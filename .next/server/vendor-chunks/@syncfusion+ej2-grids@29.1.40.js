"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@syncfusion+ej2-grids@29.1.40";
exports.ids = ["vendor-chunks/@syncfusion+ej2-grids@29.1.40"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/clipboard.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/clipboard.js ***!
  \***************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Clipboard: () => (/* binding */ Clipboard)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n/**\n * The `Clipboard` module is used to handle clipboard copy action.\n */\nvar Clipboard = /** @class */ (function () {\n    /**\n     * Constructor for the Grid clipboard module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n     * @hidden\n     */\n    function Clipboard(parent, serviceLocator) {\n        this.copyContent = '';\n        this.isSelect = false;\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.addEventListener();\n    }\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Clipboard.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.contentReady, this.initialEnd, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.keyPressed, this.keyDownHandler, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.click, this.clickHandler, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.onEmpty, this.initialEnd, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'keydown', this.pasteHandler, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Clipboard.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.keyPressed, this.keyDownHandler);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.contentReady, this.initialEnd);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.click, this.clickHandler);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.onEmpty, this.initialEnd);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'keydown', this.pasteHandler);\n    };\n    Clipboard.prototype.clickHandler = function (e) {\n        var target = e.target;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        target = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-rowcell');\n    };\n    Clipboard.prototype.pasteHandler = function (e) {\n        var _this = this;\n        var grid = this.parent;\n        var isMacLike = /(Mac)/i.test(navigator.platform);\n        var selectedRowCellIndexes = this.parent.getSelectedRowCellIndexes();\n        if (!grid.isEdit && e.keyCode === 67 && isMacLike && e.metaKey) {\n            this.copy();\n        }\n        if (selectedRowCellIndexes.length && e.keyCode === 86 && ((!isMacLike && e.ctrlKey) || (isMacLike && e.metaKey)) && !grid.isEdit) {\n            var target = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(document.activeElement, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.rowCell);\n            if (!this.clipBoardTextArea || !target || !grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' ||\n                grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n                return;\n            }\n            this.activeElement = document.activeElement;\n            var x_1 = window.scrollX;\n            var y_1 = window.scrollY;\n            this.clipBoardTextArea.focus();\n            setTimeout(function () {\n                _this.activeElement.focus();\n                window.scrollTo(x_1, y_1);\n                _this.paste(_this.clipBoardTextArea.value, selectedRowCellIndexes[0].rowIndex, selectedRowCellIndexes[0].cellIndexes[0]);\n            }, isMacLike ? 100 : 10);\n        }\n    };\n    /**\n     * Paste data from clipboard to selected cells.\n     *\n     * @param {boolean} data - Specifies the date for paste.\n     * @param {boolean} rowIndex - Specifies the row index.\n     * @param {boolean} colIndex - Specifies the column index.\n     * @returns {void}\n     */\n    Clipboard.prototype.paste = function (data, rowIndex, colIndex) {\n        var grid = this.parent;\n        var cIdx = colIndex;\n        var rIdx = rowIndex;\n        var col;\n        var value;\n        var isAvail;\n        var rows = data.split('\\n');\n        var cols;\n        for (var r = 0; r < rows.length; r++) {\n            cols = rows[parseInt(r.toString(), 10)].split('\\t');\n            cIdx = colIndex;\n            if ((r === rows.length - 1 && rows[parseInt(r.toString(), 10)] === '') || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(grid.getRowByIndex(rIdx))) {\n                cIdx++;\n                break;\n            }\n            for (var c = 0; c < cols.length; c++) {\n                isAvail = grid.getCellFromIndex(rIdx, cIdx);\n                if (!isAvail) {\n                    cIdx++;\n                    break;\n                }\n                col = grid.getColumnByIndex(cIdx);\n                value = col.getParser() ? col.getParser()(cols[parseInt(c.toString(), 10)]) : cols[parseInt(c.toString(), 10)];\n                if (col.allowEditing && !col.isPrimaryKey) {\n                    var args = {\n                        column: col,\n                        data: value,\n                        rowIndex: rIdx\n                    };\n                    this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.beforePaste, args);\n                    rIdx = args.rowIndex;\n                    if (!args.cancel) {\n                        if (grid.editModule) {\n                            if (col.type === 'number') {\n                                this.parent.editModule.updateCell(rIdx, col.field, parseFloat(args.data));\n                            }\n                            else {\n                                grid.editModule.updateCell(rIdx, col.field, args.data);\n                            }\n                        }\n                    }\n                }\n                cIdx++;\n            }\n            rIdx++;\n        }\n        grid.selectionModule.selectCellsByRange({ rowIndex: rowIndex, cellIndex: colIndex }, { rowIndex: rIdx - 1, cellIndex: cIdx - 1 });\n        var cell = this.parent.getCellFromIndex(rIdx - 1, cIdx - 1);\n        if (cell) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(cell, ['e-focus', 'e-focused'], []);\n        }\n        this.clipBoardTextArea.value = '';\n    };\n    Clipboard.prototype.initialEnd = function () {\n        this.l10n = this.serviceLocator.getService('localization');\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.contentReady, this.initialEnd);\n        this.clipBoardTextArea = this.parent.createElement('textarea', {\n            className: 'e-clipboard',\n            attrs: { tabindex: '-1', 'aria-label': this.l10n.getConstant('ClipBoard') }\n        });\n        this.clipBoardTextArea.style.opacity = '0';\n        this.parent.element.appendChild(this.clipBoardTextArea);\n    };\n    Clipboard.prototype.keyDownHandler = function (e) {\n        if (e.action === 'ctrlPlusC') {\n            this.copy();\n        }\n        else if (e.action === 'ctrlShiftPlusH') {\n            this.copy(true);\n        }\n    };\n    Clipboard.prototype.setCopyData = function (withHeader) {\n        if (window.getSelection().toString() === '') {\n            this.clipBoardTextArea.value = this.copyContent = '';\n            var rows = this.parent.getDataRows();\n            if (this.parent.selectionSettings && this.parent.selectionSettings.allowColumnSelection && this.parent.selectionModule &&\n                this.parent.selectionModule.selectedColumnsIndexes.length) {\n                if (withHeader) {\n                    var selectedColumns = this.parent.selectionModule.selectedColumnsIndexes;\n                    var headerColumns = [];\n                    for (var i = 0; i < selectedColumns.length; i++) {\n                        var colIndex = selectedColumns[parseInt(i.toString(), 10)];\n                        var headerCell = this.parent.getColumnHeaderByIndex(colIndex);\n                        if (headerCell && !headerCell.classList.contains('e-hide')) {\n                            headerColumns.push(headerCell);\n                        }\n                    }\n                    this.getCopyData(headerColumns, false, '\\t', withHeader);\n                    this.copyContent += '\\n';\n                }\n                for (var j = 0; j < rows.length; j++) {\n                    var columnCells = [];\n                    if (j > 0) {\n                        this.copyContent += '\\n';\n                    }\n                    columnCells.push.apply(columnCells, [].slice.call(rows[parseInt(j.toString(), 10)].querySelectorAll('.e-columnselection:not(.e-hide)')));\n                    this.getCopyData(columnCells, false, '\\t', withHeader);\n                }\n            }\n            else {\n                if (this.parent.selectionSettings.mode !== 'Cell') {\n                    var selectedIndexes = this.parent.getSelectedRowIndexes().sort(function (a, b) { return a - b; });\n                    if (withHeader) {\n                        var headerTextArray = [];\n                        for (var i = 0; i < this.parent.getVisibleColumns().length; i++) {\n                            headerTextArray[parseInt(i.toString(), 10)] = this.parent\n                                .getVisibleColumns()[parseInt(i.toString(), 10)].headerText;\n                        }\n                        this.getCopyData(headerTextArray, false, '\\t', withHeader);\n                        this.copyContent += '\\n';\n                    }\n                    if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && selectedIndexes.length > rows.length) {\n                        selectedIndexes = [];\n                        for (var i = 0; i < rows.length; i++) {\n                            var row = rows[parseInt(i.toString(), 10)];\n                            if (row.getAttribute('aria-selected') === 'true') {\n                                selectedIndexes.push(parseInt(row.getAttribute('data-rowindex'), 10));\n                            }\n                        }\n                    }\n                    for (var i = 0; i < selectedIndexes.length; i++) {\n                        if (i > 0) {\n                            this.copyContent += '\\n';\n                        }\n                        var leftCols = [];\n                        var idx = selectedIndexes[parseInt(i.toString(), 10)];\n                        if (!(0,_base_util__WEBPACK_IMPORTED_MODULE_2__.isGroupAdaptive)(this.parent) && (this.parent.enableVirtualization ||\n                            (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache) ||\n                            (this.parent.groupSettings.columns.length && this.parent.groupSettings.enableLazyLoading))) {\n                            idx = rows.map(function (m) { return m.getAttribute('data-rowindex'); }).indexOf(selectedIndexes[parseInt(i.toString(), 10)].toString());\n                        }\n                        var currentRow = rows[parseInt(idx.toString(), 10)];\n                        if (!((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(currentRow))) {\n                            leftCols.push.apply(leftCols, [].slice.call(currentRow.querySelectorAll('.e-rowcell:not(.e-hide)')));\n                            this.getCopyData(leftCols, false, '\\t', withHeader);\n                        }\n                    }\n                }\n                else if (this.parent.selectionModule && this.parent.selectionModule.selectedRowCellIndexes.length) {\n                    var obj = this.checkBoxSelection();\n                    if (obj.status) {\n                        if (withHeader) {\n                            var headers = [];\n                            for (var i = 0; i < obj.colIndexes.length; i++) {\n                                var colHeader = this.parent\n                                    .getColumnHeaderByIndex(obj.colIndexes[parseInt(i.toString(), 10)]);\n                                if (!colHeader.classList.contains('e-hide')) {\n                                    headers.push(colHeader);\n                                }\n                            }\n                            this.getCopyData(headers, false, '\\t', withHeader);\n                            this.copyContent += '\\n';\n                        }\n                        for (var i = 0; i < obj.rowIndexes.length; i++) {\n                            if (i > 0) {\n                                this.copyContent += '\\n';\n                            }\n                            var cells = [].slice.call(rows[obj.rowIndexes[parseInt(i.toString(), 10)]].\n                                querySelectorAll('.e-cellselectionbackground:not(.e-hide)'));\n                            this.getCopyData(cells, false, '\\t', withHeader);\n                        }\n                    }\n                    else {\n                        this.getCopyData([].slice.call(this.parent.element.getElementsByClassName('e-cellselectionbackground')), true, '\\n', withHeader);\n                    }\n                }\n            }\n            var args = {\n                data: this.copyContent,\n                cancel: false\n            };\n            this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.beforeCopy, args);\n            if (args.cancel) {\n                return;\n            }\n            this.clipBoardTextArea.value = this.copyContent = args.data;\n            if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.userAgent.match(/ipad|ipod|iphone/i)) {\n                this.clipBoardTextArea.select();\n            }\n            else {\n                this.clipBoardTextArea.setSelectionRange(0, this.clipBoardTextArea.value.length);\n            }\n            this.isSelect = true;\n        }\n    };\n    Clipboard.prototype.getCopyData = function (cells, isCell, splitKey, withHeader) {\n        var isElement = typeof cells[0] !== 'string';\n        for (var j = 0; j < cells.length; j++) {\n            if (withHeader && isCell) {\n                var colIdx = parseInt(cells[parseInt(j.toString(), 10)].\n                    getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_3__.ariaColIndex), 10) - 1;\n                this.copyContent += this.parent.getColumns()[parseInt(colIdx.toString(), 10)].headerText + '\\n';\n            }\n            if (isElement) {\n                if (!cells[parseInt(j.toString(), 10)].classList.contains('e-hide')) {\n                    this.copyContent += cells[parseInt(j.toString(), 10)].innerText;\n                }\n            }\n            else {\n                this.copyContent += cells[parseInt(j.toString(), 10)];\n            }\n            if (j < cells.length - 1) {\n                this.copyContent += splitKey;\n            }\n        }\n    };\n    /**\n     * Copy selected rows or cells data into clipboard.\n     *\n     * @returns {void}\n     * @param {boolean} withHeader - Specifies whether the column header data need to be copied or not.\n     */\n    Clipboard.prototype.copy = function (withHeader) {\n        if (document.queryCommandSupported('copy') && this.clipBoardTextArea) {\n            this.setCopyData(withHeader);\n            document.execCommand('copy');\n            this.clipBoardTextArea.blur();\n        }\n        if (this.isSelect) {\n            window.getSelection().removeAllRanges();\n            this.isSelect = false;\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    /**\n     * To destroy the clipboard\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.clipBoardTextArea) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.clipBoardTextArea);\n            this.clipBoardTextArea = null;\n        }\n    };\n    Clipboard.prototype.checkBoxSelection = function () {\n        var gridObj = this.parent;\n        var obj = { status: false };\n        if (gridObj.selectionSettings.mode === 'Cell') {\n            var rowCellIndxes = gridObj.getSelectedRowCellIndexes();\n            var str = void 0;\n            var rowIndexes = [];\n            var i = void 0;\n            for (i = 0; i < rowCellIndxes.length; i++) {\n                if (rowCellIndxes[parseInt(i.toString(), 10)].cellIndexes.length) {\n                    rowIndexes.push(rowCellIndxes[parseInt(i.toString(), 10)].rowIndex);\n                }\n                if (rowCellIndxes[parseInt(i.toString(), 10)].cellIndexes.length) {\n                    if (!str) {\n                        str = JSON.stringify(rowCellIndxes[parseInt(i.toString(), 10)].cellIndexes.sort());\n                    }\n                    if (str !== JSON.stringify(rowCellIndxes[parseInt(i.toString(), 10)].cellIndexes.sort())) {\n                        break;\n                    }\n                }\n            }\n            rowIndexes.sort(function (a, b) { return a - b; });\n            if (i === rowCellIndxes.length) {\n                obj = { status: true, rowIndexes: rowIndexes, colIndexes: rowCellIndxes[0].cellIndexes };\n            }\n        }\n        return obj;\n    };\n    return Clipboard;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL2NsaXBib2FyZC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUF5SDtBQUM1RDtBQUNsQjtBQUNTO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsZ0JBQWdCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3REFBbUI7QUFDMUMsdUJBQXVCLHNEQUFpQjtBQUN4Qyx1QkFBdUIsaURBQVk7QUFDbkMsdUJBQXVCLG1EQUFjO0FBQ3JDLFFBQVEsOERBQVk7QUFDcEI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0RBQWlCO0FBQ3pDLHdCQUF3Qix3REFBbUI7QUFDM0Msd0JBQXdCLGlEQUFZO0FBQ3BDLHdCQUF3QixtREFBYztBQUN0QyxRQUFRLDhEQUFZO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHdEQUFZO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDZEQUFPLCtCQUErQiwwREFBZ0I7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEIsZUFBZSxTQUFTO0FBQ3hCLGVBQWUsU0FBUztBQUN4QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUFDO0FBQ29CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvYWN0aW9ucy9jbGlwYm9hcmQuanM/MDk2ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCcm93c2VyLCByZW1vdmUsIEV2ZW50SGFuZGxlciwgaXNVbmRlZmluZWQsIGNsb3Nlc3QsIGNsYXNzTGlzdCwgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBwYXJlbnRzVW50aWwsIGlzR3JvdXBBZGFwdGl2ZSB9IGZyb20gJy4uL2Jhc2UvdXRpbCc7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnLi4vYmFzZS9jb25zdGFudCc7XG5pbXBvcnQgKiBhcyBsaXRlcmFscyBmcm9tICcuLi9iYXNlL3N0cmluZy1saXRlcmFscyc7XG4vKipcbiAqIFRoZSBgQ2xpcGJvYXJkYCBtb2R1bGUgaXMgdXNlZCB0byBoYW5kbGUgY2xpcGJvYXJkIGNvcHkgYWN0aW9uLlxuICovXG52YXIgQ2xpcGJvYXJkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIGZvciB0aGUgR3JpZCBjbGlwYm9hcmQgbW9kdWxlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0lHcmlkfSBwYXJlbnQgLSBzcGVjaWZpZXMgdGhlIElHcmlkXG4gICAgICogQHBhcmFtIHtTZXJ2aWNlTG9jYXRvcn0gc2VydmljZUxvY2F0b3IgLSBzcGVjaWZpZXMgdGhlIHNlcnZpY2VMb2NhdG9yXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIENsaXBib2FyZChwYXJlbnQsIHNlcnZpY2VMb2NhdG9yKSB7XG4gICAgICAgIHRoaXMuY29weUNvbnRlbnQgPSAnJztcbiAgICAgICAgdGhpcy5pc1NlbGVjdCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTG9jYXRvciA9IHNlcnZpY2VMb2NhdG9yO1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIENsaXBib2FyZC5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLmNvbnRlbnRSZWFkeSwgdGhpcy5pbml0aWFsRW5kLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLmtleVByZXNzZWQsIHRoaXMua2V5RG93bkhhbmRsZXIsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuY2xpY2ssIHRoaXMuY2xpY2tIYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLm9uRW1wdHksIHRoaXMuaW5pdGlhbEVuZCwgdGhpcyk7XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5wYXJlbnQuZWxlbWVudCwgJ2tleWRvd24nLCB0aGlzLnBhc3RlSGFuZGxlciwgdGhpcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQ2xpcGJvYXJkLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLmtleVByZXNzZWQsIHRoaXMua2V5RG93bkhhbmRsZXIpO1xuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLmNvbnRlbnRSZWFkeSwgdGhpcy5pbml0aWFsRW5kKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5jbGljaywgdGhpcy5jbGlja0hhbmRsZXIpO1xuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLm9uRW1wdHksIHRoaXMuaW5pdGlhbEVuZCk7XG4gICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5wYXJlbnQuZWxlbWVudCwgJ2tleWRvd24nLCB0aGlzLnBhc3RlSGFuZGxlcik7XG4gICAgfTtcbiAgICBDbGlwYm9hcmQucHJvdG90eXBlLmNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgICAgICB0YXJnZXQgPSBwYXJlbnRzVW50aWwodGFyZ2V0LCAnZS1yb3djZWxsJyk7XG4gICAgfTtcbiAgICBDbGlwYm9hcmQucHJvdG90eXBlLnBhc3RlSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBncmlkID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciBpc01hY0xpa2UgPSAvKE1hYykvaS50ZXN0KG5hdmlnYXRvci5wbGF0Zm9ybSk7XG4gICAgICAgIHZhciBzZWxlY3RlZFJvd0NlbGxJbmRleGVzID0gdGhpcy5wYXJlbnQuZ2V0U2VsZWN0ZWRSb3dDZWxsSW5kZXhlcygpO1xuICAgICAgICBpZiAoIWdyaWQuaXNFZGl0ICYmIGUua2V5Q29kZSA9PT0gNjcgJiYgaXNNYWNMaWtlICYmIGUubWV0YUtleSkge1xuICAgICAgICAgICAgdGhpcy5jb3B5KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdGVkUm93Q2VsbEluZGV4ZXMubGVuZ3RoICYmIGUua2V5Q29kZSA9PT0gODYgJiYgKCghaXNNYWNMaWtlICYmIGUuY3RybEtleSkgfHwgKGlzTWFjTGlrZSAmJiBlLm1ldGFLZXkpKSAmJiAhZ3JpZC5pc0VkaXQpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBjbG9zZXN0KGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQsICcuJyArIGxpdGVyYWxzLnJvd0NlbGwpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNsaXBCb2FyZFRleHRBcmVhIHx8ICF0YXJnZXQgfHwgIWdyaWQuZWRpdFNldHRpbmdzLmFsbG93RWRpdGluZyB8fCBncmlkLmVkaXRTZXR0aW5ncy5tb2RlICE9PSAnQmF0Y2gnIHx8XG4gICAgICAgICAgICAgICAgZ3JpZC5zZWxlY3Rpb25TZXR0aW5ncy5tb2RlICE9PSAnQ2VsbCcgfHwgZ3JpZC5zZWxlY3Rpb25TZXR0aW5ncy5jZWxsU2VsZWN0aW9uTW9kZSA9PT0gJ0Zsb3cnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hY3RpdmVFbGVtZW50ID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICAgICAgICAgIHZhciB4XzEgPSB3aW5kb3cuc2Nyb2xsWDtcbiAgICAgICAgICAgIHZhciB5XzEgPSB3aW5kb3cuc2Nyb2xsWTtcbiAgICAgICAgICAgIHRoaXMuY2xpcEJvYXJkVGV4dEFyZWEuZm9jdXMoKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmFjdGl2ZUVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oeF8xLCB5XzEpO1xuICAgICAgICAgICAgICAgIF90aGlzLnBhc3RlKF90aGlzLmNsaXBCb2FyZFRleHRBcmVhLnZhbHVlLCBzZWxlY3RlZFJvd0NlbGxJbmRleGVzWzBdLnJvd0luZGV4LCBzZWxlY3RlZFJvd0NlbGxJbmRleGVzWzBdLmNlbGxJbmRleGVzWzBdKTtcbiAgICAgICAgICAgIH0sIGlzTWFjTGlrZSA/IDEwMCA6IDEwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogUGFzdGUgZGF0YSBmcm9tIGNsaXBib2FyZCB0byBzZWxlY3RlZCBjZWxscy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGF0YSAtIFNwZWNpZmllcyB0aGUgZGF0ZSBmb3IgcGFzdGUuXG4gICAgICogQHBhcmFtIHtib29sZWFufSByb3dJbmRleCAtIFNwZWNpZmllcyB0aGUgcm93IGluZGV4LlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gY29sSW5kZXggLSBTcGVjaWZpZXMgdGhlIGNvbHVtbiBpbmRleC5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBDbGlwYm9hcmQucHJvdG90eXBlLnBhc3RlID0gZnVuY3Rpb24gKGRhdGEsIHJvd0luZGV4LCBjb2xJbmRleCkge1xuICAgICAgICB2YXIgZ3JpZCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgY0lkeCA9IGNvbEluZGV4O1xuICAgICAgICB2YXIgcklkeCA9IHJvd0luZGV4O1xuICAgICAgICB2YXIgY29sO1xuICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgIHZhciBpc0F2YWlsO1xuICAgICAgICB2YXIgcm93cyA9IGRhdGEuc3BsaXQoJ1xcbicpO1xuICAgICAgICB2YXIgY29scztcbiAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCByb3dzLmxlbmd0aDsgcisrKSB7XG4gICAgICAgICAgICBjb2xzID0gcm93c1twYXJzZUludChyLnRvU3RyaW5nKCksIDEwKV0uc3BsaXQoJ1xcdCcpO1xuICAgICAgICAgICAgY0lkeCA9IGNvbEluZGV4O1xuICAgICAgICAgICAgaWYgKChyID09PSByb3dzLmxlbmd0aCAtIDEgJiYgcm93c1twYXJzZUludChyLnRvU3RyaW5nKCksIDEwKV0gPT09ICcnKSB8fCBpc1VuZGVmaW5lZChncmlkLmdldFJvd0J5SW5kZXgocklkeCkpKSB7XG4gICAgICAgICAgICAgICAgY0lkeCsrO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBjb2xzLmxlbmd0aDsgYysrKSB7XG4gICAgICAgICAgICAgICAgaXNBdmFpbCA9IGdyaWQuZ2V0Q2VsbEZyb21JbmRleChySWR4LCBjSWR4KTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzQXZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY0lkeCsrO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29sID0gZ3JpZC5nZXRDb2x1bW5CeUluZGV4KGNJZHgpO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gY29sLmdldFBhcnNlcigpID8gY29sLmdldFBhcnNlcigpKGNvbHNbcGFyc2VJbnQoYy50b1N0cmluZygpLCAxMCldKSA6IGNvbHNbcGFyc2VJbnQoYy50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgICAgIGlmIChjb2wuYWxsb3dFZGl0aW5nICYmICFjb2wuaXNQcmltYXJ5S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBjb2wsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd0luZGV4OiBySWR4XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmJlZm9yZVBhc3RlLCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgcklkeCA9IGFyZ3Mucm93SW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYXJncy5jYW5jZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncmlkLmVkaXRNb2R1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29sLnR5cGUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmVkaXRNb2R1bGUudXBkYXRlQ2VsbChySWR4LCBjb2wuZmllbGQsIHBhcnNlRmxvYXQoYXJncy5kYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmlkLmVkaXRNb2R1bGUudXBkYXRlQ2VsbChySWR4LCBjb2wuZmllbGQsIGFyZ3MuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNJZHgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJJZHgrKztcbiAgICAgICAgfVxuICAgICAgICBncmlkLnNlbGVjdGlvbk1vZHVsZS5zZWxlY3RDZWxsc0J5UmFuZ2UoeyByb3dJbmRleDogcm93SW5kZXgsIGNlbGxJbmRleDogY29sSW5kZXggfSwgeyByb3dJbmRleDogcklkeCAtIDEsIGNlbGxJbmRleDogY0lkeCAtIDEgfSk7XG4gICAgICAgIHZhciBjZWxsID0gdGhpcy5wYXJlbnQuZ2V0Q2VsbEZyb21JbmRleChySWR4IC0gMSwgY0lkeCAtIDEpO1xuICAgICAgICBpZiAoY2VsbCkge1xuICAgICAgICAgICAgY2xhc3NMaXN0KGNlbGwsIFsnZS1mb2N1cycsICdlLWZvY3VzZWQnXSwgW10pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xpcEJvYXJkVGV4dEFyZWEudmFsdWUgPSAnJztcbiAgICB9O1xuICAgIENsaXBib2FyZC5wcm90b3R5cGUuaW5pdGlhbEVuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5sMTBuID0gdGhpcy5zZXJ2aWNlTG9jYXRvci5nZXRTZXJ2aWNlKCdsb2NhbGl6YXRpb24nKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5jb250ZW50UmVhZHksIHRoaXMuaW5pdGlhbEVuZCk7XG4gICAgICAgIHRoaXMuY2xpcEJvYXJkVGV4dEFyZWEgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScsIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UtY2xpcGJvYXJkJyxcbiAgICAgICAgICAgIGF0dHJzOiB7IHRhYmluZGV4OiAnLTEnLCAnYXJpYS1sYWJlbCc6IHRoaXMubDEwbi5nZXRDb25zdGFudCgnQ2xpcEJvYXJkJykgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jbGlwQm9hcmRUZXh0QXJlYS5zdHlsZS5vcGFjaXR5ID0gJzAnO1xuICAgICAgICB0aGlzLnBhcmVudC5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuY2xpcEJvYXJkVGV4dEFyZWEpO1xuICAgIH07XG4gICAgQ2xpcGJvYXJkLnByb3RvdHlwZS5rZXlEb3duSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChlLmFjdGlvbiA9PT0gJ2N0cmxQbHVzQycpIHtcbiAgICAgICAgICAgIHRoaXMuY29weSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGUuYWN0aW9uID09PSAnY3RybFNoaWZ0UGx1c0gnKSB7XG4gICAgICAgICAgICB0aGlzLmNvcHkodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENsaXBib2FyZC5wcm90b3R5cGUuc2V0Q29weURhdGEgPSBmdW5jdGlvbiAod2l0aEhlYWRlcikge1xuICAgICAgICBpZiAod2luZG93LmdldFNlbGVjdGlvbigpLnRvU3RyaW5nKCkgPT09ICcnKSB7XG4gICAgICAgICAgICB0aGlzLmNsaXBCb2FyZFRleHRBcmVhLnZhbHVlID0gdGhpcy5jb3B5Q29udGVudCA9ICcnO1xuICAgICAgICAgICAgdmFyIHJvd3MgPSB0aGlzLnBhcmVudC5nZXREYXRhUm93cygpO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnNlbGVjdGlvblNldHRpbmdzICYmIHRoaXMucGFyZW50LnNlbGVjdGlvblNldHRpbmdzLmFsbG93Q29sdW1uU2VsZWN0aW9uICYmIHRoaXMucGFyZW50LnNlbGVjdGlvbk1vZHVsZSAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnNlbGVjdGlvbk1vZHVsZS5zZWxlY3RlZENvbHVtbnNJbmRleGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmICh3aXRoSGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZENvbHVtbnMgPSB0aGlzLnBhcmVudC5zZWxlY3Rpb25Nb2R1bGUuc2VsZWN0ZWRDb2x1bW5zSW5kZXhlcztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlckNvbHVtbnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3RlZENvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xJbmRleCA9IHNlbGVjdGVkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGVhZGVyQ2VsbCA9IHRoaXMucGFyZW50LmdldENvbHVtbkhlYWRlckJ5SW5kZXgoY29sSW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhlYWRlckNlbGwgJiYgIWhlYWRlckNlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWhpZGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlckNvbHVtbnMucHVzaChoZWFkZXJDZWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldENvcHlEYXRhKGhlYWRlckNvbHVtbnMsIGZhbHNlLCAnXFx0Jywgd2l0aEhlYWRlcik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29weUNvbnRlbnQgKz0gJ1xcbic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcm93cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sdW1uQ2VsbHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGogPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvcHlDb250ZW50ICs9ICdcXG4nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbkNlbGxzLnB1c2guYXBwbHkoY29sdW1uQ2VsbHMsIFtdLnNsaWNlLmNhbGwocm93c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0ucXVlcnlTZWxlY3RvckFsbCgnLmUtY29sdW1uc2VsZWN0aW9uOm5vdCguZS1oaWRlKScpKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29weURhdGEoY29sdW1uQ2VsbHMsIGZhbHNlLCAnXFx0Jywgd2l0aEhlYWRlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnNlbGVjdGlvblNldHRpbmdzLm1vZGUgIT09ICdDZWxsJykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRJbmRleGVzID0gdGhpcy5wYXJlbnQuZ2V0U2VsZWN0ZWRSb3dJbmRleGVzKCkuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSAtIGI7IH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAod2l0aEhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlclRleHRBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBhcmVudC5nZXRWaXNpYmxlQ29sdW1ucygpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyVGV4dEFycmF5W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IHRoaXMucGFyZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRWaXNpYmxlQ29sdW1ucygpW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5oZWFkZXJUZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDb3B5RGF0YShoZWFkZXJUZXh0QXJyYXksIGZhbHNlLCAnXFx0Jywgd2l0aEhlYWRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvcHlDb250ZW50ICs9ICdcXG4nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICgodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gfHwgdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpICYmIHNlbGVjdGVkSW5kZXhlcy5sZW5ndGggPiByb3dzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleGVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93ID0gcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvdy5nZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKSA9PT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkSW5kZXhlcy5wdXNoKHBhcnNlSW50KHJvdy5nZXRBdHRyaWJ1dGUoJ2RhdGEtcm93aW5kZXgnKSwgMTApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3RlZEluZGV4ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29weUNvbnRlbnQgKz0gJ1xcbic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGVmdENvbHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSBzZWxlY3RlZEluZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0dyb3VwQWRhcHRpdmUodGhpcy5wYXJlbnQpICYmICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyAmJiB0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICYmIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuZW5hYmxlTGF6eUxvYWRpbmcpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkeCA9IHJvd3MubWFwKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLmdldEF0dHJpYnV0ZSgnZGF0YS1yb3dpbmRleCcpOyB9KS5pbmRleE9mKHNlbGVjdGVkSW5kZXhlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFJvdyA9IHJvd3NbcGFyc2VJbnQoaWR4LnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpc051bGxPclVuZGVmaW5lZChjdXJyZW50Um93KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0Q29scy5wdXNoLmFwcGx5KGxlZnRDb2xzLCBbXS5zbGljZS5jYWxsKGN1cnJlbnRSb3cucXVlcnlTZWxlY3RvckFsbCgnLmUtcm93Y2VsbDpub3QoLmUtaGlkZSknKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29weURhdGEobGVmdENvbHMsIGZhbHNlLCAnXFx0Jywgd2l0aEhlYWRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wYXJlbnQuc2VsZWN0aW9uTW9kdWxlICYmIHRoaXMucGFyZW50LnNlbGVjdGlvbk1vZHVsZS5zZWxlY3RlZFJvd0NlbGxJbmRleGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gdGhpcy5jaGVja0JveFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpdGhIZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLmNvbEluZGV4ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbEhlYWRlciA9IHRoaXMucGFyZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0Q29sdW1uSGVhZGVyQnlJbmRleChvYmouY29sSW5kZXhlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbEhlYWRlci5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaGlkZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLnB1c2goY29sSGVhZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldENvcHlEYXRhKGhlYWRlcnMsIGZhbHNlLCAnXFx0Jywgd2l0aEhlYWRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3B5Q29udGVudCArPSAnXFxuJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLnJvd0luZGV4ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3B5Q29udGVudCArPSAnXFxuJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGxzID0gW10uc2xpY2UuY2FsbChyb3dzW29iai5yb3dJbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5U2VsZWN0b3JBbGwoJy5lLWNlbGxzZWxlY3Rpb25iYWNrZ3JvdW5kOm5vdCguZS1oaWRlKScpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldENvcHlEYXRhKGNlbGxzLCBmYWxzZSwgJ1xcdCcsIHdpdGhIZWFkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDb3B5RGF0YShbXS5zbGljZS5jYWxsKHRoaXMucGFyZW50LmVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1jZWxsc2VsZWN0aW9uYmFja2dyb3VuZCcpKSwgdHJ1ZSwgJ1xcbicsIHdpdGhIZWFkZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgZGF0YTogdGhpcy5jb3B5Q29udGVudCxcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGZhbHNlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQudHJpZ2dlcihldmVudHMuYmVmb3JlQ29weSwgYXJncyk7XG4gICAgICAgICAgICBpZiAoYXJncy5jYW5jZWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNsaXBCb2FyZFRleHRBcmVhLnZhbHVlID0gdGhpcy5jb3B5Q29udGVudCA9IGFyZ3MuZGF0YTtcbiAgICAgICAgICAgIGlmICghQnJvd3Nlci51c2VyQWdlbnQubWF0Y2goL2lwYWR8aXBvZHxpcGhvbmUvaSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsaXBCb2FyZFRleHRBcmVhLnNlbGVjdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGlwQm9hcmRUZXh0QXJlYS5zZXRTZWxlY3Rpb25SYW5nZSgwLCB0aGlzLmNsaXBCb2FyZFRleHRBcmVhLnZhbHVlLmxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmlzU2VsZWN0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2xpcGJvYXJkLnByb3RvdHlwZS5nZXRDb3B5RGF0YSA9IGZ1bmN0aW9uIChjZWxscywgaXNDZWxsLCBzcGxpdEtleSwgd2l0aEhlYWRlcikge1xuICAgICAgICB2YXIgaXNFbGVtZW50ID0gdHlwZW9mIGNlbGxzWzBdICE9PSAnc3RyaW5nJztcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjZWxscy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgaWYgKHdpdGhIZWFkZXIgJiYgaXNDZWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbElkeCA9IHBhcnNlSW50KGNlbGxzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5cbiAgICAgICAgICAgICAgICAgICAgZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICAgICAgdGhpcy5jb3B5Q29udGVudCArPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKClbcGFyc2VJbnQoY29sSWR4LnRvU3RyaW5nKCksIDEwKV0uaGVhZGVyVGV4dCArICdcXG4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmICghY2VsbHNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5jb250YWlucygnZS1oaWRlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3B5Q29udGVudCArPSBjZWxsc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uaW5uZXJUZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY29weUNvbnRlbnQgKz0gY2VsbHNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGogPCBjZWxscy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb3B5Q29udGVudCArPSBzcGxpdEtleTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29weSBzZWxlY3RlZCByb3dzIG9yIGNlbGxzIGRhdGEgaW50byBjbGlwYm9hcmQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHdpdGhIZWFkZXIgLSBTcGVjaWZpZXMgd2hldGhlciB0aGUgY29sdW1uIGhlYWRlciBkYXRhIG5lZWQgdG8gYmUgY29waWVkIG9yIG5vdC5cbiAgICAgKi9cbiAgICBDbGlwYm9hcmQucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAod2l0aEhlYWRlcikge1xuICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlDb21tYW5kU3VwcG9ydGVkKCdjb3B5JykgJiYgdGhpcy5jbGlwQm9hcmRUZXh0QXJlYSkge1xuICAgICAgICAgICAgdGhpcy5zZXRDb3B5RGF0YSh3aXRoSGVhZGVyKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdjb3B5Jyk7XG4gICAgICAgICAgICB0aGlzLmNsaXBCb2FyZFRleHRBcmVhLmJsdXIoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc1NlbGVjdCkge1xuICAgICAgICAgICAgd2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICAgICAgdGhpcy5pc1NlbGVjdCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBGb3IgaW50ZXJuYWwgdXNlIG9ubHkgLSBHZXQgdGhlIG1vZHVsZSBuYW1lLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3N0cmluZ30gcmV0dXJucyB0aGUgbW9kdWxlIG5hbWVcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIENsaXBib2FyZC5wcm90b3R5cGUuZ2V0TW9kdWxlTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICdjbGlwYm9hcmQnO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVG8gZGVzdHJveSB0aGUgY2xpcGJvYXJkXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQ2xpcGJvYXJkLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICAgICAgaWYgKHRoaXMuY2xpcEJvYXJkVGV4dEFyZWEpIHtcbiAgICAgICAgICAgIHJlbW92ZSh0aGlzLmNsaXBCb2FyZFRleHRBcmVhKTtcbiAgICAgICAgICAgIHRoaXMuY2xpcEJvYXJkVGV4dEFyZWEgPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDbGlwYm9hcmQucHJvdG90eXBlLmNoZWNrQm94U2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ3JpZE9iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgb2JqID0geyBzdGF0dXM6IGZhbHNlIH07XG4gICAgICAgIGlmIChncmlkT2JqLnNlbGVjdGlvblNldHRpbmdzLm1vZGUgPT09ICdDZWxsJykge1xuICAgICAgICAgICAgdmFyIHJvd0NlbGxJbmR4ZXMgPSBncmlkT2JqLmdldFNlbGVjdGVkUm93Q2VsbEluZGV4ZXMoKTtcbiAgICAgICAgICAgIHZhciBzdHIgPSB2b2lkIDA7XG4gICAgICAgICAgICB2YXIgcm93SW5kZXhlcyA9IFtdO1xuICAgICAgICAgICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93Q2VsbEluZHhlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChyb3dDZWxsSW5keGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxsSW5kZXhlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93SW5kZXhlcy5wdXNoKHJvd0NlbGxJbmR4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnJvd0luZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvd0NlbGxJbmR4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxJbmRleGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXN0cikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyID0gSlNPTi5zdHJpbmdpZnkocm93Q2VsbEluZHhlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbEluZGV4ZXMuc29ydCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RyICE9PSBKU09OLnN0cmluZ2lmeShyb3dDZWxsSW5keGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxsSW5kZXhlcy5zb3J0KCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJvd0luZGV4ZXMuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSAtIGI7IH0pO1xuICAgICAgICAgICAgaWYgKGkgPT09IHJvd0NlbGxJbmR4ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgb2JqID0geyBzdGF0dXM6IHRydWUsIHJvd0luZGV4ZXM6IHJvd0luZGV4ZXMsIGNvbEluZGV4ZXM6IHJvd0NlbGxJbmR4ZXNbMF0uY2VsbEluZGV4ZXMgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH07XG4gICAgcmV0dXJuIENsaXBib2FyZDtcbn0oKSk7XG5leHBvcnQgeyBDbGlwYm9hcmQgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/clipboard.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/data.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/data.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Data: () => (/* binding */ Data)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/manager.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/query.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/adaptors.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _services_value_formatter__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/value-formatter */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/value-formatter.js\");\n/* harmony import */ var _common_checkbox_filter_base__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/checkbox-filter-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/common/checkbox-filter-base.js\");\n\n\n\n\n\n\n/**\n * Grid data module is used to generate query and data source.\n *\n * @hidden\n */\nvar Data = /** @class */ (function () {\n    /**\n     * Constructor for data module.\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} serviceLocator - specifies the service locator\n     * @hidden\n     */\n    function Data(parent, serviceLocator) {\n        this.dataState = { isPending: false, resolver: null, group: [] };\n        this.foreignKeyDataState = { isPending: false, resolver: null };\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.initDataManager();\n        if (this.parent.isDestroyed || this.getModuleName() === 'foreignKey') {\n            return;\n        }\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.rowsAdded, this.addRows, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.rowPositionChanged, this.reorderRows, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.rowsRemoved, this.removeRows, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.dataSourceModified, this.initDataManager, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.destroy, this.destroy, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.updateData, this.crudActions, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.addDeleteAction, this.getData, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.autoCol, this.refreshFilteredCols, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.columnsPrepared, this.refreshFilteredCols, this);\n    }\n    Data.prototype.reorderRows = function (e) {\n        if (this.parent.getDataModule().isRemote()) {\n            this.parent.getCurrentViewRecords().splice(e.toIndex, 0, this.parent.getCurrentViewRecords().splice(e.fromIndex, 1)[0]);\n        }\n        else {\n            this.dataManager.dataSource.json.splice(e.toIndex, 0, this.dataManager.dataSource.json.splice(e.fromIndex, 1)[0]);\n        }\n    };\n    Data.prototype.getModuleName = function () {\n        return 'data';\n    };\n    /**\n     * The function used to initialize dataManager and external query\n     *\n     * @returns {void}\n     */\n    Data.prototype.initDataManager = function () {\n        var gObj = this.parent;\n        this.dataManager = gObj.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.DataManager ? gObj.dataSource :\n            ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.dataSource) ? new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.DataManager() : new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.DataManager(gObj.dataSource));\n        if (gObj.isAngular && !(gObj.query instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__.Query)) {\n            gObj.setProperties({ query: new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__.Query() }, true);\n        }\n        else {\n            this.isQueryInvokedFromData = true;\n            if (!(gObj.query instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__.Query)) {\n                gObj.query = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__.Query();\n            }\n        }\n    };\n    /**\n     * The function is used to generate updated Query from Grid model.\n     *\n     * @param {boolean} skipPage - specifies the boolean to skip the page\n     * @param {boolean} isAutoCompleteCall - specifies for auto complete call\n     * @returns {Query} returns the Query\n     * @hidden\n     */\n    Data.prototype.generateQuery = function (skipPage, isAutoCompleteCall) {\n        var gObj = this.parent;\n        var query = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.getQuery()) ? gObj.getQuery().clone() : new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__.Query();\n        if (this.parent.columnQueryMode === 'ExcludeHidden') {\n            query.select(this.parent.getColumns().filter(function (column) { return !(column.isPrimaryKey !== true && column.visible === false || column.field === undefined); }).map(function (column) { return column.field; }));\n        }\n        else if (this.parent.columnQueryMode === 'Schema') {\n            var selectQueryFields = [];\n            var columns = this.parent.columns;\n            for (var i = 0; i < columns.length; i++) {\n                selectQueryFields.push(columns[parseInt(i.toString(), 10)].field);\n            }\n            query.select(selectQueryFields);\n        }\n        this.filterQuery(query);\n        this.searchQuery(query);\n        this.aggregateQuery(query);\n        this.sortQuery(query);\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.isGroupAdaptive)(this.parent)) {\n            this.virtualGroupPageQuery(query);\n        }\n        else {\n            this.pageQuery(query, skipPage);\n        }\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(isAutoCompleteCall) || !isAutoCompleteCall) {\n            this.groupQuery(query);\n        }\n        return query;\n    };\n    /**\n     * @param {Query} query - specifies the query\n     * @returns {Query} - returns the query\n     * @hidden\n     */\n    Data.prototype.aggregateQuery = function (query) {\n        var rows = this.parent.aggregates;\n        for (var i = 0; i < rows.length; i++) {\n            var row = rows[parseInt(i.toString(), 10)];\n            for (var j = 0; j < row.columns.length; j++) {\n                var cols = row.columns[parseInt(j.toString(), 10)];\n                var types = cols.type instanceof Array ? cols.type : [cols.type];\n                for (var k = 0; k < types.length; k++) {\n                    query.aggregate(types[parseInt(k.toString(), 10)].toLowerCase(), cols.field);\n                }\n            }\n        }\n        return query;\n    };\n    Data.prototype.virtualGroupPageQuery = function (query) {\n        var fName = 'fn';\n        if (query.queries.length) {\n            for (var i = 0; i < query.queries.length; i++) {\n                if (query.queries[parseInt(i.toString(), 10)][\"\" + fName] === 'onPage') {\n                    query.queries.splice(i, 1);\n                }\n            }\n        }\n        return query;\n    };\n    Data.prototype.pageQuery = function (query, skipPage) {\n        var gObj = this.parent;\n        var fName = 'fn';\n        var args = { query: query, skipPage: false };\n        gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.setVirtualPageQuery, args);\n        if (args.skipPage) {\n            return query;\n        }\n        if ((gObj.allowPaging || gObj.enableVirtualization || gObj.enableInfiniteScrolling) && skipPage !== true) {\n            gObj.pageSettings.currentPage = Math.max(1, gObj.pageSettings.currentPage);\n            if (gObj.pageSettings.pageCount <= 0) {\n                gObj.pageSettings.pageCount = 8;\n            }\n            if (gObj.pageSettings.pageSize <= 0) {\n                gObj.pageSettings.pageSize = 12;\n            }\n            if (query.queries.length) {\n                for (var i = 0; i < query.queries.length; i++) {\n                    if (query.queries[parseInt(i.toString(), 10)][\"\" + fName] === 'onPage') {\n                        query.queries.splice(i, 1);\n                    }\n                }\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.infiniteScrollModule) && gObj.enableInfiniteScrolling) {\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.infinitePageQuery, query);\n            }\n            else {\n                query.page(gObj.pageSettings.currentPage, gObj.allowPaging && gObj.pagerModule &&\n                    (gObj.pagerModule.pagerObj.isAllPage && !gObj.isManualRefresh) &&\n                    (!this.dataManager.dataSource.offline && !(this.dataManager.adaptor instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.RemoteSaveAdaptor)) ?\n                    null : gObj.pageSettings.pageSize);\n            }\n        }\n        return query;\n    };\n    Data.prototype.groupQuery = function (query) {\n        var gObj = this.parent;\n        if (gObj.allowGrouping && gObj.groupSettings.columns.length) {\n            if (this.parent.groupSettings.enableLazyLoading) {\n                query.lazyLoad.push({ key: 'isLazyLoad', value: this.parent.groupSettings.enableLazyLoading });\n            }\n            var columns = gObj.groupSettings.columns;\n            for (var i = 0, len = columns.length; i < len; i++) {\n                var column = this.getColumnByField(columns[parseInt(i.toString(), 10)]);\n                if (!column) {\n                    this.parent.log('initial_action', { moduleName: 'group', columnName: columns[parseInt(i.toString(), 10)] });\n                }\n                var isGrpFmt = column.enableGroupByFormat;\n                var format = column.format;\n                if (isGrpFmt) {\n                    query.group(columns[parseInt(i.toString(), 10)], this.formatGroupColumn.bind(this), format);\n                }\n                else {\n                    query.group(columns[parseInt(i.toString(), 10)], null);\n                }\n            }\n        }\n        return query;\n    };\n    Data.prototype.sortQuery = function (query) {\n        var gObj = this.parent;\n        if ((gObj.allowSorting || gObj.allowGrouping) && gObj.sortSettings.columns.length) {\n            var columns = gObj.sortSettings.columns;\n            var sortGrp = [];\n            for (var i = columns.length - 1; i > -1; i--) {\n                var col = this.getColumnByField(columns[parseInt(i.toString(), 10)].field);\n                if (col) {\n                    col.setSortDirection(columns[parseInt(i.toString(), 10)].direction);\n                }\n                else {\n                    this.parent.log('initial_action', { moduleName: 'sort', columnName: columns[parseInt(i.toString(), 10)].field });\n                    return query;\n                }\n                var fn = columns[parseInt(i.toString(), 10)].direction;\n                if (col.sortComparer) {\n                    this.parent.log('grid_sort_comparer');\n                    fn = !this.isRemote() ? col.sortComparer.bind(col) : columns[parseInt(i.toString(), 10)].direction;\n                }\n                if (gObj.groupSettings.columns.indexOf(columns[parseInt(i.toString(), 10)].field) === -1) {\n                    if (col.isForeignColumn() || col.sortComparer) {\n                        query.sortByForeignKey(col.field, fn, undefined, columns[parseInt(i.toString(), 10)].direction.toLowerCase());\n                    }\n                    else {\n                        query.sortBy(col.field, fn);\n                    }\n                }\n                else {\n                    sortGrp.push({ direction: fn, field: col.field });\n                }\n            }\n            for (var i = 0, len = sortGrp.length; i < len; i++) {\n                if (typeof sortGrp[parseInt(i.toString(), 10)].direction === 'string') {\n                    query.sortBy(sortGrp[parseInt(i.toString(), 10)].field, sortGrp[parseInt(i.toString(), 10)].direction);\n                }\n                else {\n                    var col = this.getColumnByField(sortGrp[parseInt(i.toString(), 10)].field);\n                    query.sortByForeignKey(sortGrp[parseInt(i.toString(), 10)].field, sortGrp[parseInt(i.toString(), 10)].direction, undefined, col.getSortDirection().toLowerCase());\n                }\n            }\n        }\n        return query;\n    };\n    /**\n     * @param {Query} query - specifies the query\n     * @param {Column} fcolumn - specifies the forein key column model\n     * @param {boolean} isForeignKey - Confirms whether the column is a foreign key or not\n     * @returns {Query} - returns the query\n     * @hidden\n     */\n    Data.prototype.searchQuery = function (query, fcolumn, isForeignKey) {\n        var sSettings = this.parent.searchSettings;\n        var fields = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(sSettings.fields) && sSettings.fields.length) ? sSettings.fields\n            : this.getSearchColumnFieldNames();\n        var predicateList = [];\n        var needForeignKeySearch = false;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.searchSettings.key) && this.parent.searchSettings.key.length) {\n            needForeignKeySearch = this.parent.getForeignKeyColumns().some(function (col) { return fields.indexOf(col.field) > -1; });\n            var adaptor = !isForeignKey ? this.dataManager.adaptor : fcolumn.dataSource.adaptor;\n            if (needForeignKeySearch || (adaptor.getModuleName &&\n                adaptor.getModuleName() === 'ODataV4Adaptor')) {\n                fields = isForeignKey ? [fcolumn.foreignKeyValue] : fields;\n                for (var i = 0; i < fields.length; i++) {\n                    var column = isForeignKey ? fcolumn : this.getColumnByField(fields[parseInt(i.toString(), 10)]);\n                    if (column.isForeignColumn() && !isForeignKey) {\n                        predicateList = this.fGeneratePredicate(column, predicateList);\n                    }\n                    else {\n                        predicateList.push(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__.Predicate(fields[parseInt(i.toString(), 10)], sSettings.operator, sSettings.key, sSettings.ignoreCase, sSettings.ignoreAccent));\n                    }\n                }\n                var predList = _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__.Predicate.or(predicateList);\n                predList.key = sSettings.key;\n                query.where(predList);\n            }\n            else {\n                query.search(sSettings.key, fields, sSettings.operator, sSettings.ignoreCase, sSettings.ignoreAccent);\n            }\n        }\n        return query;\n    };\n    Data.prototype.filterQuery = function (query, column, skipFoerign) {\n        var gObj = this.parent;\n        var predicateList = [];\n        var actualFilter = [];\n        var foreignColumn = this.parent.getForeignKeyColumns();\n        var foreignColEmpty;\n        if (gObj.allowFiltering && gObj.filterSettings.columns.length) {\n            var columns = column ? column : gObj.filterSettings.columns;\n            var colType = {};\n            for (var _i = 0, _a = gObj.getColumns(); _i < _a.length; _i++) {\n                var col = _a[_i];\n                colType[col.field] = col.filter.type ? col.filter.type : gObj.filterSettings.type;\n            }\n            var foreignCols = [];\n            var defaultFltrCols = [];\n            for (var _b = 0, columns_1 = columns; _b < columns_1.length; _b++) {\n                var col = columns_1[_b];\n                var gridColumn = col.isForeignKey ? gObj.getColumnByUid(col.uid) : gObj.getColumnByField(col.field);\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(col.type) && gridColumn && (gridColumn.type === 'date' || gridColumn.type === 'datetime' || gridColumn.type === 'dateonly')) {\n                    col.type = col.isForeignKey ? gObj.getColumnByUid(col.uid).type : gObj.getColumnByField(col.field).type;\n                }\n                if (col.isForeignKey) {\n                    foreignCols.push(col);\n                }\n                else {\n                    defaultFltrCols.push(col);\n                }\n            }\n            if (defaultFltrCols.length) {\n                for (var i = 0, len = defaultFltrCols.length; i < len; i++) {\n                    defaultFltrCols[parseInt(i.toString(), 10)].uid = defaultFltrCols[parseInt(i.toString(), 10)].uid ||\n                        this.parent.grabColumnByFieldFromAllCols(defaultFltrCols[parseInt(i.toString(), 10)]\n                            .field, defaultFltrCols[parseInt(i.toString(), 10)].isForeignKey).uid;\n                }\n                var excelPredicate = _common_checkbox_filter_base__WEBPACK_IMPORTED_MODULE_6__.CheckBoxFilterBase.getPredicate(defaultFltrCols);\n                for (var _c = 0, _d = Object.keys(excelPredicate); _c < _d.length; _c++) {\n                    var prop = _d[_c];\n                    predicateList.push(excelPredicate[\"\" + prop]);\n                }\n            }\n            if (foreignCols.length) {\n                for (var _e = 0, foreignCols_1 = foreignCols; _e < foreignCols_1.length; _e++) {\n                    var col = foreignCols_1[_e];\n                    col.uid = col.uid || this.parent.grabColumnByFieldFromAllCols(col.field, col.isForeignKey).uid;\n                    var column_1 = this.parent.grabColumnByUidFromAllCols(col.uid);\n                    if (!column_1) {\n                        this.parent.log('initial_action', { moduleName: 'filter', columnName: col.field });\n                    }\n                    if (column_1.isForeignColumn() && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.getColumnByForeignKeyValue)(col.field, foreignColumn) && !skipFoerign) {\n                        actualFilter.push(col);\n                        if (!column_1.columnData.length) {\n                            foreignColEmpty = true;\n                        }\n                        predicateList = this.fGeneratePredicate(column_1, predicateList);\n                    }\n                    else {\n                        var excelPredicate = _common_checkbox_filter_base__WEBPACK_IMPORTED_MODULE_6__.CheckBoxFilterBase.getPredicate(columns);\n                        for (var _f = 0, _g = Object.keys(excelPredicate); _f < _g.length; _f++) {\n                            var prop = _g[_f];\n                            predicateList.push(excelPredicate[\"\" + prop]);\n                        }\n                    }\n                }\n            }\n            if (predicateList.length && !foreignColEmpty) {\n                query.where(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__.Predicate.and(predicateList));\n            }\n            else {\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.showEmptyGrid, {});\n            }\n        }\n        return query;\n    };\n    Data.prototype.fGeneratePredicate = function (col, predicateList) {\n        var fPredicate = {};\n        if (col) {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.generateQuery, { predicate: fPredicate, column: col });\n            if (fPredicate.predicate.predicates.length) {\n                predicateList.push(fPredicate.predicate);\n            }\n        }\n        return predicateList;\n    };\n    /**\n     * The function is used to get dataManager promise by executing given Query.\n     *\n     * @param {object} args - specifies the object\n     * @param {string} args.requestType - Defines the request type\n     * @param {string[]} args.foreignKeyData - Defines the foreignKeyData.string\n     * @param {Object} args.data - Defines the data.\n     * @param {number} args.index - Defines the index .\n     * @param {Query} query - Defines the query which will execute along with data processing.\n     * @returns {Promise<Object>} - returns the object\n     * @hidden\n     */\n    Data.prototype.getData = function (args, query) {\n        var _this = this;\n        if (args === void 0) { args = { requestType: '' }; }\n        var key = this.getKey(args.foreignKeyData &&\n            Object.keys(args.foreignKeyData).length ?\n            args.foreignKeyData : this.parent.getPrimaryKeyFieldNames());\n        this.parent.log('datasource_syntax_mismatch', { dataState: this.parent });\n        if (this.parent.dataSource && 'result' in this.parent.dataSource) {\n            var def = this.eventPromise(args, query, key);\n            return def.promise;\n        }\n        else {\n            var crud = void 0;\n            switch (args.requestType) {\n                case 'delete':\n                    query = query ? query : this.generateQuery();\n                    // eslint-disable-next-line no-case-declarations\n                    var len = Object.keys(args.data).length;\n                    if (len === 1) {\n                        crud = this.dataManager.remove(key, args.data[0], query.fromTable, query);\n                    }\n                    else {\n                        var changes = {\n                            addedRecords: [],\n                            deletedRecords: [],\n                            changedRecords: []\n                        };\n                        changes.deletedRecords = args.data;\n                        crud = this.dataManager.saveChanges(changes, key, query.fromTable, query.requiresCount());\n                    }\n                    break;\n                case 'save':\n                    query = query ? query : this.generateQuery();\n                    args.index = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.index) ? 0 : args.index;\n                    crud = this.dataManager.insert(args.data, query.fromTable, query, args.index);\n                    break;\n            }\n            var promise = 'promise';\n            args[\"\" + promise] = crud;\n            // eslint-disable-next-line no-prototype-builtins\n            if (crud && !Array.isArray(crud) && !crud.hasOwnProperty('deletedRecords')) {\n                return crud.then(function () {\n                    return _this.insert(query, args);\n                });\n            }\n            else {\n                return this.insert(query, args);\n            }\n        }\n    };\n    Data.prototype.insert = function (query, args) {\n        if (args.requestType === 'save') {\n            args.query = query;\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.recordAdded, args);\n        }\n        return this.executeQuery(query);\n    };\n    Data.prototype.executeQuery = function (query) {\n        var _this = this;\n        if (this.dataManager.ready) {\n            var deferred_1 = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.Deferred();\n            var ready = this.dataManager.ready;\n            ready.then(function () {\n                _this.dataManager.executeQuery(query).then(function (result) {\n                    deferred_1.resolve(result);\n                });\n            }).catch(function (e) {\n                deferred_1.reject(e);\n            });\n            return deferred_1.promise;\n        }\n        else {\n            return this.dataManager.executeQuery(query);\n        }\n    };\n    Data.prototype.formatGroupColumn = function (value, field) {\n        var serviceLocator = this.serviceLocator;\n        var column = this.getColumnByField(field);\n        var date = value;\n        if (!column.type) {\n            column.type = date.getDay ? (date.getHours() > 0 || date.getMinutes() > 0 ||\n                date.getSeconds() > 0 || date.getMilliseconds() > 0 ? 'datetime' : 'date') : typeof (value);\n        }\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.getFormatter())) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.setFormatter)(serviceLocator, column);\n        }\n        var formatVal = _services_value_formatter__WEBPACK_IMPORTED_MODULE_7__.ValueFormatter.prototype.toView(value, column.getFormatter());\n        return formatVal;\n    };\n    Data.prototype.crudActions = function (args) {\n        var query = this.generateQuery();\n        var promise = null;\n        var pr = 'promise';\n        var key = this.getKey(args.foreignKeyData &&\n            Object.keys(args.foreignKeyData).length ? args.foreignKeyData :\n            this.parent.getPrimaryKeyFieldNames());\n        if (this.parent.dataSource && 'result' in this.parent.dataSource) {\n            this.eventPromise(args, query, key);\n        }\n        switch (args.requestType) {\n            case 'save':\n                promise = this.dataManager.update(key, args.data, query.fromTable, query, args.previousData);\n                break;\n        }\n        args[\"\" + pr] = promise ? promise : args[\"\" + pr];\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.crudAction, args);\n    };\n    /**\n     * @param {object} changes - specifies the changes\n     * @param {string} key - specifies the key\n     * @param {object} original - specifies the original data\n     * @param {Query} query - specifies the query\n     * @returns {Promise<Object>} returns the object\n     * @hidden\n     */\n    Data.prototype.saveChanges = function (changes, key, original, query) {\n        if (query === void 0) { query = this.generateQuery(); }\n        query.requiresCount();\n        if ('result' in this.parent.dataSource) {\n            var deff = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.Deferred();\n            var args = {\n                requestType: 'batchsave', changes: changes, key: key, query: query,\n                endEdit: deff.resolve\n            };\n            this.setState({ isPending: true, resolver: deff.resolve });\n            this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.dataSourceChanged, args);\n            return deff.promise;\n        }\n        else {\n            var promise = this.dataManager.saveChanges(changes, key, query.fromTable, query, original);\n            return promise;\n        }\n    };\n    Data.prototype.getKey = function (keys) {\n        if (keys && keys.length) {\n            return keys[0];\n        }\n        return undefined;\n    };\n    /**\n     * @returns {boolean} returns whether its remote data\n     * @hidden\n     */\n    Data.prototype.isRemote = function () {\n        return this.dataManager.dataSource.offline !== true && this.dataManager.dataSource.url !== undefined &&\n            this.dataManager.dataSource.url !== '';\n    };\n    Data.prototype.addRows = function (e) {\n        for (var i = e.records.length; i > 0; i--) {\n            if (this.parent.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.DataManager && this.dataManager.dataSource.offline) {\n                this.dataManager.dataSource.json.splice(e.toIndex, 0, e.records[i - 1]);\n            }\n            else if (((!this.parent.getDataModule().isRemote()) && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource))) &&\n                (!this.parent.dataSource.result)) {\n                this.parent.dataSource['splice'](e.toIndex, 0, e.records[i - 1]);\n            }\n        }\n    };\n    Data.prototype.removeRows = function (e) {\n        var json = this.dataManager.dataSource.json;\n        if (this.parent.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.DataManager && this.dataManager.dataSource.offline) {\n            this.dataManager.dataSource.json = json.filter(function (value) { return e.records.indexOf(value) === -1; });\n        }\n        else if (((!this.parent.getDataModule().isRemote()) && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource))) &&\n            (!this.parent.dataSource.result)) {\n            this.parent.dataSource = json.filter(function (value) { return e.records.indexOf(value) === -1; });\n        }\n    };\n    Data.prototype.getColumnByField = function (field) {\n        var col;\n        return (this.parent.columnModel).some(function (column) {\n            col = column;\n            return column.field === field;\n        }) && col;\n    };\n    Data.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.rowsAdded, this.addRows);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.rowsRemoved, this.removeRows);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.dataSourceModified, this.initDataManager);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.destroy, this.destroy);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.updateData, this.crudActions);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.addDeleteAction, this.getData);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.autoCol, this.refreshFilteredCols);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.columnsPrepared, this.refreshFilteredCols);\n    };\n    Data.prototype.getState = function () {\n        return this.dataState;\n    };\n    Data.prototype.setState = function (state) {\n        return this.dataState = state;\n    };\n    Data.prototype.getForeignKeyDataState = function () {\n        return this.foreignKeyDataState;\n    };\n    Data.prototype.setForeignKeyDataState = function (state) {\n        this.foreignKeyDataState = state;\n    };\n    Data.prototype.getStateEventArgument = function (query) {\n        var adaptr = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.UrlAdaptor();\n        var dm = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.DataManager({ url: '', adaptor: new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.UrlAdaptor });\n        var state = adaptr.processQuery(dm, query);\n        var data = JSON.parse(state.data);\n        return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(data, state.pvtData);\n    };\n    Data.prototype.eventPromise = function (args, query, key) {\n        var _this = this;\n        var dataArgs = args;\n        var state = this.getStateEventArgument(query);\n        var def = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.Deferred();\n        var deff = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.Deferred();\n        if ((args.requestType !== undefined || (this.parent.groupSettings.disablePageWiseAggregates && query.queries.some(function (query) { return query.fn === 'onGroup'; })))\n            && this.dataState.isDataChanged !== false) {\n            state.action = args;\n            if (args.requestType === 'save' || args.requestType === 'delete' || args.requestType === 'batchsave') {\n                var editArgs_1 = args;\n                editArgs_1.key = key;\n                var promise = 'promise';\n                editArgs_1[\"\" + promise] = deff.promise;\n                editArgs_1.state = state;\n                this.setState({ isPending: true, resolver: deff.resolve });\n                dataArgs.endEdit = deff.resolve;\n                dataArgs.cancelEdit = deff.reject;\n                this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.dataSourceChanged, editArgs_1);\n                deff.promise.then(function () {\n                    _this.setState({ isPending: true, resolver: def.resolve, group: state.group, aggregates: state.aggregates });\n                    if (editArgs_1.requestType === 'save') {\n                        _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.recordAdded, editArgs_1);\n                    }\n                    _this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.dataStateChange, state);\n                })\n                    .catch(function () { return void 0; });\n            }\n            else {\n                this.setState({ isPending: true, resolver: def.resolve, group: state.group, aggregates: state.aggregates });\n                this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.dataStateChange, state);\n            }\n        }\n        else {\n            this.setState({});\n            def.resolve(this.parent.dataSource);\n        }\n        return def;\n    };\n    /**\n     * Gets the columns where searching needs to be performed from the Grid.\n     *\n     * @returns {string[]} returns the searched column field names\n     */\n    Data.prototype.getSearchColumnFieldNames = function () {\n        var colFieldNames = [];\n        var columns = this.parent.getColumns();\n        for (var _i = 0, columns_2 = columns; _i < columns_2.length; _i++) {\n            var col = columns_2[_i];\n            if (col.allowSearching && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(col.field)) {\n                colFieldNames.push(col.field);\n            }\n        }\n        return colFieldNames;\n    };\n    Data.prototype.refreshFilteredCols = function () {\n        if (this.parent.allowFiltering && this.parent.filterSettings.columns.length) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.refreshFilteredColsUid)(this.parent, this.parent.filterSettings.columns);\n        }\n    };\n    return Data;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL2RhdGEuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQWlFO0FBQzZDO0FBQ0c7QUFDdEU7QUFDa0I7QUFDTztBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIscURBQWdCO0FBQ3ZDLHVCQUF1Qiw4REFBeUI7QUFDaEQsdUJBQXVCLHVEQUFrQjtBQUN6Qyx1QkFBdUIsOERBQXlCO0FBQ2hELHVCQUF1QixtREFBYztBQUNyQyx1QkFBdUIsc0RBQWlCO0FBQ3hDLHVCQUF1QiwyREFBc0I7QUFDN0MsdUJBQXVCLG1EQUFjO0FBQ3JDLHVCQUF1QiwyREFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCw2REFBVztBQUNqRSxhQUFhLHVFQUFpQix3QkFBd0IsNkRBQVcsU0FBUyw2REFBVztBQUNyRixzREFBc0QsdURBQUs7QUFDM0QsaUNBQWlDLFdBQVcsdURBQUssSUFBSTtBQUNyRDtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsdURBQUs7QUFDN0MsaUNBQWlDLHVEQUFLO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixlQUFlLFNBQVM7QUFDeEIsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFB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bURBQWM7QUFDdEMsd0JBQXdCLHNEQUFpQjtBQUN6Qyx3QkFBd0IsMkRBQXNCO0FBQzlDLHdCQUF3QixtREFBYztBQUN0Qyx3QkFBd0IsMkRBQXNCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNERBQVU7QUFDbkMscUJBQXFCLDZEQUFXLEdBQUcsc0JBQXNCLDREQUFVLEVBQUU7QUFDckU7QUFDQTtBQUNBLGVBQWUsNERBQU07QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiwwREFBUTtBQUM5Qix1QkFBdUIsMERBQVE7QUFDL0IsNklBQTZJLGdDQUFnQztBQUM3SztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHlDQUF5QztBQUN6RTtBQUNBO0FBQ0Esb0NBQW9DLDZEQUF3QjtBQUM1RDtBQUNBLHFDQUFxQywwRkFBMEY7QUFDL0g7QUFDQSw0Q0FBNEMsdURBQWtCO0FBQzlEO0FBQ0EseUNBQXlDLDJEQUFzQjtBQUMvRCxpQkFBaUI7QUFDakIseUNBQXlDLGdCQUFnQjtBQUN6RDtBQUNBO0FBQ0EsZ0NBQWdDLDBGQUEwRjtBQUMxSCxvQ0FBb0MsMkRBQXNCO0FBQzFEO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHVCQUF1QjtBQUNyRTtBQUNBLHVDQUF1Qyx1RUFBaUI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGtFQUFzQjtBQUNsQztBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ2UiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL2RhdGEuanM/MmNkMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc051bGxPclVuZGVmaW5lZCwgZXh0ZW5kIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgUXVlcnksIERhdGFNYW5hZ2VyLCBQcmVkaWNhdGUsIERlZmVycmVkLCBVcmxBZGFwdG9yLCBSZW1vdGVTYXZlQWRhcHRvciB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1kYXRhJztcbmltcG9ydCB7IHNldEZvcm1hdHRlciwgaXNHcm91cEFkYXB0aXZlLCBnZXRDb2x1bW5CeUZvcmVpZ25LZXlWYWx1ZSwgcmVmcmVzaEZpbHRlcmVkQ29sc1VpZCB9IGZyb20gJy4uL2Jhc2UvdXRpbCc7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnLi4vYmFzZS9jb25zdGFudCc7XG5pbXBvcnQgeyBWYWx1ZUZvcm1hdHRlciB9IGZyb20gJy4uL3NlcnZpY2VzL3ZhbHVlLWZvcm1hdHRlcic7XG5pbXBvcnQgeyBDaGVja0JveEZpbHRlckJhc2UgfSBmcm9tICcuLi9jb21tb24vY2hlY2tib3gtZmlsdGVyLWJhc2UnO1xuLyoqXG4gKiBHcmlkIGRhdGEgbW9kdWxlIGlzIHVzZWQgdG8gZ2VuZXJhdGUgcXVlcnkgYW5kIGRhdGEgc291cmNlLlxuICpcbiAqIEBoaWRkZW5cbiAqL1xudmFyIERhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IgZm9yIGRhdGEgbW9kdWxlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtJR3JpZH0gcGFyZW50IC0gc3BlY2lmaWVzIHRoZSBJR3JpZFxuICAgICAqIEBwYXJhbSB7U2VydmljZUxvY2F0b3J9IHNlcnZpY2VMb2NhdG9yIC0gc3BlY2lmaWVzIHRoZSBzZXJ2aWNlIGxvY2F0b3JcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZnVuY3Rpb24gRGF0YShwYXJlbnQsIHNlcnZpY2VMb2NhdG9yKSB7XG4gICAgICAgIHRoaXMuZGF0YVN0YXRlID0geyBpc1BlbmRpbmc6IGZhbHNlLCByZXNvbHZlcjogbnVsbCwgZ3JvdXA6IFtdIH07XG4gICAgICAgIHRoaXMuZm9yZWlnbktleURhdGFTdGF0ZSA9IHsgaXNQZW5kaW5nOiBmYWxzZSwgcmVzb2x2ZXI6IG51bGwgfTtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHRoaXMuc2VydmljZUxvY2F0b3IgPSBzZXJ2aWNlTG9jYXRvcjtcbiAgICAgICAgdGhpcy5pbml0RGF0YU1hbmFnZXIoKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkIHx8IHRoaXMuZ2V0TW9kdWxlTmFtZSgpID09PSAnZm9yZWlnbktleScpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMucm93c0FkZGVkLCB0aGlzLmFkZFJvd3MsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMucm93UG9zaXRpb25DaGFuZ2VkLCB0aGlzLnJlb3JkZXJSb3dzLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLnJvd3NSZW1vdmVkLCB0aGlzLnJlbW92ZVJvd3MsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuZGF0YVNvdXJjZU1vZGlmaWVkLCB0aGlzLmluaXREYXRhTWFuYWdlciwgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5kZXN0cm95LCB0aGlzLmRlc3Ryb3ksIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMudXBkYXRlRGF0YSwgdGhpcy5jcnVkQWN0aW9ucywgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5hZGREZWxldGVBY3Rpb24sIHRoaXMuZ2V0RGF0YSwgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5hdXRvQ29sLCB0aGlzLnJlZnJlc2hGaWx0ZXJlZENvbHMsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuY29sdW1uc1ByZXBhcmVkLCB0aGlzLnJlZnJlc2hGaWx0ZXJlZENvbHMsIHRoaXMpO1xuICAgIH1cbiAgICBEYXRhLnByb3RvdHlwZS5yZW9yZGVyUm93cyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuZ2V0Q3VycmVudFZpZXdSZWNvcmRzKCkuc3BsaWNlKGUudG9JbmRleCwgMCwgdGhpcy5wYXJlbnQuZ2V0Q3VycmVudFZpZXdSZWNvcmRzKCkuc3BsaWNlKGUuZnJvbUluZGV4LCAxKVswXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmRhdGFNYW5hZ2VyLmRhdGFTb3VyY2UuanNvbi5zcGxpY2UoZS50b0luZGV4LCAwLCB0aGlzLmRhdGFNYW5hZ2VyLmRhdGFTb3VyY2UuanNvbi5zcGxpY2UoZS5mcm9tSW5kZXgsIDEpWzBdKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRGF0YS5wcm90b3R5cGUuZ2V0TW9kdWxlTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICdkYXRhJztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoZSBmdW5jdGlvbiB1c2VkIHRvIGluaXRpYWxpemUgZGF0YU1hbmFnZXIgYW5kIGV4dGVybmFsIHF1ZXJ5XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBEYXRhLnByb3RvdHlwZS5pbml0RGF0YU1hbmFnZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHRoaXMuZGF0YU1hbmFnZXIgPSBnT2JqLmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBEYXRhTWFuYWdlciA/IGdPYmouZGF0YVNvdXJjZSA6XG4gICAgICAgICAgICAoaXNOdWxsT3JVbmRlZmluZWQoZ09iai5kYXRhU291cmNlKSA/IG5ldyBEYXRhTWFuYWdlcigpIDogbmV3IERhdGFNYW5hZ2VyKGdPYmouZGF0YVNvdXJjZSkpO1xuICAgICAgICBpZiAoZ09iai5pc0FuZ3VsYXIgJiYgIShnT2JqLnF1ZXJ5IGluc3RhbmNlb2YgUXVlcnkpKSB7XG4gICAgICAgICAgICBnT2JqLnNldFByb3BlcnRpZXMoeyBxdWVyeTogbmV3IFF1ZXJ5KCkgfSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmlzUXVlcnlJbnZva2VkRnJvbURhdGEgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKCEoZ09iai5xdWVyeSBpbnN0YW5jZW9mIFF1ZXJ5KSkge1xuICAgICAgICAgICAgICAgIGdPYmoucXVlcnkgPSBuZXcgUXVlcnkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIHVzZWQgdG8gZ2VuZXJhdGUgdXBkYXRlZCBRdWVyeSBmcm9tIEdyaWQgbW9kZWwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNraXBQYWdlIC0gc3BlY2lmaWVzIHRoZSBib29sZWFuIHRvIHNraXAgdGhlIHBhZ2VcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzQXV0b0NvbXBsZXRlQ2FsbCAtIHNwZWNpZmllcyBmb3IgYXV0byBjb21wbGV0ZSBjYWxsXG4gICAgICogQHJldHVybnMge1F1ZXJ5fSByZXR1cm5zIHRoZSBRdWVyeVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBEYXRhLnByb3RvdHlwZS5nZW5lcmF0ZVF1ZXJ5ID0gZnVuY3Rpb24gKHNraXBQYWdlLCBpc0F1dG9Db21wbGV0ZUNhbGwpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHF1ZXJ5ID0gIWlzTnVsbE9yVW5kZWZpbmVkKGdPYmouZ2V0UXVlcnkoKSkgPyBnT2JqLmdldFF1ZXJ5KCkuY2xvbmUoKSA6IG5ldyBRdWVyeSgpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuY29sdW1uUXVlcnlNb2RlID09PSAnRXhjbHVkZUhpZGRlbicpIHtcbiAgICAgICAgICAgIHF1ZXJ5LnNlbGVjdCh0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCkuZmlsdGVyKGZ1bmN0aW9uIChjb2x1bW4pIHsgcmV0dXJuICEoY29sdW1uLmlzUHJpbWFyeUtleSAhPT0gdHJ1ZSAmJiBjb2x1bW4udmlzaWJsZSA9PT0gZmFsc2UgfHwgY29sdW1uLmZpZWxkID09PSB1bmRlZmluZWQpOyB9KS5tYXAoZnVuY3Rpb24gKGNvbHVtbikgeyByZXR1cm4gY29sdW1uLmZpZWxkOyB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5wYXJlbnQuY29sdW1uUXVlcnlNb2RlID09PSAnU2NoZW1hJykge1xuICAgICAgICAgICAgdmFyIHNlbGVjdFF1ZXJ5RmllbGRzID0gW107XG4gICAgICAgICAgICB2YXIgY29sdW1ucyA9IHRoaXMucGFyZW50LmNvbHVtbnM7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RRdWVyeUZpZWxkcy5wdXNoKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHF1ZXJ5LnNlbGVjdChzZWxlY3RRdWVyeUZpZWxkcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maWx0ZXJRdWVyeShxdWVyeSk7XG4gICAgICAgIHRoaXMuc2VhcmNoUXVlcnkocXVlcnkpO1xuICAgICAgICB0aGlzLmFnZ3JlZ2F0ZVF1ZXJ5KHF1ZXJ5KTtcbiAgICAgICAgdGhpcy5zb3J0UXVlcnkocXVlcnkpO1xuICAgICAgICBpZiAoaXNHcm91cEFkYXB0aXZlKHRoaXMucGFyZW50KSkge1xuICAgICAgICAgICAgdGhpcy52aXJ0dWFsR3JvdXBQYWdlUXVlcnkocXVlcnkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wYWdlUXVlcnkocXVlcnksIHNraXBQYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoaXNBdXRvQ29tcGxldGVDYWxsKSB8fCAhaXNBdXRvQ29tcGxldGVDYWxsKSB7XG4gICAgICAgICAgICB0aGlzLmdyb3VwUXVlcnkocXVlcnkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBxdWVyeTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UXVlcnl9IHF1ZXJ5IC0gc3BlY2lmaWVzIHRoZSBxdWVyeVxuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gLSByZXR1cm5zIHRoZSBxdWVyeVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBEYXRhLnByb3RvdHlwZS5hZ2dyZWdhdGVRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgICB2YXIgcm93cyA9IHRoaXMucGFyZW50LmFnZ3JlZ2F0ZXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHJvdyA9IHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByb3cuY29sdW1ucy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBjb2xzID0gcm93LmNvbHVtbnNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgICAgIHZhciB0eXBlcyA9IGNvbHMudHlwZSBpbnN0YW5jZW9mIEFycmF5ID8gY29scy50eXBlIDogW2NvbHMudHlwZV07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCB0eXBlcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICBxdWVyeS5hZ2dyZWdhdGUodHlwZXNbcGFyc2VJbnQoay50b1N0cmluZygpLCAxMCldLnRvTG93ZXJDYXNlKCksIGNvbHMuZmllbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcXVlcnk7XG4gICAgfTtcbiAgICBEYXRhLnByb3RvdHlwZS52aXJ0dWFsR3JvdXBQYWdlUXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgdmFyIGZOYW1lID0gJ2ZuJztcbiAgICAgICAgaWYgKHF1ZXJ5LnF1ZXJpZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHF1ZXJ5LnF1ZXJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAocXVlcnkucXVlcmllc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIGZOYW1lXSA9PT0gJ29uUGFnZScpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnkucXVlcmllcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBxdWVyeTtcbiAgICB9O1xuICAgIERhdGEucHJvdG90eXBlLnBhZ2VRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeSwgc2tpcFBhZ2UpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIGZOYW1lID0gJ2ZuJztcbiAgICAgICAgdmFyIGFyZ3MgPSB7IHF1ZXJ5OiBxdWVyeSwgc2tpcFBhZ2U6IGZhbHNlIH07XG4gICAgICAgIGdPYmoubm90aWZ5KGV2ZW50cy5zZXRWaXJ0dWFsUGFnZVF1ZXJ5LCBhcmdzKTtcbiAgICAgICAgaWYgKGFyZ3Muc2tpcFBhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKGdPYmouYWxsb3dQYWdpbmcgfHwgZ09iai5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCBnT2JqLmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSAmJiBza2lwUGFnZSAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgZ09iai5wYWdlU2V0dGluZ3MuY3VycmVudFBhZ2UgPSBNYXRoLm1heCgxLCBnT2JqLnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZSk7XG4gICAgICAgICAgICBpZiAoZ09iai5wYWdlU2V0dGluZ3MucGFnZUNvdW50IDw9IDApIHtcbiAgICAgICAgICAgICAgICBnT2JqLnBhZ2VTZXR0aW5ncy5wYWdlQ291bnQgPSA4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdPYmoucGFnZVNldHRpbmdzLnBhZ2VTaXplIDw9IDApIHtcbiAgICAgICAgICAgICAgICBnT2JqLnBhZ2VTZXR0aW5ncy5wYWdlU2l6ZSA9IDEyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHF1ZXJ5LnF1ZXJpZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWVyeS5xdWVyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChxdWVyeS5xdWVyaWVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVtcIlwiICsgZk5hbWVdID09PSAnb25QYWdlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkucXVlcmllcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGdPYmouaW5maW5pdGVTY3JvbGxNb2R1bGUpICYmIGdPYmouZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmluZmluaXRlUGFnZVF1ZXJ5LCBxdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBxdWVyeS5wYWdlKGdPYmoucGFnZVNldHRpbmdzLmN1cnJlbnRQYWdlLCBnT2JqLmFsbG93UGFnaW5nICYmIGdPYmoucGFnZXJNb2R1bGUgJiZcbiAgICAgICAgICAgICAgICAgICAgKGdPYmoucGFnZXJNb2R1bGUucGFnZXJPYmouaXNBbGxQYWdlICYmICFnT2JqLmlzTWFudWFsUmVmcmVzaCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKCF0aGlzLmRhdGFNYW5hZ2VyLmRhdGFTb3VyY2Uub2ZmbGluZSAmJiAhKHRoaXMuZGF0YU1hbmFnZXIuYWRhcHRvciBpbnN0YW5jZW9mIFJlbW90ZVNhdmVBZGFwdG9yKSkgP1xuICAgICAgICAgICAgICAgICAgICBudWxsIDogZ09iai5wYWdlU2V0dGluZ3MucGFnZVNpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBxdWVyeTtcbiAgICB9O1xuICAgIERhdGEucHJvdG90eXBlLmdyb3VwUXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKGdPYmouYWxsb3dHcm91cGluZyAmJiBnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgcXVlcnkubGF6eUxvYWQucHVzaCh7IGtleTogJ2lzTGF6eUxvYWQnLCB2YWx1ZTogdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb2x1bW5zID0gZ09iai5ncm91cFNldHRpbmdzLmNvbHVtbnM7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gY29sdW1ucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjb2x1bW4gPSB0aGlzLmdldENvbHVtbkJ5RmllbGQoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIGlmICghY29sdW1uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmxvZygnaW5pdGlhbF9hY3Rpb24nLCB7IG1vZHVsZU5hbWU6ICdncm91cCcsIGNvbHVtbk5hbWU6IGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgaXNHcnBGbXQgPSBjb2x1bW4uZW5hYmxlR3JvdXBCeUZvcm1hdDtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybWF0ID0gY29sdW1uLmZvcm1hdDtcbiAgICAgICAgICAgICAgICBpZiAoaXNHcnBGbXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnkuZ3JvdXAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHRoaXMuZm9ybWF0R3JvdXBDb2x1bW4uYmluZCh0aGlzKSwgZm9ybWF0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5Lmdyb3VwKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgIH07XG4gICAgRGF0YS5wcm90b3R5cGUuc29ydFF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmICgoZ09iai5hbGxvd1NvcnRpbmcgfHwgZ09iai5hbGxvd0dyb3VwaW5nKSAmJiBnT2JqLnNvcnRTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGNvbHVtbnMgPSBnT2JqLnNvcnRTZXR0aW5ncy5jb2x1bW5zO1xuICAgICAgICAgICAgdmFyIHNvcnRHcnAgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBjb2x1bW5zLmxlbmd0aCAtIDE7IGkgPiAtMTsgaS0tKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IHRoaXMuZ2V0Q29sdW1uQnlGaWVsZChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maWVsZCk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbCkge1xuICAgICAgICAgICAgICAgICAgICBjb2wuc2V0U29ydERpcmVjdGlvbihjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5kaXJlY3Rpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubG9nKCdpbml0aWFsX2FjdGlvbicsIHsgbW9kdWxlTmFtZTogJ3NvcnQnLCBjb2x1bW5OYW1lOiBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maWVsZCB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZm4gPSBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5kaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgaWYgKGNvbC5zb3J0Q29tcGFyZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubG9nKCdncmlkX3NvcnRfY29tcGFyZXInKTtcbiAgICAgICAgICAgICAgICAgICAgZm4gPSAhdGhpcy5pc1JlbW90ZSgpID8gY29sLnNvcnRDb21wYXJlci5iaW5kKGNvbCkgOiBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5kaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5pbmRleE9mKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbC5pc0ZvcmVpZ25Db2x1bW4oKSB8fCBjb2wuc29ydENvbXBhcmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeS5zb3J0QnlGb3JlaWduS2V5KGNvbC5maWVsZCwgZm4sIHVuZGVmaW5lZCwgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZGlyZWN0aW9uLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkuc29ydEJ5KGNvbC5maWVsZCwgZm4pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzb3J0R3JwLnB1c2goeyBkaXJlY3Rpb246IGZuLCBmaWVsZDogY29sLmZpZWxkIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBzb3J0R3JwLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzb3J0R3JwW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5kaXJlY3Rpb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5LnNvcnRCeShzb3J0R3JwW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maWVsZCwgc29ydEdycFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSB0aGlzLmdldENvbHVtbkJ5RmllbGQoc29ydEdycFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICBxdWVyeS5zb3J0QnlGb3JlaWduS2V5KHNvcnRHcnBbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkLCBzb3J0R3JwW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5kaXJlY3Rpb24sIHVuZGVmaW5lZCwgY29sLmdldFNvcnREaXJlY3Rpb24oKS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtRdWVyeX0gcXVlcnkgLSBzcGVjaWZpZXMgdGhlIHF1ZXJ5XG4gICAgICogQHBhcmFtIHtDb2x1bW59IGZjb2x1bW4gLSBzcGVjaWZpZXMgdGhlIGZvcmVpbiBrZXkgY29sdW1uIG1vZGVsXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0ZvcmVpZ25LZXkgLSBDb25maXJtcyB3aGV0aGVyIHRoZSBjb2x1bW4gaXMgYSBmb3JlaWduIGtleSBvciBub3RcbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IC0gcmV0dXJucyB0aGUgcXVlcnlcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgRGF0YS5wcm90b3R5cGUuc2VhcmNoUXVlcnkgPSBmdW5jdGlvbiAocXVlcnksIGZjb2x1bW4sIGlzRm9yZWlnbktleSkge1xuICAgICAgICB2YXIgc1NldHRpbmdzID0gdGhpcy5wYXJlbnQuc2VhcmNoU2V0dGluZ3M7XG4gICAgICAgIHZhciBmaWVsZHMgPSAoIWlzTnVsbE9yVW5kZWZpbmVkKHNTZXR0aW5ncy5maWVsZHMpICYmIHNTZXR0aW5ncy5maWVsZHMubGVuZ3RoKSA/IHNTZXR0aW5ncy5maWVsZHNcbiAgICAgICAgICAgIDogdGhpcy5nZXRTZWFyY2hDb2x1bW5GaWVsZE5hbWVzKCk7XG4gICAgICAgIHZhciBwcmVkaWNhdGVMaXN0ID0gW107XG4gICAgICAgIHZhciBuZWVkRm9yZWlnbktleVNlYXJjaCA9IGZhbHNlO1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LnNlYXJjaFNldHRpbmdzLmtleSkgJiYgdGhpcy5wYXJlbnQuc2VhcmNoU2V0dGluZ3Mua2V5Lmxlbmd0aCkge1xuICAgICAgICAgICAgbmVlZEZvcmVpZ25LZXlTZWFyY2ggPSB0aGlzLnBhcmVudC5nZXRGb3JlaWduS2V5Q29sdW1ucygpLnNvbWUoZnVuY3Rpb24gKGNvbCkgeyByZXR1cm4gZmllbGRzLmluZGV4T2YoY29sLmZpZWxkKSA+IC0xOyB9KTtcbiAgICAgICAgICAgIHZhciBhZGFwdG9yID0gIWlzRm9yZWlnbktleSA/IHRoaXMuZGF0YU1hbmFnZXIuYWRhcHRvciA6IGZjb2x1bW4uZGF0YVNvdXJjZS5hZGFwdG9yO1xuICAgICAgICAgICAgaWYgKG5lZWRGb3JlaWduS2V5U2VhcmNoIHx8IChhZGFwdG9yLmdldE1vZHVsZU5hbWUgJiZcbiAgICAgICAgICAgICAgICBhZGFwdG9yLmdldE1vZHVsZU5hbWUoKSA9PT0gJ09EYXRhVjRBZGFwdG9yJykpIHtcbiAgICAgICAgICAgICAgICBmaWVsZHMgPSBpc0ZvcmVpZ25LZXkgPyBbZmNvbHVtbi5mb3JlaWduS2V5VmFsdWVdIDogZmllbGRzO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2x1bW4gPSBpc0ZvcmVpZ25LZXkgPyBmY29sdW1uIDogdGhpcy5nZXRDb2x1bW5CeUZpZWxkKGZpZWxkc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sdW1uLmlzRm9yZWlnbkNvbHVtbigpICYmICFpc0ZvcmVpZ25LZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWRpY2F0ZUxpc3QgPSB0aGlzLmZHZW5lcmF0ZVByZWRpY2F0ZShjb2x1bW4sIHByZWRpY2F0ZUxpc3QpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJlZGljYXRlTGlzdC5wdXNoKG5ldyBQcmVkaWNhdGUoZmllbGRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgc1NldHRpbmdzLm9wZXJhdG9yLCBzU2V0dGluZ3Mua2V5LCBzU2V0dGluZ3MuaWdub3JlQ2FzZSwgc1NldHRpbmdzLmlnbm9yZUFjY2VudCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBwcmVkTGlzdCA9IFByZWRpY2F0ZS5vcihwcmVkaWNhdGVMaXN0KTtcbiAgICAgICAgICAgICAgICBwcmVkTGlzdC5rZXkgPSBzU2V0dGluZ3Mua2V5O1xuICAgICAgICAgICAgICAgIHF1ZXJ5LndoZXJlKHByZWRMaXN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHF1ZXJ5LnNlYXJjaChzU2V0dGluZ3Mua2V5LCBmaWVsZHMsIHNTZXR0aW5ncy5vcGVyYXRvciwgc1NldHRpbmdzLmlnbm9yZUNhc2UsIHNTZXR0aW5ncy5pZ25vcmVBY2NlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBxdWVyeTtcbiAgICB9O1xuICAgIERhdGEucHJvdG90eXBlLmZpbHRlclF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5LCBjb2x1bW4sIHNraXBGb2VyaWduKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciBwcmVkaWNhdGVMaXN0ID0gW107XG4gICAgICAgIHZhciBhY3R1YWxGaWx0ZXIgPSBbXTtcbiAgICAgICAgdmFyIGZvcmVpZ25Db2x1bW4gPSB0aGlzLnBhcmVudC5nZXRGb3JlaWduS2V5Q29sdW1ucygpO1xuICAgICAgICB2YXIgZm9yZWlnbkNvbEVtcHR5O1xuICAgICAgICBpZiAoZ09iai5hbGxvd0ZpbHRlcmluZyAmJiBnT2JqLmZpbHRlclNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1ucyA9IGNvbHVtbiA/IGNvbHVtbiA6IGdPYmouZmlsdGVyU2V0dGluZ3MuY29sdW1ucztcbiAgICAgICAgICAgIHZhciBjb2xUeXBlID0ge307XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gZ09iai5nZXRDb2x1bW5zKCk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICBjb2xUeXBlW2NvbC5maWVsZF0gPSBjb2wuZmlsdGVyLnR5cGUgPyBjb2wuZmlsdGVyLnR5cGUgOiBnT2JqLmZpbHRlclNldHRpbmdzLnR5cGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZm9yZWlnbkNvbHMgPSBbXTtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0Rmx0ckNvbHMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gMCwgY29sdW1uc18xID0gY29sdW1uczsgX2IgPCBjb2x1bW5zXzEubGVuZ3RoOyBfYisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbCA9IGNvbHVtbnNfMVtfYl07XG4gICAgICAgICAgICAgICAgdmFyIGdyaWRDb2x1bW4gPSBjb2wuaXNGb3JlaWduS2V5ID8gZ09iai5nZXRDb2x1bW5CeVVpZChjb2wudWlkKSA6IGdPYmouZ2V0Q29sdW1uQnlGaWVsZChjb2wuZmllbGQpO1xuICAgICAgICAgICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChjb2wudHlwZSkgJiYgZ3JpZENvbHVtbiAmJiAoZ3JpZENvbHVtbi50eXBlID09PSAnZGF0ZScgfHwgZ3JpZENvbHVtbi50eXBlID09PSAnZGF0ZXRpbWUnIHx8IGdyaWRDb2x1bW4udHlwZSA9PT0gJ2RhdGVvbmx5JykpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sLnR5cGUgPSBjb2wuaXNGb3JlaWduS2V5ID8gZ09iai5nZXRDb2x1bW5CeVVpZChjb2wudWlkKS50eXBlIDogZ09iai5nZXRDb2x1bW5CeUZpZWxkKGNvbC5maWVsZCkudHlwZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNvbC5pc0ZvcmVpZ25LZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yZWlnbkNvbHMucHVzaChjb2wpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdEZsdHJDb2xzLnB1c2goY29sKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGVmYXVsdEZsdHJDb2xzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBkZWZhdWx0Rmx0ckNvbHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdEZsdHJDb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS51aWQgPSBkZWZhdWx0Rmx0ckNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuZ3JhYkNvbHVtbkJ5RmllbGRGcm9tQWxsQ29scyhkZWZhdWx0Rmx0ckNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpZWxkLCBkZWZhdWx0Rmx0ckNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzRm9yZWlnbktleSkudWlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZXhjZWxQcmVkaWNhdGUgPSBDaGVja0JveEZpbHRlckJhc2UuZ2V0UHJlZGljYXRlKGRlZmF1bHRGbHRyQ29scyk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSAwLCBfZCA9IE9iamVjdC5rZXlzKGV4Y2VsUHJlZGljYXRlKTsgX2MgPCBfZC5sZW5ndGg7IF9jKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3AgPSBfZFtfY107XG4gICAgICAgICAgICAgICAgICAgIHByZWRpY2F0ZUxpc3QucHVzaChleGNlbFByZWRpY2F0ZVtcIlwiICsgcHJvcF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmb3JlaWduQ29scy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfZSA9IDAsIGZvcmVpZ25Db2xzXzEgPSBmb3JlaWduQ29sczsgX2UgPCBmb3JlaWduQ29sc18xLmxlbmd0aDsgX2UrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sID0gZm9yZWlnbkNvbHNfMVtfZV07XG4gICAgICAgICAgICAgICAgICAgIGNvbC51aWQgPSBjb2wudWlkIHx8IHRoaXMucGFyZW50LmdyYWJDb2x1bW5CeUZpZWxkRnJvbUFsbENvbHMoY29sLmZpZWxkLCBjb2wuaXNGb3JlaWduS2V5KS51aWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2x1bW5fMSA9IHRoaXMucGFyZW50LmdyYWJDb2x1bW5CeVVpZEZyb21BbGxDb2xzKGNvbC51aWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbHVtbl8xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5sb2coJ2luaXRpYWxfYWN0aW9uJywgeyBtb2R1bGVOYW1lOiAnZmlsdGVyJywgY29sdW1uTmFtZTogY29sLmZpZWxkIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2x1bW5fMS5pc0ZvcmVpZ25Db2x1bW4oKSAmJiBnZXRDb2x1bW5CeUZvcmVpZ25LZXlWYWx1ZShjb2wuZmllbGQsIGZvcmVpZ25Db2x1bW4pICYmICFza2lwRm9lcmlnbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0dWFsRmlsdGVyLnB1c2goY29sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY29sdW1uXzEuY29sdW1uRGF0YS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlaWduQ29sRW1wdHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlZGljYXRlTGlzdCA9IHRoaXMuZkdlbmVyYXRlUHJlZGljYXRlKGNvbHVtbl8xLCBwcmVkaWNhdGVMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleGNlbFByZWRpY2F0ZSA9IENoZWNrQm94RmlsdGVyQmFzZS5nZXRQcmVkaWNhdGUoY29sdW1ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfZiA9IDAsIF9nID0gT2JqZWN0LmtleXMoZXhjZWxQcmVkaWNhdGUpOyBfZiA8IF9nLmxlbmd0aDsgX2YrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9wID0gX2dbX2ZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWRpY2F0ZUxpc3QucHVzaChleGNlbFByZWRpY2F0ZVtcIlwiICsgcHJvcF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZUxpc3QubGVuZ3RoICYmICFmb3JlaWduQ29sRW1wdHkpIHtcbiAgICAgICAgICAgICAgICBxdWVyeS53aGVyZShQcmVkaWNhdGUuYW5kKHByZWRpY2F0ZUxpc3QpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMuc2hvd0VtcHR5R3JpZCwge30pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBxdWVyeTtcbiAgICB9O1xuICAgIERhdGEucHJvdG90eXBlLmZHZW5lcmF0ZVByZWRpY2F0ZSA9IGZ1bmN0aW9uIChjb2wsIHByZWRpY2F0ZUxpc3QpIHtcbiAgICAgICAgdmFyIGZQcmVkaWNhdGUgPSB7fTtcbiAgICAgICAgaWYgKGNvbCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5nZW5lcmF0ZVF1ZXJ5LCB7IHByZWRpY2F0ZTogZlByZWRpY2F0ZSwgY29sdW1uOiBjb2wgfSk7XG4gICAgICAgICAgICBpZiAoZlByZWRpY2F0ZS5wcmVkaWNhdGUucHJlZGljYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBwcmVkaWNhdGVMaXN0LnB1c2goZlByZWRpY2F0ZS5wcmVkaWNhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmVkaWNhdGVMaXN0O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIHVzZWQgdG8gZ2V0IGRhdGFNYW5hZ2VyIHByb21pc2UgYnkgZXhlY3V0aW5nIGdpdmVuIFF1ZXJ5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGFyZ3MgLSBzcGVjaWZpZXMgdGhlIG9iamVjdFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhcmdzLnJlcXVlc3RUeXBlIC0gRGVmaW5lcyB0aGUgcmVxdWVzdCB0eXBlXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gYXJncy5mb3JlaWduS2V5RGF0YSAtIERlZmluZXMgdGhlIGZvcmVpZ25LZXlEYXRhLnN0cmluZ1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhcmdzLmRhdGEgLSBEZWZpbmVzIHRoZSBkYXRhLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhcmdzLmluZGV4IC0gRGVmaW5lcyB0aGUgaW5kZXggLlxuICAgICAqIEBwYXJhbSB7UXVlcnl9IHF1ZXJ5IC0gRGVmaW5lcyB0aGUgcXVlcnkgd2hpY2ggd2lsbCBleGVjdXRlIGFsb25nIHdpdGggZGF0YSBwcm9jZXNzaW5nLlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdD59IC0gcmV0dXJucyB0aGUgb2JqZWN0XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIERhdGEucHJvdG90eXBlLmdldERhdGEgPSBmdW5jdGlvbiAoYXJncywgcXVlcnkpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKGFyZ3MgPT09IHZvaWQgMCkgeyBhcmdzID0geyByZXF1ZXN0VHlwZTogJycgfTsgfVxuICAgICAgICB2YXIga2V5ID0gdGhpcy5nZXRLZXkoYXJncy5mb3JlaWduS2V5RGF0YSAmJlxuICAgICAgICAgICAgT2JqZWN0LmtleXMoYXJncy5mb3JlaWduS2V5RGF0YSkubGVuZ3RoID9cbiAgICAgICAgICAgIGFyZ3MuZm9yZWlnbktleURhdGEgOiB0aGlzLnBhcmVudC5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpKTtcbiAgICAgICAgdGhpcy5wYXJlbnQubG9nKCdkYXRhc291cmNlX3N5bnRheF9taXNtYXRjaCcsIHsgZGF0YVN0YXRlOiB0aGlzLnBhcmVudCB9KTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmRhdGFTb3VyY2UgJiYgJ3Jlc3VsdCcgaW4gdGhpcy5wYXJlbnQuZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgdmFyIGRlZiA9IHRoaXMuZXZlbnRQcm9taXNlKGFyZ3MsIHF1ZXJ5LCBrZXkpO1xuICAgICAgICAgICAgcmV0dXJuIGRlZi5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGNydWQgPSB2b2lkIDA7XG4gICAgICAgICAgICBzd2l0Y2ggKGFyZ3MucmVxdWVzdFR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5ID8gcXVlcnkgOiB0aGlzLmdlbmVyYXRlUXVlcnkoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNhc2UtZGVjbGFyYXRpb25zXG4gICAgICAgICAgICAgICAgICAgIHZhciBsZW4gPSBPYmplY3Qua2V5cyhhcmdzLmRhdGEpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxlbiA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3J1ZCA9IHRoaXMuZGF0YU1hbmFnZXIucmVtb3ZlKGtleSwgYXJncy5kYXRhWzBdLCBxdWVyeS5mcm9tVGFibGUsIHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGFuZ2VzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZGVkUmVjb3JkczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlZFJlY29yZHM6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZWRSZWNvcmRzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZXMuZGVsZXRlZFJlY29yZHMgPSBhcmdzLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcnVkID0gdGhpcy5kYXRhTWFuYWdlci5zYXZlQ2hhbmdlcyhjaGFuZ2VzLCBrZXksIHF1ZXJ5LmZyb21UYWJsZSwgcXVlcnkucmVxdWlyZXNDb3VudCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzYXZlJzpcbiAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBxdWVyeSA/IHF1ZXJ5IDogdGhpcy5nZW5lcmF0ZVF1ZXJ5KCk7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3MuaW5kZXggPSBpc051bGxPclVuZGVmaW5lZChhcmdzLmluZGV4KSA/IDAgOiBhcmdzLmluZGV4O1xuICAgICAgICAgICAgICAgICAgICBjcnVkID0gdGhpcy5kYXRhTWFuYWdlci5pbnNlcnQoYXJncy5kYXRhLCBxdWVyeS5mcm9tVGFibGUsIHF1ZXJ5LCBhcmdzLmluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9ICdwcm9taXNlJztcbiAgICAgICAgICAgIGFyZ3NbXCJcIiArIHByb21pc2VdID0gY3J1ZDtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbiAgICAgICAgICAgIGlmIChjcnVkICYmICFBcnJheS5pc0FycmF5KGNydWQpICYmICFjcnVkLmhhc093blByb3BlcnR5KCdkZWxldGVkUmVjb3JkcycpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNydWQudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5pbnNlcnQocXVlcnksIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zZXJ0KHF1ZXJ5LCBhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRGF0YS5wcm90b3R5cGUuaW5zZXJ0ID0gZnVuY3Rpb24gKHF1ZXJ5LCBhcmdzKSB7XG4gICAgICAgIGlmIChhcmdzLnJlcXVlc3RUeXBlID09PSAnc2F2ZScpIHtcbiAgICAgICAgICAgIGFyZ3MucXVlcnkgPSBxdWVyeTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMucmVjb3JkQWRkZWQsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmV4ZWN1dGVRdWVyeShxdWVyeSk7XG4gICAgfTtcbiAgICBEYXRhLnByb3RvdHlwZS5leGVjdXRlUXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuZGF0YU1hbmFnZXIucmVhZHkpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZF8xID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgICAgICB2YXIgcmVhZHkgPSB0aGlzLmRhdGFNYW5hZ2VyLnJlYWR5O1xuICAgICAgICAgICAgcmVhZHkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuZGF0YU1hbmFnZXIuZXhlY3V0ZVF1ZXJ5KHF1ZXJ5KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWRfMS5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkXzEucmVqZWN0KGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWRfMS5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YU1hbmFnZXIuZXhlY3V0ZVF1ZXJ5KHF1ZXJ5KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRGF0YS5wcm90b3R5cGUuZm9ybWF0R3JvdXBDb2x1bW4gPSBmdW5jdGlvbiAodmFsdWUsIGZpZWxkKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlTG9jYXRvciA9IHRoaXMuc2VydmljZUxvY2F0b3I7XG4gICAgICAgIHZhciBjb2x1bW4gPSB0aGlzLmdldENvbHVtbkJ5RmllbGQoZmllbGQpO1xuICAgICAgICB2YXIgZGF0ZSA9IHZhbHVlO1xuICAgICAgICBpZiAoIWNvbHVtbi50eXBlKSB7XG4gICAgICAgICAgICBjb2x1bW4udHlwZSA9IGRhdGUuZ2V0RGF5ID8gKGRhdGUuZ2V0SG91cnMoKSA+IDAgfHwgZGF0ZS5nZXRNaW51dGVzKCkgPiAwIHx8XG4gICAgICAgICAgICAgICAgZGF0ZS5nZXRTZWNvbmRzKCkgPiAwIHx8IGRhdGUuZ2V0TWlsbGlzZWNvbmRzKCkgPiAwID8gJ2RhdGV0aW1lJyA6ICdkYXRlJykgOiB0eXBlb2YgKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLmdldEZvcm1hdHRlcigpKSkge1xuICAgICAgICAgICAgc2V0Rm9ybWF0dGVyKHNlcnZpY2VMb2NhdG9yLCBjb2x1bW4pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmb3JtYXRWYWwgPSBWYWx1ZUZvcm1hdHRlci5wcm90b3R5cGUudG9WaWV3KHZhbHVlLCBjb2x1bW4uZ2V0Rm9ybWF0dGVyKCkpO1xuICAgICAgICByZXR1cm4gZm9ybWF0VmFsO1xuICAgIH07XG4gICAgRGF0YS5wcm90b3R5cGUuY3J1ZEFjdGlvbnMgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICB2YXIgcXVlcnkgPSB0aGlzLmdlbmVyYXRlUXVlcnkoKTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBudWxsO1xuICAgICAgICB2YXIgcHIgPSAncHJvbWlzZSc7XG4gICAgICAgIHZhciBrZXkgPSB0aGlzLmdldEtleShhcmdzLmZvcmVpZ25LZXlEYXRhICYmXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhhcmdzLmZvcmVpZ25LZXlEYXRhKS5sZW5ndGggPyBhcmdzLmZvcmVpZ25LZXlEYXRhIDpcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmdldFByaW1hcnlLZXlGaWVsZE5hbWVzKCkpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZGF0YVNvdXJjZSAmJiAncmVzdWx0JyBpbiB0aGlzLnBhcmVudC5kYXRhU291cmNlKSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50UHJvbWlzZShhcmdzLCBxdWVyeSwga2V5KTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGFyZ3MucmVxdWVzdFR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NhdmUnOlxuICAgICAgICAgICAgICAgIHByb21pc2UgPSB0aGlzLmRhdGFNYW5hZ2VyLnVwZGF0ZShrZXksIGFyZ3MuZGF0YSwgcXVlcnkuZnJvbVRhYmxlLCBxdWVyeSwgYXJncy5wcmV2aW91c0RhdGEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGFyZ3NbXCJcIiArIHByXSA9IHByb21pc2UgPyBwcm9taXNlIDogYXJnc1tcIlwiICsgcHJdO1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmNydWRBY3Rpb24sIGFyZ3MpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGNoYW5nZXMgLSBzcGVjaWZpZXMgdGhlIGNoYW5nZXNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gc3BlY2lmaWVzIHRoZSBrZXlcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb3JpZ2luYWwgLSBzcGVjaWZpZXMgdGhlIG9yaWdpbmFsIGRhdGFcbiAgICAgKiBAcGFyYW0ge1F1ZXJ5fSBxdWVyeSAtIHNwZWNpZmllcyB0aGUgcXVlcnlcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxPYmplY3Q+fSByZXR1cm5zIHRoZSBvYmplY3RcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgRGF0YS5wcm90b3R5cGUuc2F2ZUNoYW5nZXMgPSBmdW5jdGlvbiAoY2hhbmdlcywga2V5LCBvcmlnaW5hbCwgcXVlcnkpIHtcbiAgICAgICAgaWYgKHF1ZXJ5ID09PSB2b2lkIDApIHsgcXVlcnkgPSB0aGlzLmdlbmVyYXRlUXVlcnkoKTsgfVxuICAgICAgICBxdWVyeS5yZXF1aXJlc0NvdW50KCk7XG4gICAgICAgIGlmICgncmVzdWx0JyBpbiB0aGlzLnBhcmVudC5kYXRhU291cmNlKSB7XG4gICAgICAgICAgICB2YXIgZGVmZiA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdFR5cGU6ICdiYXRjaHNhdmUnLCBjaGFuZ2VzOiBjaGFuZ2VzLCBrZXk6IGtleSwgcXVlcnk6IHF1ZXJ5LFxuICAgICAgICAgICAgICAgIGVuZEVkaXQ6IGRlZmYucmVzb2x2ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBpc1BlbmRpbmc6IHRydWUsIHJlc29sdmVyOiBkZWZmLnJlc29sdmUgfSk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5kYXRhU291cmNlQ2hhbmdlZCwgYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZi5wcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSB0aGlzLmRhdGFNYW5hZ2VyLnNhdmVDaGFuZ2VzKGNoYW5nZXMsIGtleSwgcXVlcnkuZnJvbVRhYmxlLCBxdWVyeSwgb3JpZ2luYWwpO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIERhdGEucHJvdG90eXBlLmdldEtleSA9IGZ1bmN0aW9uIChrZXlzKSB7XG4gICAgICAgIGlmIChrZXlzICYmIGtleXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4ga2V5c1swXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJldHVybnMgd2hldGhlciBpdHMgcmVtb3RlIGRhdGFcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgRGF0YS5wcm90b3R5cGUuaXNSZW1vdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFNYW5hZ2VyLmRhdGFTb3VyY2Uub2ZmbGluZSAhPT0gdHJ1ZSAmJiB0aGlzLmRhdGFNYW5hZ2VyLmRhdGFTb3VyY2UudXJsICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHRoaXMuZGF0YU1hbmFnZXIuZGF0YVNvdXJjZS51cmwgIT09ICcnO1xuICAgIH07XG4gICAgRGF0YS5wcm90b3R5cGUuYWRkUm93cyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBlLnJlY29yZHMubGVuZ3RoOyBpID4gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZGF0YVNvdXJjZSBpbnN0YW5jZW9mIERhdGFNYW5hZ2VyICYmIHRoaXMuZGF0YU1hbmFnZXIuZGF0YVNvdXJjZS5vZmZsaW5lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhTWFuYWdlci5kYXRhU291cmNlLmpzb24uc3BsaWNlKGUudG9JbmRleCwgMCwgZS5yZWNvcmRzW2kgLSAxXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICgoKCF0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSkgJiYgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5kYXRhU291cmNlKSkpICYmXG4gICAgICAgICAgICAgICAgKCF0aGlzLnBhcmVudC5kYXRhU291cmNlLnJlc3VsdCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5kYXRhU291cmNlWydzcGxpY2UnXShlLnRvSW5kZXgsIDAsIGUucmVjb3Jkc1tpIC0gMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBEYXRhLnByb3RvdHlwZS5yZW1vdmVSb3dzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIGpzb24gPSB0aGlzLmRhdGFNYW5hZ2VyLmRhdGFTb3VyY2UuanNvbjtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBEYXRhTWFuYWdlciAmJiB0aGlzLmRhdGFNYW5hZ2VyLmRhdGFTb3VyY2Uub2ZmbGluZSkge1xuICAgICAgICAgICAgdGhpcy5kYXRhTWFuYWdlci5kYXRhU291cmNlLmpzb24gPSBqc29uLmZpbHRlcihmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIGUucmVjb3Jkcy5pbmRleE9mKHZhbHVlKSA9PT0gLTE7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCgoIXRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpKSAmJiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpKSkgJiZcbiAgICAgICAgICAgICghdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5yZXN1bHQpKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5kYXRhU291cmNlID0ganNvbi5maWx0ZXIoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBlLnJlY29yZHMuaW5kZXhPZih2YWx1ZSkgPT09IC0xOyB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRGF0YS5wcm90b3R5cGUuZ2V0Q29sdW1uQnlGaWVsZCA9IGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgICB2YXIgY29sO1xuICAgICAgICByZXR1cm4gKHRoaXMucGFyZW50LmNvbHVtbk1vZGVsKS5zb21lKGZ1bmN0aW9uIChjb2x1bW4pIHtcbiAgICAgICAgICAgIGNvbCA9IGNvbHVtbjtcbiAgICAgICAgICAgIHJldHVybiBjb2x1bW4uZmllbGQgPT09IGZpZWxkO1xuICAgICAgICB9KSAmJiBjb2w7XG4gICAgfTtcbiAgICBEYXRhLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLnJvd3NBZGRlZCwgdGhpcy5hZGRSb3dzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5yb3dzUmVtb3ZlZCwgdGhpcy5yZW1vdmVSb3dzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5kYXRhU291cmNlTW9kaWZpZWQsIHRoaXMuaW5pdERhdGFNYW5hZ2VyKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5kZXN0cm95LCB0aGlzLmRlc3Ryb3kpO1xuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLnVwZGF0ZURhdGEsIHRoaXMuY3J1ZEFjdGlvbnMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLmFkZERlbGV0ZUFjdGlvbiwgdGhpcy5nZXREYXRhKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5hdXRvQ29sLCB0aGlzLnJlZnJlc2hGaWx0ZXJlZENvbHMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLmNvbHVtbnNQcmVwYXJlZCwgdGhpcy5yZWZyZXNoRmlsdGVyZWRDb2xzKTtcbiAgICB9O1xuICAgIERhdGEucHJvdG90eXBlLmdldFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RhdGU7XG4gICAgfTtcbiAgICBEYXRhLnByb3RvdHlwZS5zZXRTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU3RhdGUgPSBzdGF0ZTtcbiAgICB9O1xuICAgIERhdGEucHJvdG90eXBlLmdldEZvcmVpZ25LZXlEYXRhU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcmVpZ25LZXlEYXRhU3RhdGU7XG4gICAgfTtcbiAgICBEYXRhLnByb3RvdHlwZS5zZXRGb3JlaWduS2V5RGF0YVN0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgIHRoaXMuZm9yZWlnbktleURhdGFTdGF0ZSA9IHN0YXRlO1xuICAgIH07XG4gICAgRGF0YS5wcm90b3R5cGUuZ2V0U3RhdGVFdmVudEFyZ3VtZW50ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBhZGFwdHIgPSBuZXcgVXJsQWRhcHRvcigpO1xuICAgICAgICB2YXIgZG0gPSBuZXcgRGF0YU1hbmFnZXIoeyB1cmw6ICcnLCBhZGFwdG9yOiBuZXcgVXJsQWRhcHRvciB9KTtcbiAgICAgICAgdmFyIHN0YXRlID0gYWRhcHRyLnByb2Nlc3NRdWVyeShkbSwgcXVlcnkpO1xuICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2Uoc3RhdGUuZGF0YSk7XG4gICAgICAgIHJldHVybiBleHRlbmQoZGF0YSwgc3RhdGUucHZ0RGF0YSk7XG4gICAgfTtcbiAgICBEYXRhLnByb3RvdHlwZS5ldmVudFByb21pc2UgPSBmdW5jdGlvbiAoYXJncywgcXVlcnksIGtleSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZGF0YUFyZ3MgPSBhcmdzO1xuICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLmdldFN0YXRlRXZlbnRBcmd1bWVudChxdWVyeSk7XG4gICAgICAgIHZhciBkZWYgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgdmFyIGRlZmYgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgaWYgKChhcmdzLnJlcXVlc3RUeXBlICE9PSB1bmRlZmluZWQgfHwgKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuZGlzYWJsZVBhZ2VXaXNlQWdncmVnYXRlcyAmJiBxdWVyeS5xdWVyaWVzLnNvbWUoZnVuY3Rpb24gKHF1ZXJ5KSB7IHJldHVybiBxdWVyeS5mbiA9PT0gJ29uR3JvdXAnOyB9KSkpXG4gICAgICAgICAgICAmJiB0aGlzLmRhdGFTdGF0ZS5pc0RhdGFDaGFuZ2VkICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgc3RhdGUuYWN0aW9uID0gYXJncztcbiAgICAgICAgICAgIGlmIChhcmdzLnJlcXVlc3RUeXBlID09PSAnc2F2ZScgfHwgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2RlbGV0ZScgfHwgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2JhdGNoc2F2ZScpIHtcbiAgICAgICAgICAgICAgICB2YXIgZWRpdEFyZ3NfMSA9IGFyZ3M7XG4gICAgICAgICAgICAgICAgZWRpdEFyZ3NfMS5rZXkgPSBrZXk7XG4gICAgICAgICAgICAgICAgdmFyIHByb21pc2UgPSAncHJvbWlzZSc7XG4gICAgICAgICAgICAgICAgZWRpdEFyZ3NfMVtcIlwiICsgcHJvbWlzZV0gPSBkZWZmLnByb21pc2U7XG4gICAgICAgICAgICAgICAgZWRpdEFyZ3NfMS5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBpc1BlbmRpbmc6IHRydWUsIHJlc29sdmVyOiBkZWZmLnJlc29sdmUgfSk7XG4gICAgICAgICAgICAgICAgZGF0YUFyZ3MuZW5kRWRpdCA9IGRlZmYucmVzb2x2ZTtcbiAgICAgICAgICAgICAgICBkYXRhQXJncy5jYW5jZWxFZGl0ID0gZGVmZi5yZWplY3Q7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQudHJpZ2dlcihldmVudHMuZGF0YVNvdXJjZUNoYW5nZWQsIGVkaXRBcmdzXzEpO1xuICAgICAgICAgICAgICAgIGRlZmYucHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBpc1BlbmRpbmc6IHRydWUsIHJlc29sdmVyOiBkZWYucmVzb2x2ZSwgZ3JvdXA6IHN0YXRlLmdyb3VwLCBhZ2dyZWdhdGVzOiBzdGF0ZS5hZ2dyZWdhdGVzIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdEFyZ3NfMS5yZXF1ZXN0VHlwZSA9PT0gJ3NhdmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5yZWNvcmRBZGRlZCwgZWRpdEFyZ3NfMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmRhdGFTdGF0ZUNoYW5nZSwgc3RhdGUpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiB2b2lkIDA7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzUGVuZGluZzogdHJ1ZSwgcmVzb2x2ZXI6IGRlZi5yZXNvbHZlLCBncm91cDogc3RhdGUuZ3JvdXAsIGFnZ3JlZ2F0ZXM6IHN0YXRlLmFnZ3JlZ2F0ZXMgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQudHJpZ2dlcihldmVudHMuZGF0YVN0YXRlQ2hhbmdlLCBzdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHt9KTtcbiAgICAgICAgICAgIGRlZi5yZXNvbHZlKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWY7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb2x1bW5zIHdoZXJlIHNlYXJjaGluZyBuZWVkcyB0byBiZSBwZXJmb3JtZWQgZnJvbSB0aGUgR3JpZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmdbXX0gcmV0dXJucyB0aGUgc2VhcmNoZWQgY29sdW1uIGZpZWxkIG5hbWVzXG4gICAgICovXG4gICAgRGF0YS5wcm90b3R5cGUuZ2V0U2VhcmNoQ29sdW1uRmllbGROYW1lcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbEZpZWxkTmFtZXMgPSBbXTtcbiAgICAgICAgdmFyIGNvbHVtbnMgPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgY29sdW1uc18yID0gY29sdW1uczsgX2kgPCBjb2x1bW5zXzIubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgY29sID0gY29sdW1uc18yW19pXTtcbiAgICAgICAgICAgIGlmIChjb2wuYWxsb3dTZWFyY2hpbmcgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKGNvbC5maWVsZCkpIHtcbiAgICAgICAgICAgICAgICBjb2xGaWVsZE5hbWVzLnB1c2goY29sLmZpZWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29sRmllbGROYW1lcztcbiAgICB9O1xuICAgIERhdGEucHJvdG90eXBlLnJlZnJlc2hGaWx0ZXJlZENvbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd0ZpbHRlcmluZyAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmVmcmVzaEZpbHRlcmVkQ29sc1VpZCh0aGlzLnBhcmVudCwgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuY29sdW1ucyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBEYXRhO1xufSgpKTtcbmV4cG9ydCB7IERhdGEgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/data.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/logger.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/logger.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Logger: () => (/* binding */ Logger),\n/* harmony export */   detailLists: () => (/* binding */ detailLists)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/util.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/manager.js\");\n/**\n *\n * `Logger` class\n */\n\n\nvar BASE_DOC_URL = 'https://ej2.syncfusion.com/documentation/grid';\nvar DOC_URL = 'https://ej2.syncfusion.com/documentation/';\nvar WARNING = '[EJ2Grid.Warning]';\nvar ERROR = '[EJ2Grid.Error]';\nvar INFO = '[EJ2Grid.Info]';\nvar Logger = /** @class */ (function () {\n    function Logger(parent) {\n        this.parent = parent;\n        this.parent.on('initial-end', this.patchadaptor, this);\n    }\n    Logger.prototype.getModuleName = function () {\n        return 'logger';\n    };\n    Logger.prototype.log = function (types, args) {\n        if (!(types instanceof Array)) {\n            types = [types];\n        }\n        var type = types;\n        for (var i = 0; i < type.length; i++) {\n            var item = detailLists[type[parseInt(i.toString(), 10)]];\n            var cOp = item.check(args, this.parent);\n            if (cOp.success) {\n                // eslint-disable-next-line no-console\n                console[item.logType](item.generateMessage(args, this.parent, cOp.options));\n            }\n        }\n    };\n    Logger.prototype.patchadaptor = function () {\n        var adaptor = this.parent.getDataModule().dataManager.adaptor;\n        var original = adaptor.beforeSend;\n        if (original) {\n            adaptor.beforeSend = function (dm, request, settings) {\n                original.call(adaptor, dm, request, settings);\n            };\n        }\n    };\n    Logger.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off('initial-end', this.patchadaptor);\n    };\n    return Logger;\n}());\n\nvar detailLists = {\n    // eslint-disable-next-line camelcase\n    module_missing: {\n        type: 'module_missing',\n        logType: 'warn',\n        check: function (args, parent) {\n            var injected = parent.getInjectedModules().map(function (m) { return m.prototype.getModuleName(); });\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var modules = parent.requiredModules().map(function (m) { return m.member; })\n                .filter(function (name) { return injected.indexOf(name) === -1; });\n            return { success: modules.filter(function (m) { return m !== 'resize'; }).length > 0, options: modules };\n        },\n        generateMessage: function (args, parent, modules) {\n            modules = modules.filter(function (m) { return m !== 'resize'; })\n                .reduce(function (prev, cur) { return prev + (\"* \" + cur + \"\\n\"); }, '');\n            return WARNING + ': MODULES MISSING\\n' + 'The following modules are not injected:.\\n' +\n                (\"\" + modules) +\n                (\"Refer to \" + BASE_DOC_URL + \"/module.html for documentation on importing feature modules.\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    promise_enabled: {\n        type: 'promise_enabled',\n        logType: 'error',\n        check: function () {\n            return { success: typeof Promise === 'undefined' };\n        },\n        generateMessage: function () {\n            return ERROR + ': PROMISE UNDEFINED\\n' +\n                'Promise object is not present in the global environment,' +\n                'please use polyfil to support Promise object in your environment.\\n' +\n                (\"Refer to \" + DOC_URL + \"/base/browser.html?#required-polyfills for more information.\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    primary_column_missing: {\n        type: 'primary_column_missing',\n        logType: 'warn',\n        check: function (args, parent) {\n            return { success: parent.enableColumnVirtualization\n                    ? parent.getPrimaryKeyFieldNames().length === 0\n                    : parent.getColumns().filter(function (column) { return column.isPrimaryKey; }).length === 0 };\n        },\n        generateMessage: function () {\n            return WARNING + ': PRIMARY KEY MISSING\\n' + 'Editing is enabled but primary key column is not specified.\\n' +\n                (\"Refer to \" + BASE_DOC_URL + \"/api-column.html?#isprimarykey for documentation on providing primary key columns.\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    selection_key_missing: {\n        type: 'selection_key_missing',\n        logType: 'warn',\n        check: function (args, parent) {\n            return { success: parent.selectionSettings.persistSelection &&\n                    parent.getColumns().filter(function (column) { return column.isPrimaryKey; }).length === 0 };\n        },\n        generateMessage: function () {\n            return WARNING + ': PRIMARY KEY MISSING\\n' +\n                'selectionSettings.persistSelection property is enabled. It requires one primary key column to persist selection.\\n' +\n                (\"Refer to \" + BASE_DOC_URL + \"/api-column.html?#isprimarykey for documentation on providing primary key columns.\");\n        }\n    },\n    actionfailure: {\n        type: 'actionfailure',\n        logType: 'error',\n        check: function () {\n            return { success: true };\n        },\n        generateMessage: function (args, parent) {\n            var message = '';\n            var formatError = formatErrorHandler(args, parent);\n            var ajaxError = ajaxErrorHandler(args, parent);\n            if (ajaxError !== '') {\n                message = ajaxError;\n            }\n            else if (formatError !== '') {\n                message = formatError;\n            }\n            else {\n                message = args.error;\n            }\n            return WARNING + ': ' + message;\n        }\n    },\n    // eslint-disable-next-line camelcase\n    locale_missing: {\n        type: 'locale_missing',\n        logType: 'warn',\n        check: function (args, parent) {\n            var lObj = _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.DataUtil.getObject(\"locale.\" + parent.locale + \".grid\", _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.L10n);\n            return { success: parent.locale !== 'en-US' && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(lObj) };\n        },\n        generateMessage: function (args, parent) {\n            return WARNING + ': LOCALE CONFIG MISSING\\n' + (\"Locale configuration for '\" + parent.locale + \"' is not provided.\\n\") +\n                (\"Refer to \" + BASE_DOC_URL + \"/globalization-and-localization.html?#localization \\n             for documentation on setting locale configuration.\");\n        }\n    },\n    limitation: {\n        type: 'limitation',\n        logType: 'warn',\n        check: function (args, parent) {\n            var name = args;\n            var opt;\n            switch (name) {\n                case 'freeze':\n                    opt = {\n                        success: !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(parent.detailTemplate) || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(parent.childGrid),\n                        options: { name: 'freeze' }\n                    };\n                    break;\n                case 'virtualization':\n                    opt = {\n                        success: !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(parent.detailTemplate) || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(parent.childGrid),\n                        options: { name: 'virtualization' }\n                    };\n                    break;\n                default:\n                    opt = { success: false };\n                    break;\n            }\n            return opt;\n        },\n        generateMessage: function (args, parent, options) {\n            var name = options.name;\n            var opt;\n            switch (name) {\n                case 'freeze':\n                    opt = 'Frozen rows and columns do not support the following features:\\n' +\n                        '* Details Template\\n' +\n                        '* Hierarchy Grid\\n';\n                    break;\n                case 'virtualization':\n                    opt = 'Virtualization does not support the following features.\\n' +\n                        '* Details Template.\\n' +\n                        '* Hierarchy Grid.\\n';\n                    break;\n                default:\n                    opt = '';\n                    break;\n            }\n            return WARNING + (\": \" + name.toUpperCase() + \" LIMITATIONS\\n\") + opt;\n        }\n    },\n    // eslint-disable-next-line camelcase\n    check_datasource_columns: {\n        type: 'check_datasource_columns',\n        logType: 'warn',\n        check: function (args, parent) {\n            return { success: !(parent.columns.length ||\n                    (parent.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.DataManager) ||\n                    (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(parent.dataSource) && parent.dataSource.length)) };\n        },\n        generateMessage: function () {\n            return WARNING + ': GRID CONFIG MISSING\\n' + 'dataSource and columns are not provided in the grid. ' +\n                'At least one of either must be provided for grid configuration.\\n' +\n                (\"Refer to \" + BASE_DOC_URL + \"/columns.html for documentation on configuring the grid data and columns.\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    virtual_height: {\n        type: 'virtual_height',\n        logType: 'error',\n        check: function (args, parent) {\n            return { success: (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(parent.height) || parent.height === 'auto' };\n        },\n        generateMessage: function () {\n            return ERROR + ': GRID HEIGHT MISSING \\n' + 'height property is required to use virtualization.\\n' +\n                (\"Refer to \" + BASE_DOC_URL + \"/virtual.html for documentation on configuring the virtual grid.\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    grid_remote_edit: {\n        type: 'grid_remote_edit',\n        logType: 'error',\n        check: function (args) {\n            return { success: Array.isArray(args) || Array.isArray(args.result) };\n        },\n        generateMessage: function () {\n            return ERROR + ': RETRUN VALUE MISSING  \\n' +\n                'Remote service returns invalid data. \\n' +\n                (\"Refer to \" + BASE_DOC_URL + \"/edit.html for documentation on configuring editing with remote data.\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    grid_sort_comparer: {\n        type: 'grid_sort_comparer',\n        logType: 'warn',\n        check: function (args, parent) {\n            return { success: parent.getDataModule().isRemote() };\n        },\n        generateMessage: function () {\n            return WARNING + ': SORT COMPARER NOT WORKING  \\n' + 'Sort comparer will not work with remote data.' +\n                (\"Refer to \" + BASE_DOC_URL + \"/sorting/#custom-sort-comparer for documentation on using the sort comparer.\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    resize_min_max: {\n        type: 'resize_min_max',\n        logType: 'info',\n        check: function (args) {\n            return { success: (args.column.minWidth && args.column.minWidth >= args.width) ||\n                    (args.column.maxWidth && args.column.maxWidth <= args.width) };\n        },\n        generateMessage: function () {\n            return INFO + ': RESIZING COLUMN REACHED MIN OR MAX  \\n' + 'The column resizing width is at its min or max.';\n        }\n    },\n    // eslint-disable-next-line camelcase\n    action_disabled_column: {\n        type: 'action_disabled_column',\n        logType: 'info',\n        check: function (args) {\n            var success = true;\n            var fn;\n            switch (args.moduleName) {\n                case 'reorder':\n                    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.destColumn)) {\n                        fn = \"reordering action is disabled for the \" + args.column.headerText + \" column\";\n                    }\n                    else {\n                        fn = \"reordering action is disabled for the \" + (args.column.allowReordering ?\n                            args.destColumn.headerText : args.column.headerText) + \" column\";\n                    }\n                    break;\n                case 'group':\n                    fn = \"grouping action is disabled for the \" + args.columnName + \" column.\";\n                    break;\n                case 'filter':\n                    fn = \"filtering action is disabled for the \" + args.columnName + \" column.\";\n                    break;\n                case 'sort':\n                    fn = \"sorting action is disabled for the \" + args.columnName + \" column.\";\n                    break;\n            }\n            return { success: success, options: { fn: fn } };\n        },\n        generateMessage: function (args, parent, options) {\n            return INFO + (\": ACTION DISABLED \\n \" + options.fn);\n        }\n    },\n    // eslint-disable-next-line camelcase\n    exporting_begin: {\n        type: 'exporting_begin',\n        logType: 'info',\n        check: function (args) {\n            return { success: true, options: { args: args } };\n        },\n        generateMessage: function (args, parent, options) {\n            return INFO + (\": EXPORTING INPROGRESS \\n Grid \" + options.args + \"ing is in progress\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    exporting_complete: {\n        type: 'exporting_complete',\n        logType: 'info',\n        check: function (args) {\n            return { success: true, options: { args: args } };\n        },\n        generateMessage: function (args, parent, options) {\n            return INFO + (\": EXPORTING COMPLETED \\n Grid \" + options.args + \"ing is complete\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    foreign_key_failure: {\n        type: 'foreign_key_failure',\n        logType: 'error',\n        check: function () {\n            return { success: true };\n        },\n        generateMessage: function () {\n            return ERROR + ': FOREIGNKEY CONFIG \\n  Grid foreign key column needs a valid data source/service.' +\n                (\"Refer to \" + BASE_DOC_URL + \"/columns/#foreign-key-column for documentation on configuring foreign key columns.\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    initial_action: {\n        type: 'initial_action',\n        logType: 'error',\n        check: function (args) {\n            var success = true;\n            var fn;\n            switch (args.moduleName) {\n                case 'group':\n                    fn = \"The \" + args.columnName + \" column is not available in the grid's column model.\" +\n                        'Please provide a valid field name to group the column';\n                    break;\n                case 'filter':\n                    fn = \"The \" + args.columnName + \" column is not available in the grid's column model.\" +\n                        'Please provide a valid field name to filter the column.';\n                    break;\n                case 'sort':\n                    fn = \"The \" + args.columnName + \" column is not available in the grid's column model.\" +\n                        'Please provide a valid field name to sort the column.';\n                    break;\n            }\n            return { success: success, options: { fn: fn } };\n        },\n        generateMessage: function (args, parent, options) {\n            return ERROR + (\": INITIAL ACTION FAILURE \\n \" + options.fn);\n        }\n    },\n    // eslint-disable-next-line camelcase\n    frozen_rows_columns: {\n        type: 'frozen_rows_columns',\n        logType: 'error',\n        check: function (args, parent) {\n            return { success: parent.getColumns().length <= parent.frozenColumns\n                    || (parent.currentViewData.length && parent.frozenRows >= parent.currentViewData.length) };\n        },\n        generateMessage: function (args, parent) {\n            return ERROR + (\": OUT OF RANGE ERROR-\\n \" + (parent.getColumns().length <= parent.frozenColumns ? 'FROZEN COLUMNS,' : '')) +\n                ((parent.frozenRows >= parent.currentViewData.length ? 'FROZEN ROWS' : '') + \" invalid\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    column_type_missing: {\n        type: 'column_type_missing',\n        logType: 'error',\n        check: function (args) {\n            return { success: (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.column.type), options: args.column.headerText };\n        },\n        generateMessage: function (args, parent, options) {\n            return ERROR + (\": COLUMN TYPE MISSING-\\n  \" + options + \" column type was invalid or not defined.\") +\n                (\"Please go through below help link: \" + DOC_URL + \"/grid/columns/#column-type\");\n        }\n    },\n    // eslint-disable-next-line camelcase\n    datasource_syntax_mismatch: {\n        type: 'datasource_syntax_mismatch',\n        logType: 'warn',\n        check: function (args) {\n            return { success: args.dataState.dataSource && !(args.dataState.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_2__.DataManager ||\n                    'result' in args.dataState.dataSource || args.dataState.dataSource instanceof Array) &&\n                    !((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.dataState.dataStateChange)) };\n        },\n        generateMessage: function () {\n            return WARNING + ': DATASOURCE SYNTAX WARNING\\n' +\n                'DataSource should be in the form of {result: Object[], count: number}' +\n                'when dataStateChangeEvent used';\n        }\n    }\n};\nvar formatErrorHandler = function (args) {\n    var error = args.error;\n    if (error.indexOf && error.indexOf('Format options') !== 0) {\n        return '';\n    }\n    return 'INVALID FORMAT\\n' +\n        'For more information, refer to the following documentation links:\\n' +\n        (\"Number format: \" + DOC_URL + \"/common/internationalization#supported-format-string\\n\") +\n        (\"Date format: \" + DOC_URL + \"/common/internationalization#manipulating-datetime\\n\") +\n        (\"Message: \" + error);\n};\nvar ajaxErrorHandler = function (args) {\n    var error = _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.DataUtil.getObject('error.error', args);\n    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(error)) {\n        return '';\n    }\n    var jsonResult = '';\n    try {\n        jsonResult = JSON.parse(error.responseText);\n    }\n    catch (_a) {\n        jsonResult = '';\n    }\n    return 'XMLHTTPREQUEST FAILED\\n' +\n        (\"Url: \" + error.responseURL + \"\\n\") +\n        (\"Status: \" + error.status + \" - \" + error.statusText + \"\\n\") +\n        (\"\" + (jsonResult !== '' ? 'Message: ' + jsonResult : ''));\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL2xvZ2dlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQzRFO0FBQ2Y7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlCQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ2lCO0FBQ1g7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEVBQTBFLHFDQUFxQztBQUMvRztBQUNBLHNFQUFzRSxrQkFBa0I7QUFDeEYsMENBQTBDLHVDQUF1QztBQUNqRixxQkFBcUIsdUNBQXVDLHdCQUF3QjtBQUNwRixTQUFTO0FBQ1Q7QUFDQSxvREFBb0Qsd0JBQXdCO0FBQzVFLCtDQUErQyxvQ0FBb0M7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxxRUFBcUUsNkJBQTZCO0FBQ2xHLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLG1FQUFtRSw2QkFBNkI7QUFDaEcs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QyxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw2RUFBNkUsNkRBQVc7QUFDN0c7QUFDQSxzQkFBc0IsdUVBQWlCO0FBQ3ZDLFNBQVM7QUFDVDtBQUNBO0FBQ0Esc0RBQXNELGdDQUFnQztBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwwREFBUTtBQUN4QixRQUFRLHVFQUFpQjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvYWN0aW9ucy9sb2dnZXIuanM/NDUxYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqXG4gKiBgTG9nZ2VyYCBjbGFzc1xuICovXG5pbXBvcnQgeyBpc051bGxPclVuZGVmaW5lZCwgTDEwbiwgaXNVbmRlZmluZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBEYXRhVXRpbCwgRGF0YU1hbmFnZXIgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItZGF0YSc7XG52YXIgQkFTRV9ET0NfVVJMID0gJ2h0dHBzOi8vZWoyLnN5bmNmdXNpb24uY29tL2RvY3VtZW50YXRpb24vZ3JpZCc7XG52YXIgRE9DX1VSTCA9ICdodHRwczovL2VqMi5zeW5jZnVzaW9uLmNvbS9kb2N1bWVudGF0aW9uLyc7XG52YXIgV0FSTklORyA9ICdbRUoyR3JpZC5XYXJuaW5nXSc7XG52YXIgRVJST1IgPSAnW0VKMkdyaWQuRXJyb3JdJztcbnZhciBJTkZPID0gJ1tFSjJHcmlkLkluZm9dJztcbnZhciBMb2dnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTG9nZ2VyKHBhcmVudCkge1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5wYXJlbnQub24oJ2luaXRpYWwtZW5kJywgdGhpcy5wYXRjaGFkYXB0b3IsIHRoaXMpO1xuICAgIH1cbiAgICBMb2dnZXIucHJvdG90eXBlLmdldE1vZHVsZU5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnbG9nZ2VyJztcbiAgICB9O1xuICAgIExvZ2dlci5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKHR5cGVzLCBhcmdzKSB7XG4gICAgICAgIGlmICghKHR5cGVzIGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICAgICAgICB0eXBlcyA9IFt0eXBlc107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHR5cGUgPSB0eXBlcztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0eXBlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGRldGFpbExpc3RzW3R5cGVbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXTtcbiAgICAgICAgICAgIHZhciBjT3AgPSBpdGVtLmNoZWNrKGFyZ3MsIHRoaXMucGFyZW50KTtcbiAgICAgICAgICAgIGlmIChjT3Auc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgY29uc29sZVtpdGVtLmxvZ1R5cGVdKGl0ZW0uZ2VuZXJhdGVNZXNzYWdlKGFyZ3MsIHRoaXMucGFyZW50LCBjT3Aub3B0aW9ucykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBMb2dnZXIucHJvdG90eXBlLnBhdGNoYWRhcHRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFkYXB0b3IgPSB0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuZGF0YU1hbmFnZXIuYWRhcHRvcjtcbiAgICAgICAgdmFyIG9yaWdpbmFsID0gYWRhcHRvci5iZWZvcmVTZW5kO1xuICAgICAgICBpZiAob3JpZ2luYWwpIHtcbiAgICAgICAgICAgIGFkYXB0b3IuYmVmb3JlU2VuZCA9IGZ1bmN0aW9uIChkbSwgcmVxdWVzdCwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbC5jYWxsKGFkYXB0b3IsIGRtLCByZXF1ZXN0LCBzZXR0aW5ncyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMb2dnZXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyZW50Lm9mZignaW5pdGlhbC1lbmQnLCB0aGlzLnBhdGNoYWRhcHRvcik7XG4gICAgfTtcbiAgICByZXR1cm4gTG9nZ2VyO1xufSgpKTtcbmV4cG9ydCB7IExvZ2dlciB9O1xuZXhwb3J0IHZhciBkZXRhaWxMaXN0cyA9IHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgbW9kdWxlX21pc3Npbmc6IHtcbiAgICAgICAgdHlwZTogJ21vZHVsZV9taXNzaW5nJyxcbiAgICAgICAgbG9nVHlwZTogJ3dhcm4nLFxuICAgICAgICBjaGVjazogZnVuY3Rpb24gKGFyZ3MsIHBhcmVudCkge1xuICAgICAgICAgICAgdmFyIGluamVjdGVkID0gcGFyZW50LmdldEluamVjdGVkTW9kdWxlcygpLm1hcChmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5wcm90b3R5cGUuZ2V0TW9kdWxlTmFtZSgpOyB9KTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB2YXIgbW9kdWxlcyA9IHBhcmVudC5yZXF1aXJlZE1vZHVsZXMoKS5tYXAoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0ubWVtYmVyOyB9KVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIGluamVjdGVkLmluZGV4T2YobmFtZSkgPT09IC0xOyB9KTtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IG1vZHVsZXMuZmlsdGVyKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtICE9PSAncmVzaXplJzsgfSkubGVuZ3RoID4gMCwgb3B0aW9uczogbW9kdWxlcyB9O1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZU1lc3NhZ2U6IGZ1bmN0aW9uIChhcmdzLCBwYXJlbnQsIG1vZHVsZXMpIHtcbiAgICAgICAgICAgIG1vZHVsZXMgPSBtb2R1bGVzLmZpbHRlcihmdW5jdGlvbiAobSkgeyByZXR1cm4gbSAhPT0gJ3Jlc2l6ZSc7IH0pXG4gICAgICAgICAgICAgICAgLnJlZHVjZShmdW5jdGlvbiAocHJldiwgY3VyKSB7IHJldHVybiBwcmV2ICsgKFwiKiBcIiArIGN1ciArIFwiXFxuXCIpOyB9LCAnJyk7XG4gICAgICAgICAgICByZXR1cm4gV0FSTklORyArICc6IE1PRFVMRVMgTUlTU0lOR1xcbicgKyAnVGhlIGZvbGxvd2luZyBtb2R1bGVzIGFyZSBub3QgaW5qZWN0ZWQ6LlxcbicgK1xuICAgICAgICAgICAgICAgIChcIlwiICsgbW9kdWxlcykgK1xuICAgICAgICAgICAgICAgIChcIlJlZmVyIHRvIFwiICsgQkFTRV9ET0NfVVJMICsgXCIvbW9kdWxlLmh0bWwgZm9yIGRvY3VtZW50YXRpb24gb24gaW1wb3J0aW5nIGZlYXR1cmUgbW9kdWxlcy5cIik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgICBwcm9taXNlX2VuYWJsZWQ6IHtcbiAgICAgICAgdHlwZTogJ3Byb21pc2VfZW5hYmxlZCcsXG4gICAgICAgIGxvZ1R5cGU6ICdlcnJvcicsXG4gICAgICAgIGNoZWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0eXBlb2YgUHJvbWlzZSA9PT0gJ3VuZGVmaW5lZCcgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2VuZXJhdGVNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gRVJST1IgKyAnOiBQUk9NSVNFIFVOREVGSU5FRFxcbicgK1xuICAgICAgICAgICAgICAgICdQcm9taXNlIG9iamVjdCBpcyBub3QgcHJlc2VudCBpbiB0aGUgZ2xvYmFsIGVudmlyb25tZW50LCcgK1xuICAgICAgICAgICAgICAgICdwbGVhc2UgdXNlIHBvbHlmaWwgdG8gc3VwcG9ydCBQcm9taXNlIG9iamVjdCBpbiB5b3VyIGVudmlyb25tZW50LlxcbicgK1xuICAgICAgICAgICAgICAgIChcIlJlZmVyIHRvIFwiICsgRE9DX1VSTCArIFwiL2Jhc2UvYnJvd3Nlci5odG1sPyNyZXF1aXJlZC1wb2x5ZmlsbHMgZm9yIG1vcmUgaW5mb3JtYXRpb24uXCIpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgcHJpbWFyeV9jb2x1bW5fbWlzc2luZzoge1xuICAgICAgICB0eXBlOiAncHJpbWFyeV9jb2x1bW5fbWlzc2luZycsXG4gICAgICAgIGxvZ1R5cGU6ICd3YXJuJyxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uIChhcmdzLCBwYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvblxuICAgICAgICAgICAgICAgICAgICA/IHBhcmVudC5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpLmxlbmd0aCA9PT0gMFxuICAgICAgICAgICAgICAgICAgICA6IHBhcmVudC5nZXRDb2x1bW5zKCkuZmlsdGVyKGZ1bmN0aW9uIChjb2x1bW4pIHsgcmV0dXJuIGNvbHVtbi5pc1ByaW1hcnlLZXk7IH0pLmxlbmd0aCA9PT0gMCB9O1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZU1lc3NhZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBXQVJOSU5HICsgJzogUFJJTUFSWSBLRVkgTUlTU0lOR1xcbicgKyAnRWRpdGluZyBpcyBlbmFibGVkIGJ1dCBwcmltYXJ5IGtleSBjb2x1bW4gaXMgbm90IHNwZWNpZmllZC5cXG4nICtcbiAgICAgICAgICAgICAgICAoXCJSZWZlciB0byBcIiArIEJBU0VfRE9DX1VSTCArIFwiL2FwaS1jb2x1bW4uaHRtbD8jaXNwcmltYXJ5a2V5IGZvciBkb2N1bWVudGF0aW9uIG9uIHByb3ZpZGluZyBwcmltYXJ5IGtleSBjb2x1bW5zLlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIHNlbGVjdGlvbl9rZXlfbWlzc2luZzoge1xuICAgICAgICB0eXBlOiAnc2VsZWN0aW9uX2tleV9taXNzaW5nJyxcbiAgICAgICAgbG9nVHlwZTogJ3dhcm4nLFxuICAgICAgICBjaGVjazogZnVuY3Rpb24gKGFyZ3MsIHBhcmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogcGFyZW50LnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LmdldENvbHVtbnMoKS5maWx0ZXIoZnVuY3Rpb24gKGNvbHVtbikgeyByZXR1cm4gY29sdW1uLmlzUHJpbWFyeUtleTsgfSkubGVuZ3RoID09PSAwIH07XG4gICAgICAgIH0sXG4gICAgICAgIGdlbmVyYXRlTWVzc2FnZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIFdBUk5JTkcgKyAnOiBQUklNQVJZIEtFWSBNSVNTSU5HXFxuJyArXG4gICAgICAgICAgICAgICAgJ3NlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24gcHJvcGVydHkgaXMgZW5hYmxlZC4gSXQgcmVxdWlyZXMgb25lIHByaW1hcnkga2V5IGNvbHVtbiB0byBwZXJzaXN0IHNlbGVjdGlvbi5cXG4nICtcbiAgICAgICAgICAgICAgICAoXCJSZWZlciB0byBcIiArIEJBU0VfRE9DX1VSTCArIFwiL2FwaS1jb2x1bW4uaHRtbD8jaXNwcmltYXJ5a2V5IGZvciBkb2N1bWVudGF0aW9uIG9uIHByb3ZpZGluZyBwcmltYXJ5IGtleSBjb2x1bW5zLlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgYWN0aW9uZmFpbHVyZToge1xuICAgICAgICB0eXBlOiAnYWN0aW9uZmFpbHVyZScsXG4gICAgICAgIGxvZ1R5cGU6ICdlcnJvcicsXG4gICAgICAgIGNoZWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XG4gICAgICAgIH0sXG4gICAgICAgIGdlbmVyYXRlTWVzc2FnZTogZnVuY3Rpb24gKGFyZ3MsIHBhcmVudCkge1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSAnJztcbiAgICAgICAgICAgIHZhciBmb3JtYXRFcnJvciA9IGZvcm1hdEVycm9ySGFuZGxlcihhcmdzLCBwYXJlbnQpO1xuICAgICAgICAgICAgdmFyIGFqYXhFcnJvciA9IGFqYXhFcnJvckhhbmRsZXIoYXJncywgcGFyZW50KTtcbiAgICAgICAgICAgIGlmIChhamF4RXJyb3IgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IGFqYXhFcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGZvcm1hdEVycm9yICE9PSAnJykge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBmb3JtYXRFcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBhcmdzLmVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFdBUk5JTkcgKyAnOiAnICsgbWVzc2FnZTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIGxvY2FsZV9taXNzaW5nOiB7XG4gICAgICAgIHR5cGU6ICdsb2NhbGVfbWlzc2luZycsXG4gICAgICAgIGxvZ1R5cGU6ICd3YXJuJyxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uIChhcmdzLCBwYXJlbnQpIHtcbiAgICAgICAgICAgIHZhciBsT2JqID0gRGF0YVV0aWwuZ2V0T2JqZWN0KFwibG9jYWxlLlwiICsgcGFyZW50LmxvY2FsZSArIFwiLmdyaWRcIiwgTDEwbik7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBwYXJlbnQubG9jYWxlICE9PSAnZW4tVVMnICYmIGlzTnVsbE9yVW5kZWZpbmVkKGxPYmopIH07XG4gICAgICAgIH0sXG4gICAgICAgIGdlbmVyYXRlTWVzc2FnZTogZnVuY3Rpb24gKGFyZ3MsIHBhcmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIFdBUk5JTkcgKyAnOiBMT0NBTEUgQ09ORklHIE1JU1NJTkdcXG4nICsgKFwiTG9jYWxlIGNvbmZpZ3VyYXRpb24gZm9yICdcIiArIHBhcmVudC5sb2NhbGUgKyBcIicgaXMgbm90IHByb3ZpZGVkLlxcblwiKSArXG4gICAgICAgICAgICAgICAgKFwiUmVmZXIgdG8gXCIgKyBCQVNFX0RPQ19VUkwgKyBcIi9nbG9iYWxpemF0aW9uLWFuZC1sb2NhbGl6YXRpb24uaHRtbD8jbG9jYWxpemF0aW9uIFxcbiAgICAgICAgICAgICBmb3IgZG9jdW1lbnRhdGlvbiBvbiBzZXR0aW5nIGxvY2FsZSBjb25maWd1cmF0aW9uLlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgbGltaXRhdGlvbjoge1xuICAgICAgICB0eXBlOiAnbGltaXRhdGlvbicsXG4gICAgICAgIGxvZ1R5cGU6ICd3YXJuJyxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uIChhcmdzLCBwYXJlbnQpIHtcbiAgICAgICAgICAgIHZhciBuYW1lID0gYXJncztcbiAgICAgICAgICAgIHZhciBvcHQ7XG4gICAgICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdmcmVlemUnOlxuICAgICAgICAgICAgICAgICAgICBvcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiAhaXNVbmRlZmluZWQocGFyZW50LmRldGFpbFRlbXBsYXRlKSB8fCAhaXNVbmRlZmluZWQocGFyZW50LmNoaWxkR3JpZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7IG5hbWU6ICdmcmVlemUnIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAndmlydHVhbGl6YXRpb24nOlxuICAgICAgICAgICAgICAgICAgICBvcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiAhaXNVbmRlZmluZWQocGFyZW50LmRldGFpbFRlbXBsYXRlKSB8fCAhaXNVbmRlZmluZWQocGFyZW50LmNoaWxkR3JpZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7IG5hbWU6ICd2aXJ0dWFsaXphdGlvbicgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBvcHQgPSB7IHN1Y2Nlc3M6IGZhbHNlIH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG9wdDtcbiAgICAgICAgfSxcbiAgICAgICAgZ2VuZXJhdGVNZXNzYWdlOiBmdW5jdGlvbiAoYXJncywgcGFyZW50LCBvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgICAgIHZhciBvcHQ7XG4gICAgICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdmcmVlemUnOlxuICAgICAgICAgICAgICAgICAgICBvcHQgPSAnRnJvemVuIHJvd3MgYW5kIGNvbHVtbnMgZG8gbm90IHN1cHBvcnQgdGhlIGZvbGxvd2luZyBmZWF0dXJlczpcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICcqIERldGFpbHMgVGVtcGxhdGVcXG4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICcqIEhpZXJhcmNoeSBHcmlkXFxuJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAndmlydHVhbGl6YXRpb24nOlxuICAgICAgICAgICAgICAgICAgICBvcHQgPSAnVmlydHVhbGl6YXRpb24gZG9lcyBub3Qgc3VwcG9ydCB0aGUgZm9sbG93aW5nIGZlYXR1cmVzLlxcbicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJyogRGV0YWlscyBUZW1wbGF0ZS5cXG4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICcqIEhpZXJhcmNoeSBHcmlkLlxcbic7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIG9wdCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBXQVJOSU5HICsgKFwiOiBcIiArIG5hbWUudG9VcHBlckNhc2UoKSArIFwiIExJTUlUQVRJT05TXFxuXCIpICsgb3B0O1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgY2hlY2tfZGF0YXNvdXJjZV9jb2x1bW5zOiB7XG4gICAgICAgIHR5cGU6ICdjaGVja19kYXRhc291cmNlX2NvbHVtbnMnLFxuICAgICAgICBsb2dUeXBlOiAnd2FybicsXG4gICAgICAgIGNoZWNrOiBmdW5jdGlvbiAoYXJncywgcGFyZW50KSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiAhKHBhcmVudC5jb2x1bW5zLmxlbmd0aCB8fFxuICAgICAgICAgICAgICAgICAgICAocGFyZW50LmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBEYXRhTWFuYWdlcikgfHxcbiAgICAgICAgICAgICAgICAgICAgKCFpc051bGxPclVuZGVmaW5lZChwYXJlbnQuZGF0YVNvdXJjZSkgJiYgcGFyZW50LmRhdGFTb3VyY2UubGVuZ3RoKSkgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2VuZXJhdGVNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gV0FSTklORyArICc6IEdSSUQgQ09ORklHIE1JU1NJTkdcXG4nICsgJ2RhdGFTb3VyY2UgYW5kIGNvbHVtbnMgYXJlIG5vdCBwcm92aWRlZCBpbiB0aGUgZ3JpZC4gJyArXG4gICAgICAgICAgICAgICAgJ0F0IGxlYXN0IG9uZSBvZiBlaXRoZXIgbXVzdCBiZSBwcm92aWRlZCBmb3IgZ3JpZCBjb25maWd1cmF0aW9uLlxcbicgK1xuICAgICAgICAgICAgICAgIChcIlJlZmVyIHRvIFwiICsgQkFTRV9ET0NfVVJMICsgXCIvY29sdW1ucy5odG1sIGZvciBkb2N1bWVudGF0aW9uIG9uIGNvbmZpZ3VyaW5nIHRoZSBncmlkIGRhdGEgYW5kIGNvbHVtbnMuXCIpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgdmlydHVhbF9oZWlnaHQ6IHtcbiAgICAgICAgdHlwZTogJ3ZpcnR1YWxfaGVpZ2h0JyxcbiAgICAgICAgbG9nVHlwZTogJ2Vycm9yJyxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uIChhcmdzLCBwYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGlzTnVsbE9yVW5kZWZpbmVkKHBhcmVudC5oZWlnaHQpIHx8IHBhcmVudC5oZWlnaHQgPT09ICdhdXRvJyB9O1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZU1lc3NhZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBFUlJPUiArICc6IEdSSUQgSEVJR0hUIE1JU1NJTkcgXFxuJyArICdoZWlnaHQgcHJvcGVydHkgaXMgcmVxdWlyZWQgdG8gdXNlIHZpcnR1YWxpemF0aW9uLlxcbicgK1xuICAgICAgICAgICAgICAgIChcIlJlZmVyIHRvIFwiICsgQkFTRV9ET0NfVVJMICsgXCIvdmlydHVhbC5odG1sIGZvciBkb2N1bWVudGF0aW9uIG9uIGNvbmZpZ3VyaW5nIHRoZSB2aXJ0dWFsIGdyaWQuXCIpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgZ3JpZF9yZW1vdGVfZWRpdDoge1xuICAgICAgICB0eXBlOiAnZ3JpZF9yZW1vdGVfZWRpdCcsXG4gICAgICAgIGxvZ1R5cGU6ICdlcnJvcicsXG4gICAgICAgIGNoZWNrOiBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogQXJyYXkuaXNBcnJheShhcmdzKSB8fCBBcnJheS5pc0FycmF5KGFyZ3MucmVzdWx0KSB9O1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZU1lc3NhZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBFUlJPUiArICc6IFJFVFJVTiBWQUxVRSBNSVNTSU5HICBcXG4nICtcbiAgICAgICAgICAgICAgICAnUmVtb3RlIHNlcnZpY2UgcmV0dXJucyBpbnZhbGlkIGRhdGEuIFxcbicgK1xuICAgICAgICAgICAgICAgIChcIlJlZmVyIHRvIFwiICsgQkFTRV9ET0NfVVJMICsgXCIvZWRpdC5odG1sIGZvciBkb2N1bWVudGF0aW9uIG9uIGNvbmZpZ3VyaW5nIGVkaXRpbmcgd2l0aCByZW1vdGUgZGF0YS5cIik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgICBncmlkX3NvcnRfY29tcGFyZXI6IHtcbiAgICAgICAgdHlwZTogJ2dyaWRfc29ydF9jb21wYXJlcicsXG4gICAgICAgIGxvZ1R5cGU6ICd3YXJuJyxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uIChhcmdzLCBwYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSB9O1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZU1lc3NhZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBXQVJOSU5HICsgJzogU09SVCBDT01QQVJFUiBOT1QgV09SS0lORyAgXFxuJyArICdTb3J0IGNvbXBhcmVyIHdpbGwgbm90IHdvcmsgd2l0aCByZW1vdGUgZGF0YS4nICtcbiAgICAgICAgICAgICAgICAoXCJSZWZlciB0byBcIiArIEJBU0VfRE9DX1VSTCArIFwiL3NvcnRpbmcvI2N1c3RvbS1zb3J0LWNvbXBhcmVyIGZvciBkb2N1bWVudGF0aW9uIG9uIHVzaW5nIHRoZSBzb3J0IGNvbXBhcmVyLlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIHJlc2l6ZV9taW5fbWF4OiB7XG4gICAgICAgIHR5cGU6ICdyZXNpemVfbWluX21heCcsXG4gICAgICAgIGxvZ1R5cGU6ICdpbmZvJyxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiAoYXJncy5jb2x1bW4ubWluV2lkdGggJiYgYXJncy5jb2x1bW4ubWluV2lkdGggPj0gYXJncy53aWR0aCkgfHxcbiAgICAgICAgICAgICAgICAgICAgKGFyZ3MuY29sdW1uLm1heFdpZHRoICYmIGFyZ3MuY29sdW1uLm1heFdpZHRoIDw9IGFyZ3Mud2lkdGgpIH07XG4gICAgICAgIH0sXG4gICAgICAgIGdlbmVyYXRlTWVzc2FnZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIElORk8gKyAnOiBSRVNJWklORyBDT0xVTU4gUkVBQ0hFRCBNSU4gT1IgTUFYICBcXG4nICsgJ1RoZSBjb2x1bW4gcmVzaXppbmcgd2lkdGggaXMgYXQgaXRzIG1pbiBvciBtYXguJztcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIGFjdGlvbl9kaXNhYmxlZF9jb2x1bW46IHtcbiAgICAgICAgdHlwZTogJ2FjdGlvbl9kaXNhYmxlZF9jb2x1bW4nLFxuICAgICAgICBsb2dUeXBlOiAnaW5mbycsXG4gICAgICAgIGNoZWNrOiBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGZuO1xuICAgICAgICAgICAgc3dpdGNoIChhcmdzLm1vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdyZW9yZGVyJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGFyZ3MuZGVzdENvbHVtbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZuID0gXCJyZW9yZGVyaW5nIGFjdGlvbiBpcyBkaXNhYmxlZCBmb3IgdGhlIFwiICsgYXJncy5jb2x1bW4uaGVhZGVyVGV4dCArIFwiIGNvbHVtblwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm4gPSBcInJlb3JkZXJpbmcgYWN0aW9uIGlzIGRpc2FibGVkIGZvciB0aGUgXCIgKyAoYXJncy5jb2x1bW4uYWxsb3dSZW9yZGVyaW5nID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLmRlc3RDb2x1bW4uaGVhZGVyVGV4dCA6IGFyZ3MuY29sdW1uLmhlYWRlclRleHQpICsgXCIgY29sdW1uXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZ3JvdXAnOlxuICAgICAgICAgICAgICAgICAgICBmbiA9IFwiZ3JvdXBpbmcgYWN0aW9uIGlzIGRpc2FibGVkIGZvciB0aGUgXCIgKyBhcmdzLmNvbHVtbk5hbWUgKyBcIiBjb2x1bW4uXCI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2ZpbHRlcic6XG4gICAgICAgICAgICAgICAgICAgIGZuID0gXCJmaWx0ZXJpbmcgYWN0aW9uIGlzIGRpc2FibGVkIGZvciB0aGUgXCIgKyBhcmdzLmNvbHVtbk5hbWUgKyBcIiBjb2x1bW4uXCI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3NvcnQnOlxuICAgICAgICAgICAgICAgICAgICBmbiA9IFwic29ydGluZyBhY3Rpb24gaXMgZGlzYWJsZWQgZm9yIHRoZSBcIiArIGFyZ3MuY29sdW1uTmFtZSArIFwiIGNvbHVtbi5cIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBzdWNjZXNzLCBvcHRpb25zOiB7IGZuOiBmbiB9IH07XG4gICAgICAgIH0sXG4gICAgICAgIGdlbmVyYXRlTWVzc2FnZTogZnVuY3Rpb24gKGFyZ3MsIHBhcmVudCwgb3B0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuIElORk8gKyAoXCI6IEFDVElPTiBESVNBQkxFRCBcXG4gXCIgKyBvcHRpb25zLmZuKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIGV4cG9ydGluZ19iZWdpbjoge1xuICAgICAgICB0eXBlOiAnZXhwb3J0aW5nX2JlZ2luJyxcbiAgICAgICAgbG9nVHlwZTogJ2luZm8nLFxuICAgICAgICBjaGVjazogZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIG9wdGlvbnM6IHsgYXJnczogYXJncyB9IH07XG4gICAgICAgIH0sXG4gICAgICAgIGdlbmVyYXRlTWVzc2FnZTogZnVuY3Rpb24gKGFyZ3MsIHBhcmVudCwgb3B0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuIElORk8gKyAoXCI6IEVYUE9SVElORyBJTlBST0dSRVNTIFxcbiBHcmlkIFwiICsgb3B0aW9ucy5hcmdzICsgXCJpbmcgaXMgaW4gcHJvZ3Jlc3NcIik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgICBleHBvcnRpbmdfY29tcGxldGU6IHtcbiAgICAgICAgdHlwZTogJ2V4cG9ydGluZ19jb21wbGV0ZScsXG4gICAgICAgIGxvZ1R5cGU6ICdpbmZvJyxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBvcHRpb25zOiB7IGFyZ3M6IGFyZ3MgfSB9O1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZU1lc3NhZ2U6IGZ1bmN0aW9uIChhcmdzLCBwYXJlbnQsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHJldHVybiBJTkZPICsgKFwiOiBFWFBPUlRJTkcgQ09NUExFVEVEIFxcbiBHcmlkIFwiICsgb3B0aW9ucy5hcmdzICsgXCJpbmcgaXMgY29tcGxldGVcIik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgICBmb3JlaWduX2tleV9mYWlsdXJlOiB7XG4gICAgICAgIHR5cGU6ICdmb3JlaWduX2tleV9mYWlsdXJlJyxcbiAgICAgICAgbG9nVHlwZTogJ2Vycm9yJyxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2VuZXJhdGVNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gRVJST1IgKyAnOiBGT1JFSUdOS0VZIENPTkZJRyBcXG4gIEdyaWQgZm9yZWlnbiBrZXkgY29sdW1uIG5lZWRzIGEgdmFsaWQgZGF0YSBzb3VyY2Uvc2VydmljZS4nICtcbiAgICAgICAgICAgICAgICAoXCJSZWZlciB0byBcIiArIEJBU0VfRE9DX1VSTCArIFwiL2NvbHVtbnMvI2ZvcmVpZ24ta2V5LWNvbHVtbiBmb3IgZG9jdW1lbnRhdGlvbiBvbiBjb25maWd1cmluZyBmb3JlaWduIGtleSBjb2x1bW5zLlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIGluaXRpYWxfYWN0aW9uOiB7XG4gICAgICAgIHR5cGU6ICdpbml0aWFsX2FjdGlvbicsXG4gICAgICAgIGxvZ1R5cGU6ICdlcnJvcicsXG4gICAgICAgIGNoZWNrOiBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGZuO1xuICAgICAgICAgICAgc3dpdGNoIChhcmdzLm1vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdncm91cCc6XG4gICAgICAgICAgICAgICAgICAgIGZuID0gXCJUaGUgXCIgKyBhcmdzLmNvbHVtbk5hbWUgKyBcIiBjb2x1bW4gaXMgbm90IGF2YWlsYWJsZSBpbiB0aGUgZ3JpZCdzIGNvbHVtbiBtb2RlbC5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAnUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBmaWVsZCBuYW1lIHRvIGdyb3VwIHRoZSBjb2x1bW4nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdmaWx0ZXInOlxuICAgICAgICAgICAgICAgICAgICBmbiA9IFwiVGhlIFwiICsgYXJncy5jb2x1bW5OYW1lICsgXCIgY29sdW1uIGlzIG5vdCBhdmFpbGFibGUgaW4gdGhlIGdyaWQncyBjb2x1bW4gbW9kZWwuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1BsZWFzZSBwcm92aWRlIGEgdmFsaWQgZmllbGQgbmFtZSB0byBmaWx0ZXIgdGhlIGNvbHVtbi4nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgZm4gPSBcIlRoZSBcIiArIGFyZ3MuY29sdW1uTmFtZSArIFwiIGNvbHVtbiBpcyBub3QgYXZhaWxhYmxlIGluIHRoZSBncmlkJ3MgY29sdW1uIG1vZGVsLlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdQbGVhc2UgcHJvdmlkZSBhIHZhbGlkIGZpZWxkIG5hbWUgdG8gc29ydCB0aGUgY29sdW1uLic7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2Vzczogc3VjY2Vzcywgb3B0aW9uczogeyBmbjogZm4gfSB9O1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZU1lc3NhZ2U6IGZ1bmN0aW9uIChhcmdzLCBwYXJlbnQsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHJldHVybiBFUlJPUiArIChcIjogSU5JVElBTCBBQ1RJT04gRkFJTFVSRSBcXG4gXCIgKyBvcHRpb25zLmZuKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIGZyb3plbl9yb3dzX2NvbHVtbnM6IHtcbiAgICAgICAgdHlwZTogJ2Zyb3plbl9yb3dzX2NvbHVtbnMnLFxuICAgICAgICBsb2dUeXBlOiAnZXJyb3InLFxuICAgICAgICBjaGVjazogZnVuY3Rpb24gKGFyZ3MsIHBhcmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogcGFyZW50LmdldENvbHVtbnMoKS5sZW5ndGggPD0gcGFyZW50LmZyb3plbkNvbHVtbnNcbiAgICAgICAgICAgICAgICAgICAgfHwgKHBhcmVudC5jdXJyZW50Vmlld0RhdGEubGVuZ3RoICYmIHBhcmVudC5mcm96ZW5Sb3dzID49IHBhcmVudC5jdXJyZW50Vmlld0RhdGEubGVuZ3RoKSB9O1xuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZU1lc3NhZ2U6IGZ1bmN0aW9uIChhcmdzLCBwYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBFUlJPUiArIChcIjogT1VUIE9GIFJBTkdFIEVSUk9SLVxcbiBcIiArIChwYXJlbnQuZ2V0Q29sdW1ucygpLmxlbmd0aCA8PSBwYXJlbnQuZnJvemVuQ29sdW1ucyA/ICdGUk9aRU4gQ09MVU1OUywnIDogJycpKSArXG4gICAgICAgICAgICAgICAgKChwYXJlbnQuZnJvemVuUm93cyA+PSBwYXJlbnQuY3VycmVudFZpZXdEYXRhLmxlbmd0aCA/ICdGUk9aRU4gUk9XUycgOiAnJykgKyBcIiBpbnZhbGlkXCIpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgY29sdW1uX3R5cGVfbWlzc2luZzoge1xuICAgICAgICB0eXBlOiAnY29sdW1uX3R5cGVfbWlzc2luZycsXG4gICAgICAgIGxvZ1R5cGU6ICdlcnJvcicsXG4gICAgICAgIGNoZWNrOiBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogaXNOdWxsT3JVbmRlZmluZWQoYXJncy5jb2x1bW4udHlwZSksIG9wdGlvbnM6IGFyZ3MuY29sdW1uLmhlYWRlclRleHQgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2VuZXJhdGVNZXNzYWdlOiBmdW5jdGlvbiAoYXJncywgcGFyZW50LCBvcHRpb25zKSB7XG4gICAgICAgICAgICByZXR1cm4gRVJST1IgKyAoXCI6IENPTFVNTiBUWVBFIE1JU1NJTkctXFxuICBcIiArIG9wdGlvbnMgKyBcIiBjb2x1bW4gdHlwZSB3YXMgaW52YWxpZCBvciBub3QgZGVmaW5lZC5cIikgK1xuICAgICAgICAgICAgICAgIChcIlBsZWFzZSBnbyB0aHJvdWdoIGJlbG93IGhlbHAgbGluazogXCIgKyBET0NfVVJMICsgXCIvZ3JpZC9jb2x1bW5zLyNjb2x1bW4tdHlwZVwiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgIGRhdGFzb3VyY2Vfc3ludGF4X21pc21hdGNoOiB7XG4gICAgICAgIHR5cGU6ICdkYXRhc291cmNlX3N5bnRheF9taXNtYXRjaCcsXG4gICAgICAgIGxvZ1R5cGU6ICd3YXJuJyxcbiAgICAgICAgY2hlY2s6IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBhcmdzLmRhdGFTdGF0ZS5kYXRhU291cmNlICYmICEoYXJncy5kYXRhU3RhdGUuZGF0YVNvdXJjZSBpbnN0YW5jZW9mIERhdGFNYW5hZ2VyIHx8XG4gICAgICAgICAgICAgICAgICAgICdyZXN1bHQnIGluIGFyZ3MuZGF0YVN0YXRlLmRhdGFTb3VyY2UgfHwgYXJncy5kYXRhU3RhdGUuZGF0YVNvdXJjZSBpbnN0YW5jZW9mIEFycmF5KSAmJlxuICAgICAgICAgICAgICAgICAgICAhKGlzTnVsbE9yVW5kZWZpbmVkKGFyZ3MuZGF0YVN0YXRlLmRhdGFTdGF0ZUNoYW5nZSkpIH07XG4gICAgICAgIH0sXG4gICAgICAgIGdlbmVyYXRlTWVzc2FnZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIFdBUk5JTkcgKyAnOiBEQVRBU09VUkNFIFNZTlRBWCBXQVJOSU5HXFxuJyArXG4gICAgICAgICAgICAgICAgJ0RhdGFTb3VyY2Ugc2hvdWxkIGJlIGluIHRoZSBmb3JtIG9mIHtyZXN1bHQ6IE9iamVjdFtdLCBjb3VudDogbnVtYmVyfScgK1xuICAgICAgICAgICAgICAgICd3aGVuIGRhdGFTdGF0ZUNoYW5nZUV2ZW50IHVzZWQnO1xuICAgICAgICB9XG4gICAgfVxufTtcbnZhciBmb3JtYXRFcnJvckhhbmRsZXIgPSBmdW5jdGlvbiAoYXJncykge1xuICAgIHZhciBlcnJvciA9IGFyZ3MuZXJyb3I7XG4gICAgaWYgKGVycm9yLmluZGV4T2YgJiYgZXJyb3IuaW5kZXhPZignRm9ybWF0IG9wdGlvbnMnKSAhPT0gMCkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHJldHVybiAnSU5WQUxJRCBGT1JNQVRcXG4nICtcbiAgICAgICAgJ0ZvciBtb3JlIGluZm9ybWF0aW9uLCByZWZlciB0byB0aGUgZm9sbG93aW5nIGRvY3VtZW50YXRpb24gbGlua3M6XFxuJyArXG4gICAgICAgIChcIk51bWJlciBmb3JtYXQ6IFwiICsgRE9DX1VSTCArIFwiL2NvbW1vbi9pbnRlcm5hdGlvbmFsaXphdGlvbiNzdXBwb3J0ZWQtZm9ybWF0LXN0cmluZ1xcblwiKSArXG4gICAgICAgIChcIkRhdGUgZm9ybWF0OiBcIiArIERPQ19VUkwgKyBcIi9jb21tb24vaW50ZXJuYXRpb25hbGl6YXRpb24jbWFuaXB1bGF0aW5nLWRhdGV0aW1lXFxuXCIpICtcbiAgICAgICAgKFwiTWVzc2FnZTogXCIgKyBlcnJvcik7XG59O1xudmFyIGFqYXhFcnJvckhhbmRsZXIgPSBmdW5jdGlvbiAoYXJncykge1xuICAgIHZhciBlcnJvciA9IERhdGFVdGlsLmdldE9iamVjdCgnZXJyb3IuZXJyb3InLCBhcmdzKTtcbiAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoZXJyb3IpKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgdmFyIGpzb25SZXN1bHQgPSAnJztcbiAgICB0cnkge1xuICAgICAgICBqc29uUmVzdWx0ID0gSlNPTi5wYXJzZShlcnJvci5yZXNwb25zZVRleHQpO1xuICAgIH1cbiAgICBjYXRjaCAoX2EpIHtcbiAgICAgICAganNvblJlc3VsdCA9ICcnO1xuICAgIH1cbiAgICByZXR1cm4gJ1hNTEhUVFBSRVFVRVNUIEZBSUxFRFxcbicgK1xuICAgICAgICAoXCJVcmw6IFwiICsgZXJyb3IucmVzcG9uc2VVUkwgKyBcIlxcblwiKSArXG4gICAgICAgIChcIlN0YXR1czogXCIgKyBlcnJvci5zdGF0dXMgKyBcIiAtIFwiICsgZXJyb3Iuc3RhdHVzVGV4dCArIFwiXFxuXCIpICtcbiAgICAgICAgKFwiXCIgKyAoanNvblJlc3VsdCAhPT0gJycgPyAnTWVzc2FnZTogJyArIGpzb25SZXN1bHQgOiAnJykpO1xufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/logger.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/print.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/print.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Print: () => (/* binding */ Print),\n/* harmony export */   getCloneProperties: () => (/* binding */ getCloneProperties)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_grid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/grid */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/grid.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/manager.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n/**\n * @returns {string[]} returns the cloned property\n * @hidden\n */\nfunction getCloneProperties() {\n    return ['aggregates', 'allowGrouping', 'allowFiltering', 'allowMultiSorting', 'allowReordering', 'allowSorting',\n        'allowTextWrap', 'childGrid', 'columns', 'currentViewData', 'dataSource', 'detailTemplate', 'enableAltRow',\n        'enableColumnVirtualization', 'filterSettings', 'gridLines',\n        'groupSettings', 'height', 'locale', 'pageSettings', 'printMode', 'query', 'queryString', 'enableRtl',\n        'rowHeight', 'rowTemplate', 'sortSettings', 'textWrapSettings', 'allowPaging', 'hierarchyPrintMode', 'searchSettings',\n        'queryCellInfo', 'beforeDataBound', 'enableHtmlSanitizer'];\n}\n/**\n *\n * The `Print` module is used to handle print action.\n */\nvar Print = /** @class */ (function () {\n    /**\n     * Constructor for the Grid print module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {Scroll} scrollModule - specifies the scroll module\n     * @hidden\n     */\n    function Print(parent, scrollModule) {\n        this.isAsyncPrint = false;\n        this.defered = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Deferred();\n        this.parent = parent;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.contentReady, this.isContentReady(), this);\n        this.actionBeginFunction = this.actionBegin.bind(this);\n        this.parent.addEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_2__.actionBegin, this.actionBeginFunction);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.onEmpty, this.onEmpty.bind(this));\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.hierarchyPrint, this.hierarchyPrint, this);\n        this.scrollModule = scrollModule;\n    }\n    Print.prototype.isContentReady = function () {\n        var _this = this;\n        if (this.isPrintGrid() && (this.parent.hierarchyPrintMode === 'None' || !this.parent.childGrid)) {\n            return this.contentReady;\n        }\n        return function () {\n            _this.defered.promise.then(function () {\n                _this.contentReady();\n            });\n            if (_this.isPrintGrid()) {\n                _this.hierarchyPrint();\n            }\n        };\n    };\n    Print.prototype.hierarchyPrint = function () {\n        this.removeColGroup(this.parent);\n        var printGridObj = window.printGridObj;\n        if (printGridObj && !printGridObj.element.querySelector('[aria-busy=true')) {\n            printGridObj.printModule.defered.resolve();\n        }\n    };\n    /**\n     * By default, prints all the Grid pages and hides the pager.\n     * > You can customize print options using the\n     * [`printMode`](./printmode/).\n     *\n     * @returns {void}\n     */\n    Print.prototype.print = function () {\n        this.renderPrintGrid();\n    };\n    Print.prototype.onEmpty = function () {\n        if (this.isPrintGrid()) {\n            this.contentReady();\n        }\n    };\n    Print.prototype.actionBegin = function () {\n        if (this.isPrintGrid()) {\n            this.isAsyncPrint = true;\n        }\n    };\n    Print.prototype.renderPrintGrid = function () {\n        var gObj = this.parent;\n        var element = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            id: this.parent.element.id + '_print', className: gObj.element.className + ' e-print-grid'\n        });\n        element.classList.remove('e-gridhover');\n        document.body.appendChild(element);\n        var printGrid = new _base_grid__WEBPACK_IMPORTED_MODULE_3__.Grid((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.getPrintGridModel)(gObj, gObj.hierarchyPrintMode));\n        for (var i = 0; i < printGrid.columns.length; i++) {\n            printGrid.columns[parseInt(i.toString(), 10)] = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, printGrid.columns[parseInt(i.toString(), 10)]);\n            if (!gObj.getFrozenColumns() && gObj.isFrozenGrid()) {\n                printGrid.columns[parseInt(i.toString(), 10)].freeze = undefined;\n            }\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (this.parent.isAngular) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            printGrid.viewContainerRef = this.parent.viewContainerRef;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        printGrid.load = function () { };\n        printGrid.query = gObj.getQuery().clone();\n        window.printGridObj = printGrid;\n        printGrid.isPrinting = true;\n        var modules = printGrid.getInjectedModules();\n        var injectedModues = gObj.getInjectedModules();\n        if (!modules || modules.length !== injectedModues.length) {\n            printGrid.setInjectedModules(injectedModues);\n        }\n        gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.printGridInit, { element: element, printgrid: printGrid });\n        this.parent.log('exporting_begin', this.getModuleName());\n        printGrid.registeredTemplate = this.parent.registeredTemplate;\n        printGrid.isVue = this.parent.isVue;\n        if (this.parent.isVue) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            printGrid.vueInstance = this.parent.vueInstance;\n        }\n        printGrid.printGridParent = gObj;\n        printGrid.appendTo(element);\n        if (!gObj.isVue3) {\n            printGrid.trigger = gObj.trigger;\n        }\n    };\n    Print.prototype.contentReady = function () {\n        var _this = this;\n        if (this.isPrintGrid()) {\n            var gObj = this.parent;\n            if (this.isAsyncPrint) {\n                this.printGrid();\n                return;\n            }\n            var args = {\n                requestType: 'print',\n                element: gObj.element,\n                selectedRows: gObj.getContentTable().querySelectorAll('tr[aria-selected=\"true\"]'),\n                cancel: false,\n                hierarchyPrintMode: gObj.hierarchyPrintMode\n            };\n            if (!this.isAsyncPrint) {\n                gObj.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_2__.beforePrint, args);\n            }\n            if (args.cancel) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.detach)(gObj.element);\n                return;\n            }\n            if (!this.isAsyncPrint) {\n                if (this.parent.printGridParent && this.parent.printGridParent.isReact) {\n                    this.parent.printGridParent.renderTemplates(function () {\n                        _this.printGrid();\n                    });\n                }\n                else {\n                    this.printGrid();\n                }\n            }\n        }\n    };\n    Print.prototype.printGrid = function () {\n        var gObj = this.parent;\n        // Height adjustment on print grid\n        if (gObj.height !== 'auto') { // if scroller enabled\n            var cssProps = this.scrollModule.getCssProperties();\n            var contentDiv = gObj.element.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_5__.content);\n            var headerDiv = gObj.element.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_5__.gridHeader);\n            contentDiv.style.height = 'auto';\n            contentDiv.style.overflowY = 'auto';\n            headerDiv.style[cssProps.padding] = '';\n            headerDiv.firstElementChild.style[cssProps.border] = '';\n        }\n        // Grid alignment adjustment on grouping\n        if (gObj.allowGrouping) {\n            if (!gObj.groupSettings.columns.length) {\n                gObj.element.querySelector('.e-groupdroparea').style.display = 'none';\n            }\n            else {\n                this.removeColGroup(gObj);\n            }\n        }\n        // hide horizontal scroll\n        for (var _i = 0, _a = [].slice.call(gObj.element.getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_5__.content)); _i < _a.length; _i++) {\n            var element = _a[_i];\n            element.style.overflowX = 'hidden';\n        }\n        // Hide the waiting popup\n        var waitingPop = [].slice.call(gObj.element.getElementsByClassName('e-spin-show'));\n        for (var _b = 0, _c = [].slice.call(waitingPop); _b < _c.length; _b++) {\n            var element = _c[_b];\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(element, ['e-spin-hide'], ['e-spin-show']);\n        }\n        this.printGridElement(gObj);\n        gObj.isPrinting = false;\n        delete window.printGridObj;\n        var args = {\n            element: gObj.element\n        };\n        gObj.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_2__.printComplete, args);\n        gObj.destroy();\n        this.parent.log('exporting_complete', this.getModuleName());\n    };\n    Print.prototype.printGridElement = function (gObj) {\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(gObj.element, ['e-print-grid-layout'], ['e-print-grid']);\n        if (gObj.isPrinting) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.detach)(gObj.element);\n        }\n        this.printWind = window.open('', 'print', 'height=' + window.outerHeight + ',width=' + window.outerWidth + ',tabbar=no');\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.printWind)) {\n            this.printWind.moveTo(0, 0);\n            this.printWind.resizeTo(screen.availWidth, screen.availHeight);\n            this.printWind = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.print)(gObj.element, this.printWind);\n        }\n    };\n    Print.prototype.removeColGroup = function (gObj) {\n        var depth = gObj.groupSettings.columns.length;\n        var element = gObj.element;\n        var id = '#' + gObj.element.id;\n        if (!depth) {\n            return;\n        }\n        var groupCaption = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.selectAll)('.e-groupcaption', element);\n        var colSpan = gObj.groupSettings.enableLazyLoading ? (parseInt(groupCaption[0].getAttribute('colspan'), 10) -\n            (gObj.groupSettings.columns.length - 1)).toString() : groupCaption[depth - 1].getAttribute('colspan');\n        for (var i = 0; i < groupCaption.length; i++) {\n            groupCaption[parseInt(i.toString(), 10)].setAttribute('colspan', colSpan);\n        }\n        var colGroups = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.selectAll)(\"colgroup\" + id + \"colgroup\", element);\n        var contentColGroups = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.selectAll)('.e-content colgroup', element);\n        var footerColGroups = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.selectAll)('.e-summarycontent colgroup', element);\n        this.hideColGroup(colGroups, depth);\n        this.hideColGroup(contentColGroups, depth);\n        this.hideColGroup(footerColGroups, depth);\n    };\n    Print.prototype.hideColGroup = function (colGroups, depth) {\n        for (var i = 0; i < colGroups.length; i++) {\n            for (var j = 0; j < depth; j++) {\n                colGroups[parseInt(i.toString(), 10)].children[parseInt(j.toString(), 10)].style.display = 'none';\n            }\n        }\n    };\n    /**\n     * To destroy the print\n     *\n     * @returns {boolean} returns the isPrintGrid or not\n     * @hidden\n     */\n    Print.prototype.isPrintGrid = function () {\n        return this.parent.element.id.indexOf('_print') > 0 && this.parent.isPrinting;\n    };\n    /**\n     * To destroy the print\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Print.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_2__.contentReady, this.contentReady.bind(this));\n        this.parent.removeEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_2__.actionBegin, this.actionBeginFunction);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_2__.onEmpty, this.onEmpty.bind(this));\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_2__.hierarchyPrint, this.hierarchyPrint);\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Print.prototype.getModuleName = function () {\n        return 'print';\n    };\n    Print.printGridProp = getCloneProperties().concat([_base_constant__WEBPACK_IMPORTED_MODULE_2__.beforePrint, _base_constant__WEBPACK_IMPORTED_MODULE_2__.printComplete, _base_constant__WEBPACK_IMPORTED_MODULE_2__.load]);\n    return Print;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL3ByaW50LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQW9JO0FBQ25GO0FBQ2I7QUFDTztBQUNLO0FBQ0k7QUFDcEQ7QUFDQSxhQUFhLFVBQVU7QUFDdkI7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwwREFBUTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3REFBbUI7QUFDMUM7QUFDQSxxQ0FBcUMsdURBQWtCO0FBQ3ZELHVCQUF1QixtREFBYztBQUNyQyx1QkFBdUIsMERBQXFCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsbUVBQWE7QUFDbkM7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLDRCQUE0Qiw0Q0FBSSxDQUFDLDZEQUFpQjtBQUNsRCx3QkFBd0IsOEJBQThCO0FBQ3RELDREQUE0RCw0REFBTSxHQUFHO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHlEQUFvQixJQUFJLHdDQUF3QztBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHVEQUFrQjtBQUMvQztBQUNBO0FBQ0EsZ0JBQWdCLDREQUFNO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQztBQUN0QztBQUNBLDhEQUE4RCwwREFBZ0I7QUFDOUUsNkRBQTZELDZEQUFtQjtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0YsMERBQWdCLElBQUksZ0JBQWdCO0FBQ3BIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsZ0JBQWdCO0FBQ3pFO0FBQ0EsWUFBWSwrREFBUztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix5REFBb0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtEQUFTO0FBQ2pCO0FBQ0EsWUFBWSw0REFBTTtBQUNsQjtBQUNBO0FBQ0EsYUFBYSx1RUFBaUI7QUFDOUI7QUFDQTtBQUNBLDZCQUE2QiwyREFBVztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsK0RBQVM7QUFDcEM7QUFDQTtBQUNBLHdCQUF3Qix5QkFBeUI7QUFDakQ7QUFDQTtBQUNBLHdCQUF3QiwrREFBUztBQUNqQywrQkFBK0IsK0RBQVM7QUFDeEMsOEJBQThCLCtEQUFTO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0JBQXNCO0FBQzlDLDRCQUE0QixXQUFXO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isd0RBQW1CO0FBQzNDLHdDQUF3Qyx1REFBa0I7QUFDMUQsd0JBQXdCLG1EQUFjO0FBQ3RDLHdCQUF3QiwwREFBcUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELHVEQUFrQixFQUFFLHlEQUFvQixFQUFFLGdEQUFXO0FBQzVHO0FBQ0EsQ0FBQztBQUNnQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL2FjdGlvbnMvcHJpbnQuanM/MmU1ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmludCBhcyBwcmludFdpbmRvdywgY3JlYXRlRWxlbWVudCwgZGV0YWNoLCBjbGFzc0xpc3QsIHNlbGVjdEFsbCwgZXh0ZW5kLCBpc051bGxPclVuZGVmaW5lZCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IGdldFByaW50R3JpZE1vZGVsIH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbmltcG9ydCB7IEdyaWQgfSBmcm9tICcuLi9iYXNlL2dyaWQnO1xuaW1wb3J0ICogYXMgZXZlbnRzIGZyb20gJy4uL2Jhc2UvY29uc3RhbnQnO1xuaW1wb3J0IHsgRGVmZXJyZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItZGF0YSc7XG5pbXBvcnQgKiBhcyBsaXRlcmFscyBmcm9tICcuLi9iYXNlL3N0cmluZy1saXRlcmFscyc7XG4vKipcbiAqIEByZXR1cm5zIHtzdHJpbmdbXX0gcmV0dXJucyB0aGUgY2xvbmVkIHByb3BlcnR5XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDbG9uZVByb3BlcnRpZXMoKSB7XG4gICAgcmV0dXJuIFsnYWdncmVnYXRlcycsICdhbGxvd0dyb3VwaW5nJywgJ2FsbG93RmlsdGVyaW5nJywgJ2FsbG93TXVsdGlTb3J0aW5nJywgJ2FsbG93UmVvcmRlcmluZycsICdhbGxvd1NvcnRpbmcnLFxuICAgICAgICAnYWxsb3dUZXh0V3JhcCcsICdjaGlsZEdyaWQnLCAnY29sdW1ucycsICdjdXJyZW50Vmlld0RhdGEnLCAnZGF0YVNvdXJjZScsICdkZXRhaWxUZW1wbGF0ZScsICdlbmFibGVBbHRSb3cnLFxuICAgICAgICAnZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24nLCAnZmlsdGVyU2V0dGluZ3MnLCAnZ3JpZExpbmVzJyxcbiAgICAgICAgJ2dyb3VwU2V0dGluZ3MnLCAnaGVpZ2h0JywgJ2xvY2FsZScsICdwYWdlU2V0dGluZ3MnLCAncHJpbnRNb2RlJywgJ3F1ZXJ5JywgJ3F1ZXJ5U3RyaW5nJywgJ2VuYWJsZVJ0bCcsXG4gICAgICAgICdyb3dIZWlnaHQnLCAncm93VGVtcGxhdGUnLCAnc29ydFNldHRpbmdzJywgJ3RleHRXcmFwU2V0dGluZ3MnLCAnYWxsb3dQYWdpbmcnLCAnaGllcmFyY2h5UHJpbnRNb2RlJywgJ3NlYXJjaFNldHRpbmdzJyxcbiAgICAgICAgJ3F1ZXJ5Q2VsbEluZm8nLCAnYmVmb3JlRGF0YUJvdW5kJywgJ2VuYWJsZUh0bWxTYW5pdGl6ZXInXTtcbn1cbi8qKlxuICpcbiAqIFRoZSBgUHJpbnRgIG1vZHVsZSBpcyB1c2VkIHRvIGhhbmRsZSBwcmludCBhY3Rpb24uXG4gKi9cbnZhciBQcmludCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvciBmb3IgdGhlIEdyaWQgcHJpbnQgbW9kdWxlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0lHcmlkfSBwYXJlbnQgLSBzcGVjaWZpZXMgdGhlIElHcmlkXG4gICAgICogQHBhcmFtIHtTY3JvbGx9IHNjcm9sbE1vZHVsZSAtIHNwZWNpZmllcyB0aGUgc2Nyb2xsIG1vZHVsZVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBQcmludChwYXJlbnQsIHNjcm9sbE1vZHVsZSkge1xuICAgICAgICB0aGlzLmlzQXN5bmNQcmludCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRlZmVyZWQgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5jb250ZW50UmVhZHksIHRoaXMuaXNDb250ZW50UmVhZHkoKSwgdGhpcyk7XG4gICAgICAgIHRoaXMuYWN0aW9uQmVnaW5GdW5jdGlvbiA9IHRoaXMuYWN0aW9uQmVnaW4uYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudHMuYWN0aW9uQmVnaW4sIHRoaXMuYWN0aW9uQmVnaW5GdW5jdGlvbik7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5vbkVtcHR5LCB0aGlzLm9uRW1wdHkuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5oaWVyYXJjaHlQcmludCwgdGhpcy5oaWVyYXJjaHlQcmludCwgdGhpcyk7XG4gICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlID0gc2Nyb2xsTW9kdWxlO1xuICAgIH1cbiAgICBQcmludC5wcm90b3R5cGUuaXNDb250ZW50UmVhZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmlzUHJpbnRHcmlkKCkgJiYgKHRoaXMucGFyZW50LmhpZXJhcmNoeVByaW50TW9kZSA9PT0gJ05vbmUnIHx8ICF0aGlzLnBhcmVudC5jaGlsZEdyaWQpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50UmVhZHk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLmRlZmVyZWQucHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5jb250ZW50UmVhZHkoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKF90aGlzLmlzUHJpbnRHcmlkKCkpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5oaWVyYXJjaHlQcmludCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgUHJpbnQucHJvdG90eXBlLmhpZXJhcmNoeVByaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlbW92ZUNvbEdyb3VwKHRoaXMucGFyZW50KTtcbiAgICAgICAgdmFyIHByaW50R3JpZE9iaiA9IHdpbmRvdy5wcmludEdyaWRPYmo7XG4gICAgICAgIGlmIChwcmludEdyaWRPYmogJiYgIXByaW50R3JpZE9iai5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ1thcmlhLWJ1c3k9dHJ1ZScpKSB7XG4gICAgICAgICAgICBwcmludEdyaWRPYmoucHJpbnRNb2R1bGUuZGVmZXJlZC5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEJ5IGRlZmF1bHQsIHByaW50cyBhbGwgdGhlIEdyaWQgcGFnZXMgYW5kIGhpZGVzIHRoZSBwYWdlci5cbiAgICAgKiA+IFlvdSBjYW4gY3VzdG9taXplIHByaW50IG9wdGlvbnMgdXNpbmcgdGhlXG4gICAgICogW2BwcmludE1vZGVgXSguL3ByaW50bW9kZS8pLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgUHJpbnQucHJvdG90eXBlLnByaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlbmRlclByaW50R3JpZCgpO1xuICAgIH07XG4gICAgUHJpbnQucHJvdG90eXBlLm9uRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUHJpbnRHcmlkKCkpIHtcbiAgICAgICAgICAgIHRoaXMuY29udGVudFJlYWR5KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFByaW50LnByb3RvdHlwZS5hY3Rpb25CZWdpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNQcmludEdyaWQoKSkge1xuICAgICAgICAgICAgdGhpcy5pc0FzeW5jUHJpbnQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQcmludC5wcm90b3R5cGUucmVuZGVyUHJpbnRHcmlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgZWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIGlkOiB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgJ19wcmludCcsIGNsYXNzTmFtZTogZ09iai5lbGVtZW50LmNsYXNzTmFtZSArICcgZS1wcmludC1ncmlkJ1xuICAgICAgICB9KTtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdlLWdyaWRob3ZlcicpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgICB2YXIgcHJpbnRHcmlkID0gbmV3IEdyaWQoZ2V0UHJpbnRHcmlkTW9kZWwoZ09iaiwgZ09iai5oaWVyYXJjaHlQcmludE1vZGUpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcmludEdyaWQuY29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcHJpbnRHcmlkLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID0gZXh0ZW5kKHt9LCBwcmludEdyaWQuY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgaWYgKCFnT2JqLmdldEZyb3plbkNvbHVtbnMoKSAmJiBnT2JqLmlzRnJvemVuR3JpZCgpKSB7XG4gICAgICAgICAgICAgICAgcHJpbnRHcmlkLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZyZWV6ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNBbmd1bGFyKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgcHJpbnRHcmlkLnZpZXdDb250YWluZXJSZWYgPSB0aGlzLnBhcmVudC52aWV3Q29udGFpbmVyUmVmO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICAgICAgcHJpbnRHcmlkLmxvYWQgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgIHByaW50R3JpZC5xdWVyeSA9IGdPYmouZ2V0UXVlcnkoKS5jbG9uZSgpO1xuICAgICAgICB3aW5kb3cucHJpbnRHcmlkT2JqID0gcHJpbnRHcmlkO1xuICAgICAgICBwcmludEdyaWQuaXNQcmludGluZyA9IHRydWU7XG4gICAgICAgIHZhciBtb2R1bGVzID0gcHJpbnRHcmlkLmdldEluamVjdGVkTW9kdWxlcygpO1xuICAgICAgICB2YXIgaW5qZWN0ZWRNb2R1ZXMgPSBnT2JqLmdldEluamVjdGVkTW9kdWxlcygpO1xuICAgICAgICBpZiAoIW1vZHVsZXMgfHwgbW9kdWxlcy5sZW5ndGggIT09IGluamVjdGVkTW9kdWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgcHJpbnRHcmlkLnNldEluamVjdGVkTW9kdWxlcyhpbmplY3RlZE1vZHVlcyk7XG4gICAgICAgIH1cbiAgICAgICAgZ09iai5ub3RpZnkoZXZlbnRzLnByaW50R3JpZEluaXQsIHsgZWxlbWVudDogZWxlbWVudCwgcHJpbnRncmlkOiBwcmludEdyaWQgfSk7XG4gICAgICAgIHRoaXMucGFyZW50LmxvZygnZXhwb3J0aW5nX2JlZ2luJywgdGhpcy5nZXRNb2R1bGVOYW1lKCkpO1xuICAgICAgICBwcmludEdyaWQucmVnaXN0ZXJlZFRlbXBsYXRlID0gdGhpcy5wYXJlbnQucmVnaXN0ZXJlZFRlbXBsYXRlO1xuICAgICAgICBwcmludEdyaWQuaXNWdWUgPSB0aGlzLnBhcmVudC5pc1Z1ZTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzVnVlKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgcHJpbnRHcmlkLnZ1ZUluc3RhbmNlID0gdGhpcy5wYXJlbnQudnVlSW5zdGFuY2U7XG4gICAgICAgIH1cbiAgICAgICAgcHJpbnRHcmlkLnByaW50R3JpZFBhcmVudCA9IGdPYmo7XG4gICAgICAgIHByaW50R3JpZC5hcHBlbmRUbyhlbGVtZW50KTtcbiAgICAgICAgaWYgKCFnT2JqLmlzVnVlMykge1xuICAgICAgICAgICAgcHJpbnRHcmlkLnRyaWdnZXIgPSBnT2JqLnRyaWdnZXI7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFByaW50LnByb3RvdHlwZS5jb250ZW50UmVhZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmlzUHJpbnRHcmlkKCkpIHtcbiAgICAgICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0FzeW5jUHJpbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaW50R3JpZCgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RUeXBlOiAncHJpbnQnLFxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGdPYmouZWxlbWVudCxcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFJvd3M6IGdPYmouZ2V0Q29udGVudFRhYmxlKCkucXVlcnlTZWxlY3RvckFsbCgndHJbYXJpYS1zZWxlY3RlZD1cInRydWVcIl0nKSxcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGhpZXJhcmNoeVByaW50TW9kZTogZ09iai5oaWVyYXJjaHlQcmludE1vZGVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNBc3luY1ByaW50KSB7XG4gICAgICAgICAgICAgICAgZ09iai50cmlnZ2VyKGV2ZW50cy5iZWZvcmVQcmludCwgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJncy5jYW5jZWwpIHtcbiAgICAgICAgICAgICAgICBkZXRhY2goZ09iai5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNBc3luY1ByaW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnByaW50R3JpZFBhcmVudCAmJiB0aGlzLnBhcmVudC5wcmludEdyaWRQYXJlbnQuaXNSZWFjdCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5wcmludEdyaWRQYXJlbnQucmVuZGVyVGVtcGxhdGVzKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnByaW50R3JpZCgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpbnRHcmlkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBQcmludC5wcm90b3R5cGUucHJpbnRHcmlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICAvLyBIZWlnaHQgYWRqdXN0bWVudCBvbiBwcmludCBncmlkXG4gICAgICAgIGlmIChnT2JqLmhlaWdodCAhPT0gJ2F1dG8nKSB7IC8vIGlmIHNjcm9sbGVyIGVuYWJsZWRcbiAgICAgICAgICAgIHZhciBjc3NQcm9wcyA9IHRoaXMuc2Nyb2xsTW9kdWxlLmdldENzc1Byb3BlcnRpZXMoKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50RGl2ID0gZ09iai5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuY29udGVudCk7XG4gICAgICAgICAgICB2YXIgaGVhZGVyRGl2ID0gZ09iai5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZEhlYWRlcik7XG4gICAgICAgICAgICBjb250ZW50RGl2LnN0eWxlLmhlaWdodCA9ICdhdXRvJztcbiAgICAgICAgICAgIGNvbnRlbnREaXYuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nO1xuICAgICAgICAgICAgaGVhZGVyRGl2LnN0eWxlW2Nzc1Byb3BzLnBhZGRpbmddID0gJyc7XG4gICAgICAgICAgICBoZWFkZXJEaXYuZmlyc3RFbGVtZW50Q2hpbGQuc3R5bGVbY3NzUHJvcHMuYm9yZGVyXSA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIC8vIEdyaWQgYWxpZ25tZW50IGFkanVzdG1lbnQgb24gZ3JvdXBpbmdcbiAgICAgICAgaWYgKGdPYmouYWxsb3dHcm91cGluZykge1xuICAgICAgICAgICAgaWYgKCFnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBnT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZ3JvdXBkcm9wYXJlYScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNvbEdyb3VwKGdPYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGhpZGUgaG9yaXpvbnRhbCBzY3JvbGxcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IFtdLnNsaWNlLmNhbGwoZ09iai5lbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUobGl0ZXJhbHMuY29udGVudCkpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBfYVtfaV07XG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLm92ZXJmbG93WCA9ICdoaWRkZW4nO1xuICAgICAgICB9XG4gICAgICAgIC8vIEhpZGUgdGhlIHdhaXRpbmcgcG9wdXBcbiAgICAgICAgdmFyIHdhaXRpbmdQb3AgPSBbXS5zbGljZS5jYWxsKGdPYmouZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlLXNwaW4tc2hvdycpKTtcbiAgICAgICAgZm9yICh2YXIgX2IgPSAwLCBfYyA9IFtdLnNsaWNlLmNhbGwod2FpdGluZ1BvcCk7IF9iIDwgX2MubGVuZ3RoOyBfYisrKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IF9jW19iXTtcbiAgICAgICAgICAgIGNsYXNzTGlzdChlbGVtZW50LCBbJ2Utc3Bpbi1oaWRlJ10sIFsnZS1zcGluLXNob3cnXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcmludEdyaWRFbGVtZW50KGdPYmopO1xuICAgICAgICBnT2JqLmlzUHJpbnRpbmcgPSBmYWxzZTtcbiAgICAgICAgZGVsZXRlIHdpbmRvdy5wcmludEdyaWRPYmo7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgZWxlbWVudDogZ09iai5lbGVtZW50XG4gICAgICAgIH07XG4gICAgICAgIGdPYmoudHJpZ2dlcihldmVudHMucHJpbnRDb21wbGV0ZSwgYXJncyk7XG4gICAgICAgIGdPYmouZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnBhcmVudC5sb2coJ2V4cG9ydGluZ19jb21wbGV0ZScsIHRoaXMuZ2V0TW9kdWxlTmFtZSgpKTtcbiAgICB9O1xuICAgIFByaW50LnByb3RvdHlwZS5wcmludEdyaWRFbGVtZW50ID0gZnVuY3Rpb24gKGdPYmopIHtcbiAgICAgICAgY2xhc3NMaXN0KGdPYmouZWxlbWVudCwgWydlLXByaW50LWdyaWQtbGF5b3V0J10sIFsnZS1wcmludC1ncmlkJ10pO1xuICAgICAgICBpZiAoZ09iai5pc1ByaW50aW5nKSB7XG4gICAgICAgICAgICBkZXRhY2goZ09iai5lbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaW50V2luZCA9IHdpbmRvdy5vcGVuKCcnLCAncHJpbnQnLCAnaGVpZ2h0PScgKyB3aW5kb3cub3V0ZXJIZWlnaHQgKyAnLHdpZHRoPScgKyB3aW5kb3cub3V0ZXJXaWR0aCArICcsdGFiYmFyPW5vJyk7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wcmludFdpbmQpKSB7XG4gICAgICAgICAgICB0aGlzLnByaW50V2luZC5tb3ZlVG8oMCwgMCk7XG4gICAgICAgICAgICB0aGlzLnByaW50V2luZC5yZXNpemVUbyhzY3JlZW4uYXZhaWxXaWR0aCwgc2NyZWVuLmF2YWlsSGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMucHJpbnRXaW5kID0gcHJpbnRXaW5kb3coZ09iai5lbGVtZW50LCB0aGlzLnByaW50V2luZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFByaW50LnByb3RvdHlwZS5yZW1vdmVDb2xHcm91cCA9IGZ1bmN0aW9uIChnT2JqKSB7XG4gICAgICAgIHZhciBkZXB0aCA9IGdPYmouZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aDtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBnT2JqLmVsZW1lbnQ7XG4gICAgICAgIHZhciBpZCA9ICcjJyArIGdPYmouZWxlbWVudC5pZDtcbiAgICAgICAgaWYgKCFkZXB0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBncm91cENhcHRpb24gPSBzZWxlY3RBbGwoJy5lLWdyb3VwY2FwdGlvbicsIGVsZW1lbnQpO1xuICAgICAgICB2YXIgY29sU3BhbiA9IGdPYmouZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZyA/IChwYXJzZUludChncm91cENhcHRpb25bMF0uZ2V0QXR0cmlidXRlKCdjb2xzcGFuJyksIDEwKSAtXG4gICAgICAgICAgICAoZ09iai5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoIC0gMSkpLnRvU3RyaW5nKCkgOiBncm91cENhcHRpb25bZGVwdGggLSAxXS5nZXRBdHRyaWJ1dGUoJ2NvbHNwYW4nKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBncm91cENhcHRpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGdyb3VwQ2FwdGlvbltwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uc2V0QXR0cmlidXRlKCdjb2xzcGFuJywgY29sU3Bhbik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbEdyb3VwcyA9IHNlbGVjdEFsbChcImNvbGdyb3VwXCIgKyBpZCArIFwiY29sZ3JvdXBcIiwgZWxlbWVudCk7XG4gICAgICAgIHZhciBjb250ZW50Q29sR3JvdXBzID0gc2VsZWN0QWxsKCcuZS1jb250ZW50IGNvbGdyb3VwJywgZWxlbWVudCk7XG4gICAgICAgIHZhciBmb290ZXJDb2xHcm91cHMgPSBzZWxlY3RBbGwoJy5lLXN1bW1hcnljb250ZW50IGNvbGdyb3VwJywgZWxlbWVudCk7XG4gICAgICAgIHRoaXMuaGlkZUNvbEdyb3VwKGNvbEdyb3VwcywgZGVwdGgpO1xuICAgICAgICB0aGlzLmhpZGVDb2xHcm91cChjb250ZW50Q29sR3JvdXBzLCBkZXB0aCk7XG4gICAgICAgIHRoaXMuaGlkZUNvbEdyb3VwKGZvb3RlckNvbEdyb3VwcywgZGVwdGgpO1xuICAgIH07XG4gICAgUHJpbnQucHJvdG90eXBlLmhpZGVDb2xHcm91cCA9IGZ1bmN0aW9uIChjb2xHcm91cHMsIGRlcHRoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sR3JvdXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRlcHRoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBjb2xHcm91cHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNoaWxkcmVuW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUbyBkZXN0cm95IHRoZSBwcmludFxuICAgICAqXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJldHVybnMgdGhlIGlzUHJpbnRHcmlkIG9yIG5vdFxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBQcmludC5wcm90b3R5cGUuaXNQcmludEdyaWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5lbGVtZW50LmlkLmluZGV4T2YoJ19wcmludCcpID4gMCAmJiB0aGlzLnBhcmVudC5pc1ByaW50aW5nO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVG8gZGVzdHJveSB0aGUgcHJpbnRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBQcmludC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5jb250ZW50UmVhZHksIHRoaXMuY29udGVudFJlYWR5LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50cy5hY3Rpb25CZWdpbiwgdGhpcy5hY3Rpb25CZWdpbkZ1bmN0aW9uKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5vbkVtcHR5LCB0aGlzLm9uRW1wdHkuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9mZihldmVudHMuaGllcmFyY2h5UHJpbnQsIHRoaXMuaGllcmFyY2h5UHJpbnQpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRm9yIGludGVybmFsIHVzZSBvbmx5IC0gR2V0IHRoZSBtb2R1bGUgbmFtZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgdGhlIG1vZHVsZSBuYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBQcmludC5wcm90b3R5cGUuZ2V0TW9kdWxlTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICdwcmludCc7XG4gICAgfTtcbiAgICBQcmludC5wcmludEdyaWRQcm9wID0gZ2V0Q2xvbmVQcm9wZXJ0aWVzKCkuY29uY2F0KFtldmVudHMuYmVmb3JlUHJpbnQsIGV2ZW50cy5wcmludENvbXBsZXRlLCBldmVudHMubG9hZF0pO1xuICAgIHJldHVybiBQcmludDtcbn0oKSk7XG5leHBvcnQgeyBQcmludCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/print.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/scroll.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/scroll.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Scroll: () => (/* binding */ Scroll)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _services_width_controller__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../services/width-controller */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/width-controller.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n\n\n\n/**\n * The `Scroll` module is used to handle scrolling behaviour.\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Grid scrolling.\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @hidden\n     */\n    function Scroll(parent) {\n        //To maintain scroll state on grid actions.\n        this.previousValues = { top: 0, left: 0 };\n        this.oneTimeReady = true;\n        this.parent = parent;\n        this.widthService = new _services_width_controller__WEBPACK_IMPORTED_MODULE_1__.ColumnWidthService(parent);\n        this.addEventListener();\n    }\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Scroll.prototype.getModuleName = function () {\n        return 'scroll';\n    };\n    /**\n     * @param {boolean} uiupdate - specifies the uiupdate\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.setWidth = function (uiupdate) {\n        this.parent.element.style.width = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.formatUnit)(this.parent.width);\n        if (uiupdate) {\n            this.widthService.setWidthToColumns();\n        }\n        if (this.parent.toolbarModule && this.parent.toolbarModule.toolbar &&\n            this.parent.toolbarModule.toolbar.element) {\n            var tlbrElement = this.parent.toolbarModule.toolbar.element;\n            var tlbrLeftElement = tlbrElement.querySelector('.e-toolbar-left');\n            var tlbrCenterElement = tlbrElement.querySelector('.e-toolbar-center');\n            var tlbrRightElement = tlbrElement.querySelector('.e-toolbar-right');\n            var tlbrItems = tlbrElement.querySelector('.e-toolbar-items');\n            var tlbrLeftWidth = tlbrLeftElement ? tlbrLeftElement.clientWidth : 0;\n            var tlbrCenterWidth = tlbrCenterElement ? tlbrCenterElement.clientWidth : 0;\n            var tlbrRightWidth = tlbrRightElement ? tlbrRightElement.clientWidth : 0;\n            var tlbrItemsWidth = tlbrItems ? tlbrItems.clientWidth : 0;\n            var tlbrWidth = tlbrElement ? tlbrElement.clientWidth : 0;\n            if (!this.parent.enableAdaptiveUI || tlbrLeftWidth > tlbrWidth || tlbrCenterWidth > tlbrWidth || tlbrRightWidth > tlbrWidth ||\n                tlbrItemsWidth > tlbrWidth) {\n                this.parent.toolbarModule.toolbar.refreshOverflow();\n            }\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.setHeight = function () {\n        var mHdrHeight = 0;\n        var content = this.parent.getContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.content);\n        var height = this.parent.height;\n        if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid() && this.parent.height !== 'auto'\n            && this.parent.height.toString().indexOf('%') < 0) {\n            height = parseInt(height, 10) - Scroll.getScrollBarWidth();\n        }\n        if (!this.parent.enableVirtualization && this.parent.frozenRows && this.parent.height !== 'auto' &&\n            this.parent.height !== '100%') {\n            var tbody = this.parent.getHeaderContent()\n                .querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody + ':not(.e-masked-tbody)');\n            mHdrHeight = tbody ? tbody.offsetHeight : 0;\n            if (tbody && mHdrHeight) {\n                var add = tbody.getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.addedRow).length;\n                var height_1 = add * this.parent.getRowHeight();\n                mHdrHeight -= height_1;\n            }\n            else if (!this.parent.isInitialLoad && this.parent.loadingIndicator.indicatorType === 'Shimmer'\n                && this.parent.getHeaderContent().querySelector('.e-masked-table')) {\n                height = parseInt(height, 10) - (this.parent.frozenRows * this.parent.getRowHeight());\n            }\n            content.style.height = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.formatUnit)(parseInt(height, 10) - mHdrHeight);\n        }\n        else {\n            content.style.height = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.formatUnit)(height);\n        }\n        this.ensureOverflow(content);\n        if (this.parent.isFrozenGrid()) {\n            this.refresh();\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.setPadding = function () {\n        var content = this.parent.getHeaderContent();\n        var scrollWidth = Scroll.getScrollBarWidth() - this.getThreshold();\n        var cssProps = this.getCssProperties();\n        content.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.headerContent).style[cssProps.border] = scrollWidth > 0 ? '1px' : '0px';\n        content.style[cssProps.padding] = scrollWidth > 0 ? scrollWidth + 'px' : '0px';\n    };\n    /**\n     * @param {boolean} rtl - specifies the rtl\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.removePadding = function (rtl) {\n        var cssProps = this.getCssProperties(rtl);\n        var hDiv = this.parent.getHeaderContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.headerContent);\n        hDiv.style[cssProps.border] = '';\n        hDiv.parentElement.style[cssProps.padding] = '';\n        var footerDiv = this.parent.getFooterContent();\n        if (footerDiv && footerDiv.classList.contains('e-footerpadding')) {\n            footerDiv.classList.remove('e-footerpadding');\n        }\n    };\n    /**\n     * Refresh makes the Grid adoptable with the height of parent container.\n     *\n     * > The [`height`](./#height) must be set to 100%.\n     *\n     * @returns {void}\n     */\n    Scroll.prototype.refresh = function () {\n        if (this.parent.height !== '100%') {\n            return;\n        }\n        var content = this.parent.getContent();\n        this.parent.element.style.height = '100%';\n        var height = this.widthService.getSiblingsHeight(content);\n        content.style.height = 'calc(100% - ' + height + 'px)'; //Set the height to the  '.' + literals.gridContent;\n    };\n    Scroll.prototype.getThreshold = function () {\n        /* Some browsers places the scroller outside the content,\n         * hence the padding should be adjusted.*/\n        var appName = _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name;\n        if (appName === 'mozilla') {\n            return 0.5;\n        }\n        return 1;\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.onEmpty, this.wireEvents, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.contentReady, this.wireEvents, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.uiUpdate, this.onPropertyChanged, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.textWrapRefresh, this.wireEvents, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.headerRefreshed, this.setScrollLeft, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.onEmpty, this.wireEvents);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.contentReady, this.wireEvents);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.uiUpdate, this.onPropertyChanged);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.textWrapRefresh, this.wireEvents);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.headerRefreshed, this.setScrollLeft);\n        this.unwireEvents();\n    };\n    Scroll.prototype.unwireEvents = function () {\n        if (this.parent.frozenRows && this.header) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.header, 'touchstart pointerdown', this.setPageXY);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.header, 'touchmove pointermove', this.onTouchScroll);\n        }\n        var mScrollBar = this.parent.getContent() ? this.parent.getContent().querySelector('.e-movablescrollbar') : null;\n        if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {\n            if (mScrollBar) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(mScrollBar, 'scroll', this.onCustomScrollbarScroll);\n            }\n            if (this.content) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.content, 'scroll', this.onCustomScrollbarScroll);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.content, 'touchstart pointerdown', this.setPageXY);\n                if (!(/macintosh|ipad/.test(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.userAgent.toLowerCase()) && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice)) {\n                    _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.content, 'touchmove pointermove', this.onTouchScroll);\n                }\n            }\n            if (this.header) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.header, 'scroll', this.onCustomScrollbarScroll);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.header, 'touchstart pointerdown', this.setPageXY);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.header, 'touchmove pointermove', this.onTouchScroll);\n            }\n        }\n        if (this.content) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.content, 'scroll', this.contentScrollHandler);\n        }\n        if (this.header) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.header, 'scroll', this.headerScrollHandler);\n        }\n        this.contentScrollHandler = null;\n        this.headerScrollHandler = null;\n        if (this.parent.aggregates.length && this.parent.getFooterContent()) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.getFooterContent().firstChild, 'scroll', this.onContentScroll);\n        }\n    };\n    Scroll.prototype.setScrollLeft = function () {\n        this.parent.getHeaderContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.headerContent).scrollLeft = this.previousValues.left;\n    };\n    Scroll.prototype.onContentScroll = function (scrollTarget) {\n        var _this = this;\n        var element = scrollTarget;\n        var isHeader = element.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.headerContent);\n        return function (e) {\n            if (_this.content.querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody) === null || _this.parent.isPreventScrollEvent) {\n                return;\n            }\n            var target = e.target;\n            if (_this.parent.frozenRows) {\n                if (_this.content.scrollTop > 0 && _this.parent.frozenRows) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([_this.parent.element], 'e-top-shadow');\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([_this.parent.element], 'e-top-shadow');\n                }\n            }\n            if (_this.parent.element.querySelectorAll('.e-leftfreeze,.e-fixedfreeze,.e-rightfreeze').length) {\n                var errorFreeze = _this.parent.getContent().querySelectorAll('.e-freezeerror:not([style*=\"display: none\"])');\n                var errorFixed = _this.parent.getContent().querySelectorAll('.e-fixederror:not([style*=\"display: none\"])');\n                var scrollLeft = _this.parent.enableRtl ? Math.abs(target.scrollLeft) : target.scrollLeft;\n                var isStartOfScroll = scrollLeft <= 1;\n                if (!isStartOfScroll && _this.parent.getVisibleFrozenLeftCount()) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([_this.parent.element], 'e-left-shadow');\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([_this.parent.element], 'e-left-shadow');\n                }\n                var scrollRight = _this.parent.enableRtl ? Math.abs(target.scrollLeft) : target.scrollLeft;\n                var isEndOfScroll = Math.round(scrollRight + target.clientWidth) >= target.scrollWidth - 1;\n                if (isEndOfScroll && _this.parent.getVisibleFrozenRightCount()) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([_this.parent.element], 'e-right-shadow');\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([_this.parent.element], 'e-right-shadow');\n                }\n                var rows = [].slice.call(_this.parent.getContent().querySelectorAll('.e-row:not(.e-hiddenrow)'));\n                if (((rows.length === 1 && errorFreeze.length) ||\n                    (_this.parent.element.querySelector('.e-freeze-autofill:not([style*=\"display: none\"])')) ||\n                    errorFixed.length) && target.scrollLeft !== _this.previousValues.left) {\n                    target.scrollLeft = _this.previousValues.left;\n                    return;\n                }\n                if (rows.length !== 1 && (errorFreeze.length || errorFixed.length) && target.scrollTop !== _this.previousValues.top) {\n                    target.scrollTop = _this.previousValues.top;\n                    return;\n                }\n            }\n            var left = target.scrollLeft;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.parent.infiniteScrollModule) && _this.parent.enableInfiniteScrolling && (!_this.parent.isEdit\n                || (_this.parent.editSettings.showAddNewRow && !_this.parent.element.querySelector('.e-editedrow')))) {\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.infiniteScrollHandler, { target: e.target, isLeft: _this.previousValues.left !== left });\n            }\n            if (_this.parent.groupSettings.columns.length && _this.parent.groupSettings.enableLazyLoading) {\n                var isDown = _this.previousValues.top < _this.parent.getContent().firstElementChild.scrollTop;\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.lazyLoadScrollHandler, { scrollDown: isDown });\n            }\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.virtualScrollEdit, {});\n            var isFooter = target.classList.contains('e-summarycontent');\n            if (_this.previousValues.left === left) {\n                _this.previousValues.top = !isHeader ? _this.previousValues.top : target.scrollTop;\n                return;\n            }\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.closeFilterDialog, e);\n            element.scrollLeft = left;\n            if (isFooter) {\n                _this.header.scrollLeft = left;\n            }\n            _this.previousValues.left = left;\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.scroll, { left: left });\n        };\n    };\n    Scroll.prototype.onCustomScrollbarScroll = function (cont, hdr) {\n        var _this = this;\n        var content = cont;\n        var header = hdr;\n        return function (e) {\n            if (_this.content.querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody) === null) {\n                return;\n            }\n            var target = e.target;\n            var left = target.scrollLeft;\n            if (_this.previousValues.left === left) {\n                return;\n            }\n            content.scrollLeft = left;\n            header.scrollLeft = left;\n            _this.previousValues.left = left;\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.scroll, { left: left });\n            if (_this.parent.isDestroyed) {\n                return;\n            }\n        };\n    };\n    Scroll.prototype.onTouchScroll = function (scrollTarget) {\n        var _this = this;\n        var element = scrollTarget;\n        return function (e) {\n            if (e.pointerType === 'mouse') {\n                return;\n            }\n            var isFrozen = _this.parent.isFrozenGrid();\n            var pageXY = _this.getPointXY(e);\n            var left = element.scrollLeft + (_this.pageXY.x - pageXY.x);\n            var mHdr = _this.parent.getHeaderContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.headerContent);\n            var mCont = _this.parent.getContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.content);\n            if (_this.previousValues.left === left || (left < 0 || (mHdr.scrollWidth - mHdr.clientWidth) < left)) {\n                return;\n            }\n            e.preventDefault();\n            mHdr.scrollLeft = left;\n            mCont.scrollLeft = left;\n            if (isFrozen && _this.parent.enableColumnVirtualization) {\n                var scrollBar = _this.parent.getContent().querySelector('.e-movablescrollbar');\n                scrollBar.scrollLeft = left;\n            }\n            _this.pageXY.x = pageXY.x;\n            _this.previousValues.left = left;\n        };\n    };\n    Scroll.prototype.setPageXY = function () {\n        var _this = this;\n        return function (e) {\n            if (e.pointerType === 'mouse') {\n                return;\n            }\n            _this.pageXY = _this.getPointXY(e);\n        };\n    };\n    Scroll.prototype.getPointXY = function (e) {\n        var pageXY = { x: 0, y: 0 };\n        if (e.touches && e.touches.length) {\n            pageXY.x = e.touches[0].pageX;\n            pageXY.y = e.touches[0].pageY;\n        }\n        else {\n            pageXY.x = e.pageX;\n            pageXY.y = e.pageY;\n        }\n        return pageXY;\n    };\n    Scroll.prototype.getScrollbleParent = function (node) {\n        if (node === null) {\n            return null;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var parent = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(node.tagName) ? node.scrollingElement : node;\n        var overflowY = document.defaultView.getComputedStyle(parent, null).overflowY;\n        if (parent.scrollHeight > parent.clientHeight && overflowY !== 'hidden'\n            && overflowY !== 'visible' || node.tagName === 'HTML' || node.tagName === 'BODY') {\n            return node;\n        }\n        else {\n            return this.getScrollbleParent(node.parentNode);\n        }\n    };\n    /**\n     * @param {boolean} isAdd - specifies whether adding/removing the event\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.addStickyListener = function (isAdd) {\n        this.parentElement = this.getScrollbleParent(this.parent.element.parentElement);\n        if (isAdd && this.parentElement) {\n            this.eventElement = this.parentElement.tagName === 'HTML' || this.parentElement.tagName === 'BODY' ? document :\n                this.parentElement;\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.eventElement, 'scroll', this.makeStickyHeader, this);\n        }\n        else if (this.eventElement) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.eventElement, 'scroll', this.makeStickyHeader);\n            this.eventElement = null;\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.resizeFrozenRowBorder = function () {\n        var div;\n        if (!this.parent.element.querySelector('.e-frozenrow-border')) {\n            div = this.parent.createElement('div', { className: 'e-frozenrow-border' });\n            this.parent.element.insertBefore(div, this.parent.element.querySelector('.e-gridcontent'));\n        }\n        else {\n            div = this.parent.element.querySelector('.e-frozenrow-border');\n        }\n        var scrollWidth = this.parent.height !== 'auto' ? Scroll.getScrollBarWidth() : 0;\n        div.style.width = (this.parent.element.offsetWidth - scrollWidth) - 0.5 + 'px';\n    };\n    Scroll.prototype.wireEvents = function () {\n        var _this = this;\n        if (this.oneTimeReady) {\n            var frzCols = this.parent.isFrozenGrid();\n            this.content = this.parent.getContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.content);\n            this.header = this.parent.getHeaderContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.headerContent);\n            var mScrollBar = this.parent.getContent().querySelector('.e-movablescrollbar');\n            if (this.parent.frozenRows && this.header && this.content) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.header, 'touchstart pointerdown', this.setPageXY(), this);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.header, 'touchmove pointermove', this.onTouchScroll(this.content), this);\n            }\n            if (frzCols && mScrollBar && this.parent.enableColumnVirtualization) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(mScrollBar, 'scroll', this.onCustomScrollbarScroll(this.content, this.header), this);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.content, 'scroll', this.onCustomScrollbarScroll(mScrollBar, this.header), this);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.header, 'scroll', this.onCustomScrollbarScroll(mScrollBar, this.content), this);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.header, 'touchstart pointerdown', this.setPageXY(), this);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.header, 'touchmove pointermove', this.onTouchScroll(this.content), this);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.content, 'touchstart pointerdown', this.setPageXY(), this);\n                if (!(/macintosh|ipad/.test(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.userAgent.toLowerCase()) && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice)) {\n                    _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.content, 'touchmove pointermove', this.onTouchScroll(this.header), this);\n                }\n            }\n            this.contentScrollHandler = this.onContentScroll(this.header);\n            this.headerScrollHandler = this.onContentScroll(this.content);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.content, 'scroll', this.contentScrollHandler, this);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.header, 'scroll', this.headerScrollHandler, this);\n            if (this.parent.aggregates.length) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.getFooterContent().firstChild, 'scroll', this.onContentScroll(this.content), this);\n            }\n            if (this.parent.enableStickyHeader) {\n                this.addStickyListener(true);\n            }\n            this.refresh();\n            this.oneTimeReady = false;\n        }\n        var table = this.parent.getContentTable();\n        var sLeft;\n        var sHeight;\n        var clientHeight;\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.getUpdateUsingRaf)(function () {\n            sLeft = _this.header.scrollLeft;\n            sHeight = table.scrollHeight;\n            clientHeight = _this.parent.getContent().clientHeight;\n        }, function () {\n            var args = { cancel: false };\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.checkScrollReset, args);\n            if (sHeight < clientHeight && _this.parent.height !== 'auto') {\n                _this.setLastRowCell();\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.lastRowCellBorderUpdated, args);\n            }\n            if (_this.parent.frozenRows) {\n                _this.resizeFrozenRowBorder();\n            }\n            if (!_this.parent.enableVirtualization && !_this.parent.enableInfiniteScrolling) {\n                if (!args.cancel) {\n                    _this.header.scrollLeft = _this.previousValues.left;\n                    _this.content.scrollLeft = _this.previousValues.left;\n                    _this.content.scrollTop = _this.previousValues.top;\n                }\n            }\n            if (!_this.parent.enableColumnVirtualization) {\n                _this.content.scrollLeft = sLeft;\n                if (_this.parent.isFrozenGrid()) {\n                    _this.previousValues.left = sLeft;\n                }\n            }\n        });\n        this.parent.isPreventScrollEvent = false;\n    };\n    /**\n     * @returns {void} returns void\n     * @hidden\n     */\n    Scroll.prototype.setLastRowCell = function () {\n        var table = this.parent.getContentTable();\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(table.querySelectorAll('td'), 'e-lastrowcell');\n        if (table.querySelector('tr:nth-last-child(2)')) {\n            if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Bottom') {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)(table.querySelector('tr:nth-last-child(2)').querySelectorAll('td'), 'e-lastrowcell');\n            }\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)(table.querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n        if (this.parent.isSpan) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)(table.querySelectorAll('.e-row-span-lastrowcell'), 'e-lastrowcell');\n        }\n    };\n    /**\n     * @param {boolean} rtl - specifies the rtl\n     * @returns {ScrollCss} returns the ScrollCss\n     * @hidden\n     */\n    Scroll.prototype.getCssProperties = function (rtl) {\n        var css = {};\n        var enableRtl = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(rtl) ? this.parent.enableRtl : rtl;\n        css.border = enableRtl ? 'borderLeftWidth' : 'borderRightWidth';\n        css.padding = enableRtl ? 'paddingLeft' : 'paddingRight';\n        return css;\n    };\n    Scroll.prototype.ensureOverflow = function (content) {\n        content.style.overflowY = this.parent.height === 'auto' ? 'auto' : 'scroll';\n    };\n    Scroll.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        this.setPadding();\n        this.oneTimeReady = true;\n        if (this.parent.height === 'auto') {\n            this.removePadding();\n        }\n        this.wireEvents();\n        this.setHeight();\n        var width = 'width';\n        this.setWidth(!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.properties[\"\" + width]));\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.makeStickyHeader = function () {\n        if (this.parent.enableStickyHeader && this.parent.element && this.parent.getContent()) {\n            var contentRect = this.parent.getContent().getClientRects()[0];\n            if (contentRect) {\n                var windowScale = window.devicePixelRatio;\n                var headerEle = this.parent.getHeaderContent();\n                var toolbarEle = this.parent.element.querySelector('.e-toolbar');\n                var groupHeaderEle = this.parent.element.querySelector('.e-groupdroparea');\n                var height = headerEle.offsetHeight + (toolbarEle ? toolbarEle.offsetHeight : 0) +\n                    (groupHeaderEle ? groupHeaderEle.offsetHeight : 0);\n                var parentTop = this.parentElement.getClientRects()[0].top;\n                var top_1 = contentRect.top - (parentTop < 0 ? 0 : parentTop);\n                var left = contentRect.left;\n                var colMenuEle = document.body.querySelector('#' + this.parent.element.id + '_columnmenu');\n                if (windowScale !== 1) {\n                    top_1 = Math.ceil(top_1);\n                }\n                if (top_1 < height && contentRect.bottom > 0) {\n                    headerEle.classList.add('e-sticky');\n                    var elemTop = 0;\n                    if (groupHeaderEle && this.parent.groupSettings.showDropArea) {\n                        this.setSticky(groupHeaderEle, elemTop, contentRect.width, left, true);\n                        elemTop += groupHeaderEle.getClientRects()[0].height;\n                    }\n                    if (toolbarEle) {\n                        this.setSticky(toolbarEle, elemTop, contentRect.width, left, true);\n                        elemTop += toolbarEle.getClientRects()[0].height;\n                    }\n                    this.setSticky(headerEle, elemTop, contentRect.width, left, true);\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(colMenuEle)) {\n                        colMenuEle.style.position = 'fixed';\n                        colMenuEle.style.top = height + 'px';\n                    }\n                }\n                else {\n                    if (headerEle.classList.contains('e-sticky')) {\n                        this.setSticky(headerEle, null, null, null, false);\n                        if (toolbarEle) {\n                            this.setSticky(toolbarEle, null, null, null, false);\n                        }\n                        if (groupHeaderEle) {\n                            this.setSticky(groupHeaderEle, null, null, null, false);\n                        }\n                        var ccDlg = this.parent.element.querySelector('.e-ccdlg');\n                        if (ccDlg) {\n                            ccDlg.classList.remove('e-sticky');\n                        }\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(colMenuEle)) {\n                            colMenuEle.style.position = 'absolute';\n                            var topStyle = contentRect.top - parentTop;\n                            colMenuEle.style.top = topStyle + 'px';\n                        }\n                    }\n                }\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.stickyScrollComplete, {});\n            }\n        }\n    };\n    Scroll.prototype.setSticky = function (ele, top, width, left, isAdd) {\n        if (isAdd) {\n            ele.classList.add('e-sticky');\n        }\n        else {\n            ele.classList.remove('e-sticky');\n        }\n        ele.style.width = width != null ? width + 'px' : '';\n        ele.style.top = top != null ? top + 'px' : '';\n        ele.style.left = left !== null ? parseInt(ele.style.left, 10) !== left ? left + 'px' : ele.style.left : '';\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridHeader) && !gridElement.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridContent))) {\n            return;\n        }\n        this.removeEventListener();\n        //Remove Dom event\n        var cont = this.parent.getContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.content);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(cont, 'scroll', this.onContentScroll);\n        if (this.parent.enableStickyHeader) {\n            this.addStickyListener(false);\n        }\n        //Remove padding\n        this.removePadding();\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([this.parent.getHeaderContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.headerContent)], _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.headerContent);\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([cont], _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.content);\n        //Remove height\n        cont.style.height = '';\n        //Remove width\n        this.parent.element.style.width = '';\n    };\n    /**\n     * Function to get the scrollbar width of the browser.\n     *\n     * @returns {number} return the width\n     * @hidden\n     */\n    Scroll.getScrollBarWidth = function () {\n        return (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.getScrollBarWidth)();\n    };\n    return Scroll;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL3Njcm9sbC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBNkQ7QUFDQTtBQUNRO0FBQ0Q7QUFDc0c7QUFDckU7QUFDbkM7QUFDZDtBQUNUO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQSxnQ0FBZ0MsMEVBQWtCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxnRUFBVTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSwwREFBZ0I7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix3REFBYztBQUM3QztBQUNBO0FBQ0EsdURBQXVELDJEQUFpQjtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxnRUFBVTtBQUM3QztBQUNBO0FBQ0EsbUNBQW1DLGdFQUFVO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxnRUFBc0I7QUFDMUQ7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QUFDQTtBQUNBLG1DQUFtQyxnRUFBMkIsSUFBSTtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQsNkRBQW1CLHNDQUFzQyw4REFBb0I7QUFDM0k7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsMERBQWdCO0FBQ2hGLFFBQVEsOERBQVk7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQVcscURBQXFELGdFQUFzQixJQUFJLGdFQUFzQjtBQUN4SCxRQUFRLGlFQUFXLFNBQVMsMERBQWdCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxlQUFlLDZEQUFpQjtBQUNoQztBQUNBO0FBQ0EsQ0FBQztBQUNpQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL2FjdGlvbnMvc2Nyb2xsLmpzPzlhNWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQnJvd3NlciwgRXZlbnRIYW5kbGVyIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgYWRkQ2xhc3MsIHJlbW92ZUNsYXNzIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgZm9ybWF0VW5pdCwgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBnZXRTY3JvbGxCYXJXaWR0aCwgZ2V0VXBkYXRlVXNpbmdSYWYgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0IHsgc2Nyb2xsLCBjb250ZW50UmVhZHksIHVpVXBkYXRlLCBvbkVtcHR5LCBoZWFkZXJSZWZyZXNoZWQsIHRleHRXcmFwUmVmcmVzaCwgdmlydHVhbFNjcm9sbEVkaXQsIGluZmluaXRlU2Nyb2xsSGFuZGxlciwgY2xvc2VGaWx0ZXJEaWFsb2cgfSBmcm9tICcuLi9iYXNlL2NvbnN0YW50JztcbmltcG9ydCB7IGxhenlMb2FkU2Nyb2xsSGFuZGxlciwgY2hlY2tTY3JvbGxSZXNldCwgbGFzdFJvd0NlbGxCb3JkZXJVcGRhdGVkIH0gZnJvbSAnLi4vYmFzZS9jb25zdGFudCc7XG5pbXBvcnQgeyBDb2x1bW5XaWR0aFNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy93aWR0aC1jb250cm9sbGVyJztcbmltcG9ydCAqIGFzIGxpdGVyYWxzIGZyb20gJy4uL2Jhc2Uvc3RyaW5nLWxpdGVyYWxzJztcbmltcG9ydCAqIGFzIGV2ZW50cyBmcm9tICcuLi9iYXNlL2NvbnN0YW50Jztcbi8qKlxuICogVGhlIGBTY3JvbGxgIG1vZHVsZSBpcyB1c2VkIHRvIGhhbmRsZSBzY3JvbGxpbmcgYmVoYXZpb3VyLlxuICovXG52YXIgU2Nyb2xsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIGZvciB0aGUgR3JpZCBzY3JvbGxpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0lHcmlkfSBwYXJlbnQgLSBzcGVjaWZpZXMgdGhlIElHcmlkXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNjcm9sbChwYXJlbnQpIHtcbiAgICAgICAgLy9UbyBtYWludGFpbiBzY3JvbGwgc3RhdGUgb24gZ3JpZCBhY3Rpb25zLlxuICAgICAgICB0aGlzLnByZXZpb3VzVmFsdWVzID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcbiAgICAgICAgdGhpcy5vbmVUaW1lUmVhZHkgPSB0cnVlO1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy53aWR0aFNlcnZpY2UgPSBuZXcgQ29sdW1uV2lkdGhTZXJ2aWNlKHBhcmVudCk7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3IgaW50ZXJuYWwgdXNlIG9ubHkgLSBHZXQgdGhlIG1vZHVsZSBuYW1lLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3N0cmluZ30gcmV0dXJucyB0aGUgbW9kdWxlIG5hbWVcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIFNjcm9sbC5wcm90b3R5cGUuZ2V0TW9kdWxlTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICdzY3JvbGwnO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtib29sZWFufSB1aXVwZGF0ZSAtIHNwZWNpZmllcyB0aGUgdWl1cGRhdGVcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgU2Nyb2xsLnByb3RvdHlwZS5zZXRXaWR0aCA9IGZ1bmN0aW9uICh1aXVwZGF0ZSkge1xuICAgICAgICB0aGlzLnBhcmVudC5lbGVtZW50LnN0eWxlLndpZHRoID0gZm9ybWF0VW5pdCh0aGlzLnBhcmVudC53aWR0aCk7XG4gICAgICAgIGlmICh1aXVwZGF0ZSkge1xuICAgICAgICAgICAgdGhpcy53aWR0aFNlcnZpY2Uuc2V0V2lkdGhUb0NvbHVtbnMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQudG9vbGJhck1vZHVsZSAmJiB0aGlzLnBhcmVudC50b29sYmFyTW9kdWxlLnRvb2xiYXIgJiZcbiAgICAgICAgICAgIHRoaXMucGFyZW50LnRvb2xiYXJNb2R1bGUudG9vbGJhci5lbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgdGxickVsZW1lbnQgPSB0aGlzLnBhcmVudC50b29sYmFyTW9kdWxlLnRvb2xiYXIuZWxlbWVudDtcbiAgICAgICAgICAgIHZhciB0bGJyTGVmdEVsZW1lbnQgPSB0bGJyRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS10b29sYmFyLWxlZnQnKTtcbiAgICAgICAgICAgIHZhciB0bGJyQ2VudGVyRWxlbWVudCA9IHRsYnJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXRvb2xiYXItY2VudGVyJyk7XG4gICAgICAgICAgICB2YXIgdGxiclJpZ2h0RWxlbWVudCA9IHRsYnJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXRvb2xiYXItcmlnaHQnKTtcbiAgICAgICAgICAgIHZhciB0bGJySXRlbXMgPSB0bGJyRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS10b29sYmFyLWl0ZW1zJyk7XG4gICAgICAgICAgICB2YXIgdGxickxlZnRXaWR0aCA9IHRsYnJMZWZ0RWxlbWVudCA/IHRsYnJMZWZ0RWxlbWVudC5jbGllbnRXaWR0aCA6IDA7XG4gICAgICAgICAgICB2YXIgdGxickNlbnRlcldpZHRoID0gdGxickNlbnRlckVsZW1lbnQgPyB0bGJyQ2VudGVyRWxlbWVudC5jbGllbnRXaWR0aCA6IDA7XG4gICAgICAgICAgICB2YXIgdGxiclJpZ2h0V2lkdGggPSB0bGJyUmlnaHRFbGVtZW50ID8gdGxiclJpZ2h0RWxlbWVudC5jbGllbnRXaWR0aCA6IDA7XG4gICAgICAgICAgICB2YXIgdGxickl0ZW1zV2lkdGggPSB0bGJySXRlbXMgPyB0bGJySXRlbXMuY2xpZW50V2lkdGggOiAwO1xuICAgICAgICAgICAgdmFyIHRsYnJXaWR0aCA9IHRsYnJFbGVtZW50ID8gdGxickVsZW1lbnQuY2xpZW50V2lkdGggOiAwO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5lbmFibGVBZGFwdGl2ZVVJIHx8IHRsYnJMZWZ0V2lkdGggPiB0bGJyV2lkdGggfHwgdGxickNlbnRlcldpZHRoID4gdGxicldpZHRoIHx8IHRsYnJSaWdodFdpZHRoID4gdGxicldpZHRoIHx8XG4gICAgICAgICAgICAgICAgdGxickl0ZW1zV2lkdGggPiB0bGJyV2lkdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC50b29sYmFyTW9kdWxlLnRvb2xiYXIucmVmcmVzaE92ZXJmbG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTY3JvbGwucHJvdG90eXBlLnNldEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1IZHJIZWlnaHQgPSAwO1xuICAgICAgICB2YXIgY29udGVudCA9IHRoaXMucGFyZW50LmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmNvbnRlbnQpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gdGhpcy5wYXJlbnQuaGVpZ2h0O1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgdGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkgJiYgdGhpcy5wYXJlbnQuaGVpZ2h0ICE9PSAnYXV0bydcbiAgICAgICAgICAgICYmIHRoaXMucGFyZW50LmhlaWdodC50b1N0cmluZygpLmluZGV4T2YoJyUnKSA8IDApIHtcbiAgICAgICAgICAgIGhlaWdodCA9IHBhcnNlSW50KGhlaWdodCwgMTApIC0gU2Nyb2xsLmdldFNjcm9sbEJhcldpZHRoKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiB0aGlzLnBhcmVudC5mcm96ZW5Sb3dzICYmIHRoaXMucGFyZW50LmhlaWdodCAhPT0gJ2F1dG8nICYmXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5oZWlnaHQgIT09ICcxMDAlJykge1xuICAgICAgICAgICAgdmFyIHRib2R5ID0gdGhpcy5wYXJlbnQuZ2V0SGVhZGVyQ29udGVudCgpXG4gICAgICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkgKyAnOm5vdCguZS1tYXNrZWQtdGJvZHkpJyk7XG4gICAgICAgICAgICBtSGRySGVpZ2h0ID0gdGJvZHkgPyB0Ym9keS5vZmZzZXRIZWlnaHQgOiAwO1xuICAgICAgICAgICAgaWYgKHRib2R5ICYmIG1IZHJIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgYWRkID0gdGJvZHkuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShsaXRlcmFscy5hZGRlZFJvdykubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhciBoZWlnaHRfMSA9IGFkZCAqIHRoaXMucGFyZW50LmdldFJvd0hlaWdodCgpO1xuICAgICAgICAgICAgICAgIG1IZHJIZWlnaHQgLT0gaGVpZ2h0XzE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghdGhpcy5wYXJlbnQuaXNJbml0aWFsTG9hZCAmJiB0aGlzLnBhcmVudC5sb2FkaW5nSW5kaWNhdG9yLmluZGljYXRvclR5cGUgPT09ICdTaGltbWVyJ1xuICAgICAgICAgICAgICAgICYmIHRoaXMucGFyZW50LmdldEhlYWRlckNvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuZS1tYXNrZWQtdGFibGUnKSkge1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IHBhcnNlSW50KGhlaWdodCwgMTApIC0gKHRoaXMucGFyZW50LmZyb3plblJvd3MgKiB0aGlzLnBhcmVudC5nZXRSb3dIZWlnaHQoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IGZvcm1hdFVuaXQocGFyc2VJbnQoaGVpZ2h0LCAxMCkgLSBtSGRySGVpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gZm9ybWF0VW5pdChoZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW5zdXJlT3ZlcmZsb3coY29udGVudCk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTY3JvbGwucHJvdG90eXBlLnNldFBhZGRpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5wYXJlbnQuZ2V0SGVhZGVyQ29udGVudCgpO1xuICAgICAgICB2YXIgc2Nyb2xsV2lkdGggPSBTY3JvbGwuZ2V0U2Nyb2xsQmFyV2lkdGgoKSAtIHRoaXMuZ2V0VGhyZXNob2xkKCk7XG4gICAgICAgIHZhciBjc3NQcm9wcyA9IHRoaXMuZ2V0Q3NzUHJvcGVydGllcygpO1xuICAgICAgICBjb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuaGVhZGVyQ29udGVudCkuc3R5bGVbY3NzUHJvcHMuYm9yZGVyXSA9IHNjcm9sbFdpZHRoID4gMCA/ICcxcHgnIDogJzBweCc7XG4gICAgICAgIGNvbnRlbnQuc3R5bGVbY3NzUHJvcHMucGFkZGluZ10gPSBzY3JvbGxXaWR0aCA+IDAgPyBzY3JvbGxXaWR0aCArICdweCcgOiAnMHB4JztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gcnRsIC0gc3BlY2lmaWVzIHRoZSBydGxcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgU2Nyb2xsLnByb3RvdHlwZS5yZW1vdmVQYWRkaW5nID0gZnVuY3Rpb24gKHJ0bCkge1xuICAgICAgICB2YXIgY3NzUHJvcHMgPSB0aGlzLmdldENzc1Byb3BlcnRpZXMocnRsKTtcbiAgICAgICAgdmFyIGhEaXYgPSB0aGlzLnBhcmVudC5nZXRIZWFkZXJDb250ZW50KCkucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5oZWFkZXJDb250ZW50KTtcbiAgICAgICAgaERpdi5zdHlsZVtjc3NQcm9wcy5ib3JkZXJdID0gJyc7XG4gICAgICAgIGhEaXYucGFyZW50RWxlbWVudC5zdHlsZVtjc3NQcm9wcy5wYWRkaW5nXSA9ICcnO1xuICAgICAgICB2YXIgZm9vdGVyRGl2ID0gdGhpcy5wYXJlbnQuZ2V0Rm9vdGVyQ29udGVudCgpO1xuICAgICAgICBpZiAoZm9vdGVyRGl2ICYmIGZvb3RlckRpdi5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZm9vdGVycGFkZGluZycpKSB7XG4gICAgICAgICAgICBmb290ZXJEaXYuY2xhc3NMaXN0LnJlbW92ZSgnZS1mb290ZXJwYWRkaW5nJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlZnJlc2ggbWFrZXMgdGhlIEdyaWQgYWRvcHRhYmxlIHdpdGggdGhlIGhlaWdodCBvZiBwYXJlbnQgY29udGFpbmVyLlxuICAgICAqXG4gICAgICogPiBUaGUgW2BoZWlnaHRgXSguLyNoZWlnaHQpIG11c3QgYmUgc2V0IHRvIDEwMCUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBTY3JvbGwucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5oZWlnaHQgIT09ICcxMDAlJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpO1xuICAgICAgICB0aGlzLnBhcmVudC5lbGVtZW50LnN0eWxlLmhlaWdodCA9ICcxMDAlJztcbiAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMud2lkdGhTZXJ2aWNlLmdldFNpYmxpbmdzSGVpZ2h0KGNvbnRlbnQpO1xuICAgICAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9ICdjYWxjKDEwMCUgLSAnICsgaGVpZ2h0ICsgJ3B4KSc7IC8vU2V0IHRoZSBoZWlnaHQgdG8gdGhlICAnLicgKyBsaXRlcmFscy5ncmlkQ29udGVudDtcbiAgICB9O1xuICAgIFNjcm9sbC5wcm90b3R5cGUuZ2V0VGhyZXNob2xkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvKiBTb21lIGJyb3dzZXJzIHBsYWNlcyB0aGUgc2Nyb2xsZXIgb3V0c2lkZSB0aGUgY29udGVudCxcbiAgICAgICAgICogaGVuY2UgdGhlIHBhZGRpbmcgc2hvdWxkIGJlIGFkanVzdGVkLiovXG4gICAgICAgIHZhciBhcHBOYW1lID0gQnJvd3Nlci5pbmZvLm5hbWU7XG4gICAgICAgIGlmIChhcHBOYW1lID09PSAnbW96aWxsYScpIHtcbiAgICAgICAgICAgIHJldHVybiAwLjU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgU2Nyb2xsLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5vbihvbkVtcHR5LCB0aGlzLndpcmVFdmVudHMsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihjb250ZW50UmVhZHksIHRoaXMud2lyZUV2ZW50cywgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKHVpVXBkYXRlLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub24odGV4dFdyYXBSZWZyZXNoLCB0aGlzLndpcmVFdmVudHMsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihoZWFkZXJSZWZyZXNoZWQsIHRoaXMuc2V0U2Nyb2xsTGVmdCwgdGhpcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgU2Nyb2xsLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5vZmYob25FbXB0eSwgdGhpcy53aXJlRXZlbnRzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGNvbnRlbnRSZWFkeSwgdGhpcy53aXJlRXZlbnRzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKHVpVXBkYXRlLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2VkKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKHRleHRXcmFwUmVmcmVzaCwgdGhpcy53aXJlRXZlbnRzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGhlYWRlclJlZnJlc2hlZCwgdGhpcy5zZXRTY3JvbGxMZWZ0KTtcbiAgICAgICAgdGhpcy51bndpcmVFdmVudHMoKTtcbiAgICB9O1xuICAgIFNjcm9sbC5wcm90b3R5cGUudW53aXJlRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cyAmJiB0aGlzLmhlYWRlcikge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmhlYWRlciwgJ3RvdWNoc3RhcnQgcG9pbnRlcmRvd24nLCB0aGlzLnNldFBhZ2VYWSk7XG4gICAgICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuaGVhZGVyLCAndG91Y2htb3ZlIHBvaW50ZXJtb3ZlJywgdGhpcy5vblRvdWNoU2Nyb2xsKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbVNjcm9sbEJhciA9IHRoaXMucGFyZW50LmdldENvbnRlbnQoKSA/IHRoaXMucGFyZW50LmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuZS1tb3ZhYmxlc2Nyb2xsYmFyJykgOiBudWxsO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkgJiYgdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgIGlmIChtU2Nyb2xsQmFyKSB7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZShtU2Nyb2xsQmFyLCAnc2Nyb2xsJywgdGhpcy5vbkN1c3RvbVNjcm9sbGJhclNjcm9sbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmNvbnRlbnQsICdzY3JvbGwnLCB0aGlzLm9uQ3VzdG9tU2Nyb2xsYmFyU2Nyb2xsKTtcbiAgICAgICAgICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuY29udGVudCwgJ3RvdWNoc3RhcnQgcG9pbnRlcmRvd24nLCB0aGlzLnNldFBhZ2VYWSk7XG4gICAgICAgICAgICAgICAgaWYgKCEoL21hY2ludG9zaHxpcGFkLy50ZXN0KEJyb3dzZXIudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpICYmIEJyb3dzZXIuaXNEZXZpY2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5jb250ZW50LCAndG91Y2htb3ZlIHBvaW50ZXJtb3ZlJywgdGhpcy5vblRvdWNoU2Nyb2xsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5oZWFkZXIpIHtcbiAgICAgICAgICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuaGVhZGVyLCAnc2Nyb2xsJywgdGhpcy5vbkN1c3RvbVNjcm9sbGJhclNjcm9sbCk7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmhlYWRlciwgJ3RvdWNoc3RhcnQgcG9pbnRlcmRvd24nLCB0aGlzLnNldFBhZ2VYWSk7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmhlYWRlciwgJ3RvdWNobW92ZSBwb2ludGVybW92ZScsIHRoaXMub25Ub3VjaFNjcm9sbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29udGVudCkge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmNvbnRlbnQsICdzY3JvbGwnLCB0aGlzLmNvbnRlbnRTY3JvbGxIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5oZWFkZXIpIHtcbiAgICAgICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5oZWFkZXIsICdzY3JvbGwnLCB0aGlzLmhlYWRlclNjcm9sbEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udGVudFNjcm9sbEhhbmRsZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmhlYWRlclNjcm9sbEhhbmRsZXIgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWdncmVnYXRlcy5sZW5ndGggJiYgdGhpcy5wYXJlbnQuZ2V0Rm9vdGVyQ29udGVudCgpKSB7XG4gICAgICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMucGFyZW50LmdldEZvb3RlckNvbnRlbnQoKS5maXJzdENoaWxkLCAnc2Nyb2xsJywgdGhpcy5vbkNvbnRlbnRTY3JvbGwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTY3JvbGwucHJvdG90eXBlLnNldFNjcm9sbExlZnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucGFyZW50LmdldEhlYWRlckNvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmhlYWRlckNvbnRlbnQpLnNjcm9sbExlZnQgPSB0aGlzLnByZXZpb3VzVmFsdWVzLmxlZnQ7XG4gICAgfTtcbiAgICBTY3JvbGwucHJvdG90eXBlLm9uQ29udGVudFNjcm9sbCA9IGZ1bmN0aW9uIChzY3JvbGxUYXJnZXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBzY3JvbGxUYXJnZXQ7XG4gICAgICAgIHZhciBpc0hlYWRlciA9IGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGxpdGVyYWxzLmhlYWRlckNvbnRlbnQpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChfdGhpcy5jb250ZW50LnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpID09PSBudWxsIHx8IF90aGlzLnBhcmVudC5pc1ByZXZlbnRTY3JvbGxFdmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuZnJvemVuUm93cykge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5jb250ZW50LnNjcm9sbFRvcCA+IDAgJiYgX3RoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3MoW190aGlzLnBhcmVudC5lbGVtZW50XSwgJ2UtdG9wLXNoYWRvdycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoW190aGlzLnBhcmVudC5lbGVtZW50XSwgJ2UtdG9wLXNoYWRvdycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZS1sZWZ0ZnJlZXplLC5lLWZpeGVkZnJlZXplLC5lLXJpZ2h0ZnJlZXplJykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVycm9yRnJlZXplID0gX3RoaXMucGFyZW50LmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yQWxsKCcuZS1mcmVlemVlcnJvcjpub3QoW3N0eWxlKj1cImRpc3BsYXk6IG5vbmVcIl0pJyk7XG4gICAgICAgICAgICAgICAgdmFyIGVycm9yRml4ZWQgPSBfdGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLWZpeGVkZXJyb3I6bm90KFtzdHlsZSo9XCJkaXNwbGF5OiBub25lXCJdKScpO1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxMZWZ0ID0gX3RoaXMucGFyZW50LmVuYWJsZVJ0bCA/IE1hdGguYWJzKHRhcmdldC5zY3JvbGxMZWZ0KSA6IHRhcmdldC5zY3JvbGxMZWZ0O1xuICAgICAgICAgICAgICAgIHZhciBpc1N0YXJ0T2ZTY3JvbGwgPSBzY3JvbGxMZWZ0IDw9IDE7XG4gICAgICAgICAgICAgICAgaWYgKCFpc1N0YXJ0T2ZTY3JvbGwgJiYgX3RoaXMucGFyZW50LmdldFZpc2libGVGcm96ZW5MZWZ0Q291bnQoKSkge1xuICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhbX3RoaXMucGFyZW50LmVsZW1lbnRdLCAnZS1sZWZ0LXNoYWRvdycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoW190aGlzLnBhcmVudC5lbGVtZW50XSwgJ2UtbGVmdC1zaGFkb3cnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbFJpZ2h0ID0gX3RoaXMucGFyZW50LmVuYWJsZVJ0bCA/IE1hdGguYWJzKHRhcmdldC5zY3JvbGxMZWZ0KSA6IHRhcmdldC5zY3JvbGxMZWZ0O1xuICAgICAgICAgICAgICAgIHZhciBpc0VuZE9mU2Nyb2xsID0gTWF0aC5yb3VuZChzY3JvbGxSaWdodCArIHRhcmdldC5jbGllbnRXaWR0aCkgPj0gdGFyZ2V0LnNjcm9sbFdpZHRoIC0gMTtcbiAgICAgICAgICAgICAgICBpZiAoaXNFbmRPZlNjcm9sbCAmJiBfdGhpcy5wYXJlbnQuZ2V0VmlzaWJsZUZyb3plblJpZ2h0Q291bnQoKSkge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhbX3RoaXMucGFyZW50LmVsZW1lbnRdLCAnZS1yaWdodC1zaGFkb3cnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZENsYXNzKFtfdGhpcy5wYXJlbnQuZWxlbWVudF0sICdlLXJpZ2h0LXNoYWRvdycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcm93cyA9IFtdLnNsaWNlLmNhbGwoX3RoaXMucGFyZW50LmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yQWxsKCcuZS1yb3c6bm90KC5lLWhpZGRlbnJvdyknKSk7XG4gICAgICAgICAgICAgICAgaWYgKCgocm93cy5sZW5ndGggPT09IDEgJiYgZXJyb3JGcmVlemUubGVuZ3RoKSB8fFxuICAgICAgICAgICAgICAgICAgICAoX3RoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZnJlZXplLWF1dG9maWxsOm5vdChbc3R5bGUqPVwiZGlzcGxheTogbm9uZVwiXSknKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JGaXhlZC5sZW5ndGgpICYmIHRhcmdldC5zY3JvbGxMZWZ0ICE9PSBfdGhpcy5wcmV2aW91c1ZhbHVlcy5sZWZ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5zY3JvbGxMZWZ0ID0gX3RoaXMucHJldmlvdXNWYWx1ZXMubGVmdDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocm93cy5sZW5ndGggIT09IDEgJiYgKGVycm9yRnJlZXplLmxlbmd0aCB8fCBlcnJvckZpeGVkLmxlbmd0aCkgJiYgdGFyZ2V0LnNjcm9sbFRvcCAhPT0gX3RoaXMucHJldmlvdXNWYWx1ZXMudG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5zY3JvbGxUb3AgPSBfdGhpcy5wcmV2aW91c1ZhbHVlcy50b3A7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbGVmdCA9IHRhcmdldC5zY3JvbGxMZWZ0O1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChfdGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxNb2R1bGUpICYmIF90aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyAmJiAoIV90aGlzLnBhcmVudC5pc0VkaXRcbiAgICAgICAgICAgICAgICB8fCAoX3RoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmICFfdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1lZGl0ZWRyb3cnKSkpKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucGFyZW50Lm5vdGlmeShpbmZpbml0ZVNjcm9sbEhhbmRsZXIsIHsgdGFyZ2V0OiBlLnRhcmdldCwgaXNMZWZ0OiBfdGhpcy5wcmV2aW91c1ZhbHVlcy5sZWZ0ICE9PSBsZWZ0IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICYmIF90aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlzRG93biA9IF90aGlzLnByZXZpb3VzVmFsdWVzLnRvcCA8IF90aGlzLnBhcmVudC5nZXRDb250ZW50KCkuZmlyc3RFbGVtZW50Q2hpbGQuc2Nyb2xsVG9wO1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkobGF6eUxvYWRTY3JvbGxIYW5kbGVyLCB7IHNjcm9sbERvd246IGlzRG93biB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkodmlydHVhbFNjcm9sbEVkaXQsIHt9KTtcbiAgICAgICAgICAgIHZhciBpc0Zvb3RlciA9IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2Utc3VtbWFyeWNvbnRlbnQnKTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5wcmV2aW91c1ZhbHVlcy5sZWZ0ID09PSBsZWZ0KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucHJldmlvdXNWYWx1ZXMudG9wID0gIWlzSGVhZGVyID8gX3RoaXMucHJldmlvdXNWYWx1ZXMudG9wIDogdGFyZ2V0LnNjcm9sbFRvcDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGNsb3NlRmlsdGVyRGlhbG9nLCBlKTtcbiAgICAgICAgICAgIGVsZW1lbnQuc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gICAgICAgICAgICBpZiAoaXNGb290ZXIpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5oZWFkZXIuc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5wcmV2aW91c1ZhbHVlcy5sZWZ0ID0gbGVmdDtcbiAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoc2Nyb2xsLCB7IGxlZnQ6IGxlZnQgfSk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBTY3JvbGwucHJvdG90eXBlLm9uQ3VzdG9tU2Nyb2xsYmFyU2Nyb2xsID0gZnVuY3Rpb24gKGNvbnQsIGhkcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY29udGVudCA9IGNvbnQ7XG4gICAgICAgIHZhciBoZWFkZXIgPSBoZHI7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKF90aGlzLmNvbnRlbnQucXVlcnlTZWxlY3RvcihsaXRlcmFscy50Ym9keSkgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgICAgICB2YXIgbGVmdCA9IHRhcmdldC5zY3JvbGxMZWZ0O1xuICAgICAgICAgICAgaWYgKF90aGlzLnByZXZpb3VzVmFsdWVzLmxlZnQgPT09IGxlZnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZW50LnNjcm9sbExlZnQgPSBsZWZ0O1xuICAgICAgICAgICAgaGVhZGVyLnNjcm9sbExlZnQgPSBsZWZ0O1xuICAgICAgICAgICAgX3RoaXMucHJldmlvdXNWYWx1ZXMubGVmdCA9IGxlZnQ7XG4gICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KHNjcm9sbCwgeyBsZWZ0OiBsZWZ0IH0pO1xuICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFNjcm9sbC5wcm90b3R5cGUub25Ub3VjaFNjcm9sbCA9IGZ1bmN0aW9uIChzY3JvbGxUYXJnZXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBzY3JvbGxUYXJnZXQ7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGUucG9pbnRlclR5cGUgPT09ICdtb3VzZScpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaXNGcm96ZW4gPSBfdGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCk7XG4gICAgICAgICAgICB2YXIgcGFnZVhZID0gX3RoaXMuZ2V0UG9pbnRYWShlKTtcbiAgICAgICAgICAgIHZhciBsZWZ0ID0gZWxlbWVudC5zY3JvbGxMZWZ0ICsgKF90aGlzLnBhZ2VYWS54IC0gcGFnZVhZLngpO1xuICAgICAgICAgICAgdmFyIG1IZHIgPSBfdGhpcy5wYXJlbnQuZ2V0SGVhZGVyQ29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuaGVhZGVyQ29udGVudCk7XG4gICAgICAgICAgICB2YXIgbUNvbnQgPSBfdGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuY29udGVudCk7XG4gICAgICAgICAgICBpZiAoX3RoaXMucHJldmlvdXNWYWx1ZXMubGVmdCA9PT0gbGVmdCB8fCAobGVmdCA8IDAgfHwgKG1IZHIuc2Nyb2xsV2lkdGggLSBtSGRyLmNsaWVudFdpZHRoKSA8IGxlZnQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgbUhkci5zY3JvbGxMZWZ0ID0gbGVmdDtcbiAgICAgICAgICAgIG1Db250LnNjcm9sbExlZnQgPSBsZWZ0O1xuICAgICAgICAgICAgaWYgKGlzRnJvemVuICYmIF90aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxCYXIgPSBfdGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy5lLW1vdmFibGVzY3JvbGxiYXInKTtcbiAgICAgICAgICAgICAgICBzY3JvbGxCYXIuc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5wYWdlWFkueCA9IHBhZ2VYWS54O1xuICAgICAgICAgICAgX3RoaXMucHJldmlvdXNWYWx1ZXMubGVmdCA9IGxlZnQ7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBTY3JvbGwucHJvdG90eXBlLnNldFBhZ2VYWSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoZS5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLnBhZ2VYWSA9IF90aGlzLmdldFBvaW50WFkoZSk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBTY3JvbGwucHJvdG90eXBlLmdldFBvaW50WFkgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgcGFnZVhZID0geyB4OiAwLCB5OiAwIH07XG4gICAgICAgIGlmIChlLnRvdWNoZXMgJiYgZS50b3VjaGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgcGFnZVhZLnggPSBlLnRvdWNoZXNbMF0ucGFnZVg7XG4gICAgICAgICAgICBwYWdlWFkueSA9IGUudG91Y2hlc1swXS5wYWdlWTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHBhZ2VYWS54ID0gZS5wYWdlWDtcbiAgICAgICAgICAgIHBhZ2VYWS55ID0gZS5wYWdlWTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFnZVhZO1xuICAgIH07XG4gICAgU2Nyb2xsLnByb3RvdHlwZS5nZXRTY3JvbGxibGVQYXJlbnQgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICBpZiAobm9kZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgdmFyIHBhcmVudCA9IGlzTnVsbE9yVW5kZWZpbmVkKG5vZGUudGFnTmFtZSkgPyBub2RlLnNjcm9sbGluZ0VsZW1lbnQgOiBub2RlO1xuICAgICAgICB2YXIgb3ZlcmZsb3dZID0gZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShwYXJlbnQsIG51bGwpLm92ZXJmbG93WTtcbiAgICAgICAgaWYgKHBhcmVudC5zY3JvbGxIZWlnaHQgPiBwYXJlbnQuY2xpZW50SGVpZ2h0ICYmIG92ZXJmbG93WSAhPT0gJ2hpZGRlbidcbiAgICAgICAgICAgICYmIG92ZXJmbG93WSAhPT0gJ3Zpc2libGUnIHx8IG5vZGUudGFnTmFtZSA9PT0gJ0hUTUwnIHx8IG5vZGUudGFnTmFtZSA9PT0gJ0JPRFknKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFNjcm9sbGJsZVBhcmVudChub2RlLnBhcmVudE5vZGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzQWRkIC0gc3BlY2lmaWVzIHdoZXRoZXIgYWRkaW5nL3JlbW92aW5nIHRoZSBldmVudFxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTY3JvbGwucHJvdG90eXBlLmFkZFN0aWNreUxpc3RlbmVyID0gZnVuY3Rpb24gKGlzQWRkKSB7XG4gICAgICAgIHRoaXMucGFyZW50RWxlbWVudCA9IHRoaXMuZ2V0U2Nyb2xsYmxlUGFyZW50KHRoaXMucGFyZW50LmVsZW1lbnQucGFyZW50RWxlbWVudCk7XG4gICAgICAgIGlmIChpc0FkZCAmJiB0aGlzLnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRFbGVtZW50ID0gdGhpcy5wYXJlbnRFbGVtZW50LnRhZ05hbWUgPT09ICdIVE1MJyB8fCB0aGlzLnBhcmVudEVsZW1lbnQudGFnTmFtZSA9PT0gJ0JPRFknID8gZG9jdW1lbnQgOlxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5ldmVudEVsZW1lbnQsICdzY3JvbGwnLCB0aGlzLm1ha2VTdGlja3lIZWFkZXIsIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuZXZlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZXZlbnRFbGVtZW50LCAnc2Nyb2xsJywgdGhpcy5tYWtlU3RpY2t5SGVhZGVyKTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNjcm9sbC5wcm90b3R5cGUucmVzaXplRnJvemVuUm93Qm9yZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGl2O1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZnJvemVucm93LWJvcmRlcicpKSB7XG4gICAgICAgICAgICBkaXYgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtZnJvemVucm93LWJvcmRlcicgfSk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5lbGVtZW50Lmluc2VydEJlZm9yZShkaXYsIHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZ3JpZGNvbnRlbnQnKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkaXYgPSB0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWZyb3plbnJvdy1ib3JkZXInKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2Nyb2xsV2lkdGggPSB0aGlzLnBhcmVudC5oZWlnaHQgIT09ICdhdXRvJyA/IFNjcm9sbC5nZXRTY3JvbGxCYXJXaWR0aCgpIDogMDtcbiAgICAgICAgZGl2LnN0eWxlLndpZHRoID0gKHRoaXMucGFyZW50LmVsZW1lbnQub2Zmc2V0V2lkdGggLSBzY3JvbGxXaWR0aCkgLSAwLjUgKyAncHgnO1xuICAgIH07XG4gICAgU2Nyb2xsLnByb3RvdHlwZS53aXJlRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5vbmVUaW1lUmVhZHkpIHtcbiAgICAgICAgICAgIHZhciBmcnpDb2xzID0gdGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQgPSB0aGlzLnBhcmVudC5nZXRDb250ZW50KCkucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5jb250ZW50KTtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyID0gdGhpcy5wYXJlbnQuZ2V0SGVhZGVyQ29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuaGVhZGVyQ29udGVudCk7XG4gICAgICAgICAgICB2YXIgbVNjcm9sbEJhciA9IHRoaXMucGFyZW50LmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuZS1tb3ZhYmxlc2Nyb2xsYmFyJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cyAmJiB0aGlzLmhlYWRlciAmJiB0aGlzLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMuaGVhZGVyLCAndG91Y2hzdGFydCBwb2ludGVyZG93bicsIHRoaXMuc2V0UGFnZVhZKCksIHRoaXMpO1xuICAgICAgICAgICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5oZWFkZXIsICd0b3VjaG1vdmUgcG9pbnRlcm1vdmUnLCB0aGlzLm9uVG91Y2hTY3JvbGwodGhpcy5jb250ZW50KSwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZnJ6Q29scyAmJiBtU2Nyb2xsQmFyICYmIHRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZChtU2Nyb2xsQmFyLCAnc2Nyb2xsJywgdGhpcy5vbkN1c3RvbVNjcm9sbGJhclNjcm9sbCh0aGlzLmNvbnRlbnQsIHRoaXMuaGVhZGVyKSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmNvbnRlbnQsICdzY3JvbGwnLCB0aGlzLm9uQ3VzdG9tU2Nyb2xsYmFyU2Nyb2xsKG1TY3JvbGxCYXIsIHRoaXMuaGVhZGVyKSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmhlYWRlciwgJ3Njcm9sbCcsIHRoaXMub25DdXN0b21TY3JvbGxiYXJTY3JvbGwobVNjcm9sbEJhciwgdGhpcy5jb250ZW50KSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmhlYWRlciwgJ3RvdWNoc3RhcnQgcG9pbnRlcmRvd24nLCB0aGlzLnNldFBhZ2VYWSgpLCB0aGlzKTtcbiAgICAgICAgICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMuaGVhZGVyLCAndG91Y2htb3ZlIHBvaW50ZXJtb3ZlJywgdGhpcy5vblRvdWNoU2Nyb2xsKHRoaXMuY29udGVudCksIHRoaXMpO1xuICAgICAgICAgICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5jb250ZW50LCAndG91Y2hzdGFydCBwb2ludGVyZG93bicsIHRoaXMuc2V0UGFnZVhZKCksIHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmICghKC9tYWNpbnRvc2h8aXBhZC8udGVzdChCcm93c2VyLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKSAmJiBCcm93c2VyLmlzRGV2aWNlKSkge1xuICAgICAgICAgICAgICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMuY29udGVudCwgJ3RvdWNobW92ZSBwb2ludGVybW92ZScsIHRoaXMub25Ub3VjaFNjcm9sbCh0aGlzLmhlYWRlciksIHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29udGVudFNjcm9sbEhhbmRsZXIgPSB0aGlzLm9uQ29udGVudFNjcm9sbCh0aGlzLmhlYWRlcik7XG4gICAgICAgICAgICB0aGlzLmhlYWRlclNjcm9sbEhhbmRsZXIgPSB0aGlzLm9uQ29udGVudFNjcm9sbCh0aGlzLmNvbnRlbnQpO1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmNvbnRlbnQsICdzY3JvbGwnLCB0aGlzLmNvbnRlbnRTY3JvbGxIYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5oZWFkZXIsICdzY3JvbGwnLCB0aGlzLmhlYWRlclNjcm9sbEhhbmRsZXIsIHRoaXMpO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmFnZ3JlZ2F0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnBhcmVudC5nZXRGb290ZXJDb250ZW50KCkuZmlyc3RDaGlsZCwgJ3Njcm9sbCcsIHRoaXMub25Db250ZW50U2Nyb2xsKHRoaXMuY29udGVudCksIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZVN0aWNreUhlYWRlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkU3RpY2t5TGlzdGVuZXIodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgICAgIHRoaXMub25lVGltZVJlYWR5ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRhYmxlID0gdGhpcy5wYXJlbnQuZ2V0Q29udGVudFRhYmxlKCk7XG4gICAgICAgIHZhciBzTGVmdDtcbiAgICAgICAgdmFyIHNIZWlnaHQ7XG4gICAgICAgIHZhciBjbGllbnRIZWlnaHQ7XG4gICAgICAgIGdldFVwZGF0ZVVzaW5nUmFmKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNMZWZ0ID0gX3RoaXMuaGVhZGVyLnNjcm9sbExlZnQ7XG4gICAgICAgICAgICBzSGVpZ2h0ID0gdGFibGUuc2Nyb2xsSGVpZ2h0O1xuICAgICAgICAgICAgY2xpZW50SGVpZ2h0ID0gX3RoaXMucGFyZW50LmdldENvbnRlbnQoKS5jbGllbnRIZWlnaHQ7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0geyBjYW5jZWw6IGZhbHNlIH07XG4gICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGNoZWNrU2Nyb2xsUmVzZXQsIGFyZ3MpO1xuICAgICAgICAgICAgaWYgKHNIZWlnaHQgPCBjbGllbnRIZWlnaHQgJiYgX3RoaXMucGFyZW50LmhlaWdodCAhPT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0TGFzdFJvd0NlbGwoKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGxhc3RSb3dDZWxsQm9yZGVyVXBkYXRlZCwgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5yZXNpemVGcm96ZW5Sb3dCb3JkZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghX3RoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uICYmICFfdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWFyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmhlYWRlci5zY3JvbGxMZWZ0ID0gX3RoaXMucHJldmlvdXNWYWx1ZXMubGVmdDtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29udGVudC5zY3JvbGxMZWZ0ID0gX3RoaXMucHJldmlvdXNWYWx1ZXMubGVmdDtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29udGVudC5zY3JvbGxUb3AgPSBfdGhpcy5wcmV2aW91c1ZhbHVlcy50b3A7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFfdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5jb250ZW50LnNjcm9sbExlZnQgPSBzTGVmdDtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmlzRnJvemVuR3JpZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnByZXZpb3VzVmFsdWVzLmxlZnQgPSBzTGVmdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBhcmVudC5pc1ByZXZlbnRTY3JvbGxFdmVudCA9IGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9IHJldHVybnMgdm9pZFxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTY3JvbGwucHJvdG90eXBlLnNldExhc3RSb3dDZWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFibGUgPSB0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKTtcbiAgICAgICAgcmVtb3ZlQ2xhc3ModGFibGUucXVlcnlTZWxlY3RvckFsbCgndGQnKSwgJ2UtbGFzdHJvd2NlbGwnKTtcbiAgICAgICAgaWYgKHRhYmxlLnF1ZXJ5U2VsZWN0b3IoJ3RyOm50aC1sYXN0LWNoaWxkKDIpJykpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJiB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubmV3Um93UG9zaXRpb24gPT09ICdCb3R0b20nKSB7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3ModGFibGUucXVlcnlTZWxlY3RvcigndHI6bnRoLWxhc3QtY2hpbGQoMiknKS5xdWVyeVNlbGVjdG9yQWxsKCd0ZCcpLCAnZS1sYXN0cm93Y2VsbCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGFkZENsYXNzKHRhYmxlLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyOmxhc3QtY2hpbGQgdGQnKSwgJ2UtbGFzdHJvd2NlbGwnKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzU3Bhbikge1xuICAgICAgICAgICAgYWRkQ2xhc3ModGFibGUucXVlcnlTZWxlY3RvckFsbCgnLmUtcm93LXNwYW4tbGFzdHJvd2NlbGwnKSwgJ2UtbGFzdHJvd2NlbGwnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBydGwgLSBzcGVjaWZpZXMgdGhlIHJ0bFxuICAgICAqIEByZXR1cm5zIHtTY3JvbGxDc3N9IHJldHVybnMgdGhlIFNjcm9sbENzc1xuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTY3JvbGwucHJvdG90eXBlLmdldENzc1Byb3BlcnRpZXMgPSBmdW5jdGlvbiAocnRsKSB7XG4gICAgICAgIHZhciBjc3MgPSB7fTtcbiAgICAgICAgdmFyIGVuYWJsZVJ0bCA9IGlzTnVsbE9yVW5kZWZpbmVkKHJ0bCkgPyB0aGlzLnBhcmVudC5lbmFibGVSdGwgOiBydGw7XG4gICAgICAgIGNzcy5ib3JkZXIgPSBlbmFibGVSdGwgPyAnYm9yZGVyTGVmdFdpZHRoJyA6ICdib3JkZXJSaWdodFdpZHRoJztcbiAgICAgICAgY3NzLnBhZGRpbmcgPSBlbmFibGVSdGwgPyAncGFkZGluZ0xlZnQnIDogJ3BhZGRpbmdSaWdodCc7XG4gICAgICAgIHJldHVybiBjc3M7XG4gICAgfTtcbiAgICBTY3JvbGwucHJvdG90eXBlLmVuc3VyZU92ZXJmbG93ID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgY29udGVudC5zdHlsZS5vdmVyZmxvd1kgPSB0aGlzLnBhcmVudC5oZWlnaHQgPT09ICdhdXRvJyA/ICdhdXRvJyA6ICdzY3JvbGwnO1xuICAgIH07XG4gICAgU2Nyb2xsLnByb3RvdHlwZS5vblByb3BlcnR5Q2hhbmdlZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChlLm1vZHVsZSAhPT0gdGhpcy5nZXRNb2R1bGVOYW1lKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFBhZGRpbmcoKTtcbiAgICAgICAgdGhpcy5vbmVUaW1lUmVhZHkgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaGVpZ2h0ID09PSAnYXV0bycpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlUGFkZGluZygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud2lyZUV2ZW50cygpO1xuICAgICAgICB0aGlzLnNldEhlaWdodCgpO1xuICAgICAgICB2YXIgd2lkdGggPSAnd2lkdGgnO1xuICAgICAgICB0aGlzLnNldFdpZHRoKCFpc051bGxPclVuZGVmaW5lZChlLnByb3BlcnRpZXNbXCJcIiArIHdpZHRoXSkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNjcm9sbC5wcm90b3R5cGUubWFrZVN0aWNreUhlYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZVN0aWNreUhlYWRlciAmJiB0aGlzLnBhcmVudC5lbGVtZW50ICYmIHRoaXMucGFyZW50LmdldENvbnRlbnQoKSkge1xuICAgICAgICAgICAgdmFyIGNvbnRlbnRSZWN0ID0gdGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLmdldENsaWVudFJlY3RzKClbMF07XG4gICAgICAgICAgICBpZiAoY29udGVudFJlY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgd2luZG93U2NhbGUgPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbztcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVyRWxlID0gdGhpcy5wYXJlbnQuZ2V0SGVhZGVyQ29udGVudCgpO1xuICAgICAgICAgICAgICAgIHZhciB0b29sYmFyRWxlID0gdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS10b29sYmFyJyk7XG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwSGVhZGVyRWxlID0gdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1ncm91cGRyb3BhcmVhJyk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IGhlYWRlckVsZS5vZmZzZXRIZWlnaHQgKyAodG9vbGJhckVsZSA/IHRvb2xiYXJFbGUub2Zmc2V0SGVpZ2h0IDogMCkgK1xuICAgICAgICAgICAgICAgICAgICAoZ3JvdXBIZWFkZXJFbGUgPyBncm91cEhlYWRlckVsZS5vZmZzZXRIZWlnaHQgOiAwKTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50VG9wID0gdGhpcy5wYXJlbnRFbGVtZW50LmdldENsaWVudFJlY3RzKClbMF0udG9wO1xuICAgICAgICAgICAgICAgIHZhciB0b3BfMSA9IGNvbnRlbnRSZWN0LnRvcCAtIChwYXJlbnRUb3AgPCAwID8gMCA6IHBhcmVudFRvcCk7XG4gICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBjb250ZW50UmVjdC5sZWZ0O1xuICAgICAgICAgICAgICAgIHZhciBjb2xNZW51RWxlID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcjJyArIHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnX2NvbHVtbm1lbnUnKTtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93U2NhbGUgIT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9wXzEgPSBNYXRoLmNlaWwodG9wXzEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodG9wXzEgPCBoZWlnaHQgJiYgY29udGVudFJlY3QuYm90dG9tID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJFbGUuY2xhc3NMaXN0LmFkZCgnZS1zdGlja3knKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1Ub3AgPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBIZWFkZXJFbGUgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5zaG93RHJvcEFyZWEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RpY2t5KGdyb3VwSGVhZGVyRWxlLCBlbGVtVG9wLCBjb250ZW50UmVjdC53aWR0aCwgbGVmdCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtVG9wICs9IGdyb3VwSGVhZGVyRWxlLmdldENsaWVudFJlY3RzKClbMF0uaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b29sYmFyRWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0aWNreSh0b29sYmFyRWxlLCBlbGVtVG9wLCBjb250ZW50UmVjdC53aWR0aCwgbGVmdCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtVG9wICs9IHRvb2xiYXJFbGUuZ2V0Q2xpZW50UmVjdHMoKVswXS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGlja3koaGVhZGVyRWxlLCBlbGVtVG9wLCBjb250ZW50UmVjdC53aWR0aCwgbGVmdCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY29sTWVudUVsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbE1lbnVFbGUuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sTWVudUVsZS5zdHlsZS50b3AgPSBoZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVyRWxlLmNsYXNzTGlzdC5jb250YWlucygnZS1zdGlja3knKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGlja3koaGVhZGVyRWxlLCBudWxsLCBudWxsLCBudWxsLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9vbGJhckVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RpY2t5KHRvb2xiYXJFbGUsIG51bGwsIG51bGwsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncm91cEhlYWRlckVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RpY2t5KGdyb3VwSGVhZGVyRWxlLCBudWxsLCBudWxsLCBudWxsLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2NEbGcgPSB0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWNjZGxnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2NEbGcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjY0RsZy5jbGFzc0xpc3QucmVtb3ZlKCdlLXN0aWNreScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjb2xNZW51RWxlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbE1lbnVFbGUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b3BTdHlsZSA9IGNvbnRlbnRSZWN0LnRvcCAtIHBhcmVudFRvcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xNZW51RWxlLnN0eWxlLnRvcCA9IHRvcFN0eWxlICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnN0aWNreVNjcm9sbENvbXBsZXRlLCB7fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNjcm9sbC5wcm90b3R5cGUuc2V0U3RpY2t5ID0gZnVuY3Rpb24gKGVsZSwgdG9wLCB3aWR0aCwgbGVmdCwgaXNBZGQpIHtcbiAgICAgICAgaWYgKGlzQWRkKSB7XG4gICAgICAgICAgICBlbGUuY2xhc3NMaXN0LmFkZCgnZS1zdGlja3knKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVsZS5jbGFzc0xpc3QucmVtb3ZlKCdlLXN0aWNreScpO1xuICAgICAgICB9XG4gICAgICAgIGVsZS5zdHlsZS53aWR0aCA9IHdpZHRoICE9IG51bGwgPyB3aWR0aCArICdweCcgOiAnJztcbiAgICAgICAgZWxlLnN0eWxlLnRvcCA9IHRvcCAhPSBudWxsID8gdG9wICsgJ3B4JyA6ICcnO1xuICAgICAgICBlbGUuc3R5bGUubGVmdCA9IGxlZnQgIT09IG51bGwgPyBwYXJzZUludChlbGUuc3R5bGUubGVmdCwgMTApICE9PSBsZWZ0ID8gbGVmdCArICdweCcgOiBlbGUuc3R5bGUubGVmdCA6ICcnO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNjcm9sbC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdyaWRFbGVtZW50ID0gdGhpcy5wYXJlbnQuZWxlbWVudDtcbiAgICAgICAgaWYgKCFncmlkRWxlbWVudCB8fCAoIWdyaWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZEhlYWRlcikgJiYgIWdyaWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZENvbnRlbnQpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigpO1xuICAgICAgICAvL1JlbW92ZSBEb20gZXZlbnRcbiAgICAgICAgdmFyIGNvbnQgPSB0aGlzLnBhcmVudC5nZXRDb250ZW50KCkucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5jb250ZW50KTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZShjb250LCAnc2Nyb2xsJywgdGhpcy5vbkNvbnRlbnRTY3JvbGwpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlU3RpY2t5SGVhZGVyKSB7XG4gICAgICAgICAgICB0aGlzLmFkZFN0aWNreUxpc3RlbmVyKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICAvL1JlbW92ZSBwYWRkaW5nXG4gICAgICAgIHRoaXMucmVtb3ZlUGFkZGluZygpO1xuICAgICAgICByZW1vdmVDbGFzcyhbdGhpcy5wYXJlbnQuZ2V0SGVhZGVyQ29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuaGVhZGVyQ29udGVudCldLCBsaXRlcmFscy5oZWFkZXJDb250ZW50KTtcbiAgICAgICAgcmVtb3ZlQ2xhc3MoW2NvbnRdLCBsaXRlcmFscy5jb250ZW50KTtcbiAgICAgICAgLy9SZW1vdmUgaGVpZ2h0XG4gICAgICAgIGNvbnQuc3R5bGUuaGVpZ2h0ID0gJyc7XG4gICAgICAgIC8vUmVtb3ZlIHdpZHRoXG4gICAgICAgIHRoaXMucGFyZW50LmVsZW1lbnQuc3R5bGUud2lkdGggPSAnJztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIGdldCB0aGUgc2Nyb2xsYmFyIHdpZHRoIG9mIHRoZSBicm93c2VyLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn0gcmV0dXJuIHRoZSB3aWR0aFxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTY3JvbGwuZ2V0U2Nyb2xsQmFyV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBnZXRTY3JvbGxCYXJXaWR0aCgpO1xuICAgIH07XG4gICAgcmV0dXJuIFNjcm9sbDtcbn0oKSk7XG5leHBvcnQgeyBTY3JvbGwgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/scroll.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/search.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/search.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Search: () => (/* binding */ Search)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n\n\n\n/**\n * The `Search` module is used to handle search action.\n */\nvar Search = /** @class */ (function () {\n    /**\n     * Constructor for Grid search module.\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @hidden\n     */\n    function Search(parent) {\n        //Internal variables\n        /** @hidden */\n        this.headerFocus = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * Checks if the input string contains non-numeric characters.\n     *\n     * @param {string} searchString - The string to be checked for non-numeric characters.\n     * @returns {boolean} - `true` if the input string contains non-numeric characters, `false` otherwise.\n     */\n    Search.prototype.hasNonNumericCharacters = function (searchString) {\n        var decimalFound = false;\n        for (var _i = 0, searchString_1 = searchString; _i < searchString_1.length; _i++) {\n            var char = searchString_1[_i];\n            if ((char < '0' || char > '9') && char !== '.') {\n                return true;\n            }\n            if (char === '.') {\n                if (decimalFound) {\n                    // If decimal is found more than once, it's not valid\n                    return true;\n                }\n                decimalFound = true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Searches Grid records by given key.\n     *\n     * > You can customize the default search action by using [`searchSettings`](./searchsettings/).\n     *\n     * @param  {string} searchString - Defines the key.\n     * @returns {void}\n     */\n    Search.prototype.search = function (searchString) {\n        var gObj = this.parent;\n        searchString = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(searchString) ? '' : searchString;\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_1__.isActionPrevent)(gObj)) {\n            gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.preventBatch, { instance: this, handler: this.search, arg1: searchString });\n            return;\n        }\n        if (searchString !== gObj.searchSettings.key) {\n            this.headerFocus = false;\n            // Check searchString is number and parseFloat to remove trailing zeros\n            if (searchString !== '' && !this.hasNonNumericCharacters(searchString)) {\n                var parts = searchString.split('.');\n                if (searchString === '.' || (searchString.indexOf('.') === -1) || (parts[0].startsWith('0') && parts[0].length > 1)) {\n                    gObj.searchSettings.key = searchString.toString();\n                }\n                else {\n                    gObj.searchSettings.key = parseFloat(searchString).toString();\n                }\n            }\n            else {\n                gObj.searchSettings.key = searchString.toString();\n            }\n            gObj.dataBind();\n        }\n        else if (this.refreshSearch) {\n            gObj.refresh();\n        }\n        else {\n            this.headerFocus = false;\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Search.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.inBoundModelChanged, this.onPropertyChanged, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.searchComplete, this.onSearchComplete, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.destroy, this.destroy, this);\n        this.actionCompleteFunc = this.onActionComplete.bind(this);\n        this.parent.addEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_2__.actionComplete, this.actionCompleteFunc);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.cancelBegin, this.cancelBeginEvent, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Search.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_2__.inBoundModelChanged, this.onPropertyChanged);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_2__.searchComplete, this.onSearchComplete);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_2__.destroy, this.destroy);\n        this.parent.removeEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_2__.actionComplete, this.actionCompleteFunc);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_2__.cancelBegin, this.cancelBeginEvent);\n    };\n    /**\n     * To destroy the print\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Search.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    /**\n     * @param {NotifyArgs} e - specfies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    Search.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.properties.key)) {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.modelChanged, {\n                requestType: 'searching', type: _base_constant__WEBPACK_IMPORTED_MODULE_2__.actionBegin, searchString: this.parent.searchSettings.key\n            });\n        }\n        else {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.modelChanged, {\n                requestType: 'searching', type: _base_constant__WEBPACK_IMPORTED_MODULE_2__.actionBegin\n            });\n        }\n    };\n    /**\n     * The function used to trigger onActionComplete\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    Search.prototype.onSearchComplete = function (e) {\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_2__.actionComplete, (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(e, {\n            searchString: this.parent.searchSettings.key, requestType: 'searching', type: _base_constant__WEBPACK_IMPORTED_MODULE_2__.actionComplete\n        }));\n    };\n    /**\n     * The function used to store the requestType\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    Search.prototype.onActionComplete = function (e) {\n        if (this.refreshSearch && e.requestType === 'refresh' && this.headerFocus) {\n            this.headerFocus = false;\n            this.parent.focusModule.focus();\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.parent.focusModule.currentInfo.element], ['e-focused']);\n        }\n        this.refreshSearch = e.requestType !== 'searching';\n    };\n    Search.prototype.cancelBeginEvent = function (e) {\n        if (e.requestType === 'searching') {\n            this.parent.setProperties({ searchSettings: { key: '' } }, true);\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Search.prototype.getModuleName = function () {\n        return 'search';\n    };\n    return Search;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL3NlYXJjaC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTJFO0FBQ2hDO0FBQ0k7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQixTQUFTO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCw0QkFBNEI7QUFDcEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUTtBQUN4QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHVFQUFpQjtBQUN4QyxZQUFZLDJEQUFlO0FBQzNCLHdCQUF3Qix3REFBbUIsSUFBSSwwREFBMEQ7QUFDekc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QiwrREFBMEI7QUFDakQsdUJBQXVCLDBEQUFxQjtBQUM1Qyx1QkFBdUIsbURBQWM7QUFDckM7QUFDQSxxQ0FBcUMsMERBQXFCO0FBQzFELHVCQUF1Qix1REFBa0I7QUFDekM7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsK0RBQTBCO0FBQ2xELHdCQUF3QiwwREFBcUI7QUFDN0Msd0JBQXdCLG1EQUFjO0FBQ3RDLHdDQUF3QywwREFBcUI7QUFDN0Qsd0JBQXdCLHVEQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFlBQVk7QUFDM0IsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsdUVBQWlCO0FBQzlCLCtCQUErQix3REFBbUI7QUFDbEQsZ0RBQWdELHVEQUFrQjtBQUNsRSxhQUFhO0FBQ2I7QUFDQTtBQUNBLCtCQUErQix3REFBbUI7QUFDbEQsZ0RBQWdELHVEQUFrQjtBQUNsRSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsWUFBWTtBQUMzQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDBEQUFxQixFQUFFLDREQUFNO0FBQ3pELDBGQUEwRiwwREFBcUI7QUFDL0csU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxZQUFZO0FBQzNCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDhEQUFRO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msa0JBQWtCLFdBQVc7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDaUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL3NlYXJjaC5qcz81OGU0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFkZENsYXNzLCBleHRlbmQsIGlzTnVsbE9yVW5kZWZpbmVkIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0ICogYXMgZXZlbnRzIGZyb20gJy4uL2Jhc2UvY29uc3RhbnQnO1xuaW1wb3J0IHsgaXNBY3Rpb25QcmV2ZW50IH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbi8qKlxuICogVGhlIGBTZWFyY2hgIG1vZHVsZSBpcyB1c2VkIHRvIGhhbmRsZSBzZWFyY2ggYWN0aW9uLlxuICovXG52YXIgU2VhcmNoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIGZvciBHcmlkIHNlYXJjaCBtb2R1bGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0lHcmlkfSBwYXJlbnQgLSBzcGVjaWZpZXMgdGhlIElHcmlkXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNlYXJjaChwYXJlbnQpIHtcbiAgICAgICAgLy9JbnRlcm5hbCB2YXJpYWJsZXNcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgdGhpcy5oZWFkZXJGb2N1cyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgaW5wdXQgc3RyaW5nIGNvbnRhaW5zIG5vbi1udW1lcmljIGNoYXJhY3RlcnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2VhcmNoU3RyaW5nIC0gVGhlIHN0cmluZyB0byBiZSBjaGVja2VkIGZvciBub24tbnVtZXJpYyBjaGFyYWN0ZXJzLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIGB0cnVlYCBpZiB0aGUgaW5wdXQgc3RyaW5nIGNvbnRhaW5zIG5vbi1udW1lcmljIGNoYXJhY3RlcnMsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqL1xuICAgIFNlYXJjaC5wcm90b3R5cGUuaGFzTm9uTnVtZXJpY0NoYXJhY3RlcnMgPSBmdW5jdGlvbiAoc2VhcmNoU3RyaW5nKSB7XG4gICAgICAgIHZhciBkZWNpbWFsRm91bmQgPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBzZWFyY2hTdHJpbmdfMSA9IHNlYXJjaFN0cmluZzsgX2kgPCBzZWFyY2hTdHJpbmdfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBjaGFyID0gc2VhcmNoU3RyaW5nXzFbX2ldO1xuICAgICAgICAgICAgaWYgKChjaGFyIDwgJzAnIHx8IGNoYXIgPiAnOScpICYmIGNoYXIgIT09ICcuJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNoYXIgPT09ICcuJykge1xuICAgICAgICAgICAgICAgIGlmIChkZWNpbWFsRm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgZGVjaW1hbCBpcyBmb3VuZCBtb3JlIHRoYW4gb25jZSwgaXQncyBub3QgdmFsaWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRlY2ltYWxGb3VuZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VhcmNoZXMgR3JpZCByZWNvcmRzIGJ5IGdpdmVuIGtleS5cbiAgICAgKlxuICAgICAqID4gWW91IGNhbiBjdXN0b21pemUgdGhlIGRlZmF1bHQgc2VhcmNoIGFjdGlvbiBieSB1c2luZyBbYHNlYXJjaFNldHRpbmdzYF0oLi9zZWFyY2hzZXR0aW5ncy8pLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBzZWFyY2hTdHJpbmcgLSBEZWZpbmVzIHRoZSBrZXkuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgU2VhcmNoLnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbiAoc2VhcmNoU3RyaW5nKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHNlYXJjaFN0cmluZyA9IGlzTnVsbE9yVW5kZWZpbmVkKHNlYXJjaFN0cmluZykgPyAnJyA6IHNlYXJjaFN0cmluZztcbiAgICAgICAgaWYgKGlzQWN0aW9uUHJldmVudChnT2JqKSkge1xuICAgICAgICAgICAgZ09iai5ub3RpZnkoZXZlbnRzLnByZXZlbnRCYXRjaCwgeyBpbnN0YW5jZTogdGhpcywgaGFuZGxlcjogdGhpcy5zZWFyY2gsIGFyZzE6IHNlYXJjaFN0cmluZyB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VhcmNoU3RyaW5nICE9PSBnT2JqLnNlYXJjaFNldHRpbmdzLmtleSkge1xuICAgICAgICAgICAgdGhpcy5oZWFkZXJGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgICAgLy8gQ2hlY2sgc2VhcmNoU3RyaW5nIGlzIG51bWJlciBhbmQgcGFyc2VGbG9hdCB0byByZW1vdmUgdHJhaWxpbmcgemVyb3NcbiAgICAgICAgICAgIGlmIChzZWFyY2hTdHJpbmcgIT09ICcnICYmICF0aGlzLmhhc05vbk51bWVyaWNDaGFyYWN0ZXJzKHNlYXJjaFN0cmluZykpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFydHMgPSBzZWFyY2hTdHJpbmcuc3BsaXQoJy4nKTtcbiAgICAgICAgICAgICAgICBpZiAoc2VhcmNoU3RyaW5nID09PSAnLicgfHwgKHNlYXJjaFN0cmluZy5pbmRleE9mKCcuJykgPT09IC0xKSB8fCAocGFydHNbMF0uc3RhcnRzV2l0aCgnMCcpICYmIHBhcnRzWzBdLmxlbmd0aCA+IDEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdPYmouc2VhcmNoU2V0dGluZ3Mua2V5ID0gc2VhcmNoU3RyaW5nLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBnT2JqLnNlYXJjaFNldHRpbmdzLmtleSA9IHBhcnNlRmxvYXQoc2VhcmNoU3RyaW5nKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGdPYmouc2VhcmNoU2V0dGluZ3Mua2V5ID0gc2VhcmNoU3RyaW5nLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnT2JqLmRhdGFCaW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5yZWZyZXNoU2VhcmNoKSB7XG4gICAgICAgICAgICBnT2JqLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyRm9jdXMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNlYXJjaC5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLmluQm91bmRNb2RlbENoYW5nZWQsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuc2VhcmNoQ29tcGxldGUsIHRoaXMub25TZWFyY2hDb21wbGV0ZSwgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5kZXN0cm95LCB0aGlzLmRlc3Ryb3ksIHRoaXMpO1xuICAgICAgICB0aGlzLmFjdGlvbkNvbXBsZXRlRnVuYyA9IHRoaXMub25BY3Rpb25Db21wbGV0ZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50cy5hY3Rpb25Db21wbGV0ZSwgdGhpcy5hY3Rpb25Db21wbGV0ZUZ1bmMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuY2FuY2VsQmVnaW4sIHRoaXMuY2FuY2VsQmVnaW5FdmVudCwgdGhpcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgU2VhcmNoLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLmluQm91bmRNb2RlbENoYW5nZWQsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZWQpO1xuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLnNlYXJjaENvbXBsZXRlLCB0aGlzLm9uU2VhcmNoQ29tcGxldGUpO1xuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLmRlc3Ryb3ksIHRoaXMuZGVzdHJveSk7XG4gICAgICAgIHRoaXMucGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRzLmFjdGlvbkNvbXBsZXRlLCB0aGlzLmFjdGlvbkNvbXBsZXRlRnVuYyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9mZihldmVudHMuY2FuY2VsQmVnaW4sIHRoaXMuY2FuY2VsQmVnaW5FdmVudCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUbyBkZXN0cm95IHRoZSBwcmludFxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNlYXJjaC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge05vdGlmeUFyZ3N9IGUgLSBzcGVjZmllcyB0aGUgTm90aWZ5QXJnc1xuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTZWFyY2gucHJvdG90eXBlLm9uUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUubW9kdWxlICE9PSB0aGlzLmdldE1vZHVsZU5hbWUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZS5wcm9wZXJ0aWVzLmtleSkpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMubW9kZWxDaGFuZ2VkLCB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdFR5cGU6ICdzZWFyY2hpbmcnLCB0eXBlOiBldmVudHMuYWN0aW9uQmVnaW4sIHNlYXJjaFN0cmluZzogdGhpcy5wYXJlbnQuc2VhcmNoU2V0dGluZ3Mua2V5XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMubW9kZWxDaGFuZ2VkLCB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdFR5cGU6ICdzZWFyY2hpbmcnLCB0eXBlOiBldmVudHMuYWN0aW9uQmVnaW5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGUgZnVuY3Rpb24gdXNlZCB0byB0cmlnZ2VyIG9uQWN0aW9uQ29tcGxldGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm90aWZ5QXJnc30gZSAtIHNwZWNpZmllcyB0aGUgTm90aWZ5QXJnc1xuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTZWFyY2gucHJvdG90eXBlLm9uU2VhcmNoQ29tcGxldGUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5hY3Rpb25Db21wbGV0ZSwgZXh0ZW5kKGUsIHtcbiAgICAgICAgICAgIHNlYXJjaFN0cmluZzogdGhpcy5wYXJlbnQuc2VhcmNoU2V0dGluZ3Mua2V5LCByZXF1ZXN0VHlwZTogJ3NlYXJjaGluZycsIHR5cGU6IGV2ZW50cy5hY3Rpb25Db21wbGV0ZVxuICAgICAgICB9KSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGUgZnVuY3Rpb24gdXNlZCB0byBzdG9yZSB0aGUgcmVxdWVzdFR5cGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Tm90aWZ5QXJnc30gZSAtIHNwZWNpZmllcyB0aGUgTm90aWZ5QXJnc1xuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTZWFyY2gucHJvdG90eXBlLm9uQWN0aW9uQ29tcGxldGUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodGhpcy5yZWZyZXNoU2VhcmNoICYmIGUucmVxdWVzdFR5cGUgPT09ICdyZWZyZXNoJyAmJiB0aGlzLmhlYWRlckZvY3VzKSB7XG4gICAgICAgICAgICB0aGlzLmhlYWRlckZvY3VzID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5mb2N1c01vZHVsZS5mb2N1cygpO1xuICAgICAgICAgICAgYWRkQ2xhc3MoW3RoaXMucGFyZW50LmZvY3VzTW9kdWxlLmN1cnJlbnRJbmZvLmVsZW1lbnRdLCBbJ2UtZm9jdXNlZCddKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZnJlc2hTZWFyY2ggPSBlLnJlcXVlc3RUeXBlICE9PSAnc2VhcmNoaW5nJztcbiAgICB9O1xuICAgIFNlYXJjaC5wcm90b3R5cGUuY2FuY2VsQmVnaW5FdmVudCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChlLnJlcXVlc3RUeXBlID09PSAnc2VhcmNoaW5nJykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2V0UHJvcGVydGllcyh7IHNlYXJjaFNldHRpbmdzOiB7IGtleTogJycgfSB9LCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRm9yIGludGVybmFsIHVzZSBvbmx5IC0gR2V0IHRoZSBtb2R1bGUgbmFtZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgdGhlIG1vZHVsZSBuYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBTZWFyY2gucHJvdG90eXBlLmdldE1vZHVsZU5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnc2VhcmNoJztcbiAgICB9O1xuICAgIHJldHVybiBTZWFyY2g7XG59KCkpO1xuZXhwb3J0IHsgU2VhcmNoIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/search.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/selection.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/selection.js ***!
  \***************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Selection: () => (/* binding */ Selection)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/manager.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n\n\n\n\n\n/**\n * The `Selection` module is used to handle cell and row selection.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Grid selection module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {SelectionSettings} selectionSettings - specifies the selectionsettings\n     * @param {ServiceLocator} locator - specifies the ServiceLocator\n     * @hidden\n     */\n    function Selection(parent, selectionSettings, locator) {\n        //Internal letiables\n        /**\n         * @hidden\n         */\n        this.selectedRowIndexes = [];\n        /**\n         * @hidden\n         */\n        this.selectedRowCellIndexes = [];\n        /**\n         * @hidden\n         */\n        this.selectedRecords = [];\n        /**\n         * @hidden\n         */\n        this.preventFocus = false;\n        /**\n         *  @hidden\n         */\n        this.selectedColumnsIndexes = [];\n        this.checkBoxState = false;\n        this.isMultiShiftRequest = false;\n        this.isMultiCtrlRequest = false;\n        this.isMultiCtrlRequestCell = false;\n        this.enableSelectMultiTouch = false;\n        this.clearRowCheck = false;\n        this.selectRowCheck = false;\n        /**\n         * @hidden\n         */\n        this.selectedRowState = {};\n        this.unSelectedRowState = {};\n        this.totalRecordsCount = 0;\n        this.chkAllCollec = [];\n        this.isCheckedOnAdd = false;\n        this.persistSelectedData = [];\n        this.virtualSelectedData = [];\n        this.deSelectedData = [];\n        this.isHdrSelectAllClicked = false;\n        this.needColumnSelection = false;\n        this.isCancelDeSelect = false;\n        this.isPreventCellSelect = false;\n        this.disableUI = false;\n        this.isPersisted = false;\n        this.cmdKeyPressed = false;\n        this.cellselected = false;\n        this.isMultiSelection = false;\n        this.isAddRowsToSelection = false;\n        this.initialRowSelection = false;\n        this.isPrevRowSelection = false;\n        this.isKeyAction = false;\n        this.isRowDragSelected = false;\n        this.isPartialSelection = false;\n        this.rmtHdrChkbxClicked = false;\n        this.isCheckboxReset = false;\n        this.isRowDeselect = false;\n        /**\n         * @hidden\n         */\n        this.autoFillRLselection = true;\n        this.isFocusLastCell = false;\n        this.bottom = '0 0 2px 0';\n        this.top = '2px 0 0 0';\n        /* eslint-disable */\n        this.right_bottom = '0 2px 2px 0';\n        this.bottom_left = '0 0 2px 2px';\n        this.top_right = '2px 2px 0 0';\n        this.top_left = '2px 0 0 2px';\n        this.top_bottom = '2px 0 2px 0';\n        this.top_right_bottom = '2px 2px 2px 0';\n        this.top_bottom_left = '2px 0 2px 2px';\n        this.top_right_left = '2px 2px 0 2px';\n        this.right_bottom_left = '0 2px 2px 2px';\n        this.all_border = '2px';\n        this.parent = parent;\n        this.selectionSettings = selectionSettings;\n        this.factory = locator.getService('rendererFactory');\n        this.focus = locator.getService('focus');\n        this.addEventListener();\n        this.wireEvents();\n    }\n    Selection.prototype.initializeSelection = function () {\n        this.parent.log('selection_key_missing');\n        this.render();\n    };\n    /**\n     * The function used to trigger onActionBegin\n     *\n     * @param {Object} args - specifies the args\n     * @param {string} type - specifies the type\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.onActionBegin = function (args, type) {\n        this.parent.trigger(type, this.fDataUpdate(args));\n    };\n    Selection.prototype.fDataUpdate = function (args) {\n        if (!this.isMultiSelection && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.cellIndex) || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.rowIndex))) {\n            var rowObj = this.getRowObj((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.rowIndex) ? (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.cellIndex) ?\n                this.currentIndex : args.cellIndex.rowIndex : args.rowIndex);\n            args.foreignKeyData = rowObj.foreignKeyData;\n        }\n        return args;\n    };\n    /**\n     * The function used to trigger onActionComplete\n     *\n     * @param {Object} args - specifies the args\n     * @param {string} type - specifies the type\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.onActionComplete = function (args, type) {\n        this.parent.trigger(type, this.fDataUpdate(args));\n        this.isMultiSelection = false;\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    /**\n     * To destroy the selection\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.gridHeader) && !gridElement.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.gridContent))) {\n            return;\n        }\n        this.hidePopUp();\n        this.clearSelection();\n        this.destroyAutoFillElements();\n        this.removeEventListener();\n        this.unWireEvents();\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.getContent(), 'mousedown', this.mouseDownHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.getHeaderContent(), 'mousedown', this.mouseDownHandler);\n    };\n    Selection.prototype.isEditing = function () {\n        return (this.parent.editSettings.mode === 'Normal' || (this.parent.editSettings.mode === 'Batch' && this.parent.editModule &&\n            this.parent.editModule.formObj && !this.parent.editModule.formObj.validate())) &&\n            (this.parent.isEdit && !this.parent.editSettings.showAddNewRow) && !this.parent.isPersistSelection;\n    };\n    Selection.prototype.getCurrentBatchRecordChanges = function () {\n        var gObj = this.parent;\n        if (gObj.editSettings.mode === 'Batch' && gObj.editModule) {\n            var currentRecords = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.iterateExtend)(this.parent.getCurrentViewRecords());\n            currentRecords = gObj.editSettings.newRowPosition === 'Bottom' ?\n                currentRecords.concat(this.parent.editModule.getBatchChanges()[_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.addedRecords]) :\n                this.parent.editModule.getBatchChanges()[_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.addedRecords].concat(currentRecords);\n            var deletedRecords = this.parent.editModule.getBatchChanges()[_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.deletedRecords];\n            var primaryKey = this.parent.getPrimaryKeyFieldNames()[0];\n            for (var i = 0; i < (deletedRecords.length); i++) {\n                for (var j = 0; j < currentRecords.length; j++) {\n                    if (deletedRecords[parseInt(i.toString(), 10)][\"\" + primaryKey] === currentRecords[parseInt(j.toString(), 10)][\"\" + primaryKey]) {\n                        currentRecords.splice(j, 1);\n                        break;\n                    }\n                }\n            }\n            return currentRecords;\n        }\n        else if (this.parent.enableVirtualization && this.parent.groupSettings.columns.length && !this.parent.isPersistSelection) {\n            var selectedGroupedData = gObj.getCurrentViewRecords().filter(function (col) { return col['key'] === undefined; });\n            return selectedGroupedData;\n        }\n        else {\n            return gObj.getCurrentViewRecords();\n        }\n    };\n    /**\n     * Selects a row by the given index.\n     *\n     * @param  {number} index - Defines the row index.\n     * @param  {boolean} isToggle - If set to true, then it toggles the selection.\n     * @returns {void}\n     */\n    Selection.prototype.selectRow = function (index, isToggle) {\n        if (this.selectedRowIndexes.length && this.selectionSettings.enableSimpleMultiRowSelection) {\n            this.addRowsToSelection([index]);\n            return;\n        }\n        var gObj = this.parent;\n        var selectedRow = gObj.getRowByIndex(index);\n        var rowObj = selectedRow && gObj.getRowObjectFromUID(selectedRow.getAttribute('data-uid'));\n        if (this.isPartialSelection && rowObj && rowObj.isDataRow && !rowObj.isSelectable) {\n            return;\n        }\n        var selectData;\n        var isRemoved = false;\n        if (gObj.enableVirtualization && index > -1) {\n            var e = { selectedIndex: index, isAvailable: true };\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.selectVirtualRow, e);\n            if (selectedRow && (gObj.getRowObjectFromUID(selectedRow.getAttribute('data-uid')))) {\n                selectData = gObj.getRowObjectFromUID(selectedRow.getAttribute('data-uid')).data;\n            }\n            else {\n                if (e.isAvailable && !gObj.selectionSettings.persistSelection) {\n                    var prevSelectedData = this.parent.getSelectedRecords();\n                    if (prevSelectedData.length > 0) {\n                        this.clearRowSelection();\n                    }\n                }\n                return;\n            }\n        }\n        else {\n            selectData = this.getRowObj(index).data;\n        }\n        if (!this.isRowType() || !selectedRow || this.isEditing()) {\n            // if (this.isEditing()) {\n            //     gObj.selectedRowIndex = index;\n            // }\n            return;\n        }\n        var isRowSelected = selectedRow.hasAttribute('aria-selected');\n        this.activeTarget();\n        if (!isToggle || !this.selectedRowIndexes.length) {\n            isToggle = false;\n        }\n        else {\n            var isCheckboxModeResetOnRowClick = this.selectionSettings.checkboxMode === 'ResetOnRowClick';\n            var isSelectionTypeMultiple = !this.parent.isCheckBoxSelection && this.selectionSettings.type === 'Multiple';\n            if ((!isCheckboxModeResetOnRowClick && !isSelectionTypeMultiple) ||\n                (this.selectedRowIndexes.length === 1 && (isCheckboxModeResetOnRowClick || isSelectionTypeMultiple))) {\n                isToggle = !(this.isKeyAction && this.parent.isCheckBoxSelection) ? this.selectedRowIndexes.indexOf(index) !== -1 : false;\n            }\n            else {\n                isToggle = false;\n            }\n        }\n        this.isKeyAction = false;\n        var args;\n        var can = 'cancel';\n        if (!isToggle) {\n            args = {\n                data: selectData, rowIndex: index, isCtrlPressed: this.isMultiCtrlRequest,\n                isShiftPressed: this.isMultiShiftRequest, row: selectedRow,\n                previousRow: gObj.getRowByIndex(this.prevRowIndex),\n                previousRowIndex: this.prevRowIndex, target: this.actualTarget, cancel: false, isInteracted: this.isInteracted,\n                isHeaderCheckboxClicked: this.isHeaderCheckboxClicked\n            };\n            this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowSelecting, this.fDataUpdate(args), this.rowSelectingCallBack(args, isToggle, index, selectData, isRemoved, isRowSelected, can));\n        }\n        else {\n            if (this.selectionSettings.checkboxMode !== 'ResetOnRowClick' && this.selectionSettings.persistSelection) {\n                this.rowDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowDeselecting, [rowObj.index], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], this.actualTarget);\n                if (this.isCancelDeSelect) {\n                    return;\n                }\n                if (!this.parent.isCheckBoxSelection) {\n                    this.selectedRowIndexes = [];\n                    this.selectedRecords = [];\n                    this.isRowSelected = false;\n                    this.selectRowIndex(-1);\n                }\n                this.rowDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowDeselected, [rowObj.index], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], this.actualTarget, undefined, undefined, undefined);\n            }\n            this.rowSelectingCallBack(args, isToggle, index, selectData, isRemoved, isRowSelected, can)(args);\n        }\n    };\n    Selection.prototype.rowSelectingCallBack = function (args, isToggle, index, selectData, isRemoved, isRowSelected, can) {\n        var _this = this;\n        return function (args) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args) && args[\"\" + can] === true) {\n                _this.disableInteracted();\n                return;\n            }\n            _this.index = index;\n            _this.toggle = isToggle;\n            _this.data = selectData;\n            _this.removed = isRemoved;\n            if (isRowSelected && _this.selectionSettings.persistSelection && !(_this.selectionSettings.checkboxMode === 'ResetOnRowClick')) {\n                _this.clearSelectedRow(index);\n                _this.selectRowCallBack();\n            }\n            else if (!isRowSelected && _this.selectionSettings.persistSelection && _this.parent.isCheckBoxSelection &&\n                _this.selectionSettings.checkboxMode !== 'ResetOnRowClick') {\n                _this.selectRowCallBack();\n            }\n            if (_this.selectionSettings.checkboxMode === 'ResetOnRowClick') {\n                _this.isCheckboxReset = true;\n                _this.clearSelection();\n            }\n            if (!_this.selectionSettings.persistSelection || _this.selectionSettings.checkboxMode === 'ResetOnRowClick' ||\n                (!_this.parent.isCheckBoxSelection && _this.selectionSettings.persistSelection)) {\n                _this.selectRowCheck = true;\n                _this.clearRow();\n            }\n        };\n    };\n    Selection.prototype.selectRowCallBack = function () {\n        var gObj = this.parent;\n        var args;\n        var index = this.index;\n        var isToggle = this.toggle;\n        var selectData = this.data;\n        var isRemoved = this.removed;\n        var selectedRow = gObj.getRowByIndex(index);\n        if (!isToggle && !isRemoved) {\n            if (this.selectedRowIndexes.indexOf(index) <= -1) {\n                this.updateRowSelection(selectedRow, index);\n            }\n            this.selectRowIndex(index);\n        }\n        if (!isToggle) {\n            args = {\n                data: selectData, rowIndex: index,\n                row: selectedRow, previousRow: gObj.getRowByIndex(this.prevRowIndex),\n                previousRowIndex: this.prevRowIndex, target: this.actualTarget, isInteracted: this.isInteracted,\n                isHeaderCheckBoxClicked: this.isHeaderCheckboxClicked, rowIndexes: index\n            };\n            this.onActionComplete(args, _base_constant__WEBPACK_IMPORTED_MODULE_3__.rowSelected);\n        }\n        this.isInteracted = false;\n        this.updateRowProps(index);\n    };\n    /**\n     * Selects a range of rows from start and end row indexes.\n     *\n     * @param  {number} startIndex - Specifies the start row index.\n     * @param  {number} endIndex - Specifies the end row index.\n     * @returns {void}\n     */\n    Selection.prototype.selectRowsByRange = function (startIndex, endIndex) {\n        this.selectRows(this.getCollectionFromIndexes(startIndex, endIndex));\n        this.selectRowIndex(endIndex);\n    };\n    Selection.prototype.selectedDataUpdate = function (selectedData, foreignKeyData, selectedRows, rowIndexes, selectableRowIndex) {\n        for (var i = 0, len = rowIndexes.length; i < len; i++) {\n            var currentRow = this.parent.getDataRows()[rowIndexes[parseInt(i.toString(), 10)]];\n            if (this.parent.enableVirtualization) {\n                currentRow = this.parent.getRowByIndex(rowIndexes[parseInt(i.toString(), 10)]);\n            }\n            var rowObj = this.getRowObj(currentRow);\n            if (rowObj && rowObj.isDataRow && rowObj.isSelectable) {\n                selectedData.push(rowObj.data);\n                selectedRows.push(currentRow);\n                foreignKeyData.push(rowObj.foreignKeyData);\n            }\n            else {\n                if (this.isPartialSelection && selectableRowIndex) {\n                    selectableRowIndex.splice(selectableRowIndex.indexOf(rowIndexes[parseInt(i.toString(), 10)]), 1);\n                }\n            }\n        }\n    };\n    /**\n     * Selects a collection of rows by index.\n     *\n     * @param  {number[]} rowIndexes - Specifies an array of row indexes.\n     * @returns {void}\n     */\n    Selection.prototype.selectRows = function (rowIndexes) {\n        var _this = this;\n        var gObj = this.parent;\n        var selectableRowIndex = rowIndexes.slice();\n        var rowIndex = !this.isSingleSel() ? rowIndexes[0] : rowIndexes[rowIndexes.length - 1];\n        this.isMultiSelection = true;\n        var selectedRows = [];\n        var foreignKeyData = [];\n        var can = 'cancel';\n        var selectedData = [];\n        if (!this.isRowType() || this.isEditing()) {\n            return;\n        }\n        this.selectedDataUpdate(selectedData, foreignKeyData, selectedRows, rowIndexes, selectableRowIndex);\n        this.activeTarget();\n        var args = {\n            cancel: false,\n            rowIndexes: selectableRowIndex, row: selectedRows, rowIndex: rowIndex, target: this.actualTarget,\n            prevRow: gObj.getRows()[this.prevRowIndex], previousRowIndex: this.prevRowIndex,\n            isInteracted: this.isInteracted, isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest,\n            data: selectedData, isHeaderCheckboxClicked: this.isHeaderCheckboxClicked, foreignKeyData: foreignKeyData\n        };\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowSelecting, this.fDataUpdate(args), function (args) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args) && args[\"\" + can] === true) {\n                _this.disableInteracted();\n                return;\n            }\n            if (!(_this.selectionSettings.persistSelection && gObj.allowRowDragAndDrop && _this.isDragged)) {\n                _this.clearRow();\n            }\n            _this.selectRowIndex(selectableRowIndex.slice(-1)[0]);\n            var selectRowFn = function (index, preventFocus) {\n                _this.updateRowSelection(gObj.getRowByIndex(index), index, preventFocus);\n                _this.updateRowProps(rowIndex);\n            };\n            if (!_this.isSingleSel()) {\n                for (var _i = 0, selectableRowIndex_1 = selectableRowIndex; _i < selectableRowIndex_1.length; _i++) {\n                    var rowIdx = selectableRowIndex_1[_i];\n                    selectRowFn(rowIdx, gObj.enableVirtualization ? true : false);\n                }\n            }\n            else {\n                selectRowFn(rowIndex);\n            }\n            if (_this.checkVirtualCheckBox() && !_this.parent.isPersistSelection) {\n                if (selectableRowIndex.length === _this.totalRecordsCount) {\n                    _this.virtualSelectedData = _this.virtualCheckBoxData().slice();\n                    _this.selectedRowIndexes = Object.keys(_this.virtualSelectedData).map(function (key) { return parseInt(key, 10); });\n                    _this.setCheckAllState();\n                }\n                else {\n                    var selectionData = selectableRowIndex.filter(function (index) {\n                        return _this.selectedRowIndexes.indexOf(index) === -1;\n                    });\n                    if (selectionData.length > 0) {\n                        var allData = _this.virtualCheckBoxData().slice();\n                        for (var i = 0; i < selectionData.length; i++) {\n                            var record = allData[selectionData[i]];\n                            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(record)) {\n                                _this.virtualSelectedData.push(record);\n                                _this.selectedRowIndexes.push(selectionData[i]);\n                            }\n                        }\n                        _this.setCheckAllState();\n                    }\n                }\n            }\n            args = {\n                rowIndexes: selectableRowIndex, row: selectedRows, rowIndex: rowIndex, target: _this.actualTarget,\n                prevRow: gObj.getRows()[_this.prevRowIndex], previousRowIndex: _this.prevRowIndex,\n                data: _this.getSelectedRecords(), isInteracted: _this.isInteracted,\n                isHeaderCheckboxClicked: _this.isHeaderCheckboxClicked, foreignKeyData: foreignKeyData\n            };\n            if (_this.isRowSelected) {\n                _this.onActionComplete(args, _base_constant__WEBPACK_IMPORTED_MODULE_3__.rowSelected);\n            }\n            _this.isInteracted = false;\n        });\n    };\n    /**\n     * Select rows with existing row selection by passing row indexes.\n     *\n     * @param {number} rowIndexes - Specifies the row indexes.\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.addRowsToSelection = function (rowIndexes) {\n        var gObj = this.parent;\n        var can = 'cancel';\n        var target = this.target;\n        this.isMultiSelection = true;\n        var selectedRows = [];\n        var foreignKeyData = [];\n        var selectedData = [];\n        var indexes = gObj.getSelectedRowIndexes().concat(rowIndexes);\n        var selectedRow = !this.isSingleSel() ? gObj.getRowByIndex(rowIndexes[0]) :\n            gObj.getRowByIndex(rowIndexes[rowIndexes.length - 1]);\n        if ((!this.isRowType() || this.isEditing()) && !this.selectionSettings.checkboxOnly) {\n            return;\n        }\n        var args;\n        var checkboxColumn = this.parent.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (this.isMultiCtrlRequest && !checkboxColumn.length) {\n            this.selectedDataUpdate(selectedData, foreignKeyData, selectedRows, indexes);\n        }\n        for (var _i = 0, rowIndexes_1 = rowIndexes; _i < rowIndexes_1.length; _i++) {\n            var rowIndex = rowIndexes_1[_i];\n            var rowObj = this.getRowObj(rowIndex);\n            var isUnSelected = this.selectedRowIndexes.indexOf(rowIndex) > -1;\n            if (this.isPartialSelection && rowObj && rowObj.isDataRow && !rowObj.isSelectable) {\n                continue;\n            }\n            this.selectRowIndex(rowIndex);\n            if (isUnSelected && ((checkboxColumn.length ? true : this.selectionSettings.enableToggle) || this.isMultiCtrlRequest)) {\n                this.isAddRowsToSelection = true;\n                this.rowDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowDeselecting, [rowIndex], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], target);\n                if (this.isCancelDeSelect) {\n                    return;\n                }\n                if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n                    this.virtualSelectedData.splice(this.virtualSelectedData.indexOf(rowObj.data), 1);\n                }\n                this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(rowIndex), 1);\n                this.selectedRecords.splice(this.selectedRecords.indexOf(selectedRow), 1);\n                this.selectRowIndex(this.selectedRowIndexes.length ? this.selectedRowIndexes[this.selectedRowIndexes.length - 1] : -1);\n                selectedRow.removeAttribute('aria-selected');\n                this.addRemoveClassesForRow(selectedRow, false, null, 'e-selectionbackground', 'e-active');\n                this.rowDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowDeselected, [rowIndex], [rowObj.data], [selectedRow], [rowObj.foreignKeyData], target, undefined, undefined, undefined);\n                this.isInteracted = false;\n                this.isMultiSelection = false;\n                this.isAddRowsToSelection = false;\n                this.isHdrSelectAllClicked = false;\n            }\n            else {\n                this.activeTarget();\n                args = {\n                    cancel: false,\n                    data: selectedData.length ? selectedData : rowObj.data, rowIndex: rowIndex, row: selectedRows.length ? selectedRows :\n                        selectedRow, target: this.actualTarget, prevRow: gObj.getRows()[this.prevRowIndex],\n                    previousRowIndex: this.prevRowIndex, isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest,\n                    foreignKeyData: foreignKeyData.length ? foreignKeyData : rowObj.foreignKeyData, isInteracted: this.isInteracted,\n                    isHeaderCheckboxClicked: this.isHeaderCheckboxClicked, rowIndexes: indexes\n                };\n                this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowSelecting, this.fDataUpdate(args));\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args) && args[\"\" + can] === true) {\n                    this.disableInteracted();\n                    return;\n                }\n                if (this.isSingleSel()) {\n                    this.clearRow();\n                }\n                this.updateRowSelection(selectedRow, rowIndex);\n            }\n            if (!isUnSelected) {\n                args = {\n                    data: selectedData.length ? selectedData : rowObj.data, rowIndex: rowIndex, row: selectedRows.length ? selectedRows :\n                        selectedRow, target: this.actualTarget, prevRow: gObj.getRows()[this.prevRowIndex],\n                    previousRowIndex: this.prevRowIndex, foreignKeyData: foreignKeyData.length ? foreignKeyData : rowObj.foreignKeyData,\n                    isInteracted: this.isInteracted, isHeaderCheckboxClicked: this.isHeaderCheckboxClicked, rowIndexes: indexes\n                };\n                this.onActionComplete(args, _base_constant__WEBPACK_IMPORTED_MODULE_3__.rowSelected);\n            }\n            this.isInteracted = false;\n            this.updateRowProps(rowIndex);\n            if (this.isSingleSel()) {\n                break;\n            }\n        }\n    };\n    Selection.prototype.getCollectionFromIndexes = function (startIndex, endIndex) {\n        var indexes = [];\n        // eslint-disable-next-line prefer-const\n        var _a = (startIndex <= endIndex) ?\n            { i: startIndex, max: endIndex } : { i: endIndex, max: startIndex }, i = _a.i, max = _a.max;\n        for (; i <= max; i++) {\n            indexes.push(i);\n        }\n        if (startIndex > endIndex) {\n            indexes.reverse();\n        }\n        return indexes;\n    };\n    Selection.prototype.clearRow = function () {\n        this.clearRowCheck = true;\n        this.clearRowSelection();\n    };\n    Selection.prototype.clearRowCallBack = function () {\n        if (this.isCancelDeSelect && this.parent.checkAllRows !== 'Check') {\n            return;\n        }\n        this.selectedRowIndexes = [];\n        this.selectedRecords = [];\n        this.selectRowIndex(-1);\n        if (this.isSingleSel() && this.parent.isPersistSelection) {\n            this.selectedRowState = {};\n        }\n    };\n    Selection.prototype.clearSelectedRow = function (index) {\n        if (this.toggle) {\n            var selectedEle = this.parent.getRowByIndex(index);\n            if (!this.disableUI) {\n                selectedEle.removeAttribute('aria-selected');\n                this.addRemoveClassesForRow(selectedEle, false, true, 'e-selectionbackground', 'e-active');\n            }\n            this.removed = true;\n            this.updatePersistCollection(selectedEle, false);\n            this.updateCheckBoxes(selectedEle);\n            this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(index), 1);\n            this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(index)), 1);\n        }\n    };\n    Selection.prototype.updateRowProps = function (startIndex) {\n        this.prevRowIndex = startIndex;\n        this.isRowSelected = this.selectedRowIndexes.length && true;\n    };\n    Selection.prototype.getPkValue = function (pkField, data) {\n        return pkField ? (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.isComplexField)(pkField) ? (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getObject)(pkField, data) : data[\"\" + pkField] : data[\"\" + pkField];\n    };\n    Selection.prototype.updatePersistCollection = function (selectedRow, chkState) {\n        var _this = this;\n        if ((this.parent.isPersistSelection || this.parent.selectionSettings.persistSelection &&\n            this.parent.getPrimaryKeyFieldNames().length > 0) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(selectedRow)) {\n            if (!this.parent.isPersistSelection) {\n                this.ensureCheckboxFieldSelection();\n            }\n            var rowObj = this.getRowObj(selectedRow);\n            var pKey_1 = rowObj.data ? this.getPkValue(this.primaryKey, rowObj.data) : null;\n            if (pKey_1 === null) {\n                return;\n            }\n            rowObj.isSelected = chkState;\n            if ((chkState && !this.isPartialSelection) || (this.isPartialSelection && rowObj.isSelectable && rowObj.isSelected)) {\n                this.selectedRowState[\"\" + pKey_1] = chkState;\n                delete (this.unSelectedRowState[\"\" + pKey_1]);\n                if (!this.persistSelectedData.some(function (data) { return _this.getPkValue(_this.primaryKey, data) === pKey_1; })) {\n                    this.persistSelectedData.push(rowObj.data);\n                }\n            }\n            else {\n                this.updatePersistDelete(pKey_1);\n            }\n        }\n    };\n    Selection.prototype.updatePersistDelete = function (pKey, isPartialSelection) {\n        var _this = this;\n        delete (this.selectedRowState[\"\" + pKey]);\n        if (this.rmtHdrChkbxClicked) {\n            this.unSelectedRowState[\"\" + pKey] = true;\n        }\n        var index;\n        var isPresent = this.persistSelectedData.some(function (data, i) {\n            index = i;\n            return _this.getPkValue(_this.primaryKey, data) === pKey;\n        });\n        if (isPresent) {\n            this.persistSelectedData.splice(index, 1);\n            if (isPartialSelection) {\n                this.parent.partialSelectedRecords.splice(index, 1);\n            }\n        }\n    };\n    Selection.prototype.updateCheckBoxes = function (row, chkState, rowIndex) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row)) {\n            var chkBox = row.querySelector('.e-checkselect');\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(chkBox)) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.removeAddCboxClasses)(chkBox.nextElementSibling, chkState);\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.setChecked)(chkBox, chkState);\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.checkedTarget) || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.checkedTarget)\n                    && !this.checkedTarget.classList.contains('e-checkselectall'))) {\n                    this.setCheckAllState(rowIndex);\n                }\n            }\n        }\n    };\n    Selection.prototype.updateRowSelection = function (selectedRow, startIndex, preventFocus) {\n        if (!selectedRow) {\n            return;\n        }\n        if (this.selectedRowIndexes.indexOf(startIndex) === -1) {\n            if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n                this.virtualSelectedData.push(this.parent.getRowObjectFromUID(selectedRow.getAttribute('data-uid')).data);\n            }\n            this.selectedRowIndexes.push(startIndex);\n            this.selectedRecords.push(selectedRow);\n        }\n        selectedRow.setAttribute('aria-selected', 'true');\n        this.updatePersistCollection(selectedRow, true);\n        this.updateCheckBoxes(selectedRow, true);\n        this.addRemoveClassesForRow(selectedRow, true, null, 'e-selectionbackground', 'e-active');\n        if (!this.preventFocus && !(this.parent.isFocusFirstCell || this.isFocusLastCell)) {\n            var target = this.focus.getPrevIndexes().cellIndex ?\n                selectedRow.cells[this.focus.getPrevIndexes().cellIndex] :\n                selectedRow.querySelector('.e-selectionbackground:not(.e-hide):not(.e-detailrowcollapse):not(.e-detailrowexpand)');\n            if (this.parent.contextMenuModule && this.mouseButton === 2) {\n                target = this.parent.contextMenuModule.cell;\n            }\n            if (!target || preventFocus) {\n                return;\n            }\n            this.focus.onClick({ target: target }, true);\n        }\n        else {\n            if (this.parent.isFocusFirstCell || this.isFocusLastCell) {\n                this.parent.isFocusFirstCell = false;\n                var selector = this.isFocusLastCell ? 'last-child' : 'first-child';\n                var target = selectedRow.querySelector('.e-selectionbackground.e-rowcell:not(.e-hide, .e-detailrowcollapse, .e-detailrowexpand, .e-rowdragdrop, .e-gridchkbox):' + selector);\n                this.isFocusLastCell = false;\n                if (target) {\n                    this.focus.onClick({ target: target }, true, true);\n                }\n            }\n        }\n    };\n    /**\n     * Deselects the currently selected rows and cells.\n     *\n     * @returns {void}\n     */\n    Selection.prototype.clearSelection = function () {\n        this.checkSelectAllClicked = true;\n        if (this.selectionSettings.persistSelection && this.persistSelectedData.length) {\n            this.deSelectedData = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.iterateExtend)(this.persistSelectedData);\n        }\n        if (!this.parent.isPersistSelection || (this.parent.isPersistSelection && !this.parent.isEdit) ||\n            (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.checkedTarget) && this.checkedTarget.classList.contains('e-checkselectall'))) {\n            var span = this.parent.element.querySelector('.e-gridpopup').querySelector('span');\n            if (span.classList.contains('e-rowselect')) {\n                span.classList.remove('e-spanclicked');\n            }\n            if (this.parent.isPersistSelection) {\n                this.persistSelectedData = [];\n                this.selectedRowState = {};\n                this.parent.partialSelectedRecords = [];\n                this.parent.disableSelectedRecords = [];\n                var rowObjects = this.parent.getRowsObject();\n                for (var i = 0; i < rowObjects.length; i++) {\n                    if (rowObjects[i].isDataRow) {\n                        if (rowObjects[i].isSelectable) {\n                            this.parent.partialSelectedRecords.push(rowObjects[i].data);\n                        }\n                        else {\n                            this.parent.disableSelectedRecords.push(rowObjects[i].data);\n                        }\n                    }\n                }\n            }\n            this.clearRowSelection();\n            this.clearCellSelection();\n            this.clearColumnSelection();\n            this.prevRowIndex = undefined;\n            this.prevCIdxs = undefined;\n            this.prevECIdxs = undefined;\n            this.enableSelectMultiTouch = false;\n            this.isInteracted = false;\n            this.checkSelectAllClicked = false;\n            this.isHdrSelectAllClicked = false;\n        }\n    };\n    /**\n     * Deselects the currently selected rows.\n     *\n     * @returns {void}\n     */\n    Selection.prototype.clearRowSelection = function () {\n        var _this = this;\n        if (this.isRowSelected) {\n            var rows_1 = this.parent.getDataRows();\n            var data_1 = [];\n            var row_1 = [];\n            var rowIndex_1 = [];\n            var foreignKeyData_1 = [];\n            var target_1 = this.target;\n            this.isRowDeselect = true;\n            for (var i = 0, len = this.selectedRowIndexes.length; i < len; i++) {\n                var currentRow = void 0;\n                if (this.parent.enableVirtualization || (this.parent.enableInfiniteScrolling\n                    && this.parent.infiniteScrollSettings.enableCache)) {\n                    currentRow = this.parent.getRowByIndex(this.selectedRowIndexes[parseInt(i.toString(), 10)]);\n                }\n                else {\n                    currentRow = this.parent.editSettings.mode === 'Batch' ?\n                        this.parent.getRows()[this.selectedRowIndexes[parseInt(i.toString(), 10)]]\n                        : this.parent.getDataRows()[this.selectedRowIndexes[parseInt(i.toString(), 10)]];\n                }\n                var rowObj = this.getRowObj(currentRow);\n                if (rowObj) {\n                    data_1.push(rowObj.data);\n                    row_1.push(currentRow);\n                    rowIndex_1.push(this.selectedRowIndexes[parseInt(i.toString(), 10)]);\n                    foreignKeyData_1.push(rowObj.foreignKeyData);\n                }\n            }\n            if (this.selectionSettings.persistSelection && this.selectionSettings.checkboxMode !== 'ResetOnRowClick') {\n                this.isRowClicked = this.checkSelectAllClicked ? true : false;\n            }\n            this.rowDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowDeselecting, rowIndex_1, data_1, row_1, foreignKeyData_1, target_1, null, function () {\n                if (_this.isCancelDeSelect && (_this.isRowClicked || _this.checkSelectAllClicked || (_this.isInteracted &&\n                    !_this.parent.isPersistSelection))) {\n                    if (_this.parent.isPersistSelection) {\n                        if (_this.getCheckAllStatus(_this.parent.element.querySelector('.e-checkselectall')) === 'Intermediate' || _this.parent.isPersistSelection) {\n                            for (var i = 0; i < _this.selectedRecords.length; i++) {\n                                _this.updatePersistCollection(_this.selectedRecords[parseInt(i.toString(), 10)], true);\n                            }\n                        }\n                        else {\n                            _this.parent.checkAllRows = 'Check';\n                            _this.updatePersistSelectedData(true);\n                        }\n                    }\n                    if (_this.clearRowCheck) {\n                        _this.clearRowCallBack();\n                        _this.clearRowCheck = false;\n                        if (_this.selectRowCheck) {\n                            _this.selectRowCallBack();\n                            _this.selectRowCheck = false;\n                        }\n                    }\n                    return;\n                }\n                var element = [].slice.call(rows_1.filter(function (record) { return record.hasAttribute('aria-selected'); }));\n                for (var j = 0; j < element.length; j++) {\n                    if (!_this.disableUI) {\n                        element[parseInt(j.toString(), 10)].removeAttribute('aria-selected');\n                        _this.addRemoveClassesForRow(element[parseInt(j.toString(), 10)], false, true, 'e-selectionbackground', 'e-active');\n                    }\n                    // tslint:disable-next-line:align\n                    if (!_this.isPrevRowSelection) {\n                        _this.updatePersistCollection(element[parseInt(j.toString(), 10)], false);\n                    }\n                    _this.updateCheckBoxes(element[parseInt(j.toString(), 10)]);\n                }\n                if ((_this.parent.enableVirtualization || (_this.parent.enableInfiniteScrolling\n                    && _this.parent.infiniteScrollSettings.enableCache)) && _this.selectedRecords.length && !element.length\n                    && !_this.parent.selectionSettings.persistSelection && !_this.disableUI\n                    && !_this.parent.isCheckBoxSelection) {\n                    _this.addRemoveClassesForRow(null, false, true);\n                }\n                _this.virtualSelectedData = [];\n                _this.selectedRowIndexes = [];\n                _this.selectedRecords = [];\n                _this.isRowSelected = false;\n                _this.selectRowIndex(-1);\n                _this.isPrevRowSelection = false;\n                _this.rowDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowDeselected, rowIndex_1, data_1, row_1, foreignKeyData_1, target_1, null, undefined, null);\n                if (_this.clearRowCheck) {\n                    _this.clearRowCallBack();\n                    _this.clearRowCheck = false;\n                    if (_this.selectRowCheck) {\n                        _this.selectRowCallBack();\n                        _this.selectRowCheck = false;\n                    }\n                }\n            }, null);\n            this.isRowDeselect = false;\n        }\n        else {\n            if (this.clearRowCheck) {\n                this.clearRowCallBack();\n                this.clearRowCheck = false;\n                if (this.selectRowCheck) {\n                    this.selectRowCallBack();\n                    this.selectRowCheck = false;\n                }\n            }\n        }\n    };\n    Selection.prototype.rowDeselect = function (type, rowIndex, data, row, \n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    foreignKeyData, target, mRow, rowDeselectCallBack, frozenRightRow) {\n        var _this = this;\n        if ((this.selectionSettings.persistSelection && (this.isRowClicked || !this.isRowDeselect || this.checkSelectAllClicked || (this.focus['activeKey'] &&\n            this.focus.currentInfo.element.classList.contains('e-gridchkbox') && this.focus['activeKey'] === 'space'))) ||\n            !this.selectionSettings.persistSelection) {\n            var cancl_1 = 'cancel';\n            var isSingleDeSel = rowIndex.length === 1 && this.deSelectedData.length === 1;\n            var rowDeselectObj = {\n                rowIndex: rowIndex[0], data: this.selectionSettings.persistSelection && (this.parent.checkAllRows === 'Uncheck' &&\n                    !isSingleDeSel) && this.selectionSettings.checkboxMode !== 'ResetOnRowClick' ? this.deSelectedData : data,\n                foreignKeyData: foreignKeyData, cancel: false, isInteracted: this.isInteracted,\n                isHeaderCheckboxClicked: this.isHeaderCheckboxClicked\n            };\n            if (type === 'rowDeselected') {\n                delete rowDeselectObj.cancel;\n            }\n            var rowInString = 'row';\n            var target_2 = 'target';\n            var rowidx = 'rowIndex';\n            var rowidxex = 'rowIndexes';\n            var dataTxt = 'data';\n            var foreignKey = 'foreignKeyData';\n            rowDeselectObj[\"\" + rowInString] = row;\n            rowDeselectObj[\"\" + target_2] = this.actualTarget;\n            var isHeaderCheckBxClick = this.actualTarget && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(this.actualTarget, 'thead'));\n            if (isHeaderCheckBxClick || rowIndex.length > 1) {\n                rowDeselectObj[\"\" + rowidx] = rowIndex[0];\n                rowDeselectObj[\"\" + rowidxex] = rowIndex;\n            }\n            else if (rowIndex.length === 1) {\n                rowDeselectObj[\"\" + dataTxt] = rowDeselectObj[\"\" + dataTxt][0];\n                rowDeselectObj[\"\" + rowInString] = rowDeselectObj[\"\" + rowInString][0];\n                rowDeselectObj[\"\" + foreignKey] = rowDeselectObj[\"\" + foreignKey][0];\n                if (this.isAddRowsToSelection) {\n                    rowDeselectObj[\"\" + rowidxex] = rowIndex;\n                }\n            }\n            this.parent.trigger(type, rowDeselectObj, function (args) {\n                _this.isCancelDeSelect = args[\"\" + cancl_1];\n                if (!_this.isCancelDeSelect || (!_this.isRowClicked && !_this.isInteracted && !_this.checkSelectAllClicked)) {\n                    _this.updatePersistCollection(row[0], false);\n                    _this.updateCheckBoxes(row[0], undefined, rowIndex[0]);\n                }\n                if (rowDeselectCallBack !== undefined) {\n                    rowDeselectCallBack();\n                }\n            });\n        }\n        else if (this.selectionSettings.persistSelection && !this.isInteracted) {\n            if (rowDeselectCallBack !== undefined) {\n                rowDeselectCallBack();\n            }\n        }\n    };\n    Selection.prototype.getRowObj = function (row) {\n        if (row === void 0) { row = this.currentIndex; }\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row)) {\n            return {};\n        }\n        if (typeof row === 'number') {\n            row = this.parent.getRowByIndex(row);\n        }\n        if (row) {\n            return this.parent.getRowObjectFromUID(row.getAttribute('data-uid')) || {};\n        }\n        return {};\n    };\n    /**\n     * Selects a cell by the given index.\n     *\n     * @param  {IIndex} cellIndex - Defines the row and column indexes.\n     * @param  {boolean} isToggle - If set to true, then it toggles the selection.\n     * @returns {void}\n     */\n    Selection.prototype.selectCell = function (cellIndex, isToggle) {\n        if (!this.isCellType() || (this.isCellType() && (this.parent.enableVirtualization ||\n            (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache)))) {\n            return;\n        }\n        var gObj = this.parent;\n        var args;\n        var selectedCell = gObj.getCellFromIndex(cellIndex.rowIndex, this.getColIndex(cellIndex.rowIndex, cellIndex.cellIndex));\n        this.currentIndex = cellIndex.rowIndex;\n        var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n        if (!this.isCellType() || !selectedCell || this.isEditing()) {\n            return;\n        }\n        var isCellSelected = selectedCell.classList.contains('e-cellselectionbackground');\n        isToggle = !isToggle ? isToggle : (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(this.prevCIdxs) &&\n            cellIndex.rowIndex === this.prevCIdxs.rowIndex && cellIndex.cellIndex === this.prevCIdxs.cellIndex &&\n            isCellSelected);\n        if (!isToggle) {\n            args = {\n                data: selectedData, cellIndex: cellIndex,\n                isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest,\n                previousRowCell: this.prevECIdxs ?\n                    this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined,\n                cancel: false\n            };\n            var currentCell = 'currentCell';\n            args[\"\" + currentCell] = selectedCell;\n            var previousRowCellIndex = 'previousRowCellIndex';\n            args[\"\" + previousRowCellIndex] = this.prevECIdxs;\n            this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelecting, this.fDataUpdate(args), this.successCallBack(args, isToggle, cellIndex, selectedCell, selectedData));\n            this.cellselected = true;\n        }\n        else {\n            this.successCallBack(args, isToggle, cellIndex, selectedCell, selectedData)(args);\n        }\n    };\n    Selection.prototype.successCallBack = function (cellSelectingArgs, isToggle, cellIndex, selectedCell, selectedData) {\n        var _this = this;\n        return function (cellSelectingArgs) {\n            var cncl = 'cancel';\n            var currentCell = 'currentCell';\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cellSelectingArgs) && cellSelectingArgs[\"\" + cncl] === true) {\n                return;\n            }\n            if (!isToggle) {\n                cellSelectingArgs[\"\" + currentCell] = cellSelectingArgs[\"\" + currentCell] ? cellSelectingArgs[\"\" + currentCell] : selectedCell;\n            }\n            _this.clearCell();\n            if (!isToggle) {\n                _this.updateCellSelection(selectedCell, cellIndex.rowIndex, cellIndex.cellIndex);\n            }\n            if (!isToggle) {\n                var args = {\n                    data: selectedData, cellIndex: cellIndex, currentCell: selectedCell,\n                    selectedRowCellIndex: _this.selectedRowCellIndexes,\n                    previousRowCell: _this.prevECIdxs ?\n                        _this.getCellIndex(_this.prevECIdxs.rowIndex, _this.prevECIdxs.cellIndex) : undefined\n                };\n                var previousRowCellIndex = 'previousRowCellIndex';\n                args[\"\" + previousRowCellIndex] = _this.prevECIdxs;\n                _this.updateCellProps(cellIndex, cellIndex);\n                _this.onActionComplete(args, _base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelected);\n            }\n        };\n    };\n    Selection.prototype.getCellIndex = function (rIdx, cIdx) {\n        return this.parent.getCellFromIndex(rIdx, cIdx);\n    };\n    /**\n     * Selects a range of cells from start and end indexes.\n     *\n     * @param  {IIndex} startIndex - Specifies the row and column's start index.\n     * @param  {IIndex} endIndex - Specifies the row and column's end index.\n     * @returns {void}\n     */\n    Selection.prototype.selectCellsByRange = function (startIndex, endIndex) {\n        var _this = this;\n        if (!this.isCellType()) {\n            return;\n        }\n        var gObj = this.parent;\n        var selectedCell = this.parent.isSpan ? (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getCellFromRow)(this.parent, startIndex.rowIndex, startIndex.cellIndex) :\n            gObj.getCellFromIndex(startIndex.rowIndex, startIndex.cellIndex);\n        var min;\n        var max;\n        var stIndex = startIndex;\n        var edIndex = endIndex = endIndex ? endIndex : startIndex;\n        var cellIndexes;\n        this.currentIndex = startIndex.rowIndex;\n        var cncl = 'cancel';\n        var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n        if (this.isSingleSel() || !this.isCellType() || this.isEditing()) {\n            return;\n        }\n        var args = {\n            data: selectedData, cellIndex: startIndex, currentCell: selectedCell,\n            isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest,\n            previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n        };\n        var previousRowCellIndex = 'previousRowCellIndex';\n        args[\"\" + previousRowCellIndex] = this.prevECIdxs;\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelecting, this.fDataUpdate(args), function (cellSelectingArgs) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cellSelectingArgs) && cellSelectingArgs[\"\" + cncl] === true) {\n                return;\n            }\n            _this.clearCell();\n            if (startIndex.rowIndex > endIndex.rowIndex) {\n                var temp = startIndex;\n                startIndex = endIndex;\n                endIndex = temp;\n            }\n            for (var i = startIndex.rowIndex; i <= endIndex.rowIndex; i++) {\n                if (_this.selectionSettings.cellSelectionMode.indexOf('Box') < 0) {\n                    min = i === startIndex.rowIndex ? (startIndex.cellIndex) : 0;\n                    max = i === endIndex.rowIndex ? (endIndex.cellIndex) : _this.getLastColIndex(i);\n                }\n                else {\n                    min = startIndex.cellIndex;\n                    max = endIndex.cellIndex;\n                }\n                cellIndexes = [];\n                for (var j = min < max ? min : max, len = min > max ? min : max; j <= len; j++) {\n                    selectedCell = _this.parent.isSpan ? (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getCellFromRow)(gObj, i, j) : gObj.getCellFromIndex(i, j);\n                    if (!selectedCell) {\n                        continue;\n                    }\n                    cellIndexes.push(j);\n                    _this.updateCellSelection(selectedCell);\n                    _this.addAttribute(selectedCell);\n                }\n                _this.selectedRowCellIndexes.push({ rowIndex: i, cellIndexes: cellIndexes });\n            }\n            var cellSelectedArgs = {\n                data: selectedData, cellIndex: edIndex, currentCell: gObj.getCellFromIndex(edIndex.rowIndex, edIndex.cellIndex),\n                selectedRowCellIndex: _this.selectedRowCellIndexes,\n                previousRowCell: _this.prevECIdxs ? _this.getCellIndex(_this.prevECIdxs.rowIndex, _this.prevECIdxs.cellIndex) : undefined\n            };\n            var previousRowCellIndex = 'previousRowCellIndex';\n            cellSelectedArgs[\"\" + previousRowCellIndex] = _this.prevECIdxs;\n            if (!_this.isDragged) {\n                _this.onActionComplete(cellSelectedArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelected);\n                _this.cellselected = true;\n            }\n            _this.updateCellProps(stIndex, edIndex);\n        });\n    };\n    /**\n     * Selects a collection of cells by row and column indexes.\n     *\n     * @param  {ISelectedCell[]} rowCellIndexes - Specifies the row and column indexes.\n     * @returns {void}\n     */\n    Selection.prototype.selectCells = function (rowCellIndexes) {\n        if (!this.isCellType()) {\n            return;\n        }\n        var gObj = this.parent;\n        var selectedCell = gObj.getCellFromIndex(rowCellIndexes[0].rowIndex, rowCellIndexes[0].cellIndexes[0]);\n        this.currentIndex = rowCellIndexes[0].rowIndex;\n        var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n        if (this.isSingleSel() || !this.isCellType() || this.isEditing()) {\n            return;\n        }\n        var cellSelectArgs = {\n            data: selectedData, cellIndex: rowCellIndexes[0].cellIndexes[0],\n            currentCell: selectedCell, isCtrlPressed: this.isMultiCtrlRequest,\n            isShiftPressed: this.isMultiShiftRequest,\n            previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n        };\n        var previousRowCellIndex = 'previousRowCellIndex';\n        cellSelectArgs[\"\" + previousRowCellIndex] = this.prevECIdxs;\n        this.onActionBegin(cellSelectArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelecting);\n        for (var i = 0, len = rowCellIndexes.length; i < len; i++) {\n            for (var j = 0, cellLen = rowCellIndexes[parseInt(i.toString(), 10)].cellIndexes.length; j < cellLen; j++) {\n                selectedCell = gObj.getCellFromIndex(rowCellIndexes[parseInt(i.toString(), 10)].rowIndex, rowCellIndexes[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)]);\n                if (!selectedCell) {\n                    continue;\n                }\n                this.updateCellSelection(selectedCell);\n                this.addAttribute(selectedCell);\n                this.addRowCellIndex({ rowIndex: rowCellIndexes[parseInt(i.toString(), 10)].rowIndex,\n                    cellIndex: rowCellIndexes[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)] });\n            }\n        }\n        this.updateCellProps({ rowIndex: rowCellIndexes[0].rowIndex, cellIndex: rowCellIndexes[0].cellIndexes[0] }, { rowIndex: rowCellIndexes[0].rowIndex, cellIndex: rowCellIndexes[0].cellIndexes[0] });\n        var cellSelectedArgs = {\n            data: selectedData, cellIndex: rowCellIndexes[0].cellIndexes[0],\n            currentCell: selectedCell, selectedRowCellIndex: this.selectedRowCellIndexes,\n            previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n        };\n        var prvRowCellIndex = 'previousRowCellIndex';\n        cellSelectedArgs[\"\" + prvRowCellIndex] = this.prevECIdxs;\n        this.onActionComplete(cellSelectedArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelected);\n    };\n    /**\n     * Select cells with existing cell selection by passing row and column index.\n     *\n     * @param {IIndex} cellIndexes - Defines the collection of row and column index.\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.addCellsToSelection = function (cellIndexes) {\n        if (!this.isCellType() || (this.isCellType() && (this.parent.enableVirtualization ||\n            (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache)))) {\n            return;\n        }\n        var gObj = this.parent;\n        var selectedCell;\n        var index;\n        this.currentIndex = cellIndexes[0].rowIndex;\n        var cncl = 'cancel';\n        var selectedData = this.getCurrentBatchRecordChanges()[this.currentIndex];\n        if (this.isSingleSel() || !this.isCellType() || this.isEditing()) {\n            return;\n        }\n        this.hideAutoFill();\n        var rowObj;\n        rowObj = gObj.getRowsObject()[cellIndexes[0].rowIndex];\n        if (gObj.groupSettings.columns.length > 0) {\n            rowObj = gObj.getRowObjectFromUID(this.target.parentElement.getAttribute('data-uid'));\n        }\n        var foreignKeyData = [];\n        for (var _i = 0, cellIndexes_1 = cellIndexes; _i < cellIndexes_1.length; _i++) {\n            var cellIndex = cellIndexes_1[_i];\n            for (var i = 0, len = this.selectedRowCellIndexes.length; i < len; i++) {\n                if (this.selectedRowCellIndexes[parseInt(i.toString(), 10)].rowIndex === cellIndex.rowIndex) {\n                    index = i;\n                    break;\n                }\n            }\n            selectedCell = gObj.getCellFromIndex(cellIndex.rowIndex, this.getColIndex(cellIndex.rowIndex, cellIndex.cellIndex));\n            var idx = cellIndex.cellIndex;\n            if (gObj.groupSettings.columns.length > 0) {\n                foreignKeyData.push(rowObj.cells[idx + gObj.groupSettings.columns.length].foreignKeyData);\n            }\n            else {\n                foreignKeyData.push(rowObj.cells[parseInt(idx.toString(), 10)].foreignKeyData);\n            }\n            var args = {\n                cancel: false, data: selectedData, cellIndex: cellIndexes[0],\n                isShiftPressed: this.isMultiShiftRequest,\n                currentCell: selectedCell, isCtrlPressed: this.isMultiCtrlRequest,\n                previousRowCell: this.prevECIdxs ?\n                    gObj.getCellFromIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) : undefined\n            };\n            var prvRowCellIndex = 'previousRowCellIndex';\n            args[\"\" + prvRowCellIndex] = this.prevECIdxs;\n            var isUnSelected = index > -1;\n            if (isUnSelected) {\n                var selectedCellIdx = this.selectedRowCellIndexes[parseInt(index.toString(), 10)].cellIndexes;\n                if (selectedCellIdx.indexOf(cellIndex.cellIndex) > -1 || (this.selectionSettings.mode === 'Both' &&\n                    selectedCell.classList.contains('e-gridchkbox') && !selectedCell.getAttribute('aria-selected'))) {\n                    this.cellDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.cellDeselecting, [{ rowIndex: cellIndex.rowIndex, cellIndexes: [cellIndex.cellIndex] }], selectedData, [selectedCell], foreignKeyData);\n                    selectedCellIdx.splice(selectedCellIdx.indexOf(cellIndex.cellIndex), 1);\n                    if (selectedCellIdx.length === 0) {\n                        this.selectedRowCellIndexes.splice(index, 1);\n                    }\n                    selectedCell.classList.remove('e-cellselectionbackground');\n                    selectedCell.removeAttribute('aria-selected');\n                    this.cellDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.cellDeselected, [{ rowIndex: cellIndex.rowIndex, cellIndexes: [cellIndex.cellIndex] }], selectedData, [selectedCell], foreignKeyData);\n                }\n                else {\n                    isUnSelected = false;\n                    this.onActionBegin(args, _base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelecting);\n                    this.addRowCellIndex({ rowIndex: cellIndex.rowIndex, cellIndex: cellIndex.cellIndex });\n                    this.updateCellSelection(selectedCell);\n                    this.addAttribute(selectedCell);\n                }\n            }\n            else {\n                this.onActionBegin(args, _base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelecting);\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args) && args[\"\" + cncl] === true) {\n                    return;\n                }\n                this.updateCellSelection(selectedCell, cellIndex.rowIndex, cellIndex.cellIndex);\n            }\n            if (!isUnSelected) {\n                var cellSelectedArgs = {\n                    data: selectedData, cellIndex: cellIndexes[0], currentCell: selectedCell,\n                    previousRowCell: this.prevECIdxs ? this.getCellIndex(this.prevECIdxs.rowIndex, this.prevECIdxs.cellIndex) :\n                        undefined, selectedRowCellIndex: this.selectedRowCellIndexes\n                };\n                cellSelectedArgs[\"\" + prvRowCellIndex] = this.prevECIdxs;\n                this.onActionComplete(cellSelectedArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelected);\n                this.cellselected = true;\n            }\n            this.updateCellProps(cellIndex, cellIndex);\n        }\n    };\n    Selection.prototype.getColIndex = function (rowIndex, index) {\n        var col = this.parent.getColumnByIndex(index);\n        var cells = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getCellsByTableName)(this.parent, col, rowIndex);\n        if (cells) {\n            for (var m = 0; m < cells.length; m++) {\n                var colIndex = parseInt(cells[parseInt(m.toString(), 10)].getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n                if (colIndex === index) {\n                    return m;\n                }\n            }\n        }\n        return -1;\n    };\n    Selection.prototype.getLastColIndex = function (rowIndex) {\n        var cells = this.parent.getDataRows()[parseInt(rowIndex.toString(), 10)].querySelectorAll('td.e-rowcell');\n        return parseInt(cells[cells.length - 1].getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n    };\n    Selection.prototype.clearCell = function () {\n        this.clearCellSelection();\n    };\n    Selection.prototype.cellDeselect = function (type, cellIndexes, data, cells, foreignKeyData) {\n        var cancl = 'cancel';\n        if (cells && cells.length > 0) {\n            for (var _i = 0, cells_1 = cells; _i < cells_1.length; _i++) {\n                var cell = cells_1[_i];\n                if (cell && cell.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.gridChkBox)) {\n                    this.updateCheckBoxes((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(cell, 'tr'));\n                }\n            }\n        }\n        var args = {\n            cells: cells, data: data, cellIndexes: cellIndexes, foreignKeyData: foreignKeyData, cancel: false\n        };\n        this.parent.trigger(type, args);\n        this.isPreventCellSelect = args[\"\" + cancl];\n    };\n    Selection.prototype.updateCellSelection = function (selectedCell, rowIndex, cellIndex) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(rowIndex)) {\n            this.addRowCellIndex({ rowIndex: rowIndex, cellIndex: cellIndex });\n        }\n        selectedCell.classList.add('e-cellselectionbackground');\n        if (selectedCell.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.gridChkBox)) {\n            this.updateCheckBoxes((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(selectedCell, 'tr'), true);\n        }\n        this.addAttribute(selectedCell);\n    };\n    Selection.prototype.addAttribute = function (cell) {\n        this.target = cell;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell)) {\n            cell.setAttribute('aria-selected', 'true');\n            if (!this.preventFocus) {\n                this.focus.onClick({ target: cell }, true);\n            }\n        }\n    };\n    Selection.prototype.updateCellProps = function (startIndex, endIndex) {\n        this.prevCIdxs = startIndex;\n        this.prevECIdxs = endIndex;\n        this.isCellSelected = this.selectedRowCellIndexes.length && true;\n    };\n    Selection.prototype.addRowCellIndex = function (rowCellIndex) {\n        var isRowAvail;\n        var index;\n        for (var i = 0, len = this.selectedRowCellIndexes.length; i < len; i++) {\n            if (this.selectedRowCellIndexes[parseInt(i.toString(), 10)].rowIndex === rowCellIndex.rowIndex) {\n                isRowAvail = true;\n                index = i;\n                break;\n            }\n        }\n        if (isRowAvail) {\n            if (this.selectedRowCellIndexes[parseInt(index.toString(), 10)].cellIndexes.indexOf(rowCellIndex.cellIndex) < 0) {\n                this.selectedRowCellIndexes[parseInt(index.toString(), 10)].cellIndexes.push(rowCellIndex.cellIndex);\n            }\n        }\n        else {\n            this.selectedRowCellIndexes.push({ rowIndex: rowCellIndex.rowIndex, cellIndexes: [rowCellIndex.cellIndex] });\n        }\n    };\n    /**\n     * Deselects the currently selected cells.\n     *\n     * @returns {void}\n     */\n    Selection.prototype.clearCellSelection = function () {\n        if (this.isCellSelected) {\n            var gObj = this.parent;\n            var selectedCells = this.getSelectedCellsElement();\n            var rowCell = this.selectedRowCellIndexes;\n            var data = [];\n            var cells = [];\n            var foreignKeyData = [];\n            var currentViewData = this.getCurrentBatchRecordChanges();\n            this.hideAutoFill();\n            for (var i = 0, len = rowCell.length; i < len; i++) {\n                data.push(currentViewData[rowCell[parseInt(i.toString(), 10)].rowIndex]);\n                var rowObj = this.getRowObj(rowCell[parseInt(i.toString(), 10)].rowIndex);\n                for (var j = 0, cLen = rowCell[parseInt(i.toString(), 10)].cellIndexes.length; j < cLen; j++) {\n                    if (rowObj.cells) {\n                        foreignKeyData.push(rowObj.cells[rowCell[parseInt(i.toString(), 10)]\n                            .cellIndexes[parseInt(j.toString(), 10)]].foreignKeyData);\n                    }\n                    cells.push(gObj.getCellFromIndex(rowCell[parseInt(i.toString(), 10)].rowIndex, rowCell[parseInt(i.toString(), 10)].cellIndexes[parseInt(j.toString(), 10)]));\n                }\n            }\n            this.cellDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.cellDeselecting, rowCell, data, cells, foreignKeyData);\n            if (this.isPreventCellSelect === true) {\n                return;\n            }\n            for (var i = 0, len = selectedCells.length; i < len; i++) {\n                selectedCells[parseInt(i.toString(), 10)].classList.remove('e-cellselectionbackground');\n                selectedCells[parseInt(i.toString(), 10)].removeAttribute('aria-selected');\n            }\n            if (this.bdrElement) {\n                this.showHideBorders('none');\n            }\n            this.selectedRowCellIndexes = [];\n            this.isCellSelected = false;\n            if (!this.isDragged && this.cellselected) {\n                this.cellDeselect(_base_constant__WEBPACK_IMPORTED_MODULE_3__.cellDeselected, rowCell, data, cells, foreignKeyData);\n            }\n        }\n    };\n    Selection.prototype.getSelectedCellsElement = function () {\n        var gObj = this.parent;\n        var rows = gObj.getDataRows();\n        var cells = [];\n        for (var i = 0, len = rows.length; i < len; i++) {\n            cells = cells.concat([].slice.call(rows[parseInt(i.toString(), 10)].getElementsByClassName('e-cellselectionbackground')));\n        }\n        return cells;\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        e.preventDefault();\n        this.stopTimer();\n        var gBRect = this.parent.element.getBoundingClientRect();\n        var x1 = this.x;\n        var y1 = this.y;\n        var position = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getPosition)(e);\n        var x2 = position.x - gBRect.left;\n        var y2 = position.y - gBRect.top;\n        var tmp;\n        var target = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, 'tr');\n        this.isDragged = true;\n        if (!this.isCellDrag) {\n            if (!target) {\n                target = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(document.elementFromPoint(this.parent.element.offsetLeft + 2, e.clientY), 'tr');\n            }\n            if (x1 > x2) {\n                tmp = x2;\n                x2 = x1;\n                x1 = tmp;\n            }\n            if (y1 > y2) {\n                tmp = y2;\n                y2 = y1;\n                y1 = tmp;\n            }\n            this.element.style.left = x1 + 'px';\n            this.element.style.top = y1 + 'px';\n            this.element.style.width = x2 - x1 + 'px';\n            this.element.style.height = y2 - y1 + 'px';\n        }\n        if (target && !e.ctrlKey && !e.shiftKey) {\n            var rowIndex = parseInt(target.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n            if (!this.isCellDrag) {\n                this.hideAutoFill();\n                this.selectRowsByRange(this.startDIndex, rowIndex);\n                this.isRowDragSelected = true;\n            }\n            else {\n                var td = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell);\n                if (td) {\n                    this.startAFCell = this.startCell;\n                    this.endAFCell = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell);\n                    if (rowIndex > -1) {\n                        this.selectLikeExcel(e, rowIndex, parseInt(td.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1);\n                    }\n                }\n            }\n        }\n        if (!e.ctrlKey && !e.shiftKey && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling &&\n            !this.parent.enableColumnVirtualization && !this.parent.groupSettings.columns.length && this.isCellDrag) {\n            this.updateScrollPosition(e, position, this.parent.getContent());\n        }\n    };\n    Selection.prototype.updateScrollPosition = function (mouseEvent, position, scrollElement) {\n        var _this = this;\n        var clientRect = scrollElement.getBoundingClientRect();\n        if (clientRect.left >= position.x - 20 -\n            (this.parent.enableRtl && this.parent.height !== 'auto' ? (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getScrollBarWidth)() : 0)) {\n            this.timer1 = window.setInterval(function () { _this.setScrollPosition(scrollElement.firstElementChild, _this.parent.enableRtl ? 'right' : 'left', mouseEvent); }, 200);\n        }\n        else if (clientRect.left + scrollElement.clientWidth - 20 -\n            (!this.parent.enableRtl && this.parent.height !== 'auto' ? (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getScrollBarWidth)() : 0) < position.x) {\n            this.timer1 = window.setInterval(function () { _this.setScrollPosition(scrollElement.firstElementChild, _this.parent.enableRtl ? 'left' : 'right', mouseEvent); }, 200);\n        }\n        if (clientRect.top >= position.y - (this.parent.getRowHeight() * 0.5)) {\n            this.timer2 = window.setInterval(function () { _this.setScrollPosition(scrollElement.firstElementChild, 'up', mouseEvent); }, 200);\n        }\n        else if (clientRect.top + scrollElement.clientHeight - (this.parent.getRowHeight() * 0.5) -\n            (scrollElement.firstElementChild.scrollWidth > scrollElement.firstElementChild.offsetWidth ?\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getScrollBarWidth)() : 0) <= position.y) {\n            this.timer2 = window.setInterval(function () { _this.setScrollPosition(scrollElement.firstElementChild, 'down', mouseEvent); }, 200);\n        }\n    };\n    Selection.prototype.stopTimer = function () {\n        if (this.timer1) {\n            window.clearInterval(this.timer1);\n            this.timer1 = null;\n        }\n        if (this.timer2) {\n            window.clearInterval(this.timer2);\n            this.timer2 = null;\n        }\n        this.preventFocus = false;\n    };\n    Selection.prototype.setScrollPosition = function (scrollElement, direction, mouseEvent) {\n        var rowIndex = -1;\n        var columnIndex = -1;\n        if (this.endAFCell || this.prevECIdxs) {\n            rowIndex = this.endAFCell ? parseInt(this.endAFCell.getAttribute('index'), 10) : this.prevECIdxs.rowIndex;\n            columnIndex = this.endAFCell ? parseInt(this.endAFCell.getAttribute('aria-colindex'), 10) - 1 : this.prevECIdxs.cellIndex;\n        }\n        switch (direction) {\n            case 'up':\n                if (mouseEvent && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(mouseEvent.target, '.e-headercontent')) {\n                    return;\n                }\n                if (this.isAutoFillSel && this.startAFCell && this.selectedRowCellIndexes.length &&\n                    ((this.selectedRowCellIndexes.length === 1 && this.startAFCell !== this.startCell) ||\n                        (this.selectedRowCellIndexes.length > 1 && this.startAFCell.getBoundingClientRect().top > 0))) {\n                    rowIndex = parseInt(this.startAFCell.getAttribute('index'), 10);\n                }\n                rowIndex -= 1;\n                if (this.parent.frozenRows) {\n                    rowIndex += this.parent.frozenRows + 1;\n                }\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                rowIndex < 1 ? scrollElement.scrollTop = 0 : scrollElement.scrollTop -= this.parent.getRowByIndex(rowIndex)\n                    .offsetHeight;\n                break;\n            case 'down':\n                if (this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n                    rowIndex = parseInt(this.startAFCell.getAttribute('index'), 10);\n                }\n                if (rowIndex < this.parent.getRows().length - 1) {\n                    rowIndex += 1;\n                    if (this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n                        this.startAFCell = this.parent.getCellFromIndex(rowIndex, this.selectedRowCellIndexes[0].cellIndexes[0]);\n                    }\n                    scrollElement.scrollTop += this.parent.getRowByIndex(rowIndex).offsetHeight;\n                }\n                else {\n                    scrollElement.scrollTop = scrollElement.scrollHeight;\n                }\n                break;\n            case 'left':\n                if (columnIndex > 0 && rowIndex > -1) {\n                    if (this.isAutoFillSel && this.startAFCell && this.selectedRowCellIndexes.length &&\n                        ((this.selectedRowCellIndexes[0].cellIndexes.length > 0 && this.startAFCell !== this.startCell) ||\n                            (this.selectedRowCellIndexes[0].cellIndexes.length > 1 &&\n                                ((!this.parent.enableRtl && this.startAFCell.getBoundingClientRect().left > 0) || (this.parent.enableRtl &&\n                                    this.startAFCell.getBoundingClientRect().left < this.parent.element.offsetWidth))))) {\n                        columnIndex = parseInt(this.startAFCell.getAttribute('aria-colindex'), 10) - 1;\n                    }\n                    var nextElement_1 = this.findNextCell(scrollElement, direction, columnIndex, rowIndex);\n                    columnIndex = nextElement_1 ? parseInt(nextElement_1.getAttribute('aria-colindex'), 10) - 1 : -1;\n                    if (this.parent.enableRtl && nextElement_1) {\n                        // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                        columnIndex < 1 ? scrollElement.scrollLeft = scrollElement.scrollWidth :\n                            scrollElement.scrollLeft += nextElement_1.offsetWidth;\n                    }\n                    else if (nextElement_1) {\n                        // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                        columnIndex < 1 ? scrollElement.scrollLeft = 0 : scrollElement.scrollLeft -= nextElement_1.offsetWidth;\n                    }\n                }\n                break;\n            case 'right':\n                if (this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n                    columnIndex = parseInt(this.startAFCell.getAttribute('aria-colindex'), 10) - 1;\n                }\n                // eslint-disable-next-line no-case-declarations\n                var currentElement = this.parent.getCellFromIndex(rowIndex, columnIndex);\n                // eslint-disable-next-line no-case-declarations\n                var nextElement = this.findNextCell(scrollElement, direction, columnIndex, rowIndex);\n                if (nextElement && this.isAutoFillSel && this.startAFCell && this.startAFCell !== this.startCell) {\n                    this.startAFCell = this.parent.getCellFromIndex(this.selectedRowCellIndexes[0].rowIndex, parseInt(nextElement.getAttribute('aria-colindex'), 10) - 1);\n                }\n                columnIndex = nextElement ? parseInt(nextElement.getAttribute('aria-colindex'), 10) - 1 : -1;\n                if (this.parent.enableRtl && nextElement) {\n                    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                    columnIndex < this.parent.columns.length - 1 ? scrollElement.scrollLeft -= currentElement.offsetWidth :\n                        scrollElement.scrollLeft = -scrollElement.scrollWidth;\n                }\n                else if (nextElement) {\n                    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                    columnIndex < this.parent.columns.length - 1 ? scrollElement.scrollLeft += currentElement.offsetWidth :\n                        scrollElement.scrollLeft = scrollElement.scrollWidth;\n                }\n                if (this.isAutoFillSel && (columnIndex === this.parent.columns.length - 1 || columnIndex === -1) &&\n                    this.startAFCell && this.endAFCell) {\n                    this.positionAFBorders();\n                    scrollElement.scrollLeft = this.parent.enableRtl ? -scrollElement.scrollWidth : scrollElement.scrollWidth;\n                }\n                break;\n        }\n        if (rowIndex > -1 && rowIndex < this.parent.getRows().length && columnIndex > -1) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var mouseEvent_1 = { target: this.parent.getCellFromIndex(rowIndex, columnIndex) };\n            if (this.isAutoFillSel && mouseEvent_1.target.classList.contains('e-cellselectionbackground') &&\n                ((direction === 'down' && parseInt(mouseEvent_1.target.getAttribute('index'), 10) === this.parent.getRows().length - 1) ||\n                    (direction === 'right' && parseInt(mouseEvent_1.target.getAttribute('aria-colindex'), 10) - 1 === this.parent.columns.length - 1))) {\n                return;\n            }\n            this.endAFCell = mouseEvent_1.target;\n            this.preventFocus = true;\n            this.selectLikeExcel(mouseEvent_1, rowIndex, columnIndex);\n        }\n    };\n    Selection.prototype.findNextCell = function (scrollElement, direction, columnIndex, rowIndex) {\n        var nextElement = this.parent.getCellFromIndex(rowIndex, direction === 'left' ? columnIndex - 1 : columnIndex + 1);\n        if (nextElement && nextElement.classList.contains('e-hide')) {\n            var siblingEles = nextElement.closest('tr').querySelectorAll('.e-rowcell:not(.e-hide)');\n            var nextEleInd = Array.from(siblingEles).indexOf(nextElement.nextElementSibling);\n            if (nextEleInd > 0 && nextEleInd < siblingEles.length - 1) {\n                nextElement = siblingEles[nextEleInd + (direction === 'left' ? -1 : 1)];\n                return nextElement;\n            }\n            else {\n                scrollElement.scrollLeft = 0;\n                return null;\n            }\n        }\n        return nextElement;\n    };\n    Selection.prototype.selectLikeExcel = function (e, rowIndex, cellIndex) {\n        if (!this.isAutoFillSel) {\n            this.clearCellSelection();\n            this.selectCellsByRange({ rowIndex: this.startDIndex, cellIndex: this.startDCellIndex }, { rowIndex: rowIndex, cellIndex: cellIndex });\n            this.drawBorders();\n        }\n        else { //Autofill\n            this.showAFBorders();\n            this.selectLikeAutoFill(e);\n        }\n    };\n    Selection.prototype.setFrozenBorders = function (parentEle, border, bdrStr) {\n        var width = border.style.borderWidth.toString().split(' ');\n        var strCell = ['', 'e-leftfreeze', 'e-unfreeze', 'e-leftfreeze', 'e-unfreeze', 'e-rightfreeze', 'e-rightfreeze'];\n        var cells = [].slice.call(parentEle.querySelectorAll('.e-cellselectionbackground' + '.' + strCell[\"\" + bdrStr])).\n            filter(function (ele) { return ele.style.display === ''; });\n        var fixedCells = [].slice.call(parentEle.querySelectorAll('.e-cellselectionbackground.e-fixedfreeze')).\n            filter(function (ele) { return ele.style.display === ''; });\n        var isRtl = this.parent.enableRtl;\n        if (cells.length) {\n            var firstRowIdx = cells[0].getAttribute('index');\n            var firstColIdx = cells[0].getAttribute('aria-colindex');\n            var lastRowIdx = cells[cells.length - 1].getAttribute('index');\n            var lastColIdx = cells[cells.length - 1].getAttribute('aria-colindex');\n            for (var i = 0; i < cells.length; i++) {\n                if (cells[parseInt(i.toString(), 10)].getAttribute('index') === firstRowIdx && (width.length === 1 || (width.length === 3\n                    && parseInt(width[0], 10) === 2) || (width.length === 4 && parseInt(width[0], 10) === 2))) {\n                    cells[parseInt(i.toString(), 10)].classList.add('e-xlsel-top-border');\n                }\n                if (cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex') === firstColIdx && (width.length === 1 ||\n                    (width.length === 3 && parseInt(width[1], 10) === 2) || (width.length === 4 && (((!isRtl &&\n                    parseInt(width[3], 10) === 2)) || (isRtl && parseInt(width[1], 10) === 2))))) {\n                    cells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-right-border' : 'e-xlsel-left-border');\n                }\n                if (cells[parseInt(i.toString(), 10)].getAttribute('index') === lastRowIdx && (width.length === 1 ||\n                    (width.length === 3 && parseInt(width[2], 10) === 2) || (width.length === 4 && parseInt(width[2], 10) === 2))) {\n                    cells[parseInt(i.toString(), 10)].classList.add('e-xlsel-bottom-border');\n                }\n                if (cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex') === lastColIdx && (width.length === 1 ||\n                    (width.length === 3 && parseInt(width[1], 10) === 2) || (width.length === 4 && ((!isRtl &&\n                    parseInt(width[1], 10) === 2)) || (isRtl && parseInt(width[3], 10) === 2)))) {\n                    cells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-left-border' : 'e-xlsel-right-border');\n                }\n            }\n        }\n        if (fixedCells.length) {\n            var firstRowIdx = fixedCells[0].getAttribute('index');\n            var firstColIdx = (parseInt(fixedCells[0].getAttribute('aria-colindex'), 10) - 1).toString();\n            var lastRowIdx = fixedCells[fixedCells.length - 1].getAttribute('index');\n            var lastColIdx = (parseInt(fixedCells[fixedCells.length - 1].getAttribute('aria-colindex'), 10) - 1).toString();\n            for (var i = 0; i < fixedCells.length; i++) {\n                var idx = fixedCells[parseInt(i.toString(), 10)].getAttribute('index');\n                var colIdx = (parseInt(fixedCells[parseInt(i.toString(), 10)].getAttribute('aria-colindex'), 10) - 1).toString();\n                if (idx === firstRowIdx &&\n                    ((!this.parent.getHeaderContent().querySelector('.e-cellselectionbackground.e-fixedfreeze')\n                        && (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(parentEle, 'e-content')) || !(0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(parentEle, 'e-content'))) {\n                    fixedCells[parseInt(i.toString(), 10)].classList.add('e-xlsel-top-border');\n                }\n                if (idx === lastRowIdx &&\n                    ((!this.parent.getContent().querySelector('.e-cellselectionbackground.e-fixedfreeze')\n                        && (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(parentEle, 'e-headercontent')) || !(0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(parentEle, 'e-headercontent'))) {\n                    fixedCells[parseInt(i.toString(), 10)].classList.add('e-xlsel-bottom-border');\n                }\n                var preCell = fixedCells[parseInt(i.toString(), 10)].parentElement.children[parseInt(colIdx, 10) - 1];\n                if (colIdx === firstColIdx && (!preCell || (preCell && !preCell.classList.contains('e-cellselectionbackground')))) {\n                    fixedCells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-right-border' : 'e-xlsel-left-border');\n                }\n                var nextCell = fixedCells[parseInt(i.toString(), 10)].parentElement.children[parseInt(colIdx, 10) + 1];\n                if (colIdx === lastColIdx && (!nextCell || (nextCell && !nextCell.classList.contains('e-cellselectionbackground')))) {\n                    fixedCells[parseInt(i.toString(), 10)].classList.add(isRtl ? 'e-xlsel-left-border' : 'e-xlsel-right-border');\n                }\n            }\n        }\n    };\n    Selection.prototype.refreshFrozenBorders = function () {\n        if (this.bdrElement) {\n            this.setFrozenBorders(this.parent.getContentTable(), this.bdrElement, '1');\n            if (this.parent.isFrozenGrid() && this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight) {\n                this.setFrozenBorders(this.parent.getContentTable(), this.frcBdrElement, '5');\n            }\n            if (this.parent.frozenRows) {\n                this.setFrozenBorders(this.parent.getHeaderTable(), this.fhBdrElement, '3');\n                if (this.parent.isFrozenGrid() && this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight) {\n                    this.setFrozenBorders(this.parent.getHeaderTable(), this.frhBdrElement, '6');\n                }\n            }\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.drawBorders = function () {\n        if (this.selectionSettings.cellSelectionMode === 'BoxWithBorder' && this.selectedRowCellIndexes.length && !this.parent.isEdit) {\n            this.parent.element.classList.add('e-enabledboxbdr');\n            if (!this.bdrElement) {\n                this.createBorders();\n            }\n            this.positionBorders();\n            if (this.parent.isFrozenGrid()) {\n                this.showHideBorders('none', true);\n                this.refreshFrozenBorders();\n            }\n        }\n        else {\n            this.showHideBorders('none');\n        }\n    };\n    Selection.prototype.isLastCell = function (cell) {\n        var cells = [].slice.call(cell.parentElement.querySelectorAll('.e-rowcell:not(.e-hide)'));\n        return cells[cells.length - 1] === cell;\n    };\n    Selection.prototype.isLastRow = function (cell) {\n        var rows = [].slice.call((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(cell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.tbody).querySelectorAll('.e-row:not(.e-hiddenrow)'));\n        return cell.parentElement === rows[rows.length - 1];\n    };\n    Selection.prototype.isFirstRow = function (cell) {\n        var rows = [].slice.call((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(cell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.tbody).querySelectorAll('.e-row:not(.e-hiddenrow)'));\n        return cell.parentElement === rows[0];\n    };\n    Selection.prototype.isFirstCell = function (cell) {\n        var cells = [].slice.call(cell.parentElement.querySelectorAll('.e-rowcell:not(.e-hide)'));\n        return cells[0] === cell;\n    };\n    Selection.prototype.setBorders = function (parentEle, border, bdrStr) {\n        var cells = [].slice.call(parentEle.getElementsByClassName('e-cellselectionbackground')).\n            filter(function (ele) { return ele.style.display === ''; });\n        if (cells.length && this.parent.isFrozenGrid()) {\n            var strCell = ['', 'e-leftfreeze', 'e-unfreeze', 'e-leftfreeze', 'e-unfreeze', 'e-rightfreeze', 'e-rightfreeze'];\n            cells = [].slice.call(parentEle.querySelectorAll('.e-cellselectionbackground' + '.' + strCell[\"\" + bdrStr] + ':not(.e-hide)')).\n                filter(function (ele) { return ele.style.display === ''; });\n        }\n        if (cells.length) {\n            var isFrozen = this.parent.isFrozenGrid();\n            var start = cells[0];\n            var end = cells[cells.length - 1];\n            var stOff = start.getBoundingClientRect();\n            var endOff = end.getBoundingClientRect();\n            var parentOff = start.offsetParent.getBoundingClientRect();\n            if (start.offsetParent.classList.contains('e-content') || start.offsetParent.classList.contains('e-headercontent')) {\n                parentOff = start.offsetParent.querySelector('table').getBoundingClientRect();\n            }\n            var rowHeight = !isFrozen && this.isLastRow(end) && (bdrStr === '1' || bdrStr === '2' || bdrStr === '5') ? 2 : 0;\n            var topOffSet = 0;\n            var leftOffset = isFrozen && (bdrStr === '2' || bdrStr === '4') && this.isFirstCell(start) ? 1 : 0;\n            var rightOffset = ((this.parent.getFrozenMode() === 'Right' && (bdrStr === '1' || bdrStr === '3'))\n                || (this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight && (bdrStr === '5' || bdrStr === '6')))\n                && this.isFirstCell(start) ? 1 : 0;\n            if (this.parent.enableRtl) {\n                border.style.right = parentOff.right - stOff.right - leftOffset + 'px';\n                border.style.width = stOff.right - endOff.left + leftOffset + 1 + 'px';\n            }\n            else {\n                border.style.left = stOff.left - parentOff.left - leftOffset - rightOffset + 'px';\n                border.style.width = endOff.right - stOff.left + leftOffset - rightOffset + 1 + 'px';\n            }\n            border.style.top = stOff.top - parentOff.top - topOffSet + 'px';\n            border.style.height = endOff.top - stOff.top > 0 ?\n                (endOff.top - parentOff.top + endOff.height + (isFrozen ? 0 : 1)) - (stOff.top - parentOff.top) - rowHeight + topOffSet + 'px' :\n                endOff.height + topOffSet - rowHeight + (isFrozen ? 0 : 1) + 'px';\n            this.selectDirection += bdrStr;\n        }\n        else {\n            border.style.display = 'none';\n        }\n    };\n    Selection.prototype.positionBorders = function () {\n        this.updateStartEndCells();\n        if (!this.startCell || !this.bdrElement || !this.selectedRowCellIndexes.length) {\n            return;\n        }\n        this.selectDirection = '';\n        this.showHideBorders('');\n        this.setBorders(this.parent.getContentTable(), this.bdrElement, '1');\n        if (this.parent.isFrozenGrid()) {\n            this.setBorders(this.parent.getContentTable(), this.mcBdrElement, '2');\n            if (this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight) {\n                this.setBorders(this.parent.getContentTable(), this.frcBdrElement, '5');\n            }\n        }\n        if (this.parent.frozenRows) {\n            this.setBorders(this.parent.getHeaderTable(), this.fhBdrElement, '3');\n            if (this.parent.isFrozenGrid()) {\n                this.setBorders(this.parent.getHeaderTable(), this.mhBdrElement, '4');\n                if (this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight) {\n                    this.setBorders(this.parent.getHeaderTable(), this.frhBdrElement, '6');\n                }\n            }\n        }\n        this.applyBorders(this.selectDirection);\n    };\n    /* eslint-enable */\n    Selection.prototype.applyBothFrozenBorders = function (str) {\n        var rtl = this.parent.enableRtl;\n        switch (str.length) {\n            case 6:\n                {\n                    this.bdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                    this.mcBdrElement.style.borderWidth = this.bottom;\n                    this.fhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                    this.mhBdrElement.style.borderWidth = this.top;\n                    this.frcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                    this.frhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                }\n                break;\n            case 4:\n                {\n                    if (str.includes('1') && str.includes('2') && str.includes('3') && str.includes('4')) {\n                        this.fhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                        this.mhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                        this.bdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                        this.mcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                    }\n                    if (str.includes('2') && str.includes('4') && str.includes('5') && str.includes('6')) {\n                        this.mcBdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                        this.mhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                        this.frcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                        this.frhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                    }\n                }\n                break;\n            case 3:\n                {\n                    this.bdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                    this.mcBdrElement.style.borderWidth = this.top_bottom;\n                    this.frcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                    if (this.parent.frozenRows) {\n                        this.fhBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        this.mhBdrElement.style.borderWidth = this.top_bottom;\n                        this.frcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                    }\n                }\n                break;\n            case 2:\n                {\n                    if (str.includes('1')) {\n                        this.mcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                        if (this.parent.frozenRows) {\n                            this.fhBdrElement.style.borderWidth = this.top_right_left;\n                        }\n                    }\n                    if (str.includes('2')) {\n                        this.bdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        this.frcBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                        if (this.parent.frozenRows) {\n                            this.mhBdrElement.style.borderWidth = this.top_right_left;\n                        }\n                    }\n                    if (str.includes('3')) {\n                        this.mhBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                        this.bdrElement.style.borderWidth = this.right_bottom_left;\n                    }\n                    if (str.includes('4')) {\n                        this.fhBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        this.frhBdrElement.style.borderWidth = rtl ? this.top_bottom_left : this.top_right_bottom;\n                        this.mcBdrElement.style.borderWidth = this.right_bottom_left;\n                    }\n                    if (str.includes('5')) {\n                        this.mcBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        if (this.parent.frozenRows) {\n                            this.frhBdrElement.style.borderWidth = this.top_right_left;\n                        }\n                    }\n                    if (str.includes('6')) {\n                        this.mhBdrElement.style.borderWidth = rtl ? this.top_right_bottom : this.top_bottom_left;\n                        this.frcBdrElement.style.borderWidth = this.right_bottom_left;\n                    }\n                }\n                break;\n            default:\n                this.bdrElement.style.borderWidth = this.all_border;\n                this.mcBdrElement.style.borderWidth = this.all_border;\n                this.frcBdrElement.style.borderWidth = this.all_border;\n                if (this.parent.frozenRows) {\n                    this.fhBdrElement.style.borderWidth = this.all_border;\n                    this.mhBdrElement.style.borderWidth = this.all_border;\n                    this.frhBdrElement.style.borderWidth = this.all_border;\n                }\n                break;\n        }\n    };\n    Selection.prototype.applyBorders = function (str) {\n        var rtl = this.parent.enableRtl;\n        if (this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight) {\n            this.applyBothFrozenBorders(str);\n        }\n        else {\n            switch (str.length) {\n                case 4:\n                    {\n                        if (this.parent.getFrozenMode() === 'Right') {\n                            this.bdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                            this.mcBdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                            this.fhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                            this.mhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                        }\n                        else {\n                            this.bdrElement.style.borderWidth = rtl ? this.right_bottom : this.bottom_left;\n                            this.mcBdrElement.style.borderWidth = rtl ? this.bottom_left : this.right_bottom;\n                            this.fhBdrElement.style.borderWidth = rtl ? this.top_right : this.top_left;\n                            this.mhBdrElement.style.borderWidth = rtl ? this.top_left : this.top_right;\n                        }\n                    }\n                    break;\n                case 2:\n                    {\n                        if (this.parent.getFrozenMode() === 'Right') {\n                            this.bdrElement.style.borderWidth = str.includes('2') ? rtl ? this.top_bottom_left\n                                : this.top_right_bottom : this.right_bottom_left;\n                            this.mcBdrElement.style.borderWidth = str.includes('1') ? rtl ? this.top_right_bottom\n                                : this.top_bottom_left : this.right_bottom_left;\n                            if (this.parent.frozenRows) {\n                                this.fhBdrElement.style.borderWidth = str.includes('1') ? this.top_right_left\n                                    : rtl ? this.top_bottom_left : this.top_right_bottom;\n                                this.mhBdrElement.style.borderWidth = str.includes('2') ? this.top_right_left\n                                    : rtl ? this.top_right_bottom : this.top_bottom_left;\n                            }\n                        }\n                        else {\n                            this.bdrElement.style.borderWidth = str.includes('2') ? rtl ? this.top_right_bottom\n                                : this.top_bottom_left : this.right_bottom_left;\n                            if (this.parent.isFrozenGrid()) {\n                                this.mcBdrElement.style.borderWidth = str.includes('1') ? rtl ? this.top_bottom_left\n                                    : this.top_right_bottom : this.right_bottom_left;\n                            }\n                            if (this.parent.frozenRows) {\n                                this.fhBdrElement.style.borderWidth = str.includes('1') ? this.top_right_left\n                                    : rtl ? this.top_right_bottom : this.top_bottom_left;\n                                if (this.parent.isFrozenGrid()) {\n                                    this.mhBdrElement.style.borderWidth = str.includes('2') ? this.top_right_left\n                                        : rtl ? this.top_bottom_left : this.top_right_bottom;\n                                }\n                            }\n                        }\n                    }\n                    break;\n                default:\n                    this.bdrElement.style.borderWidth = this.all_border;\n                    if (this.parent.isFrozenGrid()) {\n                        this.mcBdrElement.style.borderWidth = this.all_border;\n                    }\n                    if (this.parent.frozenRows) {\n                        this.fhBdrElement.style.borderWidth = this.all_border;\n                        if (this.parent.isFrozenGrid()) {\n                            this.mhBdrElement.style.borderWidth = this.all_border;\n                        }\n                    }\n                    break;\n            }\n        }\n    };\n    Selection.prototype.createBorders = function () {\n        if (!this.bdrElement) {\n            var selectionBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                className: 'e-xlsel', id: this.parent.element.id + '_bdr'\n            });\n            selectionBorder.style.cssText = 'width: 2px; border-width: 0;';\n            this.bdrElement = this.parent.getContentTable().parentElement.appendChild(selectionBorder);\n            if (this.parent.isFrozenGrid()) {\n                var middleContentBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                    className: 'e-xlsel', id: this.parent.element.id + '_mcbdr'\n                });\n                middleContentBorder.style.cssText = 'height: 2px; border-width: 0;';\n                this.mcBdrElement = this.parent.getContentTable().parentElement.appendChild(middleContentBorder);\n                if (this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight) {\n                    var frozenRightContentBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                        className: 'e-xlsel', id: this.parent.element.id + '_frcbdr'\n                    });\n                    frozenRightContentBorder.style.cssText = 'height: 2px; border-width: 0;';\n                    this.frcBdrElement = this.parent.getContentTable().parentElement.appendChild(frozenRightContentBorder);\n                }\n            }\n            if (this.parent.frozenRows) {\n                var frozenHeaderBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                    className: 'e-xlsel', id: this.parent.element.id + '_fhbdr'\n                });\n                frozenHeaderBorder.style.height = '2px';\n                this.fhBdrElement = this.parent.getHeaderTable().parentElement.appendChild(frozenHeaderBorder);\n            }\n            if (this.parent.frozenRows && this.parent.isFrozenGrid()) {\n                var middleHeaderBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                    className: 'e-xlsel', id: this.parent.element.id + '_mhbdr'\n                });\n                middleHeaderBorder.style.height = '2px';\n                this.mhBdrElement = this.parent.getHeaderTable().parentElement.appendChild(middleHeaderBorder);\n                if (this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight) {\n                    var frozenRightHeaderBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                        className: 'e-xlsel', id: this.parent.element.id + '_frhbdr'\n                    });\n                    frozenRightHeaderBorder.style.height = '2px';\n                    this.frhBdrElement = this.parent.getHeaderTable().parentElement.appendChild(frozenRightHeaderBorder);\n                }\n            }\n        }\n    };\n    Selection.prototype.showHideBorders = function (display, freeze) {\n        if (this.bdrElement) {\n            this.bdrElement.style.display = display;\n            if (this.parent.isFrozenGrid()) {\n                var parentEle = this.parent.getContentTable();\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(parentEle.querySelectorAll('.e-xlsel-top-border'), 'e-xlsel-top-border');\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(parentEle.querySelectorAll('.e-xlsel-left-border'), 'e-xlsel-left-border');\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(parentEle.querySelectorAll('.e-xlsel-right-border'), 'e-xlsel-right-border');\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(parentEle.querySelectorAll('.e-xlsel-bottom-border'), 'e-xlsel-bottom-border');\n                if (!freeze) {\n                    this.mcBdrElement.style.display = display;\n                }\n                if (this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight) {\n                    this.frcBdrElement.style.display = display;\n                }\n            }\n            if (this.parent.frozenRows) {\n                var parentEle = this.parent.getHeaderTable();\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(parentEle.querySelectorAll('.e-xlsel-top-border'), 'e-xlsel-top-border');\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(parentEle.querySelectorAll('.e-xlsel-left-border'), 'e-xlsel-left-border');\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(parentEle.querySelectorAll('.e-xlsel-right-border'), 'e-xlsel-right-border');\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(parentEle.querySelectorAll('.e-xlsel-bottom-border'), 'e-xlsel-bottom-border');\n                this.fhBdrElement.style.display = display;\n            }\n            if (this.parent.frozenRows && this.parent.isFrozenGrid()) {\n                if (!freeze) {\n                    this.mhBdrElement.style.display = display;\n                }\n                if (this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight) {\n                    this.frhBdrElement.style.display = display;\n                }\n            }\n        }\n    };\n    Selection.prototype.drawAFBorders = function () {\n        if (!this.bdrAFBottom) {\n            this.createAFBorders();\n        }\n        this.positionAFBorders();\n    };\n    Selection.prototype.positionAFBorders = function () {\n        if (!this.startCell || !this.bdrAFLeft) {\n            return;\n        }\n        var stOff = this.startAFCell.getBoundingClientRect();\n        var endOff = this.endAFCell.getBoundingClientRect();\n        var top = endOff.top - stOff.top > 0 ? 1 : 0;\n        var firstCellTop = endOff.top - stOff.top >= 0 && ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.startAFCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.movableContent) ||\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.startAFCell, 'e-frozencontent')) && this.isFirstRow(this.startAFCell) ? 1.5 : 0;\n        var firstCellLeft = ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.startAFCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.movableContent) ||\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.startAFCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.movableHeader)) && this.isFirstCell(this.startAFCell) ? 1 : 0;\n        var rowHeight = this.isLastRow(this.endAFCell) && ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.endAFCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.movableContent) ||\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.endAFCell, 'e-frozencontent')) ? 2 : 0;\n        var parentOff = this.startAFCell.offsetParent.getBoundingClientRect();\n        var parentRect = this.parent.element.getBoundingClientRect();\n        var sTop = this.startAFCell.offsetParent.parentElement.scrollTop;\n        var sLeft = this.startAFCell.offsetParent.parentElement.scrollLeft;\n        var scrollTop = sTop - this.startAFCell.offsetTop;\n        var scrollLeft = sLeft - this.startAFCell.offsetLeft;\n        var totalHeight = this.parent.element.clientHeight - (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getScrollBarWidth)();\n        if (this.parent.allowPaging) {\n            totalHeight -= this.parent.element.querySelector('.e-pager').offsetHeight;\n        }\n        if (this.parent.aggregates.length) {\n            totalHeight -= this.parent.getFooterContent().offsetHeight;\n        }\n        var totalWidth = this.parent.element.clientWidth - (this.parent.height !== 'auto' ? (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getScrollBarWidth)() : 0);\n        scrollTop = scrollTop > 0 ? Math.floor(scrollTop) - 1 : 0;\n        scrollLeft = scrollLeft > 0 ? scrollLeft : 0;\n        var left = stOff.left - parentRect.left;\n        if (!this.parent.enableRtl) {\n            this.bdrAFLeft.style.left = left - firstCellLeft + scrollLeft - 1 + 'px';\n            this.bdrAFRight.style.left = endOff.left - parentRect.left - 2 + endOff.width + 'px';\n            this.bdrAFRight.style.width = totalWidth <= parseInt(this.bdrAFRight.style.left, 10) ? '0px' : '2px';\n            this.bdrAFTop.style.left = left + scrollLeft - 0.5 + 'px';\n            this.bdrAFTop.style.width = parseInt(this.bdrAFRight.style.left, 10) - parseInt(this.bdrAFLeft.style.left, 10)\n                - firstCellLeft + 1 + 'px';\n            if (totalWidth <= (parseInt(this.bdrAFTop.style.width, 10) + parseInt(this.bdrAFTop.style.left, 10))) {\n                var leftRemove = (parseInt(this.bdrAFTop.style.width, 10) + parseInt(this.bdrAFTop.style.left, 10)) - totalWidth;\n                this.bdrAFTop.style.width = parseInt(this.bdrAFTop.style.width, 10) - leftRemove + 'px';\n            }\n        }\n        else {\n            var scrolloffSet = ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.startAFCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.movableContent) ||\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.startAFCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.movableHeader)) ? stOff.right -\n                this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width -\n                parentRect.left : 0;\n            this.bdrAFLeft.style.right = parentRect.right - endOff.right - 2 + endOff.width + 'px';\n            this.bdrAFLeft.style.width = totalWidth <= parseInt(this.bdrAFLeft.style.right, 10) ? '0px' : '2px';\n            var borderAFRightValue = parentRect.right - stOff.right - firstCellLeft + scrolloffSet - 1;\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            borderAFRightValue > 0 ? this.bdrAFRight.style.right = borderAFRightValue + 'px' : this.bdrAFRight.style.right = '0px';\n            this.bdrAFTop.style.left = endOff.left - parentRect.left - 0.5 + 'px';\n            this.bdrAFTop.style.width = parseInt(this.bdrAFLeft.style.right, 10) - parseInt(this.bdrAFRight.style.right, 10)\n                - firstCellLeft + 1 + 'px';\n            if (parseInt(this.bdrAFTop.style.left, 10) < 0) {\n                this.bdrAFTop.style.width = parseInt(this.bdrAFTop.style.width, 10) + parseInt(this.bdrAFTop.style.left, 10) + 'px';\n                if (this.parent.height !== 'auto' && (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getScrollBarWidth)()) {\n                    this.bdrAFTop.style.left = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getScrollBarWidth)() + 'px';\n                    this.bdrAFTop.style.width = (parseInt(this.bdrAFTop.style.width, 10) - (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getScrollBarWidth)()) + 'px';\n                }\n                else {\n                    this.bdrAFTop.style.left = '0px';\n                }\n            }\n        }\n        this.bdrAFLeft.style.top = stOff.top - parentRect.top - firstCellTop + scrollTop + 'px';\n        this.bdrAFLeft.style.height = endOff.top - stOff.top > 0 ?\n            (endOff.top - parentOff.top + endOff.height + 1) - (stOff.top - parentOff.top) + firstCellTop - rowHeight - scrollTop + 'px' :\n            endOff.height + firstCellTop - rowHeight - scrollTop + 'px';\n        this.bdrAFRight.style.top = this.bdrAFLeft.style.top;\n        this.bdrAFRight.style.height = parseInt(this.bdrAFLeft.style.height, 10) + 'px';\n        this.bdrAFTop.style.top = this.bdrAFRight.style.top;\n        this.bdrAFBottom.style.left = this.bdrAFTop.style.left;\n        this.bdrAFBottom.style.top = parseFloat(this.bdrAFLeft.style.top) + parseFloat(this.bdrAFLeft.style.height) - top - 1 + 'px';\n        this.bdrAFBottom.style.width = totalHeight <= parseFloat(this.bdrAFBottom.style.top) ? '0px' : this.bdrAFTop.style.width;\n        if (totalHeight <= (parseInt(this.bdrAFLeft.style.height, 10) + parseInt(this.bdrAFLeft.style.top, 10))) {\n            var topRemove = parseInt(this.bdrAFLeft.style.height, 10) + parseInt(this.bdrAFLeft.style.top, 10) - totalHeight;\n            this.bdrAFLeft.style.height = parseInt(this.bdrAFLeft.style.height, 10) - topRemove + 'px';\n            this.bdrAFRight.style.height = parseInt(this.bdrAFLeft.style.height, 10) + 'px';\n        }\n    };\n    Selection.prototype.createAFBorders = function () {\n        if (!this.bdrAFLeft) {\n            var leftSelectionBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                className: 'e-xlselaf', id: this.parent.element.id + '_bdrafleft'\n            });\n            leftSelectionBorder.style.width = '2px';\n            this.bdrAFLeft = this.parent.element.appendChild(leftSelectionBorder);\n            var rightSelectionBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                className: 'e-xlselaf', id: this.parent.element.id + '_bdrafright'\n            });\n            rightSelectionBorder.style.width = '2px';\n            this.bdrAFRight = this.parent.element.appendChild(rightSelectionBorder);\n            var bottomSelectionBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                className: 'e-xlselaf', id: this.parent.element.id + '_bdrafbottom'\n            });\n            bottomSelectionBorder.style.height = '2px';\n            this.bdrAFBottom = this.parent.element.appendChild(bottomSelectionBorder);\n            var topSelectionBorder = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n                className: 'e-xlselaf', id: this.parent.element.id + '_bdraftop'\n            });\n            topSelectionBorder.style.height = '2px';\n            this.bdrAFTop = this.parent.element.appendChild(topSelectionBorder);\n        }\n    };\n    Selection.prototype.destroyAutoFillElements = function () {\n        if (this.bdrAFLeft) {\n            this.bdrAFLeft.remove();\n            this.bdrAFRight.remove();\n            this.bdrAFBottom.remove();\n            this.bdrAFTop.remove();\n            this.bdrAFLeft = this.bdrAFRight = this.bdrAFBottom = this.bdrAFTop = null;\n        }\n        if (this.autofill) {\n            this.autofill.remove();\n            this.autofill = null;\n        }\n    };\n    Selection.prototype.showAFBorders = function () {\n        if (this.bdrAFLeft) {\n            this.bdrAFLeft.style.display = '';\n            this.bdrAFRight.style.display = '';\n            this.bdrAFBottom.style.display = '';\n            this.bdrAFTop.style.display = '';\n        }\n    };\n    Selection.prototype.hideAFBorders = function () {\n        if (this.bdrAFLeft) {\n            this.bdrAFLeft.style.display = 'none';\n            this.bdrAFRight.style.display = 'none';\n            this.bdrAFBottom.style.display = 'none';\n            this.bdrAFTop.style.display = 'none';\n        }\n    };\n    Selection.prototype.updateValue = function (rIdx, cIdx, cell) {\n        var args = this.createBeforeAutoFill(rIdx, cIdx, cell);\n        if (!args.cancel) {\n            var col = this.parent.getColumnByIndex(cIdx);\n            if (this.parent.editModule && cell) {\n                if (col.type === 'number') {\n                    this.parent.editModule.updateCell(rIdx, col.field, parseFloat(args.value));\n                }\n                else {\n                    this.parent.editModule.updateCell(rIdx, col.field, args.value);\n                }\n            }\n        }\n    };\n    Selection.prototype.createBeforeAutoFill = function (rowIndex, colIndex, cell) {\n        var col = this.parent.getColumnByIndex(colIndex);\n        var args = {\n            column: col,\n            value: cell.innerText\n        };\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.beforeAutoFill, args);\n        return args;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Selection.prototype.getAutoFillCells = function (rowIndex, startCellIdx) {\n        var cls = '.e-cellselectionbackground';\n        var cells = [].slice.call(this.parent.getDataRows()[parseInt(rowIndex.toString(), 10)].querySelectorAll(cls));\n        return cells;\n    };\n    Selection.prototype.selectLikeAutoFill = function (e, isApply) {\n        var startrowIdx = parseInt((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.startAFCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.row).getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n        var startCellIdx = parseInt(this.startAFCell.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n        var endrowIdx = parseInt((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.endAFCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.row).getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n        var endCellIdx = parseInt(this.endAFCell.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n        var rowLen = this.selectedRowCellIndexes.length - 1;\n        var colLen = this.selectedRowCellIndexes[0].cellIndexes.length - 1;\n        switch (true) { //direction\n            case !isApply && this.endAFCell.classList.contains('e-cellselectionbackground') &&\n                !!(0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell):\n                this.startAFCell = this.parent.getCellFromIndex(startrowIdx, startCellIdx);\n                this.endAFCell = this.parent.getCellFromIndex(startrowIdx + rowLen, startCellIdx + colLen);\n                this.drawAFBorders();\n                break;\n            case this.autoFillRLselection && startCellIdx + colLen < endCellIdx && //right\n                endCellIdx - startCellIdx - colLen + 1 > endrowIdx - startrowIdx - rowLen // right bottom\n                && endCellIdx - startCellIdx - colLen + 1 > startrowIdx - endrowIdx: //right top\n                this.endAFCell = this.parent.getCellFromIndex(startrowIdx + rowLen, endCellIdx);\n                endrowIdx = parseInt((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.endAFCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.row).getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n                endCellIdx = parseInt(this.endAFCell.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n                if (!isApply) {\n                    this.drawAFBorders();\n                }\n                else {\n                    var cellIdx = parseInt(this.endCell.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n                    for (var i = startrowIdx; i <= endrowIdx; i++) {\n                        var cells = this.getAutoFillCells(i, startCellIdx);\n                        var c = 0;\n                        for (var j = cellIdx + 1; j <= endCellIdx; j++) {\n                            if (c > colLen) {\n                                c = 0;\n                            }\n                            this.updateValue(i, j, cells[parseInt(c.toString(), 10)]);\n                            c++;\n                        }\n                    }\n                    this.selectCellsByRange({ rowIndex: startrowIdx, cellIndex: this.startCellIndex }, { rowIndex: endrowIdx, cellIndex: endCellIdx });\n                }\n                break;\n            case this.autoFillRLselection && startCellIdx > endCellIdx && // left\n                startCellIdx - endCellIdx + 1 > endrowIdx - startrowIdx - rowLen && //left top\n                startCellIdx - endCellIdx + 1 > startrowIdx - endrowIdx: // left bottom\n                this.startAFCell = this.parent.getCellFromIndex(startrowIdx, endCellIdx);\n                this.endAFCell = this.endCell;\n                if (!isApply) {\n                    this.drawAFBorders();\n                }\n                else {\n                    for (var i = startrowIdx; i <= startrowIdx + rowLen; i++) {\n                        var cells = this.getAutoFillCells(i, startCellIdx);\n                        cells.reverse();\n                        var c = 0;\n                        for (var j = this.startCellIndex - 1; j >= endCellIdx; j--) {\n                            if (c > colLen) {\n                                c = 0;\n                            }\n                            this.updateValue(i, j, cells[parseInt(c.toString(), 10)]);\n                            c++;\n                        }\n                    }\n                    this.selectCellsByRange({ rowIndex: startrowIdx, cellIndex: endCellIdx }, { rowIndex: startrowIdx + rowLen, cellIndex: this.startCellIndex + colLen });\n                }\n                break;\n            case startrowIdx > endrowIdx: //up\n                this.startAFCell = this.parent.getCellFromIndex(endrowIdx, startCellIdx);\n                this.endAFCell = this.endCell;\n                if (!isApply) {\n                    this.drawAFBorders();\n                }\n                else {\n                    var trIdx = parseInt(this.endCell.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n                    var r = trIdx;\n                    for (var i = startrowIdx - 1; i >= endrowIdx; i--) {\n                        if (r === this.startIndex - 1) {\n                            r = trIdx;\n                        }\n                        var cells = this.getAutoFillCells(r, startCellIdx);\n                        var c = 0;\n                        r--;\n                        for (var j = this.startCellIndex; j <= this.startCellIndex + colLen; j++) {\n                            this.updateValue(i, j, cells[parseInt(c.toString(), 10)]);\n                            c++;\n                        }\n                    }\n                    this.selectCellsByRange({ rowIndex: endrowIdx, cellIndex: startCellIdx + colLen }, { rowIndex: startrowIdx + rowLen, cellIndex: startCellIdx });\n                }\n                break;\n            default: //down\n                this.endAFCell = this.parent.getCellFromIndex(endrowIdx, startCellIdx + colLen);\n                if (!isApply) {\n                    this.drawAFBorders();\n                }\n                else {\n                    var trIdx = parseInt(this.endCell.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n                    var r = this.startIndex;\n                    for (var i = trIdx + 1; i <= endrowIdx; i++) {\n                        if (r === trIdx + 1) {\n                            r = this.startIndex;\n                        }\n                        var cells = this.getAutoFillCells(r, startCellIdx);\n                        r++;\n                        var c = 0;\n                        for (var m = this.startCellIndex; m <= this.startCellIndex + colLen; m++) {\n                            this.updateValue(i, m, cells[parseInt(c.toString(), 10)]);\n                            c++;\n                        }\n                    }\n                    this.selectCellsByRange({ rowIndex: trIdx - rowLen, cellIndex: startCellIdx }, { rowIndex: endrowIdx, cellIndex: startCellIdx + colLen });\n                }\n                break;\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        this.stopTimer();\n        document.body.classList.remove('e-disableuserselect');\n        if (this.element && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.element.parentElement)) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.element);\n        }\n        if (this.isDragged && this.selectedRowCellIndexes.length === 1 && this.selectedRowCellIndexes[0].cellIndexes.length === 1) {\n            this.mUPTarget = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell);\n        }\n        else {\n            this.mUPTarget = null;\n        }\n        var closeRowCell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-rowcell');\n        if (this.isDragged && !this.isAutoFillSel && this.selectionSettings.mode === 'Cell' &&\n            closeRowCell && closeRowCell.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell)) {\n            var rowIndex = parseInt(closeRowCell.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n            var cellIndex = parseInt(closeRowCell.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n            this.isDragged = false;\n            this.clearCellSelection();\n            this.selectCellsByRange({ rowIndex: this.startDIndex, cellIndex: this.startDCellIndex }, { rowIndex: rowIndex, cellIndex: cellIndex });\n        }\n        this.isDragged = false;\n        this.updateAutoFillPosition();\n        if (this.isAutoFillSel) {\n            this.preventFocus = true;\n            var lastCell = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell);\n            this.endAFCell = lastCell ? lastCell : this.endCell === this.endAFCell ? this.startAFCell : this.endAFCell;\n            this.startAFCell = this.startCell;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.endAFCell) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.startAFCell)) {\n                this.updateStartCellsIndex();\n                this.selectLikeAutoFill(e, true);\n                this.updateAutoFillPosition();\n                this.hideAFBorders();\n                this.positionBorders();\n                if (this.parent.isFrozenGrid()) {\n                    this.showHideBorders('none', true);\n                    this.refreshFrozenBorders();\n                }\n                if (this.parent.aggregates.length > 0) {\n                    this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.refreshFooterRenderer, {});\n                }\n            }\n            this.isAutoFillSel = false;\n            this.preventFocus = false;\n        }\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.getContent(), 'mousemove', this.mouseMoveHandler);\n        if (this.parent.frozenRows) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.getHeaderContent(), 'mousemove', this.mouseMoveHandler);\n        }\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n    };\n    Selection.prototype.hideAutoFill = function () {\n        if (this.autofill) {\n            this.autofill.style.display = 'none';\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.updateAutoFillPosition = function () {\n        if (this.parent.enableAutoFill && !this.parent.isEdit &&\n            this.selectionSettings.cellSelectionMode.indexOf('Box') > -1 && !this.isRowType() && !this.isSingleSel()\n            && this.selectedRowCellIndexes.length) {\n            var index = parseInt(this.target.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n            var rindex = parseInt(this.target.getAttribute('index'), 10);\n            var rowIndex = this.selectedRowCellIndexes[this.selectedRowCellIndexes.length - 1].rowIndex;\n            var cells = this.getAutoFillCells(rowIndex, index).filter(function (ele) { return ele.style.display === ''; });\n            var col = this.parent.getColumnByIndex(index);\n            var isFrozenCol = col.getFreezeTableName() === 'movable';\n            var isFrozenRow = rindex < this.parent.frozenRows;\n            var isFrozenRight = this.parent.getFrozenMode() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.leftRight\n                && col.getFreezeTableName() === _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.frozenRight;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.select)('#' + this.parent.element.id + '_autofill', (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.table))) {\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.select)('#' + this.parent.element.id + '_autofill', this.parent.element)) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.select)('#' + this.parent.element.id + '_autofill', this.parent.element).remove();\n                }\n                this.autofill = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', { className: 'e-autofill', id: this.parent.element.id + '_autofill' });\n                this.autofill.style.display = 'none';\n                if (this.target.classList.contains('e-leftfreeze') || this.target.classList.contains('e-rightfreeze') ||\n                    this.target.classList.contains('e-fixedfreeze')) {\n                    this.autofill.classList.add('e-freeze-autofill');\n                }\n                if (!isFrozenRow) {\n                    if (!isFrozenCol) {\n                        this.parent.getContentTable().parentElement.appendChild(this.autofill);\n                    }\n                    else {\n                        this.parent.getContentTable().parentElement.appendChild(this.autofill);\n                    }\n                }\n                else {\n                    if (!isFrozenCol) {\n                        this.parent.getHeaderTable().parentElement.appendChild(this.autofill);\n                    }\n                    else {\n                        this.parent.getHeaderTable().parentElement.appendChild(this.autofill);\n                    }\n                }\n                if (isFrozenRight) {\n                    if (isFrozenRow) {\n                        this.parent.getHeaderTable().parentElement.appendChild(this.autofill);\n                    }\n                    else {\n                        this.parent.getContentTable().parentElement.appendChild(this.autofill);\n                    }\n                }\n            }\n            var cell = cells[cells.length - 1];\n            if (cell && cell.offsetParent) {\n                var clientRect = cell.getBoundingClientRect();\n                var parentOff = cell.offsetParent.getBoundingClientRect();\n                if (cell.offsetParent.classList.contains('e-content') || cell.offsetParent.classList.contains('e-headercontent')) {\n                    parentOff = cell.offsetParent.querySelector('table').getBoundingClientRect();\n                }\n                var colWidth = this.isLastCell(cell) ? 4 : 0;\n                var rowHeight = this.isLastRow(cell) ? 3 : 0;\n                if (!this.parent.enableRtl) {\n                    this.autofill.style.left = clientRect.left - parentOff.left + clientRect.width - 4 - colWidth + 'px';\n                }\n                else {\n                    this.autofill.style.right = parentOff.right - clientRect.right + clientRect.width - 4 - colWidth + 'px';\n                }\n                this.autofill.style.top = clientRect.top - parentOff.top + clientRect.height - 5 - rowHeight + 'px';\n            }\n            this.autofill.style.display = '';\n        }\n        else {\n            this.hideAutoFill();\n        }\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        this.mouseButton = e.button;\n        var target = e.target;\n        var gObj = this.parent;\n        var isDrag;\n        var gridElement = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-grid');\n        if (gridElement && gridElement.id !== gObj.element.id || (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.headerContent) && !this.parent.frozenRows ||\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-editedbatchcell') || (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.editedRow)) {\n            return;\n        }\n        if (e.shiftKey || e.ctrlKey) {\n            e.preventDefault();\n        }\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell) && !e.shiftKey && !e.ctrlKey) {\n            if (gObj.selectionSettings.cellSelectionMode.indexOf('Box') > -1 && !this.isRowType() && !this.isSingleSel()) {\n                this.isCellDrag = true;\n                isDrag = true;\n            }\n            else if (gObj.allowRowDragAndDrop && !gObj.isEdit && !this.parent.selectionSettings.checkboxOnly) {\n                this.isRowDragSelected = false;\n                if (!this.isRowType() || this.isSingleSel() || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, 'td').classList.contains('e-selectionbackground')) {\n                    this.isDragged = false;\n                    return;\n                }\n                isDrag = true;\n                this.element = this.parent.createElement('div', { className: 'e-griddragarea' });\n                gObj.getContent().appendChild(this.element);\n            }\n            if (isDrag) {\n                this.enableDrag(e, true);\n            }\n        }\n        this.updateStartEndCells();\n        if (target.classList.contains('e-autofill') || target.classList.contains('e-xlsel')) {\n            this.isCellDrag = true;\n            this.isAutoFillSel = true;\n            this.enableDrag(e);\n        }\n    };\n    Selection.prototype.updateStartEndCells = function () {\n        var cells = [].slice.call(this.parent.element.getElementsByClassName('e-cellselectionbackground'));\n        this.startCell = cells[0];\n        this.endCell = cells[cells.length - 1];\n        if (this.startCell) {\n            this.startIndex = parseInt(this.startCell.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n            this.startCellIndex = parseInt((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.startCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell).getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n        }\n    };\n    Selection.prototype.updateStartCellsIndex = function () {\n        if (this.startCell) {\n            this.startIndex = parseInt(this.startCell.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n            this.startCellIndex = parseInt((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(this.startCell, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell).getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n        }\n    };\n    Selection.prototype.enableDrag = function (e, isUpdate) {\n        var gObj = this.parent;\n        if (isUpdate) {\n            var tr = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, 'tr');\n            this.startDIndex = parseInt(tr.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n            this.startDCellIndex = parseInt((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell)\n                .getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n        }\n        document.body.classList.add('e-disableuserselect');\n        var gBRect = gObj.element.getBoundingClientRect();\n        var postion = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.getPosition)(e);\n        this.x = postion.x - gBRect.left;\n        this.y = postion.y - gBRect.top;\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(gObj.getContent(), 'mousemove', this.mouseMoveHandler, this);\n        if (this.parent.frozenRows) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(gObj.getHeaderContent(), 'mousemove', this.mouseMoveHandler, this);\n        }\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    };\n    Selection.prototype.clearSelAfterRefresh = function (e) {\n        var isInfiniteScroll = this.parent.enableInfiniteScrolling && e.requestType === 'infiniteScroll';\n        if (e.requestType !== 'virtualscroll' && !this.parent.isPersistSelection && !isInfiniteScroll) {\n            this.clearSelection();\n        }\n        if ((e.requestType === 'virtualscroll' || isInfiniteScroll) && this.parent.isPersistSelection && this.isPartialSelection\n            && this.isHdrSelectAllClicked) {\n            var rowObj = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; });\n            var indexes = [];\n            this.selectedRowState = {};\n            this.persistSelectedData = [];\n            for (var i = 0; i < rowObj.length; i++) {\n                indexes.push(rowObj[parseInt(i.toString(), 10)].index);\n                var pkValue = this.getPkValue(this.primaryKey, rowObj[parseInt(i.toString(), 10)].data);\n                this.selectedRowState[\"\" + pkValue] = true;\n                this.persistSelectedData.push(rowObj[parseInt(i.toString(), 10)].data);\n            }\n            this.selectedRowIndexes = indexes;\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.evtHandlers = [{ event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.uiUpdate, handler: this.enableAfterRender },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.initialEnd, handler: this.initializeSelection },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.rowSelectionComplete, handler: this.onActionComplete },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.cellSelectionComplete, handler: this.onActionComplete },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.inBoundModelChanged, handler: this.onPropertyChanged },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.cellFocused, handler: this.onCellFocused },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.beforeFragAppend, handler: this.clearSelAfterRefresh },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.columnPositionChanged, handler: this.columnPositionChanged },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.contentReady, handler: this.initialEnd },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.rowsRemoved, handler: this.rowsRemoved },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.headerRefreshed, handler: this.refreshHeader },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.destroyAutoFillElements, handler: this.destroyAutoFillElements },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_3__.destroy, handler: this.destroy }];\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveEventListener)(this.parent, this.evtHandlers, true, this);\n        this.actionBeginFunction = this.actionBegin.bind(this);\n        this.actionCompleteFunction = this.actionComplete.bind(this);\n        this.parent.addEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionBegin, this.actionBeginFunction);\n        this.parent.addEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionComplete, this.actionCompleteFunction);\n        this.addEventListener_checkbox();\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.getContent(), 'mousedown', this.mouseDownHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.getHeaderContent(), 'mousedown', this.mouseDownHandler);\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveEventListener)(this.parent, this.evtHandlers, false);\n        this.parent.removeEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionBegin, this.actionBeginFunction);\n        this.parent.removeEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionComplete, this.actionCompleteFunction);\n        this.removeEventListener_checkbox();\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.destroyAutoFillElements, this.destroyAutoFillElements);\n    };\n    Selection.prototype.wireEvents = function () {\n        this.isMacOS = navigator.userAgent.indexOf('Mac OS') !== -1;\n        if (this.isMacOS) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'keydown', this.keyDownHandler, this);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'keyup', this.keyUpHandler, this);\n        }\n        else {\n            if (!this.parent.allowKeyboard) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'keydown', this.keyDownHandler, this);\n            }\n        }\n    };\n    Selection.prototype.unWireEvents = function () {\n        if (this.isMacOS) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'keydown', this.keyDownHandler);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'keyup', this.keyUpHandler);\n        }\n        else {\n            if (!this.parent.allowKeyboard) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'keydown', this.keyDownHandler);\n            }\n        }\n    };\n    Selection.prototype.columnPositionChanged = function () {\n        if (!this.parent.isPersistSelection) {\n            this.clearSelection();\n        }\n    };\n    Selection.prototype.refreshHeader = function () {\n        var checkboxColumn = this.parent.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (checkboxColumn.length && !this.parent.getDataModule().isRemote()) {\n            this.gridCurrentRecord = this.getData();\n        }\n        this.setCheckAllState();\n    };\n    Selection.prototype.rowsRemoved = function (e) {\n        for (var i = 0; i < e.records.length; i++) {\n            var pkValue = this.getPkValue(this.primaryKey, e.records[parseInt(i.toString(), 10)]);\n            delete (this.selectedRowState[\"\" + pkValue]);\n            --this.totalRecordsCount;\n        }\n        this.setCheckAllState();\n    };\n    Selection.prototype.beforeFragAppend = function (e) {\n        if (e.requestType !== 'virtualscroll' && !this.parent.isPersistSelection) {\n            this.clearSelection();\n        }\n    };\n    Selection.prototype.getCheckAllBox = function () {\n        return this.parent.getHeaderContent().querySelector('.e-checkselectall');\n    };\n    Selection.prototype.enableAfterRender = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.render();\n            this.initPerisistSelection();\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Selection.prototype.render = function (e) {\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.getContent(), 'mousedown', this.mouseDownHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.getHeaderContent(), 'mousedown', this.mouseDownHandler, this);\n    };\n    Selection.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        var gObj = this.parent;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.properties.type)) {\n            if (this.selectionSettings.type === 'Single') {\n                gObj.element.removeAttribute('aria-multiselectable');\n                if (this.selectedRowCellIndexes.length > 1) {\n                    this.clearCellSelection();\n                    this.prevCIdxs = undefined;\n                }\n                if (this.selectedRowIndexes.length > 1) {\n                    this.clearRowSelection();\n                    this.prevRowIndex = undefined;\n                }\n                if (this.selectedColumnsIndexes.length > 1) {\n                    this.clearColumnSelection();\n                    this.prevColIndex = undefined;\n                }\n                this.enableSelectMultiTouch = false;\n                this.hidePopUp();\n            }\n            else if (this.selectionSettings.type === 'Multiple') {\n                gObj.element.setAttribute('aria-multiselectable', 'true');\n            }\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.properties.mode) ||\n            !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.properties.cellSelectionMode)) {\n            this.clearSelection();\n            this.prevRowIndex = undefined;\n            this.prevCIdxs = undefined;\n            this.prevColIndex = undefined;\n        }\n        this.isPersisted = true;\n        this.checkBoxSelectionChanged();\n        this.isPersisted = false;\n        if (!this.parent.isCheckBoxSelection) {\n            this.initPerisistSelection();\n        }\n        var checkboxColumn = this.parent.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (checkboxColumn.length) {\n            gObj.isCheckBoxSelection = !(this.selectionSettings.checkboxMode === 'ResetOnRowClick');\n        }\n        this.drawBorders();\n    };\n    Selection.prototype.hidePopUp = function () {\n        if (this.parent.element.querySelector('.e-gridpopup').getElementsByClassName('e-rowselect').length) {\n            this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n        }\n    };\n    Selection.prototype.initialEnd = function () {\n        if (!this.selectedRowIndexes.length) {\n            this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.contentReady, this.initialEnd);\n            this.selectRow(this.parent.selectedRowIndex);\n        }\n    };\n    Selection.prototype.checkBoxSelectionChanged = function () {\n        var gobj = this.parent;\n        gobj.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.contentReady, this.checkBoxSelectionChanged);\n        var checkboxColumn = gobj.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (checkboxColumn.length > 0) {\n            gobj.isCheckBoxSelection = true;\n            this.chkField = checkboxColumn[0].field;\n            this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.totalRecordsCount)) {\n                this.totalRecordsCount = this.getCurrentBatchRecordChanges().length;\n            }\n            if (this.isSingleSel()) {\n                gobj.selectionSettings.type = 'Multiple';\n                gobj.dataBind();\n            }\n            else {\n                this.initPerisistSelection();\n            }\n        }\n        if (!gobj.isCheckBoxSelection && !this.isPersisted) {\n            this.chkField = null;\n            this.initPerisistSelection();\n        }\n    };\n    Selection.prototype.initPerisistSelection = function () {\n        var gobj = this.parent;\n        if (this.parent.selectionSettings.persistSelection && this.parent.getPrimaryKeyFieldNames().length > 0) {\n            gobj.isPersistSelection = true;\n            this.ensureCheckboxFieldSelection();\n        }\n        else if (this.parent.getPrimaryKeyFieldNames().length > 0) {\n            gobj.isPersistSelection = false;\n            this.ensureCheckboxFieldSelection();\n        }\n        else {\n            gobj.isPersistSelection = false;\n            this.selectedRowState = {};\n        }\n    };\n    Selection.prototype.ensureCheckboxFieldSelection = function () {\n        var gobj = this.parent;\n        this.primaryKey = this.parent.getPrimaryKeyFieldNames()[0];\n        if (!gobj.enableVirtualization && this.chkField\n            && ((gobj.isPersistSelection && Object.keys(this.selectedRowState).length === 0) ||\n                !gobj.isPersistSelection)) {\n            this.dataSuccess((!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result) ||\n                this.parent.getDataModule().isRemote() ? this.parent.getCurrentViewRecords() :\n                this.parent.renderModule.data.dataManager.dataSource.json);\n        }\n    };\n    Selection.prototype.dataSuccess = function (res) {\n        for (var i = 0; i < res.length; i++) {\n            var pkValue = this.getPkValue(this.primaryKey, res[parseInt(i.toString(), 10)]);\n            var checkedFieldData = res[parseInt(i.toString(), 10)][this.chkField];\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.selectedRowState[\"\" + pkValue]) && checkedFieldData && typeof checkedFieldData === 'boolean') {\n                this.selectedRowState[\"\" + pkValue] = checkedFieldData;\n                if (this.parent.isPersistSelection) {\n                    this.persistSelectedData.push(res[parseInt(i.toString(), 10)]);\n                }\n            }\n        }\n    };\n    Selection.prototype.setRowSelection = function (state) {\n        if (!(this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n            && this.parent.dataSource.result))) {\n            if (state) {\n                if (this.isPartialSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n                    var rowObj = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; });\n                    for (var _i = 0, rowObj_1 = rowObj; _i < rowObj_1.length; _i++) {\n                        var row = rowObj_1[_i];\n                        this.selectedRowState[this.getPkValue(this.primaryKey, row.data)] = true;\n                    }\n                }\n                else {\n                    var selectedData = this.isPartialSelection ? this.parent.partialSelectedRecords : this.getData();\n                    if (this.parent.groupSettings.columns.length) {\n                        for (var _a = 0, _b = this.isPartialSelection ? selectedData : selectedData.records; _a < _b.length; _a++) {\n                            var data = _b[_a];\n                            this.selectedRowState[this.getPkValue(this.primaryKey, data)] = true;\n                        }\n                    }\n                    else {\n                        for (var _c = 0, selectedData_1 = selectedData; _c < selectedData_1.length; _c++) {\n                            var data = selectedData_1[_c];\n                            this.selectedRowState[this.getPkValue(this.primaryKey, data)] = true;\n                        }\n                    }\n                }\n            }\n            else {\n                this.selectedRowState = {};\n            }\n            // (this.getData()).forEach(function (data) {\n            //     this.selectedRowState[data[this.primaryKey]] = true;\n            // })\n        }\n        else {\n            if (state) {\n                var selectedStateKeys = Object.keys(this.selectedRowState);\n                var unSelectedRowStateKeys = Object.keys(this.unSelectedRowState);\n                if (!this.isCheckboxReset) {\n                    var rowData = (this.parent.groupSettings.columns.length && this.parent.isPersistSelection) ?\n                        this.parent.currentViewData['records'] : this.parent.currentViewData;\n                    for (var _d = 0, rowData_1 = rowData; _d < rowData_1.length; _d++) {\n                        var data = rowData_1[_d];\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(data[this.primaryKey])) {\n                            var key = data[this.primaryKey].toString();\n                            if (selectedStateKeys.indexOf(key) === -1 && unSelectedRowStateKeys.indexOf(key) === -1) {\n                                this.selectedRowState[data[this.primaryKey]] = true;\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                this.selectedRowState = {};\n                this.unSelectedRowState = {};\n                this.rmtHdrChkbxClicked = false;\n            }\n        }\n    };\n    Selection.prototype.getData = function () {\n        return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(true));\n    };\n    Selection.prototype.getAvailableSelectedData = function (data) {\n        var filteredSearchedSelectedData = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_4__.DataManager(data).executeLocal(this.parent.getDataModule().generateQuery(true));\n        if (this.parent.groupSettings.columns.length && filteredSearchedSelectedData &&\n            filteredSearchedSelectedData.records) {\n            filteredSearchedSelectedData = filteredSearchedSelectedData.records.slice();\n        }\n        return filteredSearchedSelectedData;\n    };\n    Selection.prototype.refreshPersistSelection = function () {\n        var rows = this.parent.getRows();\n        this.totalRecordsCount = this.parent.getCurrentViewRecords().length;\n        if (this.parent.allowPaging) {\n            this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(rows) && rows.length > 0 && (this.parent.isPersistSelection || this.chkField)) {\n            var indexes = [];\n            for (var j = 0; j < rows.length; j++) {\n                var rowObj = this.getRowObj(rows[parseInt(j.toString(), 10)]);\n                var pKey = rowObj ? rowObj.data ? this.getPkValue(this.primaryKey, rowObj.data) : null : null;\n                if (pKey === null) {\n                    return;\n                }\n                if (this.isPartialSelection && !rowObj.isSelectable) {\n                    continue;\n                }\n                var checkState = void 0;\n                var chkBox = rows[parseInt(j.toString(), 10)].querySelector('.e-checkselect');\n                if (this.selectedRowState[\"\" + pKey] || (this.parent.checkAllRows === 'Check' && this.selectedRowState[\"\" + pKey] &&\n                    this.totalRecordsCount === Object.keys(this.selectedRowState).length && this.chkAllCollec.indexOf(pKey) < 0)\n                    || (this.parent.checkAllRows === 'Uncheck' && this.chkAllCollec.indexOf(pKey) > 0 && !this.parent.selectedRowIndex)\n                    || (this.parent.checkAllRows === 'Intermediate' && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.chkField) && rowObj.data[this.chkField])) {\n                    indexes.push(parseInt(rows[parseInt(j.toString(), 10)].getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1);\n                    checkState = true;\n                }\n                else {\n                    checkState = false;\n                    if (this.checkedTarget !== chkBox && this.parent.isCheckBoxSelection && chkBox) {\n                        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.removeAddCboxClasses)(chkBox.nextElementSibling, checkState);\n                    }\n                }\n                this.updatePersistCollection(rows[parseInt(j.toString(), 10)], checkState);\n            }\n            if (this.isSingleSel() && indexes.length > 0) {\n                this.selectRow(indexes[0], true);\n            }\n            else {\n                this.selectRows(indexes);\n            }\n        }\n        if ((this.parent.isCheckBoxSelection || this.parent.selectionSettings.checkboxMode === 'ResetOnRowClick') && this.getCurrentBatchRecordChanges().length > 0) {\n            this.setCheckAllState();\n        }\n    };\n    Selection.prototype.actionBegin = function (e) {\n        if (e.requestType === 'save' && this.parent.isPersistSelection) {\n            var editChkBox = this.parent.element.querySelector('.e-edit-checkselect');\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(editChkBox)) {\n                var row = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(editChkBox, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.editedRow);\n                if (row) {\n                    if (this.parent.editSettings.mode === 'Dialog') {\n                        row = this.parent.element.querySelector('.e-dlgeditrow');\n                    }\n                    var rowObj = this.getRowObj(row);\n                    if (!rowObj) {\n                        return;\n                    }\n                    this.selectedRowState[this.getPkValue(this.primaryKey, rowObj.data)] = rowObj.isSelected = editChkBox.checked;\n                }\n                else {\n                    this.isCheckedOnAdd = editChkBox.checked;\n                }\n            }\n        }\n        if (this.parent.isPersistSelection && this.isPartialSelection) {\n            if (e.requestType === 'paging' && (this.parent.getDataModule().isRemote()\n                || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result))) {\n                this.selectedRowIndexes = [];\n            }\n        }\n    };\n    Selection.prototype.actionComplete = function (e) {\n        if (e.requestType === 'save' && this.parent.isPersistSelection) {\n            if (e.action === 'add') {\n                if (this.isCheckedOnAdd) {\n                    var rowObj = this.parent.getRowObjectFromUID(this.parent.getRows()[e.selectedRow].getAttribute('data-uid'));\n                    this.selectedRowState[this.getPkValue(this.primaryKey, rowObj.data)] = rowObj.isSelected = this.isCheckedOnAdd;\n                }\n                this.isHdrSelectAllClicked = false;\n                this.setCheckAllState();\n            }\n            this.refreshPersistSelection();\n        }\n        if (e.requestType === 'delete' && this.parent.isPersistSelection) {\n            var records = e.data;\n            var data = records.slice();\n            for (var i = 0; i < data.length; i++) {\n                var pkValue = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(pkValue)) {\n                    this.updatePersistDelete(pkValue, this.isPartialSelection);\n                }\n            }\n            this.isHdrSelectAllClicked = false;\n            this.setCheckAllState();\n            this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n        }\n        if (e.requestType === 'paging') {\n            if (this.parent.isPersistSelection && this.isPartialSelection && this.isHdrSelectAllClicked) {\n                var rows = this.parent.getRowsObject();\n                var indexes = [];\n                for (var i = 0; i < rows.length; i++) {\n                    if (rows[parseInt(i.toString(), 10)].isSelectable) {\n                        indexes.push(rows[parseInt(i.toString(), 10)].index);\n                    }\n                }\n                if (indexes.length) {\n                    this.selectRows(indexes);\n                }\n            }\n            this.prevRowIndex = undefined;\n            this.prevCIdxs = undefined;\n            this.prevECIdxs = undefined;\n        }\n    };\n    Selection.prototype.onDataBound = function () {\n        var checkboxColumn = this.parent.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (checkboxColumn.length && !this.parent.getDataModule().isRemote()) {\n            this.gridCurrentRecord = this.getData();\n        }\n        if (!this.parent.enableVirtualization && this.parent.isPersistSelection) {\n            if (this.selectedRecords.length) {\n                this.isPrevRowSelection = true;\n            }\n        }\n        if (((this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n            && this.parent.dataSource.result)) && this.rmtHdrChkbxClicked)\n            || (this.isPartialSelection && this.parent.isPersistSelection && this.isHdrSelectAllClicked)) {\n            if (this.parent.checkAllRows === 'Intermediate') {\n                this.setRowSelection(true);\n            }\n            else if (this.parent.checkAllRows === 'Uncheck') {\n                this.setRowSelection(false);\n            }\n        }\n        if (this.parent.enableVirtualization) {\n            this.setCheckAllState();\n        }\n        if (this.parent.isPersistSelection) {\n            this.refreshPersistSelection();\n        }\n        this.initialRowSelection = this.isRowType() && this.parent.element.querySelectorAll('.e-selectionbackground') &&\n            this.parent.getSelectedRows().length ? true : false;\n        if (this.parent.isCheckBoxSelection && !this.initialRowSelection) {\n            var totalRecords = this.parent.getRowsObject();\n            var indexes = [];\n            for (var i = 0; i < totalRecords.length; i++) {\n                if (totalRecords[parseInt(i.toString(), 10)].isSelected) {\n                    indexes.push(i);\n                }\n            }\n            if (indexes.length) {\n                this.selectRows(indexes);\n            }\n            this.initialRowSelection = true;\n        }\n    };\n    Selection.prototype.updatePersistSelectedData = function (checkState) {\n        if (this.parent.isPersistSelection) {\n            var rows = this.parent.getRows();\n            for (var i = 0; i < rows.length; i++) {\n                this.updatePersistCollection(rows[parseInt(i.toString(), 10)], checkState);\n            }\n            if (this.parent.checkAllRows === 'Uncheck') {\n                this.setRowSelection(false);\n                this.persistSelectedData = (this.parent.getDataModule().isRemote()\n                    || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result))\n                    ? this.persistSelectedData : [];\n            }\n            else if (this.parent.checkAllRows === 'Check') {\n                this.setRowSelection(true);\n                this.persistSelectedData = !(this.parent.getDataModule().isRemote()\n                    || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result))\n                    && !this.isPartialSelection ?\n                    this.parent.groupSettings.columns.length ? this.getData().records.slice() :\n                        this.getData().slice() : this.persistSelectedData;\n            }\n        }\n    };\n    Selection.prototype.checkSelectAllAction = function (checkState) {\n        var cRenderer = this.getRenderer();\n        var editForm = this.parent.element.querySelector('.e-gridform');\n        this.checkedTarget = this.getCheckAllBox();\n        if (checkState && this.getCurrentBatchRecordChanges().length) {\n            this.parent.checkAllRows = 'Check';\n            this.updatePersistSelectedData(checkState);\n            this.selectRowsByRange(cRenderer.getVirtualRowIndex(0), cRenderer.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length - 1));\n            if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n                this.virtualSelectedData = this.virtualCheckBoxData().slice();\n                this.selectedRowIndexes = Object.keys(this.virtualSelectedData).map(function (key) { return parseInt(key, 10); });\n            }\n        }\n        else {\n            this.parent.checkAllRows = 'Uncheck';\n            this.updatePersistSelectedData(checkState);\n            this.clearSelection();\n        }\n        this.chkAllCollec = [];\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(editForm)) {\n            var editChkBox = editForm.querySelector('.e-edit-checkselect');\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(editChkBox)) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.removeAddCboxClasses)(editChkBox.nextElementSibling, checkState);\n            }\n        }\n    };\n    Selection.prototype.checkSelectAll = function (checkBox) {\n        var _this = this;\n        var stateStr = this.getCheckAllStatus(checkBox);\n        var state = stateStr === 'Check';\n        this.isHeaderCheckboxClicked = true;\n        if ((this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n            && this.parent.dataSource.result)) && ((stateStr === 'Uncheck' || this.isCheckboxReset) ||\n            (stateStr === 'Intermediate' && this.parent.isPersistSelection))) {\n            this.rmtHdrChkbxClicked = true;\n        }\n        else {\n            this.rmtHdrChkbxClicked = false;\n        }\n        if (this.rmtHdrChkbxClicked && this.isCheckboxReset) {\n            this.unSelectedRowState = {};\n        }\n        this.isCheckboxReset = false;\n        if (stateStr === 'Intermediate') {\n            if (!this.chkField && !this.parent.isPersistSelection) {\n                state = this.getCurrentBatchRecordChanges().some(function (data) {\n                    return _this.getPkValue(_this.primaryKey, data) in _this.selectedRowState;\n                });\n            }\n            if (this.parent.isPersistSelection) {\n                if (this.parent.allowPaging && this.isPartialSelection) {\n                    var rowObjects = this.parent.getRowsObject();\n                    for (var i = 0; i < rowObjects.length; i++) {\n                        if (rowObjects[i].isDataRow && rowObjects[i].isSelectable &&\n                            !rowObjects[i].isSelected) {\n                            state = false;\n                            break;\n                        }\n                        else {\n                            state = true;\n                        }\n                    }\n                }\n                else if ((this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n                    && this.parent.dataSource.result))) {\n                    for (var i = 0; i < this.getCurrentBatchRecordChanges().length; i++) {\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.getPkValue(this.primaryKey, this.getCurrentBatchRecordChanges()[\"\" + i]))) {\n                            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                            if (Object.keys(this.selectedRowState).includes((this.getPkValue(this.primaryKey, this.getCurrentBatchRecordChanges()[\"\" + i])).toString())) {\n                                state = true;\n                            }\n                            else {\n                                state = false;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (this.parent.isPersistSelection && this.parent.allowPaging) {\n            this.totalRecordsCount = this.parent.pageSettings.totalRecordsCount;\n        }\n        this.checkSelectAllAction(!state);\n        this.target = null;\n        if (this.getCurrentBatchRecordChanges().length > 0) {\n            this.setCheckAllState();\n            this.updateSelectedRowIndexes();\n        }\n        this.triggerChkChangeEvent(checkBox, !state);\n    };\n    Selection.prototype.getCheckAllStatus = function (ele) {\n        var classes;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(ele)) {\n            classes = ele.nextElementSibling.classList;\n        }\n        else {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.getCheckAllBox())) {\n                classes = this.getCheckAllBox().nextElementSibling.classList;\n            }\n        }\n        var status = 'None';\n        if (classes instanceof DOMTokenList) {\n            if (classes.contains('e-check')) {\n                status = 'Check';\n            }\n            else if (classes.contains('e-uncheck')) {\n                status = 'Uncheck';\n            }\n            else if (classes.contains('e-stop')) {\n                status = 'Intermediate';\n            }\n        }\n        return status;\n    };\n    Selection.prototype.checkSelect = function (checkBox) {\n        var target = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(this.checkedTarget, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell);\n        var gObj = this.parent;\n        this.isMultiCtrlRequest = true;\n        var rIndex = 0;\n        this.isHeaderCheckboxClicked = false;\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.isGroupAdaptive)(gObj)) {\n            var uid = target.parentElement.getAttribute('data-uid');\n            if (this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n                rIndex = parseInt(target.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n            }\n            else {\n                rIndex = gObj.getRows().map(function (m) { return m.getAttribute('data-uid'); }).indexOf(uid);\n            }\n        }\n        else {\n            rIndex = parseInt(target.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n        }\n        if (this.parent.isPersistSelection && this.parent.element.getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.addedRow).length > 0 &&\n            this.parent.editSettings.newRowPosition === 'Top' && !this.parent.editSettings.showAddNewRow) {\n            ++rIndex;\n        }\n        this.rowCellSelectionHandler(rIndex, parseInt(target.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1);\n        this.moveIntoUncheckCollection((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.row));\n        this.setCheckAllState();\n        this.isMultiCtrlRequest = false;\n        this.triggerChkChangeEvent(checkBox, checkBox.nextElementSibling.classList.contains('e-check'));\n    };\n    Selection.prototype.moveIntoUncheckCollection = function (row) {\n        if (this.parent.checkAllRows === 'Check' || this.parent.checkAllRows === 'Uncheck') {\n            var rowObj = this.getRowObj(row);\n            var pKey = rowObj && rowObj.data ? this.getPkValue(this.primaryKey, rowObj.data) : null;\n            if (!pKey) {\n                return;\n            }\n            if (this.chkAllCollec.indexOf(pKey) < 0) {\n                this.chkAllCollec.push(pKey);\n            }\n            else {\n                this.chkAllCollec.splice(this.chkAllCollec.indexOf(pKey), 1);\n            }\n        }\n    };\n    Selection.prototype.triggerChkChangeEvent = function (checkBox, checkState) {\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.checkBoxChange, {\n            checked: checkState, selectedRowIndexes: this.parent.getSelectedRowIndexes(),\n            target: checkBox\n        });\n        if (!this.parent.isEdit) {\n            this.checkedTarget = null;\n        }\n    };\n    Selection.prototype.updateSelectedRowIndexes = function () {\n        if (this.parent.isCheckBoxSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) &&\n            this.isPartialSelection && !(this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n            && this.parent.dataSource.result))\n            && this.parent.selectionSettings.persistSelection) {\n            if (this.parent.checkAllRows !== 'Uncheck') {\n                var rowObj = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; });\n                for (var _i = 0, rowObj_2 = rowObj; _i < rowObj_2.length; _i++) {\n                    var row = rowObj_2[_i];\n                    this.selectedRowIndexes.push(row.index);\n                }\n            }\n        }\n        if (this.parent.isCheckBoxSelection && this.parent.enableVirtualization && !this.isPartialSelection &&\n            (this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n                && this.parent.dataSource.result))\n            && !this.parent.isPersistSelection && this.parent.checkAllRows === 'Check') {\n            var rowObj = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; });\n            if (rowObj.length !== this.selectedRowIndexes.length) {\n                for (var _a = 0, rowObj_3 = rowObj; _a < rowObj_3.length; _a++) {\n                    var row = rowObj_3[_a];\n                    if (this.selectedRowIndexes.indexOf(row.index) <= -1) {\n                        this.selectedRowIndexes.push(row.index);\n                    }\n                }\n            }\n        }\n    };\n    Selection.prototype.updateSelectedRowIndex = function (index) {\n        if (this.parent.isCheckBoxSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)\n            && !(this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n                && this.parent.dataSource.result))\n            && !this.isPartialSelection) {\n            if (this.parent.checkAllRows === 'Check') {\n                this.selectedRowIndexes = [];\n                var dataLength = this.parent.groupSettings.columns.length ? this.getData()['records'].length :\n                    this.getData().length;\n                for (var data = 0; data < dataLength; data++) {\n                    this.selectedRowIndexes.push(data);\n                }\n            }\n            else if (this.parent.checkAllRows === 'Uncheck') {\n                this.selectedRowIndexes = [];\n            }\n            else {\n                var row = this.parent.getRowByIndex(index);\n                if (index && row && row.getAttribute('aria-selected') === 'false') {\n                    var selectedVal = this.selectedRowIndexes.indexOf(index);\n                    this.selectedRowIndexes.splice(selectedVal, 1);\n                }\n            }\n        }\n    };\n    Selection.prototype.isAllSelected = function (count) {\n        if (this.parent.getDataModule().isRemote()\n            || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result)) {\n            return this.getAvailableSelectedData(this.persistSelectedData).length === (this.parent.enableVirtualization\n                || this.parent.enableInfiniteScrolling ? this.parent.totalDataRecordsCount : this.totalRecordsCount);\n        }\n        else {\n            if (this.isPartialSelection) {\n                if (this.parent.allowPaging && !this.selectionSettings.persistSelection\n                    && this.parent.pageSettings.pageSize < this.parent.pageSettings.totalRecordsCount) {\n                    var data = this.parent.partialSelectedRecords;\n                    for (var i = 0; i < data.length; i++) {\n                        var pKey = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n                        if (!this.selectedRowState[\"\" + pKey]) {\n                            return false;\n                        }\n                    }\n                    return true;\n                }\n                else {\n                    return this.isSelectAllRowCount(count);\n                }\n            }\n            else {\n                var data = this.getData();\n                if (this.parent.groupSettings.columns.length && data['records']) {\n                    data = data['records'];\n                }\n                for (var i = 0; i < data.length; i++) {\n                    var pKey = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n                    if (!this.selectedRowState[\"\" + pKey]) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n        }\n    };\n    Selection.prototype.someDataSelected = function () {\n        if ((this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n            && this.parent.dataSource.result))\n            && (this.parent.searchSettings.key.length || this.parent.filterSettings.columns.length)) {\n            var filteredSearchedSelectedData = this.getAvailableSelectedData(this.persistSelectedData);\n            for (var i = 0; i < filteredSearchedSelectedData.length; i++) {\n                var pKey = this.getPkValue(this.primaryKey, filteredSearchedSelectedData[parseInt(i.toString(), 10)]);\n                if (this.selectedRowState[\"\" + pKey]) {\n                    return false;\n                }\n            }\n        }\n        var data = this.isPartialSelection ? this.getAvailableSelectedData(this.parent.partialSelectedRecords)\n            : (this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n                && this.parent.dataSource.result)) ? [] : this.getData();\n        for (var i = 0; i < data.length; i++) {\n            var pKey = this.getPkValue(this.primaryKey, data[parseInt(i.toString(), 10)]);\n            if (this.selectedRowState[\"\" + pKey]) {\n                return false;\n            }\n        }\n        return true;\n    };\n    Selection.prototype.setCheckAllState = function (index, isInteraction) {\n        if (this.parent.isCheckBoxSelection || this.parent.selectionSettings.checkboxMode === 'ResetOnRowClick') {\n            var checkToSelectAll = false;\n            var isFiltered = false;\n            var checkedLen = Object.keys(this.selectedRowState).length;\n            if (this.parent.element.classList.contains('e-treelistgrid') && this.parent.isPersistSelection && !this.parent.enableVirtualization &&\n                !this.parent.getDataModule().isRemote() && Array.isArray(this.parent.dataSource) &&\n                checkedLen === this.parent.dataSource.length && checkedLen > this.totalRecordsCount) {\n                checkedLen = this.totalRecordsCount;\n            }\n            if (!this.parent.isPersistSelection) {\n                checkedLen = this.selectedRowIndexes.length;\n                this.totalRecordsCount = this.getCurrentBatchRecordChanges().length;\n            }\n            if (this.parent.isPersistSelection && !((this.parent.getDataModule().isRemote() ||\n                (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result)) &&\n                this.isPartialSelection)\n                && (this.parent.searchSettings.key.length || this.parent.filterSettings.columns.length)) {\n                isFiltered = true;\n                checkToSelectAll = this.isAllSelected(checkedLen);\n            }\n            var input = this.getCheckAllBox();\n            if (input) {\n                var spanEle = input.nextElementSibling;\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([spanEle], ['e-check', 'e-stop', 'e-uncheck']);\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.setChecked)(input, false);\n                input.indeterminate = false;\n                var getRecord = this.parent.getDataModule().isRemote() ? [] : this.gridCurrentRecord;\n                if (this.parent.groupSettings.columns.length && getRecord['records']) {\n                    getRecord = getRecord['records'];\n                }\n                this.totalRecordsCount = this.checkVirtualCheckBox() ? getRecord.length : this.totalRecordsCount;\n                if ((checkToSelectAll && isFiltered && (this.parent.getDataModule().isRemote() ||\n                    (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result) ||\n                    getRecord.length)) || (!isFiltered && ((checkedLen === this.totalRecordsCount && this.totalRecordsCount\n                    && !this.isPartialSelection && (!(this.parent.getDataModule().isRemote()\n                    || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result))\n                    || this.parent.allowPaging)) ||\n                    (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling\n                        && this.isPartialSelection && (this.isSelectAllRowCount(checkedLen)\n                        || (this.isHdrSelectAllClicked && !this.parent.isPersistSelection)))\n                    || ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)\n                        && !this.parent.allowPaging && ((!(this.parent.getDataModule().isRemote()\n                        || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result)) &&\n                        getRecord.length && checkedLen === getRecord.length) || ((this.parent.getDataModule().isRemote()\n                        || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result)) &&\n                        !this.isPartialSelection && ((checkedLen === this.parent.totalDataRecordsCount) || ((this.\n                        isSelectAllRowCount(checkedLen) || checkedLen === this.totalRecordsCount) && !this.parent.isPersistSelection))) ||\n                        (this.isPartialSelection && (this.isHdrSelectAllClicked || this.isSelectAllRowCount(checkedLen)))))\n                    || (checkedLen === this.totalRecordsCount && this.totalRecordsCount && !this.isPartialSelection &&\n                        !this.parent.allowPaging && !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling)))) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([spanEle], ['e-check']);\n                    (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.setChecked)(input, true);\n                    if (isInteraction) {\n                        this.getRenderer().setSelection(null, true, true);\n                    }\n                    this.parent.checkAllRows = 'Check';\n                }\n                else if (((!this.selectedRowIndexes.length && (!this.parent.enableVirtualization ||\n                    (!this.persistSelectedData.length && !isFiltered) || (isFiltered && this.someDataSelected())) ||\n                    checkedLen === 0 && this.getCurrentBatchRecordChanges().length === 0) && !this.parent.allowPaging) ||\n                    (this.parent.allowPaging && (checkedLen === 0 || (checkedLen && isFiltered && this.someDataSelected())))) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([spanEle], ['e-uncheck']);\n                    if (isInteraction) {\n                        this.getRenderer().setSelection(null, false, true);\n                    }\n                    this.parent.checkAllRows = 'Uncheck';\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([spanEle], ['e-stop']);\n                    this.parent.checkAllRows = 'Intermediate';\n                    input.indeterminate = true;\n                }\n                if (checkedLen === 0 && this.getCurrentBatchRecordChanges().length === 0) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([spanEle.parentElement], ['e-checkbox-disabled']);\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([spanEle.parentElement], ['e-checkbox-disabled']);\n                }\n                if (this.isPartialSelection) {\n                    var rowCount = this.parent.getRowsObject().filter(function (e) { return e.isSelectable; }).length;\n                    if (rowCount === 0 && spanEle.parentElement.querySelector('.e-frame').classList.contains('e-uncheck')) {\n                        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([spanEle.parentElement], ['e-checkbox-disabled']);\n                    }\n                    else {\n                        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([spanEle.parentElement], ['e-checkbox-disabled']);\n                    }\n                }\n                if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)\n                    && !this.parent.allowPaging && !(this.parent.getDataModule().isRemote()\n                    || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource) && this.parent.dataSource.result))) {\n                    this.updateSelectedRowIndex(index);\n                }\n            }\n        }\n    };\n    Selection.prototype.checkVirtualCheckBox = function () {\n        return this.parent.enableVirtualization && !(this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n            && this.parent.dataSource.result)) && this.parent.isCheckBoxSelection && !this.isPartialSelection;\n    };\n    Selection.prototype.virtualCheckBoxData = function () {\n        var data = this.getData();\n        if (this.parent.groupSettings.columns.length && data['records']) {\n            data = data['records'];\n        }\n        return data;\n    };\n    Selection.prototype.isSelectAllRowCount = function (count) {\n        var rowCount = 0;\n        var rowObj = this.parent.getRowsObject();\n        if (this.parent.selectionSettings.persistSelection && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n            var dataLen = (this.parent.getDataModule().isRemote() || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.dataSource)\n                && this.parent.dataSource.result)) ?\n                this.parent.totalDataRecordsCount : this.getData() && this.getData().length;\n            if (dataLen === rowObj.length) {\n                rowCount = rowObj.filter(function (e) { return e.isSelectable; }).length;\n                return rowCount && count === rowCount;\n            }\n            else {\n                return false;\n            }\n        }\n        else {\n            if (this.parent.allowPaging && this.parent.selectionSettings.persistSelection) {\n                var disableSelectedRecordsCount = this.getAvailableSelectedData(this.parent.disableSelectedRecords).length;\n                var partialSelectedRecordsCount = this.getAvailableSelectedData(this.parent.partialSelectedRecords).length;\n                var selectedRowCount = this.getAvailableSelectedData(this.persistSelectedData).length;\n                rowCount = disableSelectedRecordsCount + partialSelectedRecordsCount;\n                return rowCount === this.totalRecordsCount && selectedRowCount !== 0 && selectedRowCount === partialSelectedRecordsCount;\n            }\n            else {\n                rowCount = rowObj.filter(function (e) { return e.isSelectable; }).length;\n                return rowCount && count === rowCount;\n            }\n        }\n    };\n    Selection.prototype.keyDownHandler = function (e) {\n        // Below are keyCode for command key in MAC OS. Safari/Chrome(91-Left command, 93-Right Command), Opera(17), FireFox(224)\n        if ((_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'opera' && e.keyCode === 17) || (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'mozilla' && e.keyCode === 224) ||\n            (((_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'safari') || (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'chrome')) && (e.keyCode === 91 || e.keyCode === 93))) {\n            this.cmdKeyPressed = true;\n        }\n        var targetHeadCell = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.target, 'e-headercell');\n        var targetRowCell = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell);\n        var isCheckBox = targetHeadCell ? targetHeadCell.children[0].classList.contains('e-headerchkcelldiv') :\n            targetRowCell ? targetRowCell.classList.contains('e-gridchkbox') : false;\n        if (isCheckBox && !this.parent.allowKeyboard && e.keyCode === 32) {\n            e.preventDefault();\n        }\n    };\n    Selection.prototype.keyUpHandler = function (e) {\n        if ((_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'opera' && e.keyCode === 17) || (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'mozilla' && e.keyCode === 224) ||\n            (((_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'safari') || (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'chrome')) && (e.keyCode === 91 || e.keyCode === 93))) {\n            this.cmdKeyPressed = false;\n        }\n    };\n    Selection.prototype.clickHandler = function (e) {\n        var target = e.target;\n        this.actualTarget = target;\n        if (!this.isAutoFillSel && !e.ctrlKey && !e.shiftKey) {\n            this.startAFCell = this.endAFCell = null;\n        }\n        if (this.selectionSettings.persistSelection) {\n            this.deSelectedData = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.iterateExtend)(this.persistSelectedData);\n        }\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.row) || (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-headerchkcelldiv') ||\n            (this.selectionSettings.allowColumnSelection && target.classList.contains('e-headercell'))) {\n            this.isInteracted = true;\n        }\n        this.cmdKeyPressed = e.metaKey;\n        this.isMultiCtrlRequest = e.ctrlKey || this.enableSelectMultiTouch ||\n            (this.isMacOS && this.cmdKeyPressed);\n        if (!this.parent.allowKeyboard) {\n            this.isMultiShiftRequest = false;\n            this.isMultiCtrlRequest = false;\n        }\n        else {\n            this.isMultiShiftRequest = e.shiftKey;\n        }\n        this.isMultiCtrlRequestCell = this.isMultiCtrlRequest;\n        this.popUpClickHandler(e);\n        var chkSelect = false;\n        this.preventFocus = true;\n        var checkBox;\n        var checkWrap = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-checkbox-wrapper');\n        this.checkSelectAllClicked = checkWrap && checkWrap.getElementsByClassName('e-checkselectall') ||\n            (this.selectionSettings.persistSelection && (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.row)) ? true : false;\n        if (this.selectionSettings.persistSelection && this.isPartialSelection && (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-headerchkcelldiv')\n            && !target.querySelector('.e-checkbox-disabled')) {\n            this.isHdrSelectAllClicked = true;\n        }\n        if (checkWrap && checkWrap.querySelectorAll('.e-checkselect,.e-checkselectall').length > 0) {\n            checkBox = checkWrap.querySelector('input[type=\"checkbox\"]');\n            chkSelect = true;\n        }\n        this.drawBorders();\n        this.updateAutoFillPosition();\n        target = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell);\n        if (this.parent.isReact && (target && !target.parentElement && target.classList.contains('e-rowcell'))) {\n            target = this.parent.getCellFromIndex(parseInt(target.getAttribute('index'), 10), parseInt(target.getAttribute('aria-colindex'), 10) - 1);\n        }\n        if (this.isRowDragSelected && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(target) && this.parent.allowRowDragAndDrop &&\n            this.selectionSettings.persistSelection && this.checkSelectAllClicked) {\n            this.isRowDragSelected = false;\n        }\n        if (((target && target.parentElement.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.row) && !this.parent.selectionSettings.checkboxOnly) || chkSelect)\n            && !this.isRowDragSelected) {\n            if (this.parent.isCheckBoxSelection) {\n                this.isMultiCtrlRequest = true;\n            }\n            this.target = target;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(checkBox)) {\n                this.checkedTarget = checkBox;\n                if (checkBox.classList.contains('e-checkselectall')) {\n                    this.checkSelectAll(checkBox);\n                }\n                else {\n                    this.checkSelect(checkBox);\n                }\n            }\n            else {\n                var rIndex = 0;\n                rIndex = parseInt(target.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex), 10) - 1;\n                if (this.parent.isPersistSelection && !this.parent.editSettings.showAddNewRow\n                    && this.parent.element.getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.addedRow).length > 0) {\n                    ++rIndex;\n                }\n                if (!this.mUPTarget || !this.mUPTarget.isEqualNode(target)) {\n                    this.rowCellSelectionHandler(rIndex, parseInt(target.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1);\n                }\n                if (this.parent.isCheckBoxSelection) {\n                    this.moveIntoUncheckCollection((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.row));\n                    this.setCheckAllState();\n                }\n            }\n            if (!this.parent.isCheckBoxSelection && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice && !this.isSingleSel()) {\n                this.showPopup(e);\n            }\n        }\n        else if (e.target.classList.contains('e-headercell') &&\n            !e.target.classList.contains('e-stackedheadercell')) {\n            var uid = e.target.querySelector('.e-headercelldiv').getAttribute('e-mappinguid');\n            this.headerSelectionHandler(this.parent.getColumnIndexByUid(uid));\n        }\n        this.isMultiCtrlRequest = false;\n        this.isMultiCtrlRequestCell = this.isMultiCtrlRequest;\n        this.isMultiShiftRequest = false;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-unboundcell'))) {\n            this.preventFocus = false;\n        }\n    };\n    Selection.prototype.popUpClickHandler = function (e) {\n        var target = e.target;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.e-headercell') || e.target.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell) ||\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.e-gridpopup')) {\n            if (target.classList.contains('e-rowselect')) {\n                if (!target.classList.contains('e-spanclicked')) {\n                    target.classList.add('e-spanclicked');\n                    this.enableSelectMultiTouch = true;\n                }\n                else {\n                    target.classList.remove('e-spanclicked');\n                    this.enableSelectMultiTouch = false;\n                    this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n                }\n            }\n        }\n        else {\n            this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n        }\n    };\n    Selection.prototype.showPopup = function (e) {\n        if (!this.selectionSettings.enableSimpleMultiRowSelection) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.setCssInGridPopUp)(this.parent.element.querySelector('.e-gridpopup'), e, 'e-rowselect e-icons e-icon-rowselect' +\n                (!this.isSingleSel() && (this.selectedRecords.length > 1\n                    || this.selectedRowCellIndexes.length > 1) ? ' e-spanclicked' : ''));\n        }\n    };\n    Selection.prototype.rowCellSelectionHandler = function (rowIndex, cellIndex) {\n        if ((!this.isMultiCtrlRequest && !this.isMultiShiftRequest) || this.isSingleSel()) {\n            if (!this.isDragged) {\n                this.selectRow(rowIndex, this.selectionSettings.enableToggle);\n            }\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, this.selectionSettings.enableToggle);\n            if (this.selectedRowCellIndexes.length) {\n                this.updateAutoFillPosition();\n            }\n            this.drawBorders();\n        }\n        else if (this.isMultiShiftRequest) {\n            if (this.parent.isCheckBoxSelection || (!this.parent.isCheckBoxSelection &&\n                !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(this.target, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell).classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.gridChkBox))) {\n                this.selectRowsByRange((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(this.prevRowIndex) ? rowIndex : this.prevRowIndex, rowIndex);\n            }\n            else {\n                this.addRowsToSelection([rowIndex]);\n            }\n            this.selectCellsByRange((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(this.prevCIdxs) ? { rowIndex: rowIndex, cellIndex: cellIndex } : this.prevCIdxs, { rowIndex: rowIndex, cellIndex: cellIndex });\n            this.updateAutoFillPosition();\n            this.drawBorders();\n        }\n        else {\n            this.addRowsToSelection([rowIndex]);\n            if (this.selectionSettings.mode === 'Both') {\n                var checkboxColumn = this.parent.getColumns().find(function (col) { return col.type === 'checkbox'; });\n                var checkboxColumnIndexCheck = checkboxColumn && checkboxColumn.index !== cellIndex;\n                if (checkboxColumnIndexCheck && !this.isMultiCtrlRequestCell) {\n                    this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, this.selectionSettings.enableToggle);\n                }\n                else if (!checkboxColumn || checkboxColumnIndexCheck) {\n                    this.addCellsToSelection([{ rowIndex: rowIndex, cellIndex: cellIndex }]);\n                }\n            }\n            else {\n                this.addCellsToSelection([{ rowIndex: rowIndex, cellIndex: cellIndex }]);\n            }\n            this.showHideBorders('none');\n        }\n        this.isDragged = false;\n    };\n    Selection.prototype.onCellFocused = function (e) {\n        if (this.parent.frozenRows && e.container.isHeader && e.byKey) {\n            if (e.keyArgs.action === 'upArrow') {\n                if (this.parent.allowFiltering) {\n                    e.isJump = e.element.tagName === 'INPUT' ? true : false;\n                }\n                else {\n                    e.isJump = e.element.tagName === 'TH' ? true : false;\n                }\n            }\n            else {\n                if (e.keyArgs.action === 'downArrow') {\n                    var rIdx = Number(e.element.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaRowIndex)) - 1;\n                    e.isJump = rIdx === 0 ? true : false;\n                }\n                else {\n                    if (e.keyArgs.action === 'ctrlHome') {\n                        e.isJump = true;\n                    }\n                }\n            }\n        }\n        var clear = ((e.container.isHeader && e.isJump) ||\n            (e.container.isContent && !e.container.isSelectable)) && !(e.byKey && e.keyArgs.action === 'space')\n            && !(e.element.classList.contains('e-detailrowexpand') || e.element.classList.contains('e-detailrowcollapse'));\n        var headerAction = (e.container.isHeader && e.element.tagName !== 'TD' && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.element, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell))\n            && !(e.byKey && e.keyArgs.action === 'space');\n        if (!e.byKey || clear) {\n            if (clear && !(this.parent.isCheckBoxSelection || (this.selectionSettings.persistSelection && (e.parent.classList.contains('e-recordplusexpand') ||\n                e.parent.classList.contains('e-recordpluscollapse') || e.parent.classList.contains('e-groupcaption'))))) {\n                this.clearSelection();\n            }\n            return;\n        }\n        var _a = e.container.isContent ? e.container.indexes : e.indexes, rowIndex = _a[0], cellIndex = _a[1];\n        var prev = this.focus.getPrevIndexes();\n        if (e.element.parentElement.querySelector('.e-rowcelldrag') || e.element.parentElement.querySelector('.e-dtdiagonalright')\n            || e.element.parentElement.querySelector('.e-dtdiagonaldown')) {\n            prev.cellIndex = prev.cellIndex - 1;\n        }\n        if (this.parent.frozenRows) {\n            if (e.container.isHeader && (e.element.tagName === 'TD' || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.element, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell))) {\n                var hdrLength = this.parent.getHeaderTable().querySelector('thead').childElementCount;\n                if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Top' &&\n                    e.keyArgs.action === 'upArrow') {\n                    hdrLength++;\n                }\n                rowIndex -= hdrLength;\n                prev.rowIndex = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(prev.rowIndex) ? prev.rowIndex - hdrLength : null;\n            }\n            else {\n                rowIndex += this.parent.frozenRows;\n                prev.rowIndex = prev.rowIndex === 0 || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(prev.rowIndex) ? prev.rowIndex + this.parent.frozenRows : null;\n            }\n        }\n        if (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache) {\n            rowIndex = parseInt(e.element.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n        }\n        if ((headerAction || (['ctrlPlusA', 'escape'].indexOf(e.keyArgs.action) === -1 &&\n            e.keyArgs.action !== 'space' && rowIndex === prev.rowIndex && cellIndex === prev.cellIndex)) &&\n            !this.selectionSettings.allowColumnSelection) {\n            return;\n        }\n        if (this.parent.enableVirtualization) {\n            rowIndex = parseInt(e.element.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            if (!this.parent.enableColumnVirtualization && !this.parent.groupSettings.columns.length &&\n                this.parent.totalDataRecordsCount >= 1) {\n                if (e.keyArgs.action === 'ctrlHome') {\n                    rowIndex = 0;\n                    this.parent.isFocusFirstCell = true;\n                }\n                else if (e.keyArgs.action === 'ctrlEnd') {\n                    rowIndex = this.parent.totalDataRecordsCount - 1;\n                    this.isFocusLastCell = true;\n                }\n            }\n        }\n        if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Top' &&\n            (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling) && e.keyArgs.action === 'downArrow') {\n            rowIndex--;\n        }\n        this.preventFocus = true;\n        var columnIndex = this.getKeyColIndex(e);\n        if (this.needColumnSelection) {\n            cellIndex = columnIndex;\n        }\n        if (this.parent.element.classList.contains('e-gridcell-read') && (e.keyArgs.action === 'tab' || e.keyArgs.action === 'shiftTab'\n            || e.keyArgs.action === 'rightArrow' || e.keyArgs.action === 'leftArrow')) {\n            var targetLabel = this.target.getAttribute('aria-label');\n            targetLabel = this.target.innerHTML + ' column header ' + this.parent.getColumnByIndex(cellIndex).field;\n            this.target.setAttribute('aria-label', targetLabel);\n        }\n        switch (e.keyArgs.action) {\n            case 'downArrow':\n            case 'upArrow':\n            case 'enter':\n            case 'shiftEnter':\n                this.target = e.element;\n                this.isKeyAction = true;\n                this.applyDownUpKey(rowIndex, cellIndex);\n                break;\n            case 'rightArrow':\n            case 'leftArrow':\n                this.applyRightLeftKey(rowIndex, cellIndex);\n                break;\n            case 'shiftDown':\n            case 'shiftUp':\n                this.shiftDownKey(rowIndex, cellIndex);\n                break;\n            case 'shiftLeft':\n            case 'shiftRight':\n                this.applyShiftLeftRightKey(rowIndex, cellIndex);\n                break;\n            case 'home':\n            case 'end':\n                cellIndex = e.keyArgs.action === 'end' ? this.getLastColIndex(rowIndex) : 0;\n                this.applyHomeEndKey(rowIndex, cellIndex);\n                break;\n            case 'ctrlHome':\n            case 'ctrlEnd':\n                this.applyCtrlHomeEndKey(rowIndex, cellIndex);\n                break;\n            case 'escape':\n                this.clearSelection();\n                if (this.parent.clipboardModule) {\n                    window.navigator['clipboard'].writeText('');\n                }\n                break;\n            case 'ctrlPlusA':\n                this.ctrlPlusA();\n                break;\n            case 'space':\n                this.applySpaceSelection(e.element);\n                break;\n            case 'tab':\n                if (this.parent.editSettings.allowNextRowEdit) {\n                    this.selectRow(rowIndex);\n                }\n                break;\n        }\n        this.needColumnSelection = false;\n        this.preventFocus = false;\n        this.positionBorders();\n        if (this.parent.isFrozenGrid()) {\n            this.showHideBorders('none', true);\n            this.refreshFrozenBorders();\n        }\n        this.updateAutoFillPosition();\n    };\n    Selection.prototype.getKeyColIndex = function (e) {\n        var uid;\n        var index = null;\n        var stackedHeader = e.element.querySelector('.e-stackedheadercelldiv');\n        if (this.selectionSettings.allowColumnSelection && (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.element, 'e-columnheader')) {\n            this.needColumnSelection = e.container.isHeader ? true : false;\n            if (stackedHeader) {\n                if (e.keyArgs.action === 'rightArrow' || e.keyArgs.action === 'leftArrow') {\n                    return index;\n                }\n                uid = stackedHeader.getAttribute('e-mappinguid');\n                var innerColumn = this.getstackedColumns(this.parent.getColumnByUid(uid).columns);\n                var lastIndex = this.parent.getColumnIndexByUid(innerColumn[innerColumn.length - 1].uid);\n                var firstIndex = this.parent.getColumnIndexByUid(innerColumn[0].uid);\n                index = this.prevColIndex >= lastIndex ? firstIndex : lastIndex;\n            }\n            else {\n                index = this.parent.getColumnIndexByUid(e.element\n                    .querySelector('.e-headercelldiv').getAttribute('e-mappinguid'));\n            }\n        }\n        return index;\n    };\n    /**\n     * Apply ctrl + A key selection\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.ctrlPlusA = function () {\n        if (this.isRowType() && !this.isSingleSel()) {\n            var rowObj = this.parent.getRowsObject();\n            this.selectRowsByRange(rowObj[0].index, rowObj[rowObj.length - 1].index);\n        }\n        if (this.isCellType() && !this.isSingleSel()) {\n            this.selectCellsByRange({ rowIndex: 0, cellIndex: 0 }, { rowIndex: this.parent.getRows().length - 1, cellIndex: this.parent.getColumns().length - 1 });\n        }\n    };\n    Selection.prototype.applySpaceSelection = function (target) {\n        if (target.classList.contains('e-checkselectall')) {\n            this.checkedTarget = target;\n            this.checkSelectAll(this.checkedTarget);\n        }\n        else {\n            if (target.classList.contains('e-checkselect')) {\n                this.checkedTarget = target;\n                this.checkSelect(this.checkedTarget);\n            }\n        }\n    };\n    Selection.prototype.applyDownUpKey = function (rowIndex, cellIndex) {\n        var gObj = this.parent;\n        if (this.parent.isCheckBoxSelection && this.parent.checkAllRows === 'Check' && !this.selectionSettings.persistSelection &&\n            !this.selectionSettings.checkboxOnly) {\n            this.checkSelectAllAction(false);\n            this.checkedTarget = null;\n        }\n        if (this.isRowType() && !this.selectionSettings.checkboxOnly) {\n            if (this.parent.frozenRows) {\n                this.selectRow(rowIndex, true);\n                this.applyUpDown(gObj.selectedRowIndex);\n            }\n            else {\n                this.selectRow(rowIndex, true);\n                this.applyUpDown(gObj.selectedRowIndex);\n            }\n        }\n        if (this.isCellType()) {\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, true);\n        }\n        if (this.selectionSettings.allowColumnSelection && this.needColumnSelection) {\n            this.selectColumn(cellIndex);\n        }\n    };\n    Selection.prototype.applyUpDown = function (rowIndex) {\n        if (rowIndex < 0) {\n            return;\n        }\n        if (!this.target) {\n            this.target = this.parent.getRows()[0].children[this.parent.groupSettings.columns.length || 0];\n        }\n        var cIndex = parseInt(this.target.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex), 10) - 1;\n        var row = this.contentRenderer.getRowByIndex(rowIndex);\n        if (row) {\n            this.target = row.getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell)[parseInt(cIndex.toString(), 10)];\n        }\n        this.addAttribute(this.target);\n        if (this.parent.element.classList.contains('e-gridcell-read')) {\n            var targetLabel = this.target.getAttribute('aria-label');\n            targetLabel = this.target.innerHTML;\n            this.target.setAttribute('aria-label', targetLabel);\n        }\n    };\n    Selection.prototype.applyRightLeftKey = function (rowIndex, cellIndex) {\n        if (this.selectionSettings.allowColumnSelection && this.needColumnSelection) {\n            this.selectColumn(cellIndex);\n        }\n        else if (this.isCellType()) {\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, true);\n            this.addAttribute(this.target);\n        }\n    };\n    Selection.prototype.applyHomeEndKey = function (rowIndex, cellIndex) {\n        if (this.isCellType()) {\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, true);\n        }\n        else {\n            this.addAttribute(this.parent.getCellFromIndex(rowIndex, cellIndex));\n        }\n    };\n    /**\n     * Apply shift+down key selection\n     *\n     * @param {number} rowIndex - specfies the rowIndex\n     * @param {number} cellIndex - specifies the CellIndex\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.shiftDownKey = function (rowIndex, cellIndex) {\n        this.isMultiShiftRequest = true;\n        if (this.isRowType() && !this.isSingleSel()) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(this.prevRowIndex)) {\n                this.selectRowsByRange(this.prevRowIndex, rowIndex);\n                this.applyUpDown(rowIndex);\n            }\n            else if (this.isPartialSelection) {\n                this.selectRow(rowIndex, true);\n            }\n            else {\n                this.selectRow(0, true);\n            }\n        }\n        if (this.isCellType() && !this.isSingleSel()) {\n            this.selectCellsByRange(this.prevCIdxs || { rowIndex: 0, cellIndex: 0 }, { rowIndex: rowIndex, cellIndex: cellIndex });\n        }\n        this.isMultiShiftRequest = false;\n    };\n    Selection.prototype.applyShiftLeftRightKey = function (rowIndex, cellIndex) {\n        this.isMultiShiftRequest = true;\n        if (this.selectionSettings.allowColumnSelection && this.needColumnSelection) {\n            this.selectColumnsByRange(this.prevColIndex, cellIndex);\n        }\n        else {\n            this.selectCellsByRange(this.prevCIdxs, { rowIndex: rowIndex, cellIndex: cellIndex });\n        }\n        this.isMultiShiftRequest = false;\n    };\n    Selection.prototype.getstackedColumns = function (column) {\n        var innerColumnIndexes = [];\n        for (var i = 0, len = column.length; i < len; i++) {\n            if (column[parseInt(i.toString(), 10)].columns) {\n                this.getstackedColumns(column[parseInt(i.toString(), 10)].columns);\n            }\n            else {\n                innerColumnIndexes.push(column[parseInt(i.toString(), 10)]);\n            }\n        }\n        return innerColumnIndexes;\n    };\n    Selection.prototype.applyCtrlHomeEndKey = function (rowIndex, cellIndex) {\n        if (this.isRowType()) {\n            this.selectRow(rowIndex, true);\n            if (!(this.parent.enableVirtualization || this.parent.enableColumnVirtualization)) {\n                this.addAttribute(this.parent.getCellFromIndex(rowIndex, cellIndex));\n            }\n        }\n        if (this.isCellType()) {\n            this.selectCell({ rowIndex: rowIndex, cellIndex: cellIndex }, true);\n        }\n    };\n    Selection.prototype.addRemoveClassesForRow = function (row, isAdd, clearAll) {\n        var args = [];\n        for (var _i = 3; _i < arguments.length; _i++) {\n            args[_i - 3] = arguments[_i];\n        }\n        if (row) {\n            var cells = [].slice.call(row.getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell));\n            var detailIndentCell = row.querySelector('.e-detailrowcollapse') || row.querySelector('.e-detailrowexpand');\n            var dragdropIndentCell = row.querySelector('.e-rowdragdrop');\n            if (detailIndentCell) {\n                cells.push(detailIndentCell);\n            }\n            if (dragdropIndentCell) {\n                cells.push(dragdropIndentCell);\n            }\n            _base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveActiveClasses.apply(void 0, [cells, isAdd].concat(args));\n        }\n        this.getRenderer().setSelection(row ? row.getAttribute('data-uid') : null, isAdd, clearAll);\n    };\n    Selection.prototype.isRowType = function () {\n        return this.selectionSettings.mode === 'Row' || this.selectionSettings.mode === 'Both';\n    };\n    Selection.prototype.isCellType = function () {\n        return this.selectionSettings.mode === 'Cell' || this.selectionSettings.mode === 'Both';\n    };\n    Selection.prototype.isSingleSel = function () {\n        return this.selectionSettings.type === 'Single';\n    };\n    Selection.prototype.getRenderer = function () {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.contentRenderer)) {\n            this.contentRenderer = this.factory.getRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_5__.RenderType.Content);\n        }\n        return this.contentRenderer;\n    };\n    /**\n     * Gets the collection of selected records.\n     *\n     * @returns {Object[]} returns the Object\n     */\n    Selection.prototype.getSelectedRecords = function () {\n        var selectedData = [];\n        if (!this.selectionSettings.persistSelection && this.selectedRecords.length) {\n            selectedData = this.parent.getRowsObject().filter(function (row) { return row.isSelected; })\n                .map(function (m) { return m.data; });\n        }\n        else {\n            selectedData = this.persistSelectedData;\n        }\n        if (this.checkVirtualCheckBox() && !this.parent.isPersistSelection) {\n            selectedData = this.virtualSelectedData;\n        }\n        return selectedData;\n    };\n    /**\n     * Select the column by passing start column index\n     *\n     * @param {number} index - specifies the index\n     * @returns {void}\n     */\n    Selection.prototype.selectColumn = function (index) {\n        var gObj = this.parent;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.getColumns()[parseInt(index.toString(), 10)])) {\n            return;\n        }\n        var column = gObj.getColumnByIndex(index);\n        var selectedCol = gObj.getColumnHeaderByUid(column.uid);\n        var isColSelected = selectedCol.classList.contains('e-columnselection');\n        if ((!gObj.selectionSettings.allowColumnSelection)) {\n            return;\n        }\n        var isMultiColumns = this.selectedColumnsIndexes.length > 1 &&\n            this.selectedColumnsIndexes.indexOf(index) > -1;\n        this.clearColDependency();\n        if (!this.selectionSettings.enableToggle || isMultiColumns || !isColSelected) {\n            var args = {\n                columnIndex: index, headerCell: selectedCol,\n                column: column,\n                cancel: false, target: this.actualTarget,\n                isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex,\n                isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest\n            };\n            this.onActionBegin(args, _base_constant__WEBPACK_IMPORTED_MODULE_3__.columnSelecting);\n            if (args.cancel) {\n                this.disableInteracted();\n                return;\n            }\n            if (isMultiColumns || !(isColSelected && gObj.selectionSettings.enableToggle && index === this.prevColIndex)) {\n                this.updateColSelection(selectedCol, index);\n            }\n            var selectedArgs = {\n                columnIndex: index, headerCell: selectedCol,\n                column: column,\n                target: this.actualTarget,\n                isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex\n            };\n            this.onActionComplete(selectedArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.columnSelected);\n        }\n        this.updateColProps(index);\n    };\n    /**\n     * Select the columns by passing start and end column index\n     *\n     * @param  {number} startIndex - specifies the start index\n     * @param  {number} endIndex - specifies the end index\n     * @returns {void}\n     */\n    Selection.prototype.selectColumnsByRange = function (startIndex, endIndex) {\n        var gObj = this.parent;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.getColumns()[parseInt(startIndex.toString(), 10)])) {\n            return;\n        }\n        var indexes = [];\n        if (gObj.selectionSettings.type === 'Single' || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(endIndex)) {\n            indexes[0] = startIndex;\n        }\n        else {\n            var min = startIndex < endIndex;\n            for (var i = startIndex; min ? i <= endIndex : i >= endIndex; min ? i++ : i--) {\n                indexes.push(i);\n            }\n        }\n        this.selectColumns(indexes);\n    };\n    /**\n     * Select the columns by passing column indexes\n     *\n     * @param  {number[]} columnIndexes - specifies the columnIndexes\n     * @returns {void}\n     */\n    Selection.prototype.selectColumns = function (columnIndexes) {\n        var gObj = this.parent;\n        var selectedCol = this.getselectedCols();\n        if (gObj.selectionSettings.type === 'Single') {\n            columnIndexes = [columnIndexes[0]];\n        }\n        if (!gObj.selectionSettings.allowColumnSelection) {\n            return;\n        }\n        this.clearColDependency();\n        var selectingArgs = {\n            columnIndex: columnIndexes[0], headerCell: selectedCol,\n            columnIndexes: columnIndexes,\n            column: gObj.getColumnByIndex(columnIndexes[0]),\n            cancel: false, target: this.actualTarget,\n            isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex,\n            isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest\n        };\n        this.onActionBegin(selectingArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.columnSelecting);\n        if (selectingArgs.cancel) {\n            this.disableInteracted();\n            return;\n        }\n        for (var i = 0, len = columnIndexes.length; i < len; i++) {\n            this.updateColSelection(gObj.getColumnHeaderByUid(gObj.getColumnByIndex(columnIndexes[parseInt(i.toString(), 10)]).uid), columnIndexes[parseInt(i.toString(), 10)]);\n        }\n        selectedCol = this.getselectedCols();\n        var selectedArgs = {\n            columnIndex: columnIndexes[0], headerCell: selectedCol,\n            columnIndexes: columnIndexes,\n            column: gObj.getColumnByIndex(columnIndexes[0]),\n            target: this.actualTarget,\n            isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex\n        };\n        this.onActionComplete(selectedArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.columnSelected);\n        this.updateColProps(columnIndexes[0]);\n    };\n    /**\n     * Select the column with existing column by passing column index\n     *\n     * @param  {number} startIndex - specifies the start index\n     * @returns {void}\n     */\n    Selection.prototype.selectColumnWithExisting = function (startIndex) {\n        var gObj = this.parent;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.getColumns()[parseInt(startIndex.toString(), 10)])) {\n            return;\n        }\n        var newCol = gObj.getColumnHeaderByUid(gObj.getColumnByIndex(startIndex).uid);\n        var selectedCol = this.getselectedCols();\n        if (gObj.selectionSettings.type === 'Single') {\n            this.clearColDependency();\n        }\n        if (!gObj.selectionSettings.allowColumnSelection) {\n            return;\n        }\n        if (this.selectedColumnsIndexes.indexOf(startIndex) > -1) {\n            this.clearColumnSelection(startIndex);\n        }\n        else {\n            var selectingArgs = {\n                columnIndex: startIndex, headerCell: selectedCol,\n                columnIndexes: this.selectedColumnsIndexes,\n                column: gObj.getColumnByIndex(startIndex),\n                cancel: false, target: this.actualTarget,\n                isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex,\n                isCtrlPressed: this.isMultiCtrlRequest, isShiftPressed: this.isMultiShiftRequest\n            };\n            this.onActionBegin(selectingArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.columnSelecting);\n            if (selectingArgs.cancel) {\n                this.disableInteracted();\n                return;\n            }\n            this.updateColSelection(newCol, startIndex);\n            selectedCol = this.getselectedCols();\n            var selectedArgs = {\n                columnIndex: startIndex, headerCell: selectedCol,\n                column: gObj.getColumnByIndex(startIndex),\n                columnIndexes: this.selectedColumnsIndexes,\n                target: this.actualTarget,\n                isInteracted: this.isInteracted, previousColumnIndex: this.prevColIndex\n            };\n            this.onActionComplete(selectedArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.columnSelected);\n        }\n        this.updateColProps(startIndex);\n    };\n    /**\n     * Clear the column selection\n     *\n     * @param {number} clearIndex - specifies the clearIndex\n     * @returns {void}\n     */\n    Selection.prototype.clearColumnSelection = function (clearIndex) {\n        if (this.isColumnSelected) {\n            var gObj = this.parent;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(clearIndex) && this.selectedColumnsIndexes.indexOf(clearIndex) === -1) {\n                return;\n            }\n            var index = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(clearIndex) ? clearIndex :\n                this.selectedColumnsIndexes[this.selectedColumnsIndexes.length - 1];\n            var column = gObj.getColumnByIndex(index);\n            var selectedCol = gObj.getColumnHeaderByUid(column.uid);\n            var deselectedArgs = {\n                columnIndex: index, headerCell: selectedCol,\n                columnIndexes: this.selectedColumnsIndexes,\n                column: column,\n                cancel: false, target: this.actualTarget,\n                isInteracted: this.isInteracted\n            };\n            var isCanceled = this.columnDeselect(deselectedArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.columnDeselecting);\n            if (isCanceled) {\n                this.disableInteracted();\n                return;\n            }\n            var selectedHeader = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(clearIndex) ? [selectedCol] :\n                [].slice.call(gObj.getHeaderContent().getElementsByClassName('e-columnselection'));\n            var selectedCells = this.getSelectedColumnCells(clearIndex);\n            for (var i = 0, len = selectedHeader.length; i < len; i++) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveActiveClasses)([selectedHeader[parseInt(i.toString(), 10)]], false, 'e-columnselection');\n            }\n            for (var i = 0, len = selectedCells.length; i < len; i++) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveActiveClasses)([selectedCells[parseInt(i.toString(), 10)]], false, 'e-columnselection');\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(clearIndex)) {\n                this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(clearIndex), 1);\n                this.parent.getColumns()[parseInt(clearIndex.toString(), 10)].isSelected = false;\n            }\n            else {\n                this.columnDeselect(deselectedArgs, _base_constant__WEBPACK_IMPORTED_MODULE_3__.columnDeselected);\n                this.selectedColumnsIndexes = [];\n                this.isColumnSelected = false;\n                this.parent.getColumns().filter(function (col) { return col.isSelected = false; });\n            }\n        }\n    };\n    Selection.prototype.getselectedCols = function () {\n        var gObj = this.parent;\n        var selectedCol;\n        if (this.selectedColumnsIndexes.length > 1) {\n            selectedCol = [];\n            for (var i = 0; i < this.selectedColumnsIndexes.length; i++) {\n                (selectedCol).push(gObj.getColumnHeaderByUid(gObj.getColumnByIndex(this.selectedColumnsIndexes[parseInt(i.toString(), 10)]).uid));\n            }\n        }\n        else {\n            selectedCol = gObj.getColumnHeaderByUid(gObj.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);\n        }\n        return selectedCol;\n    };\n    Selection.prototype.getSelectedColumnCells = function (clearIndex) {\n        var gObj = this.parent;\n        var isRowTemplate = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.rowTemplate);\n        var rows = isRowTemplate ? gObj.getRows() : gObj.getDataRows();\n        var seletedcells = [];\n        var selectionString = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(clearIndex) ? '[aria-colindex=\"' + (clearIndex + 1) + '\"]' : '.e-columnselection';\n        for (var i = 0, len = rows.length; i < len; i++) {\n            seletedcells = seletedcells.concat([].slice.call(rows[parseInt(i.toString(), 10)].querySelectorAll(selectionString)));\n        }\n        return seletedcells;\n    };\n    Selection.prototype.columnDeselect = function (args, event) {\n        if (event === 'columnDeselected') {\n            delete args.cancel;\n        }\n        this.onActionComplete(args, event);\n        return args.cancel;\n    };\n    Selection.prototype.updateColProps = function (startIndex) {\n        this.prevColIndex = startIndex;\n        this.isColumnSelected = this.selectedColumnsIndexes.length && true;\n    };\n    Selection.prototype.clearColDependency = function () {\n        this.clearColumnSelection();\n        this.selectedColumnsIndexes = [];\n    };\n    Selection.prototype.updateColSelection = function (selectedCol, startIndex) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.getColumns()[parseInt(startIndex.toString(), 10)])) {\n            return;\n        }\n        var isRowTemplate = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.rowTemplate);\n        var rows = isRowTemplate ? this.parent.getRows() : this.parent.getDataRows();\n        this.selectedColumnsIndexes.push(startIndex);\n        this.parent.getColumns()[parseInt(startIndex.toString(), 10)].isSelected = true;\n        startIndex = startIndex + this.parent.getIndentCount();\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveActiveClasses)([selectedCol], true, 'e-columnselection');\n        for (var j = 0, len = rows.length; j < len; j++) {\n            if (rows[parseInt(j.toString(), 10)].classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.row)) {\n                if ((rows[parseInt(j.toString(), 10)].classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.editedRow)\n                    || rows[parseInt(j.toString(), 10)].classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.addedRow))\n                    && this.parent.editSettings.mode === 'Normal'\n                    && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(rows[parseInt(j.toString(), 10)].querySelector('tr').childNodes[parseInt(startIndex.toString(), 10)])) {\n                    (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveActiveClasses)([rows[parseInt(j.toString(), 10)].querySelector('tr').childNodes[parseInt(startIndex.toString(), 10)]], true, 'e-columnselection');\n                }\n                else {\n                    if (this.parent.isSpan && this.parent.isFrozenGrid()) {\n                        var cells = rows[parseInt(j.toString(), 10)].querySelectorAll('.e-rowcell');\n                        for (var i = 0; i < cells.length; i++) {\n                            if (cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex') === selectedCol.getAttribute('aria-colindex')) {\n                                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveActiveClasses)([cells[parseInt(i.toString(), 10)]], true, 'e-columnselection');\n                            }\n                        }\n                    }\n                    else if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(rows[parseInt(j.toString(), 10)].childNodes[parseInt(startIndex.toString(), 10)])) {\n                        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveActiveClasses)([rows[parseInt(j.toString(), 10)].childNodes[parseInt(startIndex.toString(), 10)]], true, 'e-columnselection');\n                    }\n                }\n            }\n        }\n    };\n    Selection.prototype.headerSelectionHandler = function (colIndex) {\n        if ((!this.isMultiCtrlRequest && !this.isMultiShiftRequest) || this.isSingleSel()) {\n            this.selectColumn(colIndex);\n        }\n        else if (this.isMultiShiftRequest) {\n            this.selectColumnsByRange((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(this.prevColIndex) ? colIndex : this.prevColIndex, colIndex);\n        }\n        else {\n            this.selectColumnWithExisting(colIndex);\n        }\n    };\n    // eslint-disable-next-line camelcase\n    Selection.prototype.addEventListener_checkbox = function () {\n        var _this = this;\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.dataReady, this.dataReady, this);\n        this.onDataBoundFunction = this.onDataBound.bind(this);\n        this.parent.addEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.dataBound, this.onDataBoundFunction);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.refreshInfinitePersistSelection, this.onDataBoundFunction);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.contentReady, this.checkBoxSelectionChanged, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.beforeRefreshOnDataChange, this.initPerisistSelection, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.onEmpty, this.setCheckAllForEmptyGrid, this);\n        this.actionCompleteFunc = this.actionCompleteHandler.bind(this);\n        this.parent.addEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionComplete, this.actionCompleteFunc);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.click, this.clickHandler, this);\n        this.resizeEndFn = function () {\n            _this.updateAutoFillPosition();\n            _this.drawBorders();\n        };\n        this.resizeEndFn.bind(this);\n        this.parent.addEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.resizeStop, this.resizeEndFn);\n    };\n    // eslint-disable-next-line camelcase\n    Selection.prototype.removeEventListener_checkbox = function () {\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.dataReady, this.dataReady);\n        this.parent.removeEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.dataBound, this.onDataBoundFunction);\n        this.parent.removeEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionComplete, this.actionCompleteFunc);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.refreshInfinitePersistSelection, this.onDataBoundFunction);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.onEmpty, this.setCheckAllForEmptyGrid);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.click, this.clickHandler);\n        this.parent.removeEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_3__.resizeStop, this.resizeEndFn);\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_3__.beforeRefreshOnDataChange, this.initPerisistSelection);\n    };\n    Selection.prototype.setCheckAllForEmptyGrid = function () {\n        var checkAllBox = this.getCheckAllBox();\n        if (checkAllBox) {\n            this.parent.isCheckBoxSelection = true;\n            var spanEle = checkAllBox.nextElementSibling;\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([spanEle], ['e-check', 'e-stop', 'e-uncheck']);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([spanEle.parentElement], ['e-checkbox-disabled']);\n        }\n    };\n    Selection.prototype.dataReady = function (e) {\n        this.isHeaderCheckboxClicked = false;\n        var isInfinitecroll = this.parent.enableInfiniteScrolling && e.requestType === 'infiniteScroll';\n        if (e.requestType !== 'virtualscroll' && !this.parent.isPersistSelection && !isInfinitecroll) {\n            this.disableUI = !this.parent.enableImmutableMode && !(e.requestType === 'save' && e['action'] === 'add');\n            this.clearSelection();\n            this.setCheckAllState();\n            this.disableUI = false;\n        }\n    };\n    Selection.prototype.actionCompleteHandler = function (e) {\n        if (e.requestType === 'save' && this.parent.isPersistSelection) {\n            this.refreshPersistSelection();\n        }\n    };\n    Selection.prototype.selectRowIndex = function (index) {\n        this.parent.isSelectedRowIndexUpdating = true;\n        if (((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.selectedRowIndex) || this.parent.selectedRowIndex === -1) || !this.parent.enablePersistence) {\n            this.parent.selectedRowIndex = index;\n        }\n        else {\n            this.parent.selectedRowIndex = -1;\n        }\n    };\n    Selection.prototype.disableInteracted = function () {\n        this.isInteracted = false;\n    };\n    Selection.prototype.activeTarget = function () {\n        this.actualTarget = this.isInteracted ? this.actualTarget : null;\n    };\n    return Selection;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL3NlbGVjdGlvbi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQTRFO0FBQ2lCO0FBQzlCO0FBQ1o7QUFDMEY7QUFDekQ7QUFDekM7QUFDRDtBQUMwQztBQUM5QjtBQUNGO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsbUJBQW1CO0FBQ2xDLGVBQWUsZ0JBQWdCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsdUVBQWlCLHFCQUFxQix1RUFBaUI7QUFDL0Ysd0NBQXdDLHVF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Q0FBc0MsaUVBQVc7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixxREFBZ0I7QUFDdkM7QUFDQSxxQ0FBcUMscURBQWdCO0FBQ3JELHVCQUF1QiwyRUFBc0M7QUFDN0QsdUJBQXVCLHdEQUFtQjtBQUMxQyx1QkFBdUIscUVBQWdDO0FBQ3ZELHVCQUF1QixtREFBYztBQUNyQztBQUNBLHFDQUFxQywwREFBcUI7QUFDMUQsdUJBQXVCLGlEQUFZO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsc0RBQWlCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixxREFBZ0I7QUFDeEMsd0NBQXdDLHFEQUFnQjtBQUN4RCx3Q0FBd0MsMERBQXFCO0FBQzdELHdCQUF3QiwyRUFBc0M7QUFDOUQsd0JBQXdCLG1EQUFjO0FBQ3RDLHdCQUF3QixpREFBWTtBQUNwQyx3Q0FBd0Msc0RBQWlCO0FBQ3pELHdCQUF3QixxRUFBZ0M7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxpRUFBVztBQUN2QixZQUFZLDhEQUFRO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1RUFBaUI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ29CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvYWN0aW9ucy9zZWxlY3Rpb24uanM/NTZjZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCcm93c2VyLCBFdmVudEhhbmRsZXIsIGNyZWF0ZUVsZW1lbnQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBpc051bGxPclVuZGVmaW5lZCwgaXNVbmRlZmluZWQsIGFkZENsYXNzLCByZW1vdmVDbGFzcyB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IHJlbW92ZSwgY2xvc2VzdCwgc2VsZWN0IH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgRGF0YU1hbmFnZXIgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItZGF0YSc7XG5pbXBvcnQgeyBzZXRDc3NJbkdyaWRQb3BVcCwgZ2V0UG9zaXRpb24sIGlzR3JvdXBBZGFwdGl2ZSwgYWRkUmVtb3ZlQWN0aXZlQ2xhc3NlcywgcmVtb3ZlQWRkQ2JveENsYXNzZXMsIGdldENlbGxGcm9tUm93IH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbmltcG9ydCB7IGdldENlbGxzQnlUYWJsZU5hbWUsIHBhcmVudHNVbnRpbCwgZ2V0U2Nyb2xsQmFyV2lkdGggfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0ICogYXMgZXZlbnRzIGZyb20gJy4uL2Jhc2UvY29uc3RhbnQnO1xuaW1wb3J0IHsgUmVuZGVyVHlwZSB9IGZyb20gJy4uL2Jhc2UvZW51bSc7XG5pbXBvcnQgeyBpdGVyYXRlRXh0ZW5kLCBzZXRDaGVja2VkLCBpc0NvbXBsZXhGaWVsZCwgZ2V0T2JqZWN0IH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbmltcG9ydCB7IGFkZFJlbW92ZUV2ZW50TGlzdGVuZXIgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0ICogYXMgbGl0ZXJhbHMgZnJvbSAnLi4vYmFzZS9zdHJpbmctbGl0ZXJhbHMnO1xuLyoqXG4gKiBUaGUgYFNlbGVjdGlvbmAgbW9kdWxlIGlzIHVzZWQgdG8gaGFuZGxlIGNlbGwgYW5kIHJvdyBzZWxlY3Rpb24uXG4gKi9cbnZhciBTZWxlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IgZm9yIHRoZSBHcmlkIHNlbGVjdGlvbiBtb2R1bGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7SUdyaWR9IHBhcmVudCAtIHNwZWNpZmllcyB0aGUgSUdyaWRcbiAgICAgKiBAcGFyYW0ge1NlbGVjdGlvblNldHRpbmdzfSBzZWxlY3Rpb25TZXR0aW5ncyAtIHNwZWNpZmllcyB0aGUgc2VsZWN0aW9uc2V0dGluZ3NcbiAgICAgKiBAcGFyYW0ge1NlcnZpY2VMb2NhdG9yfSBsb2NhdG9yIC0gc3BlY2lmaWVzIHRoZSBTZXJ2aWNlTG9jYXRvclxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTZWxlY3Rpb24ocGFyZW50LCBzZWxlY3Rpb25TZXR0aW5ncywgbG9jYXRvcikge1xuICAgICAgICAvL0ludGVybmFsIGxldGlhYmxlc1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZWxlY3RlZFJlY29yZHMgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucHJldmVudEZvY3VzID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiAgQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZWxlY3RlZENvbHVtbnNJbmRleGVzID0gW107XG4gICAgICAgIHRoaXMuY2hlY2tCb3hTdGF0ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzTXVsdGlTaGlmdFJlcXVlc3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc011bHRpQ3RybFJlcXVlc3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc011bHRpQ3RybFJlcXVlc3RDZWxsID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZW5hYmxlU2VsZWN0TXVsdGlUb3VjaCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNsZWFyUm93Q2hlY2sgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZWxlY3RSb3dDaGVjayA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlID0ge307XG4gICAgICAgIHRoaXMudW5TZWxlY3RlZFJvd1N0YXRlID0ge307XG4gICAgICAgIHRoaXMudG90YWxSZWNvcmRzQ291bnQgPSAwO1xuICAgICAgICB0aGlzLmNoa0FsbENvbGxlYyA9IFtdO1xuICAgICAgICB0aGlzLmlzQ2hlY2tlZE9uQWRkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGVyc2lzdFNlbGVjdGVkRGF0YSA9IFtdO1xuICAgICAgICB0aGlzLnZpcnR1YWxTZWxlY3RlZERhdGEgPSBbXTtcbiAgICAgICAgdGhpcy5kZVNlbGVjdGVkRGF0YSA9IFtdO1xuICAgICAgICB0aGlzLmlzSGRyU2VsZWN0QWxsQ2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm5lZWRDb2x1bW5TZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc0NhbmNlbERlU2VsZWN0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNQcmV2ZW50Q2VsbFNlbGVjdCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRpc2FibGVVSSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzUGVyc2lzdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY21kS2V5UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNlbGxzZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzTXVsdGlTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc0FkZFJvd3NUb1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLmluaXRpYWxSb3dTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc1ByZXZSb3dTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc0tleUFjdGlvbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzUm93RHJhZ1NlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMucm10SGRyQ2hrYnhDbGlja2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNDaGVja2JveFJlc2V0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNSb3dEZXNlbGVjdCA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hdXRvRmlsbFJMc2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5pc0ZvY3VzTGFzdENlbGwgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5ib3R0b20gPSAnMCAwIDJweCAwJztcbiAgICAgICAgdGhpcy50b3AgPSAnMnB4IDAgMCAwJztcbiAgICAgICAgLyogZXNsaW50LWRpc2FibGUgKi9cbiAgICAgICAgdGhpcy5yaWdodF9ib3R0b20gPSAnMCAycHggMnB4IDAnO1xuICAgICAgICB0aGlzLmJvdHRvbV9sZWZ0ID0gJzAgMCAycHggMnB4JztcbiAgICAgICAgdGhpcy50b3BfcmlnaHQgPSAnMnB4IDJweCAwIDAnO1xuICAgICAgICB0aGlzLnRvcF9sZWZ0ID0gJzJweCAwIDAgMnB4JztcbiAgICAgICAgdGhpcy50b3BfYm90dG9tID0gJzJweCAwIDJweCAwJztcbiAgICAgICAgdGhpcy50b3BfcmlnaHRfYm90dG9tID0gJzJweCAycHggMnB4IDAnO1xuICAgICAgICB0aGlzLnRvcF9ib3R0b21fbGVmdCA9ICcycHggMCAycHggMnB4JztcbiAgICAgICAgdGhpcy50b3BfcmlnaHRfbGVmdCA9ICcycHggMnB4IDAgMnB4JztcbiAgICAgICAgdGhpcy5yaWdodF9ib3R0b21fbGVmdCA9ICcwIDJweCAycHggMnB4JztcbiAgICAgICAgdGhpcy5hbGxfYm9yZGVyID0gJzJweCc7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLnNlbGVjdGlvblNldHRpbmdzID0gc2VsZWN0aW9uU2V0dGluZ3M7XG4gICAgICAgIHRoaXMuZmFjdG9yeSA9IGxvY2F0b3IuZ2V0U2VydmljZSgncmVuZGVyZXJGYWN0b3J5Jyk7XG4gICAgICAgIHRoaXMuZm9jdXMgPSBsb2NhdG9yLmdldFNlcnZpY2UoJ2ZvY3VzJyk7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigpO1xuICAgICAgICB0aGlzLndpcmVFdmVudHMoKTtcbiAgICB9XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5pbml0aWFsaXplU2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnBhcmVudC5sb2coJ3NlbGVjdGlvbl9rZXlfbWlzc2luZycpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIHVzZWQgdG8gdHJpZ2dlciBvbkFjdGlvbkJlZ2luXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gYXJncyAtIHNwZWNpZmllcyB0aGUgYXJnc1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gc3BlY2lmaWVzIHRoZSB0eXBlXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUub25BY3Rpb25CZWdpbiA9IGZ1bmN0aW9uIChhcmdzLCB0eXBlKSB7XG4gICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIodHlwZSwgdGhpcy5mRGF0YVVwZGF0ZShhcmdzKSk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmZEYXRhVXBkYXRlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzTXVsdGlTZWxlY3Rpb24gJiYgKCFpc051bGxPclVuZGVmaW5lZChhcmdzLmNlbGxJbmRleCkgfHwgIWlzTnVsbE9yVW5kZWZpbmVkKGFyZ3Mucm93SW5kZXgpKSkge1xuICAgICAgICAgICAgdmFyIHJvd09iaiA9IHRoaXMuZ2V0Um93T2JqKGlzTnVsbE9yVW5kZWZpbmVkKGFyZ3Mucm93SW5kZXgpID8gaXNOdWxsT3JVbmRlZmluZWQoYXJncy5jZWxsSW5kZXgpID9cbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA6IGFyZ3MuY2VsbEluZGV4LnJvd0luZGV4IDogYXJncy5yb3dJbmRleCk7XG4gICAgICAgICAgICBhcmdzLmZvcmVpZ25LZXlEYXRhID0gcm93T2JqLmZvcmVpZ25LZXlEYXRhO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcmdzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIHVzZWQgdG8gdHJpZ2dlciBvbkFjdGlvbkNvbXBsZXRlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gYXJncyAtIHNwZWNpZmllcyB0aGUgYXJnc1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gc3BlY2lmaWVzIHRoZSB0eXBlXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUub25BY3Rpb25Db21wbGV0ZSA9IGZ1bmN0aW9uIChhcmdzLCB0eXBlKSB7XG4gICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIodHlwZSwgdGhpcy5mRGF0YVVwZGF0ZShhcmdzKSk7XG4gICAgICAgIHRoaXMuaXNNdWx0aVNlbGVjdGlvbiA9IGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRm9yIGludGVybmFsIHVzZSBvbmx5IC0gR2V0IHRoZSBtb2R1bGUgbmFtZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgdGhlIG1vZHVsZSBuYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmdldE1vZHVsZU5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnc2VsZWN0aW9uJztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRvIGRlc3Ryb3kgdGhlIHNlbGVjdGlvblxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdyaWRFbGVtZW50ID0gdGhpcy5wYXJlbnQuZWxlbWVudDtcbiAgICAgICAgaWYgKCFncmlkRWxlbWVudCB8fCAoIWdyaWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZEhlYWRlcikgJiYgIWdyaWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZENvbnRlbnQpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGlkZVBvcFVwKCk7XG4gICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5kZXN0cm95QXV0b0ZpbGxFbGVtZW50cygpO1xuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICAgICAgdGhpcy51bldpcmVFdmVudHMoKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLnBhcmVudC5nZXRDb250ZW50KCksICdtb3VzZWRvd24nLCB0aGlzLm1vdXNlRG93bkhhbmRsZXIpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMucGFyZW50LmdldEhlYWRlckNvbnRlbnQoKSwgJ21vdXNlZG93bicsIHRoaXMubW91c2VEb3duSGFuZGxlcik7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmlzRWRpdGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ05vcm1hbCcgfHwgKHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5tb2RlID09PSAnQmF0Y2gnICYmIHRoaXMucGFyZW50LmVkaXRNb2R1bGUgJiZcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmVkaXRNb2R1bGUuZm9ybU9iaiAmJiAhdGhpcy5wYXJlbnQuZWRpdE1vZHVsZS5mb3JtT2JqLnZhbGlkYXRlKCkpKSAmJlxuICAgICAgICAgICAgKHRoaXMucGFyZW50LmlzRWRpdCAmJiAhdGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cpICYmICF0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb247XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmdldEN1cnJlbnRCYXRjaFJlY29yZENoYW5nZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChnT2JqLmVkaXRTZXR0aW5ncy5tb2RlID09PSAnQmF0Y2gnICYmIGdPYmouZWRpdE1vZHVsZSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSZWNvcmRzID0gaXRlcmF0ZUV4dGVuZCh0aGlzLnBhcmVudC5nZXRDdXJyZW50Vmlld1JlY29yZHMoKSk7XG4gICAgICAgICAgICBjdXJyZW50UmVjb3JkcyA9IGdPYmouZWRpdFNldHRpbmdzLm5ld1Jvd1Bvc2l0aW9uID09PSAnQm90dG9tJyA/XG4gICAgICAgICAgICAgICAgY3VycmVudFJlY29yZHMuY29uY2F0KHRoaXMucGFyZW50LmVkaXRNb2R1bGUuZ2V0QmF0Y2hDaGFuZ2VzKClbbGl0ZXJhbHMuYWRkZWRSZWNvcmRzXSkgOlxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmVkaXRNb2R1bGUuZ2V0QmF0Y2hDaGFuZ2VzKClbbGl0ZXJhbHMuYWRkZWRSZWNvcmRzXS5jb25jYXQoY3VycmVudFJlY29yZHMpO1xuICAgICAgICAgICAgdmFyIGRlbGV0ZWRSZWNvcmRzID0gdGhpcy5wYXJlbnQuZWRpdE1vZHVsZS5nZXRCYXRjaENoYW5nZXMoKVtsaXRlcmFscy5kZWxldGVkUmVjb3Jkc107XG4gICAgICAgICAgICB2YXIgcHJpbWFyeUtleSA9IHRoaXMucGFyZW50LmdldFByaW1hcnlLZXlGaWVsZE5hbWVzKClbMF07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IChkZWxldGVkUmVjb3Jkcy5sZW5ndGgpOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGN1cnJlbnRSZWNvcmRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZWxldGVkUmVjb3Jkc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIHByaW1hcnlLZXldID09PSBjdXJyZW50UmVjb3Jkc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIHByaW1hcnlLZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmVjb3Jkcy5zcGxpY2UoaiwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50UmVjb3JkcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICYmICF0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEdyb3VwZWREYXRhID0gZ09iai5nZXRDdXJyZW50Vmlld1JlY29yZHMoKS5maWx0ZXIoZnVuY3Rpb24gKGNvbCkgeyByZXR1cm4gY29sWydrZXknXSA9PT0gdW5kZWZpbmVkOyB9KTtcbiAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZEdyb3VwZWREYXRhO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGdPYmouZ2V0Q3VycmVudFZpZXdSZWNvcmRzKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNlbGVjdHMgYSByb3cgYnkgdGhlIGdpdmVuIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBpbmRleCAtIERlZmluZXMgdGhlIHJvdyBpbmRleC5cbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBpc1RvZ2dsZSAtIElmIHNldCB0byB0cnVlLCB0aGVuIGl0IHRvZ2dsZXMgdGhlIHNlbGVjdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnNlbGVjdFJvdyA9IGZ1bmN0aW9uIChpbmRleCwgaXNUb2dnbGUpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmxlbmd0aCAmJiB0aGlzLnNlbGVjdGlvblNldHRpbmdzLmVuYWJsZVNpbXBsZU11bHRpUm93U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmFkZFJvd3NUb1NlbGVjdGlvbihbaW5kZXhdKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgc2VsZWN0ZWRSb3cgPSBnT2JqLmdldFJvd0J5SW5kZXgoaW5kZXgpO1xuICAgICAgICB2YXIgcm93T2JqID0gc2VsZWN0ZWRSb3cgJiYgZ09iai5nZXRSb3dPYmplY3RGcm9tVUlEKHNlbGVjdGVkUm93LmdldEF0dHJpYnV0ZSgnZGF0YS11aWQnKSk7XG4gICAgICAgIGlmICh0aGlzLmlzUGFydGlhbFNlbGVjdGlvbiAmJiByb3dPYmogJiYgcm93T2JqLmlzRGF0YVJvdyAmJiAhcm93T2JqLmlzU2VsZWN0YWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWxlY3REYXRhO1xuICAgICAgICB2YXIgaXNSZW1vdmVkID0gZmFsc2U7XG4gICAgICAgIGlmIChnT2JqLmVuYWJsZVZpcnR1YWxpemF0aW9uICYmIGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgIHZhciBlID0geyBzZWxlY3RlZEluZGV4OiBpbmRleCwgaXNBdmFpbGFibGU6IHRydWUgfTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMuc2VsZWN0VmlydHVhbFJvdywgZSk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRSb3cgJiYgKGdPYmouZ2V0Um93T2JqZWN0RnJvbVVJRChzZWxlY3RlZFJvdy5nZXRBdHRyaWJ1dGUoJ2RhdGEtdWlkJykpKSkge1xuICAgICAgICAgICAgICAgIHNlbGVjdERhdGEgPSBnT2JqLmdldFJvd09iamVjdEZyb21VSUQoc2VsZWN0ZWRSb3cuZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpKS5kYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGUuaXNBdmFpbGFibGUgJiYgIWdPYmouc2VsZWN0aW9uU2V0dGluZ3MucGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJldlNlbGVjdGVkRGF0YSA9IHRoaXMucGFyZW50LmdldFNlbGVjdGVkUmVjb3JkcygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJldlNlbGVjdGVkRGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyUm93U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VsZWN0RGF0YSA9IHRoaXMuZ2V0Um93T2JqKGluZGV4KS5kYXRhO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5pc1Jvd1R5cGUoKSB8fCAhc2VsZWN0ZWRSb3cgfHwgdGhpcy5pc0VkaXRpbmcoKSkge1xuICAgICAgICAgICAgLy8gaWYgKHRoaXMuaXNFZGl0aW5nKCkpIHtcbiAgICAgICAgICAgIC8vICAgICBnT2JqLnNlbGVjdGVkUm93SW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNSb3dTZWxlY3RlZCA9IHNlbGVjdGVkUm93Lmhhc0F0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcpO1xuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldCgpO1xuICAgICAgICBpZiAoIWlzVG9nZ2xlIHx8ICF0aGlzLnNlbGVjdGVkUm93SW5kZXhlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlzVG9nZ2xlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgaXNDaGVja2JveE1vZGVSZXNldE9uUm93Q2xpY2sgPSB0aGlzLnNlbGVjdGlvblNldHRpbmdzLmNoZWNrYm94TW9kZSA9PT0gJ1Jlc2V0T25Sb3dDbGljayc7XG4gICAgICAgICAgICB2YXIgaXNTZWxlY3Rpb25UeXBlTXVsdGlwbGUgPSAhdGhpcy5wYXJlbnQuaXNDaGVja0JveFNlbGVjdGlvbiAmJiB0aGlzLnNlbGVjdGlvblNldHRpbmdzLnR5cGUgPT09ICdNdWx0aXBsZSc7XG4gICAgICAgICAgICBpZiAoKCFpc0NoZWNrYm94TW9kZVJlc2V0T25Sb3dDbGljayAmJiAhaXNTZWxlY3Rpb25UeXBlTXVsdGlwbGUpIHx8XG4gICAgICAgICAgICAgICAgKHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmxlbmd0aCA9PT0gMSAmJiAoaXNDaGVja2JveE1vZGVSZXNldE9uUm93Q2xpY2sgfHwgaXNTZWxlY3Rpb25UeXBlTXVsdGlwbGUpKSkge1xuICAgICAgICAgICAgICAgIGlzVG9nZ2xlID0gISh0aGlzLmlzS2V5QWN0aW9uICYmIHRoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb24pID8gdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMuaW5kZXhPZihpbmRleCkgIT09IC0xIDogZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc1RvZ2dsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNLZXlBY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgdmFyIGFyZ3M7XG4gICAgICAgIHZhciBjYW4gPSAnY2FuY2VsJztcbiAgICAgICAgaWYgKCFpc1RvZ2dsZSkge1xuICAgICAgICAgICAgYXJncyA9IHtcbiAgICAgICAgICAgICAgICBkYXRhOiBzZWxlY3REYXRhLCByb3dJbmRleDogaW5kZXgsIGlzQ3RybFByZXNzZWQ6IHRoaXMuaXNNdWx0aUN0cmxSZXF1ZXN0LFxuICAgICAgICAgICAgICAgIGlzU2hpZnRQcmVzc2VkOiB0aGlzLmlzTXVsdGlTaGlmdFJlcXVlc3QsIHJvdzogc2VsZWN0ZWRSb3csXG4gICAgICAgICAgICAgICAgcHJldmlvdXNSb3c6IGdPYmouZ2V0Um93QnlJbmRleCh0aGlzLnByZXZSb3dJbmRleCksXG4gICAgICAgICAgICAgICAgcHJldmlvdXNSb3dJbmRleDogdGhpcy5wcmV2Um93SW5kZXgsIHRhcmdldDogdGhpcy5hY3R1YWxUYXJnZXQsIGNhbmNlbDogZmFsc2UsIGlzSW50ZXJhY3RlZDogdGhpcy5pc0ludGVyYWN0ZWQsXG4gICAgICAgICAgICAgICAgaXNIZWFkZXJDaGVja2JveENsaWNrZWQ6IHRoaXMuaXNIZWFkZXJDaGVja2JveENsaWNrZWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5yb3dTZWxlY3RpbmcsIHRoaXMuZkRhdGFVcGRhdGUoYXJncyksIHRoaXMucm93U2VsZWN0aW5nQ2FsbEJhY2soYXJncywgaXNUb2dnbGUsIGluZGV4LCBzZWxlY3REYXRhLCBpc1JlbW92ZWQsIGlzUm93U2VsZWN0ZWQsIGNhbikpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MuY2hlY2tib3hNb2RlICE9PSAnUmVzZXRPblJvd0NsaWNrJyAmJiB0aGlzLnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJvd0Rlc2VsZWN0KGV2ZW50cy5yb3dEZXNlbGVjdGluZywgW3Jvd09iai5pbmRleF0sIFtyb3dPYmouZGF0YV0sIFtzZWxlY3RlZFJvd10sIFtyb3dPYmouZm9yZWlnbktleURhdGFdLCB0aGlzLmFjdHVhbFRhcmdldCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNDYW5jZWxEZVNlbGVjdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQuaXNDaGVja0JveFNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93SW5kZXhlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUmVjb3JkcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzUm93U2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSb3dJbmRleCgtMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucm93RGVzZWxlY3QoZXZlbnRzLnJvd0Rlc2VsZWN0ZWQsIFtyb3dPYmouaW5kZXhdLCBbcm93T2JqLmRhdGFdLCBbc2VsZWN0ZWRSb3ddLCBbcm93T2JqLmZvcmVpZ25LZXlEYXRhXSwgdGhpcy5hY3R1YWxUYXJnZXQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yb3dTZWxlY3RpbmdDYWxsQmFjayhhcmdzLCBpc1RvZ2dsZSwgaW5kZXgsIHNlbGVjdERhdGEsIGlzUmVtb3ZlZCwgaXNSb3dTZWxlY3RlZCwgY2FuKShhcmdzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5yb3dTZWxlY3RpbmdDYWxsQmFjayA9IGZ1bmN0aW9uIChhcmdzLCBpc1RvZ2dsZSwgaW5kZXgsIHNlbGVjdERhdGEsIGlzUmVtb3ZlZCwgaXNSb3dTZWxlY3RlZCwgY2FuKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChhcmdzKSAmJiBhcmdzW1wiXCIgKyBjYW5dID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuZGlzYWJsZUludGVyYWN0ZWQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgX3RoaXMudG9nZ2xlID0gaXNUb2dnbGU7XG4gICAgICAgICAgICBfdGhpcy5kYXRhID0gc2VsZWN0RGF0YTtcbiAgICAgICAgICAgIF90aGlzLnJlbW92ZWQgPSBpc1JlbW92ZWQ7XG4gICAgICAgICAgICBpZiAoaXNSb3dTZWxlY3RlZCAmJiBfdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5wZXJzaXN0U2VsZWN0aW9uICYmICEoX3RoaXMuc2VsZWN0aW9uU2V0dGluZ3MuY2hlY2tib3hNb2RlID09PSAnUmVzZXRPblJvd0NsaWNrJykpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5jbGVhclNlbGVjdGVkUm93KGluZGV4KTtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZWxlY3RSb3dDYWxsQmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIWlzUm93U2VsZWN0ZWQgJiYgX3RoaXMuc2VsZWN0aW9uU2V0dGluZ3MucGVyc2lzdFNlbGVjdGlvbiAmJiBfdGhpcy5wYXJlbnQuaXNDaGVja0JveFNlbGVjdGlvbiAmJlxuICAgICAgICAgICAgICAgIF90aGlzLnNlbGVjdGlvblNldHRpbmdzLmNoZWNrYm94TW9kZSAhPT0gJ1Jlc2V0T25Sb3dDbGljaycpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZWxlY3RSb3dDYWxsQmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF90aGlzLnNlbGVjdGlvblNldHRpbmdzLmNoZWNrYm94TW9kZSA9PT0gJ1Jlc2V0T25Sb3dDbGljaycpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5pc0NoZWNrYm94UmVzZXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIF90aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIV90aGlzLnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24gfHwgX3RoaXMuc2VsZWN0aW9uU2V0dGluZ3MuY2hlY2tib3hNb2RlID09PSAnUmVzZXRPblJvd0NsaWNrJyB8fFxuICAgICAgICAgICAgICAgICghX3RoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb24gJiYgX3RoaXMuc2VsZWN0aW9uU2V0dGluZ3MucGVyc2lzdFNlbGVjdGlvbikpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZWxlY3RSb3dDaGVjayA9IHRydWU7XG4gICAgICAgICAgICAgICAgX3RoaXMuY2xlYXJSb3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuc2VsZWN0Um93Q2FsbEJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciBhcmdzO1xuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmluZGV4O1xuICAgICAgICB2YXIgaXNUb2dnbGUgPSB0aGlzLnRvZ2dsZTtcbiAgICAgICAgdmFyIHNlbGVjdERhdGEgPSB0aGlzLmRhdGE7XG4gICAgICAgIHZhciBpc1JlbW92ZWQgPSB0aGlzLnJlbW92ZWQ7XG4gICAgICAgIHZhciBzZWxlY3RlZFJvdyA9IGdPYmouZ2V0Um93QnlJbmRleChpbmRleCk7XG4gICAgICAgIGlmICghaXNUb2dnbGUgJiYgIWlzUmVtb3ZlZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmluZGV4T2YoaW5kZXgpIDw9IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVSb3dTZWxlY3Rpb24oc2VsZWN0ZWRSb3csIGluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93SW5kZXgoaW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNUb2dnbGUpIHtcbiAgICAgICAgICAgIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgZGF0YTogc2VsZWN0RGF0YSwgcm93SW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgICAgIHJvdzogc2VsZWN0ZWRSb3csIHByZXZpb3VzUm93OiBnT2JqLmdldFJvd0J5SW5kZXgodGhpcy5wcmV2Um93SW5kZXgpLFxuICAgICAgICAgICAgICAgIHByZXZpb3VzUm93SW5kZXg6IHRoaXMucHJldlJvd0luZGV4LCB0YXJnZXQ6IHRoaXMuYWN0dWFsVGFyZ2V0LCBpc0ludGVyYWN0ZWQ6IHRoaXMuaXNJbnRlcmFjdGVkLFxuICAgICAgICAgICAgICAgIGlzSGVhZGVyQ2hlY2tCb3hDbGlja2VkOiB0aGlzLmlzSGVhZGVyQ2hlY2tib3hDbGlja2VkLCByb3dJbmRleGVzOiBpbmRleFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMub25BY3Rpb25Db21wbGV0ZShhcmdzLCBldmVudHMucm93U2VsZWN0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNJbnRlcmFjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMudXBkYXRlUm93UHJvcHMoaW5kZXgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VsZWN0cyBhIHJhbmdlIG9mIHJvd3MgZnJvbSBzdGFydCBhbmQgZW5kIHJvdyBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBzdGFydEluZGV4IC0gU3BlY2lmaWVzIHRoZSBzdGFydCByb3cgaW5kZXguXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBlbmRJbmRleCAtIFNwZWNpZmllcyB0aGUgZW5kIHJvdyBpbmRleC5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnNlbGVjdFJvd3NCeVJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSB7XG4gICAgICAgIHRoaXMuc2VsZWN0Um93cyh0aGlzLmdldENvbGxlY3Rpb25Gcm9tSW5kZXhlcyhzdGFydEluZGV4LCBlbmRJbmRleCkpO1xuICAgICAgICB0aGlzLnNlbGVjdFJvd0luZGV4KGVuZEluZGV4KTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuc2VsZWN0ZWREYXRhVXBkYXRlID0gZnVuY3Rpb24gKHNlbGVjdGVkRGF0YSwgZm9yZWlnbktleURhdGEsIHNlbGVjdGVkUm93cywgcm93SW5kZXhlcywgc2VsZWN0YWJsZVJvd0luZGV4KSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByb3dJbmRleGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJvdyA9IHRoaXMucGFyZW50LmdldERhdGFSb3dzKClbcm93SW5kZXhlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFJvdyA9IHRoaXMucGFyZW50LmdldFJvd0J5SW5kZXgocm93SW5kZXhlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJvd09iaiA9IHRoaXMuZ2V0Um93T2JqKGN1cnJlbnRSb3cpO1xuICAgICAgICAgICAgaWYgKHJvd09iaiAmJiByb3dPYmouaXNEYXRhUm93ICYmIHJvd09iai5pc1NlbGVjdGFibGUpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZERhdGEucHVzaChyb3dPYmouZGF0YSk7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3dzLnB1c2goY3VycmVudFJvdyk7XG4gICAgICAgICAgICAgICAgZm9yZWlnbktleURhdGEucHVzaChyb3dPYmouZm9yZWlnbktleURhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uICYmIHNlbGVjdGFibGVSb3dJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RhYmxlUm93SW5kZXguc3BsaWNlKHNlbGVjdGFibGVSb3dJbmRleC5pbmRleE9mKHJvd0luZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZWxlY3RzIGEgY29sbGVjdGlvbiBvZiByb3dzIGJ5IGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyW119IHJvd0luZGV4ZXMgLSBTcGVjaWZpZXMgYW4gYXJyYXkgb2Ygcm93IGluZGV4ZXMuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zZWxlY3RSb3dzID0gZnVuY3Rpb24gKHJvd0luZGV4ZXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHNlbGVjdGFibGVSb3dJbmRleCA9IHJvd0luZGV4ZXMuc2xpY2UoKTtcbiAgICAgICAgdmFyIHJvd0luZGV4ID0gIXRoaXMuaXNTaW5nbGVTZWwoKSA/IHJvd0luZGV4ZXNbMF0gOiByb3dJbmRleGVzW3Jvd0luZGV4ZXMubGVuZ3RoIC0gMV07XG4gICAgICAgIHRoaXMuaXNNdWx0aVNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgIHZhciBzZWxlY3RlZFJvd3MgPSBbXTtcbiAgICAgICAgdmFyIGZvcmVpZ25LZXlEYXRhID0gW107XG4gICAgICAgIHZhciBjYW4gPSAnY2FuY2VsJztcbiAgICAgICAgdmFyIHNlbGVjdGVkRGF0YSA9IFtdO1xuICAgICAgICBpZiAoIXRoaXMuaXNSb3dUeXBlKCkgfHwgdGhpcy5pc0VkaXRpbmcoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhVXBkYXRlKHNlbGVjdGVkRGF0YSwgZm9yZWlnbktleURhdGEsIHNlbGVjdGVkUm93cywgcm93SW5kZXhlcywgc2VsZWN0YWJsZVJvd0luZGV4KTtcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXQoKTtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICBjYW5jZWw6IGZhbHNlLFxuICAgICAgICAgICAgcm93SW5kZXhlczogc2VsZWN0YWJsZVJvd0luZGV4LCByb3c6IHNlbGVjdGVkUm93cywgcm93SW5kZXg6IHJvd0luZGV4LCB0YXJnZXQ6IHRoaXMuYWN0dWFsVGFyZ2V0LFxuICAgICAgICAgICAgcHJldlJvdzogZ09iai5nZXRSb3dzKClbdGhpcy5wcmV2Um93SW5kZXhdLCBwcmV2aW91c1Jvd0luZGV4OiB0aGlzLnByZXZSb3dJbmRleCxcbiAgICAgICAgICAgIGlzSW50ZXJhY3RlZDogdGhpcy5pc0ludGVyYWN0ZWQsIGlzQ3RybFByZXNzZWQ6IHRoaXMuaXNNdWx0aUN0cmxSZXF1ZXN0LCBpc1NoaWZ0UHJlc3NlZDogdGhpcy5pc011bHRpU2hpZnRSZXF1ZXN0LFxuICAgICAgICAgICAgZGF0YTogc2VsZWN0ZWREYXRhLCBpc0hlYWRlckNoZWNrYm94Q2xpY2tlZDogdGhpcy5pc0hlYWRlckNoZWNrYm94Q2xpY2tlZCwgZm9yZWlnbktleURhdGE6IGZvcmVpZ25LZXlEYXRhXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLnJvd1NlbGVjdGluZywgdGhpcy5mRGF0YVVwZGF0ZShhcmdzKSwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoYXJncykgJiYgYXJnc1tcIlwiICsgY2FuXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLmRpc2FibGVJbnRlcmFjdGVkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEoX3RoaXMuc2VsZWN0aW9uU2V0dGluZ3MucGVyc2lzdFNlbGVjdGlvbiAmJiBnT2JqLmFsbG93Um93RHJhZ0FuZERyb3AgJiYgX3RoaXMuaXNEcmFnZ2VkKSkge1xuICAgICAgICAgICAgICAgIF90aGlzLmNsZWFyUm93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5zZWxlY3RSb3dJbmRleChzZWxlY3RhYmxlUm93SW5kZXguc2xpY2UoLTEpWzBdKTtcbiAgICAgICAgICAgIHZhciBzZWxlY3RSb3dGbiA9IGZ1bmN0aW9uIChpbmRleCwgcHJldmVudEZvY3VzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlUm93U2VsZWN0aW9uKGdPYmouZ2V0Um93QnlJbmRleChpbmRleCksIGluZGV4LCBwcmV2ZW50Rm9jdXMpO1xuICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZVJvd1Byb3BzKHJvd0luZGV4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoIV90aGlzLmlzU2luZ2xlU2VsKCkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHNlbGVjdGFibGVSb3dJbmRleF8xID0gc2VsZWN0YWJsZVJvd0luZGV4OyBfaSA8IHNlbGVjdGFibGVSb3dJbmRleF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm93SWR4ID0gc2VsZWN0YWJsZVJvd0luZGV4XzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RSb3dGbihyb3dJZHgsIGdPYmouZW5hYmxlVmlydHVhbGl6YXRpb24gPyB0cnVlIDogZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGVjdFJvd0ZuKHJvd0luZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfdGhpcy5jaGVja1ZpcnR1YWxDaGVja0JveCgpICYmICFfdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGFibGVSb3dJbmRleC5sZW5ndGggPT09IF90aGlzLnRvdGFsUmVjb3Jkc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnZpcnR1YWxTZWxlY3RlZERhdGEgPSBfdGhpcy52aXJ0dWFsQ2hlY2tCb3hEYXRhKCkuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0ZWRSb3dJbmRleGVzID0gT2JqZWN0LmtleXMoX3RoaXMudmlydHVhbFNlbGVjdGVkRGF0YSkubWFwKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIHBhcnNlSW50KGtleSwgMTApOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0Q2hlY2tBbGxTdGF0ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGlvbkRhdGEgPSBzZWxlY3RhYmxlUm93SW5kZXguZmlsdGVyKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNlbGVjdGVkUm93SW5kZXhlcy5pbmRleE9mKGluZGV4KSA9PT0gLTE7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0aW9uRGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWxsRGF0YSA9IF90aGlzLnZpcnR1YWxDaGVja0JveERhdGEoKS5zbGljZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3Rpb25EYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IGFsbERhdGFbc2VsZWN0aW9uRGF0YVtpXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChyZWNvcmQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnZpcnR1YWxTZWxlY3RlZERhdGEucHVzaChyZWNvcmQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMucHVzaChzZWxlY3Rpb25EYXRhW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRDaGVja0FsbFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhcmdzID0ge1xuICAgICAgICAgICAgICAgIHJvd0luZGV4ZXM6IHNlbGVjdGFibGVSb3dJbmRleCwgcm93OiBzZWxlY3RlZFJvd3MsIHJvd0luZGV4OiByb3dJbmRleCwgdGFyZ2V0OiBfdGhpcy5hY3R1YWxUYXJnZXQsXG4gICAgICAgICAgICAgICAgcHJldlJvdzogZ09iai5nZXRSb3dzKClbX3RoaXMucHJldlJvd0luZGV4XSwgcHJldmlvdXNSb3dJbmRleDogX3RoaXMucHJldlJvd0luZGV4LFxuICAgICAgICAgICAgICAgIGRhdGE6IF90aGlzLmdldFNlbGVjdGVkUmVjb3JkcygpLCBpc0ludGVyYWN0ZWQ6IF90aGlzLmlzSW50ZXJhY3RlZCxcbiAgICAgICAgICAgICAgICBpc0hlYWRlckNoZWNrYm94Q2xpY2tlZDogX3RoaXMuaXNIZWFkZXJDaGVja2JveENsaWNrZWQsIGZvcmVpZ25LZXlEYXRhOiBmb3JlaWduS2V5RGF0YVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5pc1Jvd1NlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMub25BY3Rpb25Db21wbGV0ZShhcmdzLCBldmVudHMucm93U2VsZWN0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMuaXNJbnRlcmFjdGVkID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VsZWN0IHJvd3Mgd2l0aCBleGlzdGluZyByb3cgc2VsZWN0aW9uIGJ5IHBhc3Npbmcgcm93IGluZGV4ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcm93SW5kZXhlcyAtIFNwZWNpZmllcyB0aGUgcm93IGluZGV4ZXMuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuYWRkUm93c1RvU2VsZWN0aW9uID0gZnVuY3Rpb24gKHJvd0luZGV4ZXMpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIGNhbiA9ICdjYW5jZWwnO1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXQ7XG4gICAgICAgIHRoaXMuaXNNdWx0aVNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgIHZhciBzZWxlY3RlZFJvd3MgPSBbXTtcbiAgICAgICAgdmFyIGZvcmVpZ25LZXlEYXRhID0gW107XG4gICAgICAgIHZhciBzZWxlY3RlZERhdGEgPSBbXTtcbiAgICAgICAgdmFyIGluZGV4ZXMgPSBnT2JqLmdldFNlbGVjdGVkUm93SW5kZXhlcygpLmNvbmNhdChyb3dJbmRleGVzKTtcbiAgICAgICAgdmFyIHNlbGVjdGVkUm93ID0gIXRoaXMuaXNTaW5nbGVTZWwoKSA/IGdPYmouZ2V0Um93QnlJbmRleChyb3dJbmRleGVzWzBdKSA6XG4gICAgICAgICAgICBnT2JqLmdldFJvd0J5SW5kZXgocm93SW5kZXhlc1tyb3dJbmRleGVzLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgaWYgKCghdGhpcy5pc1Jvd1R5cGUoKSB8fCB0aGlzLmlzRWRpdGluZygpKSAmJiAhdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5jaGVja2JveE9ubHkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXJncztcbiAgICAgICAgdmFyIGNoZWNrYm94Q29sdW1uID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpLmZpbHRlcihmdW5jdGlvbiAoY29sKSB7IHJldHVybiBjb2wudHlwZSA9PT0gJ2NoZWNrYm94JzsgfSk7XG4gICAgICAgIGlmICh0aGlzLmlzTXVsdGlDdHJsUmVxdWVzdCAmJiAhY2hlY2tib3hDb2x1bW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YVVwZGF0ZShzZWxlY3RlZERhdGEsIGZvcmVpZ25LZXlEYXRhLCBzZWxlY3RlZFJvd3MsIGluZGV4ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcm93SW5kZXhlc18xID0gcm93SW5kZXhlczsgX2kgPCByb3dJbmRleGVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgcm93SW5kZXggPSByb3dJbmRleGVzXzFbX2ldO1xuICAgICAgICAgICAgdmFyIHJvd09iaiA9IHRoaXMuZ2V0Um93T2JqKHJvd0luZGV4KTtcbiAgICAgICAgICAgIHZhciBpc1VuU2VsZWN0ZWQgPSB0aGlzLnNlbGVjdGVkUm93SW5kZXhlcy5pbmRleE9mKHJvd0luZGV4KSA+IC0xO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uICYmIHJvd09iaiAmJiByb3dPYmouaXNEYXRhUm93ICYmICFyb3dPYmouaXNTZWxlY3RhYmxlKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlbGVjdFJvd0luZGV4KHJvd0luZGV4KTtcbiAgICAgICAgICAgIGlmIChpc1VuU2VsZWN0ZWQgJiYgKChjaGVja2JveENvbHVtbi5sZW5ndGggPyB0cnVlIDogdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5lbmFibGVUb2dnbGUpIHx8IHRoaXMuaXNNdWx0aUN0cmxSZXF1ZXN0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNBZGRSb3dzVG9TZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMucm93RGVzZWxlY3QoZXZlbnRzLnJvd0Rlc2VsZWN0aW5nLCBbcm93SW5kZXhdLCBbcm93T2JqLmRhdGFdLCBbc2VsZWN0ZWRSb3ddLCBbcm93T2JqLmZvcmVpZ25LZXlEYXRhXSwgdGFyZ2V0KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0NhbmNlbERlU2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tWaXJ0dWFsQ2hlY2tCb3goKSAmJiAhdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlydHVhbFNlbGVjdGVkRGF0YS5zcGxpY2UodGhpcy52aXJ0dWFsU2VsZWN0ZWREYXRhLmluZGV4T2Yocm93T2JqLmRhdGEpLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMuc3BsaWNlKHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmluZGV4T2Yocm93SW5kZXgpLCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUmVjb3Jkcy5zcGxpY2UodGhpcy5zZWxlY3RlZFJlY29yZHMuaW5kZXhPZihzZWxlY3RlZFJvdyksIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93SW5kZXgodGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMubGVuZ3RoID8gdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXNbdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMubGVuZ3RoIC0gMV0gOiAtMSk7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3cucmVtb3ZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRSZW1vdmVDbGFzc2VzRm9yUm93KHNlbGVjdGVkUm93LCBmYWxzZSwgbnVsbCwgJ2Utc2VsZWN0aW9uYmFja2dyb3VuZCcsICdlLWFjdGl2ZScpO1xuICAgICAgICAgICAgICAgIHRoaXMucm93RGVzZWxlY3QoZXZlbnRzLnJvd0Rlc2VsZWN0ZWQsIFtyb3dJbmRleF0sIFtyb3dPYmouZGF0YV0sIFtzZWxlY3RlZFJvd10sIFtyb3dPYmouZm9yZWlnbktleURhdGFdLCB0YXJnZXQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNJbnRlcmFjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5pc011bHRpU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5pc0FkZFJvd3NUb1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNIZHJTZWxlY3RBbGxDbGlja2VkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldCgpO1xuICAgICAgICAgICAgICAgIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHNlbGVjdGVkRGF0YS5sZW5ndGggPyBzZWxlY3RlZERhdGEgOiByb3dPYmouZGF0YSwgcm93SW5kZXg6IHJvd0luZGV4LCByb3c6IHNlbGVjdGVkUm93cy5sZW5ndGggPyBzZWxlY3RlZFJvd3MgOlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3csIHRhcmdldDogdGhpcy5hY3R1YWxUYXJnZXQsIHByZXZSb3c6IGdPYmouZ2V0Um93cygpW3RoaXMucHJldlJvd0luZGV4XSxcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNSb3dJbmRleDogdGhpcy5wcmV2Um93SW5kZXgsIGlzQ3RybFByZXNzZWQ6IHRoaXMuaXNNdWx0aUN0cmxSZXF1ZXN0LCBpc1NoaWZ0UHJlc3NlZDogdGhpcy5pc011bHRpU2hpZnRSZXF1ZXN0LFxuICAgICAgICAgICAgICAgICAgICBmb3JlaWduS2V5RGF0YTogZm9yZWlnbktleURhdGEubGVuZ3RoID8gZm9yZWlnbktleURhdGEgOiByb3dPYmouZm9yZWlnbktleURhdGEsIGlzSW50ZXJhY3RlZDogdGhpcy5pc0ludGVyYWN0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGlzSGVhZGVyQ2hlY2tib3hDbGlja2VkOiB0aGlzLmlzSGVhZGVyQ2hlY2tib3hDbGlja2VkLCByb3dJbmRleGVzOiBpbmRleGVzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5yb3dTZWxlY3RpbmcsIHRoaXMuZkRhdGFVcGRhdGUoYXJncykpO1xuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoYXJncykgJiYgYXJnc1tcIlwiICsgY2FuXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVJbnRlcmFjdGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNTaW5nbGVTZWwoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyUm93KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUm93U2VsZWN0aW9uKHNlbGVjdGVkUm93LCByb3dJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzVW5TZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHNlbGVjdGVkRGF0YS5sZW5ndGggPyBzZWxlY3RlZERhdGEgOiByb3dPYmouZGF0YSwgcm93SW5kZXg6IHJvd0luZGV4LCByb3c6IHNlbGVjdGVkUm93cy5sZW5ndGggPyBzZWxlY3RlZFJvd3MgOlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3csIHRhcmdldDogdGhpcy5hY3R1YWxUYXJnZXQsIHByZXZSb3c6IGdPYmouZ2V0Um93cygpW3RoaXMucHJldlJvd0luZGV4XSxcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNSb3dJbmRleDogdGhpcy5wcmV2Um93SW5kZXgsIGZvcmVpZ25LZXlEYXRhOiBmb3JlaWduS2V5RGF0YS5sZW5ndGggPyBmb3JlaWduS2V5RGF0YSA6IHJvd09iai5mb3JlaWduS2V5RGF0YSxcbiAgICAgICAgICAgICAgICAgICAgaXNJbnRlcmFjdGVkOiB0aGlzLmlzSW50ZXJhY3RlZCwgaXNIZWFkZXJDaGVja2JveENsaWNrZWQ6IHRoaXMuaXNIZWFkZXJDaGVja2JveENsaWNrZWQsIHJvd0luZGV4ZXM6IGluZGV4ZXNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMub25BY3Rpb25Db21wbGV0ZShhcmdzLCBldmVudHMucm93U2VsZWN0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pc0ludGVyYWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUm93UHJvcHMocm93SW5kZXgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNTaW5nbGVTZWwoKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmdldENvbGxlY3Rpb25Gcm9tSW5kZXhlcyA9IGZ1bmN0aW9uIChzdGFydEluZGV4LCBlbmRJbmRleCkge1xuICAgICAgICB2YXIgaW5kZXhlcyA9IFtdO1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0XG4gICAgICAgIHZhciBfYSA9IChzdGFydEluZGV4IDw9IGVuZEluZGV4KSA/XG4gICAgICAgICAgICB7IGk6IHN0YXJ0SW5kZXgsIG1heDogZW5kSW5kZXggfSA6IHsgaTogZW5kSW5kZXgsIG1heDogc3RhcnRJbmRleCB9LCBpID0gX2EuaSwgbWF4ID0gX2EubWF4O1xuICAgICAgICBmb3IgKDsgaSA8PSBtYXg7IGkrKykge1xuICAgICAgICAgICAgaW5kZXhlcy5wdXNoKGkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydEluZGV4ID4gZW5kSW5kZXgpIHtcbiAgICAgICAgICAgIGluZGV4ZXMucmV2ZXJzZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbmRleGVzO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jbGVhclJvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jbGVhclJvd0NoZWNrID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jbGVhclJvd1NlbGVjdGlvbigpO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jbGVhclJvd0NhbGxCYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pc0NhbmNlbERlU2VsZWN0ICYmIHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyAhPT0gJ0NoZWNrJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzID0gW107XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRSZWNvcmRzID0gW107XG4gICAgICAgIHRoaXMuc2VsZWN0Um93SW5kZXgoLTEpO1xuICAgICAgICBpZiAodGhpcy5pc1NpbmdsZVNlbCgpICYmIHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlID0ge307XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuY2xlYXJTZWxlY3RlZFJvdyA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAodGhpcy50b2dnbGUpIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEVsZSA9IHRoaXMucGFyZW50LmdldFJvd0J5SW5kZXgoaW5kZXgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVVSSkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkRWxlLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkUmVtb3ZlQ2xhc3Nlc0ZvclJvdyhzZWxlY3RlZEVsZSwgZmFsc2UsIHRydWUsICdlLXNlbGVjdGlvbmJhY2tncm91bmQnLCAnZS1hY3RpdmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVtb3ZlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBlcnNpc3RDb2xsZWN0aW9uKHNlbGVjdGVkRWxlLCBmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNoZWNrQm94ZXMoc2VsZWN0ZWRFbGUpO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMuc3BsaWNlKHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmluZGV4T2YoaW5kZXgpLCAxKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSZWNvcmRzLnNwbGljZSh0aGlzLnNlbGVjdGVkUmVjb3Jkcy5pbmRleE9mKHRoaXMucGFyZW50LmdldFJvd0J5SW5kZXgoaW5kZXgpKSwgMSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlUm93UHJvcHMgPSBmdW5jdGlvbiAoc3RhcnRJbmRleCkge1xuICAgICAgICB0aGlzLnByZXZSb3dJbmRleCA9IHN0YXJ0SW5kZXg7XG4gICAgICAgIHRoaXMuaXNSb3dTZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmxlbmd0aCAmJiB0cnVlO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5nZXRQa1ZhbHVlID0gZnVuY3Rpb24gKHBrRmllbGQsIGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHBrRmllbGQgPyBpc0NvbXBsZXhGaWVsZChwa0ZpZWxkKSA/IGdldE9iamVjdChwa0ZpZWxkLCBkYXRhKSA6IGRhdGFbXCJcIiArIHBrRmllbGRdIDogZGF0YVtcIlwiICsgcGtGaWVsZF07XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVBlcnNpc3RDb2xsZWN0aW9uID0gZnVuY3Rpb24gKHNlbGVjdGVkUm93LCBjaGtTdGF0ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoKHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbiB8fCB0aGlzLnBhcmVudC5zZWxlY3Rpb25TZXR0aW5ncy5wZXJzaXN0U2VsZWN0aW9uICYmXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpLmxlbmd0aCA+IDApICYmICFpc051bGxPclVuZGVmaW5lZChzZWxlY3RlZFJvdykpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbnN1cmVDaGVja2JveEZpZWxkU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcm93T2JqID0gdGhpcy5nZXRSb3dPYmooc2VsZWN0ZWRSb3cpO1xuICAgICAgICAgICAgdmFyIHBLZXlfMSA9IHJvd09iai5kYXRhID8gdGhpcy5nZXRQa1ZhbHVlKHRoaXMucHJpbWFyeUtleSwgcm93T2JqLmRhdGEpIDogbnVsbDtcbiAgICAgICAgICAgIGlmIChwS2V5XzEgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByb3dPYmouaXNTZWxlY3RlZCA9IGNoa1N0YXRlO1xuICAgICAgICAgICAgaWYgKChjaGtTdGF0ZSAmJiAhdGhpcy5pc1BhcnRpYWxTZWxlY3Rpb24pIHx8ICh0aGlzLmlzUGFydGlhbFNlbGVjdGlvbiAmJiByb3dPYmouaXNTZWxlY3RhYmxlICYmIHJvd09iai5pc1NlbGVjdGVkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dTdGF0ZVtcIlwiICsgcEtleV8xXSA9IGNoa1N0YXRlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAodGhpcy51blNlbGVjdGVkUm93U3RhdGVbXCJcIiArIHBLZXlfMV0pO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5wZXJzaXN0U2VsZWN0ZWREYXRhLnNvbWUoZnVuY3Rpb24gKGRhdGEpIHsgcmV0dXJuIF90aGlzLmdldFBrVmFsdWUoX3RoaXMucHJpbWFyeUtleSwgZGF0YSkgPT09IHBLZXlfMTsgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0U2VsZWN0ZWREYXRhLnB1c2gocm93T2JqLmRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUGVyc2lzdERlbGV0ZShwS2V5XzEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVBlcnNpc3REZWxldGUgPSBmdW5jdGlvbiAocEtleSwgaXNQYXJ0aWFsU2VsZWN0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGRlbGV0ZSAodGhpcy5zZWxlY3RlZFJvd1N0YXRlW1wiXCIgKyBwS2V5XSk7XG4gICAgICAgIGlmICh0aGlzLnJtdEhkckNoa2J4Q2xpY2tlZCkge1xuICAgICAgICAgICAgdGhpcy51blNlbGVjdGVkUm93U3RhdGVbXCJcIiArIHBLZXldID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXg7XG4gICAgICAgIHZhciBpc1ByZXNlbnQgPSB0aGlzLnBlcnNpc3RTZWxlY3RlZERhdGEuc29tZShmdW5jdGlvbiAoZGF0YSwgaSkge1xuICAgICAgICAgICAgaW5kZXggPSBpO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmdldFBrVmFsdWUoX3RoaXMucHJpbWFyeUtleSwgZGF0YSkgPT09IHBLZXk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoaXNQcmVzZW50KSB7XG4gICAgICAgICAgICB0aGlzLnBlcnNpc3RTZWxlY3RlZERhdGEuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIGlmIChpc1BhcnRpYWxTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5wYXJ0aWFsU2VsZWN0ZWRSZWNvcmRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlQ2hlY2tCb3hlcyA9IGZ1bmN0aW9uIChyb3csIGNoa1N0YXRlLCByb3dJbmRleCkge1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHJvdykpIHtcbiAgICAgICAgICAgIHZhciBjaGtCb3ggPSByb3cucXVlcnlTZWxlY3RvcignLmUtY2hlY2tzZWxlY3QnKTtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY2hrQm94KSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZUFkZENib3hDbGFzc2VzKGNoa0JveC5uZXh0RWxlbWVudFNpYmxpbmcsIGNoa1N0YXRlKTtcbiAgICAgICAgICAgICAgICBzZXRDaGVja2VkKGNoa0JveCwgY2hrU3RhdGUpO1xuICAgICAgICAgICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZCh0aGlzLmNoZWNrZWRUYXJnZXQpIHx8ICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jaGVja2VkVGFyZ2V0KVxuICAgICAgICAgICAgICAgICAgICAmJiAhdGhpcy5jaGVja2VkVGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1jaGVja3NlbGVjdGFsbCcpKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldENoZWNrQWxsU3RhdGUocm93SW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS51cGRhdGVSb3dTZWxlY3Rpb24gPSBmdW5jdGlvbiAoc2VsZWN0ZWRSb3csIHN0YXJ0SW5kZXgsIHByZXZlbnRGb2N1cykge1xuICAgICAgICBpZiAoIXNlbGVjdGVkUm93KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmluZGV4T2Yoc3RhcnRJbmRleCkgPT09IC0xKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jaGVja1ZpcnR1YWxDaGVja0JveCgpICYmICF0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpcnR1YWxTZWxlY3RlZERhdGEucHVzaCh0aGlzLnBhcmVudC5nZXRSb3dPYmplY3RGcm9tVUlEKHNlbGVjdGVkUm93LmdldEF0dHJpYnV0ZSgnZGF0YS11aWQnKSkuZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93SW5kZXhlcy5wdXNoKHN0YXJ0SW5kZXgpO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJlY29yZHMucHVzaChzZWxlY3RlZFJvdyk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZWN0ZWRSb3cuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICAgICAgdGhpcy51cGRhdGVQZXJzaXN0Q29sbGVjdGlvbihzZWxlY3RlZFJvdywgdHJ1ZSk7XG4gICAgICAgIHRoaXMudXBkYXRlQ2hlY2tCb3hlcyhzZWxlY3RlZFJvdywgdHJ1ZSk7XG4gICAgICAgIHRoaXMuYWRkUmVtb3ZlQ2xhc3Nlc0ZvclJvdyhzZWxlY3RlZFJvdywgdHJ1ZSwgbnVsbCwgJ2Utc2VsZWN0aW9uYmFja2dyb3VuZCcsICdlLWFjdGl2ZScpO1xuICAgICAgICBpZiAoIXRoaXMucHJldmVudEZvY3VzICYmICEodGhpcy5wYXJlbnQuaXNGb2N1c0ZpcnN0Q2VsbCB8fCB0aGlzLmlzRm9jdXNMYXN0Q2VsbCkpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLmZvY3VzLmdldFByZXZJbmRleGVzKCkuY2VsbEluZGV4ID9cbiAgICAgICAgICAgICAgICBzZWxlY3RlZFJvdy5jZWxsc1t0aGlzLmZvY3VzLmdldFByZXZJbmRleGVzKCkuY2VsbEluZGV4XSA6XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3cucXVlcnlTZWxlY3RvcignLmUtc2VsZWN0aW9uYmFja2dyb3VuZDpub3QoLmUtaGlkZSk6bm90KC5lLWRldGFpbHJvd2NvbGxhcHNlKTpub3QoLmUtZGV0YWlscm93ZXhwYW5kKScpO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNvbnRleHRNZW51TW9kdWxlICYmIHRoaXMubW91c2VCdXR0b24gPT09IDIpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnBhcmVudC5jb250ZXh0TWVudU1vZHVsZS5jZWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0YXJnZXQgfHwgcHJldmVudEZvY3VzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5mb2N1cy5vbkNsaWNrKHsgdGFyZ2V0OiB0YXJnZXQgfSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNGb2N1c0ZpcnN0Q2VsbCB8fCB0aGlzLmlzRm9jdXNMYXN0Q2VsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmlzRm9jdXNGaXJzdENlbGwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0b3IgPSB0aGlzLmlzRm9jdXNMYXN0Q2VsbCA/ICdsYXN0LWNoaWxkJyA6ICdmaXJzdC1jaGlsZCc7XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IHNlbGVjdGVkUm93LnF1ZXJ5U2VsZWN0b3IoJy5lLXNlbGVjdGlvbmJhY2tncm91bmQuZS1yb3djZWxsOm5vdCguZS1oaWRlLCAuZS1kZXRhaWxyb3djb2xsYXBzZSwgLmUtZGV0YWlscm93ZXhwYW5kLCAuZS1yb3dkcmFnZHJvcCwgLmUtZ3JpZGNoa2JveCk6JyArIHNlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzRm9jdXNMYXN0Q2VsbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1cy5vbkNsaWNrKHsgdGFyZ2V0OiB0YXJnZXQgfSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBEZXNlbGVjdHMgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCByb3dzIGFuZCBjZWxscy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuY2xlYXJTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tTZWxlY3RBbGxDbGlja2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MucGVyc2lzdFNlbGVjdGlvbiAmJiB0aGlzLnBlcnNpc3RTZWxlY3RlZERhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmRlU2VsZWN0ZWREYXRhID0gaXRlcmF0ZUV4dGVuZCh0aGlzLnBlcnNpc3RTZWxlY3RlZERhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uIHx8ICh0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24gJiYgIXRoaXMucGFyZW50LmlzRWRpdCkgfHxcbiAgICAgICAgICAgICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jaGVja2VkVGFyZ2V0KSAmJiB0aGlzLmNoZWNrZWRUYXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNoZWNrc2VsZWN0YWxsJykpKSB7XG4gICAgICAgICAgICB2YXIgc3BhbiA9IHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZ3JpZHBvcHVwJykucXVlcnlTZWxlY3Rvcignc3BhbicpO1xuICAgICAgICAgICAgaWYgKHNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJvd3NlbGVjdCcpKSB7XG4gICAgICAgICAgICAgICAgc3Bhbi5jbGFzc0xpc3QucmVtb3ZlKCdlLXNwYW5jbGlja2VkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0U2VsZWN0ZWREYXRhID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlID0ge307XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQucGFydGlhbFNlbGVjdGVkUmVjb3JkcyA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmRpc2FibGVTZWxlY3RlZFJlY29yZHMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgcm93T2JqZWN0cyA9IHRoaXMucGFyZW50LmdldFJvd3NPYmplY3QoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd09iamVjdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd09iamVjdHNbaV0uaXNEYXRhUm93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93T2JqZWN0c1tpXS5pc1NlbGVjdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5wYXJ0aWFsU2VsZWN0ZWRSZWNvcmRzLnB1c2gocm93T2JqZWN0c1tpXS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmRpc2FibGVTZWxlY3RlZFJlY29yZHMucHVzaChyb3dPYmplY3RzW2ldLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jbGVhclJvd1NlbGVjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5jbGVhckNlbGxTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDb2x1bW5TZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMucHJldlJvd0luZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5wcmV2Q0lkeHMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLnByZXZFQ0lkeHMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLmVuYWJsZVNlbGVjdE11bHRpVG91Y2ggPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaXNJbnRlcmFjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmNoZWNrU2VsZWN0QWxsQ2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5pc0hkclNlbGVjdEFsbENsaWNrZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRGVzZWxlY3RzIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgcm93cy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuY2xlYXJSb3dTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmlzUm93U2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHZhciByb3dzXzEgPSB0aGlzLnBhcmVudC5nZXREYXRhUm93cygpO1xuICAgICAgICAgICAgdmFyIGRhdGFfMSA9IFtdO1xuICAgICAgICAgICAgdmFyIHJvd18xID0gW107XG4gICAgICAgICAgICB2YXIgcm93SW5kZXhfMSA9IFtdO1xuICAgICAgICAgICAgdmFyIGZvcmVpZ25LZXlEYXRhXzEgPSBbXTtcbiAgICAgICAgICAgIHZhciB0YXJnZXRfMSA9IHRoaXMudGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5pc1Jvd0Rlc2VsZWN0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLnNlbGVjdGVkUm93SW5kZXhlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Um93ID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCAodGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmdcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFJvdyA9IHRoaXMucGFyZW50LmdldFJvd0J5SW5kZXgodGhpcy5zZWxlY3RlZFJvd0luZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSb3cgPSB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ0JhdGNoJyA/XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRSb3dzKClbdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXVxuICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnBhcmVudC5nZXREYXRhUm93cygpW3RoaXMuc2VsZWN0ZWRSb3dJbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByb3dPYmogPSB0aGlzLmdldFJvd09iaihjdXJyZW50Um93KTtcbiAgICAgICAgICAgICAgICBpZiAocm93T2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFfMS5wdXNoKHJvd09iai5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcm93XzEucHVzaChjdXJyZW50Um93KTtcbiAgICAgICAgICAgICAgICAgICAgcm93SW5kZXhfMS5wdXNoKHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgICAgIGZvcmVpZ25LZXlEYXRhXzEucHVzaChyb3dPYmouZm9yZWlnbktleURhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24gJiYgdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5jaGVja2JveE1vZGUgIT09ICdSZXNldE9uUm93Q2xpY2snKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1Jvd0NsaWNrZWQgPSB0aGlzLmNoZWNrU2VsZWN0QWxsQ2xpY2tlZCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucm93RGVzZWxlY3QoZXZlbnRzLnJvd0Rlc2VsZWN0aW5nLCByb3dJbmRleF8xLCBkYXRhXzEsIHJvd18xLCBmb3JlaWduS2V5RGF0YV8xLCB0YXJnZXRfMSwgbnVsbCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc0NhbmNlbERlU2VsZWN0ICYmIChfdGhpcy5pc1Jvd0NsaWNrZWQgfHwgX3RoaXMuY2hlY2tTZWxlY3RBbGxDbGlja2VkIHx8IChfdGhpcy5pc0ludGVyYWN0ZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgIV90aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24pKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmdldENoZWNrQWxsU3RhdHVzKF90aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWNoZWNrc2VsZWN0YWxsJykpID09PSAnSW50ZXJtZWRpYXRlJyB8fCBfdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfdGhpcy5zZWxlY3RlZFJlY29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlUGVyc2lzdENvbGxlY3Rpb24oX3RoaXMuc2VsZWN0ZWRSZWNvcmRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9ICdDaGVjayc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlUGVyc2lzdFNlbGVjdGVkRGF0YSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY2xlYXJSb3dDaGVjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY2xlYXJSb3dDYWxsQmFjaygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY2xlYXJSb3dDaGVjayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnNlbGVjdFJvd0NoZWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0Um93Q2FsbEJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZWxlY3RSb3dDaGVjayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBbXS5zbGljZS5jYWxsKHJvd3NfMS5maWx0ZXIoZnVuY3Rpb24gKHJlY29yZCkgeyByZXR1cm4gcmVjb3JkLmhhc0F0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcpOyB9KSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBlbGVtZW50Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghX3RoaXMuZGlzYWJsZVVJKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50W3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmFkZFJlbW92ZUNsYXNzZXNGb3JSb3coZWxlbWVudFtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0sIGZhbHNlLCB0cnVlLCAnZS1zZWxlY3Rpb25iYWNrZ3JvdW5kJywgJ2UtYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmFsaWduXG4gICAgICAgICAgICAgICAgICAgIGlmICghX3RoaXMuaXNQcmV2Um93U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVQZXJzaXN0Q29sbGVjdGlvbihlbGVtZW50W3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZUNoZWNrQm94ZXMoZWxlbWVudFtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoKF90aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCAoX3RoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nXG4gICAgICAgICAgICAgICAgICAgICYmIF90aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlKSkgJiYgX3RoaXMuc2VsZWN0ZWRSZWNvcmRzLmxlbmd0aCAmJiAhZWxlbWVudC5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgJiYgIV90aGlzLnBhcmVudC5zZWxlY3Rpb25TZXR0aW5ncy5wZXJzaXN0U2VsZWN0aW9uICYmICFfdGhpcy5kaXNhYmxlVUlcbiAgICAgICAgICAgICAgICAgICAgJiYgIV90aGlzLnBhcmVudC5pc0NoZWNrQm94U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmFkZFJlbW92ZUNsYXNzZXNGb3JSb3cobnVsbCwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy52aXJ0dWFsU2VsZWN0ZWREYXRhID0gW107XG4gICAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0ZWRSb3dJbmRleGVzID0gW107XG4gICAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0ZWRSZWNvcmRzID0gW107XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNSb3dTZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIF90aGlzLnNlbGVjdFJvd0luZGV4KC0xKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5pc1ByZXZSb3dTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5yb3dEZXNlbGVjdChldmVudHMucm93RGVzZWxlY3RlZCwgcm93SW5kZXhfMSwgZGF0YV8xLCByb3dfMSwgZm9yZWlnbktleURhdGFfMSwgdGFyZ2V0XzEsIG51bGwsIHVuZGVmaW5lZCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmNsZWFyUm93Q2hlY2spIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY2xlYXJSb3dDYWxsQmFjaygpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5jbGVhclJvd0NoZWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5zZWxlY3RSb3dDaGVjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0Um93Q2FsbEJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNlbGVjdFJvd0NoZWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBudWxsKTtcbiAgICAgICAgICAgIHRoaXMuaXNSb3dEZXNlbGVjdCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2xlYXJSb3dDaGVjaykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJSb3dDYWxsQmFjaygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJSb3dDaGVjayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdFJvd0NoZWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93Q2FsbEJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSb3dDaGVjayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5yb3dEZXNlbGVjdCA9IGZ1bmN0aW9uICh0eXBlLCByb3dJbmRleCwgZGF0YSwgcm93LCBcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgZm9yZWlnbktleURhdGEsIHRhcmdldCwgbVJvdywgcm93RGVzZWxlY3RDYWxsQmFjaywgZnJvemVuUmlnaHRSb3cpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCh0aGlzLnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24gJiYgKHRoaXMuaXNSb3dDbGlja2VkIHx8ICF0aGlzLmlzUm93RGVzZWxlY3QgfHwgdGhpcy5jaGVja1NlbGVjdEFsbENsaWNrZWQgfHwgKHRoaXMuZm9jdXNbJ2FjdGl2ZUtleSddICYmXG4gICAgICAgICAgICB0aGlzLmZvY3VzLmN1cnJlbnRJbmZvLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWdyaWRjaGtib3gnKSAmJiB0aGlzLmZvY3VzWydhY3RpdmVLZXknXSA9PT0gJ3NwYWNlJykpKSB8fFxuICAgICAgICAgICAgIXRoaXMuc2VsZWN0aW9uU2V0dGluZ3MucGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgdmFyIGNhbmNsXzEgPSAnY2FuY2VsJztcbiAgICAgICAgICAgIHZhciBpc1NpbmdsZURlU2VsID0gcm93SW5kZXgubGVuZ3RoID09PSAxICYmIHRoaXMuZGVTZWxlY3RlZERhdGEubGVuZ3RoID09PSAxO1xuICAgICAgICAgICAgdmFyIHJvd0Rlc2VsZWN0T2JqID0ge1xuICAgICAgICAgICAgICAgIHJvd0luZGV4OiByb3dJbmRleFswXSwgZGF0YTogdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5wZXJzaXN0U2VsZWN0aW9uICYmICh0aGlzLnBhcmVudC5jaGVja0FsbFJvd3MgPT09ICdVbmNoZWNrJyAmJlxuICAgICAgICAgICAgICAgICAgICAhaXNTaW5nbGVEZVNlbCkgJiYgdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5jaGVja2JveE1vZGUgIT09ICdSZXNldE9uUm93Q2xpY2snID8gdGhpcy5kZVNlbGVjdGVkRGF0YSA6IGRhdGEsXG4gICAgICAgICAgICAgICAgZm9yZWlnbktleURhdGE6IGZvcmVpZ25LZXlEYXRhLCBjYW5jZWw6IGZhbHNlLCBpc0ludGVyYWN0ZWQ6IHRoaXMuaXNJbnRlcmFjdGVkLFxuICAgICAgICAgICAgICAgIGlzSGVhZGVyQ2hlY2tib3hDbGlja2VkOiB0aGlzLmlzSGVhZGVyQ2hlY2tib3hDbGlja2VkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdyb3dEZXNlbGVjdGVkJykge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSByb3dEZXNlbGVjdE9iai5jYW5jZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcm93SW5TdHJpbmcgPSAncm93JztcbiAgICAgICAgICAgIHZhciB0YXJnZXRfMiA9ICd0YXJnZXQnO1xuICAgICAgICAgICAgdmFyIHJvd2lkeCA9ICdyb3dJbmRleCc7XG4gICAgICAgICAgICB2YXIgcm93aWR4ZXggPSAncm93SW5kZXhlcyc7XG4gICAgICAgICAgICB2YXIgZGF0YVR4dCA9ICdkYXRhJztcbiAgICAgICAgICAgIHZhciBmb3JlaWduS2V5ID0gJ2ZvcmVpZ25LZXlEYXRhJztcbiAgICAgICAgICAgIHJvd0Rlc2VsZWN0T2JqW1wiXCIgKyByb3dJblN0cmluZ10gPSByb3c7XG4gICAgICAgICAgICByb3dEZXNlbGVjdE9ialtcIlwiICsgdGFyZ2V0XzJdID0gdGhpcy5hY3R1YWxUYXJnZXQ7XG4gICAgICAgICAgICB2YXIgaXNIZWFkZXJDaGVja0J4Q2xpY2sgPSB0aGlzLmFjdHVhbFRhcmdldCAmJiAhaXNOdWxsT3JVbmRlZmluZWQoY2xvc2VzdCh0aGlzLmFjdHVhbFRhcmdldCwgJ3RoZWFkJykpO1xuICAgICAgICAgICAgaWYgKGlzSGVhZGVyQ2hlY2tCeENsaWNrIHx8IHJvd0luZGV4Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICByb3dEZXNlbGVjdE9ialtcIlwiICsgcm93aWR4XSA9IHJvd0luZGV4WzBdO1xuICAgICAgICAgICAgICAgIHJvd0Rlc2VsZWN0T2JqW1wiXCIgKyByb3dpZHhleF0gPSByb3dJbmRleDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHJvd0luZGV4Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJvd0Rlc2VsZWN0T2JqW1wiXCIgKyBkYXRhVHh0XSA9IHJvd0Rlc2VsZWN0T2JqW1wiXCIgKyBkYXRhVHh0XVswXTtcbiAgICAgICAgICAgICAgICByb3dEZXNlbGVjdE9ialtcIlwiICsgcm93SW5TdHJpbmddID0gcm93RGVzZWxlY3RPYmpbXCJcIiArIHJvd0luU3RyaW5nXVswXTtcbiAgICAgICAgICAgICAgICByb3dEZXNlbGVjdE9ialtcIlwiICsgZm9yZWlnbktleV0gPSByb3dEZXNlbGVjdE9ialtcIlwiICsgZm9yZWlnbktleV1bMF07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNBZGRSb3dzVG9TZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgcm93RGVzZWxlY3RPYmpbXCJcIiArIHJvd2lkeGV4XSA9IHJvd0luZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIodHlwZSwgcm93RGVzZWxlY3RPYmosIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNDYW5jZWxEZVNlbGVjdCA9IGFyZ3NbXCJcIiArIGNhbmNsXzFdO1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuaXNDYW5jZWxEZVNlbGVjdCB8fCAoIV90aGlzLmlzUm93Q2xpY2tlZCAmJiAhX3RoaXMuaXNJbnRlcmFjdGVkICYmICFfdGhpcy5jaGVja1NlbGVjdEFsbENsaWNrZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZVBlcnNpc3RDb2xsZWN0aW9uKHJvd1swXSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVDaGVja0JveGVzKHJvd1swXSwgdW5kZWZpbmVkLCByb3dJbmRleFswXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb3dEZXNlbGVjdENhbGxCYWNrICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93RGVzZWxlY3RDYWxsQmFjaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MucGVyc2lzdFNlbGVjdGlvbiAmJiAhdGhpcy5pc0ludGVyYWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChyb3dEZXNlbGVjdENhbGxCYWNrICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByb3dEZXNlbGVjdENhbGxCYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZ2V0Um93T2JqID0gZnVuY3Rpb24gKHJvdykge1xuICAgICAgICBpZiAocm93ID09PSB2b2lkIDApIHsgcm93ID0gdGhpcy5jdXJyZW50SW5kZXg7IH1cbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHJvdykpIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHJvdyA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHJvdyA9IHRoaXMucGFyZW50LmdldFJvd0J5SW5kZXgocm93KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm93KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZ2V0Um93T2JqZWN0RnJvbVVJRChyb3cuZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpKSB8fCB7fTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge307XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZWxlY3RzIGEgY2VsbCBieSB0aGUgZ2l2ZW4gaW5kZXguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtJSW5kZXh9IGNlbGxJbmRleCAtIERlZmluZXMgdGhlIHJvdyBhbmQgY29sdW1uIGluZGV4ZXMuXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gaXNUb2dnbGUgLSBJZiBzZXQgdG8gdHJ1ZSwgdGhlbiBpdCB0b2dnbGVzIHRoZSBzZWxlY3Rpb24uXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zZWxlY3RDZWxsID0gZnVuY3Rpb24gKGNlbGxJbmRleCwgaXNUb2dnbGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzQ2VsbFR5cGUoKSB8fCAodGhpcy5pc0NlbGxUeXBlKCkgJiYgKHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8XG4gICAgICAgICAgICAodGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgJiYgdGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZSkpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciBhcmdzO1xuICAgICAgICB2YXIgc2VsZWN0ZWRDZWxsID0gZ09iai5nZXRDZWxsRnJvbUluZGV4KGNlbGxJbmRleC5yb3dJbmRleCwgdGhpcy5nZXRDb2xJbmRleChjZWxsSW5kZXgucm93SW5kZXgsIGNlbGxJbmRleC5jZWxsSW5kZXgpKTtcbiAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSBjZWxsSW5kZXgucm93SW5kZXg7XG4gICAgICAgIHZhciBzZWxlY3RlZERhdGEgPSB0aGlzLmdldEN1cnJlbnRCYXRjaFJlY29yZENoYW5nZXMoKVt0aGlzLmN1cnJlbnRJbmRleF07XG4gICAgICAgIGlmICghdGhpcy5pc0NlbGxUeXBlKCkgfHwgIXNlbGVjdGVkQ2VsbCB8fCB0aGlzLmlzRWRpdGluZygpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzQ2VsbFNlbGVjdGVkID0gc2VsZWN0ZWRDZWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1jZWxsc2VsZWN0aW9uYmFja2dyb3VuZCcpO1xuICAgICAgICBpc1RvZ2dsZSA9ICFpc1RvZ2dsZSA/IGlzVG9nZ2xlIDogKCFpc1VuZGVmaW5lZCh0aGlzLnByZXZDSWR4cykgJiZcbiAgICAgICAgICAgIGNlbGxJbmRleC5yb3dJbmRleCA9PT0gdGhpcy5wcmV2Q0lkeHMucm93SW5kZXggJiYgY2VsbEluZGV4LmNlbGxJbmRleCA9PT0gdGhpcy5wcmV2Q0lkeHMuY2VsbEluZGV4ICYmXG4gICAgICAgICAgICBpc0NlbGxTZWxlY3RlZCk7XG4gICAgICAgIGlmICghaXNUb2dnbGUpIHtcbiAgICAgICAgICAgIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgZGF0YTogc2VsZWN0ZWREYXRhLCBjZWxsSW5kZXg6IGNlbGxJbmRleCxcbiAgICAgICAgICAgICAgICBpc0N0cmxQcmVzc2VkOiB0aGlzLmlzTXVsdGlDdHJsUmVxdWVzdCwgaXNTaGlmdFByZXNzZWQ6IHRoaXMuaXNNdWx0aVNoaWZ0UmVxdWVzdCxcbiAgICAgICAgICAgICAgICBwcmV2aW91c1Jvd0NlbGw6IHRoaXMucHJldkVDSWR4cyA/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q2VsbEluZGV4KHRoaXMucHJldkVDSWR4cy5yb3dJbmRleCwgdGhpcy5wcmV2RUNJZHhzLmNlbGxJbmRleCkgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBmYWxzZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50Q2VsbCA9ICdjdXJyZW50Q2VsbCc7XG4gICAgICAgICAgICBhcmdzW1wiXCIgKyBjdXJyZW50Q2VsbF0gPSBzZWxlY3RlZENlbGw7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNSb3dDZWxsSW5kZXggPSAncHJldmlvdXNSb3dDZWxsSW5kZXgnO1xuICAgICAgICAgICAgYXJnc1tcIlwiICsgcHJldmlvdXNSb3dDZWxsSW5kZXhdID0gdGhpcy5wcmV2RUNJZHhzO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQudHJpZ2dlcihldmVudHMuY2VsbFNlbGVjdGluZywgdGhpcy5mRGF0YVVwZGF0ZShhcmdzKSwgdGhpcy5zdWNjZXNzQ2FsbEJhY2soYXJncywgaXNUb2dnbGUsIGNlbGxJbmRleCwgc2VsZWN0ZWRDZWxsLCBzZWxlY3RlZERhdGEpKTtcbiAgICAgICAgICAgIHRoaXMuY2VsbHNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3VjY2Vzc0NhbGxCYWNrKGFyZ3MsIGlzVG9nZ2xlLCBjZWxsSW5kZXgsIHNlbGVjdGVkQ2VsbCwgc2VsZWN0ZWREYXRhKShhcmdzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zdWNjZXNzQ2FsbEJhY2sgPSBmdW5jdGlvbiAoY2VsbFNlbGVjdGluZ0FyZ3MsIGlzVG9nZ2xlLCBjZWxsSW5kZXgsIHNlbGVjdGVkQ2VsbCwgc2VsZWN0ZWREYXRhKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoY2VsbFNlbGVjdGluZ0FyZ3MpIHtcbiAgICAgICAgICAgIHZhciBjbmNsID0gJ2NhbmNlbCc7XG4gICAgICAgICAgICB2YXIgY3VycmVudENlbGwgPSAnY3VycmVudENlbGwnO1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjZWxsU2VsZWN0aW5nQXJncykgJiYgY2VsbFNlbGVjdGluZ0FyZ3NbXCJcIiArIGNuY2xdID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc1RvZ2dsZSkge1xuICAgICAgICAgICAgICAgIGNlbGxTZWxlY3RpbmdBcmdzW1wiXCIgKyBjdXJyZW50Q2VsbF0gPSBjZWxsU2VsZWN0aW5nQXJnc1tcIlwiICsgY3VycmVudENlbGxdID8gY2VsbFNlbGVjdGluZ0FyZ3NbXCJcIiArIGN1cnJlbnRDZWxsXSA6IHNlbGVjdGVkQ2VsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLmNsZWFyQ2VsbCgpO1xuICAgICAgICAgICAgaWYgKCFpc1RvZ2dsZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZUNlbGxTZWxlY3Rpb24oc2VsZWN0ZWRDZWxsLCBjZWxsSW5kZXgucm93SW5kZXgsIGNlbGxJbmRleC5jZWxsSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc1RvZ2dsZSkge1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgICAgICAgICBkYXRhOiBzZWxlY3RlZERhdGEsIGNlbGxJbmRleDogY2VsbEluZGV4LCBjdXJyZW50Q2VsbDogc2VsZWN0ZWRDZWxsLFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFJvd0NlbGxJbmRleDogX3RoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcyxcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNSb3dDZWxsOiBfdGhpcy5wcmV2RUNJZHhzID9cbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmdldENlbGxJbmRleChfdGhpcy5wcmV2RUNJZHhzLnJvd0luZGV4LCBfdGhpcy5wcmV2RUNJZHhzLmNlbGxJbmRleCkgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBwcmV2aW91c1Jvd0NlbGxJbmRleCA9ICdwcmV2aW91c1Jvd0NlbGxJbmRleCc7XG4gICAgICAgICAgICAgICAgYXJnc1tcIlwiICsgcHJldmlvdXNSb3dDZWxsSW5kZXhdID0gX3RoaXMucHJldkVDSWR4cztcbiAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVDZWxsUHJvcHMoY2VsbEluZGV4LCBjZWxsSW5kZXgpO1xuICAgICAgICAgICAgICAgIF90aGlzLm9uQWN0aW9uQ29tcGxldGUoYXJncywgZXZlbnRzLmNlbGxTZWxlY3RlZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmdldENlbGxJbmRleCA9IGZ1bmN0aW9uIChySWR4LCBjSWR4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5nZXRDZWxsRnJvbUluZGV4KHJJZHgsIGNJZHgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VsZWN0cyBhIHJhbmdlIG9mIGNlbGxzIGZyb20gc3RhcnQgYW5kIGVuZCBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7SUluZGV4fSBzdGFydEluZGV4IC0gU3BlY2lmaWVzIHRoZSByb3cgYW5kIGNvbHVtbidzIHN0YXJ0IGluZGV4LlxuICAgICAqIEBwYXJhbSAge0lJbmRleH0gZW5kSW5kZXggLSBTcGVjaWZpZXMgdGhlIHJvdyBhbmQgY29sdW1uJ3MgZW5kIGluZGV4LlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuc2VsZWN0Q2VsbHNCeVJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5pc0NlbGxUeXBlKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgc2VsZWN0ZWRDZWxsID0gdGhpcy5wYXJlbnQuaXNTcGFuID8gZ2V0Q2VsbEZyb21Sb3codGhpcy5wYXJlbnQsIHN0YXJ0SW5kZXgucm93SW5kZXgsIHN0YXJ0SW5kZXguY2VsbEluZGV4KSA6XG4gICAgICAgICAgICBnT2JqLmdldENlbGxGcm9tSW5kZXgoc3RhcnRJbmRleC5yb3dJbmRleCwgc3RhcnRJbmRleC5jZWxsSW5kZXgpO1xuICAgICAgICB2YXIgbWluO1xuICAgICAgICB2YXIgbWF4O1xuICAgICAgICB2YXIgc3RJbmRleCA9IHN0YXJ0SW5kZXg7XG4gICAgICAgIHZhciBlZEluZGV4ID0gZW5kSW5kZXggPSBlbmRJbmRleCA/IGVuZEluZGV4IDogc3RhcnRJbmRleDtcbiAgICAgICAgdmFyIGNlbGxJbmRleGVzO1xuICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IHN0YXJ0SW5kZXgucm93SW5kZXg7XG4gICAgICAgIHZhciBjbmNsID0gJ2NhbmNlbCc7XG4gICAgICAgIHZhciBzZWxlY3RlZERhdGEgPSB0aGlzLmdldEN1cnJlbnRCYXRjaFJlY29yZENoYW5nZXMoKVt0aGlzLmN1cnJlbnRJbmRleF07XG4gICAgICAgIGlmICh0aGlzLmlzU2luZ2xlU2VsKCkgfHwgIXRoaXMuaXNDZWxsVHlwZSgpIHx8IHRoaXMuaXNFZGl0aW5nKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGRhdGE6IHNlbGVjdGVkRGF0YSwgY2VsbEluZGV4OiBzdGFydEluZGV4LCBjdXJyZW50Q2VsbDogc2VsZWN0ZWRDZWxsLFxuICAgICAgICAgICAgaXNDdHJsUHJlc3NlZDogdGhpcy5pc011bHRpQ3RybFJlcXVlc3QsIGlzU2hpZnRQcmVzc2VkOiB0aGlzLmlzTXVsdGlTaGlmdFJlcXVlc3QsXG4gICAgICAgICAgICBwcmV2aW91c1Jvd0NlbGw6IHRoaXMucHJldkVDSWR4cyA/IHRoaXMuZ2V0Q2VsbEluZGV4KHRoaXMucHJldkVDSWR4cy5yb3dJbmRleCwgdGhpcy5wcmV2RUNJZHhzLmNlbGxJbmRleCkgOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHByZXZpb3VzUm93Q2VsbEluZGV4ID0gJ3ByZXZpb3VzUm93Q2VsbEluZGV4JztcbiAgICAgICAgYXJnc1tcIlwiICsgcHJldmlvdXNSb3dDZWxsSW5kZXhdID0gdGhpcy5wcmV2RUNJZHhzO1xuICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5jZWxsU2VsZWN0aW5nLCB0aGlzLmZEYXRhVXBkYXRlKGFyZ3MpLCBmdW5jdGlvbiAoY2VsbFNlbGVjdGluZ0FyZ3MpIHtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY2VsbFNlbGVjdGluZ0FyZ3MpICYmIGNlbGxTZWxlY3RpbmdBcmdzW1wiXCIgKyBjbmNsXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLmNsZWFyQ2VsbCgpO1xuICAgICAgICAgICAgaWYgKHN0YXJ0SW5kZXgucm93SW5kZXggPiBlbmRJbmRleC5yb3dJbmRleCkge1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gc3RhcnRJbmRleDtcbiAgICAgICAgICAgICAgICBzdGFydEluZGV4ID0gZW5kSW5kZXg7XG4gICAgICAgICAgICAgICAgZW5kSW5kZXggPSB0ZW1wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0SW5kZXgucm93SW5kZXg7IGkgPD0gZW5kSW5kZXgucm93SW5kZXg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5jZWxsU2VsZWN0aW9uTW9kZS5pbmRleE9mKCdCb3gnKSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbWluID0gaSA9PT0gc3RhcnRJbmRleC5yb3dJbmRleCA/IChzdGFydEluZGV4LmNlbGxJbmRleCkgOiAwO1xuICAgICAgICAgICAgICAgICAgICBtYXggPSBpID09PSBlbmRJbmRleC5yb3dJbmRleCA/IChlbmRJbmRleC5jZWxsSW5kZXgpIDogX3RoaXMuZ2V0TGFzdENvbEluZGV4KGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbWluID0gc3RhcnRJbmRleC5jZWxsSW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIG1heCA9IGVuZEluZGV4LmNlbGxJbmRleDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2VsbEluZGV4ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gbWluIDwgbWF4ID8gbWluIDogbWF4LCBsZW4gPSBtaW4gPiBtYXggPyBtaW4gOiBtYXg7IGogPD0gbGVuOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDZWxsID0gX3RoaXMucGFyZW50LmlzU3BhbiA/IGdldENlbGxGcm9tUm93KGdPYmosIGksIGopIDogZ09iai5nZXRDZWxsRnJvbUluZGV4KGksIGopO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdGVkQ2VsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2VsbEluZGV4ZXMucHVzaChqKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlQ2VsbFNlbGVjdGlvbihzZWxlY3RlZENlbGwpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5hZGRBdHRyaWJ1dGUoc2VsZWN0ZWRDZWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcy5wdXNoKHsgcm93SW5kZXg6IGksIGNlbGxJbmRleGVzOiBjZWxsSW5kZXhlcyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjZWxsU2VsZWN0ZWRBcmdzID0ge1xuICAgICAgICAgICAgICAgIGRhdGE6IHNlbGVjdGVkRGF0YSwgY2VsbEluZGV4OiBlZEluZGV4LCBjdXJyZW50Q2VsbDogZ09iai5nZXRDZWxsRnJvbUluZGV4KGVkSW5kZXgucm93SW5kZXgsIGVkSW5kZXguY2VsbEluZGV4KSxcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFJvd0NlbGxJbmRleDogX3RoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcyxcbiAgICAgICAgICAgICAgICBwcmV2aW91c1Jvd0NlbGw6IF90aGlzLnByZXZFQ0lkeHMgPyBfdGhpcy5nZXRDZWxsSW5kZXgoX3RoaXMucHJldkVDSWR4cy5yb3dJbmRleCwgX3RoaXMucHJldkVDSWR4cy5jZWxsSW5kZXgpIDogdW5kZWZpbmVkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHByZXZpb3VzUm93Q2VsbEluZGV4ID0gJ3ByZXZpb3VzUm93Q2VsbEluZGV4JztcbiAgICAgICAgICAgIGNlbGxTZWxlY3RlZEFyZ3NbXCJcIiArIHByZXZpb3VzUm93Q2VsbEluZGV4XSA9IF90aGlzLnByZXZFQ0lkeHM7XG4gICAgICAgICAgICBpZiAoIV90aGlzLmlzRHJhZ2dlZCkge1xuICAgICAgICAgICAgICAgIF90aGlzLm9uQWN0aW9uQ29tcGxldGUoY2VsbFNlbGVjdGVkQXJncywgZXZlbnRzLmNlbGxTZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgX3RoaXMuY2VsbHNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLnVwZGF0ZUNlbGxQcm9wcyhzdEluZGV4LCBlZEluZGV4KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZWxlY3RzIGEgY29sbGVjdGlvbiBvZiBjZWxscyBieSByb3cgYW5kIGNvbHVtbiBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7SVNlbGVjdGVkQ2VsbFtdfSByb3dDZWxsSW5kZXhlcyAtIFNwZWNpZmllcyB0aGUgcm93IGFuZCBjb2x1bW4gaW5kZXhlcy5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnNlbGVjdENlbGxzID0gZnVuY3Rpb24gKHJvd0NlbGxJbmRleGVzKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0NlbGxUeXBlKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgc2VsZWN0ZWRDZWxsID0gZ09iai5nZXRDZWxsRnJvbUluZGV4KHJvd0NlbGxJbmRleGVzWzBdLnJvd0luZGV4LCByb3dDZWxsSW5kZXhlc1swXS5jZWxsSW5kZXhlc1swXSk7XG4gICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gcm93Q2VsbEluZGV4ZXNbMF0ucm93SW5kZXg7XG4gICAgICAgIHZhciBzZWxlY3RlZERhdGEgPSB0aGlzLmdldEN1cnJlbnRCYXRjaFJlY29yZENoYW5nZXMoKVt0aGlzLmN1cnJlbnRJbmRleF07XG4gICAgICAgIGlmICh0aGlzLmlzU2luZ2xlU2VsKCkgfHwgIXRoaXMuaXNDZWxsVHlwZSgpIHx8IHRoaXMuaXNFZGl0aW5nKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2VsbFNlbGVjdEFyZ3MgPSB7XG4gICAgICAgICAgICBkYXRhOiBzZWxlY3RlZERhdGEsIGNlbGxJbmRleDogcm93Q2VsbEluZGV4ZXNbMF0uY2VsbEluZGV4ZXNbMF0sXG4gICAgICAgICAgICBjdXJyZW50Q2VsbDogc2VsZWN0ZWRDZWxsLCBpc0N0cmxQcmVzc2VkOiB0aGlzLmlzTXVsdGlDdHJsUmVxdWVzdCxcbiAgICAgICAgICAgIGlzU2hpZnRQcmVzc2VkOiB0aGlzLmlzTXVsdGlTaGlmdFJlcXVlc3QsXG4gICAgICAgICAgICBwcmV2aW91c1Jvd0NlbGw6IHRoaXMucHJldkVDSWR4cyA/IHRoaXMuZ2V0Q2VsbEluZGV4KHRoaXMucHJldkVDSWR4cy5yb3dJbmRleCwgdGhpcy5wcmV2RUNJZHhzLmNlbGxJbmRleCkgOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHByZXZpb3VzUm93Q2VsbEluZGV4ID0gJ3ByZXZpb3VzUm93Q2VsbEluZGV4JztcbiAgICAgICAgY2VsbFNlbGVjdEFyZ3NbXCJcIiArIHByZXZpb3VzUm93Q2VsbEluZGV4XSA9IHRoaXMucHJldkVDSWR4cztcbiAgICAgICAgdGhpcy5vbkFjdGlvbkJlZ2luKGNlbGxTZWxlY3RBcmdzLCBldmVudHMuY2VsbFNlbGVjdGluZyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByb3dDZWxsSW5kZXhlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGNlbGxMZW4gPSByb3dDZWxsSW5kZXhlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbEluZGV4ZXMubGVuZ3RoOyBqIDwgY2VsbExlbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRDZWxsID0gZ09iai5nZXRDZWxsRnJvbUluZGV4KHJvd0NlbGxJbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5yb3dJbmRleCwgcm93Q2VsbEluZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxJbmRleGVzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxlY3RlZENlbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ2VsbFNlbGVjdGlvbihzZWxlY3RlZENlbGwpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQXR0cmlidXRlKHNlbGVjdGVkQ2VsbCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRSb3dDZWxsSW5kZXgoeyByb3dJbmRleDogcm93Q2VsbEluZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnJvd0luZGV4LFxuICAgICAgICAgICAgICAgICAgICBjZWxsSW5kZXg6IHJvd0NlbGxJbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxsSW5kZXhlc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVDZWxsUHJvcHMoeyByb3dJbmRleDogcm93Q2VsbEluZGV4ZXNbMF0ucm93SW5kZXgsIGNlbGxJbmRleDogcm93Q2VsbEluZGV4ZXNbMF0uY2VsbEluZGV4ZXNbMF0gfSwgeyByb3dJbmRleDogcm93Q2VsbEluZGV4ZXNbMF0ucm93SW5kZXgsIGNlbGxJbmRleDogcm93Q2VsbEluZGV4ZXNbMF0uY2VsbEluZGV4ZXNbMF0gfSk7XG4gICAgICAgIHZhciBjZWxsU2VsZWN0ZWRBcmdzID0ge1xuICAgICAgICAgICAgZGF0YTogc2VsZWN0ZWREYXRhLCBjZWxsSW5kZXg6IHJvd0NlbGxJbmRleGVzWzBdLmNlbGxJbmRleGVzWzBdLFxuICAgICAgICAgICAgY3VycmVudENlbGw6IHNlbGVjdGVkQ2VsbCwgc2VsZWN0ZWRSb3dDZWxsSW5kZXg6IHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcyxcbiAgICAgICAgICAgIHByZXZpb3VzUm93Q2VsbDogdGhpcy5wcmV2RUNJZHhzID8gdGhpcy5nZXRDZWxsSW5kZXgodGhpcy5wcmV2RUNJZHhzLnJvd0luZGV4LCB0aGlzLnByZXZFQ0lkeHMuY2VsbEluZGV4KSA6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgICB2YXIgcHJ2Um93Q2VsbEluZGV4ID0gJ3ByZXZpb3VzUm93Q2VsbEluZGV4JztcbiAgICAgICAgY2VsbFNlbGVjdGVkQXJnc1tcIlwiICsgcHJ2Um93Q2VsbEluZGV4XSA9IHRoaXMucHJldkVDSWR4cztcbiAgICAgICAgdGhpcy5vbkFjdGlvbkNvbXBsZXRlKGNlbGxTZWxlY3RlZEFyZ3MsIGV2ZW50cy5jZWxsU2VsZWN0ZWQpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VsZWN0IGNlbGxzIHdpdGggZXhpc3RpbmcgY2VsbCBzZWxlY3Rpb24gYnkgcGFzc2luZyByb3cgYW5kIGNvbHVtbiBpbmRleC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7SUluZGV4fSBjZWxsSW5kZXhlcyAtIERlZmluZXMgdGhlIGNvbGxlY3Rpb24gb2Ygcm93IGFuZCBjb2x1bW4gaW5kZXguXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuYWRkQ2VsbHNUb1NlbGVjdGlvbiA9IGZ1bmN0aW9uIChjZWxsSW5kZXhlcykge1xuICAgICAgICBpZiAoIXRoaXMuaXNDZWxsVHlwZSgpIHx8ICh0aGlzLmlzQ2VsbFR5cGUoKSAmJiAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gfHxcbiAgICAgICAgICAgICh0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyAmJiB0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlKSkpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHNlbGVjdGVkQ2VsbDtcbiAgICAgICAgdmFyIGluZGV4O1xuICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IGNlbGxJbmRleGVzWzBdLnJvd0luZGV4O1xuICAgICAgICB2YXIgY25jbCA9ICdjYW5jZWwnO1xuICAgICAgICB2YXIgc2VsZWN0ZWREYXRhID0gdGhpcy5nZXRDdXJyZW50QmF0Y2hSZWNvcmRDaGFuZ2VzKClbdGhpcy5jdXJyZW50SW5kZXhdO1xuICAgICAgICBpZiAodGhpcy5pc1NpbmdsZVNlbCgpIHx8ICF0aGlzLmlzQ2VsbFR5cGUoKSB8fCB0aGlzLmlzRWRpdGluZygpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oaWRlQXV0b0ZpbGwoKTtcbiAgICAgICAgdmFyIHJvd09iajtcbiAgICAgICAgcm93T2JqID0gZ09iai5nZXRSb3dzT2JqZWN0KClbY2VsbEluZGV4ZXNbMF0ucm93SW5kZXhdO1xuICAgICAgICBpZiAoZ09iai5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcm93T2JqID0gZ09iai5nZXRSb3dPYmplY3RGcm9tVUlEKHRoaXMudGFyZ2V0LnBhcmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZm9yZWlnbktleURhdGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBjZWxsSW5kZXhlc18xID0gY2VsbEluZGV4ZXM7IF9pIDwgY2VsbEluZGV4ZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBjZWxsSW5kZXggPSBjZWxsSW5kZXhlc18xW19pXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5yb3dJbmRleCA9PT0gY2VsbEluZGV4LnJvd0luZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZWN0ZWRDZWxsID0gZ09iai5nZXRDZWxsRnJvbUluZGV4KGNlbGxJbmRleC5yb3dJbmRleCwgdGhpcy5nZXRDb2xJbmRleChjZWxsSW5kZXgucm93SW5kZXgsIGNlbGxJbmRleC5jZWxsSW5kZXgpKTtcbiAgICAgICAgICAgIHZhciBpZHggPSBjZWxsSW5kZXguY2VsbEluZGV4O1xuICAgICAgICAgICAgaWYgKGdPYmouZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3JlaWduS2V5RGF0YS5wdXNoKHJvd09iai5jZWxsc1tpZHggKyBnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGhdLmZvcmVpZ25LZXlEYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvcmVpZ25LZXlEYXRhLnB1c2gocm93T2JqLmNlbGxzW3BhcnNlSW50KGlkeC50b1N0cmluZygpLCAxMCldLmZvcmVpZ25LZXlEYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsIGRhdGE6IHNlbGVjdGVkRGF0YSwgY2VsbEluZGV4OiBjZWxsSW5kZXhlc1swXSxcbiAgICAgICAgICAgICAgICBpc1NoaWZ0UHJlc3NlZDogdGhpcy5pc011bHRpU2hpZnRSZXF1ZXN0LFxuICAgICAgICAgICAgICAgIGN1cnJlbnRDZWxsOiBzZWxlY3RlZENlbGwsIGlzQ3RybFByZXNzZWQ6IHRoaXMuaXNNdWx0aUN0cmxSZXF1ZXN0LFxuICAgICAgICAgICAgICAgIHByZXZpb3VzUm93Q2VsbDogdGhpcy5wcmV2RUNJZHhzID9cbiAgICAgICAgICAgICAgICAgICAgZ09iai5nZXRDZWxsRnJvbUluZGV4KHRoaXMucHJldkVDSWR4cy5yb3dJbmRleCwgdGhpcy5wcmV2RUNJZHhzLmNlbGxJbmRleCkgOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcHJ2Um93Q2VsbEluZGV4ID0gJ3ByZXZpb3VzUm93Q2VsbEluZGV4JztcbiAgICAgICAgICAgIGFyZ3NbXCJcIiArIHBydlJvd0NlbGxJbmRleF0gPSB0aGlzLnByZXZFQ0lkeHM7XG4gICAgICAgICAgICB2YXIgaXNVblNlbGVjdGVkID0gaW5kZXggPiAtMTtcbiAgICAgICAgICAgIGlmIChpc1VuU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRDZWxsSWR4ID0gdGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0uY2VsbEluZGV4ZXM7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ2VsbElkeC5pbmRleE9mKGNlbGxJbmRleC5jZWxsSW5kZXgpID4gLTEgfHwgKHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MubW9kZSA9PT0gJ0JvdGgnICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ2VsbC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZ3JpZGNoa2JveCcpICYmICFzZWxlY3RlZENlbGwuZ2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJykpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2VsbERlc2VsZWN0KGV2ZW50cy5jZWxsRGVzZWxlY3RpbmcsIFt7IHJvd0luZGV4OiBjZWxsSW5kZXgucm93SW5kZXgsIGNlbGxJbmRleGVzOiBbY2VsbEluZGV4LmNlbGxJbmRleF0gfV0sIHNlbGVjdGVkRGF0YSwgW3NlbGVjdGVkQ2VsbF0sIGZvcmVpZ25LZXlEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDZWxsSWR4LnNwbGljZShzZWxlY3RlZENlbGxJZHguaW5kZXhPZihjZWxsSW5kZXguY2VsbEluZGV4KSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZENlbGxJZHgubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENlbGwuY2xhc3NMaXN0LnJlbW92ZSgnZS1jZWxsc2VsZWN0aW9uYmFja2dyb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENlbGwucmVtb3ZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2VsbERlc2VsZWN0KGV2ZW50cy5jZWxsRGVzZWxlY3RlZCwgW3sgcm93SW5kZXg6IGNlbGxJbmRleC5yb3dJbmRleCwgY2VsbEluZGV4ZXM6IFtjZWxsSW5kZXguY2VsbEluZGV4XSB9XSwgc2VsZWN0ZWREYXRhLCBbc2VsZWN0ZWRDZWxsXSwgZm9yZWlnbktleURhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaXNVblNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25BY3Rpb25CZWdpbihhcmdzLCBldmVudHMuY2VsbFNlbGVjdGluZyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkUm93Q2VsbEluZGV4KHsgcm93SW5kZXg6IGNlbGxJbmRleC5yb3dJbmRleCwgY2VsbEluZGV4OiBjZWxsSW5kZXguY2VsbEluZGV4IH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNlbGxTZWxlY3Rpb24oc2VsZWN0ZWRDZWxsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRBdHRyaWJ1dGUoc2VsZWN0ZWRDZWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQWN0aW9uQmVnaW4oYXJncywgZXZlbnRzLmNlbGxTZWxlY3RpbmcpO1xuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoYXJncykgJiYgYXJnc1tcIlwiICsgY25jbF0gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNlbGxTZWxlY3Rpb24oc2VsZWN0ZWRDZWxsLCBjZWxsSW5kZXgucm93SW5kZXgsIGNlbGxJbmRleC5jZWxsSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc1VuU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2VsbFNlbGVjdGVkQXJncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogc2VsZWN0ZWREYXRhLCBjZWxsSW5kZXg6IGNlbGxJbmRleGVzWzBdLCBjdXJyZW50Q2VsbDogc2VsZWN0ZWRDZWxsLFxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1Jvd0NlbGw6IHRoaXMucHJldkVDSWR4cyA/IHRoaXMuZ2V0Q2VsbEluZGV4KHRoaXMucHJldkVDSWR4cy5yb3dJbmRleCwgdGhpcy5wcmV2RUNJZHhzLmNlbGxJbmRleCkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLCBzZWxlY3RlZFJvd0NlbGxJbmRleDogdGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjZWxsU2VsZWN0ZWRBcmdzW1wiXCIgKyBwcnZSb3dDZWxsSW5kZXhdID0gdGhpcy5wcmV2RUNJZHhzO1xuICAgICAgICAgICAgICAgIHRoaXMub25BY3Rpb25Db21wbGV0ZShjZWxsU2VsZWN0ZWRBcmdzLCBldmVudHMuY2VsbFNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNlbGxzZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNlbGxQcm9wcyhjZWxsSW5kZXgsIGNlbGxJbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZ2V0Q29sSW5kZXggPSBmdW5jdGlvbiAocm93SW5kZXgsIGluZGV4KSB7XG4gICAgICAgIHZhciBjb2wgPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5CeUluZGV4KGluZGV4KTtcbiAgICAgICAgdmFyIGNlbGxzID0gZ2V0Q2VsbHNCeVRhYmxlTmFtZSh0aGlzLnBhcmVudCwgY29sLCByb3dJbmRleCk7XG4gICAgICAgIGlmIChjZWxscykge1xuICAgICAgICAgICAgZm9yICh2YXIgbSA9IDA7IG0gPCBjZWxscy5sZW5ndGg7IG0rKykge1xuICAgICAgICAgICAgICAgIHZhciBjb2xJbmRleCA9IHBhcnNlSW50KGNlbGxzW3BhcnNlSW50KG0udG9TdHJpbmcoKSwgMTApXS5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYUNvbEluZGV4KSwgMTApIC0gMTtcbiAgICAgICAgICAgICAgICBpZiAoY29sSW5kZXggPT09IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmdldExhc3RDb2xJbmRleCA9IGZ1bmN0aW9uIChyb3dJbmRleCkge1xuICAgICAgICB2YXIgY2VsbHMgPSB0aGlzLnBhcmVudC5nZXREYXRhUm93cygpW3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0ucXVlcnlTZWxlY3RvckFsbCgndGQuZS1yb3djZWxsJyk7XG4gICAgICAgIHJldHVybiBwYXJzZUludChjZWxsc1tjZWxscy5sZW5ndGggLSAxXS5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYUNvbEluZGV4KSwgMTApIC0gMTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuY2xlYXJDZWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNsZWFyQ2VsbFNlbGVjdGlvbigpO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jZWxsRGVzZWxlY3QgPSBmdW5jdGlvbiAodHlwZSwgY2VsbEluZGV4ZXMsIGRhdGEsIGNlbGxzLCBmb3JlaWduS2V5RGF0YSkge1xuICAgICAgICB2YXIgY2FuY2wgPSAnY2FuY2VsJztcbiAgICAgICAgaWYgKGNlbGxzICYmIGNlbGxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgY2VsbHNfMSA9IGNlbGxzOyBfaSA8IGNlbGxzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNlbGwgPSBjZWxsc18xW19pXTtcbiAgICAgICAgICAgICAgICBpZiAoY2VsbCAmJiBjZWxsLmNsYXNzTGlzdC5jb250YWlucyhsaXRlcmFscy5ncmlkQ2hrQm94KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNoZWNrQm94ZXMoY2xvc2VzdChjZWxsLCAndHInKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgY2VsbHM6IGNlbGxzLCBkYXRhOiBkYXRhLCBjZWxsSW5kZXhlczogY2VsbEluZGV4ZXMsIGZvcmVpZ25LZXlEYXRhOiBmb3JlaWduS2V5RGF0YSwgY2FuY2VsOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKHR5cGUsIGFyZ3MpO1xuICAgICAgICB0aGlzLmlzUHJldmVudENlbGxTZWxlY3QgPSBhcmdzW1wiXCIgKyBjYW5jbF07XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZUNlbGxTZWxlY3Rpb24gPSBmdW5jdGlvbiAoc2VsZWN0ZWRDZWxsLCByb3dJbmRleCwgY2VsbEluZGV4KSB7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQocm93SW5kZXgpKSB7XG4gICAgICAgICAgICB0aGlzLmFkZFJvd0NlbGxJbmRleCh7IHJvd0luZGV4OiByb3dJbmRleCwgY2VsbEluZGV4OiBjZWxsSW5kZXggfSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZWN0ZWRDZWxsLmNsYXNzTGlzdC5hZGQoJ2UtY2VsbHNlbGVjdGlvbmJhY2tncm91bmQnKTtcbiAgICAgICAgaWYgKHNlbGVjdGVkQ2VsbC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMuZ3JpZENoa0JveCkpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2hlY2tCb3hlcyhjbG9zZXN0KHNlbGVjdGVkQ2VsbCwgJ3RyJyksIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWRkQXR0cmlidXRlKHNlbGVjdGVkQ2VsbCk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmFkZEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChjZWxsKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gY2VsbDtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjZWxsKSkge1xuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAndHJ1ZScpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByZXZlbnRGb2N1cykge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXMub25DbGljayh7IHRhcmdldDogY2VsbCB9LCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS51cGRhdGVDZWxsUHJvcHMgPSBmdW5jdGlvbiAoc3RhcnRJbmRleCwgZW5kSW5kZXgpIHtcbiAgICAgICAgdGhpcy5wcmV2Q0lkeHMgPSBzdGFydEluZGV4O1xuICAgICAgICB0aGlzLnByZXZFQ0lkeHMgPSBlbmRJbmRleDtcbiAgICAgICAgdGhpcy5pc0NlbGxTZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcy5sZW5ndGggJiYgdHJ1ZTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuYWRkUm93Q2VsbEluZGV4ID0gZnVuY3Rpb24gKHJvd0NlbGxJbmRleCkge1xuICAgICAgICB2YXIgaXNSb3dBdmFpbDtcbiAgICAgICAgdmFyIGluZGV4O1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5yb3dJbmRleCA9PT0gcm93Q2VsbEluZGV4LnJvd0luZGV4KSB7XG4gICAgICAgICAgICAgICAgaXNSb3dBdmFpbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpc1Jvd0F2YWlsKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0uY2VsbEluZGV4ZXMuaW5kZXhPZihyb3dDZWxsSW5kZXguY2VsbEluZGV4KSA8IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXNbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS5jZWxsSW5kZXhlcy5wdXNoKHJvd0NlbGxJbmRleC5jZWxsSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzLnB1c2goeyByb3dJbmRleDogcm93Q2VsbEluZGV4LnJvd0luZGV4LCBjZWxsSW5kZXhlczogW3Jvd0NlbGxJbmRleC5jZWxsSW5kZXhdIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBEZXNlbGVjdHMgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBjZWxscy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuY2xlYXJDZWxsU2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pc0NlbGxTZWxlY3RlZCkge1xuICAgICAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENlbGxzID0gdGhpcy5nZXRTZWxlY3RlZENlbGxzRWxlbWVudCgpO1xuICAgICAgICAgICAgdmFyIHJvd0NlbGwgPSB0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXM7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IFtdO1xuICAgICAgICAgICAgdmFyIGNlbGxzID0gW107XG4gICAgICAgICAgICB2YXIgZm9yZWlnbktleURhdGEgPSBbXTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50Vmlld0RhdGEgPSB0aGlzLmdldEN1cnJlbnRCYXRjaFJlY29yZENoYW5nZXMoKTtcbiAgICAgICAgICAgIHRoaXMuaGlkZUF1dG9GaWxsKCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcm93Q2VsbC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGRhdGEucHVzaChjdXJyZW50Vmlld0RhdGFbcm93Q2VsbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ucm93SW5kZXhdKTtcbiAgICAgICAgICAgICAgICB2YXIgcm93T2JqID0gdGhpcy5nZXRSb3dPYmoocm93Q2VsbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ucm93SW5kZXgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBjTGVuID0gcm93Q2VsbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbEluZGV4ZXMubGVuZ3RoOyBqIDwgY0xlbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyb3dPYmouY2VsbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmVpZ25LZXlEYXRhLnB1c2gocm93T2JqLmNlbGxzW3Jvd0NlbGxbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNlbGxJbmRleGVzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXV0uZm9yZWlnbktleURhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNlbGxzLnB1c2goZ09iai5nZXRDZWxsRnJvbUluZGV4KHJvd0NlbGxbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnJvd0luZGV4LCByb3dDZWxsW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxsSW5kZXhlc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNlbGxEZXNlbGVjdChldmVudHMuY2VsbERlc2VsZWN0aW5nLCByb3dDZWxsLCBkYXRhLCBjZWxscywgZm9yZWlnbktleURhdGEpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNQcmV2ZW50Q2VsbFNlbGVjdCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBzZWxlY3RlZENlbGxzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRDZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LnJlbW92ZSgnZS1jZWxsc2VsZWN0aW9uYmFja2dyb3VuZCcpO1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkQ2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuYmRyRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0hpZGVCb3JkZXJzKCdub25lJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuaXNDZWxsU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICghdGhpcy5pc0RyYWdnZWQgJiYgdGhpcy5jZWxsc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNlbGxEZXNlbGVjdChldmVudHMuY2VsbERlc2VsZWN0ZWQsIHJvd0NlbGwsIGRhdGEsIGNlbGxzLCBmb3JlaWduS2V5RGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZ2V0U2VsZWN0ZWRDZWxsc0VsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciByb3dzID0gZ09iai5nZXREYXRhUm93cygpO1xuICAgICAgICB2YXIgY2VsbHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJvd3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGNlbGxzID0gY2VsbHMuY29uY2F0KFtdLnNsaWNlLmNhbGwocm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1jZWxsc2VsZWN0aW9uYmFja2dyb3VuZCcpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNlbGxzO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5tb3VzZU1vdmVIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLnN0b3BUaW1lcigpO1xuICAgICAgICB2YXIgZ0JSZWN0ID0gdGhpcy5wYXJlbnQuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgdmFyIHgxID0gdGhpcy54O1xuICAgICAgICB2YXIgeTEgPSB0aGlzLnk7XG4gICAgICAgIHZhciBwb3NpdGlvbiA9IGdldFBvc2l0aW9uKGUpO1xuICAgICAgICB2YXIgeDIgPSBwb3NpdGlvbi54IC0gZ0JSZWN0LmxlZnQ7XG4gICAgICAgIHZhciB5MiA9IHBvc2l0aW9uLnkgLSBnQlJlY3QudG9wO1xuICAgICAgICB2YXIgdG1wO1xuICAgICAgICB2YXIgdGFyZ2V0ID0gY2xvc2VzdChlLnRhcmdldCwgJ3RyJyk7XG4gICAgICAgIHRoaXMuaXNEcmFnZ2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKCF0aGlzLmlzQ2VsbERyYWcpIHtcbiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gY2xvc2VzdChkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHRoaXMucGFyZW50LmVsZW1lbnQub2Zmc2V0TGVmdCArIDIsIGUuY2xpZW50WSksICd0cicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHgxID4geDIpIHtcbiAgICAgICAgICAgICAgICB0bXAgPSB4MjtcbiAgICAgICAgICAgICAgICB4MiA9IHgxO1xuICAgICAgICAgICAgICAgIHgxID0gdG1wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHkxID4geTIpIHtcbiAgICAgICAgICAgICAgICB0bXAgPSB5MjtcbiAgICAgICAgICAgICAgICB5MiA9IHkxO1xuICAgICAgICAgICAgICAgIHkxID0gdG1wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSB4MSArICdweCc7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0geTEgKyAncHgnO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLndpZHRoID0geDIgLSB4MSArICdweCc7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0geTIgLSB5MSArICdweCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhcmdldCAmJiAhZS5jdHJsS2V5ICYmICFlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICB2YXIgcm93SW5kZXggPSBwYXJzZUludCh0YXJnZXQuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNDZWxsRHJhZykge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZUF1dG9GaWxsKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSb3dzQnlSYW5nZSh0aGlzLnN0YXJ0REluZGV4LCByb3dJbmRleCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1Jvd0RyYWdTZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgdGQgPSBwYXJlbnRzVW50aWwoZS50YXJnZXQsIGxpdGVyYWxzLnJvd0NlbGwpO1xuICAgICAgICAgICAgICAgIGlmICh0ZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0QUZDZWxsID0gdGhpcy5zdGFydENlbGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kQUZDZWxsID0gcGFyZW50c1VudGlsKGUudGFyZ2V0LCBsaXRlcmFscy5yb3dDZWxsKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0luZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0TGlrZUV4Y2VsKGUsIHJvd0luZGV4LCBwYXJzZUludCh0ZC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYUNvbEluZGV4KSwgMTApIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFlLmN0cmxLZXkgJiYgIWUuc2hpZnRLZXkgJiYgIXRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uICYmICF0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyAmJlxuICAgICAgICAgICAgIXRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uICYmICF0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICYmIHRoaXMuaXNDZWxsRHJhZykge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbihlLCBwb3NpdGlvbiwgdGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS51cGRhdGVTY3JvbGxQb3NpdGlvbiA9IGZ1bmN0aW9uIChtb3VzZUV2ZW50LCBwb3NpdGlvbiwgc2Nyb2xsRWxlbWVudCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY2xpZW50UmVjdCA9IHNjcm9sbEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGlmIChjbGllbnRSZWN0LmxlZnQgPj0gcG9zaXRpb24ueCAtIDIwIC1cbiAgICAgICAgICAgICh0aGlzLnBhcmVudC5lbmFibGVSdGwgJiYgdGhpcy5wYXJlbnQuaGVpZ2h0ICE9PSAnYXV0bycgPyBnZXRTY3JvbGxCYXJXaWR0aCgpIDogMCkpIHtcbiAgICAgICAgICAgIHRoaXMudGltZXIxID0gd2luZG93LnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsgX3RoaXMuc2V0U2Nyb2xsUG9zaXRpb24oc2Nyb2xsRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCwgX3RoaXMucGFyZW50LmVuYWJsZVJ0bCA/ICdyaWdodCcgOiAnbGVmdCcsIG1vdXNlRXZlbnQpOyB9LCAyMDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNsaWVudFJlY3QubGVmdCArIHNjcm9sbEVsZW1lbnQuY2xpZW50V2lkdGggLSAyMCAtXG4gICAgICAgICAgICAoIXRoaXMucGFyZW50LmVuYWJsZVJ0bCAmJiB0aGlzLnBhcmVudC5oZWlnaHQgIT09ICdhdXRvJyA/IGdldFNjcm9sbEJhcldpZHRoKCkgOiAwKSA8IHBvc2l0aW9uLngpIHtcbiAgICAgICAgICAgIHRoaXMudGltZXIxID0gd2luZG93LnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsgX3RoaXMuc2V0U2Nyb2xsUG9zaXRpb24oc2Nyb2xsRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZCwgX3RoaXMucGFyZW50LmVuYWJsZVJ0bCA/ICdsZWZ0JyA6ICdyaWdodCcsIG1vdXNlRXZlbnQpOyB9LCAyMDApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjbGllbnRSZWN0LnRvcCA+PSBwb3NpdGlvbi55IC0gKHRoaXMucGFyZW50LmdldFJvd0hlaWdodCgpICogMC41KSkge1xuICAgICAgICAgICAgdGhpcy50aW1lcjIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyBfdGhpcy5zZXRTY3JvbGxQb3NpdGlvbihzY3JvbGxFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkLCAndXAnLCBtb3VzZUV2ZW50KTsgfSwgMjAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjbGllbnRSZWN0LnRvcCArIHNjcm9sbEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gKHRoaXMucGFyZW50LmdldFJvd0hlaWdodCgpICogMC41KSAtXG4gICAgICAgICAgICAoc2Nyb2xsRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZC5zY3JvbGxXaWR0aCA+IHNjcm9sbEVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQub2Zmc2V0V2lkdGggP1xuICAgICAgICAgICAgICAgIGdldFNjcm9sbEJhcldpZHRoKCkgOiAwKSA8PSBwb3NpdGlvbi55KSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVyMiA9IHdpbmRvdy5zZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7IF90aGlzLnNldFNjcm9sbFBvc2l0aW9uKHNjcm9sbEVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQsICdkb3duJywgbW91c2VFdmVudCk7IH0sIDIwMCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuc3RvcFRpbWVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50aW1lcjEpIHtcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMudGltZXIxKTtcbiAgICAgICAgICAgIHRoaXMudGltZXIxID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50aW1lcjIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMudGltZXIyKTtcbiAgICAgICAgICAgIHRoaXMudGltZXIyID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByZXZlbnRGb2N1cyA9IGZhbHNlO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zZXRTY3JvbGxQb3NpdGlvbiA9IGZ1bmN0aW9uIChzY3JvbGxFbGVtZW50LCBkaXJlY3Rpb24sIG1vdXNlRXZlbnQpIHtcbiAgICAgICAgdmFyIHJvd0luZGV4ID0gLTE7XG4gICAgICAgIHZhciBjb2x1bW5JbmRleCA9IC0xO1xuICAgICAgICBpZiAodGhpcy5lbmRBRkNlbGwgfHwgdGhpcy5wcmV2RUNJZHhzKSB7XG4gICAgICAgICAgICByb3dJbmRleCA9IHRoaXMuZW5kQUZDZWxsID8gcGFyc2VJbnQodGhpcy5lbmRBRkNlbGwuZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkgOiB0aGlzLnByZXZFQ0lkeHMucm93SW5kZXg7XG4gICAgICAgICAgICBjb2x1bW5JbmRleCA9IHRoaXMuZW5kQUZDZWxsID8gcGFyc2VJbnQodGhpcy5lbmRBRkNlbGwuZ2V0QXR0cmlidXRlKCdhcmlhLWNvbGluZGV4JyksIDEwKSAtIDEgOiB0aGlzLnByZXZFQ0lkeHMuY2VsbEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICd1cCc6XG4gICAgICAgICAgICAgICAgaWYgKG1vdXNlRXZlbnQgJiYgY2xvc2VzdChtb3VzZUV2ZW50LnRhcmdldCwgJy5lLWhlYWRlcmNvbnRlbnQnKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQXV0b0ZpbGxTZWwgJiYgdGhpcy5zdGFydEFGQ2VsbCAmJiB0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXMubGVuZ3RoICYmXG4gICAgICAgICAgICAgICAgICAgICgodGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzLmxlbmd0aCA9PT0gMSAmJiB0aGlzLnN0YXJ0QUZDZWxsICE9PSB0aGlzLnN0YXJ0Q2VsbCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXMubGVuZ3RoID4gMSAmJiB0aGlzLnN0YXJ0QUZDZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCA+IDApKSkge1xuICAgICAgICAgICAgICAgICAgICByb3dJbmRleCA9IHBhcnNlSW50KHRoaXMuc3RhcnRBRkNlbGwuZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJvd0luZGV4IC09IDE7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93SW5kZXggKz0gdGhpcy5wYXJlbnQuZnJvemVuUm93cyArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLWV4cHJlc3Npb25zXG4gICAgICAgICAgICAgICAgcm93SW5kZXggPCAxID8gc2Nyb2xsRWxlbWVudC5zY3JvbGxUb3AgPSAwIDogc2Nyb2xsRWxlbWVudC5zY3JvbGxUb3AgLT0gdGhpcy5wYXJlbnQuZ2V0Um93QnlJbmRleChyb3dJbmRleClcbiAgICAgICAgICAgICAgICAgICAgLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2Rvd24nOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQXV0b0ZpbGxTZWwgJiYgdGhpcy5zdGFydEFGQ2VsbCAmJiB0aGlzLnN0YXJ0QUZDZWxsICE9PSB0aGlzLnN0YXJ0Q2VsbCkge1xuICAgICAgICAgICAgICAgICAgICByb3dJbmRleCA9IHBhcnNlSW50KHRoaXMuc3RhcnRBRkNlbGwuZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb3dJbmRleCA8IHRoaXMucGFyZW50LmdldFJvd3MoKS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd0luZGV4ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQXV0b0ZpbGxTZWwgJiYgdGhpcy5zdGFydEFGQ2VsbCAmJiB0aGlzLnN0YXJ0QUZDZWxsICE9PSB0aGlzLnN0YXJ0Q2VsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydEFGQ2VsbCA9IHRoaXMucGFyZW50LmdldENlbGxGcm9tSW5kZXgocm93SW5kZXgsIHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlc1swXS5jZWxsSW5kZXhlc1swXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsRWxlbWVudC5zY3JvbGxUb3AgKz0gdGhpcy5wYXJlbnQuZ2V0Um93QnlJbmRleChyb3dJbmRleCkub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsRWxlbWVudC5zY3JvbGxUb3AgPSBzY3JvbGxFbGVtZW50LnNjcm9sbEhlaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uSW5kZXggPiAwICYmIHJvd0luZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNBdXRvRmlsbFNlbCAmJiB0aGlzLnN0YXJ0QUZDZWxsICYmIHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICgodGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzWzBdLmNlbGxJbmRleGVzLmxlbmd0aCA+IDAgJiYgdGhpcy5zdGFydEFGQ2VsbCAhPT0gdGhpcy5zdGFydENlbGwpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlc1swXS5jZWxsSW5kZXhlcy5sZW5ndGggPiAxICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoIXRoaXMucGFyZW50LmVuYWJsZVJ0bCAmJiB0aGlzLnN0YXJ0QUZDZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgPiAwKSB8fCAodGhpcy5wYXJlbnQuZW5hYmxlUnRsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0QUZDZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgPCB0aGlzLnBhcmVudC5lbGVtZW50Lm9mZnNldFdpZHRoKSkpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uSW5kZXggPSBwYXJzZUludCh0aGlzLnN0YXJ0QUZDZWxsLmdldEF0dHJpYnV0ZSgnYXJpYS1jb2xpbmRleCcpLCAxMCkgLSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXh0RWxlbWVudF8xID0gdGhpcy5maW5kTmV4dENlbGwoc2Nyb2xsRWxlbWVudCwgZGlyZWN0aW9uLCBjb2x1bW5JbmRleCwgcm93SW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5JbmRleCA9IG5leHRFbGVtZW50XzEgPyBwYXJzZUludChuZXh0RWxlbWVudF8xLmdldEF0dHJpYnV0ZSgnYXJpYS1jb2xpbmRleCcpLCAxMCkgLSAxIDogLTE7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVSdGwgJiYgbmV4dEVsZW1lbnRfMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtZXhwcmVzc2lvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4IDwgMSA/IHNjcm9sbEVsZW1lbnQuc2Nyb2xsTGVmdCA9IHNjcm9sbEVsZW1lbnQuc2Nyb2xsV2lkdGggOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbEVsZW1lbnQuc2Nyb2xsTGVmdCArPSBuZXh0RWxlbWVudF8xLm9mZnNldFdpZHRoO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5leHRFbGVtZW50XzEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLWV4cHJlc3Npb25zXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5JbmRleCA8IDEgPyBzY3JvbGxFbGVtZW50LnNjcm9sbExlZnQgPSAwIDogc2Nyb2xsRWxlbWVudC5zY3JvbGxMZWZ0IC09IG5leHRFbGVtZW50XzEub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNBdXRvRmlsbFNlbCAmJiB0aGlzLnN0YXJ0QUZDZWxsICYmIHRoaXMuc3RhcnRBRkNlbGwgIT09IHRoaXMuc3RhcnRDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4ID0gcGFyc2VJbnQodGhpcy5zdGFydEFGQ2VsbC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnKSwgMTApIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNhc2UtZGVjbGFyYXRpb25zXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRFbGVtZW50ID0gdGhpcy5wYXJlbnQuZ2V0Q2VsbEZyb21JbmRleChyb3dJbmRleCwgY29sdW1uSW5kZXgpO1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jYXNlLWRlY2xhcmF0aW9uc1xuICAgICAgICAgICAgICAgIHZhciBuZXh0RWxlbWVudCA9IHRoaXMuZmluZE5leHRDZWxsKHNjcm9sbEVsZW1lbnQsIGRpcmVjdGlvbiwgY29sdW1uSW5kZXgsIHJvd0luZGV4KTtcbiAgICAgICAgICAgICAgICBpZiAobmV4dEVsZW1lbnQgJiYgdGhpcy5pc0F1dG9GaWxsU2VsICYmIHRoaXMuc3RhcnRBRkNlbGwgJiYgdGhpcy5zdGFydEFGQ2VsbCAhPT0gdGhpcy5zdGFydENlbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydEFGQ2VsbCA9IHRoaXMucGFyZW50LmdldENlbGxGcm9tSW5kZXgodGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzWzBdLnJvd0luZGV4LCBwYXJzZUludChuZXh0RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnKSwgMTApIC0gMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4ID0gbmV4dEVsZW1lbnQgPyBwYXJzZUludChuZXh0RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnKSwgMTApIC0gMSA6IC0xO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVSdGwgJiYgbmV4dEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtZXhwcmVzc2lvbnNcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uSW5kZXggPCB0aGlzLnBhcmVudC5jb2x1bW5zLmxlbmd0aCAtIDEgPyBzY3JvbGxFbGVtZW50LnNjcm9sbExlZnQgLT0gY3VycmVudEVsZW1lbnQub2Zmc2V0V2lkdGggOlxuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsRWxlbWVudC5zY3JvbGxMZWZ0ID0gLXNjcm9sbEVsZW1lbnQuc2Nyb2xsV2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5leHRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLWV4cHJlc3Npb25zXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4IDwgdGhpcy5wYXJlbnQuY29sdW1ucy5sZW5ndGggLSAxID8gc2Nyb2xsRWxlbWVudC5zY3JvbGxMZWZ0ICs9IGN1cnJlbnRFbGVtZW50Lm9mZnNldFdpZHRoIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbEVsZW1lbnQuc2Nyb2xsTGVmdCA9IHNjcm9sbEVsZW1lbnQuc2Nyb2xsV2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQXV0b0ZpbGxTZWwgJiYgKGNvbHVtbkluZGV4ID09PSB0aGlzLnBhcmVudC5jb2x1bW5zLmxlbmd0aCAtIDEgfHwgY29sdW1uSW5kZXggPT09IC0xKSAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0QUZDZWxsICYmIHRoaXMuZW5kQUZDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb25BRkJvcmRlcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsRWxlbWVudC5zY3JvbGxMZWZ0ID0gdGhpcy5wYXJlbnQuZW5hYmxlUnRsID8gLXNjcm9sbEVsZW1lbnQuc2Nyb2xsV2lkdGggOiBzY3JvbGxFbGVtZW50LnNjcm9sbFdpZHRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAocm93SW5kZXggPiAtMSAmJiByb3dJbmRleCA8IHRoaXMucGFyZW50LmdldFJvd3MoKS5sZW5ndGggJiYgY29sdW1uSW5kZXggPiAtMSkge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIHZhciBtb3VzZUV2ZW50XzEgPSB7IHRhcmdldDogdGhpcy5wYXJlbnQuZ2V0Q2VsbEZyb21JbmRleChyb3dJbmRleCwgY29sdW1uSW5kZXgpIH07XG4gICAgICAgICAgICBpZiAodGhpcy5pc0F1dG9GaWxsU2VsICYmIG1vdXNlRXZlbnRfMS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNlbGxzZWxlY3Rpb25iYWNrZ3JvdW5kJykgJiZcbiAgICAgICAgICAgICAgICAoKGRpcmVjdGlvbiA9PT0gJ2Rvd24nICYmIHBhcnNlSW50KG1vdXNlRXZlbnRfMS50YXJnZXQuZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkgPT09IHRoaXMucGFyZW50LmdldFJvd3MoKS5sZW5ndGggLSAxKSB8fFxuICAgICAgICAgICAgICAgICAgICAoZGlyZWN0aW9uID09PSAncmlnaHQnICYmIHBhcnNlSW50KG1vdXNlRXZlbnRfMS50YXJnZXQuZ2V0QXR0cmlidXRlKCdhcmlhLWNvbGluZGV4JyksIDEwKSAtIDEgPT09IHRoaXMucGFyZW50LmNvbHVtbnMubGVuZ3RoIC0gMSkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5lbmRBRkNlbGwgPSBtb3VzZUV2ZW50XzEudGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5wcmV2ZW50Rm9jdXMgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RMaWtlRXhjZWwobW91c2VFdmVudF8xLCByb3dJbmRleCwgY29sdW1uSW5kZXgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmZpbmROZXh0Q2VsbCA9IGZ1bmN0aW9uIChzY3JvbGxFbGVtZW50LCBkaXJlY3Rpb24sIGNvbHVtbkluZGV4LCByb3dJbmRleCkge1xuICAgICAgICB2YXIgbmV4dEVsZW1lbnQgPSB0aGlzLnBhcmVudC5nZXRDZWxsRnJvbUluZGV4KHJvd0luZGV4LCBkaXJlY3Rpb24gPT09ICdsZWZ0JyA/IGNvbHVtbkluZGV4IC0gMSA6IGNvbHVtbkluZGV4ICsgMSk7XG4gICAgICAgIGlmIChuZXh0RWxlbWVudCAmJiBuZXh0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaGlkZScpKSB7XG4gICAgICAgICAgICB2YXIgc2libGluZ0VsZXMgPSBuZXh0RWxlbWVudC5jbG9zZXN0KCd0cicpLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXJvd2NlbGw6bm90KC5lLWhpZGUpJyk7XG4gICAgICAgICAgICB2YXIgbmV4dEVsZUluZCA9IEFycmF5LmZyb20oc2libGluZ0VsZXMpLmluZGV4T2YobmV4dEVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nKTtcbiAgICAgICAgICAgIGlmIChuZXh0RWxlSW5kID4gMCAmJiBuZXh0RWxlSW5kIDwgc2libGluZ0VsZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgIG5leHRFbGVtZW50ID0gc2libGluZ0VsZXNbbmV4dEVsZUluZCArIChkaXJlY3Rpb24gPT09ICdsZWZ0JyA/IC0xIDogMSldO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXh0RWxlbWVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNjcm9sbEVsZW1lbnQuc2Nyb2xsTGVmdCA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5leHRFbGVtZW50O1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zZWxlY3RMaWtlRXhjZWwgPSBmdW5jdGlvbiAoZSwgcm93SW5kZXgsIGNlbGxJbmRleCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNBdXRvRmlsbFNlbCkge1xuICAgICAgICAgICAgdGhpcy5jbGVhckNlbGxTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbHNCeVJhbmdlKHsgcm93SW5kZXg6IHRoaXMuc3RhcnRESW5kZXgsIGNlbGxJbmRleDogdGhpcy5zdGFydERDZWxsSW5kZXggfSwgeyByb3dJbmRleDogcm93SW5kZXgsIGNlbGxJbmRleDogY2VsbEluZGV4IH0pO1xuICAgICAgICAgICAgdGhpcy5kcmF3Qm9yZGVycygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgeyAvL0F1dG9maWxsXG4gICAgICAgICAgICB0aGlzLnNob3dBRkJvcmRlcnMoKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0TGlrZUF1dG9GaWxsKGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnNldEZyb3plbkJvcmRlcnMgPSBmdW5jdGlvbiAocGFyZW50RWxlLCBib3JkZXIsIGJkclN0cikge1xuICAgICAgICB2YXIgd2lkdGggPSBib3JkZXIuc3R5bGUuYm9yZGVyV2lkdGgudG9TdHJpbmcoKS5zcGxpdCgnICcpO1xuICAgICAgICB2YXIgc3RyQ2VsbCA9IFsnJywgJ2UtbGVmdGZyZWV6ZScsICdlLXVuZnJlZXplJywgJ2UtbGVmdGZyZWV6ZScsICdlLXVuZnJlZXplJywgJ2UtcmlnaHRmcmVlemUnLCAnZS1yaWdodGZyZWV6ZSddO1xuICAgICAgICB2YXIgY2VsbHMgPSBbXS5zbGljZS5jYWxsKHBhcmVudEVsZS5xdWVyeVNlbGVjdG9yQWxsKCcuZS1jZWxsc2VsZWN0aW9uYmFja2dyb3VuZCcgKyAnLicgKyBzdHJDZWxsW1wiXCIgKyBiZHJTdHJdKSkuXG4gICAgICAgICAgICBmaWx0ZXIoZnVuY3Rpb24gKGVsZSkgeyByZXR1cm4gZWxlLnN0eWxlLmRpc3BsYXkgPT09ICcnOyB9KTtcbiAgICAgICAgdmFyIGZpeGVkQ2VsbHMgPSBbXS5zbGljZS5jYWxsKHBhcmVudEVsZS5xdWVyeVNlbGVjdG9yQWxsKCcuZS1jZWxsc2VsZWN0aW9uYmFja2dyb3VuZC5lLWZpeGVkZnJlZXplJykpLlxuICAgICAgICAgICAgZmlsdGVyKGZ1bmN0aW9uIChlbGUpIHsgcmV0dXJuIGVsZS5zdHlsZS5kaXNwbGF5ID09PSAnJzsgfSk7XG4gICAgICAgIHZhciBpc1J0bCA9IHRoaXMucGFyZW50LmVuYWJsZVJ0bDtcbiAgICAgICAgaWYgKGNlbGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGZpcnN0Um93SWR4ID0gY2VsbHNbMF0uZ2V0QXR0cmlidXRlKCdpbmRleCcpO1xuICAgICAgICAgICAgdmFyIGZpcnN0Q29sSWR4ID0gY2VsbHNbMF0uZ2V0QXR0cmlidXRlKCdhcmlhLWNvbGluZGV4Jyk7XG4gICAgICAgICAgICB2YXIgbGFzdFJvd0lkeCA9IGNlbGxzW2NlbGxzLmxlbmd0aCAtIDFdLmdldEF0dHJpYnV0ZSgnaW5kZXgnKTtcbiAgICAgICAgICAgIHZhciBsYXN0Q29sSWR4ID0gY2VsbHNbY2VsbHMubGVuZ3RoIC0gMV0uZ2V0QXR0cmlidXRlKCdhcmlhLWNvbGluZGV4Jyk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNlbGxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5nZXRBdHRyaWJ1dGUoJ2luZGV4JykgPT09IGZpcnN0Um93SWR4ICYmICh3aWR0aC5sZW5ndGggPT09IDEgfHwgKHdpZHRoLmxlbmd0aCA9PT0gM1xuICAgICAgICAgICAgICAgICAgICAmJiBwYXJzZUludCh3aWR0aFswXSwgMTApID09PSAyKSB8fCAod2lkdGgubGVuZ3RoID09PSA0ICYmIHBhcnNlSW50KHdpZHRoWzBdLCAxMCkgPT09IDIpKSkge1xuICAgICAgICAgICAgICAgICAgICBjZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZCgnZS14bHNlbC10b3AtYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZ2V0QXR0cmlidXRlKCdhcmlhLWNvbGluZGV4JykgPT09IGZpcnN0Q29sSWR4ICYmICh3aWR0aC5sZW5ndGggPT09IDEgfHxcbiAgICAgICAgICAgICAgICAgICAgKHdpZHRoLmxlbmd0aCA9PT0gMyAmJiBwYXJzZUludCh3aWR0aFsxXSwgMTApID09PSAyKSB8fCAod2lkdGgubGVuZ3RoID09PSA0ICYmICgoKCFpc1J0bCAmJlxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh3aWR0aFszXSwgMTApID09PSAyKSkgfHwgKGlzUnRsICYmIHBhcnNlSW50KHdpZHRoWzFdLCAxMCkgPT09IDIpKSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuYWRkKGlzUnRsID8gJ2UteGxzZWwtcmlnaHQtYm9yZGVyJyA6ICdlLXhsc2VsLWxlZnQtYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZ2V0QXR0cmlidXRlKCdpbmRleCcpID09PSBsYXN0Um93SWR4ICYmICh3aWR0aC5sZW5ndGggPT09IDEgfHxcbiAgICAgICAgICAgICAgICAgICAgKHdpZHRoLmxlbmd0aCA9PT0gMyAmJiBwYXJzZUludCh3aWR0aFsyXSwgMTApID09PSAyKSB8fCAod2lkdGgubGVuZ3RoID09PSA0ICYmIHBhcnNlSW50KHdpZHRoWzJdLCAxMCkgPT09IDIpKSkge1xuICAgICAgICAgICAgICAgICAgICBjZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZCgnZS14bHNlbC1ib3R0b20tYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZ2V0QXR0cmlidXRlKCdhcmlhLWNvbGluZGV4JykgPT09IGxhc3RDb2xJZHggJiYgKHdpZHRoLmxlbmd0aCA9PT0gMSB8fFxuICAgICAgICAgICAgICAgICAgICAod2lkdGgubGVuZ3RoID09PSAzICYmIHBhcnNlSW50KHdpZHRoWzFdLCAxMCkgPT09IDIpIHx8ICh3aWR0aC5sZW5ndGggPT09IDQgJiYgKCghaXNSdGwgJiZcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQod2lkdGhbMV0sIDEwKSA9PT0gMikpIHx8IChpc1J0bCAmJiBwYXJzZUludCh3aWR0aFszXSwgMTApID09PSAyKSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuYWRkKGlzUnRsID8gJ2UteGxzZWwtbGVmdC1ib3JkZXInIDogJ2UteGxzZWwtcmlnaHQtYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChmaXhlZENlbGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGZpcnN0Um93SWR4ID0gZml4ZWRDZWxsc1swXS5nZXRBdHRyaWJ1dGUoJ2luZGV4Jyk7XG4gICAgICAgICAgICB2YXIgZmlyc3RDb2xJZHggPSAocGFyc2VJbnQoZml4ZWRDZWxsc1swXS5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnKSwgMTApIC0gMSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHZhciBsYXN0Um93SWR4ID0gZml4ZWRDZWxsc1tmaXhlZENlbGxzLmxlbmd0aCAtIDFdLmdldEF0dHJpYnV0ZSgnaW5kZXgnKTtcbiAgICAgICAgICAgIHZhciBsYXN0Q29sSWR4ID0gKHBhcnNlSW50KGZpeGVkQ2VsbHNbZml4ZWRDZWxscy5sZW5ndGggLSAxXS5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnKSwgMTApIC0gMSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZml4ZWRDZWxscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSBmaXhlZENlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5nZXRBdHRyaWJ1dGUoJ2luZGV4Jyk7XG4gICAgICAgICAgICAgICAgdmFyIGNvbElkeCA9IChwYXJzZUludChmaXhlZENlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnKSwgMTApIC0gMSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBpZiAoaWR4ID09PSBmaXJzdFJvd0lkeCAmJlxuICAgICAgICAgICAgICAgICAgICAoKCF0aGlzLnBhcmVudC5nZXRIZWFkZXJDb250ZW50KCkucXVlcnlTZWxlY3RvcignLmUtY2VsbHNlbGVjdGlvbmJhY2tncm91bmQuZS1maXhlZGZyZWV6ZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBwYXJlbnRzVW50aWwocGFyZW50RWxlLCAnZS1jb250ZW50JykpIHx8ICFwYXJlbnRzVW50aWwocGFyZW50RWxlLCAnZS1jb250ZW50JykpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpeGVkQ2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5hZGQoJ2UteGxzZWwtdG9wLWJvcmRlcicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaWR4ID09PSBsYXN0Um93SWR4ICYmXG4gICAgICAgICAgICAgICAgICAgICgoIXRoaXMucGFyZW50LmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuZS1jZWxsc2VsZWN0aW9uYmFja2dyb3VuZC5lLWZpeGVkZnJlZXplJylcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHBhcmVudHNVbnRpbChwYXJlbnRFbGUsICdlLWhlYWRlcmNvbnRlbnQnKSkgfHwgIXBhcmVudHNVbnRpbChwYXJlbnRFbGUsICdlLWhlYWRlcmNvbnRlbnQnKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZml4ZWRDZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZCgnZS14bHNlbC1ib3R0b20tYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBwcmVDZWxsID0gZml4ZWRDZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ucGFyZW50RWxlbWVudC5jaGlsZHJlbltwYXJzZUludChjb2xJZHgsIDEwKSAtIDFdO1xuICAgICAgICAgICAgICAgIGlmIChjb2xJZHggPT09IGZpcnN0Q29sSWR4ICYmICghcHJlQ2VsbCB8fCAocHJlQ2VsbCAmJiAhcHJlQ2VsbC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY2VsbHNlbGVjdGlvbmJhY2tncm91bmQnKSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpeGVkQ2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5hZGQoaXNSdGwgPyAnZS14bHNlbC1yaWdodC1ib3JkZXInIDogJ2UteGxzZWwtbGVmdC1ib3JkZXInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5leHRDZWxsID0gZml4ZWRDZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ucGFyZW50RWxlbWVudC5jaGlsZHJlbltwYXJzZUludChjb2xJZHgsIDEwKSArIDFdO1xuICAgICAgICAgICAgICAgIGlmIChjb2xJZHggPT09IGxhc3RDb2xJZHggJiYgKCFuZXh0Q2VsbCB8fCAobmV4dENlbGwgJiYgIW5leHRDZWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1jZWxsc2VsZWN0aW9uYmFja2dyb3VuZCcpKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZml4ZWRDZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZChpc1J0bCA/ICdlLXhsc2VsLWxlZnQtYm9yZGVyJyA6ICdlLXhsc2VsLXJpZ2h0LWJvcmRlcicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5yZWZyZXNoRnJvemVuQm9yZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuYmRyRWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5zZXRGcm96ZW5Cb3JkZXJzKHRoaXMucGFyZW50LmdldENvbnRlbnRUYWJsZSgpLCB0aGlzLmJkckVsZW1lbnQsICcxJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkgJiYgdGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSBsaXRlcmFscy5sZWZ0UmlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEZyb3plbkJvcmRlcnModGhpcy5wYXJlbnQuZ2V0Q29udGVudFRhYmxlKCksIHRoaXMuZnJjQmRyRWxlbWVudCwgJzUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5mcm96ZW5Sb3dzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGcm96ZW5Cb3JkZXJzKHRoaXMucGFyZW50LmdldEhlYWRlclRhYmxlKCksIHRoaXMuZmhCZHJFbGVtZW50LCAnMycpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSAmJiB0aGlzLnBhcmVudC5nZXRGcm96ZW5Nb2RlKCkgPT09IGxpdGVyYWxzLmxlZnRSaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEZyb3plbkJvcmRlcnModGhpcy5wYXJlbnQuZ2V0SGVhZGVyVGFibGUoKSwgdGhpcy5mcmhCZHJFbGVtZW50LCAnNicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZHJhd0JvcmRlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvblNldHRpbmdzLmNlbGxTZWxlY3Rpb25Nb2RlID09PSAnQm94V2l0aEJvcmRlcicgJiYgdGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzLmxlbmd0aCAmJiAhdGhpcy5wYXJlbnQuaXNFZGl0KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2UtZW5hYmxlZGJveGJkcicpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmJkckVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUJvcmRlcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucG9zaXRpb25Cb3JkZXJzKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dIaWRlQm9yZGVycygnbm9uZScsIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaEZyb3plbkJvcmRlcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0hpZGVCb3JkZXJzKCdub25lJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuaXNMYXN0Q2VsbCA9IGZ1bmN0aW9uIChjZWxsKSB7XG4gICAgICAgIHZhciBjZWxscyA9IFtdLnNsaWNlLmNhbGwoY2VsbC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXJvd2NlbGw6bm90KC5lLWhpZGUpJykpO1xuICAgICAgICByZXR1cm4gY2VsbHNbY2VsbHMubGVuZ3RoIC0gMV0gPT09IGNlbGw7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmlzTGFzdFJvdyA9IGZ1bmN0aW9uIChjZWxsKSB7XG4gICAgICAgIHZhciByb3dzID0gW10uc2xpY2UuY2FsbChjbG9zZXN0KGNlbGwsIGxpdGVyYWxzLnRib2R5KS5xdWVyeVNlbGVjdG9yQWxsKCcuZS1yb3c6bm90KC5lLWhpZGRlbnJvdyknKSk7XG4gICAgICAgIHJldHVybiBjZWxsLnBhcmVudEVsZW1lbnQgPT09IHJvd3Nbcm93cy5sZW5ndGggLSAxXTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuaXNGaXJzdFJvdyA9IGZ1bmN0aW9uIChjZWxsKSB7XG4gICAgICAgIHZhciByb3dzID0gW10uc2xpY2UuY2FsbChjbG9zZXN0KGNlbGwsIGxpdGVyYWxzLnRib2R5KS5xdWVyeVNlbGVjdG9yQWxsKCcuZS1yb3c6bm90KC5lLWhpZGRlbnJvdyknKSk7XG4gICAgICAgIHJldHVybiBjZWxsLnBhcmVudEVsZW1lbnQgPT09IHJvd3NbMF07XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmlzRmlyc3RDZWxsID0gZnVuY3Rpb24gKGNlbGwpIHtcbiAgICAgICAgdmFyIGNlbGxzID0gW10uc2xpY2UuY2FsbChjZWxsLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtcm93Y2VsbDpub3QoLmUtaGlkZSknKSk7XG4gICAgICAgIHJldHVybiBjZWxsc1swXSA9PT0gY2VsbDtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuc2V0Qm9yZGVycyA9IGZ1bmN0aW9uIChwYXJlbnRFbGUsIGJvcmRlciwgYmRyU3RyKSB7XG4gICAgICAgIHZhciBjZWxscyA9IFtdLnNsaWNlLmNhbGwocGFyZW50RWxlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2UtY2VsbHNlbGVjdGlvbmJhY2tncm91bmQnKSkuXG4gICAgICAgICAgICBmaWx0ZXIoZnVuY3Rpb24gKGVsZSkgeyByZXR1cm4gZWxlLnN0eWxlLmRpc3BsYXkgPT09ICcnOyB9KTtcbiAgICAgICAgaWYgKGNlbGxzLmxlbmd0aCAmJiB0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgdmFyIHN0ckNlbGwgPSBbJycsICdlLWxlZnRmcmVlemUnLCAnZS11bmZyZWV6ZScsICdlLWxlZnRmcmVlemUnLCAnZS11bmZyZWV6ZScsICdlLXJpZ2h0ZnJlZXplJywgJ2UtcmlnaHRmcmVlemUnXTtcbiAgICAgICAgICAgIGNlbGxzID0gW10uc2xpY2UuY2FsbChwYXJlbnRFbGUucXVlcnlTZWxlY3RvckFsbCgnLmUtY2VsbHNlbGVjdGlvbmJhY2tncm91bmQnICsgJy4nICsgc3RyQ2VsbFtcIlwiICsgYmRyU3RyXSArICc6bm90KC5lLWhpZGUpJykpLlxuICAgICAgICAgICAgICAgIGZpbHRlcihmdW5jdGlvbiAoZWxlKSB7IHJldHVybiBlbGUuc3R5bGUuZGlzcGxheSA9PT0gJyc7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjZWxscy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBpc0Zyb3plbiA9IHRoaXMucGFyZW50LmlzRnJvemVuR3JpZCgpO1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gY2VsbHNbMF07XG4gICAgICAgICAgICB2YXIgZW5kID0gY2VsbHNbY2VsbHMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB2YXIgc3RPZmYgPSBzdGFydC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIHZhciBlbmRPZmYgPSBlbmQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICB2YXIgcGFyZW50T2ZmID0gc3RhcnQub2Zmc2V0UGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgaWYgKHN0YXJ0Lm9mZnNldFBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY29udGVudCcpIHx8IHN0YXJ0Lm9mZnNldFBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaGVhZGVyY29udGVudCcpKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50T2ZmID0gc3RhcnQub2Zmc2V0UGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RhYmxlJykuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcm93SGVpZ2h0ID0gIWlzRnJvemVuICYmIHRoaXMuaXNMYXN0Um93KGVuZCkgJiYgKGJkclN0ciA9PT0gJzEnIHx8IGJkclN0ciA9PT0gJzInIHx8IGJkclN0ciA9PT0gJzUnKSA/IDIgOiAwO1xuICAgICAgICAgICAgdmFyIHRvcE9mZlNldCA9IDA7XG4gICAgICAgICAgICB2YXIgbGVmdE9mZnNldCA9IGlzRnJvemVuICYmIChiZHJTdHIgPT09ICcyJyB8fCBiZHJTdHIgPT09ICc0JykgJiYgdGhpcy5pc0ZpcnN0Q2VsbChzdGFydCkgPyAxIDogMDtcbiAgICAgICAgICAgIHZhciByaWdodE9mZnNldCA9ICgodGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSAnUmlnaHQnICYmIChiZHJTdHIgPT09ICcxJyB8fCBiZHJTdHIgPT09ICczJykpXG4gICAgICAgICAgICAgICAgfHwgKHRoaXMucGFyZW50LmdldEZyb3plbk1vZGUoKSA9PT0gbGl0ZXJhbHMubGVmdFJpZ2h0ICYmIChiZHJTdHIgPT09ICc1JyB8fCBiZHJTdHIgPT09ICc2JykpKVxuICAgICAgICAgICAgICAgICYmIHRoaXMuaXNGaXJzdENlbGwoc3RhcnQpID8gMSA6IDA7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlUnRsKSB7XG4gICAgICAgICAgICAgICAgYm9yZGVyLnN0eWxlLnJpZ2h0ID0gcGFyZW50T2ZmLnJpZ2h0IC0gc3RPZmYucmlnaHQgLSBsZWZ0T2Zmc2V0ICsgJ3B4JztcbiAgICAgICAgICAgICAgICBib3JkZXIuc3R5bGUud2lkdGggPSBzdE9mZi5yaWdodCAtIGVuZE9mZi5sZWZ0ICsgbGVmdE9mZnNldCArIDEgKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYm9yZGVyLnN0eWxlLmxlZnQgPSBzdE9mZi5sZWZ0IC0gcGFyZW50T2ZmLmxlZnQgLSBsZWZ0T2Zmc2V0IC0gcmlnaHRPZmZzZXQgKyAncHgnO1xuICAgICAgICAgICAgICAgIGJvcmRlci5zdHlsZS53aWR0aCA9IGVuZE9mZi5yaWdodCAtIHN0T2ZmLmxlZnQgKyBsZWZ0T2Zmc2V0IC0gcmlnaHRPZmZzZXQgKyAxICsgJ3B4JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJvcmRlci5zdHlsZS50b3AgPSBzdE9mZi50b3AgLSBwYXJlbnRPZmYudG9wIC0gdG9wT2ZmU2V0ICsgJ3B4JztcbiAgICAgICAgICAgIGJvcmRlci5zdHlsZS5oZWlnaHQgPSBlbmRPZmYudG9wIC0gc3RPZmYudG9wID4gMCA/XG4gICAgICAgICAgICAgICAgKGVuZE9mZi50b3AgLSBwYXJlbnRPZmYudG9wICsgZW5kT2ZmLmhlaWdodCArIChpc0Zyb3plbiA/IDAgOiAxKSkgLSAoc3RPZmYudG9wIC0gcGFyZW50T2ZmLnRvcCkgLSByb3dIZWlnaHQgKyB0b3BPZmZTZXQgKyAncHgnIDpcbiAgICAgICAgICAgICAgICBlbmRPZmYuaGVpZ2h0ICsgdG9wT2ZmU2V0IC0gcm93SGVpZ2h0ICsgKGlzRnJvemVuID8gMCA6IDEpICsgJ3B4JztcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0RGlyZWN0aW9uICs9IGJkclN0cjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJvcmRlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnBvc2l0aW9uQm9yZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51cGRhdGVTdGFydEVuZENlbGxzKCk7XG4gICAgICAgIGlmICghdGhpcy5zdGFydENlbGwgfHwgIXRoaXMuYmRyRWxlbWVudCB8fCAhdGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VsZWN0RGlyZWN0aW9uID0gJyc7XG4gICAgICAgIHRoaXMuc2hvd0hpZGVCb3JkZXJzKCcnKTtcbiAgICAgICAgdGhpcy5zZXRCb3JkZXJzKHRoaXMucGFyZW50LmdldENvbnRlbnRUYWJsZSgpLCB0aGlzLmJkckVsZW1lbnQsICcxJyk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRCb3JkZXJzKHRoaXMucGFyZW50LmdldENvbnRlbnRUYWJsZSgpLCB0aGlzLm1jQmRyRWxlbWVudCwgJzInKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5nZXRGcm96ZW5Nb2RlKCkgPT09IGxpdGVyYWxzLmxlZnRSaWdodCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0Qm9yZGVycyh0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKSwgdGhpcy5mcmNCZHJFbGVtZW50LCAnNScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5mcm96ZW5Sb3dzKSB7XG4gICAgICAgICAgICB0aGlzLnNldEJvcmRlcnModGhpcy5wYXJlbnQuZ2V0SGVhZGVyVGFibGUoKSwgdGhpcy5maEJkckVsZW1lbnQsICczJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEJvcmRlcnModGhpcy5wYXJlbnQuZ2V0SGVhZGVyVGFibGUoKSwgdGhpcy5taEJkckVsZW1lbnQsICc0Jyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmdldEZyb3plbk1vZGUoKSA9PT0gbGl0ZXJhbHMubGVmdFJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Qm9yZGVycyh0aGlzLnBhcmVudC5nZXRIZWFkZXJUYWJsZSgpLCB0aGlzLmZyaEJkckVsZW1lbnQsICc2Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXBwbHlCb3JkZXJzKHRoaXMuc2VsZWN0RGlyZWN0aW9uKTtcbiAgICB9O1xuICAgIC8qIGVzbGludC1lbmFibGUgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmFwcGx5Qm90aEZyb3plbkJvcmRlcnMgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICAgIHZhciBydGwgPSB0aGlzLnBhcmVudC5lbmFibGVSdGw7XG4gICAgICAgIHN3aXRjaCAoc3RyLmxlbmd0aCkge1xuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy5yaWdodF9ib3R0b20gOiB0aGlzLmJvdHRvbV9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1jQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMuYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZoQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHJ0bCA/IHRoaXMudG9wX3JpZ2h0IDogdGhpcy50b3BfbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5taEJkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSB0aGlzLnRvcDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy5ib3R0b21fbGVmdCA6IHRoaXMucmlnaHRfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyaEJkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSBydGwgPyB0aGlzLnRvcF9sZWZ0IDogdGhpcy50b3BfcmlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ci5pbmNsdWRlcygnMScpICYmIHN0ci5pbmNsdWRlcygnMicpICYmIHN0ci5pbmNsdWRlcygnMycpICYmIHN0ci5pbmNsdWRlcygnNCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZoQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHJ0bCA/IHRoaXMudG9wX3JpZ2h0IDogdGhpcy50b3BfbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfbGVmdCA6IHRoaXMudG9wX3JpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy5yaWdodF9ib3R0b20gOiB0aGlzLmJvdHRvbV9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tY0JkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSBydGwgPyB0aGlzLmJvdHRvbV9sZWZ0IDogdGhpcy5yaWdodF9ib3R0b207XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ci5pbmNsdWRlcygnMicpICYmIHN0ci5pbmNsdWRlcygnNCcpICYmIHN0ci5pbmNsdWRlcygnNScpICYmIHN0ci5pbmNsdWRlcygnNicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1jQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHJ0bCA/IHRoaXMucmlnaHRfYm90dG9tIDogdGhpcy5ib3R0b21fbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfcmlnaHQgOiB0aGlzLnRvcF9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy5ib3R0b21fbGVmdCA6IHRoaXMucmlnaHRfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfbGVmdCA6IHRoaXMudG9wX3JpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfcmlnaHRfYm90dG9tIDogdGhpcy50b3BfYm90dG9tX2xlZnQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gdGhpcy50b3BfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyY0JkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSBydGwgPyB0aGlzLnRvcF9ib3R0b21fbGVmdCA6IHRoaXMudG9wX3JpZ2h0X2JvdHRvbTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfcmlnaHRfYm90dG9tIDogdGhpcy50b3BfYm90dG9tX2xlZnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1oQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMudG9wX2JvdHRvbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnJjQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHJ0bCA/IHRoaXMudG9wX2JvdHRvbV9sZWZ0IDogdGhpcy50b3BfcmlnaHRfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ci5pbmNsdWRlcygnMScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1jQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHJ0bCA/IHRoaXMudG9wX2JvdHRvbV9sZWZ0IDogdGhpcy50b3BfcmlnaHRfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZoQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMudG9wX3JpZ2h0X2xlZnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ci5pbmNsdWRlcygnMicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSBydGwgPyB0aGlzLnRvcF9yaWdodF9ib3R0b20gOiB0aGlzLnRvcF9ib3R0b21fbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnJjQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHJ0bCA/IHRoaXMudG9wX2JvdHRvbV9sZWZ0IDogdGhpcy50b3BfcmlnaHRfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1oQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMudG9wX3JpZ2h0X2xlZnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ci5pbmNsdWRlcygnMycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1oQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHJ0bCA/IHRoaXMudG9wX2JvdHRvbV9sZWZ0IDogdGhpcy50b3BfcmlnaHRfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gdGhpcy5yaWdodF9ib3R0b21fbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RyLmluY2x1ZGVzKCc0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfcmlnaHRfYm90dG9tIDogdGhpcy50b3BfYm90dG9tX2xlZnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZyaEJkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSBydGwgPyB0aGlzLnRvcF9ib3R0b21fbGVmdCA6IHRoaXMudG9wX3JpZ2h0X2JvdHRvbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gdGhpcy5yaWdodF9ib3R0b21fbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RyLmluY2x1ZGVzKCc1JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfcmlnaHRfYm90dG9tIDogdGhpcy50b3BfYm90dG9tX2xlZnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnJoQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMudG9wX3JpZ2h0X2xlZnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ci5pbmNsdWRlcygnNicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1oQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHJ0bCA/IHRoaXMudG9wX3JpZ2h0X2JvdHRvbSA6IHRoaXMudG9wX2JvdHRvbV9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gdGhpcy5yaWdodF9ib3R0b21fbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhpcy5iZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gdGhpcy5hbGxfYm9yZGVyO1xuICAgICAgICAgICAgICAgIHRoaXMubWNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gdGhpcy5hbGxfYm9yZGVyO1xuICAgICAgICAgICAgICAgIHRoaXMuZnJjQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMuYWxsX2JvcmRlcjtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZoQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMuYWxsX2JvcmRlcjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5taEJkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSB0aGlzLmFsbF9ib3JkZXI7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZnJoQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMuYWxsX2JvcmRlcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuYXBwbHlCb3JkZXJzID0gZnVuY3Rpb24gKHN0cikge1xuICAgICAgICB2YXIgcnRsID0gdGhpcy5wYXJlbnQuZW5hYmxlUnRsO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSBsaXRlcmFscy5sZWZ0UmlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwbHlCb3RoRnJvemVuQm9yZGVycyhzdHIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoIChzdHIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy5ib3R0b21fbGVmdCA6IHRoaXMucmlnaHRfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy5yaWdodF9ib3R0b20gOiB0aGlzLmJvdHRvbV9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfbGVmdCA6IHRoaXMudG9wX3JpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfcmlnaHQgOiB0aGlzLnRvcF9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy5yaWdodF9ib3R0b20gOiB0aGlzLmJvdHRvbV9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy5ib3R0b21fbGVmdCA6IHRoaXMucmlnaHRfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfcmlnaHQgOiB0aGlzLnRvcF9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gcnRsID8gdGhpcy50b3BfbGVmdCA6IHRoaXMudG9wX3JpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmdldEZyb3plbk1vZGUoKSA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHN0ci5pbmNsdWRlcygnMicpID8gcnRsID8gdGhpcy50b3BfYm90dG9tX2xlZnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnRvcF9yaWdodF9ib3R0b20gOiB0aGlzLnJpZ2h0X2JvdHRvbV9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWNCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gc3RyLmluY2x1ZGVzKCcxJykgPyBydGwgPyB0aGlzLnRvcF9yaWdodF9ib3R0b21cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnRvcF9ib3R0b21fbGVmdCA6IHRoaXMucmlnaHRfYm90dG9tX2xlZnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maEJkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSBzdHIuaW5jbHVkZXMoJzEnKSA/IHRoaXMudG9wX3JpZ2h0X2xlZnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogcnRsID8gdGhpcy50b3BfYm90dG9tX2xlZnQgOiB0aGlzLnRvcF9yaWdodF9ib3R0b207XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWhCZHJFbGVtZW50LnN0eWxlLmJvcmRlcldpZHRoID0gc3RyLmluY2x1ZGVzKCcyJykgPyB0aGlzLnRvcF9yaWdodF9sZWZ0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHJ0bCA/IHRoaXMudG9wX3JpZ2h0X2JvdHRvbSA6IHRoaXMudG9wX2JvdHRvbV9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHN0ci5pbmNsdWRlcygnMicpID8gcnRsID8gdGhpcy50b3BfcmlnaHRfYm90dG9tXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy50b3BfYm90dG9tX2xlZnQgOiB0aGlzLnJpZ2h0X2JvdHRvbV9sZWZ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1jQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHN0ci5pbmNsdWRlcygnMScpID8gcnRsID8gdGhpcy50b3BfYm90dG9tX2xlZnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy50b3BfcmlnaHRfYm90dG9tIDogdGhpcy5yaWdodF9ib3R0b21fbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maEJkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSBzdHIuaW5jbHVkZXMoJzEnKSA/IHRoaXMudG9wX3JpZ2h0X2xlZnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogcnRsID8gdGhpcy50b3BfcmlnaHRfYm90dG9tIDogdGhpcy50b3BfYm90dG9tX2xlZnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5taEJkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSBzdHIuaW5jbHVkZXMoJzInKSA/IHRoaXMudG9wX3JpZ2h0X2xlZnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHJ0bCA/IHRoaXMudG9wX2JvdHRvbV9sZWZ0IDogdGhpcy50b3BfcmlnaHRfYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMuYWxsX2JvcmRlcjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRnJvemVuR3JpZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1jQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMuYWxsX2JvcmRlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maEJkckVsZW1lbnQuc3R5bGUuYm9yZGVyV2lkdGggPSB0aGlzLmFsbF9ib3JkZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1oQmRyRWxlbWVudC5zdHlsZS5ib3JkZXJXaWR0aCA9IHRoaXMuYWxsX2JvcmRlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVCb3JkZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuYmRyRWxlbWVudCkge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGlvbkJvcmRlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdlLXhsc2VsJywgaWQ6IHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnX2JkcidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VsZWN0aW9uQm9yZGVyLnN0eWxlLmNzc1RleHQgPSAnd2lkdGg6IDJweDsgYm9yZGVyLXdpZHRoOiAwOyc7XG4gICAgICAgICAgICB0aGlzLmJkckVsZW1lbnQgPSB0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKS5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHNlbGVjdGlvbkJvcmRlcik7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWlkZGxlQ29udGVudEJvcmRlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZS14bHNlbCcsIGlkOiB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgJ19tY2JkcidcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBtaWRkbGVDb250ZW50Qm9yZGVyLnN0eWxlLmNzc1RleHQgPSAnaGVpZ2h0OiAycHg7IGJvcmRlci13aWR0aDogMDsnO1xuICAgICAgICAgICAgICAgIHRoaXMubWNCZHJFbGVtZW50ID0gdGhpcy5wYXJlbnQuZ2V0Q29udGVudFRhYmxlKCkucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChtaWRkbGVDb250ZW50Qm9yZGVyKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSBsaXRlcmFscy5sZWZ0UmlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZyb3plblJpZ2h0Q29udGVudEJvcmRlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UteGxzZWwnLCBpZDogdGhpcy5wYXJlbnQuZWxlbWVudC5pZCArICdfZnJjYmRyJ1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZnJvemVuUmlnaHRDb250ZW50Qm9yZGVyLnN0eWxlLmNzc1RleHQgPSAnaGVpZ2h0OiAycHg7IGJvcmRlci13aWR0aDogMDsnO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyY0JkckVsZW1lbnQgPSB0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKS5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGZyb3plblJpZ2h0Q29udGVudEJvcmRlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJvemVuSGVhZGVyQm9yZGVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdlLXhsc2VsJywgaWQ6IHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnX2ZoYmRyJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZyb3plbkhlYWRlckJvcmRlci5zdHlsZS5oZWlnaHQgPSAnMnB4JztcbiAgICAgICAgICAgICAgICB0aGlzLmZoQmRyRWxlbWVudCA9IHRoaXMucGFyZW50LmdldEhlYWRlclRhYmxlKCkucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChmcm96ZW5IZWFkZXJCb3JkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MgJiYgdGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWlkZGxlSGVhZGVyQm9yZGVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdlLXhsc2VsJywgaWQ6IHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnX21oYmRyJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIG1pZGRsZUhlYWRlckJvcmRlci5zdHlsZS5oZWlnaHQgPSAnMnB4JztcbiAgICAgICAgICAgICAgICB0aGlzLm1oQmRyRWxlbWVudCA9IHRoaXMucGFyZW50LmdldEhlYWRlclRhYmxlKCkucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChtaWRkbGVIZWFkZXJCb3JkZXIpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5nZXRGcm96ZW5Nb2RlKCkgPT09IGxpdGVyYWxzLmxlZnRSaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZnJvemVuUmlnaHRIZWFkZXJCb3JkZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdlLXhsc2VsJywgaWQ6IHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnX2ZyaGJkcidcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGZyb3plblJpZ2h0SGVhZGVyQm9yZGVyLnN0eWxlLmhlaWdodCA9ICcycHgnO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyaEJkckVsZW1lbnQgPSB0aGlzLnBhcmVudC5nZXRIZWFkZXJUYWJsZSgpLnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoZnJvemVuUmlnaHRIZWFkZXJCb3JkZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zaG93SGlkZUJvcmRlcnMgPSBmdW5jdGlvbiAoZGlzcGxheSwgZnJlZXplKSB7XG4gICAgICAgIGlmICh0aGlzLmJkckVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuYmRyRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gZGlzcGxheTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRFbGUgPSB0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKTtcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhwYXJlbnRFbGUucXVlcnlTZWxlY3RvckFsbCgnLmUteGxzZWwtdG9wLWJvcmRlcicpLCAnZS14bHNlbC10b3AtYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50RWxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXhsc2VsLWxlZnQtYm9yZGVyJyksICdlLXhsc2VsLWxlZnQtYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50RWxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXhsc2VsLXJpZ2h0LWJvcmRlcicpLCAnZS14bHNlbC1yaWdodC1ib3JkZXInKTtcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhwYXJlbnRFbGUucXVlcnlTZWxlY3RvckFsbCgnLmUteGxzZWwtYm90dG9tLWJvcmRlcicpLCAnZS14bHNlbC1ib3R0b20tYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgaWYgKCFmcmVlemUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tY0JkckVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IGRpc3BsYXk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5nZXRGcm96ZW5Nb2RlKCkgPT09IGxpdGVyYWxzLmxlZnRSaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyY0JkckVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IGRpc3BsYXk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50RWxlID0gdGhpcy5wYXJlbnQuZ2V0SGVhZGVyVGFibGUoKTtcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhwYXJlbnRFbGUucXVlcnlTZWxlY3RvckFsbCgnLmUteGxzZWwtdG9wLWJvcmRlcicpLCAnZS14bHNlbC10b3AtYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50RWxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXhsc2VsLWxlZnQtYm9yZGVyJyksICdlLXhsc2VsLWxlZnQtYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50RWxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXhsc2VsLXJpZ2h0LWJvcmRlcicpLCAnZS14bHNlbC1yaWdodC1ib3JkZXInKTtcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhwYXJlbnRFbGUucXVlcnlTZWxlY3RvckFsbCgnLmUteGxzZWwtYm90dG9tLWJvcmRlcicpLCAnZS14bHNlbC1ib3R0b20tYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5maEJkckVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IGRpc3BsYXk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cyAmJiB0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgICAgIGlmICghZnJlZXplKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWhCZHJFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSBsaXRlcmFscy5sZWZ0UmlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmhCZHJFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5kcmF3QUZCb3JkZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuYmRyQUZCb3R0b20pIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQUZCb3JkZXJzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wb3NpdGlvbkFGQm9yZGVycygpO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5wb3NpdGlvbkFGQm9yZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0Q2VsbCB8fCAhdGhpcy5iZHJBRkxlZnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RPZmYgPSB0aGlzLnN0YXJ0QUZDZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB2YXIgZW5kT2ZmID0gdGhpcy5lbmRBRkNlbGwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHZhciB0b3AgPSBlbmRPZmYudG9wIC0gc3RPZmYudG9wID4gMCA/IDEgOiAwO1xuICAgICAgICB2YXIgZmlyc3RDZWxsVG9wID0gZW5kT2ZmLnRvcCAtIHN0T2ZmLnRvcCA+PSAwICYmIChwYXJlbnRzVW50aWwodGhpcy5zdGFydEFGQ2VsbCwgbGl0ZXJhbHMubW92YWJsZUNvbnRlbnQpIHx8XG4gICAgICAgICAgICBwYXJlbnRzVW50aWwodGhpcy5zdGFydEFGQ2VsbCwgJ2UtZnJvemVuY29udGVudCcpKSAmJiB0aGlzLmlzRmlyc3RSb3codGhpcy5zdGFydEFGQ2VsbCkgPyAxLjUgOiAwO1xuICAgICAgICB2YXIgZmlyc3RDZWxsTGVmdCA9IChwYXJlbnRzVW50aWwodGhpcy5zdGFydEFGQ2VsbCwgbGl0ZXJhbHMubW92YWJsZUNvbnRlbnQpIHx8XG4gICAgICAgICAgICBwYXJlbnRzVW50aWwodGhpcy5zdGFydEFGQ2VsbCwgbGl0ZXJhbHMubW92YWJsZUhlYWRlcikpICYmIHRoaXMuaXNGaXJzdENlbGwodGhpcy5zdGFydEFGQ2VsbCkgPyAxIDogMDtcbiAgICAgICAgdmFyIHJvd0hlaWdodCA9IHRoaXMuaXNMYXN0Um93KHRoaXMuZW5kQUZDZWxsKSAmJiAocGFyZW50c1VudGlsKHRoaXMuZW5kQUZDZWxsLCBsaXRlcmFscy5tb3ZhYmxlQ29udGVudCkgfHxcbiAgICAgICAgICAgIHBhcmVudHNVbnRpbCh0aGlzLmVuZEFGQ2VsbCwgJ2UtZnJvemVuY29udGVudCcpKSA/IDIgOiAwO1xuICAgICAgICB2YXIgcGFyZW50T2ZmID0gdGhpcy5zdGFydEFGQ2VsbC5vZmZzZXRQYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHZhciBwYXJlbnRSZWN0ID0gdGhpcy5wYXJlbnQuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgdmFyIHNUb3AgPSB0aGlzLnN0YXJ0QUZDZWxsLm9mZnNldFBhcmVudC5wYXJlbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICAgICAgdmFyIHNMZWZ0ID0gdGhpcy5zdGFydEFGQ2VsbC5vZmZzZXRQYXJlbnQucGFyZW50RWxlbWVudC5zY3JvbGxMZWZ0O1xuICAgICAgICB2YXIgc2Nyb2xsVG9wID0gc1RvcCAtIHRoaXMuc3RhcnRBRkNlbGwub2Zmc2V0VG9wO1xuICAgICAgICB2YXIgc2Nyb2xsTGVmdCA9IHNMZWZ0IC0gdGhpcy5zdGFydEFGQ2VsbC5vZmZzZXRMZWZ0O1xuICAgICAgICB2YXIgdG90YWxIZWlnaHQgPSB0aGlzLnBhcmVudC5lbGVtZW50LmNsaWVudEhlaWdodCAtIGdldFNjcm9sbEJhcldpZHRoKCk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd1BhZ2luZykge1xuICAgICAgICAgICAgdG90YWxIZWlnaHQgLT0gdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1wYWdlcicpLm9mZnNldEhlaWdodDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWdncmVnYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRvdGFsSGVpZ2h0IC09IHRoaXMucGFyZW50LmdldEZvb3RlckNvbnRlbnQoKS5vZmZzZXRIZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRvdGFsV2lkdGggPSB0aGlzLnBhcmVudC5lbGVtZW50LmNsaWVudFdpZHRoIC0gKHRoaXMucGFyZW50LmhlaWdodCAhPT0gJ2F1dG8nID8gZ2V0U2Nyb2xsQmFyV2lkdGgoKSA6IDApO1xuICAgICAgICBzY3JvbGxUb3AgPSBzY3JvbGxUb3AgPiAwID8gTWF0aC5mbG9vcihzY3JvbGxUb3ApIC0gMSA6IDA7XG4gICAgICAgIHNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0ID4gMCA/IHNjcm9sbExlZnQgOiAwO1xuICAgICAgICB2YXIgbGVmdCA9IHN0T2ZmLmxlZnQgLSBwYXJlbnRSZWN0LmxlZnQ7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQuZW5hYmxlUnRsKSB7XG4gICAgICAgICAgICB0aGlzLmJkckFGTGVmdC5zdHlsZS5sZWZ0ID0gbGVmdCAtIGZpcnN0Q2VsbExlZnQgKyBzY3JvbGxMZWZ0IC0gMSArICdweCc7XG4gICAgICAgICAgICB0aGlzLmJkckFGUmlnaHQuc3R5bGUubGVmdCA9IGVuZE9mZi5sZWZ0IC0gcGFyZW50UmVjdC5sZWZ0IC0gMiArIGVuZE9mZi53aWR0aCArICdweCc7XG4gICAgICAgICAgICB0aGlzLmJkckFGUmlnaHQuc3R5bGUud2lkdGggPSB0b3RhbFdpZHRoIDw9IHBhcnNlSW50KHRoaXMuYmRyQUZSaWdodC5zdHlsZS5sZWZ0LCAxMCkgPyAnMHB4JyA6ICcycHgnO1xuICAgICAgICAgICAgdGhpcy5iZHJBRlRvcC5zdHlsZS5sZWZ0ID0gbGVmdCArIHNjcm9sbExlZnQgLSAwLjUgKyAncHgnO1xuICAgICAgICAgICAgdGhpcy5iZHJBRlRvcC5zdHlsZS53aWR0aCA9IHBhcnNlSW50KHRoaXMuYmRyQUZSaWdodC5zdHlsZS5sZWZ0LCAxMCkgLSBwYXJzZUludCh0aGlzLmJkckFGTGVmdC5zdHlsZS5sZWZ0LCAxMClcbiAgICAgICAgICAgICAgICAtIGZpcnN0Q2VsbExlZnQgKyAxICsgJ3B4JztcbiAgICAgICAgICAgIGlmICh0b3RhbFdpZHRoIDw9IChwYXJzZUludCh0aGlzLmJkckFGVG9wLnN0eWxlLndpZHRoLCAxMCkgKyBwYXJzZUludCh0aGlzLmJkckFGVG9wLnN0eWxlLmxlZnQsIDEwKSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGVmdFJlbW92ZSA9IChwYXJzZUludCh0aGlzLmJkckFGVG9wLnN0eWxlLndpZHRoLCAxMCkgKyBwYXJzZUludCh0aGlzLmJkckFGVG9wLnN0eWxlLmxlZnQsIDEwKSkgLSB0b3RhbFdpZHRoO1xuICAgICAgICAgICAgICAgIHRoaXMuYmRyQUZUb3Auc3R5bGUud2lkdGggPSBwYXJzZUludCh0aGlzLmJkckFGVG9wLnN0eWxlLndpZHRoLCAxMCkgLSBsZWZ0UmVtb3ZlICsgJ3B4JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBzY3JvbGxvZmZTZXQgPSAocGFyZW50c1VudGlsKHRoaXMuc3RhcnRBRkNlbGwsIGxpdGVyYWxzLm1vdmFibGVDb250ZW50KSB8fFxuICAgICAgICAgICAgICAgIHBhcmVudHNVbnRpbCh0aGlzLnN0YXJ0QUZDZWxsLCBsaXRlcmFscy5tb3ZhYmxlSGVhZGVyKSkgPyBzdE9mZi5yaWdodCAtXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydEFGQ2VsbC5vZmZzZXRQYXJlbnQucGFyZW50RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCAtXG4gICAgICAgICAgICAgICAgcGFyZW50UmVjdC5sZWZ0IDogMDtcbiAgICAgICAgICAgIHRoaXMuYmRyQUZMZWZ0LnN0eWxlLnJpZ2h0ID0gcGFyZW50UmVjdC5yaWdodCAtIGVuZE9mZi5yaWdodCAtIDIgKyBlbmRPZmYud2lkdGggKyAncHgnO1xuICAgICAgICAgICAgdGhpcy5iZHJBRkxlZnQuc3R5bGUud2lkdGggPSB0b3RhbFdpZHRoIDw9IHBhcnNlSW50KHRoaXMuYmRyQUZMZWZ0LnN0eWxlLnJpZ2h0LCAxMCkgPyAnMHB4JyA6ICcycHgnO1xuICAgICAgICAgICAgdmFyIGJvcmRlckFGUmlnaHRWYWx1ZSA9IHBhcmVudFJlY3QucmlnaHQgLSBzdE9mZi5yaWdodCAtIGZpcnN0Q2VsbExlZnQgKyBzY3JvbGxvZmZTZXQgLSAxO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtZXhwcmVzc2lvbnNcbiAgICAgICAgICAgIGJvcmRlckFGUmlnaHRWYWx1ZSA+IDAgPyB0aGlzLmJkckFGUmlnaHQuc3R5bGUucmlnaHQgPSBib3JkZXJBRlJpZ2h0VmFsdWUgKyAncHgnIDogdGhpcy5iZHJBRlJpZ2h0LnN0eWxlLnJpZ2h0ID0gJzBweCc7XG4gICAgICAgICAgICB0aGlzLmJkckFGVG9wLnN0eWxlLmxlZnQgPSBlbmRPZmYubGVmdCAtIHBhcmVudFJlY3QubGVmdCAtIDAuNSArICdweCc7XG4gICAgICAgICAgICB0aGlzLmJkckFGVG9wLnN0eWxlLndpZHRoID0gcGFyc2VJbnQodGhpcy5iZHJBRkxlZnQuc3R5bGUucmlnaHQsIDEwKSAtIHBhcnNlSW50KHRoaXMuYmRyQUZSaWdodC5zdHlsZS5yaWdodCwgMTApXG4gICAgICAgICAgICAgICAgLSBmaXJzdENlbGxMZWZ0ICsgMSArICdweCc7XG4gICAgICAgICAgICBpZiAocGFyc2VJbnQodGhpcy5iZHJBRlRvcC5zdHlsZS5sZWZ0LCAxMCkgPCAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iZHJBRlRvcC5zdHlsZS53aWR0aCA9IHBhcnNlSW50KHRoaXMuYmRyQUZUb3Auc3R5bGUud2lkdGgsIDEwKSArIHBhcnNlSW50KHRoaXMuYmRyQUZUb3Auc3R5bGUubGVmdCwgMTApICsgJ3B4JztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaGVpZ2h0ICE9PSAnYXV0bycgJiYgZ2V0U2Nyb2xsQmFyV2lkdGgoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJkckFGVG9wLnN0eWxlLmxlZnQgPSBnZXRTY3JvbGxCYXJXaWR0aCgpICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iZHJBRlRvcC5zdHlsZS53aWR0aCA9IChwYXJzZUludCh0aGlzLmJkckFGVG9wLnN0eWxlLndpZHRoLCAxMCkgLSBnZXRTY3JvbGxCYXJXaWR0aCgpKSArICdweCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJkckFGVG9wLnN0eWxlLmxlZnQgPSAnMHB4JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5iZHJBRkxlZnQuc3R5bGUudG9wID0gc3RPZmYudG9wIC0gcGFyZW50UmVjdC50b3AgLSBmaXJzdENlbGxUb3AgKyBzY3JvbGxUb3AgKyAncHgnO1xuICAgICAgICB0aGlzLmJkckFGTGVmdC5zdHlsZS5oZWlnaHQgPSBlbmRPZmYudG9wIC0gc3RPZmYudG9wID4gMCA/XG4gICAgICAgICAgICAoZW5kT2ZmLnRvcCAtIHBhcmVudE9mZi50b3AgKyBlbmRPZmYuaGVpZ2h0ICsgMSkgLSAoc3RPZmYudG9wIC0gcGFyZW50T2ZmLnRvcCkgKyBmaXJzdENlbGxUb3AgLSByb3dIZWlnaHQgLSBzY3JvbGxUb3AgKyAncHgnIDpcbiAgICAgICAgICAgIGVuZE9mZi5oZWlnaHQgKyBmaXJzdENlbGxUb3AgLSByb3dIZWlnaHQgLSBzY3JvbGxUb3AgKyAncHgnO1xuICAgICAgICB0aGlzLmJkckFGUmlnaHQuc3R5bGUudG9wID0gdGhpcy5iZHJBRkxlZnQuc3R5bGUudG9wO1xuICAgICAgICB0aGlzLmJkckFGUmlnaHQuc3R5bGUuaGVpZ2h0ID0gcGFyc2VJbnQodGhpcy5iZHJBRkxlZnQuc3R5bGUuaGVpZ2h0LCAxMCkgKyAncHgnO1xuICAgICAgICB0aGlzLmJkckFGVG9wLnN0eWxlLnRvcCA9IHRoaXMuYmRyQUZSaWdodC5zdHlsZS50b3A7XG4gICAgICAgIHRoaXMuYmRyQUZCb3R0b20uc3R5bGUubGVmdCA9IHRoaXMuYmRyQUZUb3Auc3R5bGUubGVmdDtcbiAgICAgICAgdGhpcy5iZHJBRkJvdHRvbS5zdHlsZS50b3AgPSBwYXJzZUZsb2F0KHRoaXMuYmRyQUZMZWZ0LnN0eWxlLnRvcCkgKyBwYXJzZUZsb2F0KHRoaXMuYmRyQUZMZWZ0LnN0eWxlLmhlaWdodCkgLSB0b3AgLSAxICsgJ3B4JztcbiAgICAgICAgdGhpcy5iZHJBRkJvdHRvbS5zdHlsZS53aWR0aCA9IHRvdGFsSGVpZ2h0IDw9IHBhcnNlRmxvYXQodGhpcy5iZHJBRkJvdHRvbS5zdHlsZS50b3ApID8gJzBweCcgOiB0aGlzLmJkckFGVG9wLnN0eWxlLndpZHRoO1xuICAgICAgICBpZiAodG90YWxIZWlnaHQgPD0gKHBhcnNlSW50KHRoaXMuYmRyQUZMZWZ0LnN0eWxlLmhlaWdodCwgMTApICsgcGFyc2VJbnQodGhpcy5iZHJBRkxlZnQuc3R5bGUudG9wLCAxMCkpKSB7XG4gICAgICAgICAgICB2YXIgdG9wUmVtb3ZlID0gcGFyc2VJbnQodGhpcy5iZHJBRkxlZnQuc3R5bGUuaGVpZ2h0LCAxMCkgKyBwYXJzZUludCh0aGlzLmJkckFGTGVmdC5zdHlsZS50b3AsIDEwKSAtIHRvdGFsSGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5iZHJBRkxlZnQuc3R5bGUuaGVpZ2h0ID0gcGFyc2VJbnQodGhpcy5iZHJBRkxlZnQuc3R5bGUuaGVpZ2h0LCAxMCkgLSB0b3BSZW1vdmUgKyAncHgnO1xuICAgICAgICAgICAgdGhpcy5iZHJBRlJpZ2h0LnN0eWxlLmhlaWdodCA9IHBhcnNlSW50KHRoaXMuYmRyQUZMZWZ0LnN0eWxlLmhlaWdodCwgMTApICsgJ3B4JztcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVBRkJvcmRlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5iZHJBRkxlZnQpIHtcbiAgICAgICAgICAgIHZhciBsZWZ0U2VsZWN0aW9uQm9yZGVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UteGxzZWxhZicsIGlkOiB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgJ19iZHJhZmxlZnQnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxlZnRTZWxlY3Rpb25Cb3JkZXIuc3R5bGUud2lkdGggPSAnMnB4JztcbiAgICAgICAgICAgIHRoaXMuYmRyQUZMZWZ0ID0gdGhpcy5wYXJlbnQuZWxlbWVudC5hcHBlbmRDaGlsZChsZWZ0U2VsZWN0aW9uQm9yZGVyKTtcbiAgICAgICAgICAgIHZhciByaWdodFNlbGVjdGlvbkJvcmRlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdlLXhsc2VsYWYnLCBpZDogdGhpcy5wYXJlbnQuZWxlbWVudC5pZCArICdfYmRyYWZyaWdodCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmlnaHRTZWxlY3Rpb25Cb3JkZXIuc3R5bGUud2lkdGggPSAnMnB4JztcbiAgICAgICAgICAgIHRoaXMuYmRyQUZSaWdodCA9IHRoaXMucGFyZW50LmVsZW1lbnQuYXBwZW5kQ2hpbGQocmlnaHRTZWxlY3Rpb25Cb3JkZXIpO1xuICAgICAgICAgICAgdmFyIGJvdHRvbVNlbGVjdGlvbkJvcmRlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdlLXhsc2VsYWYnLCBpZDogdGhpcy5wYXJlbnQuZWxlbWVudC5pZCArICdfYmRyYWZib3R0b20nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJvdHRvbVNlbGVjdGlvbkJvcmRlci5zdHlsZS5oZWlnaHQgPSAnMnB4JztcbiAgICAgICAgICAgIHRoaXMuYmRyQUZCb3R0b20gPSB0aGlzLnBhcmVudC5lbGVtZW50LmFwcGVuZENoaWxkKGJvdHRvbVNlbGVjdGlvbkJvcmRlcik7XG4gICAgICAgICAgICB2YXIgdG9wU2VsZWN0aW9uQm9yZGVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UteGxzZWxhZicsIGlkOiB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgJ19iZHJhZnRvcCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdG9wU2VsZWN0aW9uQm9yZGVyLnN0eWxlLmhlaWdodCA9ICcycHgnO1xuICAgICAgICAgICAgdGhpcy5iZHJBRlRvcCA9IHRoaXMucGFyZW50LmVsZW1lbnQuYXBwZW5kQ2hpbGQodG9wU2VsZWN0aW9uQm9yZGVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5kZXN0cm95QXV0b0ZpbGxFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuYmRyQUZMZWZ0KSB7XG4gICAgICAgICAgICB0aGlzLmJkckFGTGVmdC5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMuYmRyQUZSaWdodC5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMuYmRyQUZCb3R0b20ucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLmJkckFGVG9wLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5iZHJBRkxlZnQgPSB0aGlzLmJkckFGUmlnaHQgPSB0aGlzLmJkckFGQm90dG9tID0gdGhpcy5iZHJBRlRvcCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXV0b2ZpbGwpIHtcbiAgICAgICAgICAgIHRoaXMuYXV0b2ZpbGwucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLmF1dG9maWxsID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zaG93QUZCb3JkZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5iZHJBRkxlZnQpIHtcbiAgICAgICAgICAgIHRoaXMuYmRyQUZMZWZ0LnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgICAgIHRoaXMuYmRyQUZSaWdodC5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgICAgICAgICB0aGlzLmJkckFGQm90dG9tLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgICAgIHRoaXMuYmRyQUZUb3Auc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmhpZGVBRkJvcmRlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmJkckFGTGVmdCkge1xuICAgICAgICAgICAgdGhpcy5iZHJBRkxlZnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIHRoaXMuYmRyQUZSaWdodC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgdGhpcy5iZHJBRkJvdHRvbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgdGhpcy5iZHJBRlRvcC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVZhbHVlID0gZnVuY3Rpb24gKHJJZHgsIGNJZHgsIGNlbGwpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB0aGlzLmNyZWF0ZUJlZm9yZUF1dG9GaWxsKHJJZHgsIGNJZHgsIGNlbGwpO1xuICAgICAgICBpZiAoIWFyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICB2YXIgY29sID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1uQnlJbmRleChjSWR4KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lZGl0TW9kdWxlICYmIGNlbGwpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29sLnR5cGUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmVkaXRNb2R1bGUudXBkYXRlQ2VsbChySWR4LCBjb2wuZmllbGQsIHBhcnNlRmxvYXQoYXJncy52YWx1ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuZWRpdE1vZHVsZS51cGRhdGVDZWxsKHJJZHgsIGNvbC5maWVsZCwgYXJncy52YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmNyZWF0ZUJlZm9yZUF1dG9GaWxsID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjb2xJbmRleCwgY2VsbCkge1xuICAgICAgICB2YXIgY29sID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1uQnlJbmRleChjb2xJbmRleCk7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgY29sdW1uOiBjb2wsXG4gICAgICAgICAgICB2YWx1ZTogY2VsbC5pbm5lclRleHRcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wYXJlbnQudHJpZ2dlcihldmVudHMuYmVmb3JlQXV0b0ZpbGwsIGFyZ3MpO1xuICAgICAgICByZXR1cm4gYXJncztcbiAgICB9O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmdldEF1dG9GaWxsQ2VsbHMgPSBmdW5jdGlvbiAocm93SW5kZXgsIHN0YXJ0Q2VsbElkeCkge1xuICAgICAgICB2YXIgY2xzID0gJy5lLWNlbGxzZWxlY3Rpb25iYWNrZ3JvdW5kJztcbiAgICAgICAgdmFyIGNlbGxzID0gW10uc2xpY2UuY2FsbCh0aGlzLnBhcmVudC5nZXREYXRhUm93cygpW3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0ucXVlcnlTZWxlY3RvckFsbChjbHMpKTtcbiAgICAgICAgcmV0dXJuIGNlbGxzO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zZWxlY3RMaWtlQXV0b0ZpbGwgPSBmdW5jdGlvbiAoZSwgaXNBcHBseSkge1xuICAgICAgICB2YXIgc3RhcnRyb3dJZHggPSBwYXJzZUludChwYXJlbnRzVW50aWwodGhpcy5zdGFydEFGQ2VsbCwgbGl0ZXJhbHMucm93KS5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSwgMTApIC0gMTtcbiAgICAgICAgdmFyIHN0YXJ0Q2VsbElkeCA9IHBhcnNlSW50KHRoaXMuc3RhcnRBRkNlbGwuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDE7XG4gICAgICAgIHZhciBlbmRyb3dJZHggPSBwYXJzZUludChwYXJlbnRzVW50aWwodGhpcy5lbmRBRkNlbGwsIGxpdGVyYWxzLnJvdykuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDE7XG4gICAgICAgIHZhciBlbmRDZWxsSWR4ID0gcGFyc2VJbnQodGhpcy5lbmRBRkNlbGwuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDE7XG4gICAgICAgIHZhciByb3dMZW4gPSB0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXMubGVuZ3RoIC0gMTtcbiAgICAgICAgdmFyIGNvbExlbiA9IHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlc1swXS5jZWxsSW5kZXhlcy5sZW5ndGggLSAxO1xuICAgICAgICBzd2l0Y2ggKHRydWUpIHsgLy9kaXJlY3Rpb25cbiAgICAgICAgICAgIGNhc2UgIWlzQXBwbHkgJiYgdGhpcy5lbmRBRkNlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNlbGxzZWxlY3Rpb25iYWNrZ3JvdW5kJykgJiZcbiAgICAgICAgICAgICAgICAhIXBhcmVudHNVbnRpbChlLnRhcmdldCwgbGl0ZXJhbHMucm93Q2VsbCk6XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydEFGQ2VsbCA9IHRoaXMucGFyZW50LmdldENlbGxGcm9tSW5kZXgoc3RhcnRyb3dJZHgsIHN0YXJ0Q2VsbElkeCk7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmRBRkNlbGwgPSB0aGlzLnBhcmVudC5nZXRDZWxsRnJvbUluZGV4KHN0YXJ0cm93SWR4ICsgcm93TGVuLCBzdGFydENlbGxJZHggKyBjb2xMZW4pO1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhd0FGQm9yZGVycygpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB0aGlzLmF1dG9GaWxsUkxzZWxlY3Rpb24gJiYgc3RhcnRDZWxsSWR4ICsgY29sTGVuIDwgZW5kQ2VsbElkeCAmJiAvL3JpZ2h0XG4gICAgICAgICAgICAgICAgZW5kQ2VsbElkeCAtIHN0YXJ0Q2VsbElkeCAtIGNvbExlbiArIDEgPiBlbmRyb3dJZHggLSBzdGFydHJvd0lkeCAtIHJvd0xlbiAvLyByaWdodCBib3R0b21cbiAgICAgICAgICAgICAgICAmJiBlbmRDZWxsSWR4IC0gc3RhcnRDZWxsSWR4IC0gY29sTGVuICsgMSA+IHN0YXJ0cm93SWR4IC0gZW5kcm93SWR4OiAvL3JpZ2h0IHRvcFxuICAgICAgICAgICAgICAgIHRoaXMuZW5kQUZDZWxsID0gdGhpcy5wYXJlbnQuZ2V0Q2VsbEZyb21JbmRleChzdGFydHJvd0lkeCArIHJvd0xlbiwgZW5kQ2VsbElkeCk7XG4gICAgICAgICAgICAgICAgZW5kcm93SWR4ID0gcGFyc2VJbnQocGFyZW50c1VudGlsKHRoaXMuZW5kQUZDZWxsLCBsaXRlcmFscy5yb3cpLmdldEF0dHJpYnV0ZShsaXRlcmFscy5hcmlhUm93SW5kZXgpLCAxMCkgLSAxO1xuICAgICAgICAgICAgICAgIGVuZENlbGxJZHggPSBwYXJzZUludCh0aGlzLmVuZEFGQ2VsbC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYUNvbEluZGV4KSwgMTApIC0gMTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzQXBwbHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3QUZCb3JkZXJzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbElkeCA9IHBhcnNlSW50KHRoaXMuZW5kQ2VsbC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYUNvbEluZGV4KSwgMTApIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0cm93SWR4OyBpIDw9IGVuZHJvd0lkeDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbHMgPSB0aGlzLmdldEF1dG9GaWxsQ2VsbHMoaSwgc3RhcnRDZWxsSWR4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBjZWxsSWR4ICsgMTsgaiA8PSBlbmRDZWxsSWR4OyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYyA+IGNvbExlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZShpLCBqLCBjZWxsc1twYXJzZUludChjLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdENlbGxzQnlSYW5nZSh7IHJvd0luZGV4OiBzdGFydHJvd0lkeCwgY2VsbEluZGV4OiB0aGlzLnN0YXJ0Q2VsbEluZGV4IH0sIHsgcm93SW5kZXg6IGVuZHJvd0lkeCwgY2VsbEluZGV4OiBlbmRDZWxsSWR4IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgdGhpcy5hdXRvRmlsbFJMc2VsZWN0aW9uICYmIHN0YXJ0Q2VsbElkeCA+IGVuZENlbGxJZHggJiYgLy8gbGVmdFxuICAgICAgICAgICAgICAgIHN0YXJ0Q2VsbElkeCAtIGVuZENlbGxJZHggKyAxID4gZW5kcm93SWR4IC0gc3RhcnRyb3dJZHggLSByb3dMZW4gJiYgLy9sZWZ0IHRvcFxuICAgICAgICAgICAgICAgIHN0YXJ0Q2VsbElkeCAtIGVuZENlbGxJZHggKyAxID4gc3RhcnRyb3dJZHggLSBlbmRyb3dJZHg6IC8vIGxlZnQgYm90dG9tXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydEFGQ2VsbCA9IHRoaXMucGFyZW50LmdldENlbGxGcm9tSW5kZXgoc3RhcnRyb3dJZHgsIGVuZENlbGxJZHgpO1xuICAgICAgICAgICAgICAgIHRoaXMuZW5kQUZDZWxsID0gdGhpcy5lbmRDZWxsO1xuICAgICAgICAgICAgICAgIGlmICghaXNBcHBseSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYXdBRkJvcmRlcnMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydHJvd0lkeDsgaSA8PSBzdGFydHJvd0lkeCArIHJvd0xlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbHMgPSB0aGlzLmdldEF1dG9GaWxsQ2VsbHMoaSwgc3RhcnRDZWxsSWR4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxzLnJldmVyc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSB0aGlzLnN0YXJ0Q2VsbEluZGV4IC0gMTsgaiA+PSBlbmRDZWxsSWR4OyBqLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYyA+IGNvbExlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZShpLCBqLCBjZWxsc1twYXJzZUludChjLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdENlbGxzQnlSYW5nZSh7IHJvd0luZGV4OiBzdGFydHJvd0lkeCwgY2VsbEluZGV4OiBlbmRDZWxsSWR4IH0sIHsgcm93SW5kZXg6IHN0YXJ0cm93SWR4ICsgcm93TGVuLCBjZWxsSW5kZXg6IHRoaXMuc3RhcnRDZWxsSW5kZXggKyBjb2xMZW4gfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBzdGFydHJvd0lkeCA+IGVuZHJvd0lkeDogLy91cFxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRBRkNlbGwgPSB0aGlzLnBhcmVudC5nZXRDZWxsRnJvbUluZGV4KGVuZHJvd0lkeCwgc3RhcnRDZWxsSWR4KTtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZEFGQ2VsbCA9IHRoaXMuZW5kQ2VsbDtcbiAgICAgICAgICAgICAgICBpZiAoIWlzQXBwbHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3QUZCb3JkZXJzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJJZHggPSBwYXJzZUludCh0aGlzLmVuZENlbGwucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSwgMTApIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSB0cklkeDtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0cm93SWR4IC0gMTsgaSA+PSBlbmRyb3dJZHg7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgPT09IHRoaXMuc3RhcnRJbmRleCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gdHJJZHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbHMgPSB0aGlzLmdldEF1dG9GaWxsQ2VsbHMociwgc3RhcnRDZWxsSWR4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHItLTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSB0aGlzLnN0YXJ0Q2VsbEluZGV4OyBqIDw9IHRoaXMuc3RhcnRDZWxsSW5kZXggKyBjb2xMZW47IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVmFsdWUoaSwgaiwgY2VsbHNbcGFyc2VJbnQoYy50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjKys7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RDZWxsc0J5UmFuZ2UoeyByb3dJbmRleDogZW5kcm93SWR4LCBjZWxsSW5kZXg6IHN0YXJ0Q2VsbElkeCArIGNvbExlbiB9LCB7IHJvd0luZGV4OiBzdGFydHJvd0lkeCArIHJvd0xlbiwgY2VsbEluZGV4OiBzdGFydENlbGxJZHggfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDogLy9kb3duXG4gICAgICAgICAgICAgICAgdGhpcy5lbmRBRkNlbGwgPSB0aGlzLnBhcmVudC5nZXRDZWxsRnJvbUluZGV4KGVuZHJvd0lkeCwgc3RhcnRDZWxsSWR4ICsgY29sTGVuKTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzQXBwbHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3QUZCb3JkZXJzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJJZHggPSBwYXJzZUludCh0aGlzLmVuZENlbGwucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSwgMTApIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSB0aGlzLnN0YXJ0SW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSB0cklkeCArIDE7IGkgPD0gZW5kcm93SWR4OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyID09PSB0cklkeCArIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gdGhpcy5zdGFydEluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGxzID0gdGhpcy5nZXRBdXRvRmlsbENlbGxzKHIsIHN0YXJ0Q2VsbElkeCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByKys7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBtID0gdGhpcy5zdGFydENlbGxJbmRleDsgbSA8PSB0aGlzLnN0YXJ0Q2VsbEluZGV4ICsgY29sTGVuOyBtKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlKGksIG0sIGNlbGxzW3BhcnNlSW50KGMudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYysrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbHNCeVJhbmdlKHsgcm93SW5kZXg6IHRySWR4IC0gcm93TGVuLCBjZWxsSW5kZXg6IHN0YXJ0Q2VsbElkeCB9LCB7IHJvd0luZGV4OiBlbmRyb3dJZHgsIGNlbGxJbmRleDogc3RhcnRDZWxsSWR4ICsgY29sTGVuIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5tb3VzZVVwSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMuc3RvcFRpbWVyKCk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnZS1kaXNhYmxldXNlcnNlbGVjdCcpO1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50ICYmICFpc051bGxPclVuZGVmaW5lZCh0aGlzLmVsZW1lbnQucGFyZW50RWxlbWVudCkpIHtcbiAgICAgICAgICAgIHJlbW92ZSh0aGlzLmVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzRHJhZ2dlZCAmJiB0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXMubGVuZ3RoID09PSAxICYmIHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlc1swXS5jZWxsSW5kZXhlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHRoaXMubVVQVGFyZ2V0ID0gcGFyZW50c1VudGlsKGUudGFyZ2V0LCBsaXRlcmFscy5yb3dDZWxsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubVVQVGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2xvc2VSb3dDZWxsID0gY2xvc2VzdChlLnRhcmdldCwgJy5lLXJvd2NlbGwnKTtcbiAgICAgICAgaWYgKHRoaXMuaXNEcmFnZ2VkICYmICF0aGlzLmlzQXV0b0ZpbGxTZWwgJiYgdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5tb2RlID09PSAnQ2VsbCcgJiZcbiAgICAgICAgICAgIGNsb3NlUm93Q2VsbCAmJiBjbG9zZVJvd0NlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKGxpdGVyYWxzLnJvd0NlbGwpKSB7XG4gICAgICAgICAgICB2YXIgcm93SW5kZXggPSBwYXJzZUludChjbG9zZVJvd0NlbGwucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSwgMTApIC0gMTtcbiAgICAgICAgICAgIHZhciBjZWxsSW5kZXggPSBwYXJzZUludChjbG9zZVJvd0NlbGwuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICB0aGlzLmlzRHJhZ2dlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5jbGVhckNlbGxTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbHNCeVJhbmdlKHsgcm93SW5kZXg6IHRoaXMuc3RhcnRESW5kZXgsIGNlbGxJbmRleDogdGhpcy5zdGFydERDZWxsSW5kZXggfSwgeyByb3dJbmRleDogcm93SW5kZXgsIGNlbGxJbmRleDogY2VsbEluZGV4IH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNEcmFnZ2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMudXBkYXRlQXV0b0ZpbGxQb3NpdGlvbigpO1xuICAgICAgICBpZiAodGhpcy5pc0F1dG9GaWxsU2VsKSB7XG4gICAgICAgICAgICB0aGlzLnByZXZlbnRGb2N1cyA9IHRydWU7XG4gICAgICAgICAgICB2YXIgbGFzdENlbGwgPSBwYXJlbnRzVW50aWwoZS50YXJnZXQsIGxpdGVyYWxzLnJvd0NlbGwpO1xuICAgICAgICAgICAgdGhpcy5lbmRBRkNlbGwgPSBsYXN0Q2VsbCA/IGxhc3RDZWxsIDogdGhpcy5lbmRDZWxsID09PSB0aGlzLmVuZEFGQ2VsbCA/IHRoaXMuc3RhcnRBRkNlbGwgOiB0aGlzLmVuZEFGQ2VsbDtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRBRkNlbGwgPSB0aGlzLnN0YXJ0Q2VsbDtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5lbmRBRkNlbGwpICYmICFpc051bGxPclVuZGVmaW5lZCh0aGlzLnN0YXJ0QUZDZWxsKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhcnRDZWxsc0luZGV4KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RMaWtlQXV0b0ZpbGwoZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVBdXRvRmlsbFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlQUZCb3JkZXJzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbkJvcmRlcnMoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93SGlkZUJvcmRlcnMoJ25vbmUnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoRnJvemVuQm9yZGVycygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWdncmVnYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMucmVmcmVzaEZvb3RlclJlbmRlcmVyLCB7fSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pc0F1dG9GaWxsU2VsID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByZXZlbnRGb2N1cyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLCAnbW91c2Vtb3ZlJywgdGhpcy5tb3VzZU1vdmVIYW5kbGVyKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5wYXJlbnQuZ2V0SGVhZGVyQ29udGVudCgpLCAnbW91c2Vtb3ZlJywgdGhpcy5tb3VzZU1vdmVIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKGRvY3VtZW50LCAnbW91c2V1cCcsIHRoaXMubW91c2VVcEhhbmRsZXIpO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5oaWRlQXV0b0ZpbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmF1dG9maWxsKSB7XG4gICAgICAgICAgICB0aGlzLmF1dG9maWxsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZUF1dG9GaWxsUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVBdXRvRmlsbCAmJiAhdGhpcy5wYXJlbnQuaXNFZGl0ICYmXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblNldHRpbmdzLmNlbGxTZWxlY3Rpb25Nb2RlLmluZGV4T2YoJ0JveCcpID4gLTEgJiYgIXRoaXMuaXNSb3dUeXBlKCkgJiYgIXRoaXMuaXNTaW5nbGVTZWwoKVxuICAgICAgICAgICAgJiYgdGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gcGFyc2VJbnQodGhpcy50YXJnZXQuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICB2YXIgcmluZGV4ID0gcGFyc2VJbnQodGhpcy50YXJnZXQuZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCk7XG4gICAgICAgICAgICB2YXIgcm93SW5kZXggPSB0aGlzLnNlbGVjdGVkUm93Q2VsbEluZGV4ZXNbdGhpcy5zZWxlY3RlZFJvd0NlbGxJbmRleGVzLmxlbmd0aCAtIDFdLnJvd0luZGV4O1xuICAgICAgICAgICAgdmFyIGNlbGxzID0gdGhpcy5nZXRBdXRvRmlsbENlbGxzKHJvd0luZGV4LCBpbmRleCkuZmlsdGVyKGZ1bmN0aW9uIChlbGUpIHsgcmV0dXJuIGVsZS5zdHlsZS5kaXNwbGF5ID09PSAnJzsgfSk7XG4gICAgICAgICAgICB2YXIgY29sID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1uQnlJbmRleChpbmRleCk7XG4gICAgICAgICAgICB2YXIgaXNGcm96ZW5Db2wgPSBjb2wuZ2V0RnJlZXplVGFibGVOYW1lKCkgPT09ICdtb3ZhYmxlJztcbiAgICAgICAgICAgIHZhciBpc0Zyb3plblJvdyA9IHJpbmRleCA8IHRoaXMucGFyZW50LmZyb3plblJvd3M7XG4gICAgICAgICAgICB2YXIgaXNGcm96ZW5SaWdodCA9IHRoaXMucGFyZW50LmdldEZyb3plbk1vZGUoKSA9PT0gbGl0ZXJhbHMubGVmdFJpZ2h0XG4gICAgICAgICAgICAgICAgJiYgY29sLmdldEZyZWV6ZVRhYmxlTmFtZSgpID09PSBsaXRlcmFscy5mcm96ZW5SaWdodDtcbiAgICAgICAgICAgIGlmICghc2VsZWN0KCcjJyArIHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnX2F1dG9maWxsJywgcGFyZW50c1VudGlsKHRoaXMudGFyZ2V0LCBsaXRlcmFscy50YWJsZSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdCgnIycgKyB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgJ19hdXRvZmlsbCcsIHRoaXMucGFyZW50LmVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdCgnIycgKyB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgJ19hdXRvZmlsbCcsIHRoaXMucGFyZW50LmVsZW1lbnQpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9maWxsID0gY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLWF1dG9maWxsJywgaWQ6IHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnX2F1dG9maWxsJyB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9maWxsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1sZWZ0ZnJlZXplJykgfHwgdGhpcy50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJpZ2h0ZnJlZXplJykgfHxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWZpeGVkZnJlZXplJykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdXRvZmlsbC5jbGFzc0xpc3QuYWRkKCdlLWZyZWV6ZS1hdXRvZmlsbCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWlzRnJvemVuUm93KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNGcm96ZW5Db2wpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmdldENvbnRlbnRUYWJsZSgpLnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5hdXRvZmlsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKS5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuYXV0b2ZpbGwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRnJvemVuQ29sKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRIZWFkZXJUYWJsZSgpLnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5hdXRvZmlsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRIZWFkZXJUYWJsZSgpLnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5hdXRvZmlsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzRnJvemVuUmlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRnJvemVuUm93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRIZWFkZXJUYWJsZSgpLnBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5hdXRvZmlsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKS5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuYXV0b2ZpbGwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNlbGwgPSBjZWxsc1tjZWxscy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGlmIChjZWxsICYmIGNlbGwub2Zmc2V0UGFyZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNsaWVudFJlY3QgPSBjZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRPZmYgPSBjZWxsLm9mZnNldFBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICBpZiAoY2VsbC5vZmZzZXRQYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNvbnRlbnQnKSB8fCBjZWxsLm9mZnNldFBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaGVhZGVyY29udGVudCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudE9mZiA9IGNlbGwub2Zmc2V0UGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RhYmxlJykuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjb2xXaWR0aCA9IHRoaXMuaXNMYXN0Q2VsbChjZWxsKSA/IDQgOiAwO1xuICAgICAgICAgICAgICAgIHZhciByb3dIZWlnaHQgPSB0aGlzLmlzTGFzdFJvdyhjZWxsKSA/IDMgOiAwO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQuZW5hYmxlUnRsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXV0b2ZpbGwuc3R5bGUubGVmdCA9IGNsaWVudFJlY3QubGVmdCAtIHBhcmVudE9mZi5sZWZ0ICsgY2xpZW50UmVjdC53aWR0aCAtIDQgLSBjb2xXaWR0aCArICdweCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dG9maWxsLnN0eWxlLnJpZ2h0ID0gcGFyZW50T2ZmLnJpZ2h0IC0gY2xpZW50UmVjdC5yaWdodCArIGNsaWVudFJlY3Qud2lkdGggLSA0IC0gY29sV2lkdGggKyAncHgnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9maWxsLnN0eWxlLnRvcCA9IGNsaWVudFJlY3QudG9wIC0gcGFyZW50T2ZmLnRvcCArIGNsaWVudFJlY3QuaGVpZ2h0IC0gNSAtIHJvd0hlaWdodCArICdweCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmF1dG9maWxsLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZUF1dG9GaWxsKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUubW91c2VEb3duSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMubW91c2VCdXR0b24gPSBlLmJ1dHRvbjtcbiAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgaXNEcmFnO1xuICAgICAgICB2YXIgZ3JpZEVsZW1lbnQgPSBwYXJlbnRzVW50aWwodGFyZ2V0LCAnZS1ncmlkJyk7XG4gICAgICAgIGlmIChncmlkRWxlbWVudCAmJiBncmlkRWxlbWVudC5pZCAhPT0gZ09iai5lbGVtZW50LmlkIHx8IHBhcmVudHNVbnRpbCh0YXJnZXQsIGxpdGVyYWxzLmhlYWRlckNvbnRlbnQpICYmICF0aGlzLnBhcmVudC5mcm96ZW5Sb3dzIHx8XG4gICAgICAgICAgICBwYXJlbnRzVW50aWwodGFyZ2V0LCAnZS1lZGl0ZWRiYXRjaGNlbGwnKSB8fCBwYXJlbnRzVW50aWwodGFyZ2V0LCBsaXRlcmFscy5lZGl0ZWRSb3cpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUuc2hpZnRLZXkgfHwgZS5jdHJsS2V5KSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmVudHNVbnRpbCh0YXJnZXQsIGxpdGVyYWxzLnJvd0NlbGwpICYmICFlLnNoaWZ0S2V5ICYmICFlLmN0cmxLZXkpIHtcbiAgICAgICAgICAgIGlmIChnT2JqLnNlbGVjdGlvblNldHRpbmdzLmNlbGxTZWxlY3Rpb25Nb2RlLmluZGV4T2YoJ0JveCcpID4gLTEgJiYgIXRoaXMuaXNSb3dUeXBlKCkgJiYgIXRoaXMuaXNTaW5nbGVTZWwoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNDZWxsRHJhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgaXNEcmFnID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGdPYmouYWxsb3dSb3dEcmFnQW5kRHJvcCAmJiAhZ09iai5pc0VkaXQgJiYgIXRoaXMucGFyZW50LnNlbGVjdGlvblNldHRpbmdzLmNoZWNrYm94T25seSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNSb3dEcmFnU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNSb3dUeXBlKCkgfHwgdGhpcy5pc1NpbmdsZVNlbCgpIHx8IGNsb3Nlc3QodGFyZ2V0LCAndGQnKS5jbGFzc0xpc3QuY29udGFpbnMoJ2Utc2VsZWN0aW9uYmFja2dyb3VuZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNEcmFnZ2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaXNEcmFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtZ3JpZGRyYWdhcmVhJyB9KTtcbiAgICAgICAgICAgICAgICBnT2JqLmdldENvbnRlbnQoKS5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzRHJhZykge1xuICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlRHJhZyhlLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZVN0YXJ0RW5kQ2VsbHMoKTtcbiAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtYXV0b2ZpbGwnKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXhsc2VsJykpIHtcbiAgICAgICAgICAgIHRoaXMuaXNDZWxsRHJhZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmlzQXV0b0ZpbGxTZWwgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5lbmFibGVEcmFnKGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVN0YXJ0RW5kQ2VsbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjZWxscyA9IFtdLnNsaWNlLmNhbGwodGhpcy5wYXJlbnQuZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlLWNlbGxzZWxlY3Rpb25iYWNrZ3JvdW5kJykpO1xuICAgICAgICB0aGlzLnN0YXJ0Q2VsbCA9IGNlbGxzWzBdO1xuICAgICAgICB0aGlzLmVuZENlbGwgPSBjZWxsc1tjZWxscy5sZW5ndGggLSAxXTtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRDZWxsKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0SW5kZXggPSBwYXJzZUludCh0aGlzLnN0YXJ0Q2VsbC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZShsaXRlcmFscy5hcmlhUm93SW5kZXgpLCAxMCkgLSAxO1xuICAgICAgICAgICAgdGhpcy5zdGFydENlbGxJbmRleCA9IHBhcnNlSW50KHBhcmVudHNVbnRpbCh0aGlzLnN0YXJ0Q2VsbCwgbGl0ZXJhbHMucm93Q2VsbCkuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlU3RhcnRDZWxsc0luZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydENlbGwpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRJbmRleCA9IHBhcnNlSW50KHRoaXMuc3RhcnRDZWxsLnBhcmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0Q2VsbEluZGV4ID0gcGFyc2VJbnQocGFyZW50c1VudGlsKHRoaXMuc3RhcnRDZWxsLCBsaXRlcmFscy5yb3dDZWxsKS5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYUNvbEluZGV4KSwgMTApIC0gMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5lbmFibGVEcmFnID0gZnVuY3Rpb24gKGUsIGlzVXBkYXRlKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChpc1VwZGF0ZSkge1xuICAgICAgICAgICAgdmFyIHRyID0gY2xvc2VzdChlLnRhcmdldCwgJ3RyJyk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0REluZGV4ID0gcGFyc2VJbnQodHIuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0RENlbGxJbmRleCA9IHBhcnNlSW50KHBhcmVudHNVbnRpbChlLnRhcmdldCwgbGl0ZXJhbHMucm93Q2VsbClcbiAgICAgICAgICAgICAgICAuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdlLWRpc2FibGV1c2Vyc2VsZWN0Jyk7XG4gICAgICAgIHZhciBnQlJlY3QgPSBnT2JqLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHZhciBwb3N0aW9uID0gZ2V0UG9zaXRpb24oZSk7XG4gICAgICAgIHRoaXMueCA9IHBvc3Rpb24ueCAtIGdCUmVjdC5sZWZ0O1xuICAgICAgICB0aGlzLnkgPSBwb3N0aW9uLnkgLSBnQlJlY3QudG9wO1xuICAgICAgICBFdmVudEhhbmRsZXIuYWRkKGdPYmouZ2V0Q29udGVudCgpLCAnbW91c2Vtb3ZlJywgdGhpcy5tb3VzZU1vdmVIYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgIEV2ZW50SGFuZGxlci5hZGQoZ09iai5nZXRIZWFkZXJDb250ZW50KCksICdtb3VzZW1vdmUnLCB0aGlzLm1vdXNlTW92ZUhhbmRsZXIsIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQoZG9jdW1lbnQsICdtb3VzZXVwJywgdGhpcy5tb3VzZVVwSGFuZGxlciwgdGhpcyk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmNsZWFyU2VsQWZ0ZXJSZWZyZXNoID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIGlzSW5maW5pdGVTY3JvbGwgPSB0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyAmJiBlLnJlcXVlc3RUeXBlID09PSAnaW5maW5pdGVTY3JvbGwnO1xuICAgICAgICBpZiAoZS5yZXF1ZXN0VHlwZSAhPT0gJ3ZpcnR1YWxzY3JvbGwnICYmICF0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24gJiYgIWlzSW5maW5pdGVTY3JvbGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKGUucmVxdWVzdFR5cGUgPT09ICd2aXJ0dWFsc2Nyb2xsJyB8fCBpc0luZmluaXRlU2Nyb2xsKSAmJiB0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24gJiYgdGhpcy5pc1BhcnRpYWxTZWxlY3Rpb25cbiAgICAgICAgICAgICYmIHRoaXMuaXNIZHJTZWxlY3RBbGxDbGlja2VkKSB7XG4gICAgICAgICAgICB2YXIgcm93T2JqID0gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpLmZpbHRlcihmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5pc1NlbGVjdGFibGU7IH0pO1xuICAgICAgICAgICAgdmFyIGluZGV4ZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dTdGF0ZSA9IHt9O1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0U2VsZWN0ZWREYXRhID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd09iai5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGluZGV4ZXMucHVzaChyb3dPYmpbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmluZGV4KTtcbiAgICAgICAgICAgICAgICB2YXIgcGtWYWx1ZSA9IHRoaXMuZ2V0UGtWYWx1ZSh0aGlzLnByaW1hcnlLZXksIHJvd09ialtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZGF0YSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlW1wiXCIgKyBwa1ZhbHVlXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0U2VsZWN0ZWREYXRhLnB1c2gocm93T2JqW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5kYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzID0gaW5kZXhlcztcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ldnRIYW5kbGVycyA9IFt7IGV2ZW50OiBldmVudHMudWlVcGRhdGUsIGhhbmRsZXI6IHRoaXMuZW5hYmxlQWZ0ZXJSZW5kZXIgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50cy5pbml0aWFsRW5kLCBoYW5kbGVyOiB0aGlzLmluaXRpYWxpemVTZWxlY3Rpb24gfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50cy5yb3dTZWxlY3Rpb25Db21wbGV0ZSwgaGFuZGxlcjogdGhpcy5vbkFjdGlvbkNvbXBsZXRlIH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudHMuY2VsbFNlbGVjdGlvbkNvbXBsZXRlLCBoYW5kbGVyOiB0aGlzLm9uQWN0aW9uQ29tcGxldGUgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50cy5pbkJvdW5kTW9kZWxDaGFuZ2VkLCBoYW5kbGVyOiB0aGlzLm9uUHJvcGVydHlDaGFuZ2VkIH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudHMuY2VsbEZvY3VzZWQsIGhhbmRsZXI6IHRoaXMub25DZWxsRm9jdXNlZCB9LFxuICAgICAgICAgICAgeyBldmVudDogZXZlbnRzLmJlZm9yZUZyYWdBcHBlbmQsIGhhbmRsZXI6IHRoaXMuY2xlYXJTZWxBZnRlclJlZnJlc2ggfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50cy5jb2x1bW5Qb3NpdGlvbkNoYW5nZWQsIGhhbmRsZXI6IHRoaXMuY29sdW1uUG9zaXRpb25DaGFuZ2VkIH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudHMuY29udGVudFJlYWR5LCBoYW5kbGVyOiB0aGlzLmluaXRpYWxFbmQgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50cy5yb3dzUmVtb3ZlZCwgaGFuZGxlcjogdGhpcy5yb3dzUmVtb3ZlZCB9LFxuICAgICAgICAgICAgeyBldmVudDogZXZlbnRzLmhlYWRlclJlZnJlc2hlZCwgaGFuZGxlcjogdGhpcy5yZWZyZXNoSGVhZGVyIH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudHMuZGVzdHJveUF1dG9GaWxsRWxlbWVudHMsIGhhbmRsZXI6IHRoaXMuZGVzdHJveUF1dG9GaWxsRWxlbWVudHMgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50cy5kZXN0cm95LCBoYW5kbGVyOiB0aGlzLmRlc3Ryb3kgfV07XG4gICAgICAgIGFkZFJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5wYXJlbnQsIHRoaXMuZXZ0SGFuZGxlcnMsIHRydWUsIHRoaXMpO1xuICAgICAgICB0aGlzLmFjdGlvbkJlZ2luRnVuY3Rpb24gPSB0aGlzLmFjdGlvbkJlZ2luLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuYWN0aW9uQ29tcGxldGVGdW5jdGlvbiA9IHRoaXMuYWN0aW9uQ29tcGxldGUuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudHMuYWN0aW9uQmVnaW4sIHRoaXMuYWN0aW9uQmVnaW5GdW5jdGlvbik7XG4gICAgICAgIHRoaXMucGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRzLmFjdGlvbkNvbXBsZXRlLCB0aGlzLmFjdGlvbkNvbXBsZXRlRnVuY3Rpb24pO1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJfY2hlY2tib3goKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUoZG9jdW1lbnQsICdtb3VzZXVwJywgdGhpcy5tb3VzZVVwSGFuZGxlcik7XG4gICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLCAnbW91c2Vkb3duJywgdGhpcy5tb3VzZURvd25IYW5kbGVyKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLnBhcmVudC5nZXRIZWFkZXJDb250ZW50KCksICdtb3VzZWRvd24nLCB0aGlzLm1vdXNlRG93bkhhbmRsZXIpO1xuICAgICAgICBhZGRSZW1vdmVFdmVudExpc3RlbmVyKHRoaXMucGFyZW50LCB0aGlzLmV2dEhhbmRsZXJzLCBmYWxzZSk7XG4gICAgICAgIHRoaXMucGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRzLmFjdGlvbkJlZ2luLCB0aGlzLmFjdGlvbkJlZ2luRnVuY3Rpb24pO1xuICAgICAgICB0aGlzLnBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50cy5hY3Rpb25Db21wbGV0ZSwgdGhpcy5hY3Rpb25Db21wbGV0ZUZ1bmN0aW9uKTtcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyX2NoZWNrYm94KCk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9mZihldmVudHMuZGVzdHJveUF1dG9GaWxsRWxlbWVudHMsIHRoaXMuZGVzdHJveUF1dG9GaWxsRWxlbWVudHMpO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS53aXJlRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlzTWFjT1MgPSBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ01hYyBPUycpICE9PSAtMTtcbiAgICAgICAgaWYgKHRoaXMuaXNNYWNPUykge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnBhcmVudC5lbGVtZW50LCAna2V5ZG93bicsIHRoaXMua2V5RG93bkhhbmRsZXIsIHRoaXMpO1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnBhcmVudC5lbGVtZW50LCAna2V5dXAnLCB0aGlzLmtleVVwSGFuZGxlciwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50LmFsbG93S2V5Ym9hcmQpIHtcbiAgICAgICAgICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMucGFyZW50LmVsZW1lbnQsICdrZXlkb3duJywgdGhpcy5rZXlEb3duSGFuZGxlciwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUudW5XaXJlRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pc01hY09TKSB7XG4gICAgICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMucGFyZW50LmVsZW1lbnQsICdrZXlkb3duJywgdGhpcy5rZXlEb3duSGFuZGxlcik7XG4gICAgICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMucGFyZW50LmVsZW1lbnQsICdrZXl1cCcsIHRoaXMua2V5VXBIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQuYWxsb3dLZXlib2FyZCkge1xuICAgICAgICAgICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5wYXJlbnQuZWxlbWVudCwgJ2tleWRvd24nLCB0aGlzLmtleURvd25IYW5kbGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jb2x1bW5Qb3NpdGlvbkNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUucmVmcmVzaEhlYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNoZWNrYm94Q29sdW1uID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpLmZpbHRlcihmdW5jdGlvbiAoY29sKSB7IHJldHVybiBjb2wudHlwZSA9PT0gJ2NoZWNrYm94JzsgfSk7XG4gICAgICAgIGlmIChjaGVja2JveENvbHVtbi5sZW5ndGggJiYgIXRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpKSB7XG4gICAgICAgICAgICB0aGlzLmdyaWRDdXJyZW50UmVjb3JkID0gdGhpcy5nZXREYXRhKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRDaGVja0FsbFN0YXRlKCk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnJvd3NSZW1vdmVkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlLnJlY29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBwa1ZhbHVlID0gdGhpcy5nZXRQa1ZhbHVlKHRoaXMucHJpbWFyeUtleSwgZS5yZWNvcmRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICBkZWxldGUgKHRoaXMuc2VsZWN0ZWRSb3dTdGF0ZVtcIlwiICsgcGtWYWx1ZV0pO1xuICAgICAgICAgICAgLS10aGlzLnRvdGFsUmVjb3Jkc0NvdW50O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0Q2hlY2tBbGxTdGF0ZSgpO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5iZWZvcmVGcmFnQXBwZW5kID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUucmVxdWVzdFR5cGUgIT09ICd2aXJ0dWFsc2Nyb2xsJyAmJiAhdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZ2V0Q2hlY2tBbGxCb3ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5nZXRIZWFkZXJDb250ZW50KCkucXVlcnlTZWxlY3RvcignLmUtY2hlY2tzZWxlY3RhbGwnKTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZW5hYmxlQWZ0ZXJSZW5kZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoZS5tb2R1bGUgPT09IHRoaXMuZ2V0TW9kdWxlTmFtZSgpICYmIGUuZW5hYmxlKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgdGhpcy5pbml0UGVyaXNpc3RTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnBhcmVudC5nZXRDb250ZW50KCksICdtb3VzZWRvd24nLCB0aGlzLm1vdXNlRG93bkhhbmRsZXIsIHRoaXMpO1xuICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMucGFyZW50LmdldEhlYWRlckNvbnRlbnQoKSwgJ21vdXNlZG93bicsIHRoaXMubW91c2VEb3duSGFuZGxlciwgdGhpcyk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLm9uUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUubW9kdWxlICE9PSB0aGlzLmdldE1vZHVsZU5hbWUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZS5wcm9wZXJ0aWVzLnR5cGUpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25TZXR0aW5ncy50eXBlID09PSAnU2luZ2xlJykge1xuICAgICAgICAgICAgICAgIGdPYmouZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtbXVsdGlzZWxlY3RhYmxlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJDZWxsU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldkNJZHhzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyUm93U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldlJvd0luZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZENvbHVtbnNJbmRleGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhckNvbHVtblNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZDb2xJbmRleCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5lbmFibGVTZWxlY3RNdWx0aVRvdWNoID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlUG9wVXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MudHlwZSA9PT0gJ011bHRpcGxlJykge1xuICAgICAgICAgICAgICAgIGdPYmouZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbXVsdGlzZWxlY3RhYmxlJywgJ3RydWUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGUucHJvcGVydGllcy5tb2RlKSB8fFxuICAgICAgICAgICAgIWlzTnVsbE9yVW5kZWZpbmVkKGUucHJvcGVydGllcy5jZWxsU2VsZWN0aW9uTW9kZSkpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMucHJldlJvd0luZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5wcmV2Q0lkeHMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLnByZXZDb2xJbmRleCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzUGVyc2lzdGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jaGVja0JveFNlbGVjdGlvbkNoYW5nZWQoKTtcbiAgICAgICAgdGhpcy5pc1BlcnNpc3RlZCA9IGZhbHNlO1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMuaW5pdFBlcmlzaXN0U2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoZWNrYm94Q29sdW1uID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpLmZpbHRlcihmdW5jdGlvbiAoY29sKSB7IHJldHVybiBjb2wudHlwZSA9PT0gJ2NoZWNrYm94JzsgfSk7XG4gICAgICAgIGlmIChjaGVja2JveENvbHVtbi5sZW5ndGgpIHtcbiAgICAgICAgICAgIGdPYmouaXNDaGVja0JveFNlbGVjdGlvbiA9ICEodGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5jaGVja2JveE1vZGUgPT09ICdSZXNldE9uUm93Q2xpY2snKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRyYXdCb3JkZXJzKCk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmhpZGVQb3BVcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZ3JpZHBvcHVwJykuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1yb3dzZWxlY3QnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZ3JpZHBvcHVwJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5pbml0aWFsRW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5jb250ZW50UmVhZHksIHRoaXMuaW5pdGlhbEVuZCk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdFJvdyh0aGlzLnBhcmVudC5zZWxlY3RlZFJvd0luZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jaGVja0JveFNlbGVjdGlvbkNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnb2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGdvYmoub2ZmKGV2ZW50cy5jb250ZW50UmVhZHksIHRoaXMuY2hlY2tCb3hTZWxlY3Rpb25DaGFuZ2VkKTtcbiAgICAgICAgdmFyIGNoZWNrYm94Q29sdW1uID0gZ29iai5nZXRDb2x1bW5zKCkuZmlsdGVyKGZ1bmN0aW9uIChjb2wpIHsgcmV0dXJuIGNvbC50eXBlID09PSAnY2hlY2tib3gnOyB9KTtcbiAgICAgICAgaWYgKGNoZWNrYm94Q29sdW1uLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGdvYmouaXNDaGVja0JveFNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmNoa0ZpZWxkID0gY2hlY2tib3hDb2x1bW5bMF0uZmllbGQ7XG4gICAgICAgICAgICB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50ID0gdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLnRvdGFsUmVjb3Jkc0NvdW50O1xuICAgICAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMudG90YWxSZWNvcmRzQ291bnQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b3RhbFJlY29yZHNDb3VudCA9IHRoaXMuZ2V0Q3VycmVudEJhdGNoUmVjb3JkQ2hhbmdlcygpLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmlzU2luZ2xlU2VsKCkpIHtcbiAgICAgICAgICAgICAgICBnb2JqLnNlbGVjdGlvblNldHRpbmdzLnR5cGUgPSAnTXVsdGlwbGUnO1xuICAgICAgICAgICAgICAgIGdvYmouZGF0YUJpbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlcmlzaXN0U2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFnb2JqLmlzQ2hlY2tCb3hTZWxlY3Rpb24gJiYgIXRoaXMuaXNQZXJzaXN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY2hrRmllbGQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5pbml0UGVyaXNpc3RTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5pbml0UGVyaXNpc3RTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnb2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5zZWxlY3Rpb25TZXR0aW5ncy5wZXJzaXN0U2VsZWN0aW9uICYmIHRoaXMucGFyZW50LmdldFByaW1hcnlLZXlGaWVsZE5hbWVzKCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZ29iai5pc1BlcnNpc3RTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5lbnN1cmVDaGVja2JveEZpZWxkU2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5wYXJlbnQuZ2V0UHJpbWFyeUtleUZpZWxkTmFtZXMoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBnb2JqLmlzUGVyc2lzdFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5lbnN1cmVDaGVja2JveEZpZWxkU2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBnb2JqLmlzUGVyc2lzdFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlID0ge307XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZW5zdXJlQ2hlY2tib3hGaWVsZFNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdvYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdGhpcy5wcmltYXJ5S2V5ID0gdGhpcy5wYXJlbnQuZ2V0UHJpbWFyeUtleUZpZWxkTmFtZXMoKVswXTtcbiAgICAgICAgaWYgKCFnb2JqLmVuYWJsZVZpcnR1YWxpemF0aW9uICYmIHRoaXMuY2hrRmllbGRcbiAgICAgICAgICAgICYmICgoZ29iai5pc1BlcnNpc3RTZWxlY3Rpb24gJiYgT2JqZWN0LmtleXModGhpcy5zZWxlY3RlZFJvd1N0YXRlKS5sZW5ndGggPT09IDApIHx8XG4gICAgICAgICAgICAgICAgIWdvYmouaXNQZXJzaXN0U2VsZWN0aW9uKSkge1xuICAgICAgICAgICAgdGhpcy5kYXRhU3VjY2VzcygoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpICYmIHRoaXMucGFyZW50LmRhdGFTb3VyY2UucmVzdWx0KSB8fFxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpID8gdGhpcy5wYXJlbnQuZ2V0Q3VycmVudFZpZXdSZWNvcmRzKCkgOlxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnJlbmRlck1vZHVsZS5kYXRhLmRhdGFNYW5hZ2VyLmRhdGFTb3VyY2UuanNvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZGF0YVN1Y2Nlc3MgPSBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcGtWYWx1ZSA9IHRoaXMuZ2V0UGtWYWx1ZSh0aGlzLnByaW1hcnlLZXksIHJlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgdmFyIGNoZWNrZWRGaWVsZERhdGEgPSByZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldW3RoaXMuY2hrRmllbGRdO1xuICAgICAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc2VsZWN0ZWRSb3dTdGF0ZVtcIlwiICsgcGtWYWx1ZV0pICYmIGNoZWNrZWRGaWVsZERhdGEgJiYgdHlwZW9mIGNoZWNrZWRGaWVsZERhdGEgPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dTdGF0ZVtcIlwiICsgcGtWYWx1ZV0gPSBjaGVja2VkRmllbGREYXRhO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0U2VsZWN0ZWREYXRhLnB1c2gocmVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnNldFJvd1NlbGVjdGlvbiA9IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICBpZiAoISh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSB8fCAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpXG4gICAgICAgICAgICAmJiB0aGlzLnBhcmVudC5kYXRhU291cmNlLnJlc3VsdCkpKSB7XG4gICAgICAgICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1BhcnRpYWxTZWxlY3Rpb24gJiYgKHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8IHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm93T2JqID0gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpLmZpbHRlcihmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5pc1NlbGVjdGFibGU7IH0pO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJvd09ial8xID0gcm93T2JqOyBfaSA8IHJvd09ial8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJvdyA9IHJvd09ial8xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dTdGF0ZVt0aGlzLmdldFBrVmFsdWUodGhpcy5wcmltYXJ5S2V5LCByb3cuZGF0YSldID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkRGF0YSA9IHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uID8gdGhpcy5wYXJlbnQucGFydGlhbFNlbGVjdGVkUmVjb3JkcyA6IHRoaXMuZ2V0RGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBfYiA9IHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uID8gc2VsZWN0ZWREYXRhIDogc2VsZWN0ZWREYXRhLnJlY29yZHM7IF9hIDwgX2IubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBfYltfYV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlW3RoaXMuZ2V0UGtWYWx1ZSh0aGlzLnByaW1hcnlLZXksIGRhdGEpXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfYyA9IDAsIHNlbGVjdGVkRGF0YV8xID0gc2VsZWN0ZWREYXRhOyBfYyA8IHNlbGVjdGVkRGF0YV8xLmxlbmd0aDsgX2MrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gc2VsZWN0ZWREYXRhXzFbX2NdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dTdGF0ZVt0aGlzLmdldFBrVmFsdWUodGhpcy5wcmltYXJ5S2V5LCBkYXRhKV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyAodGhpcy5nZXREYXRhKCkpLmZvckVhY2goZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIC8vICAgICB0aGlzLnNlbGVjdGVkUm93U3RhdGVbZGF0YVt0aGlzLnByaW1hcnlLZXldXSA9IHRydWU7XG4gICAgICAgICAgICAvLyB9KVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkU3RhdGVLZXlzID0gT2JqZWN0LmtleXModGhpcy5zZWxlY3RlZFJvd1N0YXRlKTtcbiAgICAgICAgICAgICAgICB2YXIgdW5TZWxlY3RlZFJvd1N0YXRlS2V5cyA9IE9iamVjdC5rZXlzKHRoaXMudW5TZWxlY3RlZFJvd1N0YXRlKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNDaGVja2JveFJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByb3dEYXRhID0gKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiYgdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5jdXJyZW50Vmlld0RhdGFbJ3JlY29yZHMnXSA6IHRoaXMucGFyZW50LmN1cnJlbnRWaWV3RGF0YTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2QgPSAwLCByb3dEYXRhXzEgPSByb3dEYXRhOyBfZCA8IHJvd0RhdGFfMS5sZW5ndGg7IF9kKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcm93RGF0YV8xW19kXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZGF0YVt0aGlzLnByaW1hcnlLZXldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBkYXRhW3RoaXMucHJpbWFyeUtleV0udG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRTdGF0ZUtleXMuaW5kZXhPZihrZXkpID09PSAtMSAmJiB1blNlbGVjdGVkUm93U3RhdGVLZXlzLmluZGV4T2Yoa2V5KSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlW2RhdGFbdGhpcy5wcmltYXJ5S2V5XV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dTdGF0ZSA9IHt9O1xuICAgICAgICAgICAgICAgIHRoaXMudW5TZWxlY3RlZFJvd1N0YXRlID0ge307XG4gICAgICAgICAgICAgICAgdGhpcy5ybXRIZHJDaGtieENsaWNrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5nZXREYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmRhdGFNYW5hZ2VyLmV4ZWN1dGVMb2NhbCh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuZ2VuZXJhdGVRdWVyeSh0cnVlKSk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmdldEF2YWlsYWJsZVNlbGVjdGVkRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBmaWx0ZXJlZFNlYXJjaGVkU2VsZWN0ZWREYXRhID0gbmV3IERhdGFNYW5hZ2VyKGRhdGEpLmV4ZWN1dGVMb2NhbCh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuZ2VuZXJhdGVRdWVyeSh0cnVlKSk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICYmIGZpbHRlcmVkU2VhcmNoZWRTZWxlY3RlZERhdGEgJiZcbiAgICAgICAgICAgIGZpbHRlcmVkU2VhcmNoZWRTZWxlY3RlZERhdGEucmVjb3Jkcykge1xuICAgICAgICAgICAgZmlsdGVyZWRTZWFyY2hlZFNlbGVjdGVkRGF0YSA9IGZpbHRlcmVkU2VhcmNoZWRTZWxlY3RlZERhdGEucmVjb3Jkcy5zbGljZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWx0ZXJlZFNlYXJjaGVkU2VsZWN0ZWREYXRhO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5yZWZyZXNoUGVyc2lzdFNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJvd3MgPSB0aGlzLnBhcmVudC5nZXRSb3dzKCk7XG4gICAgICAgIHRoaXMudG90YWxSZWNvcmRzQ291bnQgPSB0aGlzLnBhcmVudC5nZXRDdXJyZW50Vmlld1JlY29yZHMoKS5sZW5ndGg7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd1BhZ2luZykge1xuICAgICAgICAgICAgdGhpcy50b3RhbFJlY29yZHNDb3VudCA9IHRoaXMucGFyZW50LnBhZ2VTZXR0aW5ncy50b3RhbFJlY29yZHNDb3VudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHJvd3MpICYmIHJvd3MubGVuZ3RoID4gMCAmJiAodGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uIHx8IHRoaXMuY2hrRmllbGQpKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXhlcyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByb3dzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvd09iaiA9IHRoaXMuZ2V0Um93T2JqKHJvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICB2YXIgcEtleSA9IHJvd09iaiA/IHJvd09iai5kYXRhID8gdGhpcy5nZXRQa1ZhbHVlKHRoaXMucHJpbWFyeUtleSwgcm93T2JqLmRhdGEpIDogbnVsbCA6IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKHBLZXkgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1BhcnRpYWxTZWxlY3Rpb24gJiYgIXJvd09iai5pc1NlbGVjdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjaGVja1N0YXRlID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIHZhciBjaGtCb3ggPSByb3dzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5xdWVyeVNlbGVjdG9yKCcuZS1jaGVja3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkUm93U3RhdGVbXCJcIiArIHBLZXldIHx8ICh0aGlzLnBhcmVudC5jaGVja0FsbFJvd3MgPT09ICdDaGVjaycgJiYgdGhpcy5zZWxlY3RlZFJvd1N0YXRlW1wiXCIgKyBwS2V5XSAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50ID09PSBPYmplY3Qua2V5cyh0aGlzLnNlbGVjdGVkUm93U3RhdGUpLmxlbmd0aCAmJiB0aGlzLmNoa0FsbENvbGxlYy5pbmRleE9mKHBLZXkpIDwgMClcbiAgICAgICAgICAgICAgICAgICAgfHwgKHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9PT0gJ1VuY2hlY2snICYmIHRoaXMuY2hrQWxsQ29sbGVjLmluZGV4T2YocEtleSkgPiAwICYmICF0aGlzLnBhcmVudC5zZWxlY3RlZFJvd0luZGV4KVxuICAgICAgICAgICAgICAgICAgICB8fCAodGhpcy5wYXJlbnQuY2hlY2tBbGxSb3dzID09PSAnSW50ZXJtZWRpYXRlJyAmJiAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jaGtGaWVsZCkgJiYgcm93T2JqLmRhdGFbdGhpcy5jaGtGaWVsZF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ZXMucHVzaChwYXJzZUludChyb3dzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSwgMTApIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrU3RhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tTdGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGVja2VkVGFyZ2V0ICE9PSBjaGtCb3ggJiYgdGhpcy5wYXJlbnQuaXNDaGVja0JveFNlbGVjdGlvbiAmJiBjaGtCb3gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUFkZENib3hDbGFzc2VzKGNoa0JveC5uZXh0RWxlbWVudFNpYmxpbmcsIGNoZWNrU3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUGVyc2lzdENvbGxlY3Rpb24ocm93c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0sIGNoZWNrU3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaXNTaW5nbGVTZWwoKSAmJiBpbmRleGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFJvdyhpbmRleGVzWzBdLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93cyhpbmRleGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoKHRoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb24gfHwgdGhpcy5wYXJlbnQuc2VsZWN0aW9uU2V0dGluZ3MuY2hlY2tib3hNb2RlID09PSAnUmVzZXRPblJvd0NsaWNrJykgJiYgdGhpcy5nZXRDdXJyZW50QmF0Y2hSZWNvcmRDaGFuZ2VzKCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5zZXRDaGVja0FsbFN0YXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuYWN0aW9uQmVnaW4gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoZS5yZXF1ZXN0VHlwZSA9PT0gJ3NhdmUnICYmIHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgdmFyIGVkaXRDaGtCb3ggPSB0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWVkaXQtY2hlY2tzZWxlY3QnKTtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZWRpdENoa0JveCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcm93ID0gY2xvc2VzdChlZGl0Q2hrQm94LCAnLicgKyBsaXRlcmFscy5lZGl0ZWRSb3cpO1xuICAgICAgICAgICAgICAgIGlmIChyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5tb2RlID09PSAnRGlhbG9nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93ID0gdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1kbGdlZGl0cm93Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvd09iaiA9IHRoaXMuZ2V0Um93T2JqKHJvdyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcm93T2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlW3RoaXMuZ2V0UGtWYWx1ZSh0aGlzLnByaW1hcnlLZXksIHJvd09iai5kYXRhKV0gPSByb3dPYmouaXNTZWxlY3RlZCA9IGVkaXRDaGtCb3guY2hlY2tlZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNDaGVja2VkT25BZGQgPSBlZGl0Q2hrQm94LmNoZWNrZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24gJiYgdGhpcy5pc1BhcnRpYWxTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIGlmIChlLnJlcXVlc3RUeXBlID09PSAncGFnaW5nJyAmJiAodGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmlzUmVtb3RlKClcbiAgICAgICAgICAgICAgICB8fCAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpICYmIHRoaXMucGFyZW50LmRhdGFTb3VyY2UucmVzdWx0KSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93SW5kZXhlcyA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmFjdGlvbkNvbXBsZXRlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUucmVxdWVzdFR5cGUgPT09ICdzYXZlJyAmJiB0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIGlmIChlLmFjdGlvbiA9PT0gJ2FkZCcpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0NoZWNrZWRPbkFkZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm93T2JqID0gdGhpcy5wYXJlbnQuZ2V0Um93T2JqZWN0RnJvbVVJRCh0aGlzLnBhcmVudC5nZXRSb3dzKClbZS5zZWxlY3RlZFJvd10uZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd1N0YXRlW3RoaXMuZ2V0UGtWYWx1ZSh0aGlzLnByaW1hcnlLZXksIHJvd09iai5kYXRhKV0gPSByb3dPYmouaXNTZWxlY3RlZCA9IHRoaXMuaXNDaGVja2VkT25BZGQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaXNIZHJTZWxlY3RBbGxDbGlja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRDaGVja0FsbFN0YXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hQZXJzaXN0U2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUucmVxdWVzdFR5cGUgPT09ICdkZWxldGUnICYmIHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgdmFyIHJlY29yZHMgPSBlLmRhdGE7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHJlY29yZHMuc2xpY2UoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBwa1ZhbHVlID0gdGhpcy5nZXRQa1ZhbHVlKHRoaXMucHJpbWFyeUtleSwgZGF0YVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQocGtWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVQZXJzaXN0RGVsZXRlKHBrVmFsdWUsIHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmlzSGRyU2VsZWN0QWxsQ2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zZXRDaGVja0FsbFN0YXRlKCk7XG4gICAgICAgICAgICB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50ID0gdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLnRvdGFsUmVjb3Jkc0NvdW50O1xuICAgICAgICB9XG4gICAgICAgIGlmIChlLnJlcXVlc3RUeXBlID09PSAncGFnaW5nJykge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbiAmJiB0aGlzLmlzUGFydGlhbFNlbGVjdGlvbiAmJiB0aGlzLmlzSGRyU2VsZWN0QWxsQ2xpY2tlZCkge1xuICAgICAgICAgICAgICAgIHZhciByb3dzID0gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpO1xuICAgICAgICAgICAgICAgIHZhciBpbmRleGVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc1NlbGVjdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ZXMucHVzaChyb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93cyhpbmRleGVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByZXZSb3dJbmRleCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMucHJldkNJZHhzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5wcmV2RUNJZHhzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLm9uRGF0YUJvdW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2hlY2tib3hDb2x1bW4gPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCkuZmlsdGVyKGZ1bmN0aW9uIChjb2wpIHsgcmV0dXJuIGNvbC50eXBlID09PSAnY2hlY2tib3gnOyB9KTtcbiAgICAgICAgaWYgKGNoZWNrYm94Q29sdW1uLmxlbmd0aCAmJiAhdGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmlzUmVtb3RlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuZ3JpZEN1cnJlbnRSZWNvcmQgPSB0aGlzLmdldERhdGEoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uICYmIHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRSZWNvcmRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNQcmV2Um93U2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoKCh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSB8fCAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpXG4gICAgICAgICAgICAmJiB0aGlzLnBhcmVudC5kYXRhU291cmNlLnJlc3VsdCkpICYmIHRoaXMucm10SGRyQ2hrYnhDbGlja2VkKVxuICAgICAgICAgICAgfHwgKHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uICYmIHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbiAmJiB0aGlzLmlzSGRyU2VsZWN0QWxsQ2xpY2tlZCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5jaGVja0FsbFJvd3MgPT09ICdJbnRlcm1lZGlhdGUnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRSb3dTZWxlY3Rpb24odHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnBhcmVudC5jaGVja0FsbFJvd3MgPT09ICdVbmNoZWNrJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0Um93U2VsZWN0aW9uKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Q2hlY2tBbGxTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFBlcnNpc3RTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRpYWxSb3dTZWxlY3Rpb24gPSB0aGlzLmlzUm93VHlwZSgpICYmIHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtc2VsZWN0aW9uYmFja2dyb3VuZCcpICYmXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRTZWxlY3RlZFJvd3MoKS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0NoZWNrQm94U2VsZWN0aW9uICYmICF0aGlzLmluaXRpYWxSb3dTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHZhciB0b3RhbFJlY29yZHMgPSB0aGlzLnBhcmVudC5nZXRSb3dzT2JqZWN0KCk7XG4gICAgICAgICAgICB2YXIgaW5kZXhlcyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b3RhbFJlY29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodG90YWxSZWNvcmRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc1NlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ZXMucHVzaChpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5kZXhlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFJvd3MoaW5kZXhlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxSb3dTZWxlY3Rpb24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVBlcnNpc3RTZWxlY3RlZERhdGEgPSBmdW5jdGlvbiAoY2hlY2tTdGF0ZSkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICB2YXIgcm93cyA9IHRoaXMucGFyZW50LmdldFJvd3MoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUGVyc2lzdENvbGxlY3Rpb24ocm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGNoZWNrU3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9PT0gJ1VuY2hlY2snKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRSb3dTZWxlY3Rpb24oZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMucGVyc2lzdFNlbGVjdGVkRGF0YSA9ICh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKVxuICAgICAgICAgICAgICAgICAgICB8fCAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpICYmIHRoaXMucGFyZW50LmRhdGFTb3VyY2UucmVzdWx0KSlcbiAgICAgICAgICAgICAgICAgICAgPyB0aGlzLnBlcnNpc3RTZWxlY3RlZERhdGEgOiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9PT0gJ0NoZWNrJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0Um93U2VsZWN0aW9uKHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMucGVyc2lzdFNlbGVjdGVkRGF0YSA9ICEodGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmlzUmVtb3RlKClcbiAgICAgICAgICAgICAgICAgICAgfHwgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5kYXRhU291cmNlKSAmJiB0aGlzLnBhcmVudC5kYXRhU291cmNlLnJlc3VsdCkpXG4gICAgICAgICAgICAgICAgICAgICYmICF0aGlzLmlzUGFydGlhbFNlbGVjdGlvbiA/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggPyB0aGlzLmdldERhdGEoKS5yZWNvcmRzLnNsaWNlKCkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXREYXRhKCkuc2xpY2UoKSA6IHRoaXMucGVyc2lzdFNlbGVjdGVkRGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jaGVja1NlbGVjdEFsbEFjdGlvbiA9IGZ1bmN0aW9uIChjaGVja1N0YXRlKSB7XG4gICAgICAgIHZhciBjUmVuZGVyZXIgPSB0aGlzLmdldFJlbmRlcmVyKCk7XG4gICAgICAgIHZhciBlZGl0Rm9ybSA9IHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZ3JpZGZvcm0nKTtcbiAgICAgICAgdGhpcy5jaGVja2VkVGFyZ2V0ID0gdGhpcy5nZXRDaGVja0FsbEJveCgpO1xuICAgICAgICBpZiAoY2hlY2tTdGF0ZSAmJiB0aGlzLmdldEN1cnJlbnRCYXRjaFJlY29yZENoYW5nZXMoKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9ICdDaGVjayc7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBlcnNpc3RTZWxlY3RlZERhdGEoY2hlY2tTdGF0ZSk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdFJvd3NCeVJhbmdlKGNSZW5kZXJlci5nZXRWaXJ0dWFsUm93SW5kZXgoMCksIGNSZW5kZXJlci5nZXRWaXJ0dWFsUm93SW5kZXgodGhpcy5nZXRDdXJyZW50QmF0Y2hSZWNvcmRDaGFuZ2VzKCkubGVuZ3RoIC0gMSkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tWaXJ0dWFsQ2hlY2tCb3goKSAmJiAhdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aXJ0dWFsU2VsZWN0ZWREYXRhID0gdGhpcy52aXJ0dWFsQ2hlY2tCb3hEYXRhKCkuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93SW5kZXhlcyA9IE9iamVjdC5rZXlzKHRoaXMudmlydHVhbFNlbGVjdGVkRGF0YSkubWFwKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIHBhcnNlSW50KGtleSwgMTApOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9ICdVbmNoZWNrJztcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUGVyc2lzdFNlbGVjdGVkRGF0YShjaGVja1N0YXRlKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoa0FsbENvbGxlYyA9IFtdO1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGVkaXRGb3JtKSkge1xuICAgICAgICAgICAgdmFyIGVkaXRDaGtCb3ggPSBlZGl0Rm9ybS5xdWVyeVNlbGVjdG9yKCcuZS1lZGl0LWNoZWNrc2VsZWN0Jyk7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGVkaXRDaGtCb3gpKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQWRkQ2JveENsYXNzZXMoZWRpdENoa0JveC5uZXh0RWxlbWVudFNpYmxpbmcsIGNoZWNrU3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmNoZWNrU2VsZWN0QWxsID0gZnVuY3Rpb24gKGNoZWNrQm94KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzdGF0ZVN0ciA9IHRoaXMuZ2V0Q2hlY2tBbGxTdGF0dXMoY2hlY2tCb3gpO1xuICAgICAgICB2YXIgc3RhdGUgPSBzdGF0ZVN0ciA9PT0gJ0NoZWNrJztcbiAgICAgICAgdGhpcy5pc0hlYWRlckNoZWNrYm94Q2xpY2tlZCA9IHRydWU7XG4gICAgICAgIGlmICgodGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmlzUmVtb3RlKCkgfHwgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5kYXRhU291cmNlKVxuICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5yZXN1bHQpKSAmJiAoKHN0YXRlU3RyID09PSAnVW5jaGVjaycgfHwgdGhpcy5pc0NoZWNrYm94UmVzZXQpIHx8XG4gICAgICAgICAgICAoc3RhdGVTdHIgPT09ICdJbnRlcm1lZGlhdGUnICYmIHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikpKSB7XG4gICAgICAgICAgICB0aGlzLnJtdEhkckNoa2J4Q2xpY2tlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJtdEhkckNoa2J4Q2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJtdEhkckNoa2J4Q2xpY2tlZCAmJiB0aGlzLmlzQ2hlY2tib3hSZXNldCkge1xuICAgICAgICAgICAgdGhpcy51blNlbGVjdGVkUm93U3RhdGUgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzQ2hlY2tib3hSZXNldCA9IGZhbHNlO1xuICAgICAgICBpZiAoc3RhdGVTdHIgPT09ICdJbnRlcm1lZGlhdGUnKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2hrRmllbGQgJiYgIXRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpcy5nZXRDdXJyZW50QmF0Y2hSZWNvcmRDaGFuZ2VzKCkuc29tZShmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZ2V0UGtWYWx1ZShfdGhpcy5wcmltYXJ5S2V5LCBkYXRhKSBpbiBfdGhpcy5zZWxlY3RlZFJvd1N0YXRlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd1BhZ2luZyAmJiB0aGlzLmlzUGFydGlhbFNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm93T2JqZWN0cyA9IHRoaXMucGFyZW50LmdldFJvd3NPYmplY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByb3dPYmplY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93T2JqZWN0c1tpXS5pc0RhdGFSb3cgJiYgcm93T2JqZWN0c1tpXS5pc1NlbGVjdGFibGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhcm93T2JqZWN0c1tpXS5pc1NlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICgodGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmlzUmVtb3RlKCkgfHwgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5kYXRhU291cmNlKVxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLnBhcmVudC5kYXRhU291cmNlLnJlc3VsdCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5nZXRDdXJyZW50QmF0Y2hSZWNvcmRDaGFuZ2VzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5nZXRQa1ZhbHVlKHRoaXMucHJpbWFyeUtleSwgdGhpcy5nZXRDdXJyZW50QmF0Y2hSZWNvcmRDaGFuZ2VzKClbXCJcIiArIGldKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLnNlbGVjdGVkUm93U3RhdGUpLmluY2x1ZGVzKCh0aGlzLmdldFBrVmFsdWUodGhpcy5wcmltYXJ5S2V5LCB0aGlzLmdldEN1cnJlbnRCYXRjaFJlY29yZENoYW5nZXMoKVtcIlwiICsgaV0pKS50b1N0cmluZygpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbiAmJiB0aGlzLnBhcmVudC5hbGxvd1BhZ2luZykge1xuICAgICAgICAgICAgdGhpcy50b3RhbFJlY29yZHNDb3VudCA9IHRoaXMucGFyZW50LnBhZ2VTZXR0aW5ncy50b3RhbFJlY29yZHNDb3VudDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoZWNrU2VsZWN0QWxsQWN0aW9uKCFzdGF0ZSk7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuZ2V0Q3VycmVudEJhdGNoUmVjb3JkQ2hhbmdlcygpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Q2hlY2tBbGxTdGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3RlZFJvd0luZGV4ZXMoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRyaWdnZXJDaGtDaGFuZ2VFdmVudChjaGVja0JveCwgIXN0YXRlKTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZ2V0Q2hlY2tBbGxTdGF0dXMgPSBmdW5jdGlvbiAoZWxlKSB7XG4gICAgICAgIHZhciBjbGFzc2VzO1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGVsZSkpIHtcbiAgICAgICAgICAgIGNsYXNzZXMgPSBlbGUubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5nZXRDaGVja0FsbEJveCgpKSkge1xuICAgICAgICAgICAgICAgIGNsYXNzZXMgPSB0aGlzLmdldENoZWNrQWxsQm94KCkubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RhdHVzID0gJ05vbmUnO1xuICAgICAgICBpZiAoY2xhc3NlcyBpbnN0YW5jZW9mIERPTVRva2VuTGlzdCkge1xuICAgICAgICAgICAgaWYgKGNsYXNzZXMuY29udGFpbnMoJ2UtY2hlY2snKSkge1xuICAgICAgICAgICAgICAgIHN0YXR1cyA9ICdDaGVjayc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbGFzc2VzLmNvbnRhaW5zKCdlLXVuY2hlY2snKSkge1xuICAgICAgICAgICAgICAgIHN0YXR1cyA9ICdVbmNoZWNrJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNsYXNzZXMuY29udGFpbnMoJ2Utc3RvcCcpKSB7XG4gICAgICAgICAgICAgICAgc3RhdHVzID0gJ0ludGVybWVkaWF0ZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0YXR1cztcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuY2hlY2tTZWxlY3QgPSBmdW5jdGlvbiAoY2hlY2tCb3gpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGNsb3Nlc3QodGhpcy5jaGVja2VkVGFyZ2V0LCAnLicgKyBsaXRlcmFscy5yb3dDZWxsKTtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdGhpcy5pc011bHRpQ3RybFJlcXVlc3QgPSB0cnVlO1xuICAgICAgICB2YXIgckluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5pc0hlYWRlckNoZWNrYm94Q2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICBpZiAoaXNHcm91cEFkYXB0aXZlKGdPYmopKSB7XG4gICAgICAgICAgICB2YXIgdWlkID0gdGFyZ2V0LnBhcmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uICYmIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBySW5kZXggPSBwYXJzZUludCh0YXJnZXQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSwgMTApIC0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJJbmRleCA9IGdPYmouZ2V0Um93cygpLm1hcChmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdWlkJyk7IH0pLmluZGV4T2YodWlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJJbmRleCA9IHBhcnNlSW50KHRhcmdldC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZShsaXRlcmFscy5hcmlhUm93SW5kZXgpLCAxMCkgLSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24gJiYgdGhpcy5wYXJlbnQuZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGxpdGVyYWxzLmFkZGVkUm93KS5sZW5ndGggPiAwICYmXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubmV3Um93UG9zaXRpb24gPT09ICdUb3AnICYmICF0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1Jvdykge1xuICAgICAgICAgICAgKytySW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yb3dDZWxsU2VsZWN0aW9uSGFuZGxlcihySW5kZXgsIHBhcnNlSW50KHRhcmdldC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYUNvbEluZGV4KSwgMTApIC0gMSk7XG4gICAgICAgIHRoaXMubW92ZUludG9VbmNoZWNrQ29sbGVjdGlvbihjbG9zZXN0KHRhcmdldCwgJy4nICsgbGl0ZXJhbHMucm93KSk7XG4gICAgICAgIHRoaXMuc2V0Q2hlY2tBbGxTdGF0ZSgpO1xuICAgICAgICB0aGlzLmlzTXVsdGlDdHJsUmVxdWVzdCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRyaWdnZXJDaGtDaGFuZ2VFdmVudChjaGVja0JveCwgY2hlY2tCb3gubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC5jb250YWlucygnZS1jaGVjaycpKTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUubW92ZUludG9VbmNoZWNrQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9PT0gJ0NoZWNrJyB8fCB0aGlzLnBhcmVudC5jaGVja0FsbFJvd3MgPT09ICdVbmNoZWNrJykge1xuICAgICAgICAgICAgdmFyIHJvd09iaiA9IHRoaXMuZ2V0Um93T2JqKHJvdyk7XG4gICAgICAgICAgICB2YXIgcEtleSA9IHJvd09iaiAmJiByb3dPYmouZGF0YSA/IHRoaXMuZ2V0UGtWYWx1ZSh0aGlzLnByaW1hcnlLZXksIHJvd09iai5kYXRhKSA6IG51bGw7XG4gICAgICAgICAgICBpZiAoIXBLZXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5jaGtBbGxDb2xsZWMuaW5kZXhPZihwS2V5KSA8IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoa0FsbENvbGxlYy5wdXNoKHBLZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGtBbGxDb2xsZWMuc3BsaWNlKHRoaXMuY2hrQWxsQ29sbGVjLmluZGV4T2YocEtleSksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnRyaWdnZXJDaGtDaGFuZ2VFdmVudCA9IGZ1bmN0aW9uIChjaGVja0JveCwgY2hlY2tTdGF0ZSkge1xuICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5jaGVja0JveENoYW5nZSwge1xuICAgICAgICAgICAgY2hlY2tlZDogY2hlY2tTdGF0ZSwgc2VsZWN0ZWRSb3dJbmRleGVzOiB0aGlzLnBhcmVudC5nZXRTZWxlY3RlZFJvd0luZGV4ZXMoKSxcbiAgICAgICAgICAgIHRhcmdldDogY2hlY2tCb3hcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQuaXNFZGl0KSB7XG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRUYXJnZXQgPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVNlbGVjdGVkUm93SW5kZXhlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb24gJiYgKHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8IHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSAmJlxuICAgICAgICAgICAgdGhpcy5pc1BhcnRpYWxTZWxlY3Rpb24gJiYgISh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSB8fCAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpXG4gICAgICAgICAgICAmJiB0aGlzLnBhcmVudC5kYXRhU291cmNlLnJlc3VsdCkpXG4gICAgICAgICAgICAmJiB0aGlzLnBhcmVudC5zZWxlY3Rpb25TZXR0aW5ncy5wZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuY2hlY2tBbGxSb3dzICE9PSAnVW5jaGVjaycpIHtcbiAgICAgICAgICAgICAgICB2YXIgcm93T2JqID0gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpLmZpbHRlcihmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5pc1NlbGVjdGFibGU7IH0pO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgcm93T2JqXzIgPSByb3dPYmo7IF9pIDwgcm93T2JqXzIubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByb3cgPSByb3dPYmpfMltfaV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLnB1c2gocm93LmluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb24gJiYgdGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgIXRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uICYmXG4gICAgICAgICAgICAodGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmlzUmVtb3RlKCkgfHwgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5kYXRhU291cmNlKVxuICAgICAgICAgICAgICAgICYmIHRoaXMucGFyZW50LmRhdGFTb3VyY2UucmVzdWx0KSlcbiAgICAgICAgICAgICYmICF0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24gJiYgdGhpcy5wYXJlbnQuY2hlY2tBbGxSb3dzID09PSAnQ2hlY2snKSB7XG4gICAgICAgICAgICB2YXIgcm93T2JqID0gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpLmZpbHRlcihmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5pc1NlbGVjdGFibGU7IH0pO1xuICAgICAgICAgICAgaWYgKHJvd09iai5sZW5ndGggIT09IHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgcm93T2JqXzMgPSByb3dPYmo7IF9hIDwgcm93T2JqXzMubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByb3cgPSByb3dPYmpfM1tfYV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkUm93SW5kZXhlcy5pbmRleE9mKHJvdy5pbmRleCkgPD0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLnB1c2gocm93LmluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS51cGRhdGVTZWxlY3RlZFJvd0luZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0NoZWNrQm94U2VsZWN0aW9uICYmICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZylcbiAgICAgICAgICAgICYmICEodGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmlzUmVtb3RlKCkgfHwgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5kYXRhU291cmNlKVxuICAgICAgICAgICAgICAgICYmIHRoaXMucGFyZW50LmRhdGFTb3VyY2UucmVzdWx0KSlcbiAgICAgICAgICAgICYmICF0aGlzLmlzUGFydGlhbFNlbGVjdGlvbikge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9PT0gJ0NoZWNrJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFMZW5ndGggPSB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoID8gdGhpcy5nZXREYXRhKClbJ3JlY29yZHMnXS5sZW5ndGggOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldERhdGEoKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZGF0YSA9IDA7IGRhdGEgPCBkYXRhTGVuZ3RoOyBkYXRhKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnBhcmVudC5jaGVja0FsbFJvd3MgPT09ICdVbmNoZWNrJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcm93ID0gdGhpcy5wYXJlbnQuZ2V0Um93QnlJbmRleChpbmRleCk7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ICYmIHJvdyAmJiByb3cuZ2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJykgPT09ICdmYWxzZScpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkVmFsID0gdGhpcy5zZWxlY3RlZFJvd0luZGV4ZXMuaW5kZXhPZihpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLnNwbGljZShzZWxlY3RlZFZhbCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmlzQWxsU2VsZWN0ZWQgPSBmdW5jdGlvbiAoY291bnQpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpXG4gICAgICAgICAgICB8fCAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpICYmIHRoaXMucGFyZW50LmRhdGFTb3VyY2UucmVzdWx0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QXZhaWxhYmxlU2VsZWN0ZWREYXRhKHRoaXMucGVyc2lzdFNlbGVjdGVkRGF0YSkubGVuZ3RoID09PSAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb25cbiAgICAgICAgICAgICAgICB8fCB0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyA/IHRoaXMucGFyZW50LnRvdGFsRGF0YVJlY29yZHNDb3VudCA6IHRoaXMudG90YWxSZWNvcmRzQ291bnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93UGFnaW5nICYmICF0aGlzLnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLnBhZ2VTaXplIDwgdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLnRvdGFsUmVjb3Jkc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5wYXJlbnQucGFydGlhbFNlbGVjdGVkUmVjb3JkcztcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcEtleSA9IHRoaXMuZ2V0UGtWYWx1ZSh0aGlzLnByaW1hcnlLZXksIGRhdGFbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3RlZFJvd1N0YXRlW1wiXCIgKyBwS2V5XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzU2VsZWN0QWxsUm93Q291bnQoY291bnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5nZXREYXRhKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiYgZGF0YVsncmVjb3JkcyddKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhWydyZWNvcmRzJ107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcEtleSA9IHRoaXMuZ2V0UGtWYWx1ZSh0aGlzLnByaW1hcnlLZXksIGRhdGFbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkUm93U3RhdGVbXCJcIiArIHBLZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuc29tZURhdGFTZWxlY3RlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSB8fCAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpXG4gICAgICAgICAgICAmJiB0aGlzLnBhcmVudC5kYXRhU291cmNlLnJlc3VsdCkpXG4gICAgICAgICAgICAmJiAodGhpcy5wYXJlbnQuc2VhcmNoU2V0dGluZ3Mua2V5Lmxlbmd0aCB8fCB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkpIHtcbiAgICAgICAgICAgIHZhciBmaWx0ZXJlZFNlYXJjaGVkU2VsZWN0ZWREYXRhID0gdGhpcy5nZXRBdmFpbGFibGVTZWxlY3RlZERhdGEodGhpcy5wZXJzaXN0U2VsZWN0ZWREYXRhKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsdGVyZWRTZWFyY2hlZFNlbGVjdGVkRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBwS2V5ID0gdGhpcy5nZXRQa1ZhbHVlKHRoaXMucHJpbWFyeUtleSwgZmlsdGVyZWRTZWFyY2hlZFNlbGVjdGVkRGF0YVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkUm93U3RhdGVbXCJcIiArIHBLZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLmlzUGFydGlhbFNlbGVjdGlvbiA/IHRoaXMuZ2V0QXZhaWxhYmxlU2VsZWN0ZWREYXRhKHRoaXMucGFyZW50LnBhcnRpYWxTZWxlY3RlZFJlY29yZHMpXG4gICAgICAgICAgICA6ICh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSB8fCAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmRhdGFTb3VyY2UpXG4gICAgICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5yZXN1bHQpKSA/IFtdIDogdGhpcy5nZXREYXRhKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHBLZXkgPSB0aGlzLmdldFBrVmFsdWUodGhpcy5wcmltYXJ5S2V5LCBkYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFJvd1N0YXRlW1wiXCIgKyBwS2V5XSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuc2V0Q2hlY2tBbGxTdGF0ZSA9IGZ1bmN0aW9uIChpbmRleCwgaXNJbnRlcmFjdGlvbikge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNDaGVja0JveFNlbGVjdGlvbiB8fCB0aGlzLnBhcmVudC5zZWxlY3Rpb25TZXR0aW5ncy5jaGVja2JveE1vZGUgPT09ICdSZXNldE9uUm93Q2xpY2snKSB7XG4gICAgICAgICAgICB2YXIgY2hlY2tUb1NlbGVjdEFsbCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGlzRmlsdGVyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBjaGVja2VkTGVuID0gT2JqZWN0LmtleXModGhpcy5zZWxlY3RlZFJvd1N0YXRlKS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtdHJlZWxpc3RncmlkJykgJiYgdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uICYmICF0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJlxuICAgICAgICAgICAgICAgICF0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSAmJiBBcnJheS5pc0FycmF5KHRoaXMucGFyZW50LmRhdGFTb3VyY2UpICYmXG4gICAgICAgICAgICAgICAgY2hlY2tlZExlbiA9PT0gdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5sZW5ndGggJiYgY2hlY2tlZExlbiA+IHRoaXMudG90YWxSZWNvcmRzQ291bnQpIHtcbiAgICAgICAgICAgICAgICBjaGVja2VkTGVuID0gdGhpcy50b3RhbFJlY29yZHNDb3VudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQuaXNQZXJzaXN0U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgY2hlY2tlZExlbiA9IHRoaXMuc2VsZWN0ZWRSb3dJbmRleGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50ID0gdGhpcy5nZXRDdXJyZW50QmF0Y2hSZWNvcmRDaGFuZ2VzKCkubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbiAmJiAhKCh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKSB8fFxuICAgICAgICAgICAgICAgICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuZGF0YVNvdXJjZSkgJiYgdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5yZXN1bHQpKSAmJlxuICAgICAgICAgICAgICAgIHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uKVxuICAgICAgICAgICAgICAgICYmICh0aGlzLnBhcmVudC5zZWFyY2hTZXR0aW5ncy5rZXkubGVuZ3RoIHx8IHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIGlzRmlsdGVyZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNoZWNrVG9TZWxlY3RBbGwgPSB0aGlzLmlzQWxsU2VsZWN0ZWQoY2hlY2tlZExlbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaW5wdXQgPSB0aGlzLmdldENoZWNrQWxsQm94KCk7XG4gICAgICAgICAgICBpZiAoaW5wdXQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3BhbkVsZSA9IGlucHV0Lm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhbc3BhbkVsZV0sIFsnZS1jaGVjaycsICdlLXN0b3AnLCAnZS11bmNoZWNrJ10pO1xuICAgICAgICAgICAgICAgIHNldENoZWNrZWQoaW5wdXQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBpbnB1dC5pbmRldGVybWluYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIGdldFJlY29yZCA9IHRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpID8gW10gOiB0aGlzLmdyaWRDdXJyZW50UmVjb3JkO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICYmIGdldFJlY29yZFsncmVjb3JkcyddKSB7XG4gICAgICAgICAgICAgICAgICAgIGdldFJlY29yZCA9IGdldFJlY29yZFsncmVjb3JkcyddO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50ID0gdGhpcy5jaGVja1ZpcnR1YWxDaGVja0JveCgpID8gZ2V0UmVjb3JkLmxlbmd0aCA6IHRoaXMudG90YWxSZWNvcmRzQ291bnQ7XG4gICAgICAgICAgICAgICAgaWYgKChjaGVja1RvU2VsZWN0QWxsICYmIGlzRmlsdGVyZWQgJiYgKHRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpIHx8XG4gICAgICAgICAgICAgICAgICAgICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuZGF0YVNvdXJjZSkgJiYgdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5yZXN1bHQpIHx8XG4gICAgICAgICAgICAgICAgICAgIGdldFJlY29yZC5sZW5ndGgpKSB8fCAoIWlzRmlsdGVyZWQgJiYgKChjaGVja2VkTGVuID09PSB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50ICYmIHRoaXMudG90YWxSZWNvcmRzQ291bnRcbiAgICAgICAgICAgICAgICAgICAgJiYgIXRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uICYmICghKHRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpXG4gICAgICAgICAgICAgICAgICAgIHx8ICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuZGF0YVNvdXJjZSkgJiYgdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5yZXN1bHQpKVxuICAgICAgICAgICAgICAgICAgICB8fCB0aGlzLnBhcmVudC5hbGxvd1BhZ2luZykpIHx8XG4gICAgICAgICAgICAgICAgICAgICghdGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgIXRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLmlzUGFydGlhbFNlbGVjdGlvbiAmJiAodGhpcy5pc1NlbGVjdEFsbFJvd0NvdW50KGNoZWNrZWRMZW4pXG4gICAgICAgICAgICAgICAgICAgICAgICB8fCAodGhpcy5pc0hkclNlbGVjdEFsbENsaWNrZWQgJiYgIXRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikpKVxuICAgICAgICAgICAgICAgICAgICB8fCAoKHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8IHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgIXRoaXMucGFyZW50LmFsbG93UGFnaW5nICYmICgoISh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNSZW1vdGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfHwgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5kYXRhU291cmNlKSAmJiB0aGlzLnBhcmVudC5kYXRhU291cmNlLnJlc3VsdCkpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRSZWNvcmQubGVuZ3RoICYmIGNoZWNrZWRMZW4gPT09IGdldFJlY29yZC5sZW5ndGgpIHx8ICgodGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmlzUmVtb3RlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8ICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuZGF0YVNvdXJjZSkgJiYgdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5yZXN1bHQpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uICYmICgoY2hlY2tlZExlbiA9PT0gdGhpcy5wYXJlbnQudG90YWxEYXRhUmVjb3Jkc0NvdW50KSB8fCAoKHRoaXMuXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdEFsbFJvd0NvdW50KGNoZWNrZWRMZW4pIHx8IGNoZWNrZWRMZW4gPT09IHRoaXMudG90YWxSZWNvcmRzQ291bnQpICYmICF0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24pKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLmlzUGFydGlhbFNlbGVjdGlvbiAmJiAodGhpcy5pc0hkclNlbGVjdEFsbENsaWNrZWQgfHwgdGhpcy5pc1NlbGVjdEFsbFJvd0NvdW50KGNoZWNrZWRMZW4pKSkpKVxuICAgICAgICAgICAgICAgICAgICB8fCAoY2hlY2tlZExlbiA9PT0gdGhpcy50b3RhbFJlY29yZHNDb3VudCAmJiB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50ICYmICF0aGlzLmlzUGFydGlhbFNlbGVjdGlvbiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMucGFyZW50LmFsbG93UGFnaW5nICYmICF0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiAhdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3MoW3NwYW5FbGVdLCBbJ2UtY2hlY2snXSk7XG4gICAgICAgICAgICAgICAgICAgIHNldENoZWNrZWQoaW5wdXQsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNJbnRlcmFjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRSZW5kZXJlcigpLnNldFNlbGVjdGlvbihudWxsLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5jaGVja0FsbFJvd3MgPSAnQ2hlY2snO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICgoKCF0aGlzLnNlbGVjdGVkUm93SW5kZXhlcy5sZW5ndGggJiYgKCF0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fFxuICAgICAgICAgICAgICAgICAgICAoIXRoaXMucGVyc2lzdFNlbGVjdGVkRGF0YS5sZW5ndGggJiYgIWlzRmlsdGVyZWQpIHx8IChpc0ZpbHRlcmVkICYmIHRoaXMuc29tZURhdGFTZWxlY3RlZCgpKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZExlbiA9PT0gMCAmJiB0aGlzLmdldEN1cnJlbnRCYXRjaFJlY29yZENoYW5nZXMoKS5sZW5ndGggPT09IDApICYmICF0aGlzLnBhcmVudC5hbGxvd1BhZ2luZykgfHxcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMucGFyZW50LmFsbG93UGFnaW5nICYmIChjaGVja2VkTGVuID09PSAwIHx8IChjaGVja2VkTGVuICYmIGlzRmlsdGVyZWQgJiYgdGhpcy5zb21lRGF0YVNlbGVjdGVkKCkpKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3MoW3NwYW5FbGVdLCBbJ2UtdW5jaGVjayddKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSW50ZXJhY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0UmVuZGVyZXIoKS5zZXRTZWxlY3Rpb24obnVsbCwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9ICdVbmNoZWNrJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZENsYXNzKFtzcGFuRWxlXSwgWydlLXN0b3AnXSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9ICdJbnRlcm1lZGlhdGUnO1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5pbmRldGVybWluYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNoZWNrZWRMZW4gPT09IDAgJiYgdGhpcy5nZXRDdXJyZW50QmF0Y2hSZWNvcmRDaGFuZ2VzKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZENsYXNzKFtzcGFuRWxlLnBhcmVudEVsZW1lbnRdLCBbJ2UtY2hlY2tib3gtZGlzYWJsZWQnXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhbc3BhbkVsZS5wYXJlbnRFbGVtZW50XSwgWydlLWNoZWNrYm94LWRpc2FibGVkJ10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1BhcnRpYWxTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvd0NvdW50ID0gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpLmZpbHRlcihmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5pc1NlbGVjdGFibGU7IH0pLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0NvdW50ID09PSAwICYmIHNwYW5FbGUucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1mcmFtZScpLmNsYXNzTGlzdC5jb250YWlucygnZS11bmNoZWNrJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZENsYXNzKFtzcGFuRWxlLnBhcmVudEVsZW1lbnRdLCBbJ2UtY2hlY2tib3gtZGlzYWJsZWQnXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhbc3BhbkVsZS5wYXJlbnRFbGVtZW50XSwgWydlLWNoZWNrYm94LWRpc2FibGVkJ10pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gfHwgdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpXG4gICAgICAgICAgICAgICAgICAgICYmICF0aGlzLnBhcmVudC5hbGxvd1BhZ2luZyAmJiAhKHRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpXG4gICAgICAgICAgICAgICAgICAgIHx8ICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuZGF0YVNvdXJjZSkgJiYgdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5yZXN1bHQpKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkUm93SW5kZXgoaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jaGVja1ZpcnR1YWxDaGVja0JveCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uICYmICEodGhpcy5wYXJlbnQuZ2V0RGF0YU1vZHVsZSgpLmlzUmVtb3RlKCkgfHwgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5kYXRhU291cmNlKVxuICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuZGF0YVNvdXJjZS5yZXN1bHQpKSAmJiB0aGlzLnBhcmVudC5pc0NoZWNrQm94U2VsZWN0aW9uICYmICF0aGlzLmlzUGFydGlhbFNlbGVjdGlvbjtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUudmlydHVhbENoZWNrQm94RGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLmdldERhdGEoKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiYgZGF0YVsncmVjb3JkcyddKSB7XG4gICAgICAgICAgICBkYXRhID0gZGF0YVsncmVjb3JkcyddO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5pc1NlbGVjdEFsbFJvd0NvdW50ID0gZnVuY3Rpb24gKGNvdW50KSB7XG4gICAgICAgIHZhciByb3dDb3VudCA9IDA7XG4gICAgICAgIHZhciByb3dPYmogPSB0aGlzLnBhcmVudC5nZXRSb3dzT2JqZWN0KCk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5zZWxlY3Rpb25TZXR0aW5ncy5wZXJzaXN0U2VsZWN0aW9uICYmICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZykpIHtcbiAgICAgICAgICAgIHZhciBkYXRhTGVuID0gKHRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpIHx8ICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuZGF0YVNvdXJjZSlcbiAgICAgICAgICAgICAgICAmJiB0aGlzLnBhcmVudC5kYXRhU291cmNlLnJlc3VsdCkpID9cbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC50b3RhbERhdGFSZWNvcmRzQ291bnQgOiB0aGlzLmdldERhdGEoKSAmJiB0aGlzLmdldERhdGEoKS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAoZGF0YUxlbiA9PT0gcm93T2JqLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJvd0NvdW50ID0gcm93T2JqLmZpbHRlcihmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5pc1NlbGVjdGFibGU7IH0pLmxlbmd0aDtcbiAgICAgICAgICAgICAgICByZXR1cm4gcm93Q291bnQgJiYgY291bnQgPT09IHJvd0NvdW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93UGFnaW5nICYmIHRoaXMucGFyZW50LnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlzYWJsZVNlbGVjdGVkUmVjb3Jkc0NvdW50ID0gdGhpcy5nZXRBdmFpbGFibGVTZWxlY3RlZERhdGEodGhpcy5wYXJlbnQuZGlzYWJsZVNlbGVjdGVkUmVjb3JkcykubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhciBwYXJ0aWFsU2VsZWN0ZWRSZWNvcmRzQ291bnQgPSB0aGlzLmdldEF2YWlsYWJsZVNlbGVjdGVkRGF0YSh0aGlzLnBhcmVudC5wYXJ0aWFsU2VsZWN0ZWRSZWNvcmRzKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkUm93Q291bnQgPSB0aGlzLmdldEF2YWlsYWJsZVNlbGVjdGVkRGF0YSh0aGlzLnBlcnNpc3RTZWxlY3RlZERhdGEpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICByb3dDb3VudCA9IGRpc2FibGVTZWxlY3RlZFJlY29yZHNDb3VudCArIHBhcnRpYWxTZWxlY3RlZFJlY29yZHNDb3VudDtcbiAgICAgICAgICAgICAgICByZXR1cm4gcm93Q291bnQgPT09IHRoaXMudG90YWxSZWNvcmRzQ291bnQgJiYgc2VsZWN0ZWRSb3dDb3VudCAhPT0gMCAmJiBzZWxlY3RlZFJvd0NvdW50ID09PSBwYXJ0aWFsU2VsZWN0ZWRSZWNvcmRzQ291bnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByb3dDb3VudCA9IHJvd09iai5maWx0ZXIoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUuaXNTZWxlY3RhYmxlOyB9KS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvd0NvdW50ICYmIGNvdW50ID09PSByb3dDb3VudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5rZXlEb3duSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIC8vIEJlbG93IGFyZSBrZXlDb2RlIGZvciBjb21tYW5kIGtleSBpbiBNQUMgT1MuIFNhZmFyaS9DaHJvbWUoOTEtTGVmdCBjb21tYW5kLCA5My1SaWdodCBDb21tYW5kKSwgT3BlcmEoMTcpLCBGaXJlRm94KDIyNClcbiAgICAgICAgaWYgKChCcm93c2VyLmluZm8ubmFtZSA9PT0gJ29wZXJhJyAmJiBlLmtleUNvZGUgPT09IDE3KSB8fCAoQnJvd3Nlci5pbmZvLm5hbWUgPT09ICdtb3ppbGxhJyAmJiBlLmtleUNvZGUgPT09IDIyNCkgfHxcbiAgICAgICAgICAgICgoKEJyb3dzZXIuaW5mby5uYW1lID09PSAnc2FmYXJpJykgfHwgKEJyb3dzZXIuaW5mby5uYW1lID09PSAnY2hyb21lJykpICYmIChlLmtleUNvZGUgPT09IDkxIHx8IGUua2V5Q29kZSA9PT0gOTMpKSkge1xuICAgICAgICAgICAgdGhpcy5jbWRLZXlQcmVzc2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGFyZ2V0SGVhZENlbGwgPSBwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLWhlYWRlcmNlbGwnKTtcbiAgICAgICAgdmFyIHRhcmdldFJvd0NlbGwgPSBwYXJlbnRzVW50aWwoZS50YXJnZXQsIGxpdGVyYWxzLnJvd0NlbGwpO1xuICAgICAgICB2YXIgaXNDaGVja0JveCA9IHRhcmdldEhlYWRDZWxsID8gdGFyZ2V0SGVhZENlbGwuY2hpbGRyZW5bMF0uY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWhlYWRlcmNoa2NlbGxkaXYnKSA6XG4gICAgICAgICAgICB0YXJnZXRSb3dDZWxsID8gdGFyZ2V0Um93Q2VsbC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZ3JpZGNoa2JveCcpIDogZmFsc2U7XG4gICAgICAgIGlmIChpc0NoZWNrQm94ICYmICF0aGlzLnBhcmVudC5hbGxvd0tleWJvYXJkICYmIGUua2V5Q29kZSA9PT0gMzIpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5rZXlVcEhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoKEJyb3dzZXIuaW5mby5uYW1lID09PSAnb3BlcmEnICYmIGUua2V5Q29kZSA9PT0gMTcpIHx8IChCcm93c2VyLmluZm8ubmFtZSA9PT0gJ21vemlsbGEnICYmIGUua2V5Q29kZSA9PT0gMjI0KSB8fFxuICAgICAgICAgICAgKCgoQnJvd3Nlci5pbmZvLm5hbWUgPT09ICdzYWZhcmknKSB8fCAoQnJvd3Nlci5pbmZvLm5hbWUgPT09ICdjaHJvbWUnKSkgJiYgKGUua2V5Q29kZSA9PT0gOTEgfHwgZS5rZXlDb2RlID09PSA5MykpKSB7XG4gICAgICAgICAgICB0aGlzLmNtZEtleVByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgIHRoaXMuYWN0dWFsVGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICBpZiAoIXRoaXMuaXNBdXRvRmlsbFNlbCAmJiAhZS5jdHJsS2V5ICYmICFlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0QUZDZWxsID0gdGhpcy5lbmRBRkNlbGwgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMuZGVTZWxlY3RlZERhdGEgPSBpdGVyYXRlRXh0ZW5kKHRoaXMucGVyc2lzdFNlbGVjdGVkRGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmVudHNVbnRpbCh0YXJnZXQsIGxpdGVyYWxzLnJvdykgfHwgcGFyZW50c1VudGlsKHRhcmdldCwgJ2UtaGVhZGVyY2hrY2VsbGRpdicpIHx8XG4gICAgICAgICAgICAodGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5hbGxvd0NvbHVtblNlbGVjdGlvbiAmJiB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWhlYWRlcmNlbGwnKSkpIHtcbiAgICAgICAgICAgIHRoaXMuaXNJbnRlcmFjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNtZEtleVByZXNzZWQgPSBlLm1ldGFLZXk7XG4gICAgICAgIHRoaXMuaXNNdWx0aUN0cmxSZXF1ZXN0ID0gZS5jdHJsS2V5IHx8IHRoaXMuZW5hYmxlU2VsZWN0TXVsdGlUb3VjaCB8fFxuICAgICAgICAgICAgKHRoaXMuaXNNYWNPUyAmJiB0aGlzLmNtZEtleVByZXNzZWQpO1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50LmFsbG93S2V5Ym9hcmQpIHtcbiAgICAgICAgICAgIHRoaXMuaXNNdWx0aVNoaWZ0UmVxdWVzdCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5pc011bHRpQ3RybFJlcXVlc3QgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaXNNdWx0aVNoaWZ0UmVxdWVzdCA9IGUuc2hpZnRLZXk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc011bHRpQ3RybFJlcXVlc3RDZWxsID0gdGhpcy5pc011bHRpQ3RybFJlcXVlc3Q7XG4gICAgICAgIHRoaXMucG9wVXBDbGlja0hhbmRsZXIoZSk7XG4gICAgICAgIHZhciBjaGtTZWxlY3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcmV2ZW50Rm9jdXMgPSB0cnVlO1xuICAgICAgICB2YXIgY2hlY2tCb3g7XG4gICAgICAgIHZhciBjaGVja1dyYXAgPSBwYXJlbnRzVW50aWwodGFyZ2V0LCAnZS1jaGVja2JveC13cmFwcGVyJyk7XG4gICAgICAgIHRoaXMuY2hlY2tTZWxlY3RBbGxDbGlja2VkID0gY2hlY2tXcmFwICYmIGNoZWNrV3JhcC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlLWNoZWNrc2VsZWN0YWxsJykgfHxcbiAgICAgICAgICAgICh0aGlzLnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24gJiYgcGFyZW50c1VudGlsKHRhcmdldCwgbGl0ZXJhbHMucm93KSkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24gJiYgdGhpcy5pc1BhcnRpYWxTZWxlY3Rpb24gJiYgcGFyZW50c1VudGlsKHRhcmdldCwgJ2UtaGVhZGVyY2hrY2VsbGRpdicpXG4gICAgICAgICAgICAmJiAhdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5lLWNoZWNrYm94LWRpc2FibGVkJykpIHtcbiAgICAgICAgICAgIHRoaXMuaXNIZHJTZWxlY3RBbGxDbGlja2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hlY2tXcmFwICYmIGNoZWNrV3JhcC5xdWVyeVNlbGVjdG9yQWxsKCcuZS1jaGVja3NlbGVjdCwuZS1jaGVja3NlbGVjdGFsbCcpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNoZWNrQm94ID0gY2hlY2tXcmFwLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXScpO1xuICAgICAgICAgICAgY2hrU2VsZWN0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRyYXdCb3JkZXJzKCk7XG4gICAgICAgIHRoaXMudXBkYXRlQXV0b0ZpbGxQb3NpdGlvbigpO1xuICAgICAgICB0YXJnZXQgPSBwYXJlbnRzVW50aWwodGFyZ2V0LCBsaXRlcmFscy5yb3dDZWxsKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzUmVhY3QgJiYgKHRhcmdldCAmJiAhdGFyZ2V0LnBhcmVudEVsZW1lbnQgJiYgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1yb3djZWxsJykpKSB7XG4gICAgICAgICAgICB0YXJnZXQgPSB0aGlzLnBhcmVudC5nZXRDZWxsRnJvbUluZGV4KHBhcnNlSW50KHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2luZGV4JyksIDEwKSwgcGFyc2VJbnQodGFyZ2V0LmdldEF0dHJpYnV0ZSgnYXJpYS1jb2xpbmRleCcpLCAxMCkgLSAxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc1Jvd0RyYWdTZWxlY3RlZCAmJiBpc051bGxPclVuZGVmaW5lZCh0YXJnZXQpICYmIHRoaXMucGFyZW50LmFsbG93Um93RHJhZ0FuZERyb3AgJiZcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MucGVyc2lzdFNlbGVjdGlvbiAmJiB0aGlzLmNoZWNrU2VsZWN0QWxsQ2xpY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5pc1Jvd0RyYWdTZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICgoKHRhcmdldCAmJiB0YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMucm93KSAmJiAhdGhpcy5wYXJlbnQuc2VsZWN0aW9uU2V0dGluZ3MuY2hlY2tib3hPbmx5KSB8fCBjaGtTZWxlY3QpXG4gICAgICAgICAgICAmJiAhdGhpcy5pc1Jvd0RyYWdTZWxlY3RlZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzTXVsdGlDdHJsUmVxdWVzdCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY2hlY2tCb3gpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkVGFyZ2V0ID0gY2hlY2tCb3g7XG4gICAgICAgICAgICAgICAgaWYgKGNoZWNrQm94LmNsYXNzTGlzdC5jb250YWlucygnZS1jaGVja3NlbGVjdGFsbCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tTZWxlY3RBbGwoY2hlY2tCb3gpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja1NlbGVjdChjaGVja0JveCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHJJbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgckluZGV4ID0gcGFyc2VJbnQodGFyZ2V0LnBhcmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbiAmJiAhdGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3dcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGxpdGVyYWxzLmFkZGVkUm93KS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICsrckluZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubVVQVGFyZ2V0IHx8ICF0aGlzLm1VUFRhcmdldC5pc0VxdWFsTm9kZSh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm93Q2VsbFNlbGVjdGlvbkhhbmRsZXIockluZGV4LCBwYXJzZUludCh0YXJnZXQuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNDaGVja0JveFNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmVJbnRvVW5jaGVja0NvbGxlY3Rpb24oY2xvc2VzdCh0YXJnZXQsICcuJyArIGxpdGVyYWxzLnJvdykpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldENoZWNrQWxsU3RhdGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb24gJiYgQnJvd3Nlci5pc0RldmljZSAmJiAhdGhpcy5pc1NpbmdsZVNlbCgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93UG9wdXAoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWhlYWRlcmNlbGwnKSAmJlxuICAgICAgICAgICAgIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1zdGFja2VkaGVhZGVyY2VsbCcpKSB7XG4gICAgICAgICAgICB2YXIgdWlkID0gZS50YXJnZXQucXVlcnlTZWxlY3RvcignLmUtaGVhZGVyY2VsbGRpdicpLmdldEF0dHJpYnV0ZSgnZS1tYXBwaW5ndWlkJyk7XG4gICAgICAgICAgICB0aGlzLmhlYWRlclNlbGVjdGlvbkhhbmRsZXIodGhpcy5wYXJlbnQuZ2V0Q29sdW1uSW5kZXhCeVVpZCh1aWQpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzTXVsdGlDdHJsUmVxdWVzdCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzTXVsdGlDdHJsUmVxdWVzdENlbGwgPSB0aGlzLmlzTXVsdGlDdHJsUmVxdWVzdDtcbiAgICAgICAgdGhpcy5pc011bHRpU2hpZnRSZXF1ZXN0ID0gZmFsc2U7XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChjbG9zZXN0KGUudGFyZ2V0LCAnLmUtdW5ib3VuZGNlbGwnKSkpIHtcbiAgICAgICAgICAgIHRoaXMucHJldmVudEZvY3VzID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUucG9wVXBDbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgIGlmIChjbG9zZXN0KHRhcmdldCwgJy5lLWhlYWRlcmNlbGwnKSB8fCBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMucm93Q2VsbCkgfHxcbiAgICAgICAgICAgIGNsb3Nlc3QodGFyZ2V0LCAnLmUtZ3JpZHBvcHVwJykpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJvd3NlbGVjdCcpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXNwYW5jbGlja2VkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2Utc3BhbmNsaWNrZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmFibGVTZWxlY3RNdWx0aVRvdWNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdlLXNwYW5jbGlja2VkJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlU2VsZWN0TXVsdGlUb3VjaCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWdyaWRwb3B1cCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1ncmlkcG9wdXAnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnNob3dQb3B1cCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5lbmFibGVTaW1wbGVNdWx0aVJvd1NlbGVjdGlvbikge1xuICAgICAgICAgICAgc2V0Q3NzSW5HcmlkUG9wVXAodGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1ncmlkcG9wdXAnKSwgZSwgJ2Utcm93c2VsZWN0IGUtaWNvbnMgZS1pY29uLXJvd3NlbGVjdCcgK1xuICAgICAgICAgICAgICAgICghdGhpcy5pc1NpbmdsZVNlbCgpICYmICh0aGlzLnNlbGVjdGVkUmVjb3Jkcy5sZW5ndGggPiAxXG4gICAgICAgICAgICAgICAgICAgIHx8IHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcy5sZW5ndGggPiAxKSA/ICcgZS1zcGFuY2xpY2tlZCcgOiAnJykpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnJvd0NlbGxTZWxlY3Rpb25IYW5kbGVyID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjZWxsSW5kZXgpIHtcbiAgICAgICAgaWYgKCghdGhpcy5pc011bHRpQ3RybFJlcXVlc3QgJiYgIXRoaXMuaXNNdWx0aVNoaWZ0UmVxdWVzdCkgfHwgdGhpcy5pc1NpbmdsZVNlbCgpKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNEcmFnZ2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSb3cocm93SW5kZXgsIHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MuZW5hYmxlVG9nZ2xlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbCh7IHJvd0luZGV4OiByb3dJbmRleCwgY2VsbEluZGV4OiBjZWxsSW5kZXggfSwgdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5lbmFibGVUb2dnbGUpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUF1dG9GaWxsUG9zaXRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZHJhd0JvcmRlcnMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmlzTXVsdGlTaGlmdFJlcXVlc3QpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0NoZWNrQm94U2VsZWN0aW9uIHx8ICghdGhpcy5wYXJlbnQuaXNDaGVja0JveFNlbGVjdGlvbiAmJlxuICAgICAgICAgICAgICAgICFjbG9zZXN0KHRoaXMudGFyZ2V0LCAnLicgKyBsaXRlcmFscy5yb3dDZWxsKS5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMuZ3JpZENoa0JveCkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSb3dzQnlSYW5nZShpc1VuZGVmaW5lZCh0aGlzLnByZXZSb3dJbmRleCkgPyByb3dJbmRleCA6IHRoaXMucHJldlJvd0luZGV4LCByb3dJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFJvd3NUb1NlbGVjdGlvbihbcm93SW5kZXhdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbHNCeVJhbmdlKGlzVW5kZWZpbmVkKHRoaXMucHJldkNJZHhzKSA/IHsgcm93SW5kZXg6IHJvd0luZGV4LCBjZWxsSW5kZXg6IGNlbGxJbmRleCB9IDogdGhpcy5wcmV2Q0lkeHMsIHsgcm93SW5kZXg6IHJvd0luZGV4LCBjZWxsSW5kZXg6IGNlbGxJbmRleCB9KTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQXV0b0ZpbGxQb3NpdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5kcmF3Qm9yZGVycygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hZGRSb3dzVG9TZWxlY3Rpb24oW3Jvd0luZGV4XSk7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5tb2RlID09PSAnQm90aCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hlY2tib3hDb2x1bW4gPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCkuZmluZChmdW5jdGlvbiAoY29sKSB7IHJldHVybiBjb2wudHlwZSA9PT0gJ2NoZWNrYm94JzsgfSk7XG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrYm94Q29sdW1uSW5kZXhDaGVjayA9IGNoZWNrYm94Q29sdW1uICYmIGNoZWNrYm94Q29sdW1uLmluZGV4ICE9PSBjZWxsSW5kZXg7XG4gICAgICAgICAgICAgICAgaWYgKGNoZWNrYm94Q29sdW1uSW5kZXhDaGVjayAmJiAhdGhpcy5pc011bHRpQ3RybFJlcXVlc3RDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbCh7IHJvd0luZGV4OiByb3dJbmRleCwgY2VsbEluZGV4OiBjZWxsSW5kZXggfSwgdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5lbmFibGVUb2dnbGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICghY2hlY2tib3hDb2x1bW4gfHwgY2hlY2tib3hDb2x1bW5JbmRleENoZWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2VsbHNUb1NlbGVjdGlvbihbeyByb3dJbmRleDogcm93SW5kZXgsIGNlbGxJbmRleDogY2VsbEluZGV4IH1dKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZENlbGxzVG9TZWxlY3Rpb24oW3sgcm93SW5kZXg6IHJvd0luZGV4LCBjZWxsSW5kZXg6IGNlbGxJbmRleCB9XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNob3dIaWRlQm9yZGVycygnbm9uZScpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNEcmFnZ2VkID0gZmFsc2U7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLm9uQ2VsbEZvY3VzZWQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cyAmJiBlLmNvbnRhaW5lci5pc0hlYWRlciAmJiBlLmJ5S2V5KSB7XG4gICAgICAgICAgICBpZiAoZS5rZXlBcmdzLmFjdGlvbiA9PT0gJ3VwQXJyb3cnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93RmlsdGVyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGUuaXNKdW1wID0gZS5lbGVtZW50LnRhZ05hbWUgPT09ICdJTlBVVCcgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlLmlzSnVtcCA9IGUuZWxlbWVudC50YWdOYW1lID09PSAnVEgnID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChlLmtleUFyZ3MuYWN0aW9uID09PSAnZG93bkFycm93Jykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcklkeCA9IE51bWJlcihlLmVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSkgLSAxO1xuICAgICAgICAgICAgICAgICAgICBlLmlzSnVtcCA9IHJJZHggPT09IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXlBcmdzLmFjdGlvbiA9PT0gJ2N0cmxIb21lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5pc0p1bXAgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBjbGVhciA9ICgoZS5jb250YWluZXIuaXNIZWFkZXIgJiYgZS5pc0p1bXApIHx8XG4gICAgICAgICAgICAoZS5jb250YWluZXIuaXNDb250ZW50ICYmICFlLmNvbnRhaW5lci5pc1NlbGVjdGFibGUpKSAmJiAhKGUuYnlLZXkgJiYgZS5rZXlBcmdzLmFjdGlvbiA9PT0gJ3NwYWNlJylcbiAgICAgICAgICAgICYmICEoZS5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1kZXRhaWxyb3dleHBhbmQnKSB8fCBlLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWRldGFpbHJvd2NvbGxhcHNlJykpO1xuICAgICAgICB2YXIgaGVhZGVyQWN0aW9uID0gKGUuY29udGFpbmVyLmlzSGVhZGVyICYmIGUuZWxlbWVudC50YWdOYW1lICE9PSAnVEQnICYmICFjbG9zZXN0KGUuZWxlbWVudCwgJy4nICsgbGl0ZXJhbHMucm93Q2VsbCkpXG4gICAgICAgICAgICAmJiAhKGUuYnlLZXkgJiYgZS5rZXlBcmdzLmFjdGlvbiA9PT0gJ3NwYWNlJyk7XG4gICAgICAgIGlmICghZS5ieUtleSB8fCBjbGVhcikge1xuICAgICAgICAgICAgaWYgKGNsZWFyICYmICEodGhpcy5wYXJlbnQuaXNDaGVja0JveFNlbGVjdGlvbiB8fCAodGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5wZXJzaXN0U2VsZWN0aW9uICYmIChlLnBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtcmVjb3JkcGx1c2V4cGFuZCcpIHx8XG4gICAgICAgICAgICAgICAgZS5wYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJlY29yZHBsdXNjb2xsYXBzZScpIHx8IGUucGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1ncm91cGNhcHRpb24nKSkpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX2EgPSBlLmNvbnRhaW5lci5pc0NvbnRlbnQgPyBlLmNvbnRhaW5lci5pbmRleGVzIDogZS5pbmRleGVzLCByb3dJbmRleCA9IF9hWzBdLCBjZWxsSW5kZXggPSBfYVsxXTtcbiAgICAgICAgdmFyIHByZXYgPSB0aGlzLmZvY3VzLmdldFByZXZJbmRleGVzKCk7XG4gICAgICAgIGlmIChlLmVsZW1lbnQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1yb3djZWxsZHJhZycpIHx8IGUuZWxlbWVudC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWR0ZGlhZ29uYWxyaWdodCcpXG4gICAgICAgICAgICB8fCBlLmVsZW1lbnQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1kdGRpYWdvbmFsZG93bicpKSB7XG4gICAgICAgICAgICBwcmV2LmNlbGxJbmRleCA9IHByZXYuY2VsbEluZGV4IC0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cykge1xuICAgICAgICAgICAgaWYgKGUuY29udGFpbmVyLmlzSGVhZGVyICYmIChlLmVsZW1lbnQudGFnTmFtZSA9PT0gJ1REJyB8fCBjbG9zZXN0KGUuZWxlbWVudCwgJy4nICsgbGl0ZXJhbHMucm93Q2VsbCkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhkckxlbmd0aCA9IHRoaXMucGFyZW50LmdldEhlYWRlclRhYmxlKCkucXVlcnlTZWxlY3RvcigndGhlYWQnKS5jaGlsZEVsZW1lbnRDb3VudDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cgJiYgdGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm5ld1Jvd1Bvc2l0aW9uID09PSAnVG9wJyAmJlxuICAgICAgICAgICAgICAgICAgICBlLmtleUFyZ3MuYWN0aW9uID09PSAndXBBcnJvdycpIHtcbiAgICAgICAgICAgICAgICAgICAgaGRyTGVuZ3RoKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJvd0luZGV4IC09IGhkckxlbmd0aDtcbiAgICAgICAgICAgICAgICBwcmV2LnJvd0luZGV4ID0gIWlzTnVsbE9yVW5kZWZpbmVkKHByZXYucm93SW5kZXgpID8gcHJldi5yb3dJbmRleCAtIGhkckxlbmd0aCA6IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByb3dJbmRleCArPSB0aGlzLnBhcmVudC5mcm96ZW5Sb3dzO1xuICAgICAgICAgICAgICAgIHByZXYucm93SW5kZXggPSBwcmV2LnJvd0luZGV4ID09PSAwIHx8ICFpc051bGxPclVuZGVmaW5lZChwcmV2LnJvd0luZGV4KSA/IHByZXYucm93SW5kZXggKyB0aGlzLnBhcmVudC5mcm96ZW5Sb3dzIDogbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgJiYgdGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZSkge1xuICAgICAgICAgICAgcm93SW5kZXggPSBwYXJzZUludChlLmVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2FyaWEtcm93aW5kZXgnKSwgMTApIC0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKGhlYWRlckFjdGlvbiB8fCAoWydjdHJsUGx1c0EnLCAnZXNjYXBlJ10uaW5kZXhPZihlLmtleUFyZ3MuYWN0aW9uKSA9PT0gLTEgJiZcbiAgICAgICAgICAgIGUua2V5QXJncy5hY3Rpb24gIT09ICdzcGFjZScgJiYgcm93SW5kZXggPT09IHByZXYucm93SW5kZXggJiYgY2VsbEluZGV4ID09PSBwcmV2LmNlbGxJbmRleCkpICYmXG4gICAgICAgICAgICAhdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5hbGxvd0NvbHVtblNlbGVjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbikge1xuICAgICAgICAgICAgcm93SW5kZXggPSBwYXJzZUludChlLmVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2FyaWEtcm93aW5kZXgnKSwgMTApIC0gMTtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgIXRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC50b3RhbERhdGFSZWNvcmRzQ291bnQgPj0gMSkge1xuICAgICAgICAgICAgICAgIGlmIChlLmtleUFyZ3MuYWN0aW9uID09PSAnY3RybEhvbWUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuaXNGb2N1c0ZpcnN0Q2VsbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGUua2V5QXJncy5hY3Rpb24gPT09ICdjdHJsRW5kJykge1xuICAgICAgICAgICAgICAgICAgICByb3dJbmRleCA9IHRoaXMucGFyZW50LnRvdGFsRGF0YVJlY29yZHNDb3VudCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNGb2N1c0xhc3RDZWxsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5uZXdSb3dQb3NpdGlvbiA9PT0gJ1RvcCcgJiZcbiAgICAgICAgICAgICghdGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgIXRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSAmJiBlLmtleUFyZ3MuYWN0aW9uID09PSAnZG93bkFycm93Jykge1xuICAgICAgICAgICAgcm93SW5kZXgtLTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByZXZlbnRGb2N1cyA9IHRydWU7XG4gICAgICAgIHZhciBjb2x1bW5JbmRleCA9IHRoaXMuZ2V0S2V5Q29sSW5kZXgoZSk7XG4gICAgICAgIGlmICh0aGlzLm5lZWRDb2x1bW5TZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIGNlbGxJbmRleCA9IGNvbHVtbkluZGV4O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1ncmlkY2VsbC1yZWFkJykgJiYgKGUua2V5QXJncy5hY3Rpb24gPT09ICd0YWInIHx8IGUua2V5QXJncy5hY3Rpb24gPT09ICdzaGlmdFRhYidcbiAgICAgICAgICAgIHx8IGUua2V5QXJncy5hY3Rpb24gPT09ICdyaWdodEFycm93JyB8fCBlLmtleUFyZ3MuYWN0aW9uID09PSAnbGVmdEFycm93JykpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXRMYWJlbCA9IHRoaXMudGFyZ2V0LmdldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcpO1xuICAgICAgICAgICAgdGFyZ2V0TGFiZWwgPSB0aGlzLnRhcmdldC5pbm5lckhUTUwgKyAnIGNvbHVtbiBoZWFkZXIgJyArIHRoaXMucGFyZW50LmdldENvbHVtbkJ5SW5kZXgoY2VsbEluZGV4KS5maWVsZDtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHRhcmdldExhYmVsKTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGUua2V5QXJncy5hY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2Rvd25BcnJvdyc6XG4gICAgICAgICAgICBjYXNlICd1cEFycm93JzpcbiAgICAgICAgICAgIGNhc2UgJ2VudGVyJzpcbiAgICAgICAgICAgIGNhc2UgJ3NoaWZ0RW50ZXInOlxuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gZS5lbGVtZW50O1xuICAgICAgICAgICAgICAgIHRoaXMuaXNLZXlBY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlEb3duVXBLZXkocm93SW5kZXgsIGNlbGxJbmRleCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyaWdodEFycm93JzpcbiAgICAgICAgICAgIGNhc2UgJ2xlZnRBcnJvdyc6XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseVJpZ2h0TGVmdEtleShyb3dJbmRleCwgY2VsbEluZGV4KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3NoaWZ0RG93bic6XG4gICAgICAgICAgICBjYXNlICdzaGlmdFVwJzpcbiAgICAgICAgICAgICAgICB0aGlzLnNoaWZ0RG93bktleShyb3dJbmRleCwgY2VsbEluZGV4KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3NoaWZ0TGVmdCc6XG4gICAgICAgICAgICBjYXNlICdzaGlmdFJpZ2h0JzpcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGx5U2hpZnRMZWZ0UmlnaHRLZXkocm93SW5kZXgsIGNlbGxJbmRleCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdob21lJzpcbiAgICAgICAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgICAgICAgICAgY2VsbEluZGV4ID0gZS5rZXlBcmdzLmFjdGlvbiA9PT0gJ2VuZCcgPyB0aGlzLmdldExhc3RDb2xJbmRleChyb3dJbmRleCkgOiAwO1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlIb21lRW5kS2V5KHJvd0luZGV4LCBjZWxsSW5kZXgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnY3RybEhvbWUnOlxuICAgICAgICAgICAgY2FzZSAnY3RybEVuZCc6XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseUN0cmxIb21lRW5kS2V5KHJvd0luZGV4LCBjZWxsSW5kZXgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZXNjYXBlJzpcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNsaXBib2FyZE1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubmF2aWdhdG9yWydjbGlwYm9hcmQnXS53cml0ZVRleHQoJycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2N0cmxQbHVzQSc6XG4gICAgICAgICAgICAgICAgdGhpcy5jdHJsUGx1c0EoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3NwYWNlJzpcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGx5U3BhY2VTZWxlY3Rpb24oZS5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3RhYic6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5hbGxvd05leHRSb3dFZGl0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93KHJvd0luZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZWVkQ29sdW1uU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJldmVudEZvY3VzID0gZmFsc2U7XG4gICAgICAgIHRoaXMucG9zaXRpb25Cb3JkZXJzKCk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgdGhpcy5zaG93SGlkZUJvcmRlcnMoJ25vbmUnLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaEZyb3plbkJvcmRlcnMoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZUF1dG9GaWxsUG9zaXRpb24oKTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZ2V0S2V5Q29sSW5kZXggPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdWlkO1xuICAgICAgICB2YXIgaW5kZXggPSBudWxsO1xuICAgICAgICB2YXIgc3RhY2tlZEhlYWRlciA9IGUuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1zdGFja2VkaGVhZGVyY2VsbGRpdicpO1xuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5hbGxvd0NvbHVtblNlbGVjdGlvbiAmJiBwYXJlbnRzVW50aWwoZS5lbGVtZW50LCAnZS1jb2x1bW5oZWFkZXInKSkge1xuICAgICAgICAgICAgdGhpcy5uZWVkQ29sdW1uU2VsZWN0aW9uID0gZS5jb250YWluZXIuaXNIZWFkZXIgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoc3RhY2tlZEhlYWRlcikge1xuICAgICAgICAgICAgICAgIGlmIChlLmtleUFyZ3MuYWN0aW9uID09PSAncmlnaHRBcnJvdycgfHwgZS5rZXlBcmdzLmFjdGlvbiA9PT0gJ2xlZnRBcnJvdycpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB1aWQgPSBzdGFja2VkSGVhZGVyLmdldEF0dHJpYnV0ZSgnZS1tYXBwaW5ndWlkJyk7XG4gICAgICAgICAgICAgICAgdmFyIGlubmVyQ29sdW1uID0gdGhpcy5nZXRzdGFja2VkQ29sdW1ucyh0aGlzLnBhcmVudC5nZXRDb2x1bW5CeVVpZCh1aWQpLmNvbHVtbnMpO1xuICAgICAgICAgICAgICAgIHZhciBsYXN0SW5kZXggPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5JbmRleEJ5VWlkKGlubmVyQ29sdW1uW2lubmVyQ29sdW1uLmxlbmd0aCAtIDFdLnVpZCk7XG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0SW5kZXggPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5JbmRleEJ5VWlkKGlubmVyQ29sdW1uWzBdLnVpZCk7XG4gICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLnByZXZDb2xJbmRleCA+PSBsYXN0SW5kZXggPyBmaXJzdEluZGV4IDogbGFzdEluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5JbmRleEJ5VWlkKGUuZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAucXVlcnlTZWxlY3RvcignLmUtaGVhZGVyY2VsbGRpdicpLmdldEF0dHJpYnV0ZSgnZS1tYXBwaW5ndWlkJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFwcGx5IGN0cmwgKyBBIGtleSBzZWxlY3Rpb25cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmN0cmxQbHVzQSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNSb3dUeXBlKCkgJiYgIXRoaXMuaXNTaW5nbGVTZWwoKSkge1xuICAgICAgICAgICAgdmFyIHJvd09iaiA9IHRoaXMucGFyZW50LmdldFJvd3NPYmplY3QoKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93c0J5UmFuZ2Uocm93T2JqWzBdLmluZGV4LCByb3dPYmpbcm93T2JqLmxlbmd0aCAtIDFdLmluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc0NlbGxUeXBlKCkgJiYgIXRoaXMuaXNTaW5nbGVTZWwoKSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RDZWxsc0J5UmFuZ2UoeyByb3dJbmRleDogMCwgY2VsbEluZGV4OiAwIH0sIHsgcm93SW5kZXg6IHRoaXMucGFyZW50LmdldFJvd3MoKS5sZW5ndGggLSAxLCBjZWxsSW5kZXg6IHRoaXMucGFyZW50LmdldENvbHVtbnMoKS5sZW5ndGggLSAxIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmFwcGx5U3BhY2VTZWxlY3Rpb24gPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNoZWNrc2VsZWN0YWxsJykpIHtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZFRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tTZWxlY3RBbGwodGhpcy5jaGVja2VkVGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNoZWNrc2VsZWN0JykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRUYXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja1NlbGVjdCh0aGlzLmNoZWNrZWRUYXJnZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmFwcGx5RG93blVwS2V5ID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjZWxsSW5kZXgpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb24gJiYgdGhpcy5wYXJlbnQuY2hlY2tBbGxSb3dzID09PSAnQ2hlY2snICYmICF0aGlzLnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24gJiZcbiAgICAgICAgICAgICF0aGlzLnNlbGVjdGlvblNldHRpbmdzLmNoZWNrYm94T25seSkge1xuICAgICAgICAgICAgdGhpcy5jaGVja1NlbGVjdEFsbEFjdGlvbihmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRUYXJnZXQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzUm93VHlwZSgpICYmICF0aGlzLnNlbGVjdGlvblNldHRpbmdzLmNoZWNrYm94T25seSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFJvdyhyb3dJbmRleCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseVVwRG93bihnT2JqLnNlbGVjdGVkUm93SW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSb3cocm93SW5kZXgsIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlVcERvd24oZ09iai5zZWxlY3RlZFJvd0luZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc0NlbGxUeXBlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbCh7IHJvd0luZGV4OiByb3dJbmRleCwgY2VsbEluZGV4OiBjZWxsSW5kZXggfSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MuYWxsb3dDb2x1bW5TZWxlY3Rpb24gJiYgdGhpcy5uZWVkQ29sdW1uU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdENvbHVtbihjZWxsSW5kZXgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmFwcGx5VXBEb3duID0gZnVuY3Rpb24gKHJvd0luZGV4KSB7XG4gICAgICAgIGlmIChyb3dJbmRleCA8IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMudGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IHRoaXMucGFyZW50LmdldFJvd3MoKVswXS5jaGlsZHJlblt0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoIHx8IDBdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjSW5kZXggPSBwYXJzZUludCh0aGlzLnRhcmdldC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYUNvbEluZGV4KSwgMTApIC0gMTtcbiAgICAgICAgdmFyIHJvdyA9IHRoaXMuY29udGVudFJlbmRlcmVyLmdldFJvd0J5SW5kZXgocm93SW5kZXgpO1xuICAgICAgICBpZiAocm93KSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IHJvdy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGxpdGVyYWxzLnJvd0NlbGwpW3BhcnNlSW50KGNJbmRleC50b1N0cmluZygpLCAxMCldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWRkQXR0cmlidXRlKHRoaXMudGFyZ2V0KTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWdyaWRjZWxsLXJlYWQnKSkge1xuICAgICAgICAgICAgdmFyIHRhcmdldExhYmVsID0gdGhpcy50YXJnZXQuZ2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJyk7XG4gICAgICAgICAgICB0YXJnZXRMYWJlbCA9IHRoaXMudGFyZ2V0LmlubmVySFRNTDtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHRhcmdldExhYmVsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5hcHBseVJpZ2h0TGVmdEtleSA9IGZ1bmN0aW9uIChyb3dJbmRleCwgY2VsbEluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvblNldHRpbmdzLmFsbG93Q29sdW1uU2VsZWN0aW9uICYmIHRoaXMubmVlZENvbHVtblNlbGVjdGlvbikge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RDb2x1bW4oY2VsbEluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmlzQ2VsbFR5cGUoKSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RDZWxsKHsgcm93SW5kZXg6IHJvd0luZGV4LCBjZWxsSW5kZXg6IGNlbGxJbmRleCB9LCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQXR0cmlidXRlKHRoaXMudGFyZ2V0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5hcHBseUhvbWVFbmRLZXkgPSBmdW5jdGlvbiAocm93SW5kZXgsIGNlbGxJbmRleCkge1xuICAgICAgICBpZiAodGhpcy5pc0NlbGxUeXBlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbCh7IHJvd0luZGV4OiByb3dJbmRleCwgY2VsbEluZGV4OiBjZWxsSW5kZXggfSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFkZEF0dHJpYnV0ZSh0aGlzLnBhcmVudC5nZXRDZWxsRnJvbUluZGV4KHJvd0luZGV4LCBjZWxsSW5kZXgpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQXBwbHkgc2hpZnQrZG93biBrZXkgc2VsZWN0aW9uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcm93SW5kZXggLSBzcGVjZmllcyB0aGUgcm93SW5kZXhcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY2VsbEluZGV4IC0gc3BlY2lmaWVzIHRoZSBDZWxsSW5kZXhcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zaGlmdERvd25LZXkgPSBmdW5jdGlvbiAocm93SW5kZXgsIGNlbGxJbmRleCkge1xuICAgICAgICB0aGlzLmlzTXVsdGlTaGlmdFJlcXVlc3QgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5pc1Jvd1R5cGUoKSAmJiAhdGhpcy5pc1NpbmdsZVNlbCgpKSB7XG4gICAgICAgICAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMucHJldlJvd0luZGV4KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Um93c0J5UmFuZ2UodGhpcy5wcmV2Um93SW5kZXgsIHJvd0luZGV4KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGx5VXBEb3duKHJvd0luZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuaXNQYXJ0aWFsU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSb3cocm93SW5kZXgsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSb3coMCwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNDZWxsVHlwZSgpICYmICF0aGlzLmlzU2luZ2xlU2VsKCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbHNCeVJhbmdlKHRoaXMucHJldkNJZHhzIHx8IHsgcm93SW5kZXg6IDAsIGNlbGxJbmRleDogMCB9LCB7IHJvd0luZGV4OiByb3dJbmRleCwgY2VsbEluZGV4OiBjZWxsSW5kZXggfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc011bHRpU2hpZnRSZXF1ZXN0ID0gZmFsc2U7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmFwcGx5U2hpZnRMZWZ0UmlnaHRLZXkgPSBmdW5jdGlvbiAocm93SW5kZXgsIGNlbGxJbmRleCkge1xuICAgICAgICB0aGlzLmlzTXVsdGlTaGlmdFJlcXVlc3QgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5hbGxvd0NvbHVtblNlbGVjdGlvbiAmJiB0aGlzLm5lZWRDb2x1bW5TZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q29sdW1uc0J5UmFuZ2UodGhpcy5wcmV2Q29sSW5kZXgsIGNlbGxJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdENlbGxzQnlSYW5nZSh0aGlzLnByZXZDSWR4cywgeyByb3dJbmRleDogcm93SW5kZXgsIGNlbGxJbmRleDogY2VsbEluZGV4IH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNNdWx0aVNoaWZ0UmVxdWVzdCA9IGZhbHNlO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5nZXRzdGFja2VkQ29sdW1ucyA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcbiAgICAgICAgdmFyIGlubmVyQ29sdW1uSW5kZXhlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gY29sdW1uLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoY29sdW1uW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRzdGFja2VkQ29sdW1ucyhjb2x1bW5bcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5uZXJDb2x1bW5JbmRleGVzLnB1c2goY29sdW1uW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlubmVyQ29sdW1uSW5kZXhlcztcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuYXBwbHlDdHJsSG9tZUVuZEtleSA9IGZ1bmN0aW9uIChyb3dJbmRleCwgY2VsbEluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLmlzUm93VHlwZSgpKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdFJvdyhyb3dJbmRleCwgdHJ1ZSk7XG4gICAgICAgICAgICBpZiAoISh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEF0dHJpYnV0ZSh0aGlzLnBhcmVudC5nZXRDZWxsRnJvbUluZGV4KHJvd0luZGV4LCBjZWxsSW5kZXgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc0NlbGxUeXBlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbCh7IHJvd0luZGV4OiByb3dJbmRleCwgY2VsbEluZGV4OiBjZWxsSW5kZXggfSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuYWRkUmVtb3ZlQ2xhc3Nlc0ZvclJvdyA9IGZ1bmN0aW9uIChyb3csIGlzQWRkLCBjbGVhckFsbCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDNdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm93KSB7XG4gICAgICAgICAgICB2YXIgY2VsbHMgPSBbXS5zbGljZS5jYWxsKHJvdy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGxpdGVyYWxzLnJvd0NlbGwpKTtcbiAgICAgICAgICAgIHZhciBkZXRhaWxJbmRlbnRDZWxsID0gcm93LnF1ZXJ5U2VsZWN0b3IoJy5lLWRldGFpbHJvd2NvbGxhcHNlJykgfHwgcm93LnF1ZXJ5U2VsZWN0b3IoJy5lLWRldGFpbHJvd2V4cGFuZCcpO1xuICAgICAgICAgICAgdmFyIGRyYWdkcm9wSW5kZW50Q2VsbCA9IHJvdy5xdWVyeVNlbGVjdG9yKCcuZS1yb3dkcmFnZHJvcCcpO1xuICAgICAgICAgICAgaWYgKGRldGFpbEluZGVudENlbGwpIHtcbiAgICAgICAgICAgICAgICBjZWxscy5wdXNoKGRldGFpbEluZGVudENlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRyYWdkcm9wSW5kZW50Q2VsbCkge1xuICAgICAgICAgICAgICAgIGNlbGxzLnB1c2goZHJhZ2Ryb3BJbmRlbnRDZWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFkZFJlbW92ZUFjdGl2ZUNsYXNzZXMuYXBwbHkodm9pZCAwLCBbY2VsbHMsIGlzQWRkXS5jb25jYXQoYXJncykpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ2V0UmVuZGVyZXIoKS5zZXRTZWxlY3Rpb24ocm93ID8gcm93LmdldEF0dHJpYnV0ZSgnZGF0YS11aWQnKSA6IG51bGwsIGlzQWRkLCBjbGVhckFsbCk7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmlzUm93VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MubW9kZSA9PT0gJ1JvdycgfHwgdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5tb2RlID09PSAnQm90aCc7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmlzQ2VsbFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvblNldHRpbmdzLm1vZGUgPT09ICdDZWxsJyB8fCB0aGlzLnNlbGVjdGlvblNldHRpbmdzLm1vZGUgPT09ICdCb3RoJztcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuaXNTaW5nbGVTZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvblNldHRpbmdzLnR5cGUgPT09ICdTaW5nbGUnO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5nZXRSZW5kZXJlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuY29udGVudFJlbmRlcmVyKSkge1xuICAgICAgICAgICAgdGhpcy5jb250ZW50UmVuZGVyZXIgPSB0aGlzLmZhY3RvcnkuZ2V0UmVuZGVyZXIoUmVuZGVyVHlwZS5Db250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50UmVuZGVyZXI7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb2xsZWN0aW9uIG9mIHNlbGVjdGVkIHJlY29yZHMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0W119IHJldHVybnMgdGhlIE9iamVjdFxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZ2V0U2VsZWN0ZWRSZWNvcmRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZWN0ZWREYXRhID0gW107XG4gICAgICAgIGlmICghdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5wZXJzaXN0U2VsZWN0aW9uICYmIHRoaXMuc2VsZWN0ZWRSZWNvcmRzLmxlbmd0aCkge1xuICAgICAgICAgICAgc2VsZWN0ZWREYXRhID0gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpLmZpbHRlcihmdW5jdGlvbiAocm93KSB7IHJldHVybiByb3cuaXNTZWxlY3RlZDsgfSlcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLmRhdGE7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VsZWN0ZWREYXRhID0gdGhpcy5wZXJzaXN0U2VsZWN0ZWREYXRhO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNoZWNrVmlydHVhbENoZWNrQm94KCkgJiYgIXRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgc2VsZWN0ZWREYXRhID0gdGhpcy52aXJ0dWFsU2VsZWN0ZWREYXRhO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZWxlY3RlZERhdGE7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZWxlY3QgdGhlIGNvbHVtbiBieSBwYXNzaW5nIHN0YXJ0IGNvbHVtbiBpbmRleFxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gc3BlY2lmaWVzIHRoZSBpbmRleFxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuc2VsZWN0Q29sdW1uID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChnT2JqLmdldENvbHVtbnMoKVtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb2x1bW4gPSBnT2JqLmdldENvbHVtbkJ5SW5kZXgoaW5kZXgpO1xuICAgICAgICB2YXIgc2VsZWN0ZWRDb2wgPSBnT2JqLmdldENvbHVtbkhlYWRlckJ5VWlkKGNvbHVtbi51aWQpO1xuICAgICAgICB2YXIgaXNDb2xTZWxlY3RlZCA9IHNlbGVjdGVkQ29sLmNsYXNzTGlzdC5jb250YWlucygnZS1jb2x1bW5zZWxlY3Rpb24nKTtcbiAgICAgICAgaWYgKCghZ09iai5zZWxlY3Rpb25TZXR0aW5ncy5hbGxvd0NvbHVtblNlbGVjdGlvbikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNNdWx0aUNvbHVtbnMgPSB0aGlzLnNlbGVjdGVkQ29sdW1uc0luZGV4ZXMubGVuZ3RoID4gMSAmJlxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZENvbHVtbnNJbmRleGVzLmluZGV4T2YoaW5kZXgpID4gLTE7XG4gICAgICAgIHRoaXMuY2xlYXJDb2xEZXBlbmRlbmN5KCk7XG4gICAgICAgIGlmICghdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5lbmFibGVUb2dnbGUgfHwgaXNNdWx0aUNvbHVtbnMgfHwgIWlzQ29sU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4OiBpbmRleCwgaGVhZGVyQ2VsbDogc2VsZWN0ZWRDb2wsXG4gICAgICAgICAgICAgICAgY29sdW1uOiBjb2x1bW4sXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBmYWxzZSwgdGFyZ2V0OiB0aGlzLmFjdHVhbFRhcmdldCxcbiAgICAgICAgICAgICAgICBpc0ludGVyYWN0ZWQ6IHRoaXMuaXNJbnRlcmFjdGVkLCBwcmV2aW91c0NvbHVtbkluZGV4OiB0aGlzLnByZXZDb2xJbmRleCxcbiAgICAgICAgICAgICAgICBpc0N0cmxQcmVzc2VkOiB0aGlzLmlzTXVsdGlDdHJsUmVxdWVzdCwgaXNTaGlmdFByZXNzZWQ6IHRoaXMuaXNNdWx0aVNoaWZ0UmVxdWVzdFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMub25BY3Rpb25CZWdpbihhcmdzLCBldmVudHMuY29sdW1uU2VsZWN0aW5nKTtcbiAgICAgICAgICAgIGlmIChhcmdzLmNhbmNlbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZUludGVyYWN0ZWQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNNdWx0aUNvbHVtbnMgfHwgIShpc0NvbFNlbGVjdGVkICYmIGdPYmouc2VsZWN0aW9uU2V0dGluZ3MuZW5hYmxlVG9nZ2xlICYmIGluZGV4ID09PSB0aGlzLnByZXZDb2xJbmRleCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbFNlbGVjdGlvbihzZWxlY3RlZENvbCwgaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQXJncyA9IHtcbiAgICAgICAgICAgICAgICBjb2x1bW5JbmRleDogaW5kZXgsIGhlYWRlckNlbGw6IHNlbGVjdGVkQ29sLFxuICAgICAgICAgICAgICAgIGNvbHVtbjogY29sdW1uLFxuICAgICAgICAgICAgICAgIHRhcmdldDogdGhpcy5hY3R1YWxUYXJnZXQsXG4gICAgICAgICAgICAgICAgaXNJbnRlcmFjdGVkOiB0aGlzLmlzSW50ZXJhY3RlZCwgcHJldmlvdXNDb2x1bW5JbmRleDogdGhpcy5wcmV2Q29sSW5kZXhcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLm9uQWN0aW9uQ29tcGxldGUoc2VsZWN0ZWRBcmdzLCBldmVudHMuY29sdW1uU2VsZWN0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlQ29sUHJvcHMoaW5kZXgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VsZWN0IHRoZSBjb2x1bW5zIGJ5IHBhc3Npbmcgc3RhcnQgYW5kIGVuZCBjb2x1bW4gaW5kZXhcbiAgICAgKlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gc3RhcnRJbmRleCAtIHNwZWNpZmllcyB0aGUgc3RhcnQgaW5kZXhcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGVuZEluZGV4IC0gc3BlY2lmaWVzIHRoZSBlbmQgaW5kZXhcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnNlbGVjdENvbHVtbnNCeVJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChnT2JqLmdldENvbHVtbnMoKVtwYXJzZUludChzdGFydEluZGV4LnRvU3RyaW5nKCksIDEwKV0pKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGV4ZXMgPSBbXTtcbiAgICAgICAgaWYgKGdPYmouc2VsZWN0aW9uU2V0dGluZ3MudHlwZSA9PT0gJ1NpbmdsZScgfHwgaXNOdWxsT3JVbmRlZmluZWQoZW5kSW5kZXgpKSB7XG4gICAgICAgICAgICBpbmRleGVzWzBdID0gc3RhcnRJbmRleDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBtaW4gPSBzdGFydEluZGV4IDwgZW5kSW5kZXg7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhcnRJbmRleDsgbWluID8gaSA8PSBlbmRJbmRleCA6IGkgPj0gZW5kSW5kZXg7IG1pbiA/IGkrKyA6IGktLSkge1xuICAgICAgICAgICAgICAgIGluZGV4ZXMucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbGVjdENvbHVtbnMoaW5kZXhlcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZWxlY3QgdGhlIGNvbHVtbnMgYnkgcGFzc2luZyBjb2x1bW4gaW5kZXhlc1xuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyW119IGNvbHVtbkluZGV4ZXMgLSBzcGVjaWZpZXMgdGhlIGNvbHVtbkluZGV4ZXNcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnNlbGVjdENvbHVtbnMgPSBmdW5jdGlvbiAoY29sdW1uSW5kZXhlcykge1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgc2VsZWN0ZWRDb2wgPSB0aGlzLmdldHNlbGVjdGVkQ29scygpO1xuICAgICAgICBpZiAoZ09iai5zZWxlY3Rpb25TZXR0aW5ncy50eXBlID09PSAnU2luZ2xlJykge1xuICAgICAgICAgICAgY29sdW1uSW5kZXhlcyA9IFtjb2x1bW5JbmRleGVzWzBdXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWdPYmouc2VsZWN0aW9uU2V0dGluZ3MuYWxsb3dDb2x1bW5TZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsZWFyQ29sRGVwZW5kZW5jeSgpO1xuICAgICAgICB2YXIgc2VsZWN0aW5nQXJncyA9IHtcbiAgICAgICAgICAgIGNvbHVtbkluZGV4OiBjb2x1bW5JbmRleGVzWzBdLCBoZWFkZXJDZWxsOiBzZWxlY3RlZENvbCxcbiAgICAgICAgICAgIGNvbHVtbkluZGV4ZXM6IGNvbHVtbkluZGV4ZXMsXG4gICAgICAgICAgICBjb2x1bW46IGdPYmouZ2V0Q29sdW1uQnlJbmRleChjb2x1bW5JbmRleGVzWzBdKSxcbiAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsIHRhcmdldDogdGhpcy5hY3R1YWxUYXJnZXQsXG4gICAgICAgICAgICBpc0ludGVyYWN0ZWQ6IHRoaXMuaXNJbnRlcmFjdGVkLCBwcmV2aW91c0NvbHVtbkluZGV4OiB0aGlzLnByZXZDb2xJbmRleCxcbiAgICAgICAgICAgIGlzQ3RybFByZXNzZWQ6IHRoaXMuaXNNdWx0aUN0cmxSZXF1ZXN0LCBpc1NoaWZ0UHJlc3NlZDogdGhpcy5pc011bHRpU2hpZnRSZXF1ZXN0XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub25BY3Rpb25CZWdpbihzZWxlY3RpbmdBcmdzLCBldmVudHMuY29sdW1uU2VsZWN0aW5nKTtcbiAgICAgICAgaWYgKHNlbGVjdGluZ0FyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2FibGVJbnRlcmFjdGVkKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNvbHVtbkluZGV4ZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29sU2VsZWN0aW9uKGdPYmouZ2V0Q29sdW1uSGVhZGVyQnlVaWQoZ09iai5nZXRDb2x1bW5CeUluZGV4KGNvbHVtbkluZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKS51aWQpLCBjb2x1bW5JbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZWN0ZWRDb2wgPSB0aGlzLmdldHNlbGVjdGVkQ29scygpO1xuICAgICAgICB2YXIgc2VsZWN0ZWRBcmdzID0ge1xuICAgICAgICAgICAgY29sdW1uSW5kZXg6IGNvbHVtbkluZGV4ZXNbMF0sIGhlYWRlckNlbGw6IHNlbGVjdGVkQ29sLFxuICAgICAgICAgICAgY29sdW1uSW5kZXhlczogY29sdW1uSW5kZXhlcyxcbiAgICAgICAgICAgIGNvbHVtbjogZ09iai5nZXRDb2x1bW5CeUluZGV4KGNvbHVtbkluZGV4ZXNbMF0pLFxuICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLmFjdHVhbFRhcmdldCxcbiAgICAgICAgICAgIGlzSW50ZXJhY3RlZDogdGhpcy5pc0ludGVyYWN0ZWQsIHByZXZpb3VzQ29sdW1uSW5kZXg6IHRoaXMucHJldkNvbEluZGV4XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub25BY3Rpb25Db21wbGV0ZShzZWxlY3RlZEFyZ3MsIGV2ZW50cy5jb2x1bW5TZWxlY3RlZCk7XG4gICAgICAgIHRoaXMudXBkYXRlQ29sUHJvcHMoY29sdW1uSW5kZXhlc1swXSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZWxlY3QgdGhlIGNvbHVtbiB3aXRoIGV4aXN0aW5nIGNvbHVtbiBieSBwYXNzaW5nIGNvbHVtbiBpbmRleFxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBzdGFydEluZGV4IC0gc3BlY2lmaWVzIHRoZSBzdGFydCBpbmRleFxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuc2VsZWN0Q29sdW1uV2l0aEV4aXN0aW5nID0gZnVuY3Rpb24gKHN0YXJ0SW5kZXgpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGdPYmouZ2V0Q29sdW1ucygpW3BhcnNlSW50KHN0YXJ0SW5kZXgudG9TdHJpbmcoKSwgMTApXSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3Q29sID0gZ09iai5nZXRDb2x1bW5IZWFkZXJCeVVpZChnT2JqLmdldENvbHVtbkJ5SW5kZXgoc3RhcnRJbmRleCkudWlkKTtcbiAgICAgICAgdmFyIHNlbGVjdGVkQ29sID0gdGhpcy5nZXRzZWxlY3RlZENvbHMoKTtcbiAgICAgICAgaWYgKGdPYmouc2VsZWN0aW9uU2V0dGluZ3MudHlwZSA9PT0gJ1NpbmdsZScpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDb2xEZXBlbmRlbmN5KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFnT2JqLnNlbGVjdGlvblNldHRpbmdzLmFsbG93Q29sdW1uU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRDb2x1bW5zSW5kZXhlcy5pbmRleE9mKHN0YXJ0SW5kZXgpID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDb2x1bW5TZWxlY3Rpb24oc3RhcnRJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0aW5nQXJncyA9IHtcbiAgICAgICAgICAgICAgICBjb2x1bW5JbmRleDogc3RhcnRJbmRleCwgaGVhZGVyQ2VsbDogc2VsZWN0ZWRDb2wsXG4gICAgICAgICAgICAgICAgY29sdW1uSW5kZXhlczogdGhpcy5zZWxlY3RlZENvbHVtbnNJbmRleGVzLFxuICAgICAgICAgICAgICAgIGNvbHVtbjogZ09iai5nZXRDb2x1bW5CeUluZGV4KHN0YXJ0SW5kZXgpLFxuICAgICAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsIHRhcmdldDogdGhpcy5hY3R1YWxUYXJnZXQsXG4gICAgICAgICAgICAgICAgaXNJbnRlcmFjdGVkOiB0aGlzLmlzSW50ZXJhY3RlZCwgcHJldmlvdXNDb2x1bW5JbmRleDogdGhpcy5wcmV2Q29sSW5kZXgsXG4gICAgICAgICAgICAgICAgaXNDdHJsUHJlc3NlZDogdGhpcy5pc011bHRpQ3RybFJlcXVlc3QsIGlzU2hpZnRQcmVzc2VkOiB0aGlzLmlzTXVsdGlTaGlmdFJlcXVlc3RcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLm9uQWN0aW9uQmVnaW4oc2VsZWN0aW5nQXJncywgZXZlbnRzLmNvbHVtblNlbGVjdGluZyk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0aW5nQXJncy5jYW5jZWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVJbnRlcmFjdGVkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb2xTZWxlY3Rpb24obmV3Q29sLCBzdGFydEluZGV4KTtcbiAgICAgICAgICAgIHNlbGVjdGVkQ29sID0gdGhpcy5nZXRzZWxlY3RlZENvbHMoKTtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgY29sdW1uSW5kZXg6IHN0YXJ0SW5kZXgsIGhlYWRlckNlbGw6IHNlbGVjdGVkQ29sLFxuICAgICAgICAgICAgICAgIGNvbHVtbjogZ09iai5nZXRDb2x1bW5CeUluZGV4KHN0YXJ0SW5kZXgpLFxuICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4ZXM6IHRoaXMuc2VsZWN0ZWRDb2x1bW5zSW5kZXhlcyxcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMuYWN0dWFsVGFyZ2V0LFxuICAgICAgICAgICAgICAgIGlzSW50ZXJhY3RlZDogdGhpcy5pc0ludGVyYWN0ZWQsIHByZXZpb3VzQ29sdW1uSW5kZXg6IHRoaXMucHJldkNvbEluZGV4XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5vbkFjdGlvbkNvbXBsZXRlKHNlbGVjdGVkQXJncywgZXZlbnRzLmNvbHVtblNlbGVjdGVkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZUNvbFByb3BzKHN0YXJ0SW5kZXgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2xlYXIgdGhlIGNvbHVtbiBzZWxlY3Rpb25cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjbGVhckluZGV4IC0gc3BlY2lmaWVzIHRoZSBjbGVhckluZGV4XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jbGVhckNvbHVtblNlbGVjdGlvbiA9IGZ1bmN0aW9uIChjbGVhckluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLmlzQ29sdW1uU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGNsZWFySW5kZXgpICYmIHRoaXMuc2VsZWN0ZWRDb2x1bW5zSW5kZXhlcy5pbmRleE9mKGNsZWFySW5kZXgpID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpbmRleCA9ICFpc051bGxPclVuZGVmaW5lZChjbGVhckluZGV4KSA/IGNsZWFySW5kZXggOlxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRDb2x1bW5zSW5kZXhlc1t0aGlzLnNlbGVjdGVkQ29sdW1uc0luZGV4ZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB2YXIgY29sdW1uID0gZ09iai5nZXRDb2x1bW5CeUluZGV4KGluZGV4KTtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENvbCA9IGdPYmouZ2V0Q29sdW1uSGVhZGVyQnlVaWQoY29sdW1uLnVpZCk7XG4gICAgICAgICAgICB2YXIgZGVzZWxlY3RlZEFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgY29sdW1uSW5kZXg6IGluZGV4LCBoZWFkZXJDZWxsOiBzZWxlY3RlZENvbCxcbiAgICAgICAgICAgICAgICBjb2x1bW5JbmRleGVzOiB0aGlzLnNlbGVjdGVkQ29sdW1uc0luZGV4ZXMsXG4gICAgICAgICAgICAgICAgY29sdW1uOiBjb2x1bW4sXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBmYWxzZSwgdGFyZ2V0OiB0aGlzLmFjdHVhbFRhcmdldCxcbiAgICAgICAgICAgICAgICBpc0ludGVyYWN0ZWQ6IHRoaXMuaXNJbnRlcmFjdGVkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGlzQ2FuY2VsZWQgPSB0aGlzLmNvbHVtbkRlc2VsZWN0KGRlc2VsZWN0ZWRBcmdzLCBldmVudHMuY29sdW1uRGVzZWxlY3RpbmcpO1xuICAgICAgICAgICAgaWYgKGlzQ2FuY2VsZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVJbnRlcmFjdGVkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSGVhZGVyID0gIWlzTnVsbE9yVW5kZWZpbmVkKGNsZWFySW5kZXgpID8gW3NlbGVjdGVkQ29sXSA6XG4gICAgICAgICAgICAgICAgW10uc2xpY2UuY2FsbChnT2JqLmdldEhlYWRlckNvbnRlbnQoKS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlLWNvbHVtbnNlbGVjdGlvbicpKTtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENlbGxzID0gdGhpcy5nZXRTZWxlY3RlZENvbHVtbkNlbGxzKGNsZWFySW5kZXgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHNlbGVjdGVkSGVhZGVyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgYWRkUmVtb3ZlQWN0aXZlQ2xhc3Nlcyhbc2VsZWN0ZWRIZWFkZXJbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSwgZmFsc2UsICdlLWNvbHVtbnNlbGVjdGlvbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHNlbGVjdGVkQ2VsbHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBhZGRSZW1vdmVBY3RpdmVDbGFzc2VzKFtzZWxlY3RlZENlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0sIGZhbHNlLCAnZS1jb2x1bW5zZWxlY3Rpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY2xlYXJJbmRleCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkQ29sdW1uc0luZGV4ZXMuc3BsaWNlKHRoaXMuc2VsZWN0ZWRDb2x1bW5zSW5kZXhlcy5pbmRleE9mKGNsZWFySW5kZXgpLCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKClbcGFyc2VJbnQoY2xlYXJJbmRleC50b1N0cmluZygpLCAxMCldLmlzU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uRGVzZWxlY3QoZGVzZWxlY3RlZEFyZ3MsIGV2ZW50cy5jb2x1bW5EZXNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkQ29sdW1uc0luZGV4ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzQ29sdW1uU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCkuZmlsdGVyKGZ1bmN0aW9uIChjb2wpIHsgcmV0dXJuIGNvbC5pc1NlbGVjdGVkID0gZmFsc2U7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmdldHNlbGVjdGVkQ29scyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHNlbGVjdGVkQ29sO1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZENvbHVtbnNJbmRleGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkQ29sID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2VsZWN0ZWRDb2x1bW5zSW5kZXhlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIChzZWxlY3RlZENvbCkucHVzaChnT2JqLmdldENvbHVtbkhlYWRlckJ5VWlkKGdPYmouZ2V0Q29sdW1uQnlJbmRleCh0aGlzLnNlbGVjdGVkQ29sdW1uc0luZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKS51aWQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGVjdGVkQ29sID0gZ09iai5nZXRDb2x1bW5IZWFkZXJCeVVpZChnT2JqLmdldENvbHVtbkJ5SW5kZXgodGhpcy5zZWxlY3RlZENvbHVtbnNJbmRleGVzWzBdKS51aWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZWxlY3RlZENvbDtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuZ2V0U2VsZWN0ZWRDb2x1bW5DZWxscyA9IGZ1bmN0aW9uIChjbGVhckluZGV4KSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciBpc1Jvd1RlbXBsYXRlID0gIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LnJvd1RlbXBsYXRlKTtcbiAgICAgICAgdmFyIHJvd3MgPSBpc1Jvd1RlbXBsYXRlID8gZ09iai5nZXRSb3dzKCkgOiBnT2JqLmdldERhdGFSb3dzKCk7XG4gICAgICAgIHZhciBzZWxldGVkY2VsbHMgPSBbXTtcbiAgICAgICAgdmFyIHNlbGVjdGlvblN0cmluZyA9ICFpc051bGxPclVuZGVmaW5lZChjbGVhckluZGV4KSA/ICdbYXJpYS1jb2xpbmRleD1cIicgKyAoY2xlYXJJbmRleCArIDEpICsgJ1wiXScgOiAnLmUtY29sdW1uc2VsZWN0aW9uJztcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJvd3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHNlbGV0ZWRjZWxscyA9IHNlbGV0ZWRjZWxscy5jb25jYXQoW10uc2xpY2UuY2FsbChyb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdGlvblN0cmluZykpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VsZXRlZGNlbGxzO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5jb2x1bW5EZXNlbGVjdCA9IGZ1bmN0aW9uIChhcmdzLCBldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQgPT09ICdjb2x1bW5EZXNlbGVjdGVkJykge1xuICAgICAgICAgICAgZGVsZXRlIGFyZ3MuY2FuY2VsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub25BY3Rpb25Db21wbGV0ZShhcmdzLCBldmVudCk7XG4gICAgICAgIHJldHVybiBhcmdzLmNhbmNlbDtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlQ29sUHJvcHMgPSBmdW5jdGlvbiAoc3RhcnRJbmRleCkge1xuICAgICAgICB0aGlzLnByZXZDb2xJbmRleCA9IHN0YXJ0SW5kZXg7XG4gICAgICAgIHRoaXMuaXNDb2x1bW5TZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWRDb2x1bW5zSW5kZXhlcy5sZW5ndGggJiYgdHJ1ZTtcbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuY2xlYXJDb2xEZXBlbmRlbmN5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNsZWFyQ29sdW1uU2VsZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRDb2x1bW5zSW5kZXhlcyA9IFtdO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS51cGRhdGVDb2xTZWxlY3Rpb24gPSBmdW5jdGlvbiAoc2VsZWN0ZWRDb2wsIHN0YXJ0SW5kZXgpIHtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmdldENvbHVtbnMoKVtwYXJzZUludChzdGFydEluZGV4LnRvU3RyaW5nKCksIDEwKV0pKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzUm93VGVtcGxhdGUgPSAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQucm93VGVtcGxhdGUpO1xuICAgICAgICB2YXIgcm93cyA9IGlzUm93VGVtcGxhdGUgPyB0aGlzLnBhcmVudC5nZXRSb3dzKCkgOiB0aGlzLnBhcmVudC5nZXREYXRhUm93cygpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkQ29sdW1uc0luZGV4ZXMucHVzaChzdGFydEluZGV4KTtcbiAgICAgICAgdGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpW3BhcnNlSW50KHN0YXJ0SW5kZXgudG9TdHJpbmcoKSwgMTApXS5pc1NlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgc3RhcnRJbmRleCA9IHN0YXJ0SW5kZXggKyB0aGlzLnBhcmVudC5nZXRJbmRlbnRDb3VudCgpO1xuICAgICAgICBhZGRSZW1vdmVBY3RpdmVDbGFzc2VzKFtzZWxlY3RlZENvbF0sIHRydWUsICdlLWNvbHVtbnNlbGVjdGlvbicpO1xuICAgICAgICBmb3IgKHZhciBqID0gMCwgbGVuID0gcm93cy5sZW5ndGg7IGogPCBsZW47IGorKykge1xuICAgICAgICAgICAgaWYgKHJvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5jb250YWlucyhsaXRlcmFscy5yb3cpKSB7XG4gICAgICAgICAgICAgICAgaWYgKChyb3dzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMuZWRpdGVkUm93KVxuICAgICAgICAgICAgICAgICAgICB8fCByb3dzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMuYWRkZWRSb3cpKVxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ05vcm1hbCdcbiAgICAgICAgICAgICAgICAgICAgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKHJvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnF1ZXJ5U2VsZWN0b3IoJ3RyJykuY2hpbGROb2Rlc1twYXJzZUludChzdGFydEluZGV4LnRvU3RyaW5nKCksIDEwKV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZFJlbW92ZUFjdGl2ZUNsYXNzZXMoW3Jvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnF1ZXJ5U2VsZWN0b3IoJ3RyJykuY2hpbGROb2Rlc1twYXJzZUludChzdGFydEluZGV4LnRvU3RyaW5nKCksIDEwKV1dLCB0cnVlLCAnZS1jb2x1bW5zZWxlY3Rpb24nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pc1NwYW4gJiYgdGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjZWxscyA9IHJvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXJvd2NlbGwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2VsbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmdldEF0dHJpYnV0ZSgnYXJpYS1jb2xpbmRleCcpID09PSBzZWxlY3RlZENvbC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRSZW1vdmVBY3RpdmVDbGFzc2VzKFtjZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dLCB0cnVlLCAnZS1jb2x1bW5zZWxlY3Rpb24nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHJvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmNoaWxkTm9kZXNbcGFyc2VJbnQoc3RhcnRJbmRleC50b1N0cmluZygpLCAxMCldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkUmVtb3ZlQWN0aXZlQ2xhc3Nlcyhbcm93c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uY2hpbGROb2Rlc1twYXJzZUludChzdGFydEluZGV4LnRvU3RyaW5nKCksIDEwKV1dLCB0cnVlLCAnZS1jb2x1bW5zZWxlY3Rpb24nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5oZWFkZXJTZWxlY3Rpb25IYW5kbGVyID0gZnVuY3Rpb24gKGNvbEluZGV4KSB7XG4gICAgICAgIGlmICgoIXRoaXMuaXNNdWx0aUN0cmxSZXF1ZXN0ICYmICF0aGlzLmlzTXVsdGlTaGlmdFJlcXVlc3QpIHx8IHRoaXMuaXNTaW5nbGVTZWwoKSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RDb2x1bW4oY29sSW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaXNNdWx0aVNoaWZ0UmVxdWVzdCkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RDb2x1bW5zQnlSYW5nZShpc1VuZGVmaW5lZCh0aGlzLnByZXZDb2xJbmRleCkgPyBjb2xJbmRleCA6IHRoaXMucHJldkNvbEluZGV4LCBjb2xJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdENvbHVtbldpdGhFeGlzdGluZyhjb2xJbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXJfY2hlY2tib3ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5kYXRhUmVhZHksIHRoaXMuZGF0YVJlYWR5LCB0aGlzKTtcbiAgICAgICAgdGhpcy5vbkRhdGFCb3VuZEZ1bmN0aW9uID0gdGhpcy5vbkRhdGFCb3VuZC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50cy5kYXRhQm91bmQsIHRoaXMub25EYXRhQm91bmRGdW5jdGlvbik7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5yZWZyZXNoSW5maW5pdGVQZXJzaXN0U2VsZWN0aW9uLCB0aGlzLm9uRGF0YUJvdW5kRnVuY3Rpb24pO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuY29udGVudFJlYWR5LCB0aGlzLmNoZWNrQm94U2VsZWN0aW9uQ2hhbmdlZCwgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5iZWZvcmVSZWZyZXNoT25EYXRhQ2hhbmdlLCB0aGlzLmluaXRQZXJpc2lzdFNlbGVjdGlvbiwgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5vbkVtcHR5LCB0aGlzLnNldENoZWNrQWxsRm9yRW1wdHlHcmlkLCB0aGlzKTtcbiAgICAgICAgdGhpcy5hY3Rpb25Db21wbGV0ZUZ1bmMgPSB0aGlzLmFjdGlvbkNvbXBsZXRlSGFuZGxlci5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50cy5hY3Rpb25Db21wbGV0ZSwgdGhpcy5hY3Rpb25Db21wbGV0ZUZ1bmMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuY2xpY2ssIHRoaXMuY2xpY2tIYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgdGhpcy5yZXNpemVFbmRGbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLnVwZGF0ZUF1dG9GaWxsUG9zaXRpb24oKTtcbiAgICAgICAgICAgIF90aGlzLmRyYXdCb3JkZXJzKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVzaXplRW5kRm4uYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudHMucmVzaXplU3RvcCwgdGhpcy5yZXNpemVFbmRGbik7XG4gICAgfTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyX2NoZWNrYm94ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLmRhdGFSZWFkeSwgdGhpcy5kYXRhUmVhZHkpO1xuICAgICAgICB0aGlzLnBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50cy5kYXRhQm91bmQsIHRoaXMub25EYXRhQm91bmRGdW5jdGlvbik7XG4gICAgICAgIHRoaXMucGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRzLmFjdGlvbkNvbXBsZXRlLCB0aGlzLmFjdGlvbkNvbXBsZXRlRnVuYyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9mZihldmVudHMucmVmcmVzaEluZmluaXRlUGVyc2lzdFNlbGVjdGlvbiwgdGhpcy5vbkRhdGFCb3VuZEZ1bmN0aW9uKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5vbkVtcHR5LCB0aGlzLnNldENoZWNrQWxsRm9yRW1wdHlHcmlkKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5jbGljaywgdGhpcy5jbGlja0hhbmRsZXIpO1xuICAgICAgICB0aGlzLnBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50cy5yZXNpemVTdG9wLCB0aGlzLnJlc2l6ZUVuZEZuKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5iZWZvcmVSZWZyZXNoT25EYXRhQ2hhbmdlLCB0aGlzLmluaXRQZXJpc2lzdFNlbGVjdGlvbik7XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLnNldENoZWNrQWxsRm9yRW1wdHlHcmlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2hlY2tBbGxCb3ggPSB0aGlzLmdldENoZWNrQWxsQm94KCk7XG4gICAgICAgIGlmIChjaGVja0FsbEJveCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuaXNDaGVja0JveFNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB2YXIgc3BhbkVsZSA9IGNoZWNrQWxsQm94Lm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgICAgIHJlbW92ZUNsYXNzKFtzcGFuRWxlXSwgWydlLWNoZWNrJywgJ2Utc3RvcCcsICdlLXVuY2hlY2snXSk7XG4gICAgICAgICAgICBhZGRDbGFzcyhbc3BhbkVsZS5wYXJlbnRFbGVtZW50XSwgWydlLWNoZWNrYm94LWRpc2FibGVkJ10pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmRhdGFSZWFkeSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMuaXNIZWFkZXJDaGVja2JveENsaWNrZWQgPSBmYWxzZTtcbiAgICAgICAgdmFyIGlzSW5maW5pdGVjcm9sbCA9IHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nICYmIGUucmVxdWVzdFR5cGUgPT09ICdpbmZpbml0ZVNjcm9sbCc7XG4gICAgICAgIGlmIChlLnJlcXVlc3RUeXBlICE9PSAndmlydHVhbHNjcm9sbCcgJiYgIXRoaXMucGFyZW50LmlzUGVyc2lzdFNlbGVjdGlvbiAmJiAhaXNJbmZpbml0ZWNyb2xsKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2FibGVVSSA9ICF0aGlzLnBhcmVudC5lbmFibGVJbW11dGFibGVNb2RlICYmICEoZS5yZXF1ZXN0VHlwZSA9PT0gJ3NhdmUnICYmIGVbJ2FjdGlvbiddID09PSAnYWRkJyk7XG4gICAgICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnNldENoZWNrQWxsU3RhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZVVJID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdGlvbi5wcm90b3R5cGUuYWN0aW9uQ29tcGxldGVIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUucmVxdWVzdFR5cGUgPT09ICdzYXZlJyAmJiB0aGlzLnBhcmVudC5pc1BlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFBlcnNpc3RTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5zZWxlY3RSb3dJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB0aGlzLnBhcmVudC5pc1NlbGVjdGVkUm93SW5kZXhVcGRhdGluZyA9IHRydWU7XG4gICAgICAgIGlmICgoaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuc2VsZWN0ZWRSb3dJbmRleCkgfHwgdGhpcy5wYXJlbnQuc2VsZWN0ZWRSb3dJbmRleCA9PT0gLTEpIHx8ICF0aGlzLnBhcmVudC5lbmFibGVQZXJzaXN0ZW5jZSkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2VsZWN0ZWRSb3dJbmRleCA9IGluZGV4O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2VsZWN0ZWRSb3dJbmRleCA9IC0xO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb24ucHJvdG90eXBlLmRpc2FibGVJbnRlcmFjdGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlzSW50ZXJhY3RlZCA9IGZhbHNlO1xuICAgIH07XG4gICAgU2VsZWN0aW9uLnByb3RvdHlwZS5hY3RpdmVUYXJnZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYWN0dWFsVGFyZ2V0ID0gdGhpcy5pc0ludGVyYWN0ZWQgPyB0aGlzLmFjdHVhbFRhcmdldCA6IG51bGw7XG4gICAgfTtcbiAgICByZXR1cm4gU2VsZWN0aW9uO1xufSgpKTtcbmV4cG9ydCB7IFNlbGVjdGlvbiB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/selection.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/show-hide.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/show-hide.js ***!
  \***************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ShowHide: () => (/* binding */ ShowHide)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _services_width_controller__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../services/width-controller */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/width-controller.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n\n\n\n\n/**\n * The `ShowHide` module is used to control column visibility.\n */\nvar ShowHide = /** @class */ (function () {\n    /**\n     * Constructor for the show hide module.\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @hidden\n     */\n    function ShowHide(parent) {\n        this.colName = [];\n        this.isShowHide = false;\n        this.parent = parent;\n        this.addEventListener();\n        this.widthService = new _services_width_controller__WEBPACK_IMPORTED_MODULE_1__.ColumnWidthService(parent);\n    }\n    ShowHide.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.evtHandlers = [{ event: _base_constant__WEBPACK_IMPORTED_MODULE_2__.batchCancel, handler: this.batchChanges },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_2__.batchCnfrmDlgCancel, handler: this.resetColumnState }\n        ];\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.addRemoveEventListener)(this.parent, this.evtHandlers, true, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    ShowHide.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.addRemoveEventListener)(this.parent, this.evtHandlers, false);\n    };\n    ShowHide.prototype.batchChanges = function () {\n        if (this.isShowHide) {\n            this.isShowHide = false;\n            this.setVisible(this.colName, this.changedCol);\n            this.changedCol = this.colName = [];\n        }\n    };\n    /**\n     * Shows a column by column name.\n     *\n     * @param  {string|string[]} columnName - Defines a single or collection of column names to show.\n     * @param  {string} showBy - Defines the column key either as field name or header text.\n     * @returns {void}\n     */\n    ShowHide.prototype.show = function (columnName, showBy) {\n        var keys = this.getToggleFields(columnName);\n        var columns = this.getColumns(keys, showBy);\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.tooltipDestroy, { module: 'edit' });\n        for (var i = 0; i < columns.length; i++) {\n            columns[parseInt(i.toString(), 10)].visible = true;\n        }\n        this.setVisible(columns);\n    };\n    /**\n     * Hides a column by column name.\n     *\n     * @param  {string|string[]} columnName - Defines a single or collection of column names to hide.\n     * @param  {string} hideBy - Defines the column key either as field name or header text.\n     * @returns {void}\n     */\n    ShowHide.prototype.hide = function (columnName, hideBy) {\n        var keys = this.getToggleFields(columnName);\n        var columns = this.getColumns(keys, hideBy);\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.tooltipDestroy, { module: 'edit' });\n        for (var i = 0; i < columns.length; i++) {\n            columns[parseInt(i.toString(), 10)].visible = false;\n        }\n        this.setVisible(columns);\n    };\n    ShowHide.prototype.getToggleFields = function (key) {\n        var finalized = [];\n        if (typeof key === 'string') {\n            finalized = [key];\n        }\n        else {\n            finalized = key;\n        }\n        return finalized;\n    };\n    ShowHide.prototype.getColumns = function (keys, getKeyBy) {\n        var _this = this;\n        var columns = (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.iterateArrayOrObject)(keys, function (key) {\n            return (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.iterateArrayOrObject)(_this.parent.columnModel, function (item) {\n                if (item[\"\" + getKeyBy] === key) {\n                    return item;\n                }\n                return undefined;\n            })[0];\n        });\n        return columns;\n    };\n    ShowHide.prototype.batchActionPrevent = function (columns, changedStateColumns) {\n        if (changedStateColumns === void 0) { changedStateColumns = []; }\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_3__.isActionPrevent)(this.parent)) {\n            this.colName = columns;\n            this.changedCol = changedStateColumns;\n            this.parent.closeEdit();\n            return false;\n        }\n        return true;\n    };\n    ShowHide.prototype.resetColumnState = function () {\n        if (this.isShowHide) {\n            for (var i = 0; i < this.colName.length; i++) {\n                this.colName[parseInt(i.toString(), 10)].visible = !this.colName[parseInt(i.toString(), 10)].visible;\n            }\n        }\n    };\n    /**\n     * Shows or hides columns by given column collection.\n     *\n     * @private\n     * @param {Column[]} columns - Specifies the columns.\n     * @param {Column[]} changedStateColumns - specifies the changedStateColumns\n     * @returns {void}\n     */\n    ShowHide.prototype.setVisible = function (columns, changedStateColumns) {\n        var _this = this;\n        if (changedStateColumns === void 0) { changedStateColumns = []; }\n        this.isShowHide = true;\n        if (!this.batchActionPrevent(columns, changedStateColumns)) {\n            return;\n        }\n        changedStateColumns = (changedStateColumns.length > 0) ? changedStateColumns : columns;\n        var args = {\n            requestType: 'columnstate',\n            cancel: false,\n            columns: changedStateColumns\n        };\n        var cancel = 'cancel';\n        if (this.parent.enableInfiniteScrolling && this.parent.allowGrouping\n            && this.parent.groupModule.groupSettings.columns.length > 0) {\n            this.parent.contentModule.visibleRows = [];\n        }\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_2__.actionBegin, args, function (showHideArgs) {\n            var currentViewCols = _this.parent.getColumns();\n            columns = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns) ? currentViewCols : columns;\n            if (showHideArgs[\"\" + cancel]) {\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.resetColumns, { showHideArgs: showHideArgs });\n                if (columns.length > 0) {\n                    columns[0].visible = true;\n                }\n                return;\n            }\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.destroyEditForm, args);\n            if ((0,_base_util__WEBPACK_IMPORTED_MODULE_3__.isGroupAdaptive)(_this.parent)) {\n                _this.parent.contentModule.emptyVcRows();\n            }\n            var addedRow = _this.parent.element.querySelector('.e-addedrow');\n            if (_this.parent.editSettings.showAddNewRow && addedRow) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(addedRow);\n                if (_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) {\n                    _this.parent.isAddNewRow = true;\n                }\n                _this.parent.addNewRowFocus = true;\n                _this.parent.isEdit = false;\n            }\n            if (_this.parent.allowSelection && _this.parent.getSelectedRecords().length &&\n                !_this.parent.selectionSettings.persistSelection) {\n                _this.parent.clearSelection();\n            }\n            if (_this.parent.enableColumnVirtualization) {\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.refreshFrozenPosition, { isModeChg: true });\n            }\n            else {\n                if (_this.parent.isFrozenGrid() && columns.length) {\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.refreshFrozenPosition, { isModeChg: true });\n                }\n                else {\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.columnVisibilityChanged, columns);\n                }\n            }\n            var params = {\n                requestType: 'columnstate',\n                columns: changedStateColumns\n            };\n            _this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_2__.actionComplete, params);\n            var startAdd = !_this.parent.element.querySelector('.e-addedrow');\n            if (_this.parent.editSettings.showAddNewRow && startAdd) {\n                _this.parent.isEdit = false;\n                _this.parent.addRecord();\n                if (!(_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling)) {\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.showAddNewRowFocus, {});\n                }\n            }\n            if (_this.parent.columnQueryMode !== 'All') {\n                _this.parent.refresh();\n            }\n        });\n        if (!this.parent.groupSettings.columns.length) {\n            if (this.parent.autoFit) {\n                this.parent.preventAdjustColumns();\n            }\n            else if (this.parent.allowResizing && this.parent.resizeSettings.mode === 'Normal') {\n                var isMaxWidth = this.parent.getHeaderTable().style.width.indexOf('px') === -1;\n                this.widthService.setWidthToTable(isMaxWidth);\n            }\n        }\n    };\n    return ShowHide;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL3Nob3ctaGlkZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFpRTtBQUM2QztBQUM1QztBQUN2QjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQywwRUFBa0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixPQUFPLHVEQUFrQiw4QkFBOEI7QUFDckYsY0FBYyxPQUFPLCtEQUEwQjtBQUMvQztBQUNBLFFBQVEsa0VBQXNCO0FBQzlCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxrRUFBc0I7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpQkFBaUI7QUFDakMsZ0JBQWdCLFFBQVE7QUFDeEIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDBEQUFxQixJQUFJLGdCQUFnQjtBQUNwRSx3QkFBd0Isb0JBQW9CO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlCQUFpQjtBQUNqQyxnQkFBZ0IsUUFBUTtBQUN4QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMERBQXFCLElBQUksZ0JBQWdCO0FBQ3BFLHdCQUF3QixvQkFBb0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsZ0VBQW9CO0FBQzFDLG1CQUFtQixnRUFBb0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QztBQUM5QyxZQUFZLDJEQUFlO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix5QkFBeUI7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsVUFBVTtBQUN6QixlQUFlLFVBQVU7QUFDekIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsdURBQWtCO0FBQzlDO0FBQ0Esc0JBQXNCLHVFQUFpQjtBQUN2QztBQUNBLG9DQUFvQyx3REFBbUIsSUFBSSw0QkFBNEI7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQywyREFBc0I7QUFDdEQsZ0JBQWdCLDJEQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDREQUFNO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsaUVBQTRCLElBQUksaUJBQWlCO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxpRUFBNEIsSUFBSSxpQkFBaUI7QUFDekY7QUFDQTtBQUNBLHdDQUF3QyxtRUFBOEI7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLDBEQUFxQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLDhEQUF5QixJQUFJO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9hY3Rpb25zL3Nob3ctaGlkZS5qcz9jZjNkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzTnVsbE9yVW5kZWZpbmVkLCByZW1vdmUgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBpdGVyYXRlQXJyYXlPck9iamVjdCwgaXNHcm91cEFkYXB0aXZlLCBpc0FjdGlvblByZXZlbnQsIGFkZFJlbW92ZUV2ZW50TGlzdGVuZXIgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0IHsgQ29sdW1uV2lkdGhTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvd2lkdGgtY29udHJvbGxlcic7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnLi4vYmFzZS9jb25zdGFudCc7XG4vKipcbiAqIFRoZSBgU2hvd0hpZGVgIG1vZHVsZSBpcyB1c2VkIHRvIGNvbnRyb2wgY29sdW1uIHZpc2liaWxpdHkuXG4gKi9cbnZhciBTaG93SGlkZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvciBmb3IgdGhlIHNob3cgaGlkZSBtb2R1bGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0lHcmlkfSBwYXJlbnQgLSBzcGVjaWZpZXMgdGhlIElHcmlkXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNob3dIaWRlKHBhcmVudCkge1xuICAgICAgICB0aGlzLmNvbE5hbWUgPSBbXTtcbiAgICAgICAgdGhpcy5pc1Nob3dIaWRlID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoKTtcbiAgICAgICAgdGhpcy53aWR0aFNlcnZpY2UgPSBuZXcgQ29sdW1uV2lkdGhTZXJ2aWNlKHBhcmVudCk7XG4gICAgfVxuICAgIFNob3dIaWRlLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV2dEhhbmRsZXJzID0gW3sgZXZlbnQ6IGV2ZW50cy5iYXRjaENhbmNlbCwgaGFuZGxlcjogdGhpcy5iYXRjaENoYW5nZXMgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50cy5iYXRjaENuZnJtRGxnQ2FuY2VsLCBoYW5kbGVyOiB0aGlzLnJlc2V0Q29sdW1uU3RhdGUgfVxuICAgICAgICBdO1xuICAgICAgICBhZGRSZW1vdmVFdmVudExpc3RlbmVyKHRoaXMucGFyZW50LCB0aGlzLmV2dEhhbmRsZXJzLCB0cnVlLCB0aGlzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBTaG93SGlkZS5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgYWRkUmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLnBhcmVudCwgdGhpcy5ldnRIYW5kbGVycywgZmFsc2UpO1xuICAgIH07XG4gICAgU2hvd0hpZGUucHJvdG90eXBlLmJhdGNoQ2hhbmdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNTaG93SGlkZSkge1xuICAgICAgICAgICAgdGhpcy5pc1Nob3dIaWRlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnNldFZpc2libGUodGhpcy5jb2xOYW1lLCB0aGlzLmNoYW5nZWRDb2wpO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VkQ29sID0gdGhpcy5jb2xOYW1lID0gW107XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNob3dzIGEgY29sdW1uIGJ5IGNvbHVtbiBuYW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfHN0cmluZ1tdfSBjb2x1bW5OYW1lIC0gRGVmaW5lcyBhIHNpbmdsZSBvciBjb2xsZWN0aW9uIG9mIGNvbHVtbiBuYW1lcyB0byBzaG93LlxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gc2hvd0J5IC0gRGVmaW5lcyB0aGUgY29sdW1uIGtleSBlaXRoZXIgYXMgZmllbGQgbmFtZSBvciBoZWFkZXIgdGV4dC5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBTaG93SGlkZS5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uIChjb2x1bW5OYW1lLCBzaG93QnkpIHtcbiAgICAgICAgdmFyIGtleXMgPSB0aGlzLmdldFRvZ2dsZUZpZWxkcyhjb2x1bW5OYW1lKTtcbiAgICAgICAgdmFyIGNvbHVtbnMgPSB0aGlzLmdldENvbHVtbnMoa2V5cywgc2hvd0J5KTtcbiAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy50b29sdGlwRGVzdHJveSwgeyBtb2R1bGU6ICdlZGl0JyB9KTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFZpc2libGUoY29sdW1ucyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBIaWRlcyBhIGNvbHVtbiBieSBjb2x1bW4gbmFtZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge3N0cmluZ3xzdHJpbmdbXX0gY29sdW1uTmFtZSAtIERlZmluZXMgYSBzaW5nbGUgb3IgY29sbGVjdGlvbiBvZiBjb2x1bW4gbmFtZXMgdG8gaGlkZS5cbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGhpZGVCeSAtIERlZmluZXMgdGhlIGNvbHVtbiBrZXkgZWl0aGVyIGFzIGZpZWxkIG5hbWUgb3IgaGVhZGVyIHRleHQuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgU2hvd0hpZGUucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoY29sdW1uTmFtZSwgaGlkZUJ5KSB7XG4gICAgICAgIHZhciBrZXlzID0gdGhpcy5nZXRUb2dnbGVGaWVsZHMoY29sdW1uTmFtZSk7XG4gICAgICAgIHZhciBjb2x1bW5zID0gdGhpcy5nZXRDb2x1bW5zKGtleXMsIGhpZGVCeSk7XG4gICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMudG9vbHRpcERlc3Ryb3ksIHsgbW9kdWxlOiAnZWRpdCcgfSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0VmlzaWJsZShjb2x1bW5zKTtcbiAgICB9O1xuICAgIFNob3dIaWRlLnByb3RvdHlwZS5nZXRUb2dnbGVGaWVsZHMgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHZhciBmaW5hbGl6ZWQgPSBbXTtcbiAgICAgICAgaWYgKHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBmaW5hbGl6ZWQgPSBba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZpbmFsaXplZCA9IGtleTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmluYWxpemVkO1xuICAgIH07XG4gICAgU2hvd0hpZGUucHJvdG90eXBlLmdldENvbHVtbnMgPSBmdW5jdGlvbiAoa2V5cywgZ2V0S2V5QnkpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNvbHVtbnMgPSBpdGVyYXRlQXJyYXlPck9iamVjdChrZXlzLCBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gaXRlcmF0ZUFycmF5T3JPYmplY3QoX3RoaXMucGFyZW50LmNvbHVtbk1vZGVsLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVtW1wiXCIgKyBnZXRLZXlCeV0gPT09IGtleSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH0pWzBdO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNvbHVtbnM7XG4gICAgfTtcbiAgICBTaG93SGlkZS5wcm90b3R5cGUuYmF0Y2hBY3Rpb25QcmV2ZW50ID0gZnVuY3Rpb24gKGNvbHVtbnMsIGNoYW5nZWRTdGF0ZUNvbHVtbnMpIHtcbiAgICAgICAgaWYgKGNoYW5nZWRTdGF0ZUNvbHVtbnMgPT09IHZvaWQgMCkgeyBjaGFuZ2VkU3RhdGVDb2x1bW5zID0gW107IH1cbiAgICAgICAgaWYgKGlzQWN0aW9uUHJldmVudCh0aGlzLnBhcmVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuY29sTmFtZSA9IGNvbHVtbnM7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZWRDb2wgPSBjaGFuZ2VkU3RhdGVDb2x1bW5zO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2xvc2VFZGl0KCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBTaG93SGlkZS5wcm90b3R5cGUucmVzZXRDb2x1bW5TdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNTaG93SGlkZSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNvbE5hbWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbE5hbWVbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUgPSAhdGhpcy5jb2xOYW1lW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTaG93cyBvciBoaWRlcyBjb2x1bW5zIGJ5IGdpdmVuIGNvbHVtbiBjb2xsZWN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0NvbHVtbltdfSBjb2x1bW5zIC0gU3BlY2lmaWVzIHRoZSBjb2x1bW5zLlxuICAgICAqIEBwYXJhbSB7Q29sdW1uW119IGNoYW5nZWRTdGF0ZUNvbHVtbnMgLSBzcGVjaWZpZXMgdGhlIGNoYW5nZWRTdGF0ZUNvbHVtbnNcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBTaG93SGlkZS5wcm90b3R5cGUuc2V0VmlzaWJsZSA9IGZ1bmN0aW9uIChjb2x1bW5zLCBjaGFuZ2VkU3RhdGVDb2x1bW5zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChjaGFuZ2VkU3RhdGVDb2x1bW5zID09PSB2b2lkIDApIHsgY2hhbmdlZFN0YXRlQ29sdW1ucyA9IFtdOyB9XG4gICAgICAgIHRoaXMuaXNTaG93SGlkZSA9IHRydWU7XG4gICAgICAgIGlmICghdGhpcy5iYXRjaEFjdGlvblByZXZlbnQoY29sdW1ucywgY2hhbmdlZFN0YXRlQ29sdW1ucykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjaGFuZ2VkU3RhdGVDb2x1bW5zID0gKGNoYW5nZWRTdGF0ZUNvbHVtbnMubGVuZ3RoID4gMCkgPyBjaGFuZ2VkU3RhdGVDb2x1bW5zIDogY29sdW1ucztcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICByZXF1ZXN0VHlwZTogJ2NvbHVtbnN0YXRlJyxcbiAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsXG4gICAgICAgICAgICBjb2x1bW5zOiBjaGFuZ2VkU3RhdGVDb2x1bW5zXG4gICAgICAgIH07XG4gICAgICAgIHZhciBjYW5jZWwgPSAnY2FuY2VsJztcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nICYmIHRoaXMucGFyZW50LmFsbG93R3JvdXBpbmdcbiAgICAgICAgICAgICYmIHRoaXMucGFyZW50Lmdyb3VwTW9kdWxlLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5jb250ZW50TW9kdWxlLnZpc2libGVSb3dzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQudHJpZ2dlcihldmVudHMuYWN0aW9uQmVnaW4sIGFyZ3MsIGZ1bmN0aW9uIChzaG93SGlkZUFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50Vmlld0NvbHMgPSBfdGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpO1xuICAgICAgICAgICAgY29sdW1ucyA9IGlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbnMpID8gY3VycmVudFZpZXdDb2xzIDogY29sdW1ucztcbiAgICAgICAgICAgIGlmIChzaG93SGlkZUFyZ3NbXCJcIiArIGNhbmNlbF0pIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5yZXNldENvbHVtbnMsIHsgc2hvd0hpZGVBcmdzOiBzaG93SGlkZUFyZ3MgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zWzBdLnZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5kZXN0cm95RWRpdEZvcm0sIGFyZ3MpO1xuICAgICAgICAgICAgaWYgKGlzR3JvdXBBZGFwdGl2ZShfdGhpcy5wYXJlbnQpKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LmNvbnRlbnRNb2R1bGUuZW1wdHlWY1Jvd3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhZGRlZFJvdyA9IF90aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWFkZGVkcm93Jyk7XG4gICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIGFkZGVkUm93KSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlKGFkZGVkUm93KTtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8IF90aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuaXNBZGROZXdSb3cgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuYWRkTmV3Um93Rm9jdXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5pc0VkaXQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuYWxsb3dTZWxlY3Rpb24gJiYgX3RoaXMucGFyZW50LmdldFNlbGVjdGVkUmVjb3JkcygpLmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgICFfdGhpcy5wYXJlbnQuc2VsZWN0aW9uU2V0dGluZ3MucGVyc2lzdFNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5jbGVhclNlbGVjdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbikge1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnJlZnJlc2hGcm96ZW5Qb3NpdGlvbiwgeyBpc01vZGVDaGc6IHRydWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmlzRnJvemVuR3JpZCgpICYmIGNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnJlZnJlc2hGcm96ZW5Qb3NpdGlvbiwgeyBpc01vZGVDaGc6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5jb2x1bW5WaXNpYmlsaXR5Q2hhbmdlZCwgY29sdW1ucyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0VHlwZTogJ2NvbHVtbnN0YXRlJyxcbiAgICAgICAgICAgICAgICBjb2x1bW5zOiBjaGFuZ2VkU3RhdGVDb2x1bW5zXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgX3RoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmFjdGlvbkNvbXBsZXRlLCBwYXJhbXMpO1xuICAgICAgICAgICAgdmFyIHN0YXJ0QWRkID0gIV90aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWFkZGVkcm93Jyk7XG4gICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIHN0YXJ0QWRkKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LmlzRWRpdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5hZGRSZWNvcmQoKTtcbiAgICAgICAgICAgICAgICBpZiAoIShfdGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gfHwgX3RoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5zaG93QWRkTmV3Um93Rm9jdXMsIHt9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmNvbHVtblF1ZXJ5TW9kZSAhPT0gJ0FsbCcpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQucmVmcmVzaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuYXV0b0ZpdCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnByZXZlbnRBZGp1c3RDb2x1bW5zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnBhcmVudC5hbGxvd1Jlc2l6aW5nICYmIHRoaXMucGFyZW50LnJlc2l6ZVNldHRpbmdzLm1vZGUgPT09ICdOb3JtYWwnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlzTWF4V2lkdGggPSB0aGlzLnBhcmVudC5nZXRIZWFkZXJUYWJsZSgpLnN0eWxlLndpZHRoLmluZGV4T2YoJ3B4JykgPT09IC0xO1xuICAgICAgICAgICAgICAgIHRoaXMud2lkdGhTZXJ2aWNlLnNldFdpZHRoVG9UYWJsZShpc01heFdpZHRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFNob3dIaWRlO1xufSgpKTtcbmV4cG9ydCB7IFNob3dIaWRlIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/show-hide.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   accessPredicate: () => (/* binding */ accessPredicate),\n/* harmony export */   actionBegin: () => (/* binding */ actionBegin),\n/* harmony export */   actionComplete: () => (/* binding */ actionComplete),\n/* harmony export */   actionFailure: () => (/* binding */ actionFailure),\n/* harmony export */   addBegin: () => (/* binding */ addBegin),\n/* harmony export */   addComplete: () => (/* binding */ addComplete),\n/* harmony export */   addDeleteAction: () => (/* binding */ addDeleteAction),\n/* harmony export */   afterContentRender: () => (/* binding */ afterContentRender),\n/* harmony export */   afterFilterColumnMenuClose: () => (/* binding */ afterFilterColumnMenuClose),\n/* harmony export */   appendInfiniteContent: () => (/* binding */ appendInfiniteContent),\n/* harmony export */   autoCol: () => (/* binding */ autoCol),\n/* harmony export */   batchAdd: () => (/* binding */ batchAdd),\n/* harmony export */   batchCancel: () => (/* binding */ batchCancel),\n/* harmony export */   batchCnfrmDlgCancel: () => (/* binding */ batchCnfrmDlgCancel),\n/* harmony export */   batchDelete: () => (/* binding */ batchDelete),\n/* harmony export */   batchEditFormRendered: () => (/* binding */ batchEditFormRendered),\n/* harmony export */   batchForm: () => (/* binding */ batchForm),\n/* harmony export */   beforeAutoFill: () => (/* binding */ beforeAutoFill),\n/* harmony export */   beforeBatchAdd: () => (/* binding */ beforeBatchAdd),\n/* harmony export */   beforeBatchCancel: () => (/* binding */ beforeBatchCancel),\n/* harmony export */   beforeBatchDelete: () => (/* binding */ beforeBatchDelete),\n/* harmony export */   beforeBatchSave: () => (/* binding */ beforeBatchSave),\n/* harmony export */   beforeCellFocused: () => (/* binding */ beforeCellFocused),\n/* harmony export */   beforeCheckboxRenderer: () => (/* binding */ beforeCheckboxRenderer),\n/* harmony export */   beforeCheckboxRendererQuery: () => (/* binding */ beforeCheckboxRendererQuery),\n/* harmony export */   beforeCheckboxfilterRenderer: () => (/* binding */ beforeCheckboxfilterRenderer),\n/* harmony export */   beforeCopy: () => (/* binding */ beforeCopy),\n/* harmony export */   beforeCustomFilterOpen: () => (/* binding */ beforeCustomFilterOpen),\n/* harmony export */   beforeDataBound: () => (/* binding */ beforeDataBound),\n/* harmony export */   beforeDetailTemplateDetach: () => (/* binding */ beforeDetailTemplateDetach),\n/* harmony export */   beforeExcelExport: () => (/* binding */ beforeExcelExport),\n/* harmony export */   beforeFltrcMenuOpen: () => (/* binding */ beforeFltrcMenuOpen),\n/* harmony export */   beforeFragAppend: () => (/* binding */ beforeFragAppend),\n/* harmony export */   beforeOpenAdaptiveDialog: () => (/* binding */ beforeOpenAdaptiveDialog),\n/* harmony export */   beforeOpenColumnChooser: () => (/* binding */ beforeOpenColumnChooser),\n/* harmony export */   beforePaste: () => (/* binding */ beforePaste),\n/* harmony export */   beforePdfExport: () => (/* binding */ beforePdfExport),\n/* harmony export */   beforePrint: () => (/* binding */ beforePrint),\n/* harmony export */   beforeRefreshOnDataChange: () => (/* binding */ beforeRefreshOnDataChange),\n/* harmony export */   beforeStartEdit: () => (/* binding */ beforeStartEdit),\n/* harmony export */   beginEdit: () => (/* binding */ beginEdit),\n/* harmony export */   bulkSave: () => (/* binding */ bulkSave),\n/* harmony export */   cBoxFltrBegin: () => (/* binding */ cBoxFltrBegin),\n/* harmony export */   cBoxFltrComplete: () => (/* binding */ cBoxFltrComplete),\n/* harmony export */   cancelBegin: () => (/* binding */ cancelBegin),\n/* harmony export */   captionActionComplete: () => (/* binding */ captionActionComplete),\n/* harmony export */   cellDeselected: () => (/* binding */ cellDeselected),\n/* harmony export */   cellDeselecting: () => (/* binding */ cellDeselecting),\n/* harmony export */   cellEdit: () => (/* binding */ cellEdit),\n/* harmony export */   cellFocused: () => (/* binding */ cellFocused),\n/* harmony export */   cellSave: () => (/* binding */ cellSave),\n/* harmony export */   cellSaved: () => (/* binding */ cellSaved),\n/* harmony export */   cellSelected: () => (/* binding */ cellSelected),\n/* harmony export */   cellSelecting: () => (/* binding */ cellSelecting),\n/* harmony export */   cellSelectionBegin: () => (/* binding */ cellSelectionBegin),\n/* harmony export */   cellSelectionComplete: () => (/* binding */ cellSelectionComplete),\n/* harmony export */   checkBoxChange: () => (/* binding */ checkBoxChange),\n/* harmony export */   checkScrollReset: () => (/* binding */ checkScrollReset),\n/* harmony export */   click: () => (/* binding */ click),\n/* harmony export */   closeBatch: () => (/* binding */ closeBatch),\n/* harmony export */   closeEdit: () => (/* binding */ closeEdit),\n/* harmony export */   closeFilterDialog: () => (/* binding */ closeFilterDialog),\n/* harmony export */   closeInline: () => (/* binding */ closeInline),\n/* harmony export */   colGroupRefresh: () => (/* binding */ colGroupRefresh),\n/* harmony export */   columnChooserCancelBtnClick: () => (/* binding */ columnChooserCancelBtnClick),\n/* harmony export */   columnChooserClose: () => (/* binding */ columnChooserClose),\n/* harmony export */   columnChooserOpened: () => (/* binding */ columnChooserOpened),\n/* harmony export */   columnChooserSearch: () => (/* binding */ columnChooserSearch),\n/* harmony export */   columnChooserUpdate: () => (/* binding */ columnChooserUpdate),\n/* harmony export */   columnDataStateChange: () => (/* binding */ columnDataStateChange),\n/* harmony export */   columnDeselected: () => (/* binding */ columnDeselected),\n/* harmony export */   columnDeselecting: () => (/* binding */ columnDeselecting),\n/* harmony export */   columnDrag: () => (/* binding */ columnDrag),\n/* harmony export */   columnDragStart: () => (/* binding */ columnDragStart),\n/* harmony export */   columnDragStop: () => (/* binding */ columnDragStop),\n/* harmony export */   columnDrop: () => (/* binding */ columnDrop),\n/* harmony export */   columnMenuClick: () => (/* binding */ columnMenuClick),\n/* harmony export */   columnMenuOpen: () => (/* binding */ columnMenuOpen),\n/* harmony export */   columnPositionChanged: () => (/* binding */ columnPositionChanged),\n/* harmony export */   columnSelected: () => (/* binding */ columnSelected),\n/* harmony export */   columnSelecting: () => (/* binding */ columnSelecting),\n/* harmony export */   columnSelectionBegin: () => (/* binding */ columnSelectionBegin),\n/* harmony export */   columnSelectionComplete: () => (/* binding */ columnSelectionComplete),\n/* harmony export */   columnVisibilityChanged: () => (/* binding */ columnVisibilityChanged),\n/* harmony export */   columnWidthChanged: () => (/* binding */ columnWidthChanged),\n/* harmony export */   columnsPrepared: () => (/* binding */ columnsPrepared),\n/* harmony export */   commandClick: () => (/* binding */ commandClick),\n/* harmony export */   commandColumnDestroy: () => (/* binding */ commandColumnDestroy),\n/* harmony export */   componentRendered: () => (/* binding */ componentRendered),\n/* harmony export */   contentReady: () => (/* binding */ contentReady),\n/* harmony export */   contextMenuClick: () => (/* binding */ contextMenuClick),\n/* harmony export */   contextMenuOpen: () => (/* binding */ contextMenuOpen),\n/* harmony export */   createVirtualValidationForm: () => (/* binding */ createVirtualValidationForm),\n/* harmony export */   created: () => (/* binding */ created),\n/* harmony export */   crudAction: () => (/* binding */ crudAction),\n/* harmony export */   customFilterClose: () => (/* binding */ customFilterClose),\n/* harmony export */   dataBound: () => (/* binding */ dataBound),\n/* harmony export */   dataReady: () => (/* binding */ dataReady),\n/* harmony export */   dataSourceChanged: () => (/* binding */ dataSourceChanged),\n/* harmony export */   dataSourceModified: () => (/* binding */ dataSourceModified),\n/* harmony export */   dataStateChange: () => (/* binding */ dataStateChange),\n/* harmony export */   dblclick: () => (/* binding */ dblclick),\n/* harmony export */   deleteBegin: () => (/* binding */ deleteBegin),\n/* harmony export */   deleteComplete: () => (/* binding */ deleteComplete),\n/* harmony export */   destroy: () => (/* binding */ destroy),\n/* harmony export */   destroyAutoFillElements: () => (/* binding */ destroyAutoFillElements),\n/* harmony export */   destroyChildGrid: () => (/* binding */ destroyChildGrid),\n/* harmony export */   destroyEditForm: () => (/* binding */ destroyEditForm),\n/* harmony export */   destroyForm: () => (/* binding */ destroyForm),\n/* harmony export */   destroyed: () => (/* binding */ destroyed),\n/* harmony export */   detachDetailTemplate: () => (/* binding */ detachDetailTemplate),\n/* harmony export */   detailDataBound: () => (/* binding */ detailDataBound),\n/* harmony export */   detailIndentCellInfo: () => (/* binding */ detailIndentCellInfo),\n/* harmony export */   detailStateChange: () => (/* binding */ detailStateChange),\n/* harmony export */   dialogDestroy: () => (/* binding */ dialogDestroy),\n/* harmony export */   doubleTap: () => (/* binding */ doubleTap),\n/* harmony export */   editBegin: () => (/* binding */ editBegin),\n/* harmony export */   editComplete: () => (/* binding */ editComplete),\n/* harmony export */   editNextValCell: () => (/* binding */ editNextValCell),\n/* harmony export */   editReset: () => (/* binding */ editReset),\n/* harmony export */   endAdd: () => (/* binding */ endAdd),\n/* harmony export */   endDelete: () => (/* binding */ endDelete),\n/* harmony export */   endEdit: () => (/* binding */ endEdit),\n/* harmony export */   enterKeyHandler: () => (/* binding */ enterKeyHandler),\n/* harmony export */   excelAggregateQueryCellInfo: () => (/* binding */ excelAggregateQueryCellInfo),\n/* harmony export */   excelExportComplete: () => (/* binding */ excelExportComplete),\n/* harmony export */   excelHeaderQueryCellInfo: () => (/* binding */ excelHeaderQueryCellInfo),\n/* harmony export */   excelQueryCellInfo: () => (/* binding */ excelQueryCellInfo),\n/* harmony export */   expandChildGrid: () => (/* binding */ expandChildGrid),\n/* harmony export */   exportDataBound: () => (/* binding */ exportDataBound),\n/* harmony export */   exportDetailDataBound: () => (/* binding */ exportDetailDataBound),\n/* harmony export */   exportDetailTemplate: () => (/* binding */ exportDetailTemplate),\n/* harmony export */   exportGroupCaption: () => (/* binding */ exportGroupCaption),\n/* harmony export */   exportRowDataBound: () => (/* binding */ exportRowDataBound),\n/* harmony export */   filterAfterOpen: () => (/* binding */ filterAfterOpen),\n/* harmony export */   filterBeforeOpen: () => (/* binding */ filterBeforeOpen),\n/* harmony export */   filterBegin: () => (/* binding */ filterBegin),\n/* harmony export */   filterCboxValue: () => (/* binding */ filterCboxValue),\n/* harmony export */   filterChoiceRequest: () => (/* binding */ filterChoiceRequest),\n/* harmony export */   filterCmenuSelect: () => (/* binding */ filterCmenuSelect),\n/* harmony export */   filterComplete: () => (/* binding */ filterComplete),\n/* harmony export */   filterDialogClose: () => (/* binding */ filterDialogClose),\n/* harmony export */   filterDialogCreated: () => (/* binding */ filterDialogCreated),\n/* harmony export */   filterMenuClose: () => (/* binding */ filterMenuClose),\n/* harmony export */   filterOpen: () => (/* binding */ filterOpen),\n/* harmony export */   filterSearchBegin: () => (/* binding */ filterSearchBegin),\n/* harmony export */   fltrPrevent: () => (/* binding */ fltrPrevent),\n/* harmony export */   foreignKeyData: () => (/* binding */ foreignKeyData),\n/* harmony export */   freezeRefresh: () => (/* binding */ freezeRefresh),\n/* harmony export */   freezeRender: () => (/* binding */ freezeRender),\n/* harmony export */   frozenHeight: () => (/* binding */ frozenHeight),\n/* harmony export */   generateQuery: () => (/* binding */ generateQuery),\n/* harmony export */   getAggregateQuery: () => (/* binding */ getAggregateQuery),\n/* harmony export */   getFilterBarOperator: () => (/* binding */ getFilterBarOperator),\n/* harmony export */   getForeignKeyData: () => (/* binding */ getForeignKeyData),\n/* harmony export */   getVirtualData: () => (/* binding */ getVirtualData),\n/* harmony export */   groupAggregates: () => (/* binding */ groupAggregates),\n/* harmony export */   groupBegin: () => (/* binding */ groupBegin),\n/* harmony export */   groupCollapse: () => (/* binding */ groupCollapse),\n/* harmony export */   groupComplete: () => (/* binding */ groupComplete),\n/* harmony export */   headerCellInfo: () => (/* binding */ headerCellInfo),\n/* harmony export */   headerDrop: () => (/* binding */ headerDrop),\n/* harmony export */   headerRefreshed: () => (/* binding */ headerRefreshed),\n/* harmony export */   hierarchyPrint: () => (/* binding */ hierarchyPrint),\n/* harmony export */   immutableBatchCancel: () => (/* binding */ immutableBatchCancel),\n/* harmony export */   inBoundModelChanged: () => (/* binding */ inBoundModelChanged),\n/* harmony export */   infiniteCrudCancel: () => (/* binding */ infiniteCrudCancel),\n/* harmony export */   infiniteEditHandler: () => (/* binding */ infiniteEditHandler),\n/* harmony export */   infinitePageQuery: () => (/* binding */ infinitePageQuery),\n/* harmony export */   infiniteScrollComplete: () => (/* binding */ infiniteScrollComplete),\n/* harmony export */   infiniteScrollHandler: () => (/* binding */ infiniteScrollHandler),\n/* harmony export */   infiniteShowHide: () => (/* binding */ infiniteShowHide),\n/* harmony export */   initForeignKeyColumn: () => (/* binding */ initForeignKeyColumn),\n/* harmony export */   initialCollapse: () => (/* binding */ initialCollapse),\n/* harmony export */   initialEnd: () => (/* binding */ initialEnd),\n/* harmony export */   initialLoad: () => (/* binding */ initialLoad),\n/* harmony export */   keyPressed: () => (/* binding */ keyPressed),\n/* harmony export */   lastRowCellBorderUpdated: () => (/* binding */ lastRowCellBorderUpdated),\n/* harmony export */   lazyLoadGroupCollapse: () => (/* binding */ lazyLoadGroupCollapse),\n/* harmony export */   lazyLoadGroupExpand: () => (/* binding */ lazyLoadGroupExpand),\n/* harmony export */   lazyLoadScrollHandler: () => (/* binding */ lazyLoadScrollHandler),\n/* harmony export */   load: () => (/* binding */ load),\n/* harmony export */   modelChanged: () => (/* binding */ modelChanged),\n/* harmony export */   nextCellIndex: () => (/* binding */ nextCellIndex),\n/* harmony export */   onEmpty: () => (/* binding */ onEmpty),\n/* harmony export */   onResize: () => (/* binding */ onResize),\n/* harmony export */   pageBegin: () => (/* binding */ pageBegin),\n/* harmony export */   pageComplete: () => (/* binding */ pageComplete),\n/* harmony export */   pagerRefresh: () => (/* binding */ pagerRefresh),\n/* harmony export */   partialRefresh: () => (/* binding */ partialRefresh),\n/* harmony export */   pdfAggregateQueryCellInfo: () => (/* binding */ pdfAggregateQueryCellInfo),\n/* harmony export */   pdfExportComplete: () => (/* binding */ pdfExportComplete),\n/* harmony export */   pdfHeaderQueryCellInfo: () => (/* binding */ pdfHeaderQueryCellInfo),\n/* harmony export */   pdfQueryCellInfo: () => (/* binding */ pdfQueryCellInfo),\n/* harmony export */   preventBatch: () => (/* binding */ preventBatch),\n/* harmony export */   preventFrozenScrollRefresh: () => (/* binding */ preventFrozenScrollRefresh),\n/* harmony export */   printComplete: () => (/* binding */ printComplete),\n/* harmony export */   printGridInit: () => (/* binding */ printGridInit),\n/* harmony export */   queryCellInfo: () => (/* binding */ queryCellInfo),\n/* harmony export */   recordAdded: () => (/* binding */ recordAdded),\n/* harmony export */   recordClick: () => (/* binding */ recordClick),\n/* harmony export */   recordDoubleClick: () => (/* binding */ recordDoubleClick),\n/* harmony export */   refreshAggregateCell: () => (/* binding */ refreshAggregateCell),\n/* harmony export */   refreshAggregates: () => (/* binding */ refreshAggregates),\n/* harmony export */   refreshComplete: () => (/* binding */ refreshComplete),\n/* harmony export */   refreshCustomFilterClearBtn: () => (/* binding */ refreshCustomFilterClearBtn),\n/* harmony export */   refreshCustomFilterOkBtn: () => (/* binding */ refreshCustomFilterOkBtn),\n/* harmony export */   refreshExpandandCollapse: () => (/* binding */ refreshExpandandCollapse),\n/* harmony export */   refreshFooterRenderer: () => (/* binding */ refreshFooterRenderer),\n/* harmony export */   refreshFrozenColumns: () => (/* binding */ refreshFrozenColumns),\n/* harmony export */   refreshFrozenHeight: () => (/* binding */ refreshFrozenHeight),\n/* harmony export */   refreshFrozenPosition: () => (/* binding */ refreshFrozenPosition),\n/* harmony export */   refreshHandlers: () => (/* binding */ refreshHandlers),\n/* harmony export */   refreshInfiniteCurrentViewData: () => (/* binding */ refreshInfiniteCurrentViewData),\n/* harmony export */   refreshInfiniteEditrowindex: () => (/* binding */ refreshInfiniteEditrowindex),\n/* harmony export */   refreshInfiniteModeBlocks: () => (/* binding */ refreshInfiniteModeBlocks),\n/* harmony export */   refreshInfinitePersistSelection: () => (/* binding */ refreshInfinitePersistSelection),\n/* harmony export */   refreshResizePosition: () => (/* binding */ refreshResizePosition),\n/* harmony export */   refreshSplitFrozenColumn: () => (/* binding */ refreshSplitFrozenColumn),\n/* harmony export */   refreshVirtualBlock: () => (/* binding */ refreshVirtualBlock),\n/* harmony export */   refreshVirtualCache: () => (/* binding */ refreshVirtualCache),\n/* harmony export */   refreshVirtualEditFormCells: () => (/* binding */ refreshVirtualEditFormCells),\n/* harmony export */   refreshVirtualFrozenHeight: () => (/* binding */ refreshVirtualFrozenHeight),\n/* harmony export */   refreshVirtualFrozenRows: () => (/* binding */ refreshVirtualFrozenRows),\n/* harmony export */   refreshVirtualLazyLoadCache: () => (/* binding */ refreshVirtualLazyLoadCache),\n/* harmony export */   refreshVirtualMaxPage: () => (/* binding */ refreshVirtualMaxPage),\n/* harmony export */   removeInfiniteRows: () => (/* binding */ removeInfiniteRows),\n/* harmony export */   renderResponsiveChangeAction: () => (/* binding */ renderResponsiveChangeAction),\n/* harmony export */   renderResponsiveCmenu: () => (/* binding */ renderResponsiveCmenu),\n/* harmony export */   renderResponsiveColumnChooserDiv: () => (/* binding */ renderResponsiveColumnChooserDiv),\n/* harmony export */   reorderBegin: () => (/* binding */ reorderBegin),\n/* harmony export */   reorderComplete: () => (/* binding */ reorderComplete),\n/* harmony export */   resetColumns: () => (/* binding */ resetColumns),\n/* harmony export */   resetInfiniteBlocks: () => (/* binding */ resetInfiniteBlocks),\n/* harmony export */   resetVirtualFocus: () => (/* binding */ resetVirtualFocus),\n/* harmony export */   resizeStart: () => (/* binding */ resizeStart),\n/* harmony export */   resizeStop: () => (/* binding */ resizeStop),\n/* harmony export */   restoreFocus: () => (/* binding */ restoreFocus),\n/* harmony export */   rowDataBound: () => (/* binding */ rowDataBound),\n/* harmony export */   rowDeselected: () => (/* binding */ rowDeselected),\n/* harmony export */   rowDeselecting: () => (/* binding */ rowDeselecting),\n/* harmony export */   rowDrag: () => (/* binding */ rowDrag),\n/* harmony export */   rowDragAndDrop: () => (/* binding */ rowDragAndDrop),\n/* harmony export */   rowDragAndDropBegin: () => (/* binding */ rowDragAndDropBegin),\n/* harmony export */   rowDragAndDropComplete: () => (/* binding */ rowDragAndDropComplete),\n/* harmony export */   rowDragStart: () => (/* binding */ rowDragStart),\n/* harmony export */   rowDragStartHelper: () => (/* binding */ rowDragStartHelper),\n/* harmony export */   rowDrop: () => (/* binding */ rowDrop),\n/* harmony export */   rowModeChange: () => (/* binding */ rowModeChange),\n/* harmony export */   rowPositionChanged: () => (/* binding */ rowPositionChanged),\n/* harmony export */   rowSelected: () => (/* binding */ rowSelected),\n/* harmony export */   rowSelecting: () => (/* binding */ rowSelecting),\n/* harmony export */   rowSelectionBegin: () => (/* binding */ rowSelectionBegin),\n/* harmony export */   rowSelectionComplete: () => (/* binding */ rowSelectionComplete),\n/* harmony export */   rowsAdded: () => (/* binding */ rowsAdded),\n/* harmony export */   rowsRemoved: () => (/* binding */ rowsRemoved),\n/* harmony export */   rtlUpdated: () => (/* binding */ rtlUpdated),\n/* harmony export */   saveComplete: () => (/* binding */ saveComplete),\n/* harmony export */   scroll: () => (/* binding */ scroll),\n/* harmony export */   scrollToEdit: () => (/* binding */ scrollToEdit),\n/* harmony export */   searchBegin: () => (/* binding */ searchBegin),\n/* harmony export */   searchComplete: () => (/* binding */ searchComplete),\n/* harmony export */   selectRowOnContextOpen: () => (/* binding */ selectRowOnContextOpen),\n/* harmony export */   selectVirtualRow: () => (/* binding */ selectVirtualRow),\n/* harmony export */   setFreezeSelection: () => (/* binding */ setFreezeSelection),\n/* harmony export */   setFullScreenDialog: () => (/* binding */ setFullScreenDialog),\n/* harmony export */   setGroupCache: () => (/* binding */ setGroupCache),\n/* harmony export */   setHeightToFrozenElement: () => (/* binding */ setHeightToFrozenElement),\n/* harmony export */   setInfiniteCache: () => (/* binding */ setInfiniteCache),\n/* harmony export */   setInfiniteColFrozenHeight: () => (/* binding */ setInfiniteColFrozenHeight),\n/* harmony export */   setInfiniteFrozenHeight: () => (/* binding */ setInfiniteFrozenHeight),\n/* harmony export */   setReorderDestinationElement: () => (/* binding */ setReorderDestinationElement),\n/* harmony export */   setVirtualPageQuery: () => (/* binding */ setVirtualPageQuery),\n/* harmony export */   showAddNewRowFocus: () => (/* binding */ showAddNewRowFocus),\n/* harmony export */   showEmptyGrid: () => (/* binding */ showEmptyGrid),\n/* harmony export */   sortBegin: () => (/* binding */ sortBegin),\n/* harmony export */   sortComplete: () => (/* binding */ sortComplete),\n/* harmony export */   stickyScrollComplete: () => (/* binding */ stickyScrollComplete),\n/* harmony export */   textWrapRefresh: () => (/* binding */ textWrapRefresh),\n/* harmony export */   toolbarClick: () => (/* binding */ toolbarClick),\n/* harmony export */   toolbarRefresh: () => (/* binding */ toolbarRefresh),\n/* harmony export */   tooltipDestroy: () => (/* binding */ tooltipDestroy),\n/* harmony export */   uiUpdate: () => (/* binding */ uiUpdate),\n/* harmony export */   ungroupBegin: () => (/* binding */ ungroupBegin),\n/* harmony export */   ungroupComplete: () => (/* binding */ ungroupComplete),\n/* harmony export */   updateData: () => (/* binding */ updateData),\n/* harmony export */   valCustomPlacement: () => (/* binding */ valCustomPlacement),\n/* harmony export */   validateVirtualForm: () => (/* binding */ validateVirtualForm),\n/* harmony export */   virtaulCellFocus: () => (/* binding */ virtaulCellFocus),\n/* harmony export */   virtaulKeyHandler: () => (/* binding */ virtaulKeyHandler),\n/* harmony export */   virtualScrollAddActionBegin: () => (/* binding */ virtualScrollAddActionBegin),\n/* harmony export */   virtualScrollEdit: () => (/* binding */ virtualScrollEdit),\n/* harmony export */   virtualScrollEditActionBegin: () => (/* binding */ virtualScrollEditActionBegin),\n/* harmony export */   virtualScrollEditCancel: () => (/* binding */ virtualScrollEditCancel),\n/* harmony export */   virtualScrollEditSuccess: () => (/* binding */ virtualScrollEditSuccess)\n/* harmony export */ });\n/** @hidden */\nvar created = 'create';\n/** @hidden */\nvar destroyed = 'destroy';\n/** @hidden */\nvar load = 'load';\n/** @hidden */\nvar rowDataBound = 'rowDataBound';\n/** @hidden */\nvar queryCellInfo = 'queryCellInfo';\n/** @hidden */\nvar headerCellInfo = 'headerCellInfo';\n/** @hidden */\nvar actionBegin = 'actionBegin';\n/** @hidden */\nvar actionComplete = 'actionComplete';\n/** @hidden */\nvar actionFailure = 'actionFailure';\n/** @hidden */\nvar dataBound = 'dataBound';\n/** @hidden */\nvar rowSelecting = 'rowSelecting';\n/** @hidden */\nvar rowSelected = 'rowSelected';\n/** @hidden */\nvar rowDeselecting = 'rowDeselecting';\n/** @hidden */\nvar rowDeselected = 'rowDeselected';\n/** @hidden */\nvar cellSelecting = 'cellSelecting';\n/** @hidden */\nvar cellSelected = 'cellSelected';\n/** @hidden */\nvar cellDeselecting = 'cellDeselecting';\n/** @hidden */\nvar cellDeselected = 'cellDeselected';\n/** @hidden */\nvar columnSelecting = 'columnSelecting';\n/** @hidden */\nvar columnSelected = 'columnSelected';\n/** @hidden */\nvar columnDeselecting = 'columnDeselecting';\n/** @hidden */\nvar columnDeselected = 'columnDeselected';\n/** @hidden */\nvar columnDragStart = 'columnDragStart';\n/** @hidden */\nvar columnDrag = 'columnDrag';\n/** @hidden */\nvar columnDrop = 'columnDrop';\n/** @hidden */\nvar rowDragStartHelper = 'rowDragStartHelper';\n/** @hidden */\nvar rowDragStart = 'rowDragStart';\n/** @hidden */\nvar rowDrag = 'rowDrag';\n/** @hidden */\nvar rowDrop = 'rowDrop';\n/** @hidden */\nvar beforePrint = 'beforePrint';\n/** @hidden */\nvar printComplete = 'printComplete';\n/** @hidden */\nvar detailDataBound = 'detailDataBound';\n/** @hidden */\nvar toolbarClick = 'toolbarClick';\n/** @hidden */\nvar batchAdd = 'batchAdd';\n/** @hidden */\nvar batchCancel = 'batchCancel';\n/** @hidden */\nvar batchDelete = 'batchDelete';\n/** @hidden */\nvar beforeBatchAdd = 'beforeBatchAdd';\n/** @hidden */\nvar beforeBatchDelete = 'beforeBatchDelete';\n/** @hidden */\nvar beforeBatchSave = 'beforeBatchSave';\n/** @hidden */\nvar beginEdit = 'beginEdit';\n/** @hidden */\nvar cellEdit = 'cellEdit';\n/** @hidden */\nvar cellSave = 'cellSave';\n/** @hidden */\nvar cellSaved = 'cellSaved';\n/** @hidden */\nvar endAdd = 'endAdd';\n/** @hidden */\nvar endDelete = 'endDelete';\n/** @hidden */\nvar endEdit = 'endEdit';\n/** @hidden */\nvar recordDoubleClick = 'recordDoubleClick';\n/** @hidden */\nvar recordClick = 'recordClick';\n/** @hidden */\nvar beforeDataBound = 'beforeDataBound';\n/** @hidden */\nvar beforeOpenColumnChooser = 'beforeOpenColumnChooser';\n/** @hidden */\nvar beforeOpenAdaptiveDialog = 'beforeOpenAdaptiveDialog';\n/** @hidden */\nvar resizeStart = 'resizeStart';\n/** @hidden */\nvar onResize = 'resizing';\n/** @hidden */\nvar resizeStop = 'resizeStop';\n/** @hidden */\nvar checkBoxChange = 'checkBoxChange';\n/** @hidden */\nvar beforeCopy = 'beforeCopy';\n/** @hidden */\nvar beforePaste = 'beforePaste';\n/** @hidden */\nvar beforeAutoFill = 'beforeAutoFill';\n/** @hidden */\nvar filterChoiceRequest = 'filterchoicerequest';\n/** @hidden */\nvar filterAfterOpen = 'filterAfterOpen';\n/** @hidden */\nvar filterBeforeOpen = 'filterBeforeOpen';\n/** @hidden */\nvar filterSearchBegin = 'filterSearchBegin';\n/** @hidden */\nvar commandClick = 'commandClick';\n/** @hidden */\nvar exportGroupCaption = 'exportGroupCaption';\n/** @hidden */\nvar lazyLoadGroupExpand = 'lazyLoadGroupExpand';\n/** @hidden */\nvar lazyLoadGroupCollapse = 'lazyLoadGroupCollapse';\n/**\n * Specifies grid internal events\n */\n/** @hidden */\nvar initialLoad = 'initial-load';\n/** @hidden */\nvar initialEnd = 'initial-end';\n/** @hidden */\nvar dataReady = 'data-ready';\n/** @hidden */\nvar contentReady = 'content-ready';\n/** @hidden */\nvar uiUpdate = 'ui-update';\n/** @hidden */\nvar onEmpty = 'on-empty';\n/** @hidden */\nvar inBoundModelChanged = 'inbound-model-changed';\n/** @hidden */\nvar modelChanged = 'model-changed';\n/** @hidden */\nvar colGroupRefresh = 'colgroup-refresh';\n/** @hidden */\nvar headerRefreshed = 'header-refreshed';\n/** @hidden */\nvar pageBegin = 'paging-begin';\n/** @hidden */\nvar pageComplete = 'paging-complete';\n/** @hidden */\nvar sortBegin = 'sorting-begin';\n/** @hidden */\nvar sortComplete = 'sorting-complete';\n/** @hidden */\nvar filterBegin = 'filtering-begin';\n/** @hidden */\nvar filterComplete = 'filtering-complete';\n/** @hidden */\nvar searchBegin = 'searching-begin';\n/** @hidden */\nvar searchComplete = 'searching-complete';\n/** @hidden */\nvar reorderBegin = 'reorder-begin';\n/** @hidden */\nvar reorderComplete = 'reorder-complete';\n/** @hidden */\nvar rowDragAndDropBegin = 'rowdraganddrop-begin';\n/** @hidden */\nvar rowDragAndDropComplete = 'rowdraganddrop-complete';\n/** @hidden */\nvar groupBegin = 'grouping-begin';\n/** @hidden */\nvar groupComplete = 'grouping-complete';\n/** @hidden */\nvar ungroupBegin = 'ungrouping-begin';\n/** @hidden */\nvar ungroupComplete = 'ungrouping-complete';\n/** @hidden */\nvar groupAggregates = 'group-aggregates';\n/** @hidden */\nvar refreshFooterRenderer = 'refresh-footer-rendered';\n/** @hidden */\nvar refreshAggregateCell = 'refresh-aggregate-cell';\n/** @hidden */\nvar refreshAggregates = 'refresh-aggregates';\n/** @hidden */\nvar rowSelectionBegin = 'rowselecting';\n/** @hidden */\nvar rowSelectionComplete = 'rowselected';\n/** @hidden */\nvar columnSelectionBegin = 'columnselecting';\n/** @hidden */\nvar columnSelectionComplete = 'columnselected';\n/** @hidden */\nvar cellSelectionBegin = 'cellselecting';\n/** @hidden */\nvar cellSelectionComplete = 'cellselected';\n/** @hidden */\nvar destroyAutoFillElements = 'destroy-autofill-elements';\n/** @hidden */\nvar beforeCellFocused = 'beforecellfocused';\n/** @hidden */\nvar cellFocused = 'cellfocused';\n/** @hidden */\nvar keyPressed = 'key-pressed';\n/** @hidden */\nvar click = 'click';\n/** @hidden */\nvar destroy = 'destroy';\n/** @hidden */\nvar columnVisibilityChanged = 'column-visible-changed';\n/** @hidden */\nvar scroll = 'scroll';\n/** @hidden */\nvar columnWidthChanged = 'column-width-changed';\n/** @hidden */\nvar columnPositionChanged = 'column-position-changed';\n/** @hidden */\nvar rowDragAndDrop = 'row-drag-and-drop';\n/** @hidden */\nvar rowsAdded = 'rows-added';\n/** @hidden */\nvar rowsRemoved = 'rows-removed';\n/** @hidden */\nvar columnDragStop = 'column-drag-stop';\n/** @hidden */\nvar headerDrop = 'header-drop';\n/** @hidden */\nvar dataSourceModified = 'datasource-modified';\n/** @hidden */\nvar refreshComplete = 'refresh-complete';\n/** @hidden */\nvar refreshVirtualBlock = 'refresh-virtual-block';\n/** @hidden */\nvar dblclick = 'dblclick';\n/** @hidden */\nvar toolbarRefresh = 'toolbar-refresh';\n/** @hidden */\nvar bulkSave = 'bulk-save';\n/** @hidden */\nvar autoCol = 'auto-col';\n/** @hidden */\nvar tooltipDestroy = 'tooltip-destroy';\n/** @hidden */\nvar updateData = 'update-data';\n/** @hidden */\nvar editBegin = 'edit-begin';\n/** @hidden */\nvar editComplete = 'edit-complete';\n/** @hidden */\nvar addBegin = 'add-begin';\n/** @hidden */\nvar addComplete = 'add-complete';\n/** @hidden */\nvar saveComplete = 'save-complete';\n/** @hidden */\nvar deleteBegin = 'delete-begin';\n/** @hidden */\nvar deleteComplete = 'delete-complete';\n/** @hidden */\nvar preventBatch = 'prevent-batch';\n/** @hidden */\nvar dialogDestroy = 'dialog-destroy';\n/** @hidden */\nvar crudAction = 'crud-Action';\n/** @hidden */\nvar addDeleteAction = 'add-delete-Action';\n/** @hidden */\nvar destroyForm = 'destroy-form';\n/** @hidden */\nvar doubleTap = 'double-tap';\n/** @hidden */\nvar beforeExcelExport = 'beforeExcelExport';\n/** @hidden */\nvar excelExportComplete = 'excelExportComplete';\n/** @hidden */\nvar excelQueryCellInfo = 'excelQueryCellInfo';\n/** @hidden */\nvar excelHeaderQueryCellInfo = 'excelHeaderQueryCellInfo';\n/** @hidden */\nvar exportDetailDataBound = 'exportDetailDataBound';\n/** @hidden */\nvar exportDetailTemplate = 'exportDetailTemplate';\n/** @hidden */\nvar beforePdfExport = 'beforePdfExport';\n/** @hidden */\nvar pdfExportComplete = 'pdfExportComplete';\n/** @hidden */\nvar pdfQueryCellInfo = 'pdfQueryCellInfo';\n/** @hidden */\nvar pdfHeaderQueryCellInfo = 'pdfHeaderQueryCellInfo';\n/** @hidden */\nvar accessPredicate = 'access-predicate';\n/** @hidden */\nvar contextMenuClick = 'contextMenuClick';\n/** @hidden */\nvar freezeRender = 'freezerender';\n/** @hidden */\nvar freezeRefresh = 'freezerefresh';\n/** @hidden */\nvar contextMenuOpen = 'contextMenuOpen';\n/** @hidden */\nvar columnMenuClick = 'columnMenuClick';\n/** @hidden */\nvar columnMenuOpen = 'columnMenuOpen';\n/** @hidden */\nvar filterOpen = 'filterOpen';\n/** @hidden */\nvar filterDialogCreated = 'filterDialogCreated';\n/** @hidden */\nvar filterMenuClose = 'filter-menu-close';\n/** @hidden */\nvar initForeignKeyColumn = 'initForeignKeyColumn';\n/** @hidden */\nvar getForeignKeyData = 'getForeignKeyData';\n/** @hidden */\nvar generateQuery = 'generateQuery';\n/** @hidden */\nvar showEmptyGrid = 'showEmptyGrid';\n/** @hidden */\nvar foreignKeyData = 'foreignKeyData';\n/** @hidden */\nvar columnDataStateChange = 'columnDataStateChange';\n/** @hidden */\nvar dataStateChange = 'dataStateChange';\n/** @hidden */\nvar dataSourceChanged = 'dataSourceChanged';\n/** @hidden */\nvar rtlUpdated = 'rtl-updated';\n/** @hidden */\nvar beforeFragAppend = 'beforeFragAppend';\n/** @hidden */\nvar frozenHeight = 'frozenHeight';\n/** @hidden */\nvar textWrapRefresh = 'textWrapRefresh';\n/** @hidden */\nvar recordAdded = 'recordAdded';\n/** @hidden */\nvar cancelBegin = 'cancel-Begin';\n/** @hidden */\nvar editNextValCell = 'editNextValCell';\n/** @hidden */\nvar hierarchyPrint = 'hierarchyprint';\n/** @hidden */\nvar expandChildGrid = 'expandchildgrid';\n/** @hidden */\nvar printGridInit = 'printGrid-Init';\n/** @hidden */\nvar exportRowDataBound = 'export-RowDataBound';\n/** @hidden */\nvar exportDataBound = 'export-DataBound';\n/** @hidden */\nvar rowPositionChanged = 'row-position-changed';\n/** @hidden */\nvar columnChooserOpened = 'columnChooserOpened';\n/** @hidden */\nvar batchForm = 'batchedit-form';\n/** @hidden */\nvar beforeStartEdit = 'edit-form';\n/** @hidden */\nvar beforeBatchCancel = 'before-batch-cancel';\n/** @hidden */\nvar batchEditFormRendered = 'batcheditform-rendered';\n/** @hidden */\nvar partialRefresh = 'partial-refresh';\n/** @hidden */\nvar beforeCustomFilterOpen = 'beforeCustomFilterOpen';\n/** @hidden */\nvar selectVirtualRow = 'select-virtual-Row';\n/** @hidden */\nvar columnsPrepared = 'columns-prepared';\n/** @hidden */\nvar cBoxFltrBegin = 'cbox-filter-begin';\n/** @hidden */\nvar cBoxFltrComplete = 'cbox-filter-complete';\n/** @hidden */\nvar fltrPrevent = 'filter-Prevent';\n/** @hidden */\nvar beforeFltrcMenuOpen = 'before-filter-cmenu-open';\n/** @hidden */\nvar valCustomPlacement = 'validation-custom-placement';\n/** @hidden */\nvar filterCboxValue = 'filter-cbox-value';\n/** @hidden */\nvar componentRendered = 'component-rendered';\n/** @hidden */\nvar restoreFocus = 'restore-Focus';\n/** @hidden */\nvar detailStateChange = 'detail-state-change';\n/** @hidden */\nvar detailIndentCellInfo = 'detail-indentcell-info';\n/** @hidden */\nvar virtaulKeyHandler = 'virtaul-key-handler';\n/** @hidden */\nvar virtaulCellFocus = 'virtaul-cell-focus';\n/** @hidden */\nvar virtualScrollEditActionBegin = 'virtual-scroll-edit-action-begin';\n/** @hidden */\nvar virtualScrollEditSuccess = 'virtual-scroll-edit-success';\n/** @hidden */\nvar virtualScrollEditCancel = 'virtual-scroll-edit-cancel';\n/** @hidden */\nvar virtualScrollEdit = 'virtual-scroll-edit';\n/** @hidden */\nvar refreshVirtualCache = 'refresh-virtual-cache';\n/** @hidden */\nvar editReset = 'edit-reset';\n/** @hidden */\nvar virtualScrollAddActionBegin = 'virtual-scroll-add-action-begin';\n/** @hidden */\nvar getVirtualData = 'get-virtual-data';\n/** @hidden */\nvar refreshInfiniteModeBlocks = 'refresh-infinite-mode-blocks';\n/** @hidden */\nvar resetInfiniteBlocks = 'reset-infinite-blocks';\n/** @hidden */\nvar infiniteScrollHandler = 'infinite-scroll-handler';\n/** @hidden */\nvar infinitePageQuery = 'infinite-page-query';\n/** @hidden */\nvar infiniteShowHide = 'infinite-show-hide';\n/** @hidden */\nvar appendInfiniteContent = 'append-infinite-content';\n/** @hidden */\nvar removeInfiniteRows = 'remove-infinite-rows';\n/** @hidden */\nvar setInfiniteCache = 'set-infinite-cache';\n/** @hidden */\nvar infiniteEditHandler = 'infinite-edit-handler';\n/** @hidden */\nvar initialCollapse = 'initial-collapse';\n/** @hidden */\nvar getAggregateQuery = 'get-aggregate-query';\n/** @hidden */\nvar closeFilterDialog = 'close-filter-dialog';\n/** @hidden */\nvar columnChooserCancelBtnClick = 'columnChooserCancelBtnClick';\n/** @hidden */\nvar getFilterBarOperator = 'get-filterbar-operator';\n/** @hidden */\nvar resetColumns = 'reset-columns';\n/** @hidden */\nvar pdfAggregateQueryCellInfo = 'pdfAggregateQueryCellInfo';\n/** @hidden */\nvar excelAggregateQueryCellInfo = 'excelAggregateQueryCellInfo';\n/** @hidden */\nvar setGroupCache = 'group-cache';\n/** @hidden */\nvar lazyLoadScrollHandler = 'lazy-load-scroll-handler';\n/** @hidden */\nvar groupCollapse = 'group-collapse';\n/** @hidden */\nvar beforeCheckboxRenderer = 'beforeCheckboxRenderer';\n/** @hidden */\nvar refreshHandlers = 'refreshResizeHandlers';\n/** @hidden */\nvar refreshFrozenColumns = 'refresh-frozen-columns';\n/** @hidden */\nvar setReorderDestinationElement = 'set-reorder-destination-element';\n/** @hidden */\nvar refreshVirtualFrozenHeight = 'refresh-virtual-frozen-height';\n/** @hidden */\nvar setFreezeSelection = 'set-freeze-selection';\n/** @hidden */\nvar setInfiniteFrozenHeight = 'set-infinite-frozen-height';\n/** @hidden */\nvar setInfiniteColFrozenHeight = 'set-infinite-col-frozen-height';\n/** @hidden */\nvar beforeRefreshOnDataChange = 'before-refresh-on-data-change';\n/** @hidden */\nvar immutableBatchCancel = 'immutable-batch-cancel';\n/** @hidden */\nvar refreshVirtualFrozenRows = 'refresh-virtual-frozenrows';\n/** @hidden */\nvar checkScrollReset = 'check-scroll-reset';\n/** @hidden */\nvar refreshFrozenHeight = 'refresh-frozen-height';\n/** @hidden */\nvar setHeightToFrozenElement = 'set-height-to-frozen-element';\n/** @hidden */\nvar preventFrozenScrollRefresh = 'prevent-frozen-scroll-refresh';\n/** @hidden */\nvar nextCellIndex = 'next-cell-index';\n/** @hidden */\nvar refreshInfiniteCurrentViewData = 'refresh-infinite-current-view-data';\n/** @hidden */\nvar infiniteCrudCancel = 'infinite-crud-cancel';\n/** @hidden */\nvar filterDialogClose = 'filter-dialog-close';\n/** @hidden */\nvar refreshCustomFilterOkBtn = 'refresh-cutsom-filter-ok-button';\n/** @hidden */\nvar refreshCustomFilterClearBtn = 'refresh-cutsom-filter-clear-button';\n/** @hidden */\nvar renderResponsiveCmenu = 'render-responsive-cmenu';\n/** @hidden */\nvar filterCmenuSelect = 'filter-cmenu-select';\n/** @hidden */\nvar customFilterClose = 'custom-filter-close';\n/** @hidden */\nvar setFullScreenDialog = 'set-fullscreen-dialog';\n/** @hidden */\nvar refreshExpandandCollapse = 'refresh-Expand-and-Collapse';\n/** @hidden */\nvar rowModeChange = 'row-mode-change';\n/** @hidden */\nvar enterKeyHandler = 'enter-key-handler';\n/** @hidden */\nvar refreshVirtualMaxPage = 'refresh-virtual-max-page';\n/** @hidden */\nvar setVirtualPageQuery = 'set-virtual-page-query';\n/** @hidden */\nvar selectRowOnContextOpen = 'select-row-on-context-open';\n/** @hidden */\nvar pagerRefresh = 'pager-refresh';\n/** @hidden */\nvar closeInline = 'closeinline';\n/** @hidden */\nvar closeBatch = 'closebatch';\n/** @hidden */\nvar closeEdit = 'close-edit';\n/** @hidden */\nvar resetVirtualFocus = 'reset-virtual-focus';\n/** @hidden */\nvar afterContentRender = 'after-content-renderer';\n/** @hidden */\nvar refreshVirtualEditFormCells = 'refresh-virtual-editform-cells';\n/** @hidden */\nvar scrollToEdit = 'scroll-to-edit';\n/** @hidden */\nvar beforeCheckboxRendererQuery = 'before-checkbox-renderer-query';\n/** @hidden */\nvar createVirtualValidationForm = 'create-virtual-validation-form';\n/** @hidden */\nvar validateVirtualForm = 'validate-virtual-form';\n/** @hidden */\nvar destroyChildGrid = 'destroy-child-grid';\n/** @hidden */\nvar stickyScrollComplete = 'sticky-scroll-complete';\n/** @hidden */\nvar captionActionComplete = 'infinite-group-collapse';\n/** @hidden */\nvar refreshInfinitePersistSelection = 'refresh-infinite-persist-selection';\n/** @hidden */\nvar refreshInfiniteEditrowindex = 'refresh-infinite-editrowindex';\n/** @hidden */\nvar afterFilterColumnMenuClose = 'after-filter-column-menu-close';\n/** @hidden */\nvar beforeCheckboxfilterRenderer = 'beforeCheckboxfilterRenderer';\n/** @hidden */\nvar commandColumnDestroy = 'commandColumnDestroy';\n/** @hidden */\nvar batchCnfrmDlgCancel = 'cancelcnfrmDlg';\n/** @hidden */\nvar refreshVirtualLazyLoadCache = 'refresh-Virtual-LazyLoad-Cache';\n/** @hidden */\nvar refreshFrozenPosition = 'refresh-Frozen-Position';\n/** @hidden */\nvar refreshResizePosition = 'refresh-Resize-Position';\n/** @hidden */\nvar refreshSplitFrozenColumn = 'refresh-Split-Frozen-Column';\n/** @hidden */\nvar renderResponsiveChangeAction = 'render-Responsive-Change-Action';\n/** @hidden */\nvar renderResponsiveColumnChooserDiv = 'render-Responsive-Column-Chooser-Div';\n/** @hidden */\nvar showAddNewRowFocus = 'show-Add-New-Row-Focus';\n/** @hidden */\nvar infiniteScrollComplete = 'infinitescroll-complete';\n/** @hidden */\nvar lastRowCellBorderUpdated = 'last-rowcell-border-updated';\n/** @hidden */\nvar columnChooserSearch = 'columnChooserSearch';\n/** @hidden */\nvar columnChooserClose = 'columnChooserClose';\n/** @hidden */\nvar columnChooserUpdate = 'columnChooserUpdate';\n/** @hidden */\nvar destroyEditForm = 'destroy-edit-form';\n/** @hidden */\nvar beforeDetailTemplateDetach = 'beforeDetailTemplateDetach';\n/** @hidden */\nvar detachDetailTemplate = 'detach-detail-template';\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9iYXNlL2NvbnN0YW50LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvYmFzZS9jb25zdGFudC5qcz9jZWUwIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNyZWF0ZWQgPSAnY3JlYXRlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGRlc3Ryb3llZCA9ICdkZXN0cm95Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGxvYWQgPSAnbG9hZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByb3dEYXRhQm91bmQgPSAncm93RGF0YUJvdW5kJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHF1ZXJ5Q2VsbEluZm8gPSAncXVlcnlDZWxsSW5mbyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBoZWFkZXJDZWxsSW5mbyA9ICdoZWFkZXJDZWxsSW5mbyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBhY3Rpb25CZWdpbiA9ICdhY3Rpb25CZWdpbic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBhY3Rpb25Db21wbGV0ZSA9ICdhY3Rpb25Db21wbGV0ZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBhY3Rpb25GYWlsdXJlID0gJ2FjdGlvbkZhaWx1cmUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZGF0YUJvdW5kID0gJ2RhdGFCb3VuZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByb3dTZWxlY3RpbmcgPSAncm93U2VsZWN0aW5nJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd1NlbGVjdGVkID0gJ3Jvd1NlbGVjdGVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd0Rlc2VsZWN0aW5nID0gJ3Jvd0Rlc2VsZWN0aW5nJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd0Rlc2VsZWN0ZWQgPSAncm93RGVzZWxlY3RlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjZWxsU2VsZWN0aW5nID0gJ2NlbGxTZWxlY3RpbmcnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY2VsbFNlbGVjdGVkID0gJ2NlbGxTZWxlY3RlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjZWxsRGVzZWxlY3RpbmcgPSAnY2VsbERlc2VsZWN0aW5nJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNlbGxEZXNlbGVjdGVkID0gJ2NlbGxEZXNlbGVjdGVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNvbHVtblNlbGVjdGluZyA9ICdjb2x1bW5TZWxlY3RpbmcnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29sdW1uU2VsZWN0ZWQgPSAnY29sdW1uU2VsZWN0ZWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29sdW1uRGVzZWxlY3RpbmcgPSAnY29sdW1uRGVzZWxlY3RpbmcnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29sdW1uRGVzZWxlY3RlZCA9ICdjb2x1bW5EZXNlbGVjdGVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNvbHVtbkRyYWdTdGFydCA9ICdjb2x1bW5EcmFnU3RhcnQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29sdW1uRHJhZyA9ICdjb2x1bW5EcmFnJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNvbHVtbkRyb3AgPSAnY29sdW1uRHJvcCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByb3dEcmFnU3RhcnRIZWxwZXIgPSAncm93RHJhZ1N0YXJ0SGVscGVyJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd0RyYWdTdGFydCA9ICdyb3dEcmFnU3RhcnQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcm93RHJhZyA9ICdyb3dEcmFnJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd0Ryb3AgPSAncm93RHJvcCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBiZWZvcmVQcmludCA9ICdiZWZvcmVQcmludCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBwcmludENvbXBsZXRlID0gJ3ByaW50Q29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZGV0YWlsRGF0YUJvdW5kID0gJ2RldGFpbERhdGFCb3VuZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB0b29sYmFyQ2xpY2sgPSAndG9vbGJhckNsaWNrJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJhdGNoQWRkID0gJ2JhdGNoQWRkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJhdGNoQ2FuY2VsID0gJ2JhdGNoQ2FuY2VsJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJhdGNoRGVsZXRlID0gJ2JhdGNoRGVsZXRlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZUJhdGNoQWRkID0gJ2JlZm9yZUJhdGNoQWRkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZUJhdGNoRGVsZXRlID0gJ2JlZm9yZUJhdGNoRGVsZXRlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZUJhdGNoU2F2ZSA9ICdiZWZvcmVCYXRjaFNhdmUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYmVnaW5FZGl0ID0gJ2JlZ2luRWRpdCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjZWxsRWRpdCA9ICdjZWxsRWRpdCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjZWxsU2F2ZSA9ICdjZWxsU2F2ZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjZWxsU2F2ZWQgPSAnY2VsbFNhdmVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGVuZEFkZCA9ICdlbmRBZGQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZW5kRGVsZXRlID0gJ2VuZERlbGV0ZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBlbmRFZGl0ID0gJ2VuZEVkaXQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVjb3JkRG91YmxlQ2xpY2sgPSAncmVjb3JkRG91YmxlQ2xpY2snO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVjb3JkQ2xpY2sgPSAncmVjb3JkQ2xpY2snO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYmVmb3JlRGF0YUJvdW5kID0gJ2JlZm9yZURhdGFCb3VuZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBiZWZvcmVPcGVuQ29sdW1uQ2hvb3NlciA9ICdiZWZvcmVPcGVuQ29sdW1uQ2hvb3Nlcic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBiZWZvcmVPcGVuQWRhcHRpdmVEaWFsb2cgPSAnYmVmb3JlT3BlbkFkYXB0aXZlRGlhbG9nJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlc2l6ZVN0YXJ0ID0gJ3Jlc2l6ZVN0YXJ0Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIG9uUmVzaXplID0gJ3Jlc2l6aW5nJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlc2l6ZVN0b3AgPSAncmVzaXplU3RvcCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjaGVja0JveENoYW5nZSA9ICdjaGVja0JveENoYW5nZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBiZWZvcmVDb3B5ID0gJ2JlZm9yZUNvcHknO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYmVmb3JlUGFzdGUgPSAnYmVmb3JlUGFzdGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYmVmb3JlQXV0b0ZpbGwgPSAnYmVmb3JlQXV0b0ZpbGwnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyQ2hvaWNlUmVxdWVzdCA9ICdmaWx0ZXJjaG9pY2VyZXF1ZXN0Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZpbHRlckFmdGVyT3BlbiA9ICdmaWx0ZXJBZnRlck9wZW4nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyQmVmb3JlT3BlbiA9ICdmaWx0ZXJCZWZvcmVPcGVuJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZpbHRlclNlYXJjaEJlZ2luID0gJ2ZpbHRlclNlYXJjaEJlZ2luJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNvbW1hbmRDbGljayA9ICdjb21tYW5kQ2xpY2snO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZXhwb3J0R3JvdXBDYXB0aW9uID0gJ2V4cG9ydEdyb3VwQ2FwdGlvbic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBsYXp5TG9hZEdyb3VwRXhwYW5kID0gJ2xhenlMb2FkR3JvdXBFeHBhbmQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgbGF6eUxvYWRHcm91cENvbGxhcHNlID0gJ2xhenlMb2FkR3JvdXBDb2xsYXBzZSc7XG4vKipcbiAqIFNwZWNpZmllcyBncmlkIGludGVybmFsIGV2ZW50c1xuICovXG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBpbml0aWFsTG9hZCA9ICdpbml0aWFsLWxvYWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgaW5pdGlhbEVuZCA9ICdpbml0aWFsLWVuZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBkYXRhUmVhZHkgPSAnZGF0YS1yZWFkeSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb250ZW50UmVhZHkgPSAnY29udGVudC1yZWFkeSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB1aVVwZGF0ZSA9ICd1aS11cGRhdGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgb25FbXB0eSA9ICdvbi1lbXB0eSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBpbkJvdW5kTW9kZWxDaGFuZ2VkID0gJ2luYm91bmQtbW9kZWwtY2hhbmdlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBtb2RlbENoYW5nZWQgPSAnbW9kZWwtY2hhbmdlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb2xHcm91cFJlZnJlc2ggPSAnY29sZ3JvdXAtcmVmcmVzaCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBoZWFkZXJSZWZyZXNoZWQgPSAnaGVhZGVyLXJlZnJlc2hlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBwYWdlQmVnaW4gPSAncGFnaW5nLWJlZ2luJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHBhZ2VDb21wbGV0ZSA9ICdwYWdpbmctY29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc29ydEJlZ2luID0gJ3NvcnRpbmctYmVnaW4nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc29ydENvbXBsZXRlID0gJ3NvcnRpbmctY29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyQmVnaW4gPSAnZmlsdGVyaW5nLWJlZ2luJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZpbHRlckNvbXBsZXRlID0gJ2ZpbHRlcmluZy1jb21wbGV0ZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBzZWFyY2hCZWdpbiA9ICdzZWFyY2hpbmctYmVnaW4nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc2VhcmNoQ29tcGxldGUgPSAnc2VhcmNoaW5nLWNvbXBsZXRlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlb3JkZXJCZWdpbiA9ICdyZW9yZGVyLWJlZ2luJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlb3JkZXJDb21wbGV0ZSA9ICdyZW9yZGVyLWNvbXBsZXRlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd0RyYWdBbmREcm9wQmVnaW4gPSAncm93ZHJhZ2FuZGRyb3AtYmVnaW4nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcm93RHJhZ0FuZERyb3BDb21wbGV0ZSA9ICdyb3dkcmFnYW5kZHJvcC1jb21wbGV0ZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBncm91cEJlZ2luID0gJ2dyb3VwaW5nLWJlZ2luJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGdyb3VwQ29tcGxldGUgPSAnZ3JvdXBpbmctY29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgdW5ncm91cEJlZ2luID0gJ3VuZ3JvdXBpbmctYmVnaW4nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgdW5ncm91cENvbXBsZXRlID0gJ3VuZ3JvdXBpbmctY29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZ3JvdXBBZ2dyZWdhdGVzID0gJ2dyb3VwLWFnZ3JlZ2F0ZXMnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaEZvb3RlclJlbmRlcmVyID0gJ3JlZnJlc2gtZm9vdGVyLXJlbmRlcmVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlZnJlc2hBZ2dyZWdhdGVDZWxsID0gJ3JlZnJlc2gtYWdncmVnYXRlLWNlbGwnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaEFnZ3JlZ2F0ZXMgPSAncmVmcmVzaC1hZ2dyZWdhdGVzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd1NlbGVjdGlvbkJlZ2luID0gJ3Jvd3NlbGVjdGluZyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByb3dTZWxlY3Rpb25Db21wbGV0ZSA9ICdyb3dzZWxlY3RlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb2x1bW5TZWxlY3Rpb25CZWdpbiA9ICdjb2x1bW5zZWxlY3RpbmcnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29sdW1uU2VsZWN0aW9uQ29tcGxldGUgPSAnY29sdW1uc2VsZWN0ZWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY2VsbFNlbGVjdGlvbkJlZ2luID0gJ2NlbGxzZWxlY3RpbmcnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY2VsbFNlbGVjdGlvbkNvbXBsZXRlID0gJ2NlbGxzZWxlY3RlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBkZXN0cm95QXV0b0ZpbGxFbGVtZW50cyA9ICdkZXN0cm95LWF1dG9maWxsLWVsZW1lbnRzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZUNlbGxGb2N1c2VkID0gJ2JlZm9yZWNlbGxmb2N1c2VkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNlbGxGb2N1c2VkID0gJ2NlbGxmb2N1c2VkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGtleVByZXNzZWQgPSAna2V5LXByZXNzZWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY2xpY2sgPSAnY2xpY2snO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZGVzdHJveSA9ICdkZXN0cm95Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNvbHVtblZpc2liaWxpdHlDaGFuZ2VkID0gJ2NvbHVtbi12aXNpYmxlLWNoYW5nZWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc2Nyb2xsID0gJ3Njcm9sbCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb2x1bW5XaWR0aENoYW5nZWQgPSAnY29sdW1uLXdpZHRoLWNoYW5nZWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29sdW1uUG9zaXRpb25DaGFuZ2VkID0gJ2NvbHVtbi1wb3NpdGlvbi1jaGFuZ2VkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd0RyYWdBbmREcm9wID0gJ3Jvdy1kcmFnLWFuZC1kcm9wJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd3NBZGRlZCA9ICdyb3dzLWFkZGVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd3NSZW1vdmVkID0gJ3Jvd3MtcmVtb3ZlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb2x1bW5EcmFnU3RvcCA9ICdjb2x1bW4tZHJhZy1zdG9wJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGhlYWRlckRyb3AgPSAnaGVhZGVyLWRyb3AnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZGF0YVNvdXJjZU1vZGlmaWVkID0gJ2RhdGFzb3VyY2UtbW9kaWZpZWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaENvbXBsZXRlID0gJ3JlZnJlc2gtY29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaFZpcnR1YWxCbG9jayA9ICdyZWZyZXNoLXZpcnR1YWwtYmxvY2snO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZGJsY2xpY2sgPSAnZGJsY2xpY2snO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgdG9vbGJhclJlZnJlc2ggPSAndG9vbGJhci1yZWZyZXNoJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJ1bGtTYXZlID0gJ2J1bGstc2F2ZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBhdXRvQ29sID0gJ2F1dG8tY29sJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHRvb2x0aXBEZXN0cm95ID0gJ3Rvb2x0aXAtZGVzdHJveSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVEYXRhID0gJ3VwZGF0ZS1kYXRhJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGVkaXRCZWdpbiA9ICdlZGl0LWJlZ2luJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGVkaXRDb21wbGV0ZSA9ICdlZGl0LWNvbXBsZXRlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGFkZEJlZ2luID0gJ2FkZC1iZWdpbic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBhZGRDb21wbGV0ZSA9ICdhZGQtY29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc2F2ZUNvbXBsZXRlID0gJ3NhdmUtY29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZGVsZXRlQmVnaW4gPSAnZGVsZXRlLWJlZ2luJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGRlbGV0ZUNvbXBsZXRlID0gJ2RlbGV0ZS1jb21wbGV0ZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBwcmV2ZW50QmF0Y2ggPSAncHJldmVudC1iYXRjaCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBkaWFsb2dEZXN0cm95ID0gJ2RpYWxvZy1kZXN0cm95Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNydWRBY3Rpb24gPSAnY3J1ZC1BY3Rpb24nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYWRkRGVsZXRlQWN0aW9uID0gJ2FkZC1kZWxldGUtQWN0aW9uJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGRlc3Ryb3lGb3JtID0gJ2Rlc3Ryb3ktZm9ybSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBkb3VibGVUYXAgPSAnZG91YmxlLXRhcCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBiZWZvcmVFeGNlbEV4cG9ydCA9ICdiZWZvcmVFeGNlbEV4cG9ydCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBleGNlbEV4cG9ydENvbXBsZXRlID0gJ2V4Y2VsRXhwb3J0Q29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZXhjZWxRdWVyeUNlbGxJbmZvID0gJ2V4Y2VsUXVlcnlDZWxsSW5mbyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBleGNlbEhlYWRlclF1ZXJ5Q2VsbEluZm8gPSAnZXhjZWxIZWFkZXJRdWVyeUNlbGxJbmZvJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGV4cG9ydERldGFpbERhdGFCb3VuZCA9ICdleHBvcnREZXRhaWxEYXRhQm91bmQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZXhwb3J0RGV0YWlsVGVtcGxhdGUgPSAnZXhwb3J0RGV0YWlsVGVtcGxhdGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYmVmb3JlUGRmRXhwb3J0ID0gJ2JlZm9yZVBkZkV4cG9ydCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBwZGZFeHBvcnRDb21wbGV0ZSA9ICdwZGZFeHBvcnRDb21wbGV0ZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBwZGZRdWVyeUNlbGxJbmZvID0gJ3BkZlF1ZXJ5Q2VsbEluZm8nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcGRmSGVhZGVyUXVlcnlDZWxsSW5mbyA9ICdwZGZIZWFkZXJRdWVyeUNlbGxJbmZvJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGFjY2Vzc1ByZWRpY2F0ZSA9ICdhY2Nlc3MtcHJlZGljYXRlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNvbnRleHRNZW51Q2xpY2sgPSAnY29udGV4dE1lbnVDbGljayc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBmcmVlemVSZW5kZXIgPSAnZnJlZXplcmVuZGVyJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZyZWV6ZVJlZnJlc2ggPSAnZnJlZXplcmVmcmVzaCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb250ZXh0TWVudU9wZW4gPSAnY29udGV4dE1lbnVPcGVuJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNvbHVtbk1lbnVDbGljayA9ICdjb2x1bW5NZW51Q2xpY2snO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29sdW1uTWVudU9wZW4gPSAnY29sdW1uTWVudU9wZW4nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyT3BlbiA9ICdmaWx0ZXJPcGVuJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZpbHRlckRpYWxvZ0NyZWF0ZWQgPSAnZmlsdGVyRGlhbG9nQ3JlYXRlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNZW51Q2xvc2UgPSAnZmlsdGVyLW1lbnUtY2xvc2UnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgaW5pdEZvcmVpZ25LZXlDb2x1bW4gPSAnaW5pdEZvcmVpZ25LZXlDb2x1bW4nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZ2V0Rm9yZWlnbktleURhdGEgPSAnZ2V0Rm9yZWlnbktleURhdGEnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZ2VuZXJhdGVRdWVyeSA9ICdnZW5lcmF0ZVF1ZXJ5Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHNob3dFbXB0eUdyaWQgPSAnc2hvd0VtcHR5R3JpZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBmb3JlaWduS2V5RGF0YSA9ICdmb3JlaWduS2V5RGF0YSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb2x1bW5EYXRhU3RhdGVDaGFuZ2UgPSAnY29sdW1uRGF0YVN0YXRlQ2hhbmdlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGRhdGFTdGF0ZUNoYW5nZSA9ICdkYXRhU3RhdGVDaGFuZ2UnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZGF0YVNvdXJjZUNoYW5nZWQgPSAnZGF0YVNvdXJjZUNoYW5nZWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcnRsVXBkYXRlZCA9ICdydGwtdXBkYXRlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBiZWZvcmVGcmFnQXBwZW5kID0gJ2JlZm9yZUZyYWdBcHBlbmQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZnJvemVuSGVpZ2h0ID0gJ2Zyb3plbkhlaWdodCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB0ZXh0V3JhcFJlZnJlc2ggPSAndGV4dFdyYXBSZWZyZXNoJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlY29yZEFkZGVkID0gJ3JlY29yZEFkZGVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNhbmNlbEJlZ2luID0gJ2NhbmNlbC1CZWdpbic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBlZGl0TmV4dFZhbENlbGwgPSAnZWRpdE5leHRWYWxDZWxsJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGhpZXJhcmNoeVByaW50ID0gJ2hpZXJhcmNoeXByaW50Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGV4cGFuZENoaWxkR3JpZCA9ICdleHBhbmRjaGlsZGdyaWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcHJpbnRHcmlkSW5pdCA9ICdwcmludEdyaWQtSW5pdCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBleHBvcnRSb3dEYXRhQm91bmQgPSAnZXhwb3J0LVJvd0RhdGFCb3VuZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBleHBvcnREYXRhQm91bmQgPSAnZXhwb3J0LURhdGFCb3VuZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByb3dQb3NpdGlvbkNoYW5nZWQgPSAncm93LXBvc2l0aW9uLWNoYW5nZWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29sdW1uQ2hvb3Nlck9wZW5lZCA9ICdjb2x1bW5DaG9vc2VyT3BlbmVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJhdGNoRm9ybSA9ICdiYXRjaGVkaXQtZm9ybSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBiZWZvcmVTdGFydEVkaXQgPSAnZWRpdC1mb3JtJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZUJhdGNoQ2FuY2VsID0gJ2JlZm9yZS1iYXRjaC1jYW5jZWwnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYmF0Y2hFZGl0Rm9ybVJlbmRlcmVkID0gJ2JhdGNoZWRpdGZvcm0tcmVuZGVyZWQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcGFydGlhbFJlZnJlc2ggPSAncGFydGlhbC1yZWZyZXNoJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZUN1c3RvbUZpbHRlck9wZW4gPSAnYmVmb3JlQ3VzdG9tRmlsdGVyT3Blbic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBzZWxlY3RWaXJ0dWFsUm93ID0gJ3NlbGVjdC12aXJ0dWFsLVJvdyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb2x1bW5zUHJlcGFyZWQgPSAnY29sdW1ucy1wcmVwYXJlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjQm94Rmx0ckJlZ2luID0gJ2Nib3gtZmlsdGVyLWJlZ2luJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNCb3hGbHRyQ29tcGxldGUgPSAnY2JveC1maWx0ZXItY29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZmx0clByZXZlbnQgPSAnZmlsdGVyLVByZXZlbnQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYmVmb3JlRmx0cmNNZW51T3BlbiA9ICdiZWZvcmUtZmlsdGVyLWNtZW51LW9wZW4nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgdmFsQ3VzdG9tUGxhY2VtZW50ID0gJ3ZhbGlkYXRpb24tY3VzdG9tLXBsYWNlbWVudCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJDYm94VmFsdWUgPSAnZmlsdGVyLWNib3gtdmFsdWUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29tcG9uZW50UmVuZGVyZWQgPSAnY29tcG9uZW50LXJlbmRlcmVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlc3RvcmVGb2N1cyA9ICdyZXN0b3JlLUZvY3VzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGRldGFpbFN0YXRlQ2hhbmdlID0gJ2RldGFpbC1zdGF0ZS1jaGFuZ2UnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZGV0YWlsSW5kZW50Q2VsbEluZm8gPSAnZGV0YWlsLWluZGVudGNlbGwtaW5mbyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB2aXJ0YXVsS2V5SGFuZGxlciA9ICd2aXJ0YXVsLWtleS1oYW5kbGVyJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHZpcnRhdWxDZWxsRm9jdXMgPSAndmlydGF1bC1jZWxsLWZvY3VzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHZpcnR1YWxTY3JvbGxFZGl0QWN0aW9uQmVnaW4gPSAndmlydHVhbC1zY3JvbGwtZWRpdC1hY3Rpb24tYmVnaW4nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgdmlydHVhbFNjcm9sbEVkaXRTdWNjZXNzID0gJ3ZpcnR1YWwtc2Nyb2xsLWVkaXQtc3VjY2Vzcyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB2aXJ0dWFsU2Nyb2xsRWRpdENhbmNlbCA9ICd2aXJ0dWFsLXNjcm9sbC1lZGl0LWNhbmNlbCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB2aXJ0dWFsU2Nyb2xsRWRpdCA9ICd2aXJ0dWFsLXNjcm9sbC1lZGl0Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlZnJlc2hWaXJ0dWFsQ2FjaGUgPSAncmVmcmVzaC12aXJ0dWFsLWNhY2hlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGVkaXRSZXNldCA9ICdlZGl0LXJlc2V0Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHZpcnR1YWxTY3JvbGxBZGRBY3Rpb25CZWdpbiA9ICd2aXJ0dWFsLXNjcm9sbC1hZGQtYWN0aW9uLWJlZ2luJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGdldFZpcnR1YWxEYXRhID0gJ2dldC12aXJ0dWFsLWRhdGEnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaEluZmluaXRlTW9kZUJsb2NrcyA9ICdyZWZyZXNoLWluZmluaXRlLW1vZGUtYmxvY2tzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlc2V0SW5maW5pdGVCbG9ja3MgPSAncmVzZXQtaW5maW5pdGUtYmxvY2tzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGluZmluaXRlU2Nyb2xsSGFuZGxlciA9ICdpbmZpbml0ZS1zY3JvbGwtaGFuZGxlcic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBpbmZpbml0ZVBhZ2VRdWVyeSA9ICdpbmZpbml0ZS1wYWdlLXF1ZXJ5Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGluZmluaXRlU2hvd0hpZGUgPSAnaW5maW5pdGUtc2hvdy1oaWRlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGFwcGVuZEluZmluaXRlQ29udGVudCA9ICdhcHBlbmQtaW5maW5pdGUtY29udGVudCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZW1vdmVJbmZpbml0ZVJvd3MgPSAncmVtb3ZlLWluZmluaXRlLXJvd3MnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc2V0SW5maW5pdGVDYWNoZSA9ICdzZXQtaW5maW5pdGUtY2FjaGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgaW5maW5pdGVFZGl0SGFuZGxlciA9ICdpbmZpbml0ZS1lZGl0LWhhbmRsZXInO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgaW5pdGlhbENvbGxhcHNlID0gJ2luaXRpYWwtY29sbGFwc2UnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZ2V0QWdncmVnYXRlUXVlcnkgPSAnZ2V0LWFnZ3JlZ2F0ZS1xdWVyeSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjbG9zZUZpbHRlckRpYWxvZyA9ICdjbG9zZS1maWx0ZXItZGlhbG9nJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNvbHVtbkNob29zZXJDYW5jZWxCdG5DbGljayA9ICdjb2x1bW5DaG9vc2VyQ2FuY2VsQnRuQ2xpY2snO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZ2V0RmlsdGVyQmFyT3BlcmF0b3IgPSAnZ2V0LWZpbHRlcmJhci1vcGVyYXRvcic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZXNldENvbHVtbnMgPSAncmVzZXQtY29sdW1ucyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBwZGZBZ2dyZWdhdGVRdWVyeUNlbGxJbmZvID0gJ3BkZkFnZ3JlZ2F0ZVF1ZXJ5Q2VsbEluZm8nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZXhjZWxBZ2dyZWdhdGVRdWVyeUNlbGxJbmZvID0gJ2V4Y2VsQWdncmVnYXRlUXVlcnlDZWxsSW5mbyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBzZXRHcm91cENhY2hlID0gJ2dyb3VwLWNhY2hlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGxhenlMb2FkU2Nyb2xsSGFuZGxlciA9ICdsYXp5LWxvYWQtc2Nyb2xsLWhhbmRsZXInO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZ3JvdXBDb2xsYXBzZSA9ICdncm91cC1jb2xsYXBzZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBiZWZvcmVDaGVja2JveFJlbmRlcmVyID0gJ2JlZm9yZUNoZWNrYm94UmVuZGVyZXInO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaEhhbmRsZXJzID0gJ3JlZnJlc2hSZXNpemVIYW5kbGVycyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZWZyZXNoRnJvemVuQ29sdW1ucyA9ICdyZWZyZXNoLWZyb3plbi1jb2x1bW5zJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHNldFJlb3JkZXJEZXN0aW5hdGlvbkVsZW1lbnQgPSAnc2V0LXJlb3JkZXItZGVzdGluYXRpb24tZWxlbWVudCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZWZyZXNoVmlydHVhbEZyb3plbkhlaWdodCA9ICdyZWZyZXNoLXZpcnR1YWwtZnJvemVuLWhlaWdodCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBzZXRGcmVlemVTZWxlY3Rpb24gPSAnc2V0LWZyZWV6ZS1zZWxlY3Rpb24nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc2V0SW5maW5pdGVGcm96ZW5IZWlnaHQgPSAnc2V0LWluZmluaXRlLWZyb3plbi1oZWlnaHQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc2V0SW5maW5pdGVDb2xGcm96ZW5IZWlnaHQgPSAnc2V0LWluZmluaXRlLWNvbC1mcm96ZW4taGVpZ2h0Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZVJlZnJlc2hPbkRhdGFDaGFuZ2UgPSAnYmVmb3JlLXJlZnJlc2gtb24tZGF0YS1jaGFuZ2UnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgaW1tdXRhYmxlQmF0Y2hDYW5jZWwgPSAnaW1tdXRhYmxlLWJhdGNoLWNhbmNlbCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZWZyZXNoVmlydHVhbEZyb3plblJvd3MgPSAncmVmcmVzaC12aXJ0dWFsLWZyb3plbnJvd3MnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY2hlY2tTY3JvbGxSZXNldCA9ICdjaGVjay1zY3JvbGwtcmVzZXQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaEZyb3plbkhlaWdodCA9ICdyZWZyZXNoLWZyb3plbi1oZWlnaHQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc2V0SGVpZ2h0VG9Gcm96ZW5FbGVtZW50ID0gJ3NldC1oZWlnaHQtdG8tZnJvemVuLWVsZW1lbnQnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcHJldmVudEZyb3plblNjcm9sbFJlZnJlc2ggPSAncHJldmVudC1mcm96ZW4tc2Nyb2xsLXJlZnJlc2gnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgbmV4dENlbGxJbmRleCA9ICduZXh0LWNlbGwtaW5kZXgnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaEluZmluaXRlQ3VycmVudFZpZXdEYXRhID0gJ3JlZnJlc2gtaW5maW5pdGUtY3VycmVudC12aWV3LWRhdGEnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgaW5maW5pdGVDcnVkQ2FuY2VsID0gJ2luZmluaXRlLWNydWQtY2FuY2VsJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZpbHRlckRpYWxvZ0Nsb3NlID0gJ2ZpbHRlci1kaWFsb2ctY2xvc2UnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaEN1c3RvbUZpbHRlck9rQnRuID0gJ3JlZnJlc2gtY3V0c29tLWZpbHRlci1vay1idXR0b24nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaEN1c3RvbUZpbHRlckNsZWFyQnRuID0gJ3JlZnJlc2gtY3V0c29tLWZpbHRlci1jbGVhci1idXR0b24nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVuZGVyUmVzcG9uc2l2ZUNtZW51ID0gJ3JlbmRlci1yZXNwb25zaXZlLWNtZW51Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZpbHRlckNtZW51U2VsZWN0ID0gJ2ZpbHRlci1jbWVudS1zZWxlY3QnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY3VzdG9tRmlsdGVyQ2xvc2UgPSAnY3VzdG9tLWZpbHRlci1jbG9zZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBzZXRGdWxsU2NyZWVuRGlhbG9nID0gJ3NldC1mdWxsc2NyZWVuLWRpYWxvZyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZWZyZXNoRXhwYW5kYW5kQ29sbGFwc2UgPSAncmVmcmVzaC1FeHBhbmQtYW5kLUNvbGxhcHNlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvd01vZGVDaGFuZ2UgPSAncm93LW1vZGUtY2hhbmdlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGVudGVyS2V5SGFuZGxlciA9ICdlbnRlci1rZXktaGFuZGxlcic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZWZyZXNoVmlydHVhbE1heFBhZ2UgPSAncmVmcmVzaC12aXJ0dWFsLW1heC1wYWdlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHNldFZpcnR1YWxQYWdlUXVlcnkgPSAnc2V0LXZpcnR1YWwtcGFnZS1xdWVyeSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBzZWxlY3RSb3dPbkNvbnRleHRPcGVuID0gJ3NlbGVjdC1yb3ctb24tY29udGV4dC1vcGVuJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHBhZ2VyUmVmcmVzaCA9ICdwYWdlci1yZWZyZXNoJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNsb3NlSW5saW5lID0gJ2Nsb3NlaW5saW5lJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNsb3NlQmF0Y2ggPSAnY2xvc2ViYXRjaCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjbG9zZUVkaXQgPSAnY2xvc2UtZWRpdCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZXNldFZpcnR1YWxGb2N1cyA9ICdyZXNldC12aXJ0dWFsLWZvY3VzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGFmdGVyQ29udGVudFJlbmRlciA9ICdhZnRlci1jb250ZW50LXJlbmRlcmVyJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlZnJlc2hWaXJ0dWFsRWRpdEZvcm1DZWxscyA9ICdyZWZyZXNoLXZpcnR1YWwtZWRpdGZvcm0tY2VsbHMnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgc2Nyb2xsVG9FZGl0ID0gJ3Njcm9sbC10by1lZGl0Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZUNoZWNrYm94UmVuZGVyZXJRdWVyeSA9ICdiZWZvcmUtY2hlY2tib3gtcmVuZGVyZXItcXVlcnknO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY3JlYXRlVmlydHVhbFZhbGlkYXRpb25Gb3JtID0gJ2NyZWF0ZS12aXJ0dWFsLXZhbGlkYXRpb24tZm9ybSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB2YWxpZGF0ZVZpcnR1YWxGb3JtID0gJ3ZhbGlkYXRlLXZpcnR1YWwtZm9ybSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBkZXN0cm95Q2hpbGRHcmlkID0gJ2Rlc3Ryb3ktY2hpbGQtZ3JpZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBzdGlja3lTY3JvbGxDb21wbGV0ZSA9ICdzdGlja3ktc2Nyb2xsLWNvbXBsZXRlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNhcHRpb25BY3Rpb25Db21wbGV0ZSA9ICdpbmZpbml0ZS1ncm91cC1jb2xsYXBzZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZWZyZXNoSW5maW5pdGVQZXJzaXN0U2VsZWN0aW9uID0gJ3JlZnJlc2gtaW5maW5pdGUtcGVyc2lzdC1zZWxlY3Rpb24nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaEluZmluaXRlRWRpdHJvd2luZGV4ID0gJ3JlZnJlc2gtaW5maW5pdGUtZWRpdHJvd2luZGV4Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGFmdGVyRmlsdGVyQ29sdW1uTWVudUNsb3NlID0gJ2FmdGVyLWZpbHRlci1jb2x1bW4tbWVudS1jbG9zZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBiZWZvcmVDaGVja2JveGZpbHRlclJlbmRlcmVyID0gJ2JlZm9yZUNoZWNrYm94ZmlsdGVyUmVuZGVyZXInO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29tbWFuZENvbHVtbkRlc3Ryb3kgPSAnY29tbWFuZENvbHVtbkRlc3Ryb3knO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYmF0Y2hDbmZybURsZ0NhbmNlbCA9ICdjYW5jZWxjbmZybURsZyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZWZyZXNoVmlydHVhbExhenlMb2FkQ2FjaGUgPSAncmVmcmVzaC1WaXJ0dWFsLUxhenlMb2FkLUNhY2hlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJlZnJlc2hGcm96ZW5Qb3NpdGlvbiA9ICdyZWZyZXNoLUZyb3plbi1Qb3NpdGlvbic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZWZyZXNoUmVzaXplUG9zaXRpb24gPSAncmVmcmVzaC1SZXNpemUtUG9zaXRpb24nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVmcmVzaFNwbGl0RnJvemVuQ29sdW1uID0gJ3JlZnJlc2gtU3BsaXQtRnJvemVuLUNvbHVtbic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciByZW5kZXJSZXNwb25zaXZlQ2hhbmdlQWN0aW9uID0gJ3JlbmRlci1SZXNwb25zaXZlLUNoYW5nZS1BY3Rpb24nO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcmVuZGVyUmVzcG9uc2l2ZUNvbHVtbkNob29zZXJEaXYgPSAncmVuZGVyLVJlc3BvbnNpdmUtQ29sdW1uLUNob29zZXItRGl2Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHNob3dBZGROZXdSb3dGb2N1cyA9ICdzaG93LUFkZC1OZXctUm93LUZvY3VzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGluZmluaXRlU2Nyb2xsQ29tcGxldGUgPSAnaW5maW5pdGVzY3JvbGwtY29tcGxldGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgbGFzdFJvd0NlbGxCb3JkZXJVcGRhdGVkID0gJ2xhc3Qtcm93Y2VsbC1ib3JkZXItdXBkYXRlZCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb2x1bW5DaG9vc2VyU2VhcmNoID0gJ2NvbHVtbkNob29zZXJTZWFyY2gnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgY29sdW1uQ2hvb3NlckNsb3NlID0gJ2NvbHVtbkNob29zZXJDbG9zZSc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb2x1bW5DaG9vc2VyVXBkYXRlID0gJ2NvbHVtbkNob29zZXJVcGRhdGUnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZGVzdHJveUVkaXRGb3JtID0gJ2Rlc3Ryb3ktZWRpdC1mb3JtJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZURldGFpbFRlbXBsYXRlRGV0YWNoID0gJ2JlZm9yZURldGFpbFRlbXBsYXRlRGV0YWNoJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGRldGFjaERldGFpbFRlbXBsYXRlID0gJ2RldGFjaC1kZXRhaWwtdGVtcGxhdGUnO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CellType: () => (/* binding */ CellType),\n/* harmony export */   RenderType: () => (/* binding */ RenderType),\n/* harmony export */   ResponsiveDialogAction: () => (/* binding */ ResponsiveDialogAction),\n/* harmony export */   ResponsiveToolbarAction: () => (/* binding */ ResponsiveToolbarAction),\n/* harmony export */   ToolbarItem: () => (/* binding */ ToolbarItem)\n/* harmony export */ });\n/**\n * Defines types of Cell\n *\n * @hidden\n */\nvar CellType;\n(function (CellType) {\n    /**  Defines CellType as Data */\n    CellType[CellType[\"Data\"] = 0] = \"Data\";\n    /**  Defines CellType as Header */\n    CellType[CellType[\"Header\"] = 1] = \"Header\";\n    /**  Defines CellType as Summary */\n    CellType[CellType[\"Summary\"] = 2] = \"Summary\";\n    /**  Defines CellType as GroupSummary */\n    CellType[CellType[\"GroupSummary\"] = 3] = \"GroupSummary\";\n    /**  Defines CellType as CaptionSummary */\n    CellType[CellType[\"CaptionSummary\"] = 4] = \"CaptionSummary\";\n    /**  Defines CellType as Filter */\n    CellType[CellType[\"Filter\"] = 5] = \"Filter\";\n    /**  Defines CellType as Indent */\n    CellType[CellType[\"Indent\"] = 6] = \"Indent\";\n    /**  Defines CellType as GroupCaption */\n    CellType[CellType[\"GroupCaption\"] = 7] = \"GroupCaption\";\n    /**  Defines CellType as GroupCaptionEmpty */\n    CellType[CellType[\"GroupCaptionEmpty\"] = 8] = \"GroupCaptionEmpty\";\n    /**  Defines CellType as Expand */\n    CellType[CellType[\"Expand\"] = 9] = \"Expand\";\n    /**  Defines CellType as HeaderIndent */\n    CellType[CellType[\"HeaderIndent\"] = 10] = \"HeaderIndent\";\n    /**  Defines CellType as StackedHeader */\n    CellType[CellType[\"StackedHeader\"] = 11] = \"StackedHeader\";\n    /**  Defines CellType as DetailHeader */\n    CellType[CellType[\"DetailHeader\"] = 12] = \"DetailHeader\";\n    /**  Defines CellType as DetailExpand */\n    CellType[CellType[\"DetailExpand\"] = 13] = \"DetailExpand\";\n    /**  Defines CellType as CommandColumn */\n    CellType[CellType[\"CommandColumn\"] = 14] = \"CommandColumn\";\n    /**  Defines CellType as DetailFooterIntent */\n    CellType[CellType[\"DetailFooterIntent\"] = 15] = \"DetailFooterIntent\";\n    /**  Defines CellType as RowDrag */\n    CellType[CellType[\"RowDragIcon\"] = 16] = \"RowDragIcon\";\n    /**  Defines CellType as RowDragHeader */\n    CellType[CellType[\"RowDragHIcon\"] = 17] = \"RowDragHIcon\";\n})(CellType || (CellType = {}));\n/**\n * Defines types of Render\n *\n * @hidden\n */\nvar RenderType;\n(function (RenderType) {\n    /**  Defines RenderType as Header */\n    RenderType[RenderType[\"Header\"] = 0] = \"Header\";\n    /**  Defines RenderType as Content */\n    RenderType[RenderType[\"Content\"] = 1] = \"Content\";\n    /**  Defines RenderType as Summary */\n    RenderType[RenderType[\"Summary\"] = 2] = \"Summary\";\n})(RenderType || (RenderType = {}));\n/**\n * Defines Predefined toolbar items.\n *\n * @hidden\n */\nvar ToolbarItem;\n(function (ToolbarItem) {\n    ToolbarItem[ToolbarItem[\"Add\"] = 0] = \"Add\";\n    ToolbarItem[ToolbarItem[\"Edit\"] = 1] = \"Edit\";\n    ToolbarItem[ToolbarItem[\"Update\"] = 2] = \"Update\";\n    ToolbarItem[ToolbarItem[\"Delete\"] = 3] = \"Delete\";\n    ToolbarItem[ToolbarItem[\"Cancel\"] = 4] = \"Cancel\";\n    ToolbarItem[ToolbarItem[\"Print\"] = 5] = \"Print\";\n    ToolbarItem[ToolbarItem[\"Search\"] = 6] = \"Search\";\n    ToolbarItem[ToolbarItem[\"ColumnChooser\"] = 7] = \"ColumnChooser\";\n    ToolbarItem[ToolbarItem[\"PdfExport\"] = 8] = \"PdfExport\";\n    ToolbarItem[ToolbarItem[\"ExcelExport\"] = 9] = \"ExcelExport\";\n    ToolbarItem[ToolbarItem[\"CsvExport\"] = 10] = \"CsvExport\";\n    ToolbarItem[ToolbarItem[\"WordExport\"] = 11] = \"WordExport\";\n})(ToolbarItem || (ToolbarItem = {}));\n/**\n * Defines types of responsive dialogs\n *\n * @hidden\n */\nvar ResponsiveDialogAction;\n(function (ResponsiveDialogAction) {\n    /**  Defines dialog type as Edit */\n    ResponsiveDialogAction[ResponsiveDialogAction[\"isEdit\"] = 0] = \"isEdit\";\n    /**  Defines dialog type as Add */\n    ResponsiveDialogAction[ResponsiveDialogAction[\"isAdd\"] = 1] = \"isAdd\";\n    /**  Defines dialog type as Sort */\n    ResponsiveDialogAction[ResponsiveDialogAction[\"isSort\"] = 2] = \"isSort\";\n    /**  Defines dialog type as Filter */\n    ResponsiveDialogAction[ResponsiveDialogAction[\"isFilter\"] = 3] = \"isFilter\";\n    /**  Defines dialog type as ColMenu */\n    ResponsiveDialogAction[ResponsiveDialogAction[\"isColMenu\"] = 4] = \"isColMenu\";\n    /**  Defines dialog type as ColumChooser */\n    ResponsiveDialogAction[ResponsiveDialogAction[\"isColumnChooser\"] = 5] = \"isColumnChooser\";\n})(ResponsiveDialogAction || (ResponsiveDialogAction = {}));\n/**\n * Defines responsive toolbar actions\n *\n * @hidden\n */\nvar ResponsiveToolbarAction;\n(function (ResponsiveToolbarAction) {\n    /**  Defines initial responsive toolbar buttons */\n    ResponsiveToolbarAction[ResponsiveToolbarAction[\"isInitial\"] = 0] = \"isInitial\";\n    /**  Defines responsive toolbar search */\n    ResponsiveToolbarAction[ResponsiveToolbarAction[\"isSearch\"] = 1] = \"isSearch\";\n})(ResponsiveToolbarAction || (ResponsiveToolbarAction = {}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9iYXNlL2VudW0uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNEJBQTRCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnQ0FBZ0M7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGtDQUFrQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsd0RBQXdEO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDBEQUEwRCIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL2Jhc2UvZW51bS5qcz9iZWQ0Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGVmaW5lcyB0eXBlcyBvZiBDZWxsXG4gKlxuICogQGhpZGRlblxuICovXG5leHBvcnQgdmFyIENlbGxUeXBlO1xuKGZ1bmN0aW9uIChDZWxsVHlwZSkge1xuICAgIC8qKiAgRGVmaW5lcyBDZWxsVHlwZSBhcyBEYXRhICovXG4gICAgQ2VsbFR5cGVbQ2VsbFR5cGVbXCJEYXRhXCJdID0gMF0gPSBcIkRhdGFcIjtcbiAgICAvKiogIERlZmluZXMgQ2VsbFR5cGUgYXMgSGVhZGVyICovXG4gICAgQ2VsbFR5cGVbQ2VsbFR5cGVbXCJIZWFkZXJcIl0gPSAxXSA9IFwiSGVhZGVyXCI7XG4gICAgLyoqICBEZWZpbmVzIENlbGxUeXBlIGFzIFN1bW1hcnkgKi9cbiAgICBDZWxsVHlwZVtDZWxsVHlwZVtcIlN1bW1hcnlcIl0gPSAyXSA9IFwiU3VtbWFyeVwiO1xuICAgIC8qKiAgRGVmaW5lcyBDZWxsVHlwZSBhcyBHcm91cFN1bW1hcnkgKi9cbiAgICBDZWxsVHlwZVtDZWxsVHlwZVtcIkdyb3VwU3VtbWFyeVwiXSA9IDNdID0gXCJHcm91cFN1bW1hcnlcIjtcbiAgICAvKiogIERlZmluZXMgQ2VsbFR5cGUgYXMgQ2FwdGlvblN1bW1hcnkgKi9cbiAgICBDZWxsVHlwZVtDZWxsVHlwZVtcIkNhcHRpb25TdW1tYXJ5XCJdID0gNF0gPSBcIkNhcHRpb25TdW1tYXJ5XCI7XG4gICAgLyoqICBEZWZpbmVzIENlbGxUeXBlIGFzIEZpbHRlciAqL1xuICAgIENlbGxUeXBlW0NlbGxUeXBlW1wiRmlsdGVyXCJdID0gNV0gPSBcIkZpbHRlclwiO1xuICAgIC8qKiAgRGVmaW5lcyBDZWxsVHlwZSBhcyBJbmRlbnQgKi9cbiAgICBDZWxsVHlwZVtDZWxsVHlwZVtcIkluZGVudFwiXSA9IDZdID0gXCJJbmRlbnRcIjtcbiAgICAvKiogIERlZmluZXMgQ2VsbFR5cGUgYXMgR3JvdXBDYXB0aW9uICovXG4gICAgQ2VsbFR5cGVbQ2VsbFR5cGVbXCJHcm91cENhcHRpb25cIl0gPSA3XSA9IFwiR3JvdXBDYXB0aW9uXCI7XG4gICAgLyoqICBEZWZpbmVzIENlbGxUeXBlIGFzIEdyb3VwQ2FwdGlvbkVtcHR5ICovXG4gICAgQ2VsbFR5cGVbQ2VsbFR5cGVbXCJHcm91cENhcHRpb25FbXB0eVwiXSA9IDhdID0gXCJHcm91cENhcHRpb25FbXB0eVwiO1xuICAgIC8qKiAgRGVmaW5lcyBDZWxsVHlwZSBhcyBFeHBhbmQgKi9cbiAgICBDZWxsVHlwZVtDZWxsVHlwZVtcIkV4cGFuZFwiXSA9IDldID0gXCJFeHBhbmRcIjtcbiAgICAvKiogIERlZmluZXMgQ2VsbFR5cGUgYXMgSGVhZGVySW5kZW50ICovXG4gICAgQ2VsbFR5cGVbQ2VsbFR5cGVbXCJIZWFkZXJJbmRlbnRcIl0gPSAxMF0gPSBcIkhlYWRlckluZGVudFwiO1xuICAgIC8qKiAgRGVmaW5lcyBDZWxsVHlwZSBhcyBTdGFja2VkSGVhZGVyICovXG4gICAgQ2VsbFR5cGVbQ2VsbFR5cGVbXCJTdGFja2VkSGVhZGVyXCJdID0gMTFdID0gXCJTdGFja2VkSGVhZGVyXCI7XG4gICAgLyoqICBEZWZpbmVzIENlbGxUeXBlIGFzIERldGFpbEhlYWRlciAqL1xuICAgIENlbGxUeXBlW0NlbGxUeXBlW1wiRGV0YWlsSGVhZGVyXCJdID0gMTJdID0gXCJEZXRhaWxIZWFkZXJcIjtcbiAgICAvKiogIERlZmluZXMgQ2VsbFR5cGUgYXMgRGV0YWlsRXhwYW5kICovXG4gICAgQ2VsbFR5cGVbQ2VsbFR5cGVbXCJEZXRhaWxFeHBhbmRcIl0gPSAxM10gPSBcIkRldGFpbEV4cGFuZFwiO1xuICAgIC8qKiAgRGVmaW5lcyBDZWxsVHlwZSBhcyBDb21tYW5kQ29sdW1uICovXG4gICAgQ2VsbFR5cGVbQ2VsbFR5cGVbXCJDb21tYW5kQ29sdW1uXCJdID0gMTRdID0gXCJDb21tYW5kQ29sdW1uXCI7XG4gICAgLyoqICBEZWZpbmVzIENlbGxUeXBlIGFzIERldGFpbEZvb3RlckludGVudCAqL1xuICAgIENlbGxUeXBlW0NlbGxUeXBlW1wiRGV0YWlsRm9vdGVySW50ZW50XCJdID0gMTVdID0gXCJEZXRhaWxGb290ZXJJbnRlbnRcIjtcbiAgICAvKiogIERlZmluZXMgQ2VsbFR5cGUgYXMgUm93RHJhZyAqL1xuICAgIENlbGxUeXBlW0NlbGxUeXBlW1wiUm93RHJhZ0ljb25cIl0gPSAxNl0gPSBcIlJvd0RyYWdJY29uXCI7XG4gICAgLyoqICBEZWZpbmVzIENlbGxUeXBlIGFzIFJvd0RyYWdIZWFkZXIgKi9cbiAgICBDZWxsVHlwZVtDZWxsVHlwZVtcIlJvd0RyYWdISWNvblwiXSA9IDE3XSA9IFwiUm93RHJhZ0hJY29uXCI7XG59KShDZWxsVHlwZSB8fCAoQ2VsbFR5cGUgPSB7fSkpO1xuLyoqXG4gKiBEZWZpbmVzIHR5cGVzIG9mIFJlbmRlclxuICpcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IHZhciBSZW5kZXJUeXBlO1xuKGZ1bmN0aW9uIChSZW5kZXJUeXBlKSB7XG4gICAgLyoqICBEZWZpbmVzIFJlbmRlclR5cGUgYXMgSGVhZGVyICovXG4gICAgUmVuZGVyVHlwZVtSZW5kZXJUeXBlW1wiSGVhZGVyXCJdID0gMF0gPSBcIkhlYWRlclwiO1xuICAgIC8qKiAgRGVmaW5lcyBSZW5kZXJUeXBlIGFzIENvbnRlbnQgKi9cbiAgICBSZW5kZXJUeXBlW1JlbmRlclR5cGVbXCJDb250ZW50XCJdID0gMV0gPSBcIkNvbnRlbnRcIjtcbiAgICAvKiogIERlZmluZXMgUmVuZGVyVHlwZSBhcyBTdW1tYXJ5ICovXG4gICAgUmVuZGVyVHlwZVtSZW5kZXJUeXBlW1wiU3VtbWFyeVwiXSA9IDJdID0gXCJTdW1tYXJ5XCI7XG59KShSZW5kZXJUeXBlIHx8IChSZW5kZXJUeXBlID0ge30pKTtcbi8qKlxuICogRGVmaW5lcyBQcmVkZWZpbmVkIHRvb2xiYXIgaXRlbXMuXG4gKlxuICogQGhpZGRlblxuICovXG5leHBvcnQgdmFyIFRvb2xiYXJJdGVtO1xuKGZ1bmN0aW9uIChUb29sYmFySXRlbSkge1xuICAgIFRvb2xiYXJJdGVtW1Rvb2xiYXJJdGVtW1wiQWRkXCJdID0gMF0gPSBcIkFkZFwiO1xuICAgIFRvb2xiYXJJdGVtW1Rvb2xiYXJJdGVtW1wiRWRpdFwiXSA9IDFdID0gXCJFZGl0XCI7XG4gICAgVG9vbGJhckl0ZW1bVG9vbGJhckl0ZW1bXCJVcGRhdGVcIl0gPSAyXSA9IFwiVXBkYXRlXCI7XG4gICAgVG9vbGJhckl0ZW1bVG9vbGJhckl0ZW1bXCJEZWxldGVcIl0gPSAzXSA9IFwiRGVsZXRlXCI7XG4gICAgVG9vbGJhckl0ZW1bVG9vbGJhckl0ZW1bXCJDYW5jZWxcIl0gPSA0XSA9IFwiQ2FuY2VsXCI7XG4gICAgVG9vbGJhckl0ZW1bVG9vbGJhckl0ZW1bXCJQcmludFwiXSA9IDVdID0gXCJQcmludFwiO1xuICAgIFRvb2xiYXJJdGVtW1Rvb2xiYXJJdGVtW1wiU2VhcmNoXCJdID0gNl0gPSBcIlNlYXJjaFwiO1xuICAgIFRvb2xiYXJJdGVtW1Rvb2xiYXJJdGVtW1wiQ29sdW1uQ2hvb3NlclwiXSA9IDddID0gXCJDb2x1bW5DaG9vc2VyXCI7XG4gICAgVG9vbGJhckl0ZW1bVG9vbGJhckl0ZW1bXCJQZGZFeHBvcnRcIl0gPSA4XSA9IFwiUGRmRXhwb3J0XCI7XG4gICAgVG9vbGJhckl0ZW1bVG9vbGJhckl0ZW1bXCJFeGNlbEV4cG9ydFwiXSA9IDldID0gXCJFeGNlbEV4cG9ydFwiO1xuICAgIFRvb2xiYXJJdGVtW1Rvb2xiYXJJdGVtW1wiQ3N2RXhwb3J0XCJdID0gMTBdID0gXCJDc3ZFeHBvcnRcIjtcbiAgICBUb29sYmFySXRlbVtUb29sYmFySXRlbVtcIldvcmRFeHBvcnRcIl0gPSAxMV0gPSBcIldvcmRFeHBvcnRcIjtcbn0pKFRvb2xiYXJJdGVtIHx8IChUb29sYmFySXRlbSA9IHt9KSk7XG4vKipcbiAqIERlZmluZXMgdHlwZXMgb2YgcmVzcG9uc2l2ZSBkaWFsb2dzXG4gKlxuICogQGhpZGRlblxuICovXG5leHBvcnQgdmFyIFJlc3BvbnNpdmVEaWFsb2dBY3Rpb247XG4oZnVuY3Rpb24gKFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24pIHtcbiAgICAvKiogIERlZmluZXMgZGlhbG9nIHR5cGUgYXMgRWRpdCAqL1xuICAgIFJlc3BvbnNpdmVEaWFsb2dBY3Rpb25bUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbltcImlzRWRpdFwiXSA9IDBdID0gXCJpc0VkaXRcIjtcbiAgICAvKiogIERlZmluZXMgZGlhbG9nIHR5cGUgYXMgQWRkICovXG4gICAgUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbltSZXNwb25zaXZlRGlhbG9nQWN0aW9uW1wiaXNBZGRcIl0gPSAxXSA9IFwiaXNBZGRcIjtcbiAgICAvKiogIERlZmluZXMgZGlhbG9nIHR5cGUgYXMgU29ydCAqL1xuICAgIFJlc3BvbnNpdmVEaWFsb2dBY3Rpb25bUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbltcImlzU29ydFwiXSA9IDJdID0gXCJpc1NvcnRcIjtcbiAgICAvKiogIERlZmluZXMgZGlhbG9nIHR5cGUgYXMgRmlsdGVyICovXG4gICAgUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbltSZXNwb25zaXZlRGlhbG9nQWN0aW9uW1wiaXNGaWx0ZXJcIl0gPSAzXSA9IFwiaXNGaWx0ZXJcIjtcbiAgICAvKiogIERlZmluZXMgZGlhbG9nIHR5cGUgYXMgQ29sTWVudSAqL1xuICAgIFJlc3BvbnNpdmVEaWFsb2dBY3Rpb25bUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbltcImlzQ29sTWVudVwiXSA9IDRdID0gXCJpc0NvbE1lbnVcIjtcbiAgICAvKiogIERlZmluZXMgZGlhbG9nIHR5cGUgYXMgQ29sdW1DaG9vc2VyICovXG4gICAgUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbltSZXNwb25zaXZlRGlhbG9nQWN0aW9uW1wiaXNDb2x1bW5DaG9vc2VyXCJdID0gNV0gPSBcImlzQ29sdW1uQ2hvb3NlclwiO1xufSkoUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbiB8fCAoUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbiA9IHt9KSk7XG4vKipcbiAqIERlZmluZXMgcmVzcG9uc2l2ZSB0b29sYmFyIGFjdGlvbnNcbiAqXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCB2YXIgUmVzcG9uc2l2ZVRvb2xiYXJBY3Rpb247XG4oZnVuY3Rpb24gKFJlc3BvbnNpdmVUb29sYmFyQWN0aW9uKSB7XG4gICAgLyoqICBEZWZpbmVzIGluaXRpYWwgcmVzcG9uc2l2ZSB0b29sYmFyIGJ1dHRvbnMgKi9cbiAgICBSZXNwb25zaXZlVG9vbGJhckFjdGlvbltSZXNwb25zaXZlVG9vbGJhckFjdGlvbltcImlzSW5pdGlhbFwiXSA9IDBdID0gXCJpc0luaXRpYWxcIjtcbiAgICAvKiogIERlZmluZXMgcmVzcG9uc2l2ZSB0b29sYmFyIHNlYXJjaCAqL1xuICAgIFJlc3BvbnNpdmVUb29sYmFyQWN0aW9uW1Jlc3BvbnNpdmVUb29sYmFyQWN0aW9uW1wiaXNTZWFyY2hcIl0gPSAxXSA9IFwiaXNTZWFyY2hcIjtcbn0pKFJlc3BvbnNpdmVUb29sYmFyQWN0aW9uIHx8IChSZXNwb25zaXZlVG9vbGJhckFjdGlvbiA9IHt9KSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/grid.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/grid.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EditSettings: () => (/* binding */ EditSettings),\n/* harmony export */   FilterSettings: () => (/* binding */ FilterSettings),\n/* harmony export */   Grid: () => (/* binding */ Grid),\n/* harmony export */   GroupSettings: () => (/* binding */ GroupSettings),\n/* harmony export */   InfiniteScrollSettings: () => (/* binding */ InfiniteScrollSettings),\n/* harmony export */   LoadingIndicator: () => (/* binding */ LoadingIndicator),\n/* harmony export */   Predicate: () => (/* binding */ Predicate),\n/* harmony export */   ResizeSettings: () => (/* binding */ ResizeSettings),\n/* harmony export */   RowDropSettings: () => (/* binding */ RowDropSettings),\n/* harmony export */   SearchSettings: () => (/* binding */ SearchSettings),\n/* harmony export */   SelectionSettings: () => (/* binding */ SelectionSettings),\n/* harmony export */   SortDescriptor: () => (/* binding */ SortDescriptor),\n/* harmony export */   SortSettings: () => (/* binding */ SortSettings),\n/* harmony export */   TextWrapSettings: () => (/* binding */ TextWrapSettings)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/manager.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/util.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/adaptors.js\");\n/* harmony import */ var _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-popups */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-popups@29.1.37/node_modules/@syncfusion/ej2-popups/src/spinner/spinner.js\");\n/* harmony import */ var _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! @syncfusion/ej2-popups */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-popups@29.1.37/node_modules/@syncfusion/ej2-popups/src/tooltip/tooltip.js\");\n/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _renderer_render__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../renderer/render */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/render.js\");\n/* harmony import */ var _models_column__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../models/column */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column.js\");\n/* harmony import */ var _enum__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _renderer_row_renderer__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../renderer/row-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-renderer.js\");\n/* harmony import */ var _renderer_cell_renderer__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../renderer/cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\n/* harmony import */ var _services_cell_render_factory__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../services/cell-render-factory */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/cell-render-factory.js\");\n/* harmony import */ var _services_service_locator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../services/service-locator */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/service-locator.js\");\n/* harmony import */ var _services_value_formatter__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../services/value-formatter */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/value-formatter.js\");\n/* harmony import */ var _services_renderer_factory__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../services/renderer-factory */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/renderer-factory.js\");\n/* harmony import */ var _services_width_controller__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../services/width-controller */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/width-controller.js\");\n/* harmony import */ var _services_aria_service__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../services/aria-service */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/aria-service.js\");\n/* harmony import */ var _services_focus_strategy__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../services/focus-strategy */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/focus-strategy.js\");\n/* harmony import */ var _models_page_settings__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../models/page-settings */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/page-settings.js\");\n/* harmony import */ var _models_column_chooser_settings__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../models/column-chooser-settings */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column-chooser-settings.js\");\n/* harmony import */ var _actions_selection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../actions/selection */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/selection.js\");\n/* harmony import */ var _actions_search__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../actions/search */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/search.js\");\n/* harmony import */ var _actions_show_hide__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../actions/show-hide */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/show-hide.js\");\n/* harmony import */ var _actions_scroll__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../actions/scroll */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/scroll.js\");\n/* harmony import */ var _actions_print__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../actions/print */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/print.js\");\n/* harmony import */ var _models_aggregate__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../models/aggregate */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/aggregate.js\");\n/* harmony import */ var _actions_clipboard__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../actions/clipboard */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/clipboard.js\");\n/* harmony import */ var _actions_logger__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../actions/logger */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/logger.js\");\n/* harmony import */ var _services_row_model_generator__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../services/row-model-generator */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/row-model-generator.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n/* harmony import */ var _renderer_header_cell_renderer__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../renderer/header-cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-cell-renderer.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Represents the field name and direction of sort column.\n */\nvar SortDescriptor = /** @class */ (function (_super) {\n    __extends(SortDescriptor, _super);\n    function SortDescriptor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], SortDescriptor.prototype, \"field\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], SortDescriptor.prototype, \"direction\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], SortDescriptor.prototype, \"isFromGroup\", void 0);\n    return SortDescriptor;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the sorting behavior of Grid.\n */\nvar SortSettings = /** @class */ (function (_super) {\n    __extends(SortSettings, _super);\n    function SortSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Collection)([], SortDescriptor)\n    ], SortSettings.prototype, \"columns\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], SortSettings.prototype, \"allowUnsort\", void 0);\n    return SortSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Represents the predicate for the filter column.\n */\nvar Predicate = /** @class */ (function (_super) {\n    __extends(Predicate, _super);\n    function Predicate() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"field\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"operator\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"value\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"matchCase\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Predicate.prototype, \"ignoreAccent\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"predicate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)({})\n    ], Predicate.prototype, \"actualFilterValue\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)({})\n    ], Predicate.prototype, \"actualOperator\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"type\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"ejpredicate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"uid\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"isForeignKey\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Predicate.prototype, \"condition\", void 0);\n    return Predicate;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the infinite scroll behavior of Grid.\n */\nvar InfiniteScrollSettings = /** @class */ (function (_super) {\n    __extends(InfiniteScrollSettings, _super);\n    function InfiniteScrollSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], InfiniteScrollSettings.prototype, \"enableCache\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(3)\n    ], InfiniteScrollSettings.prototype, \"maxBlocks\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(3)\n    ], InfiniteScrollSettings.prototype, \"initialBlocks\", void 0);\n    return InfiniteScrollSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the filtering behavior of the Grid.\n */\nvar FilterSettings = /** @class */ (function (_super) {\n    __extends(FilterSettings, _super);\n    function FilterSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Collection)([], Predicate)\n    ], FilterSettings.prototype, \"columns\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('FilterBar')\n    ], FilterSettings.prototype, \"type\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('OnEnter')\n    ], FilterSettings.prototype, \"mode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], FilterSettings.prototype, \"showFilterBarStatus\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(1500)\n    ], FilterSettings.prototype, \"immediateModeDelay\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], FilterSettings.prototype, \"operators\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], FilterSettings.prototype, \"ignoreAccent\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], FilterSettings.prototype, \"enableInfiniteScrolling\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(50)\n    ], FilterSettings.prototype, \"itemsCount\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Shimmer')\n    ], FilterSettings.prototype, \"loadingIndicator\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], FilterSettings.prototype, \"enableCaseSensitivity\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], FilterSettings.prototype, \"showFilterBarOperator\", void 0);\n    return FilterSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the selection behavior of the Grid.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Row')\n    ], SelectionSettings.prototype, \"mode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Flow')\n    ], SelectionSettings.prototype, \"cellSelectionMode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Single')\n    ], SelectionSettings.prototype, \"type\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], SelectionSettings.prototype, \"checkboxOnly\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], SelectionSettings.prototype, \"persistSelection\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Default')\n    ], SelectionSettings.prototype, \"checkboxMode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], SelectionSettings.prototype, \"enableSimpleMultiRowSelection\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], SelectionSettings.prototype, \"enableToggle\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], SelectionSettings.prototype, \"allowColumnSelection\", void 0);\n    return SelectionSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the search behavior of the Grid.\n */\nvar SearchSettings = /** @class */ (function (_super) {\n    __extends(SearchSettings, _super);\n    function SearchSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)([])\n    ], SearchSettings.prototype, \"fields\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('')\n    ], SearchSettings.prototype, \"key\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('contains')\n    ], SearchSettings.prototype, \"operator\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], SearchSettings.prototype, \"ignoreCase\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], SearchSettings.prototype, \"ignoreAccent\", void 0);\n    return SearchSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the row drop settings of the Grid.\n */\nvar RowDropSettings = /** @class */ (function (_super) {\n    __extends(RowDropSettings, _super);\n    function RowDropSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], RowDropSettings.prototype, \"targetID\", void 0);\n    return RowDropSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the text wrap settings of the Grid.\n */\nvar TextWrapSettings = /** @class */ (function (_super) {\n    __extends(TextWrapSettings, _super);\n    function TextWrapSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Both')\n    ], TextWrapSettings.prototype, \"wrapMode\", void 0);\n    return TextWrapSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the resize behavior of the Grid.\n */\nvar ResizeSettings = /** @class */ (function (_super) {\n    __extends(ResizeSettings, _super);\n    function ResizeSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Normal')\n    ], ResizeSettings.prototype, \"mode\", void 0);\n    return ResizeSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the group behavior of the Grid.\n */\nvar GroupSettings = /** @class */ (function (_super) {\n    __extends(GroupSettings, _super);\n    function GroupSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], GroupSettings.prototype, \"showDropArea\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], GroupSettings.prototype, \"allowReordering\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], GroupSettings.prototype, \"showToggleButton\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], GroupSettings.prototype, \"showGroupedColumn\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], GroupSettings.prototype, \"showUngroupButton\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], GroupSettings.prototype, \"disablePageWiseAggregates\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)([])\n    ], GroupSettings.prototype, \"columns\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], GroupSettings.prototype, \"captionTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], GroupSettings.prototype, \"enableLazyLoading\", void 0);\n    return GroupSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the edit behavior of the Grid.\n */\nvar EditSettings = /** @class */ (function (_super) {\n    __extends(EditSettings, _super);\n    function EditSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], EditSettings.prototype, \"allowAdding\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], EditSettings.prototype, \"allowEditing\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], EditSettings.prototype, \"allowDeleting\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Normal')\n    ], EditSettings.prototype, \"mode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], EditSettings.prototype, \"allowEditOnDblClick\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], EditSettings.prototype, \"showConfirmDialog\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], EditSettings.prototype, \"showDeleteConfirmDialog\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], EditSettings.prototype, \"template\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], EditSettings.prototype, \"headerTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], EditSettings.prototype, \"footerTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Top')\n    ], EditSettings.prototype, \"newRowPosition\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)({})\n    ], EditSettings.prototype, \"dialog\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], EditSettings.prototype, \"allowNextRowEdit\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], EditSettings.prototype, \"showAddNewRow\", void 0);\n    return EditSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the Loading Indicator of the Grid.\n */\nvar LoadingIndicator = /** @class */ (function (_super) {\n    __extends(LoadingIndicator, _super);\n    function LoadingIndicator() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Spinner')\n    ], LoadingIndicator.prototype, \"indicatorType\", void 0);\n    return LoadingIndicator;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Represents the Grid component.\n * ```html\n * <div id=\"grid\"></div>\n * <script>\n *  var gridObj = new Grid({ allowPaging: true });\n *  gridObj.appendTo(\"#grid\");\n * </script>\n * ```\n */\nvar Grid = /** @class */ (function (_super) {\n    __extends(Grid, _super);\n    /**\n     * Constructor for creating the component\n     *\n     * @param {GridModel} options - specifies the options\n     * @param {string | HTMLElement} element - specifies the element\n     * @hidden\n     */\n    function Grid(options, element) {\n        var _this_1 = _super.call(this, options, element) || this;\n        _this_1.isPreventScrollEvent = false;\n        _this_1.inViewIndexes = [];\n        _this_1.keyA = false;\n        _this_1.frozenRightCount = 0;\n        _this_1.freezeColumnRefresh = true;\n        _this_1.rightcount = 0;\n        _this_1.frozenLeftCount = 0;\n        _this_1.leftcount = 0;\n        _this_1.tablesCount = 1;\n        _this_1.movableCount = 0;\n        _this_1.movablecount = 0;\n        _this_1.fixedcount = 0;\n        _this_1.fixedCount = 0;\n        _this_1.visibleFrozenLeft = 0;\n        _this_1.visibleFrozenFixed = 0;\n        _this_1.isPreparedFrozenColumns = false;\n        _this_1.visibleFrozenRight = 0;\n        _this_1.visibleMovable = 0;\n        _this_1.frozenLeftColumns = [];\n        _this_1.frozenRightColumns = [];\n        _this_1.movableColumns = [];\n        _this_1.fixedColumns = [];\n        _this_1.stackedLeft = [];\n        _this_1.stackedRight = [];\n        _this_1.stackedFixed = [];\n        _this_1.stackedMovable = [];\n        _this_1.stackedarrayLeft = [];\n        _this_1.stackedarrayRight = [];\n        _this_1.stackedarrayFixed = [];\n        _this_1.stackedarrayMovable = [];\n        _this_1.media = {};\n        _this_1.autoFitColumnsResize = false;\n        /** @hidden */\n        _this_1.tableIndex = 0;\n        _this_1.componentRefresh = _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Component.prototype.refresh;\n        _this_1.isChangeDataSourceCall = false;\n        _this_1.mergedColumns = false;\n        /** @hidden */\n        _this_1.isVirtualAdaptive = false;\n        /** @hidden */\n        /**\n         * * If `requireTemplateRef` is set to false in the load event, then the template element can't be accessed in grid queryCellInfo, and rowDataBound events.\n         * * By default, React's grid queryCellInfo and rowDataBound events allow access to the template element.\n         * * Avoid accessing the template elements in the grid queryCellInfo and rowDataBound events to improve rendering performance by setting this value as false.\n         *\n         * @default true\n         */\n        _this_1.requireTemplateRef = true;\n        /** @hidden */\n        _this_1.vRows = [];\n        /** @hidden */\n        _this_1.vcRows = [];\n        /** @hidden */\n        _this_1.vGroupOffsets = {};\n        /** @hidden */\n        _this_1.rowUid = 0;\n        /** @hidden */\n        _this_1.translateX = 0;\n        /** @hidden */\n        _this_1.isManualRefresh = false;\n        /** @hidden */\n        _this_1.isAutoFitColumns = false;\n        /** @hidden */\n        _this_1.enableDeepCompare = false;\n        /** @hidden */\n        _this_1.totalDataRecordsCount = 0;\n        /** @hidden */\n        _this_1.disableSelectedRecords = [];\n        /** @hidden */\n        _this_1.partialSelectedRecords = [];\n        /** @hidden */\n        _this_1.isSpan = false;\n        /** @hidden */\n        _this_1.islazyloadRequest = false;\n        /** @hidden */\n        _this_1.isAddNewRow = false;\n        /** @hidden */\n        _this_1.addNewRowFocus = true;\n        /** @hidden */\n        _this_1.selectVirtualRowOnAdd = false;\n        /** @hidden */\n        _this_1.lockcolPositionCount = 0;\n        /** @hidden */\n        _this_1.prevPageMoving = false;\n        /** @hidden */\n        _this_1.pageTemplateChange = false;\n        /** @hidden */\n        _this_1.isAutoGen = false;\n        /** @hidden */\n        _this_1.isAutoGenerateColumns = false;\n        /** @hidden */\n        _this_1.pageRequireRefresh = true;\n        _this_1.mediaBindInstance = {};\n        /** @hidden */\n        _this_1.commandDelIndex = undefined;\n        /** @hidden */\n        _this_1.preventAutoFit = false;\n        /** @hidden */\n        _this_1.asyncTimeOut = 50;\n        /** @hidden */\n        _this_1.isExportGrid = false;\n        /** @hidden */\n        _this_1.isWidgetsDestroyed = false;\n        _this_1.enableLogger = false;\n        _this_1.needsID = true;\n        Grid_1.Inject(_actions_selection__WEBPACK_IMPORTED_MODULE_1__.Selection);\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setValue)('mergePersistData', _this_1.mergePersistGridData, _this_1);\n        return _this_1;\n    }\n    Grid_1 = Grid;\n    /**\n     * Get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} returns the persist data\n     */\n    Grid.prototype.getPersistData = function () {\n        var keyEntity = ['pageSettings', 'sortSettings',\n            'filterSettings', 'groupSettings', 'columns', 'searchSettings', 'selectedRowIndex', 'scrollPosition'];\n        var ignoreOnPersist = {\n            pageSettings: ['template', 'pageSizes', 'enableQueryString', 'totalRecordsCount', 'pageCount'],\n            filterSettings: ['type', 'mode', 'showFilterBarStatus', 'immediateModeDelay', 'ignoreAccent'],\n            groupSettings: ['showDropArea', 'showToggleButton', 'showGroupedColumn', 'showUngroupButton',\n                'disablePageWiseAggregates', 'hideCaptionCount'],\n            searchSettings: ['fields', 'operator', 'ignoreCase'],\n            sortSettings: [], columns: [], selectedRowIndex: [], scrollPosition: []\n        };\n        for (var i = 0; i < keyEntity.length; i++) {\n            var currentObject = this[keyEntity[parseInt(i.toString(), 10)]];\n            for (var _i = 0, _a = ignoreOnPersist[keyEntity[parseInt(i.toString(), 10)]]; _i < _a.length; _i++) {\n                var val = _a[_i];\n                delete currentObject[\"\" + val];\n            }\n        }\n        var temp = this.pageSettings.template;\n        var settings = Object.assign({ template: undefined }, this.pageSettings);\n        if (this.enableVirtualization && this.enablePersistence && this.contentModule &&\n            this.contentModule.getPageFromTop && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.scrollPosition) &&\n            !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.scrollPosition.top)) {\n            settings['properties']['currentPage'] = this.contentModule.getPageFromTop(this.scrollPosition.top, { block: 1 });\n        }\n        this.setProperties({ pageSettings: settings }, true);\n        var captionTemplateRef = this.groupSettings.captionTemplate;\n        var isAngularCaptionTemplate = captionTemplateRef && this.isAngular;\n        if (isAngularCaptionTemplate) {\n            delete this.groupSettings['properties']['captionTemplate'];\n        }\n        this.pageTemplateChange = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.pagerTemplate);\n        var persistData = this.addOnPersist(keyEntity);\n        settings.template = temp;\n        this.setProperties({ pageSettings: settings }, true);\n        if (isAngularCaptionTemplate) {\n            this.groupSettings.captionTemplate = captionTemplateRef;\n        }\n        return persistData;\n    };\n    /**\n     * To provide the array of modules needed for component rendering\n     *\n     * @returns {ModuleDeclaration[]} Returns the module Declaration\n     * @hidden\n     */\n    Grid.prototype.requiredModules = function () {\n        this.setFrozenCount();\n        this.enableInfiniteAggrgate();\n        var modules = [];\n        if (this.isDestroyed) {\n            return modules;\n        }\n        if (this.allowFiltering) {\n            modules.push({\n                member: 'filter',\n                args: [this, this.filterSettings, this.serviceLocator],\n                name: 'Filter'\n            });\n        }\n        if (this.allowExcelExport) {\n            modules.push({\n                member: 'ExcelExport',\n                args: [this, this.serviceLocator],\n                name: 'ExcelExport'\n            });\n        }\n        if (this.allowPdfExport) {\n            modules.push({\n                member: 'PdfExport',\n                args: [this],\n                name: 'PdfExport'\n            });\n        }\n        if (this.allowSorting) {\n            modules.push({\n                member: 'sort',\n                args: [this, this.sortSettings, this.sortedColumns, this.serviceLocator],\n                name: 'Sort'\n            });\n        }\n        if (this.allowPaging) {\n            modules.push({\n                member: 'pager',\n                args: [this, this.pageSettings],\n                name: 'Page'\n            });\n        }\n        if (this.allowSelection) {\n            modules.push({\n                member: 'selection',\n                args: [this, this.selectionSettings, this.serviceLocator],\n                name: 'Selection'\n            });\n        }\n        if (this.resizeCheck()) {\n            modules.push({\n                member: 'resize',\n                args: [this],\n                name: 'Resize'\n            });\n        }\n        if (this.allowReordering) {\n            modules.push({\n                member: 'reorder',\n                args: [this],\n                name: 'Reorder'\n            });\n        }\n        if (this.allowRowDragAndDrop) {\n            modules.push({\n                member: 'rowDragAndDrop',\n                args: [this],\n                name: 'RowDD'\n            });\n        }\n        if (this.allowGrouping) {\n            modules.push({\n                member: 'group',\n                args: [this, this.groupSettings, this.sortedColumns, this.serviceLocator],\n                name: 'Group'\n            });\n        }\n        if (this.aggregates.length) {\n            modules.push({ member: 'aggregate', args: [this, this.serviceLocator], name: 'Aggregate' });\n        }\n        if (this.isDetail()) {\n            modules.push({\n                member: 'detailRow',\n                args: [this, this.serviceLocator],\n                name: 'DetailRow'\n            });\n        }\n        if (this.toolbar || this.toolbarTemplate) {\n            modules.push({\n                member: 'toolbar',\n                args: [this, this.serviceLocator],\n                name: 'Toolbar'\n            });\n        }\n        if (this.enableVirtualization || this.enableColumnVirtualization) {\n            modules.push({\n                member: 'virtualscroll',\n                args: [this, this.serviceLocator],\n                name: 'VirtualScroll'\n            });\n        }\n        if (this.getFrozenColumns() || this.frozenRows || this.frozenRightCount || this.frozenLeftCount) {\n            modules.push({ member: 'freeze', args: [this, this.serviceLocator], name: 'Freeze' });\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.columns) && this.isCommandColumn(this.columns)) {\n            modules.push({\n                member: 'commandColumn',\n                args: [this, this.serviceLocator],\n                name: 'CommandColumn'\n            });\n        }\n        if (this.editSettings.allowAdding || this.editSettings.allowDeleting || this.editSettings.allowEditing) {\n            modules.push({\n                member: 'edit',\n                args: [this, this.serviceLocator],\n                name: 'Edit'\n            });\n        }\n        this.extendRequiredModules(modules);\n        return modules;\n    };\n    Grid.prototype.extendRequiredModules = function (modules) {\n        if (this.enableInfiniteScrolling) {\n            modules.push({\n                member: 'infiniteScroll',\n                args: [this, this.serviceLocator],\n                name: 'InfiniteScroll'\n            });\n        }\n        if (this.groupSettings.enableLazyLoading) {\n            modules.push({\n                member: 'lazyLoadGroup',\n                args: [this, this.serviceLocator],\n                name: 'LazyLoadGroup'\n            });\n        }\n        if (this.contextMenuItems) {\n            modules.push({\n                member: 'contextMenu',\n                args: [this, this.serviceLocator],\n                name: 'ContextMenu'\n            });\n        }\n        if (this.showColumnMenu) {\n            modules.push({\n                member: 'columnMenu',\n                args: [this, this.serviceLocator],\n                name: 'ColumnMenu'\n            });\n        }\n        if (this.showColumnChooser) {\n            modules.push({\n                member: 'columnChooser',\n                args: [this, this.serviceLocator],\n                name: 'ColumnChooser'\n            });\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.columns) && this.isForeignKeyEnabled(this.columns)) {\n            modules.push({ member: 'foreignKey', args: [this, this.serviceLocator], name: 'ForeignKey' });\n        }\n        if (this.enableLogger) {\n            modules.push({ member: 'logger', args: [this], name: 'Logger' });\n        }\n    };\n    Grid.prototype.resizeCheck = function () {\n        var autoFitColumns = this.getColumns().filter(function (c) { return c.autoFit === true; }).length ? true : false;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.columnModel) && this.columnModel.length && !(this.columnModel[0] instanceof _models_column__WEBPACK_IMPORTED_MODULE_2__.Column)) {\n            this.columnModel = [];\n        }\n        var columnMenu = this.showColumnMenu && (!this.columnMenuItems || this.columnMenuItems\n            .filter(function (c) { return c === 'AutoFit' || c === 'AutoFitAll'; }).length) ? true : false;\n        var contextMenu = this.contextMenuItems && this.contextMenuItems\n            .filter(function (c) { return c === 'AutoFit' || c === 'AutoFitAll'; }).length ? true : false;\n        return this.allowResizing || this.autoFitColumnsResize || autoFitColumns || columnMenu || contextMenu;\n    };\n    /**\n     * For internal use only - Initialize the event handler;\n     *\n     * @returns {void}\n     * @private\n     */\n    Grid.prototype.preRender = function () {\n        this.serviceLocator = new _services_service_locator__WEBPACK_IMPORTED_MODULE_3__.ServiceLocator;\n        this.initProperties();\n        this.initializeServices();\n    };\n    Grid.prototype.initProperties = function () {\n        this.isInitial = true;\n        this.sortedColumns = [];\n        this.inViewIndexes = [];\n        this.mediaCol = [];\n        this.isInitialLoad = false;\n        this.allowServerDataBinding = false;\n        this.ignoreCollectionWatch = true;\n        this.mergeCells = {};\n        this.isEdit = false;\n        this.checkAllRows = 'None';\n        this.isCheckBoxSelection = false;\n        this.isPersistSelection = false;\n        this.componentRefresh = _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Component.prototype.refresh;\n        this.freezeColumnRefresh = true;\n        this.filterOperators = {\n            contains: 'contains', endsWith: 'endswith', equal: 'equal', greaterThan: 'greaterthan', greaterThanOrEqual: 'greaterthanorequal',\n            lessThan: 'lessthan', lessThanOrEqual: 'lessthanorequal', notEqual: 'notequal', startsWith: 'startswith', wildCard: 'wildcard',\n            isNull: 'isnull', notNull: 'notnull', like: 'like'\n        };\n        this.defaultLocale = {\n            EmptyRecord: 'No records to display',\n            True: 'true',\n            False: 'false',\n            InvalidFilterMessage: 'Invalid Filter Data',\n            GroupDropArea: 'Drag a column header here to group its column',\n            UnGroup: 'Click here to ungroup',\n            UnGroupButton: 'Click here to ungroup',\n            GroupDisable: 'Grouping is disabled for this column',\n            FilterbarTitle: '\\'s filter bar cell',\n            EmptyDataSourceError: 'DataSource must not be empty at initial load since columns are generated from dataSource in AutoGenerate Column Grid',\n            // Toolbar Items\n            Add: 'Add',\n            Edit: 'Edit',\n            Cancel: 'Cancel',\n            Update: 'Update',\n            Delete: 'Delete',\n            Print: 'Print',\n            Pdfexport: 'PDF Export',\n            Excelexport: 'Excel Export',\n            Wordexport: 'Word Export',\n            Csvexport: 'CSV Export',\n            Search: 'Search',\n            Columnchooser: 'Columns',\n            Save: 'Save',\n            Item: 'item',\n            Items: 'items',\n            EditOperationAlert: 'No records selected for edit operation',\n            DeleteOperationAlert: 'No records selected for delete operation',\n            SaveButton: 'Save',\n            OKButton: 'OK',\n            CancelButton: 'Cancel',\n            EditFormTitle: 'Details of ',\n            AddFormTitle: 'Add New Record',\n            BatchSaveConfirm: 'Are you sure you want to save changes?',\n            BatchSaveLostChanges: 'Unsaved changes will be lost. Are you sure you want to continue?',\n            ConfirmDelete: 'Are you sure you want to Delete Record?',\n            CancelEdit: 'Are you sure you want to Cancel the changes?',\n            ChooseColumns: 'Choose Column',\n            ColumnMenu: 'Column Menu',\n            SearchColumns: 'search columns',\n            Matchs: 'No matches found',\n            FilterButton: 'Filter',\n            FilterTitle: 'Filter',\n            FilterIcon: 'Filter',\n            ClearButton: 'Clear',\n            StartsWith: 'Starts With',\n            NotStartsWith: 'Does Not Start With',\n            Like: 'Like',\n            EndsWith: 'Ends With',\n            NotEndsWith: 'Does Not End With',\n            Contains: 'Contains',\n            NotContains: 'Does Not Contain',\n            IsNull: 'Null',\n            NotNull: 'Not Null',\n            IsEmpty: 'Empty',\n            IsNotEmpty: 'Not Empty',\n            Equal: 'Equal',\n            NotEqual: 'Not Equal',\n            LessThan: 'Less Than',\n            LessThanOrEqual: 'Less Than Or Equal',\n            GreaterThan: 'Greater Than',\n            GreaterThanOrEqual: 'Greater Than Or Equal',\n            In: 'In',\n            NotIn: 'Not In',\n            ChooseDate: 'Choose a Date',\n            EnterValue: 'Enter the value',\n            Copy: 'Copy',\n            Group: 'Group by this column',\n            Ungroup: 'Ungroup by this column',\n            GroupButton: 'Group button',\n            UnGroupAria: 'ungroup button',\n            GroupSeperator: 'Separator for the grouped columns',\n            UnGroupIcon: 'ungroup the grouped column ',\n            GroupedSortIcon: 'sort the grouped column ',\n            GroupedDrag: 'Drag the grouped column',\n            GroupCaption: ' is groupcaption cell',\n            CheckBoxLabel: 'checkbox',\n            SelectAllCheckbox: 'Select all checkbox',\n            SelectRow: 'Select row',\n            autoFitAll: 'Autofit all columns',\n            autoFit: 'Autofit this column',\n            AutoFitAll: 'Autofit all columns',\n            AutoFit: 'Autofit this column',\n            Export: 'Export',\n            FirstPage: 'First Page',\n            LastPage: 'Last Page',\n            PreviousPage: 'Previous Page',\n            NextPage: 'Next Page',\n            SortAscending: 'Sort Ascending',\n            SortDescending: 'Sort Descending',\n            EditRecord: 'Edit Record',\n            DeleteRecord: 'Delete Record',\n            FilterMenu: 'Filter',\n            SelectAll: 'Select All',\n            AddCurrentSelection: 'Add current selection to filter',\n            Blanks: 'Blanks',\n            FilterTrue: 'True',\n            FilterFalse: 'False',\n            NoResult: 'No matches found',\n            ClearFilter: 'Clear Filter',\n            Clear: 'Clear',\n            NumberFilter: 'Number Filters',\n            TextFilter: 'Text Filters',\n            DateFilter: 'Date Filters',\n            DateTimeFilter: 'DateTime Filters',\n            MatchCase: 'Match Case',\n            Between: 'Between',\n            CustomFilter: 'Custom Filter',\n            CustomFilterPlaceHolder: 'Enter the value',\n            CustomFilterDatePlaceHolder: 'Choose a date',\n            AND: 'AND',\n            OR: 'OR',\n            ShowRowsWhere: 'Show rows where:',\n            ToolbarMenuDialogARIA: 'Toolbar menu dialog',\n            FilterMenuDialogARIA: 'Filter menu',\n            ExcelFilterDialogARIA: 'Excel filter',\n            CheckBoxFilterDialogARIA: 'Checkbox filter',\n            DialogEditARIA: 'Edit dialog',\n            ColumnMenuDialogARIA: 'Column menu dialog',\n            CustomFilterDialogARIA: 'Customer filter dialog',\n            SortAtoZ: 'Sort A to Z',\n            SortZtoA: 'Sort Z to A',\n            SortByOldest: 'Sort by Oldest',\n            SortByNewest: 'Sort by Newest',\n            SortSmallestToLargest: 'Sort Smallest to Largest',\n            SortLargestToSmallest: 'Sort Largest to Smallest',\n            Sort: 'Sort',\n            SortIcon: 'Sort',\n            FilterDescription: 'Press Alt Down to open filter Menu',\n            SortDescription: 'Press Enter to sort',\n            ColumnMenuDescription: 'Press Alt Down to open Column Menu',\n            GroupDescription: 'Press Ctrl space to group',\n            ColumnHeader: ' column header ',\n            TemplateCell: ' is template cell',\n            CommandColumnAria: 'is Command column column header ',\n            DialogEdit: 'Dialog edit',\n            ClipBoard: 'clipboard',\n            AscendingText: 'Ascending',\n            DescendingText: 'Descending',\n            NoneText: 'None',\n            Expanded: 'Expanded',\n            Collapsed: 'Collapsed'\n        };\n        this.keyConfigs = {\n            downArrow: 'downarrow',\n            upArrow: 'uparrow',\n            rightArrow: 'rightarrow',\n            leftArrow: 'leftarrow',\n            shiftDown: 'shift+downarrow',\n            shiftUp: 'shift+uparrow',\n            shiftRight: 'shift+rightarrow',\n            shiftLeft: 'shift+leftarrow',\n            home: 'home',\n            end: 'end',\n            escape: 'escape',\n            ctrlHome: 'ctrl+home',\n            ctrlEnd: 'ctrl+end',\n            pageUp: 'pageup',\n            pageDown: 'pagedown',\n            ctrlAltPageUp: 'ctrl+alt+pageup',\n            ctrlAltPageDown: 'ctrl+alt+pagedown',\n            altPageUp: 'alt+pageup',\n            altPageDown: 'alt+pagedown',\n            altDownArrow: 'alt+downarrow',\n            altUpArrow: 'alt+uparrow',\n            ctrlDownArrow: 'ctrl+downarrow',\n            ctrlUpArrow: 'ctrl+uparrow',\n            ctrlPlusA: 'ctrl+A',\n            ctrlPlusP: 'ctrl+P',\n            insert: 'insert',\n            delete: 'delete',\n            f2: 'f2',\n            enter: 'enter',\n            ctrlEnter: 'ctrl+enter',\n            shiftEnter: 'shift+enter',\n            tab: 'tab',\n            shiftTab: 'shift+tab',\n            space: 'space',\n            ctrlPlusC: 'ctrl+C',\n            ctrlShiftPlusH: 'ctrl+shift+H',\n            ctrlSpace: 'ctrl+space',\n            ctrlLeftArrow: 'ctrl+leftarrow',\n            ctrlRightArrow: 'ctrl+rightarrow'\n        };\n    };\n    /**\n     * For internal use only - To Initialize the component rendering.\n     *\n     * @returns {void}\n     * @private\n     */\n    Grid.prototype.render = function () {\n        this.log(['module_missing', 'promise_enabled', 'locale_missing', 'check_datasource_columns']);\n        this.ariaService.setOptions(this.element, { role: 'grid' });\n        (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__.createSpinner)({ target: this.element, cssClass: this.cssClass ? this.cssClass : null }, this.createElement);\n        this.renderModule = new _renderer_render__WEBPACK_IMPORTED_MODULE_5__.Render(this, this.serviceLocator);\n        this.searchModule = new _actions_search__WEBPACK_IMPORTED_MODULE_6__.Search(this);\n        this.scrollModule = new _actions_scroll__WEBPACK_IMPORTED_MODULE_7__.Scroll(this);\n        this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.initialLoad, {});\n        if (this.pageSettings.enableQueryString) {\n            var pageValue = new URL(window.location.href).searchParams.get('page');\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(pageValue) && window.location.href.indexOf('?page=') > 0) {\n                var currentPageValue = parseInt(pageValue, 10);\n                this.setProperties({ pageSettings: { currentPage: currentPageValue } }, true);\n                this.pageSettings.currentPage = currentPageValue;\n            }\n        }\n        if ((this.getDataModule().dataManager.dataSource.offline === true || this.getDataModule().dataManager.dataSource.url === undefined)\n            && !(!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.dataSource) && this.dataSource.result)) {\n            this.isVirtualAdaptive = true;\n        }\n        if (this.aggregateModule && this.aggregates.length) {\n            for (var i = 0; i < this.aggregates.length; i++) {\n                for (var j = 0; j < this.aggregates[parseInt(i.toString(), 10)].columns.length; j++) {\n                    var column = this.aggregates[parseInt(i.toString(), 10)].columns[parseInt(j.toString(), 10)];\n                    if (column['types']) {\n                        column.type = column['types'];\n                    }\n                }\n            }\n        }\n        if (this.isReact) {\n            var args = { requireTemplateRef: this.requireTemplateRef };\n            this.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_8__.load, args);\n            if (!args.requireTemplateRef) {\n                this.requireTemplateRef = args.requireTemplateRef;\n            }\n        }\n        else {\n            this.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_8__.load);\n        }\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.prepareColumns)(this.columns, this.enableColumnVirtualization, this);\n        if (this.enableColumnVirtualization && this.isChangeDataSourceCall && this.columnModel) {\n            this.columnModel = [];\n            this.updateColumnModel(this.columns);\n        }\n        this.isPreparedFrozenColumns = true;\n        if (this.enablePersistence) {\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.columnsPrepared, {});\n        }\n        this.getMediaColumns();\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.setColumnIndex)(this.columns);\n        if (this.isFrozenGrid() && !this.mergedColumns) {\n            this.setInitialFrozenColumnIndex(this.columns);\n        }\n        this.checkLockColumns(this.columns);\n        this.getColumns();\n        this.processModel();\n        this.gridRender();\n        this.wireEvents();\n        this.addListener();\n        this.updateDefaultCursor();\n        this.updateStackedFilter();\n        if (this.loadingIndicator.indicatorType === 'Spinner') {\n            this.showSpinner();\n        }\n        this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.initialEnd, {});\n        if (this.loadingIndicator.indicatorType === 'Shimmer') {\n            this.refreshMaskRow();\n        }\n        if (this.refreshing) {\n            this.trigger('created');\n        }\n    };\n    Grid.prototype.setInitialFrozenColumnIndex = function (columns) {\n        for (var i = 0; i < columns.length; i++) {\n            var column = columns[parseInt(i.toString(), 10)];\n            column[\"\" + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.initialFrozenColumnIndex] = column.index;\n            if (column.columns) {\n                this.setInitialFrozenColumnIndex(column.columns);\n            }\n        }\n    };\n    /**\n     * By default, grid shows the spinner for all its actions. You can use this method to show spinner at your needed time.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.showSpinner = function () {\n        if (!this.isExportGrid) {\n            (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__.showSpinner)(this.element);\n        }\n    };\n    /**\n     * By default, grid shows the spinner for all its actions. You can use this method to show spinner at your needed time.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.hideSpinner = function () {\n        if (!this.isExportGrid) {\n            (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__.hideSpinner)(this.element);\n        }\n    };\n    Grid.prototype.showMaskRow = function (axisDirection, dialogElement) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.headerModule) || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.contentModule)) {\n            return;\n        }\n        var gridHeader = this.getHeaderContent().firstChild;\n        var gridContent = this.getContent().firstChild;\n        var gridFooter = this.getFooterContent();\n        if (dialogElement) {\n            var dialogHolder = dialogElement.querySelector('.e-checkboxlist');\n            var maskRowCount = Math.floor(dialogHolder.getBoundingClientRect().height / this.getRowHeight());\n            var maskTemplate = '<div class=\"e-ftrchk e-mask-ftrchk\">'\n                + '<div class=\"e-checkbox-wrapper\"><input class=\"e-chk-hidden\">'\n                + this.getShimmerTemplate() + this.getShimmerTemplate() + '</div></div>';\n            dialogHolder.innerHTML = '';\n            for (var i = 0; i < maskRowCount; i++) {\n                dialogHolder.innerHTML += maskTemplate;\n                dialogHolder.querySelector('.e-ftrchk.e-mask-ftrchk').style.width = '100%';\n                dialogHolder.querySelector('.e-checkbox-wrapper').style.width = '100%';\n                var maskSpan = [].slice.call(dialogHolder\n                    .querySelectorAll('.e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)'));\n                maskSpan[0].classList.add('e-mask-checkbox-filter-intent');\n                maskSpan[1].classList.add('e-mask-checkbox-filter-span-intent');\n            }\n            return;\n        }\n        if ((!this.enableRtl && !this.getHeaderContent().style.paddingRight)\n            || (this.enableRtl && !this.getHeaderContent().style.paddingLeft)) {\n            gridContent.style.overflowY = 'hidden';\n        }\n        if (!this.isInitialLoad && !this.getColumns().length) {\n            var contentHeight = gridContent.getBoundingClientRect().height;\n            var maskTableHeight = contentHeight === 0 ? this.allowPaging ? this.pageSettings.pageSize * this.getRowHeight()\n                : window.innerHeight : contentHeight;\n            var contentRowCount = Math.ceil(maskTableHeight / this.getRowHeight());\n            if (this.rowRenderingMode !== 'Vertical') {\n                this.headerMaskTable = this.createEmptyMaskTable(gridHeader, 1);\n            }\n            this.contentMaskTable = this.createEmptyMaskTable(gridContent, contentRowCount);\n            return;\n        }\n        this.maskRowContentScroll = (this.enableVirtualization || this.enableColumnVirtualization) && axisDirection ? true : false;\n        if (!this.contentMaskTable) {\n            var content = gridContent;\n            if (this.enableVirtualization || this.enableColumnVirtualization) {\n                content = content.querySelector('.e-virtualtable');\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(content.querySelector('tbody'))) {\n                this.contentMaskTable = this.createMaskTable(content, this.getContentMaskColumns(), axisDirection);\n            }\n        }\n        if (!this.headerMaskTable && (this.isFrozenGrid() || (this.enableColumnVirtualization && axisDirection === 'X'))) {\n            var content = gridHeader;\n            if (this.enableColumnVirtualization && axisDirection === 'X') {\n                content = content.querySelector('.e-virtualtable');\n            }\n            this.headerMaskTable = this.createMaskTable(content, this.getContentMaskColumns(), axisDirection);\n        }\n        if (gridFooter && gridFooter.querySelector('.e-summaryrow')) {\n            var gridFooterContent = gridFooter.firstChild;\n            if (!this.footerContentMaskTable) {\n                var footerContent = gridFooterContent;\n                this.footerContentMaskTable = this.createMaskTable(footerContent);\n            }\n        }\n        if (!(this.enableVirtualization && axisDirection)) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(gridContent, 'scroll', this.translateMaskRow, this);\n        }\n    };\n    Grid.prototype.getContentMaskColumns = function () {\n        return this.getColumns();\n    };\n    Grid.prototype.createEmptyMaskTable = function (maskElement, rowCount) {\n        var table = this.createElement('table', { className: 'e-table e-masked-table' });\n        var tbody = this.createElement('tbody', { className: 'e-masked-tbody' });\n        var row = this.createElement('tr', { className: 'e-masked-row e-row' });\n        row.style.height = this.getRowHeight() + \"px\";\n        var cell = this.createElement('td', { className: 'e-masked-cell e-rowcell' });\n        cell.innerHTML = this.getShimmerTemplate();\n        row.appendChild(cell);\n        for (var i = 0; i < rowCount; i++) {\n            tbody.appendChild(row.cloneNode(true));\n        }\n        table.appendChild(tbody);\n        maskElement.appendChild(table);\n        return table;\n    };\n    Grid.prototype.createMaskTable = function (element, columns, axisDirection) {\n        var parentElement = element;\n        var header = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(parentElement, '.e-gridheader') ? true : false;\n        var content = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(parentElement, '.e-gridcontent') ? true : false;\n        var footer = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(parentElement, '.e-gridfooter') ? true : false;\n        var gridContent = this.getContent().firstChild;\n        var gridContentScrollHeight = gridContent.scrollHeight;\n        var table = parentElement.querySelector('table');\n        var maskTable = table.cloneNode();\n        maskTable.removeAttribute('role');\n        maskTable.removeAttribute('id');\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.updateCSSText)(maskTable, \"position: absolute; z-index: 5; width: \" + table.getBoundingClientRect().width + \"px;\");\n        if (header && !(this.enableColumnVirtualization && axisDirection === 'X')) {\n            maskTable.style.transform = 'translate(0px,'\n                + table.querySelector('thead').getBoundingClientRect().height + 'px)';\n        }\n        maskTable.setAttribute('class', 'e-table e-masked-table');\n        var maskColgroup = table.querySelector('colgroup').cloneNode(true);\n        maskColgroup.removeAttribute('id');\n        maskColgroup.setAttribute('class', 'e-masked-colgroup');\n        maskTable.appendChild(maskColgroup);\n        if (header && this.enableColumnVirtualization && axisDirection === 'X') {\n            var row = this.createMaskRow(maskColgroup, columns);\n            if (this.isFrozenGrid()) {\n                var frzTd = [].slice.call(row.querySelectorAll('.e-rowcell'));\n                for (var i = 0; i < frzTd.length; i++) {\n                    if (i < this.frozenLeftCount) {\n                        if (this.frozenLeftCount - 1 === i) {\n                            frzTd[parseInt(i.toString(), 10)].classList.add('e-freezeleftborder');\n                        }\n                        frzTd[parseInt(i.toString(), 10)].classList.add('e-leftfreeze');\n                        frzTd[parseInt(i.toString(), 10)].setAttribute('aria-colindex', (i + 1).toString());\n                        frzTd[parseInt(i.toString(), 10)].style.left = (columns[parseInt(i.toString(), 10)].valueX -\n                            this.translateX) + 'px';\n                    }\n                    else if ((frzTd.length - this.frozenRightCount) <= i && columns[parseInt(i.toString(), 10)]) {\n                        if ((frzTd.length - this.frozenRightCount) === i) {\n                            frzTd[parseInt(i.toString(), 10)].classList.add('e-freezerightborder');\n                        }\n                        frzTd[parseInt(i.toString(), 10)].classList.add('e-rightfreeze');\n                        frzTd[parseInt(i.toString(), 10)].setAttribute('aria-colindex', (i + 1).toString());\n                        frzTd[parseInt(i.toString(), 10)].style.right = (this.translateX +\n                            columns[parseInt(i.toString(), 10)].valueX) + 'px';\n                    }\n                }\n            }\n            var thead = table.querySelector('thead');\n            var rows = [].slice.call(thead.querySelectorAll('tr'));\n            var maskTHead = thead.cloneNode();\n            maskTHead.removeAttribute('role');\n            maskTHead.setAttribute('class', 'e-masked-thead');\n            var rowCount = rows.length;\n            for (var i = 0; i < rowCount; i++) {\n                maskTHead.appendChild(row.cloneNode(true));\n                maskTHead.childNodes[parseInt(i.toString(), 10)].style\n                    .height = rows[parseInt(i.toString(), 10)].getBoundingClientRect().height + 'px';\n            }\n            maskTable.appendChild(maskTHead);\n        }\n        var maskTBody = table.querySelector('tbody').cloneNode();\n        maskTBody.removeAttribute('role');\n        maskTBody.setAttribute('class', 'e-masked-tbody');\n        var tbody = table.querySelector('tbody');\n        if (content || header) {\n            var rowCountElement = gridContent;\n            var rowCount = Math.ceil(rowCountElement.getBoundingClientRect().height / this.getRowHeight());\n            if (this.allowPaging && this.pageSettings.pageSize !== this.currentViewData.length &&\n                this.pagerModule.pagerObj.totalPages !== this.pageSettings.currentPage) {\n                var row = this.createMaskRow(maskColgroup, columns);\n                var altRow = row.cloneNode(true);\n                altRow.classList.add('e-altrow');\n                for (var i = 0; i < this.pageSettings.pageSize - this.currentViewData.length; i++) {\n                    maskTBody.appendChild((i % 2 === 1) ? altRow.cloneNode(true) : row.cloneNode(true));\n                }\n            }\n            if (tbody.querySelector('.e-emptyrow') || !tbody.childNodes.length || (content && this.childGrid)) {\n                var row = this.createMaskRow(maskColgroup, columns);\n                var altRow = row.cloneNode(true);\n                altRow.classList.add('e-altrow');\n                for (var i = 0; i < rowCount; i++) {\n                    var altNumber = 1;\n                    maskTBody.appendChild((i + altNumber) % 2 === 0 ? altRow.cloneNode(true) : row.cloneNode(true));\n                }\n            }\n            else {\n                var rowsQuery = 'tr:not(.e-hide):not([style*=\"display:none\"]):not([style*=\"display: none\"])';\n                var rows = [].slice.call(tbody.querySelectorAll(rowsQuery));\n                var addEditRow = tbody.querySelector('.e-addedrow, .e-editedrow');\n                var addEditRowIndex = void 0;\n                if (addEditRow) {\n                    addEditRowIndex = rows.indexOf(addEditRow);\n                    if (this.isFrozenGrid() && this.enableColumnVirtualization) {\n                        var frzTd = [].slice.call(rows[addEditRowIndex + 1].querySelectorAll('.e-rowcell'));\n                        for (var i = 0; i < frzTd.length; i++) {\n                            if (i < this.frozenLeftCount) {\n                                frzTd[parseInt(i.toString(), 10)].classList.add('e-leftfreeze');\n                                frzTd[parseInt(i.toString(), 10)].setAttribute('aria-colindex', (i + 1).toString());\n                                frzTd[parseInt(i.toString(), 10)].style.left = (columns[parseInt(i.toString(), 10)].valueX - this.translateX) + 'px';\n                            }\n                            else if ((frzTd.length - this.frozenRightCount) <= i && columns[parseInt(i.toString(), 10)]) {\n                                frzTd[parseInt(i.toString(), 10)].classList.add('e-rightfreeze');\n                                frzTd[parseInt(i.toString(), 10)].setAttribute('aria-colindex', (i + 1).toString());\n                                frzTd[parseInt(i.toString(), 10)].style.right = (this.translateX +\n                                    columns[parseInt(i.toString(), 10)].valueX) + 'px';\n                            }\n                        }\n                    }\n                    if (addEditRow.classList.contains('e-addedrow')) {\n                        rows.splice(addEditRowIndex, 2);\n                    }\n                    else {\n                        rows.splice(addEditRowIndex, 1);\n                    }\n                }\n                rowCount = (this.enableVirtualization || this.enableColumnVirtualization) && axisDirection ? rows.length\n                    : rowCount <= rows.length ? rowCount : rows.length;\n                for (var i = 0; i < rowCount; i++) {\n                    maskTBody.appendChild(this.applyMaskRow(rows[parseInt(i.toString(), 10)].cloneNode(true), rows[parseInt(i.toString(), 10)].getBoundingClientRect().height));\n                }\n                if (addEditRow && addEditRow.classList.contains('e-editedrow') && addEditRowIndex < rowCount) {\n                    var addEditMaskRow = maskTBody.childNodes[parseInt(addEditRowIndex.toString(), 10)];\n                    addEditMaskRow.style.height = this.getRowHeight() + 'px';\n                    addEditMaskRow.classList.add('e-row');\n                    if (addEditRow.classList.contains('e-altrow')) {\n                        addEditMaskRow.classList.add('e-altrow');\n                    }\n                }\n            }\n        }\n        maskTable.appendChild(maskTBody);\n        if (footer) {\n            var tfoot = table.querySelector('tfoot');\n            var maskTFoot = tfoot.cloneNode();\n            maskTFoot.setAttribute('class', 'e-masked-tfoot');\n            var rows = [].slice.call(tfoot.querySelectorAll('tr'));\n            for (var i = 0; i < rows.length; i++) {\n                maskTFoot.appendChild(this.applyMaskRow(rows[parseInt(i.toString(), 10)].cloneNode(true), rows[parseInt(i.toString(), 10)].getBoundingClientRect().height));\n            }\n            maskTable.appendChild(maskTFoot);\n        }\n        if (header && this.isFrozenGrid() && !this.enableColumnVirtualization) {\n            this.getHeaderContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.headerContent).style.position = 'relative';\n        }\n        parentElement.insertBefore(maskTable, parentElement.firstChild);\n        if (content && !(this.enableVirtualization && axisDirection)) {\n            var minScrollTop = gridContentScrollHeight - maskTable.getBoundingClientRect().height;\n            minScrollTop = minScrollTop < 0 ? 0 : minScrollTop;\n            var scrollTop = gridContent.scrollTop <= minScrollTop ? gridContent.scrollTop : minScrollTop;\n            if (this.enableVirtualization) {\n                scrollTop -= (0,_util__WEBPACK_IMPORTED_MODULE_9__.getTransformValues)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(parentElement, '.e-virtualtable')).height;\n            }\n            maskTable.style.transform = 'translate(0px,' + scrollTop + 'px)';\n        }\n        return maskTable;\n    };\n    Grid.prototype.applyMaskRow = function (row, rowHeight) {\n        var maskRow = row;\n        maskRow.removeAttribute('role');\n        maskRow.removeAttribute('aria-rowindex');\n        maskRow.removeAttribute('data-uid');\n        maskRow.classList.add('e-masked-row');\n        maskRow.style.height = rowHeight + 'px';\n        var maskCells = [].slice.call(maskRow.childNodes);\n        for (var i = 0; i < maskCells.length; i++) {\n            var maskCell = maskCells[parseInt(i.toString(), 10)];\n            var displayAsCheckBoxCell = maskCell.firstChild && maskCell.firstChild.classList\n                && maskCell.firstChild.classList.contains('e-checkbox-wrapper');\n            maskCell.removeAttribute('role');\n            maskCell.removeAttribute('tabindex');\n            maskCell.removeAttribute('aria-label');\n            if (this.enableColumnVirtualization && maskCell.classList.contains('e-fixedfreeze')) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([maskCell], ['e-fixedfreeze', 'e-freezeleftborder', 'e-freezerightborder']);\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([maskCell], ['e-unfreeze']);\n            }\n            maskCell.removeAttribute('aria-colindex');\n            maskCell.removeAttribute('index');\n            maskCell.removeAttribute('ej-mappingname');\n            maskCell.removeAttribute('ej-mappingvalue');\n            maskCell.removeAttribute('e-mappinguid');\n            maskCell.removeAttribute('aria-expanded');\n            maskCell.classList.add('e-masked-cell');\n            maskCell.innerHTML = this.getShimmerTemplate();\n            if (maskCell.classList.contains('e-recordplusexpand') || maskCell.classList.contains('e-recordpluscollapse')) {\n                maskCell.firstChild.classList.add('e-mask-group-intent');\n            }\n            else if (maskCell.classList.contains('e-gridchkbox') || displayAsCheckBoxCell) {\n                maskCell.firstChild.classList.add('e-mask-checkbox-intent');\n            }\n            else if (maskCell.classList.contains('e-rowdragdrop')) {\n                maskCell.firstChild.classList.add('e-mask-drag-intent');\n            }\n            else if (maskCell.classList.contains('e-indentcell')) {\n                maskCell.innerHTML = '';\n            }\n        }\n        return maskRow;\n    };\n    Grid.prototype.createMaskRow = function (refColgroup, refColumns) {\n        var colgroup = refColgroup;\n        var columns = refColumns;\n        var row = this.createElement('tr', { className: 'e-masked-row e-row' });\n        if (this.rowRenderingMode !== 'Vertical') {\n            row.style.height = this.getRowHeight() + 'px';\n        }\n        var td = this.createElement('td', { className: 'e-masked-cell e-rowcell' });\n        for (var i = 0, colIndex = 0; i < colgroup.childNodes.length; i++) {\n            var col = colgroup.childNodes[parseInt(i.toString(), 10)];\n            var localTD = td.cloneNode();\n            localTD.innerHTML = this.getShimmerTemplate();\n            if (!(col.classList.contains('e-group-intent') || col.classList.contains('e-detail-intent')\n                || col.classList.contains('e-drag-intent'))) {\n                if (this.rowRenderingMode === 'Vertical' && columns[parseInt(colIndex.toString(), 10)]) {\n                    localTD.setAttribute('data-cell', columns[parseInt(colIndex.toString(), 10)].headerText ?\n                        columns[parseInt(colIndex.toString(), 10)].headerText : columns[parseInt(colIndex.toString(), 10)].field);\n                }\n                if (col.style.display === 'none') {\n                    localTD.classList.add('e-hide');\n                }\n                else {\n                    localTD.style.textAlign = columns[parseInt(colIndex.toString(), 10)]\n                        && columns[parseInt(colIndex.toString(), 10)].textAlign ?\n                        columns[parseInt(colIndex.toString(), 10)].textAlign.toLowerCase()\n                        : this.enableRtl ? 'right' : 'left';\n                    if (columns[parseInt(colIndex.toString(), 10)] && (columns[parseInt(colIndex.toString(), 10)].type === 'checkbox'\n                        || columns[parseInt(colIndex.toString(), 10)].displayAsCheckBox)) {\n                        localTD.firstChild.classList.add('e-mask-checkbox-intent');\n                    }\n                }\n                colIndex++;\n            }\n            else {\n                if (col.classList.contains('e-group-intent')) {\n                    localTD.firstChild.classList.add('e-mask-group-intent');\n                }\n                else if (col.classList.contains('e-detail-intent')) {\n                    localTD.firstChild.classList.add('e-mask-detail-intent');\n                }\n                else if (col.classList.contains('e-drag-intent')) {\n                    localTD.firstChild.classList.add('e-mask-drag-intent');\n                }\n            }\n            row.appendChild(localTD);\n        }\n        return row;\n    };\n    Grid.prototype.getShimmerTemplate = function () {\n        if (this.maskRowContentScroll) {\n            return '<span class=\"e-mask e-skeleton e-skeleton-text\"></span>';\n        }\n        return '<span class=\"e-mask e-skeleton e-skeleton-text e-shimmer-wave\"></span>';\n    };\n    Grid.prototype.addShimmerEffect = function () {\n        this.maskRowContentScroll = false;\n        var maskSpan = [].slice.call(this.element.querySelectorAll('.e-mask:not(.e-shimmer-wave)'));\n        for (var i = 0; i < maskSpan.length; i++) {\n            if (maskSpan[parseInt(i.toString(), 10)]) {\n                maskSpan[parseInt(i.toString(), 10)].classList.add('e-shimmer-wave');\n            }\n        }\n    };\n    Grid.prototype.translateMaskRow = function (e) {\n        var target = e.target;\n        var maskTables = target.querySelectorAll('.e-masked-table');\n        for (var i = 0; i < maskTables.length; i++) {\n            var maskTable = maskTables[parseInt(i.toString(), 10)];\n            if (maskTable) {\n                var minScrollTop = target.scrollHeight - maskTable.getBoundingClientRect().height;\n                minScrollTop = minScrollTop < 0 ? 0 : minScrollTop;\n                var scrollTop = target.scrollTop <= minScrollTop ? target.scrollTop : minScrollTop;\n                if (this.enableVirtualization) {\n                    scrollTop -= (0,_util__WEBPACK_IMPORTED_MODULE_9__.getTransformValues)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(maskTable, '.e-virtualtable')).height;\n                }\n                maskTable.style.transform = 'translate(0px,' + scrollTop + 'px)';\n            }\n        }\n    };\n    Grid.prototype.removeMaskRow = function () {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.contentModule)) {\n            var gridContent = this.getContent().firstChild;\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(gridContent, 'scroll', this.translateMaskRow);\n        }\n        if (this.headerMaskTable && this.isFrozenGrid() && !this.enableColumnVirtualization) {\n            this.getHeaderContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.headerContent).style.position = '';\n        }\n        var maskTables = [this.headerMaskTable,\n            this.contentMaskTable, this.footerContentMaskTable];\n        for (var i = 0; i < maskTables.length; i++) {\n            var maskTable = maskTables[parseInt(i.toString(), 10)];\n            if (maskTable) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(maskTable);\n            }\n        }\n        this.headerMaskTable = null;\n        this.contentMaskTable = null;\n        this.footerContentMaskTable = null;\n    };\n    Grid.prototype.refreshMaskRow = function () {\n        var gridContent = this.getContent().firstChild;\n        if (!this.isInitialLoad && !this.getColumns().length) {\n            return;\n        }\n        if (this.contentMaskTable && gridContent.querySelector('.e-masked-table')) {\n            var content = gridContent;\n            if (this.enableVirtualization) {\n                content = content.querySelector('.e-virtualtable');\n            }\n            this.refreshMaskRowColgroupWidth(content);\n        }\n    };\n    Grid.prototype.refreshMaskRowColgroupWidth = function (content) {\n        var table = content.querySelector('table:not(.e-masked-table)');\n        var colgroup = table.querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.colGroup).cloneNode(true);\n        var maskTable = content.querySelector('.e-masked-table');\n        colgroup.removeAttribute('id');\n        colgroup.setAttribute('class', 'e-masked-colgroup');\n        for (var i = 0; i < colgroup.childNodes.length; i++) {\n            colgroup.childNodes[parseInt(i.toString(), 10)].removeAttribute('class');\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(maskTable.querySelector('.e-masked-colgroup'));\n        maskTable.insertBefore(colgroup, maskTable.firstChild);\n        maskTable.style.width = table.getBoundingClientRect().width + 'px';\n    };\n    Grid.prototype.updateStackedFilter = function () {\n        if (this.allowFiltering && this.filterSettings.type === 'FilterBar' &&\n            this.getHeaderContent().getElementsByClassName('e-stackedheadercell').length) {\n            this.getHeaderContent().classList.add('e-stackedfilter');\n        }\n        else {\n            this.getHeaderContent().classList.remove('e-stackedfilter');\n        }\n    };\n    Grid.prototype.getMediaColumns = function () {\n        if (!this.enableColumnVirtualization) {\n            var gcol = this.getColumns();\n            this.getShowHideService = this.serviceLocator.getService('showHideService');\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gcol)) {\n                for (var index = 0; index < gcol.length; index++) {\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gcol[parseInt(index.toString(), 10)].hideAtMedia)\n                        && ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gcol[parseInt(index.toString(), 10)].visible)\n                            || gcol[parseInt(index.toString(), 10)].visible)) {\n                        this.pushMediaColumn(gcol[parseInt(index.toString(), 10)], index);\n                    }\n                }\n            }\n        }\n        this.updateFrozenColumnsWidth();\n    };\n    Grid.prototype.pushMediaColumn = function (col, index) {\n        this.mediaCol.push(col);\n        this.media[col.uid] = window.matchMedia(col.hideAtMedia);\n        this.mediaQueryUpdate(index, this.media[col.uid]);\n        this.mediaBindInstance[parseInt(index.toString(), 10)] = this.mediaQueryUpdate.bind(this, index);\n        this.media[col.uid].addListener(this.mediaBindInstance[parseInt(index.toString(), 10)]);\n    };\n    /**\n     * @param {Column} col - specifies the column\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.updateMediaColumns = function (col) {\n        if (!this.enableColumnVirtualization) {\n            var index = this.getColumnIndexByUid(col.uid);\n            for (var i = 0; i < this.mediaCol.length; i++) {\n                if (col.uid === this.mediaCol[parseInt(i.toString(), 10)].uid) {\n                    this.mediaCol.splice(i, 1);\n                    return;\n                }\n            }\n            this.pushMediaColumn(col, index);\n        }\n    };\n    /**\n     * @param {number} columnIndex - specifies the column index\n     * @param {MediaQueryList} e - specifies the MediaQueryList\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.mediaQueryUpdate = function (columnIndex, e) {\n        var col = this.getColumns()[parseInt(columnIndex.toString(), 10)];\n        if (this.mediaCol.some(function (mediaColumn) { return mediaColumn.uid === col.uid; })) {\n            col.visible = e.matches;\n            if (this.isInitialLoad) {\n                this.invokedFromMedia = true;\n                if (col.visible) {\n                    this.showHider.show(col.headerText, 'headerText');\n                }\n                else {\n                    this.showHider.hide(col.headerText, 'headerText');\n                }\n            }\n        }\n    };\n    Grid.prototype.refreshMediaCol = function () {\n        this.isInitialLoad = true;\n        var footerContent = this.element.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.gridFooter);\n        if (this.aggregates.length && this.element.scrollHeight > parseInt(this.height.toString(), 10) && footerContent) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([footerContent], ['e-footerpadding']);\n        }\n        var checkboxColumn = this.getColumns().filter(function (col) { return col.type === 'checkbox'; });\n        if (checkboxColumn.length === 0 || checkboxColumn.length && this.selectionSettings.checkboxMode === 'ResetOnRowClick') {\n            this.isCheckBoxSelection = false;\n        }\n        if (this.rowRenderingMode === 'Vertical') {\n            if (this.enableHover) {\n                this.setProperties({ enableAdaptiveUI: true, enableHover: false }, true);\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([this.element], 'e-gridhover');\n            }\n        }\n        if (this.enableAdaptiveUI && this.scrollModule) {\n            this.scrollModule.refresh();\n        }\n        if (this.isFrozenGrid() && this.isAutoGenerateColumns) {\n            this.widthService.setWidthToColumns();\n            this.isAutoGenerateColumns = false;\n        }\n    };\n    Grid.prototype.removeMediaListener = function () {\n        for (var i = 0; i < this.mediaCol.length; i++) {\n            this.media[this.mediaCol[parseInt(i.toString(), 10)].uid]\n                .removeListener(this.mediaBindInstance[this.mediaCol[parseInt(i.toString(), 10)].index]);\n        }\n    };\n    /**\n     * For internal use only - Initialize the event handler\n     *\n     * @returns {void}\n     * @private\n     */\n    Grid.prototype.eventInitializer = function () {\n        //eventInitializer\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     *\n     * @function destroy\n     * @returns {void}\n     */\n    Grid.prototype.destroy = function () {\n        var gridElement = this.element;\n        if (!gridElement) {\n            return;\n        }\n        var hasGridChild = gridElement.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.gridHeader) &&\n            gridElement.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.gridContent) ? true : false;\n        if (hasGridChild) {\n            this.unwireEvents();\n        }\n        this.removeListener();\n        this.removeMediaListener();\n        this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.destroy, {});\n        this.destroyDependentModules();\n        if (this.isReact) {\n            this.destroyTemplate(['template']);\n        }\n        if (this.isVue) {\n            this.destroyTemplate();\n        }\n        if (hasGridChild) {\n            _super.prototype.destroy.call(this);\n        }\n        this.toolTipObj.destroy();\n        if (this.isReact && !_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isIE) {\n            this.element.innerHTML = '';\n        }\n        var modules = ['renderModule', 'headerModule', 'contentModule', 'valueFormatterService',\n            'serviceLocator', 'ariaService', 'keyboardModule', 'widthService', 'searchModule', 'showHider',\n            'scrollModule', 'printModule', 'clipboardModule', 'focusModule'];\n        for (var i = 0; i < modules.length; i++) {\n            if (this[modules[parseInt(i.toString(), 10)]]) {\n                this[modules[parseInt(i.toString(), 10)]] = null;\n            }\n        }\n        this.element.innerHTML = '';\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.element, [], ['e-rtl', 'e-gridhover', 'e-responsive', 'e-default', 'e-device', 'e-grid-min-height']);\n    };\n    Grid.prototype.destroyDependentModules = function () {\n        var gridElement = this.element;\n        if (!gridElement || (!gridElement.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.gridHeader) && !gridElement.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.gridContent))) {\n            return;\n        }\n        this.scrollModule.destroy();\n        this.keyboardModule.destroy();\n        this.focusModule.destroy();\n        this.clipboardModule.destroy();\n        this.printModule.destroy();\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Grid.prototype.getModuleName = function () {\n        return 'grid';\n    };\n    Grid.prototype.enableBoxSelection = function () {\n        if (this.enableAutoFill) {\n            this.selectionSettings.cellSelectionMode = 'BoxWithBorder';\n            this.element.classList.add('e-afenabled');\n        }\n        else {\n            this.element.classList.remove('e-afenabled');\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.destroyAutoFillElements, {});\n        }\n    };\n    Grid.prototype.setCSSClass = function (oldCSSClass) {\n        if (this.cssClass) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.element], this.cssClass.split(' '));\n        }\n        if (oldCSSClass) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([this.element], oldCSSClass.split(' '));\n        }\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {GridModel} newProp - Defines new properties\n     * @param {GridModel} oldProp - Defines old properties\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var requireRefresh = false;\n        var requireGridRefresh = false;\n        var freezeRefresh = false;\n        var checkCursor;\n        var args = { requestType: 'refresh' };\n        var childGridParent = null;\n        var parentInstance = null;\n        if (this.isDestroyed) {\n            return;\n        }\n        this.log('module_missing');\n        if (this.isEllipsisTooltip()) {\n            this.toolTipObj.close();\n        }\n        var properties = Object.keys(newProp);\n        if (properties.indexOf('columns') > -1) {\n            if (this.enableColumnVirtualization) {\n                this.columnModel = [];\n            }\n            this.updateColumnObject();\n            requireGridRefresh = true;\n        }\n        for (var _i = 0, properties_1 = properties; _i < properties_1.length; _i++) {\n            var prop = properties_1[_i];\n            switch (prop) {\n                case 'allowPaging':\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'pager', enable: this.allowPaging });\n                    requireRefresh = true;\n                    if (this.height === '100%') {\n                        this.scrollModule.refresh();\n                    }\n                    break;\n                case 'pageSettings':\n                    if (this.pageTemplateChange) {\n                        this.pageTemplateChange = false;\n                        this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.inBoundModelChanged, { module: 'pager', properties: newProp.pageSettings });\n                        break;\n                    }\n                    if (this.pagerModule && this.pagerModule.isCancel) {\n                        this.pagerModule.isCancel = false;\n                        return;\n                    }\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.inBoundModelChanged, { module: 'pager', properties: newProp.pageSettings });\n                    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(newProp.pageSettings.currentPage) && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(newProp.pageSettings.pageSize)\n                        && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(newProp.pageSettings.totalRecordsCount)\n                        || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(oldProp.pageSettings) &&\n                            ((newProp.pageSettings.currentPage !== oldProp.pageSettings.currentPage)\n                                && !this.enableColumnVirtualization && !this.enableVirtualization && this.pageRequireRefresh\n                                && this.pageSettings.totalRecordsCount <= this.pageSettings.pageSize)) {\n                        requireRefresh = true;\n                    }\n                    if (!this.pageRequireRefresh) {\n                        this.pageRequireRefresh = true;\n                    }\n                    if (this.pagerModule && this.pagerModule.isCancel) {\n                        this.pagerModule.isCancel = false;\n                    }\n                    break;\n                case 'allowSorting':\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'sort', enable: this.allowSorting });\n                    requireRefresh = true;\n                    checkCursor = true;\n                    break;\n                case 'allowFiltering':\n                    this.updateStackedFilter();\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'filter', enable: this.allowFiltering });\n                    requireRefresh = true;\n                    if (this.filterSettings.type !== 'FilterBar' || (this.editSettings.showAddNewRow && this.filterSettings.type === 'FilterBar')) {\n                        this.refreshHeader();\n                    }\n                    else {\n                        if (this.height === '100%') {\n                            this.scrollModule.refresh();\n                        }\n                    }\n                    break;\n                case 'height':\n                case 'width':\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'scroll', properties: { width: newProp.width, height: newProp.height } });\n                    if (this.allowPaging) {\n                        this.pagerModule.refresh();\n                    }\n                    break;\n                case 'allowReordering':\n                    this.headerModule.refreshUI();\n                    checkCursor = true;\n                    break;\n                case 'allowRowDragAndDrop':\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'rowDragAndDrop', enable: this.allowRowDragAndDrop });\n                    this.renderModule.refresh();\n                    this.headerModule.refreshUI();\n                    break;\n                case 'allowSelection':\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'selection', enable: this.allowSelection });\n                    this.renderModule.refresh();\n                    break;\n                case 'cssClass':\n                    this.setCSSClass(oldProp.cssClass);\n                    break;\n                case 'enableAutoFill':\n                    if (this.selectionModule) {\n                        this.enableBoxSelection();\n                        this.selectionModule.updateAutoFillPosition();\n                    }\n                    break;\n                case 'rowTemplate':\n                    this.rowTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.rowTemplate);\n                    requireRefresh = true;\n                    break;\n                case 'emptyRecordTemplate':\n                    this.emptyRecordTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.emptyRecordTemplate);\n                    requireRefresh = true;\n                    break;\n                case 'detailTemplate':\n                    this.detailTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.detailTemplate);\n                    requireRefresh = true;\n                    break;\n                case 'allowGrouping':\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'group', enable: this.allowGrouping });\n                    this.headerModule.refreshUI();\n                    requireRefresh = true;\n                    checkCursor = true;\n                    if (this.height === '100%') {\n                        this.scrollModule.refresh();\n                    }\n                    break;\n                case 'enableInfiniteScrolling':\n                case 'childGrid':\n                    requireRefresh = true;\n                    childGridParent = this.parentDetails ? document.querySelector(\"#\" + this.parentDetails.parentID) : null;\n                    parentInstance = childGridParent ? childGridParent.ej2_instances[0] : null;\n                    if (this.childGrid && parentInstance && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(parentInstance.childGrid.childGrid)) {\n                        var childGridObject = Object.assign({}, parentInstance.childGrid, { childGrid: newProp.childGrid });\n                        parentInstance.setProperties({ childGrid: childGridObject }, true);\n                        while (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(parentInstance.parentDetails)) {\n                            var currentParent = document.querySelector(\"#\" + parentInstance.parentDetails.parentID);\n                            var currentParentInstance = currentParent ? currentParent.ej2_instances[0] : null;\n                            if (currentParentInstance) {\n                                var currentChildObject = Object.assign({}, currentParentInstance.childGrid);\n                                currentChildObject.childGrid = parentInstance.childGrid;\n                                currentParentInstance.setProperties({ childGrid: currentChildObject }, true);\n                            }\n                            parentInstance = currentParentInstance;\n                        }\n                    }\n                    this.headerModule.refreshUI();\n                    break;\n                case 'toolbar':\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'toolbar' });\n                    if (this.height === '100%') {\n                        this.scrollModule.refresh();\n                    }\n                    break;\n                case 'groupSettings':\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.inBoundModelChanged, {\n                        module: 'group', properties: newProp.groupSettings,\n                        oldProperties: oldProp.groupSettings\n                    });\n                    break;\n                case 'aggregates':\n                    if (!this.aggregates.length && this.allowGrouping && this.groupSettings.columns.length) {\n                        requireRefresh = true;\n                    }\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'aggregate', properties: newProp });\n                    if (this.height === '100%') {\n                        this.scrollModule.refresh();\n                    }\n                    break;\n                case 'frozenColumns':\n                case 'frozenRows':\n                case 'enableVirtualization':\n                case 'enableColumnVirtualization':\n                case 'currencyCode':\n                case 'locale':\n                    if (this.isFrozenGrid()) {\n                        this.log('frozen_rows_columns');\n                    }\n                    freezeRefresh = true;\n                    requireGridRefresh = true;\n                    this.addNewRowFocus = true;\n                    break;\n                case 'query':\n                    if (!this.getDataModule().isQueryInvokedFromData) {\n                        requireRefresh = true;\n                    }\n                    this.getDataModule().isQueryInvokedFromData = false;\n                    break;\n                case 'autoFit':\n                    if (this.autoFit) {\n                        this.preventAdjustColumns();\n                    }\n                    else {\n                        this.restoreAdjustColumns();\n                    }\n                    break;\n                default:\n                    this.extendedPropertyChange(prop, newProp, requireGridRefresh);\n            }\n        }\n        if (checkCursor) {\n            this.updateDefaultCursor();\n        }\n        if (requireGridRefresh) {\n            if (freezeRefresh || this.getFrozenColumns() || this.frozenRows\n                || (this.frozenLeftColumns.length || this.frozenRightColumns.length)) {\n                this.freezeRefresh();\n            }\n            else {\n                this.refresh();\n            }\n        }\n        else if (requireRefresh) {\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.modelChanged, args);\n            requireRefresh = false;\n            this.maintainSelection(newProp.selectedRowIndex);\n        }\n    };\n    Grid.prototype.extendedPropertyChange = function (prop, newProp, requireGridRefresh) {\n        switch (prop) {\n            case 'enableRtl':\n                this.updateRTL();\n                if (this.allowPaging) {\n                    this.element.querySelector('.e-gridpager').ej2_instances[0].enableRtl = newProp.enableRtl;\n                    this.element.querySelector('.e-gridpager').ej2_instances[0].dataBind();\n                }\n                if (this.height !== 'auto') {\n                    this.scrollModule.removePadding(!newProp.enableRtl);\n                    this.scrollModule.setPadding();\n                }\n                if (this.toolbar && this.toolbarModule) {\n                    this.toolbarModule.getToolbar().ej2_instances[0].enableRtl = newProp.enableRtl;\n                    this.toolbarModule.getToolbar().ej2_instances[0].dataBind();\n                }\n                if (this.contextMenuItems && this.contextMenuModule) {\n                    this.contextMenuModule.getContextMenu().ej2_instances[0].enableRtl = newProp.enableRtl;\n                    this.contextMenuModule.getContextMenu().ej2_instances[0].dataBind();\n                }\n                if (this.showColumnMenu && this.columnMenuModule && !this.enableAdaptiveUI) {\n                    this.columnMenuModule.getColumnMenu().ej2_instances[0].enableRtl = newProp.enableRtl;\n                    this.columnMenuModule.getColumnMenu().ej2_instances[0].dataBind();\n                }\n                if (this.filterSettings.type === 'FilterBar' && this.filterSettings.showFilterBarOperator) {\n                    this.refreshHeader();\n                }\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.rtlUpdated, {});\n                break;\n            case 'enableAltRow':\n                this.renderModule.refresh();\n                break;\n            case 'allowResizing':\n                if (this.resizeModule) {\n                    this.resizeModule.render();\n                }\n                this.headerModule.refreshUI();\n                this.updateResizeLines();\n                break;\n            case 'rowHeight':\n                if (this.rowHeight) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.element], 'e-grid-min-height');\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([this.element], 'e-grid-min-height');\n                }\n                this.renderModule.refresh();\n                this.headerModule.refreshUI();\n                break;\n            case 'gridLines':\n                this.updateGridLines();\n                break;\n            case 'showColumnMenu':\n                this.headerModule.refreshUI();\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'columnMenu', enable: true });\n                break;\n            case 'columnMenuItems':\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'columnMenu', enable: this.columnMenuItems });\n                break;\n            case 'contextMenuItems':\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'contextMenu', enable: this.contextMenuItems });\n                break;\n            case 'showColumnChooser':\n                if (this.toolbarModule) {\n                    this.toolbarModule.refreshToolbarItems();\n                }\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.uiUpdate, { module: 'columnChooser', enable: this.showColumnChooser });\n                break;\n            case 'filterSettings':\n                this.updateStackedFilter();\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.inBoundModelChanged, { module: 'filter', properties: newProp.filterSettings });\n                break;\n            case 'searchSettings':\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.inBoundModelChanged, { module: 'search', properties: newProp.searchSettings });\n                break;\n            case 'sortSettings':\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.inBoundModelChanged, { module: 'sort' });\n                break;\n            case 'selectionSettings':\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.inBoundModelChanged, { module: 'selection', properties: newProp.selectionSettings });\n                break;\n            case 'editSettings':\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.inBoundModelChanged, { module: 'edit', properties: newProp.editSettings });\n                break;\n            case 'allowTextWrap':\n            case 'textWrapSettings':\n                if (this.allowTextWrap) {\n                    this.applyTextWrap();\n                }\n                else {\n                    this.removeTextWrap();\n                }\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.freezeRender, { case: 'textwrap', isModeChg: (prop === 'textWrapSettings') });\n                this.refreshHeader();\n                if (this.height === '100%') {\n                    this.scrollModule.refresh();\n                }\n                break;\n            case 'dataSource':\n                // eslint-disable-next-line no-case-declarations\n                var requestPendingState = this.getDataModule().getState();\n                if (this.allowPaging && this.pageSettings.pageSizes && !this.getDataModule().isRemote()\n                    && !(requestPendingState && requestPendingState.isPending)) {\n                    if (this.pagerModule.pagerObj.isAllPage) {\n                        var count = this.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_11__.DataManager ? this.dataSource.dataSource.json.length :\n                            'result' in this.dataSource ? this.dataSource.count : this.dataSource.length;\n                        var isAllPage = Array.isArray(this.pageSettings.pageSizes) &&\n                            this.pageSettings.pageSizes.indexOf('All') > -1 ? true : this.pageSettings.pageSizes;\n                        if (!isAllPage && this.pageSettings.pageSize !== count) {\n                            this.pagerModule.pagerObj.isAllPage = false;\n                        }\n                        else {\n                            this.setProperties({ pageSettings: { pageSize: count } }, true);\n                            this.pagerModule.pagerObj.setProperties({ pageSize: count }, true);\n                        }\n                    }\n                }\n                if (this.allowSelection && this.isPersistSelection && !(requestPendingState && requestPendingState.isPending)) {\n                    this.clearSelection();\n                }\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.dataSource) && this.dataSource.result) {\n                    this.isVirtualAdaptive = false;\n                }\n                if (Object.getPrototypeOf(newProp).deepWatch) {\n                    var pKeyField = this.getPrimaryKeyFieldNames()[0];\n                    for (var i = 0, props = Object.keys(newProp.dataSource); i < props.length; i++) {\n                        this.setRowData((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(pKeyField, this.dataSource[props[parseInt(i.toString(), 10)]]), this.dataSource[props[parseInt(i.toString(), 10)]]);\n                    }\n                }\n                else if (requestPendingState.isPending) {\n                    var gResult = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.dataSource) ? this.dataSource.result : [];\n                    var names = (requestPendingState.group || []);\n                    if (names.length && !this.groupSettings.enableLazyLoading && !(gResult.length && gResult[0].field)) {\n                        for (var i = 0; i < names.length; i++) {\n                            gResult = _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_12__.DataUtil.group(gResult, names[parseInt(i.toString(), 10)], requestPendingState.aggregates\n                                || []);\n                        }\n                    }\n                    this.dataSource = {\n                        result: gResult, count: this.dataSource.count,\n                        aggregates: this.dataSource.aggregates\n                    };\n                    this.getDataModule().setState({});\n                    requestPendingState.resolver(this.dataSource);\n                }\n                else {\n                    if ((!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.dataSource) && this.dataSource.result\n                        && this.dataSource.count && this.groupSettings.columns.length)) {\n                        var gResult = this.dataSource.result;\n                        var names = this.groupSettings.columns;\n                        if (names.length && !(gResult.length && gResult[0].field)) {\n                            for (var i = 0; i < names.length; i++) {\n                                gResult = _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_12__.DataUtil.group(gResult, names[parseInt(i.toString(), 10)]);\n                            }\n                        }\n                        this.dataSource = {\n                            result: gResult, count: this.dataSource.count\n                        };\n                    }\n                    this.getDataModule().setState({ isDataChanged: false });\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.dataSourceModified, {});\n                    if (!requireGridRefresh) {\n                        this.renderModule.refresh();\n                        if (this.isCheckBoxSelection) {\n                            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.beforeRefreshOnDataChange, {});\n                        }\n                    }\n                }\n                this.scrollRefresh();\n                break;\n            case 'enableHover':\n                // eslint-disable-next-line no-case-declarations\n                var action = newProp.enableHover ? _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass : _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass;\n                action([this.element], 'e-gridhover');\n                break;\n            case 'selectedRowIndex':\n                if (!this.isSelectedRowIndexUpdating) {\n                    this.selectRow(newProp.selectedRowIndex);\n                }\n                this.isSelectedRowIndexUpdating = false;\n                break;\n            case 'resizeSettings':\n                this.widthService.setWidthToTable();\n                break;\n            case 'enableAdaptiveUI':\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.setFullScreenDialog, {});\n                break;\n            case 'rowRenderingMode':\n                this.enableVerticalRendering();\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.rowModeChange, {});\n                this.refresh();\n                break;\n            case 'enableStickyHeader':\n                this.scrollModule.addStickyListener(newProp.enableStickyHeader);\n                break;\n            case 'allowPdfExport':\n                if (this.toolbarModule) {\n                    this.toolbarModule.refreshToolbarItems();\n                }\n                break;\n            case 'allowExcelExport':\n                if (this.toolbarModule) {\n                    this.toolbarModule.refreshToolbarItems();\n                }\n                break;\n        }\n    };\n    Grid.prototype.maintainSelection = function (index) {\n        var _this_1 = this;\n        if (index !== -1) {\n            var fn_1 = function () {\n                _this_1.selectRow(index);\n                _this_1.off(_base_constant__WEBPACK_IMPORTED_MODULE_8__.contentReady, fn_1);\n            };\n            this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.contentReady, fn_1, this);\n        }\n    };\n    /**\n     * @param {Object} prop - Defines the property\n     * @param {boolean} muteOnChange - Defines the mute on change\n     * @returns {void}\n     * @private\n     */\n    Grid.prototype.setProperties = function (prop, muteOnChange) {\n        _super.prototype.setProperties.call(this, prop, muteOnChange);\n        var filterSettings = 'filterSettings';\n        if (prop[\"\" + filterSettings] && this.filterModule && muteOnChange) {\n            this.filterModule.refreshFilter();\n        }\n    };\n    /**\n     * @hidden\n     * @returns {number} - Returns the tables count\n     */\n    Grid.prototype.getTablesCount = function () {\n        return this.tablesCount;\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.updateDefaultCursor = function () {\n        var headerCells = [].slice.call(this.getHeaderContent().querySelectorAll('.e-headercell:not(.e-stackedheadercell)'));\n        var stdHdrCell = [].slice.call(this.getHeaderContent().getElementsByClassName('e-stackedheadercell'));\n        var cols = this.getColumns();\n        for (var i = 0; i < headerCells.length; i++) {\n            var cell = headerCells[parseInt(i.toString(), 10)];\n            if (this.allowGrouping || this.allowReordering || this.allowSorting) {\n                if (!cols[parseInt(i.toString(), 10)].allowReordering || !cols[parseInt(i.toString(), 10)].allowSorting\n                    || !cols[parseInt(i.toString(), 10)].allowGrouping) {\n                    cell.classList.add('e-defaultcursor');\n                }\n                else {\n                    cell.classList.add('e-mousepointer');\n                }\n            }\n        }\n        for (var count = 0; count < stdHdrCell.length; count++) {\n            if (this.allowReordering) {\n                stdHdrCell[parseInt(count.toString(), 10)].classList.add('e-mousepointer');\n            }\n        }\n    };\n    Grid.prototype.updateColumnModel = function (columns, isRecursion) {\n        for (var i = 0, len = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns) ? columns.length : 0); i < len; i++) {\n            if (columns[parseInt(i.toString(), 10)].columns) {\n                this.updateColumnModel(columns[parseInt(i.toString(), 10)].columns, true);\n            }\n            else {\n                this.columnModel.push(columns[parseInt(i.toString(), 10)]);\n            }\n        }\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(isRecursion) || !isRecursion) {\n            this.updateLockableColumns();\n        }\n    };\n    Grid.prototype.getFrozenLeftCount = function () {\n        return this.getFrozenColumns() || this.getFrozenLeftColumnsCount();\n    };\n    Grid.prototype.isFrozenGrid = function () {\n        return this.getFrozenColumns() !== 0 || this.frozenLeftColumns.length !== 0 || this.frozenRightColumns.length !== 0 ||\n            this.fixedColumns.length !== 0;\n    };\n    Grid.prototype.getFrozenMode = function () {\n        return this.frozenName;\n    };\n    Grid.prototype.updateLockableColumns = function () {\n        var cols = this.columnModel;\n        var frozenCount = 0;\n        var movableCount = 0;\n        var frozenColumns = this.getFrozenColumns();\n        for (var i = 0; i < cols.length; i++) {\n            if (cols[parseInt(i.toString(), 10)].lockColumn) {\n                if (i < frozenColumns) {\n                    cols.splice(frozenCount, 0, cols.splice(i, 1)[0]);\n                    frozenCount++;\n                }\n                else {\n                    cols.splice(frozenColumns + movableCount, 0, cols.splice(i, 1)[0]);\n                    movableCount++;\n                }\n            }\n        }\n    };\n    Grid.prototype.checkLockColumns = function (cols) {\n        for (var i = 0; i < cols.length; i++) {\n            if (cols[parseInt(i.toString(), 10)].columns) {\n                this.checkLockColumns(cols[parseInt(i.toString(), 10)].columns);\n            }\n            else if (cols[parseInt(i.toString(), 10)].lockColumn) {\n                this.lockcolPositionCount++;\n            }\n        }\n    };\n    /**\n     * @param {string} position - specifies position\n     * @returns {number} returns the width\n     * @hidden\n     */\n    Grid.prototype.leftrightColumnWidth = function (position) {\n        var cols = position === 'left' ? this.getFrozenLeftColumns() : position === 'right' ? this.getFrozenRightColumns() : [];\n        var width = 0;\n        cols.filter(function (col) {\n            if (col.visible) {\n                width += parseInt(col.width.toString(), 10);\n            }\n        });\n        return width;\n    };\n    /**\n     * Gets the columns from the Grid.\n     *\n     * @param {boolean} isRefresh - Defines the boolean whether to refresh\n     * @returns {Column[]} - returns the column\n     */\n    Grid.prototype.getColumns = function (isRefresh) {\n        var _this_1 = this;\n        var inview = this.inViewIndexes.map(function (v) { return v - _this_1.groupSettings.columns.length; }).filter(function (v) { return v > -1; });\n        var vLen = inview.length;\n        if (!this.enableColumnVirtualization || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.columnModel) || this.columnModel.length === 0 || isRefresh) {\n            this.columnModel = [];\n            this.updateColumnModel(this.columns);\n        }\n        var columns = vLen === 0 ? this.columnModel :\n            this.getVisibleColumns().slice(inview[0], inview[vLen - 1] + 1);\n        var left = [];\n        var right = [];\n        var movable = [];\n        var isLeftRightFrozen = this.enableColumnVirtualization && this.isPreparedFrozenColumns && vLen === 0;\n        if (isLeftRightFrozen) {\n            this.frozenRightColumns = [];\n            this.frozenLeftColumns = [];\n        }\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[parseInt(i.toString(), 10)].freeze === 'Left' || columns[parseInt(i.toString(), 10)].isFrozen) {\n                left.push(columns[parseInt(i.toString(), 10)]);\n                if (isLeftRightFrozen) {\n                    this.frozenLeftColumns.push(columns[parseInt(i.toString(), 10)]);\n                }\n            }\n            else if (columns[parseInt(i.toString(), 10)].freeze === 'Right') {\n                right.push(columns[parseInt(i.toString(), 10)]);\n                if (isLeftRightFrozen) {\n                    this.frozenRightColumns.push(columns[parseInt(i.toString(), 10)]);\n                }\n            }\n            else {\n                movable.push(columns[parseInt(i.toString(), 10)]);\n            }\n        }\n        if (this.enableColumnVirtualization && this.isFrozenGrid()) {\n            if (this.frozenLeftColumns.length) {\n                left = this.frozenLeftColumns;\n            }\n            if (this.frozenRightColumns.length) {\n                right = this.frozenRightColumns;\n            }\n        }\n        return left.concat(movable).concat(right);\n    };\n    /**\n     * @private\n     * @param {string} stackedHeader - Defines the stacked header\n     * @param {Column[]} col - Defines the column\n     * @returns {Column} Returns the Column\n     */\n    Grid.prototype.getStackedHeaderColumnByHeaderText = function (stackedHeader, col) {\n        for (var i = 0; i < col.length; i++) {\n            var individualColumn = col[parseInt(i.toString(), 10)];\n            if (individualColumn.field === stackedHeader || individualColumn.headerText === stackedHeader) {\n                this.stackedColumn = individualColumn;\n                break;\n            }\n            else if (individualColumn.columns) {\n                this.getStackedHeaderColumnByHeaderText(stackedHeader, individualColumn.columns);\n            }\n        }\n        return this.stackedColumn;\n    };\n    /**\n     * @private\n     * @returns {number[]} Returns the column indexes\n     */\n    Grid.prototype.getColumnIndexesInView = function () {\n        return this.inViewIndexes;\n    };\n    /**\n     * @private\n     * @returns {Query} - returns the query\n     */\n    Grid.prototype.getQuery = function () {\n        return this.query;\n    };\n    /**\n     * @private\n     * @returns {object} - returns the locale constants\n     */\n    Grid.prototype.getLocaleConstants = function () {\n        return this.defaultLocale;\n    };\n    /**\n     * @param {number[]} indexes - specifies the indexes\n     * @returns {void}\n     * @private\n     */\n    Grid.prototype.setColumnIndexesInView = function (indexes) {\n        this.inViewIndexes = indexes;\n    };\n    /**\n     * Gets the visible columns from the Grid.\n     *\n     * @returns {Column[]} returns the column\n     */\n    Grid.prototype.getVisibleColumns = function () {\n        return this.getCurrentVisibleColumns();\n    };\n    /**\n     * Gets the header div of the Grid.\n     *\n     * @returns {Element} - Returns the element\n     */\n    Grid.prototype.getHeaderContent = function () {\n        return this.headerModule.getPanel();\n    };\n    /**\n     * Sets the header div of the Grid to replace the old header.\n     *\n     * @param  {Element} element - Specifies the Grid header.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.setGridHeaderContent = function (element) {\n        this.headerModule.setPanel(element);\n    };\n    /**\n     * Gets the content table of the Grid.\n     *\n     * @returns {Element} - Returns the element\n     */\n    Grid.prototype.getContentTable = function () {\n        return this.contentModule.getTable();\n    };\n    /**\n     * Sets the content table of the Grid to replace the old content table.\n     *\n     * @param  {Element} element - Specifies the Grid content table.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.setGridContentTable = function (element) {\n        this.contentModule.setTable(element);\n    };\n    /**\n     * Gets the content div of the Grid.\n     *\n     * @returns {Element} Returns the element\n     */\n    Grid.prototype.getContent = function () {\n        return this.contentModule.getPanel();\n    };\n    /**\n     * Sets the content div of the Grid to replace the old Grid content.\n     *\n     * @param  {Element} element - Specifies the Grid content.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.setGridContent = function (element) {\n        this.contentModule.setPanel(element);\n    };\n    /**\n     * Gets the header table element of the Grid.\n     *\n     * @returns {Element} returns the element\n     */\n    Grid.prototype.getHeaderTable = function () {\n        return this.headerModule.getTable();\n    };\n    /**\n     * Sets the header table of the Grid to replace the old one.\n     *\n     * @param  {Element} element - Specifies the Grid header table.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.setGridHeaderTable = function (element) {\n        this.headerModule.setTable(element);\n    };\n    /**\n     * Gets the footer div of the Grid.\n     *\n     * @returns {Element} returns the element\n     */\n    Grid.prototype.getFooterContent = function () {\n        this.footerElement = this.element.getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.gridFooter)[0];\n        return this.footerElement;\n    };\n    /**\n     * Gets the footer table element of the Grid.\n     *\n     * @returns {Element} returns the element\n     */\n    Grid.prototype.getFooterContentTable = function () {\n        this.footerElement = this.element.getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.gridFooter)[0];\n        return this.footerElement.firstChild.firstChild;\n    };\n    /**\n     * Gets the pager of the Grid.\n     *\n     * @returns {Element} returns the element\n     */\n    Grid.prototype.getPager = function () {\n        return this.gridPager; //get element from pager\n    };\n    /**\n     * Sets the pager of the Grid to replace the old pager.\n     *\n     * @param  {Element} element - Specifies the Grid pager.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.setGridPager = function (element) {\n        this.gridPager = element;\n    };\n    /**\n     * Gets a row by index.\n     *\n     * @param  {number} index - Specifies the row index.\n     *\n     * @returns {Element} returns the element\n     */\n    Grid.prototype.getRowByIndex = function (index) {\n        if (this.enableVirtualization && this.groupSettings.enableLazyLoading) {\n            return this.lazyLoadRender.getRowByIndex(index);\n        }\n        else {\n            return this.contentModule.getRowByIndex(index);\n        }\n    };\n    /**\n     * Gets a movable tables row by index.\n     *\n     * @param  {number} index - Specifies the row index.\n     *\n     * @returns {Element} returns the element\n\n     */\n    Grid.prototype.getMovableRowByIndex = function (index) {\n        return this.contentModule.getRowByIndex(index);\n    };\n    /**\n     * Gets a frozen tables row by index.\n     *\n     * @param  {number} index - Specifies the row index.\n     * @returns {Element} returns the element\n\n     */\n    Grid.prototype.getFrozenRowByIndex = function (index) {\n        return this.contentModule.getRowByIndex(index);\n    };\n    /**\n     * Gets all the data rows of the Grid.\n     *\n     * @returns {Element[]} returns the element\n     */\n    Grid.prototype.getRows = function () {\n        return this.contentModule.getRowElements();\n    };\n    /**\n     * Gets a frozen right tables row element by index.\n     *\n     * @param  {number} index - Specifies the row index.\n     * @returns {Element} returns the element\n\n     */\n    Grid.prototype.getFrozenRightRowByIndex = function (index) {\n        return this.contentModule.getRowByIndex(index);\n    };\n    /**\n     * Get a row information based on cell\n     *\n     * @param {Element | EventTarget} target - specifies the element\n     *\n     * @returns {RowInfo} returns the row info\n     */\n    Grid.prototype.getRowInfo = function (target) {\n        var ele = target;\n        var args = { target: target };\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(target) && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(ele, 'e-detailrowcollapse')\n            && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(ele, 'e-recordplusexpand')))) {\n            var cell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(ele, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.rowCell);\n            if (!cell) {\n                var row_1 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(ele, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.row);\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row_1) && !row_1.classList.contains('e-addedrow')) {\n                    var rowObj = this.getRowObjectFromUID(row_1.getAttribute('data-uid'));\n                    var rowIndex = parseInt(row_1.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.ariaRowIndex), 10) - 1;\n                    args = { row: row_1, rowData: rowObj.data, rowIndex: rowIndex };\n                }\n                return args;\n            }\n            var cellIndex = parseInt(cell.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.ariaColIndex), 10) - 1;\n            var row_2 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(cell, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.row);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell) && !isNaN(cellIndex) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row_2)) {\n                var rowIndex = parseInt(row_2.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.ariaRowIndex), 10) - 1;\n                var rows = this.contentModule.getRows();\n                var index = cellIndex + this.getIndentCount();\n                var rowsObject = rows.filter(function (r) { return r.uid === row_2.getAttribute('data-uid'); });\n                var rowData = {};\n                var column = void 0;\n                if (Object.keys(rowsObject).length) {\n                    rowData = rowsObject[0].data;\n                    column = rowsObject[0].cells[parseInt(index.toString(), 10)].column;\n                }\n                args = { cell: cell, cellIndex: cellIndex, row: row_2, rowIndex: rowIndex, rowData: rowData, column: column, target: target };\n            }\n        }\n        return args;\n    };\n    /**\n     * Gets the Grid's movable content rows from frozen grid.\n     *\n     * @returns {Element[]} returns the element\n\n     */\n    Grid.prototype.getMovableRows = function () {\n        return this.contentModule.getRowElements();\n    };\n    /**\n     * Gets the Grid's frozen right content rows from frozen grid.\n     *\n     * @returns {Element[]} returns the element\n\n     */\n    Grid.prototype.getFrozenRightRows = function () {\n        return this.contentModule.getRowElements();\n    };\n    /**\n     * Gets all the Grid's data rows.\n     *\n     * @returns {Element[]} returns the element\n     */\n    Grid.prototype.getDataRows = function () {\n        return this.getAllDataRows();\n    };\n    /**\n     * @param {boolean} includeAdd - specifies includeAdd\n     * @returns {Element[]} returns the element\n     * @hidden\n     */\n    Grid.prototype.getAllDataRows = function (includeAdd) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.getContentTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody))) {\n            return [];\n        }\n        var tbody = this.getContentTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n        var rows = [].slice.call(tbody.children);\n        if (this.editSettings.showAddNewRow) {\n            if (rows[0].classList.contains('e-addedrow')) {\n                rows.shift();\n            }\n            else if (rows[rows.length - 1].classList.contains('e-addedrow')) {\n                rows.pop();\n            }\n        }\n        if (this.frozenRows) {\n            var hdrTbody = this.getHeaderTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n            var freezeRows = [].slice.call(hdrTbody.children);\n            rows = this.addMovableRows(freezeRows, rows);\n            if (this.editSettings.showAddNewRow && freezeRows[0].classList.contains('e-addedrow')) {\n                freezeRows.shift();\n            }\n        }\n        var dataRows = this.generateDataRows(rows, includeAdd);\n        return dataRows;\n    };\n    /**\n     * @param {HTMLElement[]} fRows - Defines the frozen Rows\n     * @param {HTMLElement[]} mrows - Defines the movable Rows\n     * @returns {HTMLElement[]} Returns the element\n     * @hidden\n     */\n    Grid.prototype.addMovableRows = function (fRows, mrows) {\n        for (var i = 0, len = mrows.length; i < len; i++) {\n            fRows.push(mrows[parseInt(i.toString(), 10)]);\n        }\n        return fRows;\n    };\n    Grid.prototype.generateDataRows = function (rows, includAdd) {\n        var dRows = [];\n        for (var i = 0, len = rows.length; i < len; i++) {\n            if (rows[parseInt(i.toString(), 10)].classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.row)\n                && (!rows[parseInt(i.toString(), 10)].classList.contains('e-hiddenrow') || includAdd)) {\n                if (this.isCollapseStateEnabled()) {\n                    dRows[parseInt(rows[parseInt(i.toString(), 10)].getAttribute('aria-rowindex'), 10) - 1] = rows[parseInt(i.toString(), 10)];\n                }\n                else {\n                    dRows.push(rows[parseInt(i.toString(), 10)]);\n                }\n            }\n        }\n        return dRows;\n    };\n    /**\n     * Gets all the Grid's movable table data rows.\n     *\n     * @returns {Element[]} Returns the element\n\n     */\n    Grid.prototype.getMovableDataRows = function () {\n        return this.getAllMovableDataRows();\n    };\n    /**\n     * @param {boolean} includeAdd Defines the include add in boolean\n     * @returns {Element[]} Returns the element\n\n     * @hidden\n     */\n    Grid.prototype.getAllMovableDataRows = function (includeAdd) {\n        return this.getAllDataRows(includeAdd);\n    };\n    /**\n     * Gets all the Grid's frozen table data rows.\n     *\n     * @returns {Element[]} returns the element\n\n     */\n    Grid.prototype.getFrozenDataRows = function () {\n        return this.getAllFrozenDataRows();\n    };\n    /**\n     * @param {boolean} includeAdd Defines the include add in boolean\n     * @returns {Element[]} Returns the element\n\n     * @hidden\n     */\n    Grid.prototype.getAllFrozenDataRows = function (includeAdd) {\n        return this.getAllDataRows(includeAdd);\n    };\n    /**\n     * Gets all the Grid's frozen right table data rows.\n     *\n     * @returns {Element[]} Returns the Element\n\n     */\n    Grid.prototype.getFrozenRightDataRows = function () {\n        return this.getAllFrozenRightDataRows();\n    };\n    /**\n     * @param {boolean} includeAdd Defines the include add in boolean\n     * @returns {Element[]} Returns the element\n\n     * @hidden\n     */\n    Grid.prototype.getAllFrozenRightDataRows = function (includeAdd) {\n        return this.getAllDataRows(includeAdd);\n    };\n    /**\n     * Updates particular cell value based on the given primary key value.\n     * > Primary key column must be specified using `columns.isPrimaryKey` property.\n     *\n     * @param {string| number} key - Specifies the PrimaryKey value of dataSource.\n     * @param {string } field - Specifies the field name which you want to update.\n     * @param {string | number | boolean | Date} value - To update new value for the particular cell.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.setCellValue = function (key, field, value) {\n        var cells = 'cells';\n        var rowData = 'data';\n        var rowIdx = 'index';\n        var rowuID = 'uid';\n        var pkName = this.getPrimaryKeyFieldNames()[0];\n        var cell = new _renderer_cell_renderer__WEBPACK_IMPORTED_MODULE_13__.CellRenderer(this, this.serviceLocator);\n        var fieldIdx = this.getColumnIndexByField(field);\n        var col = this.getColumnByField(field);\n        var rowObjects = this.contentModule.getRows();\n        var selectedRow = rowObjects.filter(function (r) {\n            return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(pkName, r.data) === key;\n        })[0];\n        var tr = selectedRow ? this.element.querySelector('[data-uid=' + selectedRow[\"\" + rowuID] + ']') : null;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(tr)) {\n            if (typeof value === 'string') {\n                value = this.sanitize(value);\n            }\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setValue)(field, value, selectedRow[\"\" + rowData]);\n            var td = this.enableVirtualization ? tr.children[parseInt(fieldIdx.toString(), 10)]\n                : this.getCellFromIndex(selectedRow[\"\" + rowIdx], fieldIdx);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(td)) {\n                var Idx = 0;\n                if (this.groupSettings.columns.length) {\n                    fieldIdx = fieldIdx + this.groupSettings.columns.length;\n                }\n                if (this.childGrid || this.detailTemplate) {\n                    fieldIdx++;\n                }\n                if (this.isRowDragable()) {\n                    fieldIdx++;\n                }\n                var sRow = selectedRow[\"\" + cells][fieldIdx - Idx];\n                cell.refreshTD(td, sRow, selectedRow[\"\" + rowData], { index: selectedRow[\"\" + rowIdx] });\n                if (this.isReact) {\n                    td = this.enableVirtualization ? tr.children[parseInt(fieldIdx.toString(), 10)]\n                        : this.getCellFromIndex(selectedRow[\"\" + rowIdx], fieldIdx);\n                }\n                if (this.aggregates.length > 0) {\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshFooterRenderer, {});\n                    if (this.groupSettings.columns.length > 0) {\n                        this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.groupAggregates, {});\n                    }\n                }\n                /* tslint:disable:no-string-literal */\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(selectedRow) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(selectedRow['changes'])) {\n                    selectedRow['changes'][\"\" + field] = value;\n                }\n                /* tslint:disable:no-string-literal */\n                this.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_8__.queryCellInfo, {\n                    cell: td, column: col, data: selectedRow[\"\" + rowData]\n                });\n                if (this.isReact && td.getAttribute('tabindex') === '0' && td.classList.contains('e-focused')) {\n                    td.focus();\n                }\n            }\n        }\n        else {\n            return;\n        }\n    };\n    /**\n     * @param {string} columnUid - Defines column uid\n     * @param {boolean} renderTemplates - Defines renderTemplates need to invoke\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.refreshReactColumnTemplateByUid = function (columnUid, renderTemplates) {\n        var _this_1 = this;\n        if (this.isReact) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.clearTemplate(['columnTemplate'], undefined, function () {\n                var isChildGrid = _this_1.childGrid && _this_1.element.querySelectorAll('.e-childgrid').length ? true : false;\n                var rows = isChildGrid ? _this_1.getContentTable().querySelectorAll('.e-row') :\n                    _this_1.getDataRows();\n                _this_1.refreshReactTemplateTD(rows, isChildGrid);\n                if (renderTemplates) {\n                    _this_1.renderTemplates();\n                }\n            });\n        }\n    };\n    /**\n     * @param {Element[] | NodeListOf<Element>} rows - Defines the rows\n     * @param {boolean} isChildGrid - Defines whether it is a Hierarchy Grid.\n     * @param {boolean} isFrozen - Defines whether it is a Frozen Grid\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.refreshReactTemplateTD = function (rows, isChildGrid, isFrozen) {\n        var cells = 'cells';\n        var rowIdx = 'index';\n        var indent = this.getIndentCount();\n        var childIndent = 0;\n        var isChildRow = false;\n        for (var j = 0; j < rows.length; j++) {\n            var rowsObj = this.getRowObjectFromUID(rows[parseInt(j.toString(), 10)].getAttribute('data-uid'));\n            if (isChildGrid && !rowsObj && (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(rows[parseInt(j.toString(), 10)], 'e-childgrid')) {\n                var gridObj = (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(rows[parseInt(j.toString(), 10)], 'e-childgrid').ej2_instances[0];\n                rowsObj = gridObj.getRowObjectFromUID(rows[parseInt(j.toString(), 10)].getAttribute('data-uid'));\n                childIndent = gridObj.getIndentCount();\n                isChildRow = true;\n            }\n            if (rowsObj && rowsObj.isDataRow && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(rowsObj.index) &&\n                !rows[parseInt(j.toString(), 10)].classList.contains('e-editedrow')) {\n                for (var i = 0; i < rowsObj[\"\" + cells].length; i++) {\n                    var cell = rowsObj[\"\" + cells][parseInt(i.toString(), 10)];\n                    if (cell.isTemplate) {\n                        var cellRenderer = new _renderer_cell_renderer__WEBPACK_IMPORTED_MODULE_13__.CellRenderer(this, this.serviceLocator);\n                        var td = isChildGrid ? rows[parseInt(j.toString(), 10)]\n                            .children[cell.index + (isChildRow ? childIndent : indent)] : this.getCellFromIndex(j, isFrozen ? cell.index : i - indent);\n                        cellRenderer.refreshTD(td, cell, rowsObj.data, { index: rowsObj[\"\" + rowIdx] });\n                    }\n                }\n            }\n            isChildRow = false;\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.refreshGroupCaptionFooterTemplate = function () {\n        var isChildGrid = this.childGrid && this.element.querySelectorAll('.e-childgrid').length ? true : false;\n        var rows = this.getContentTable().querySelectorAll('.e-groupcaptionrow, .e-groupfooterrow');\n        for (var i = 0; i < rows.length; i++) {\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            var gridObj = this;\n            var rowsObj = this.getRowObjectFromUID(rows[parseInt(i.toString(), 10)].getAttribute('data-uid'));\n            if (isChildGrid && !rowsObj && (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(rows[parseInt(i.toString(), 10)], 'e-childgrid')) {\n                gridObj = (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(rows[parseInt(i.toString(), 10)], 'e-childgrid').ej2_instances[0];\n                rowsObj = gridObj.getRowObjectFromUID(rows[parseInt(i.toString(), 10)].getAttribute('data-uid'));\n            }\n            if (rowsObj) {\n                var cells = rowsObj.cells.filter(function (cell) { return cell.isDataCell; });\n                var args = { cells: cells, data: rowsObj.data, dataUid: rowsObj.uid };\n                gridObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshAggregateCell, args);\n            }\n        }\n    };\n    /**\n     * @param {string} columnUid - Defines column uid\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.refreshReactHeaderTemplateByUid = function (columnUid) {\n        if (this.isReact) {\n            var cells = 'cells';\n            var rowsObj = this.headerModule.rows;\n            var cellIndex = this.getNormalizedColumnIndex(columnUid);\n            var _loop_1 = function (j) {\n                var cell = rowsObj[parseInt(j.toString(), 10)][\"\" + cells][parseInt(cellIndex.toString(), 10)];\n                if (cell && cell.column.uid === columnUid) {\n                    var headerCellRenderer = new _renderer_header_cell_renderer__WEBPACK_IMPORTED_MODULE_14__.HeaderCellRenderer(this_1, this_1.serviceLocator);\n                    var td = (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(this_1.element.querySelectorAll('[e-mappinguid=' + columnUid + ']')[0], 'e-templatecell');\n                    headerCellRenderer.refresh(cell, td);\n                    var cols = this_1.sortSettings.columns;\n                    var columnIndex = cols.findIndex(function (col) {\n                        return col.field === cell\n                            .column.field;\n                    });\n                    if (columnIndex !== -1) {\n                        var header = this_1.getColumnHeaderByField(cell.column.field);\n                        this_1.ariaService.setSort(header, (cols[parseInt(columnIndex.toString(), 10)].direction).toLowerCase());\n                        if (cols.length > 1) {\n                            header.querySelector('.e-headercelldiv').insertBefore(this_1.createElement('span', { className: 'e-sortnumber', innerHTML: (columnIndex + 1).toString() }), header.querySelector('.e-headertext'));\n                        }\n                        var filterElement = header.querySelector('.e-sortfilterdiv');\n                        if (cols[parseInt(columnIndex.toString(), 10)].direction === 'Ascending') {\n                            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(filterElement, ['e-ascending', 'e-icon-ascending'], []);\n                        }\n                        else {\n                            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(filterElement, ['e-descending', 'e-icon-descending'], []);\n                        }\n                    }\n                }\n            };\n            var this_1 = this;\n            for (var j = 0; j < rowsObj.length; j++) {\n                _loop_1(j);\n            }\n        }\n    };\n    /**\n     * Updates and refresh the particular row values based on the given primary key value.\n     * > Primary key column must be specified using `columns.isPrimaryKey` property.\n     *\n     * @param {string| number} key - Specifies the PrimaryKey value of dataSource.\n     * @param {Object} rowData - To update new data for the particular row.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.setRowData = function (key, rowData) {\n        var rowuID = 'uid';\n        var rowObjects = this.contentModule.getRows();\n        var pkName = this.getPrimaryKeyFieldNames()[0];\n        if (this.groupSettings.columns.length > 0 && this.aggregates.length > 0) {\n            rowObjects = rowObjects.filter(function (row) { return row.isDataRow; });\n        }\n        var selectedRow = rowObjects.filter(function (r) {\n            return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(pkName, r.data) === key;\n        })[0];\n        var selectRowEle = selectedRow ? [].slice.call(this.element.querySelectorAll('[data-uid=' + selectedRow[\"\" + rowuID] + ']')) : undefined;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(selectedRow) && selectRowEle.length) {\n            selectedRow.changes = rowData;\n            if (this.frozenRows) {\n                var fRowTr = this.getRowsObject()[selectedRow.index];\n                this.setFrozenRowData(fRowTr, rowData);\n            }\n            else {\n                this.setFrozenRowData(selectedRow, rowData);\n            }\n            if (this.aggregates.length > 0) {\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshFooterRenderer, {});\n                if (this.groupSettings.columns.length > 0) {\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.groupAggregates, {});\n                }\n            }\n        }\n        else {\n            return;\n        }\n    };\n    Grid.prototype.setFrozenRowData = function (fTr, rowData) {\n        var rowRenderer = new _renderer_row_renderer__WEBPACK_IMPORTED_MODULE_15__.RowRenderer(this.serviceLocator, null, this);\n        fTr.changes = rowData;\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.refreshForeignData)(fTr, this.getForeignKeyColumns(), fTr.changes);\n        rowRenderer.refresh(fTr, this.getColumns(), true);\n    };\n    /**\n     * Gets a cell by row and column index.\n     *\n     * @param  {number} rowIndex - Specifies the row index.\n     * @param  {number} columnIndex - Specifies the column index.\n     *\n     * @returns {Element} Returns the Element\n     */\n    Grid.prototype.getCellFromIndex = function (rowIndex, columnIndex) {\n        var col = this.getColumnByIndex(columnIndex);\n        return (0,_util__WEBPACK_IMPORTED_MODULE_9__.getCellByColAndRowIndex)(this, col, rowIndex, columnIndex);\n    };\n    /**\n     * Gets a movable table cell by row and column index.\n     *\n     * @param  {number} rowIndex - Specifies the row index.\n     * @param  {number} columnIndex - Specifies the column index.\n     *\n     * @returns {Element} Returns the Element\n\n     */\n    Grid.prototype.getMovableCellFromIndex = function (rowIndex, columnIndex) {\n        return this.getCellFromIndex(rowIndex, columnIndex);\n    };\n    /**\n     * Gets a frozen right table cell by row and column index.\n     *\n     * @param  {number} rowIndex - Specifies the row index.\n     * @param  {number} columnIndex - Specifies the column index.\n     * @returns {Element} Returns the Element\n\n     */\n    Grid.prototype.getFrozenRightCellFromIndex = function (rowIndex, columnIndex) {\n        return this.getCellFromIndex(rowIndex, columnIndex);\n    };\n    /**\n     * Gets a column header by column index.\n     *\n     * @param  {number} index - Specifies the column index.\n     *\n     * @returns {Element} Returns the Element\n     */\n    Grid.prototype.getColumnHeaderByIndex = function (index) {\n        return this.getHeaderTable().getElementsByClassName('e-headercell')[parseInt(index.toString(), 10)];\n    };\n    /**\n     * Gets a movable column header by column index.\n     *\n     * @param  {number} index - Specifies the column index.\n     * @returns {Element} Returns the Element\n\n     */\n    Grid.prototype.getMovableColumnHeaderByIndex = function (index) {\n        return this.getColumnHeaderByIndex(index);\n    };\n    /**\n     * Gets a frozen right column header by column index.\n     *\n     * @param  {number} index - Specifies the column index.\n     * @returns {Element} Returns the Element\n\n     */\n    Grid.prototype.getFrozenRightColumnHeaderByIndex = function (index) {\n        return this.getColumnHeaderByIndex(index);\n    };\n    /**\n     * Gets a frozen left column header by column index.\n     *\n     * @param  {number} index - Specifies the column index.\n     * @returns {Element} Returns the Element\n\n     */\n    Grid.prototype.getFrozenLeftColumnHeaderByIndex = function (index) {\n        return this.getColumnHeaderByIndex(index);\n    };\n    /**\n     * @param {string} uid - Defines the uid\n     * @returns {Row<Column>} Returns the row object\n     * @hidden\n     */\n    Grid.prototype.getRowObjectFromUID = function (uid) {\n        var rows = this.contentModule.getRows();\n        var row = this.rowObject(rows, uid);\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row) && this.enableVirtualization && this.groupSettings.columns.length > 0) {\n            row = this.rowObject(this.vRows, uid);\n            return row;\n        }\n        return row;\n    };\n    Grid.prototype.rowObject = function (rows, uid) {\n        if (rows) {\n            for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n                var row = rows_1[_i];\n                if (row.uid === uid) {\n                    return row;\n                }\n            }\n        }\n        return null;\n    };\n    /**\n     * Get an array of row objects.\n     *\n     * @returns {Row<Column>[]} Returns the Row object\n     */\n    Grid.prototype.getRowsObject = function () {\n        return this.contentModule.getRows();\n    };\n    /**\n     * @hidden\n     * @returns {Row<Column>[]} Returns the Row object\n\n     */\n    Grid.prototype.getMovableRowsObject = function () {\n        return this.contentModule.getRows();\n    };\n    /**\n     * @hidden\n     * @returns {Row<Column>[]} Returns the Row object\n\n     */\n    Grid.prototype.getFrozenRightRowsObject = function () {\n        return this.contentModule.getRows();\n    };\n    /**\n     * Gets a column header by column name.\n     *\n     * @param  {string} field - Specifies the column name.\n     *\n     * @returns {Element} - Returns the element\n     */\n    Grid.prototype.getColumnHeaderByField = function (field) {\n        var column = this.getColumnByField(field);\n        return column ? this.getColumnHeaderByUid(column.uid) : undefined;\n    };\n    /**\n     * Gets a column header by UID.\n     *\n     * @param {string} uid - Specifies the column uid.\n     *\n     * @returns {Element} - Returns the element\n     */\n    Grid.prototype.getColumnHeaderByUid = function (uid) {\n        var element = this.getHeaderContent().querySelector('[e-mappinguid=' + uid + ']');\n        return element ? element.parentElement : undefined;\n    };\n    /**\n     * @hidden\n     * @param {number} index - Defines the index\n     * @returns {Column} Returns the column\n     */\n    Grid.prototype.getColumnByIndex = function (index) {\n        var column;\n        this.getColumns().some(function (col, i) {\n            column = col;\n            return i === index;\n        });\n        return column;\n    };\n    /**\n     * Gets a Column by column name.\n     *\n     * @param  {string} field - Specifies the column name.\n     *\n     * @returns {Column} Returns the column\n     */\n    Grid.prototype.getColumnByField = function (field) {\n        return (0,_util__WEBPACK_IMPORTED_MODULE_9__.iterateArrayOrObject)(this.getColumns(), function (item) {\n            if (item.field === field) {\n                return item;\n            }\n            return undefined;\n        })[0];\n    };\n    /**\n     * Gets a column index by column name.\n     *\n     * @param  {string} field - Specifies the column name.\n     *\n     * @returns {number} Returns the index by field\n     */\n    Grid.prototype.getColumnIndexByField = function (field) {\n        var cols = this.getColumns();\n        for (var i = 0; i < cols.length; i++) {\n            if (cols[parseInt(i.toString(), 10)].field === field) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /**\n     * Gets a column by UID.\n     *\n     * @param  {string} uid - Specifies the column UID.\n     * @param  {boolean} isColumns - Defines the all columns.\n     *\n     * @returns {Column} Returns the column\n     */\n    Grid.prototype.getColumnByUid = function (uid, isColumns) {\n        var cols = isColumns ? this.columns : this.getColumns();\n        return (0,_util__WEBPACK_IMPORTED_MODULE_9__.iterateArrayOrObject)(cols.concat(this.getStackedColumns(this.columns)), function (item) {\n            if (item.uid === uid) {\n                return item;\n            }\n            return undefined;\n        })[0];\n    };\n    /**\n     * @param {Column[]} columns - Defines the columns\n     * @param {Column[]} stackedColumn - Defines the stacked columns\n     * @returns {Column[]} Returns the columns\n     * @hidden\n     */\n    Grid.prototype.getStackedColumns = function (columns, stackedColumn) {\n        if (stackedColumn === void 0) { stackedColumn = []; }\n        for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n            var column = columns_1[_i];\n            if (column.columns) {\n                stackedColumn.push(column);\n                this.getStackedColumns(column.columns, stackedColumn);\n            }\n        }\n        return stackedColumn;\n    };\n    /**\n     * Gets a column index by UID.\n     *\n     * @param  {string} uid - Specifies the column UID.\n     *\n     * @returns {number} Returns the column by index\n     */\n    Grid.prototype.getColumnIndexByUid = function (uid) {\n        var index = (0,_util__WEBPACK_IMPORTED_MODULE_9__.iterateArrayOrObject)(this.getColumns(), function (item, index) {\n            if (item.uid === uid) {\n                return index;\n            }\n            return undefined;\n        })[0];\n        return !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(index) ? index : -1;\n    };\n    /**\n     * Gets UID by column name.\n     *\n     * @param  {string} field - Specifies the column name.\n     *\n     * @returns {string} Returns the column by field\n     */\n    Grid.prototype.getUidByColumnField = function (field) {\n        return (0,_util__WEBPACK_IMPORTED_MODULE_9__.iterateArrayOrObject)(this.getColumns(), function (item) {\n            if (item.field === field) {\n                return item.uid;\n            }\n            return undefined;\n        })[0];\n    };\n    /**\n     * Gets column index by column uid value.\n     *\n     * @private\n     * @param  {string} uid - Specifies the column uid.\n     * @returns {number} Returns the column by field\n     */\n    Grid.prototype.getNormalizedColumnIndex = function (uid) {\n        var index = this.getColumnIndexByUid(uid);\n        return index + this.getIndentCount();\n    };\n    /**\n     * Gets indent cell count.\n     *\n     * @private\n     * @returns {number} Returns the indent count\n     */\n    Grid.prototype.getIndentCount = function () {\n        var index = 0;\n        if (this.allowGrouping) {\n            index += this.groupSettings.columns.length;\n        }\n        if (this.isDetail()) {\n            index++;\n        }\n        if (this.isRowDragable() && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.rowDropSettings.targetID)) {\n            index++;\n        }\n        /**\n         * TODO: index normalization based on the stacked header, grouping and detailTemplate\n         * and frozen should be handled here\n         */\n        return index;\n    };\n    /**\n     * Gets the collection of column fields.\n     *\n     * @returns {string[]} Returns the Field names\n     */\n    Grid.prototype.getColumnFieldNames = function () {\n        var columnNames = [];\n        var column;\n        for (var i = 0, len = this.getColumns().length; i < len; i++) {\n            column = this.getColumns()[parseInt(i.toString(), 10)];\n            if (column.visible) {\n                columnNames.push(column.field);\n            }\n        }\n        return columnNames;\n    };\n    /**\n     * Gets a compiled row template.\n     *\n     * @returns {Function} Returns the row TEmplate\n     * @private\n     */\n    Grid.prototype.getRowTemplate = function () {\n        return this.rowTemplateFn;\n    };\n    /**\n     * Gets a compiled empty Record template.\n     *\n     * @returns {Function} Returns the empty Record template\n     * @private\n     */\n    Grid.prototype.getEmptyRecordTemplate = function () {\n        return this.emptyRecordTemplateFn;\n    };\n    /**\n     * Gets a compiled detail row template.\n     *\n     * @private\n     * @returns {Function} Returns the Detail template\n     */\n    Grid.prototype.getDetailTemplate = function () {\n        return this.detailTemplateFn;\n    };\n    /**\n     * Gets a compiled dialog edit template.\n     *\n     * @private\n     * @returns {Function} Returns the Edit template\n     */\n    Grid.prototype.getEditTemplate = function () {\n        return this.editTemplateFn;\n    };\n    /**\n     * Gets a compiled dialog edit header template.\n     *\n     * @private\n     * @returns {Function} returns template function\n     */\n    Grid.prototype.getEditHeaderTemplate = function () {\n        return this.editHeaderTemplateFn;\n    };\n    /**\n     * Gets a compiled dialog edit footer template.\n     *\n     * @private\n     * @returns {Function} Returns the Footer template\n     */\n    Grid.prototype.getEditFooterTemplate = function () {\n        return this.editFooterTemplateFn;\n    };\n    /**\n     * Gets a compiled column chooser template.\n     *\n     * @private\n     * @returns {Function} Returns the template\n     */\n    Grid.prototype.getColumnChooserTemplate = function () {\n        return this.columnChooserTemplateFn;\n    };\n    /**\n     * Gets a compiled column chooser header template.\n     *\n     * @private\n     * @returns {Function} returns the header template\n     */\n    Grid.prototype.getColumnChooserHeaderTemplate = function () {\n        return this.columnChooserHeaderTemplateFn;\n    };\n    /**\n     * Gets a compiled column chooser footer template.\n     *\n     * @private\n     * @returns {Function} Returns the Footer template\n     */\n    Grid.prototype.getColumnChooserFooterTemplate = function () {\n        return this.columnChooserFooterTemplateFn;\n    };\n    /**\n     * Get the names of the primary key columns of the Grid.\n     *\n     * @returns {string[]} Returns the field names\n     */\n    Grid.prototype.getPrimaryKeyFieldNames = function () {\n        var keys = [];\n        for (var k = 0; k < this.columnModel.length; k++) {\n            if (this.columnModel[parseInt(k.toString(), 10)].isPrimaryKey) {\n                keys.push(this.columnModel[parseInt(k.toString(), 10)].field);\n            }\n        }\n        return keys;\n    };\n    /**\n     * Refreshes the Grid header and content.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.refresh = function () {\n        if (!this.isDestroyed) {\n            this.isManualRefresh = true;\n            this.headerModule.refreshUI();\n            this.updateStackedFilter();\n            this.renderModule.refresh();\n        }\n    };\n    /**\n     * Refreshes the Grid header.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.refreshHeader = function () {\n        this.headerModule.refreshUI();\n    };\n    /**\n     * Gets the collection of selected rows.\n     *\n     * @returns {Element[]} Returns the element\n     */\n    Grid.prototype.getSelectedRows = function () {\n        return this.selectionModule ? this.selectionModule.selectedRecords : [];\n    };\n    /**\n     * Gets the collection of selected row indexes.\n     *\n     * @returns {number[]} Returns the Selected row indexes\n     */\n    Grid.prototype.getSelectedRowIndexes = function () {\n        return this.selectionModule ? this.selectionModule.selectedRowIndexes : [];\n    };\n    /**\n     * Gets the collection of selected row and cell indexes.\n     *\n     * @returns {number[]} Returns the Selected row cell indexes\n     */\n    Grid.prototype.getSelectedRowCellIndexes = function () {\n        return this.selectionModule ? this.selectionModule.selectedRowCellIndexes : [];\n    };\n    /**\n     * Gets the collection of selected records.\n     *\n     * @returns {Object[]} Returns the selected records\n     * @isGenericType true\n     */\n    Grid.prototype.getSelectedRecords = function () {\n        return this.selectionModule ? this.selectionModule.getSelectedRecords() : [];\n    };\n    /**\n     * Gets the collection of selected columns uid.\n     *\n     * @returns {string[]} Returns the selected column uid\n     * @isGenericType true\n     */\n    Grid.prototype.getSelectedColumnsUid = function () {\n        var _this_1 = this;\n        var uid = [];\n        if (this.selectionModule) {\n            this.selectionModule.selectedColumnsIndexes.filter(function (i) { return uid.push(_this_1.getColumns()[parseInt(i.toString(), 10)].uid); });\n        }\n        return uid;\n    };\n    /**\n     * Gets the data module.\n     *\n     * @returns {Data} Returns the data\n     */\n    Grid.prototype.getDataModule = function () {\n        return this.renderModule.data;\n    };\n    /**\n     * Shows a column by its column name.\n     *\n     * @param  {string|string[]} keys - Defines a single or collection of column names.\n     * @param  {string} showBy - Defines the column key either as field name or header text.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.showColumns = function (keys, showBy) {\n        showBy = showBy ? showBy : 'headerText';\n        this.showHider.show(keys, showBy);\n    };\n    /**\n     * Hides a column by column name.\n     *\n     * @param  {string|string[]} keys - Defines a single or collection of column names.\n     * @param  {string} hideBy - Defines the column key either as field name or header text.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.hideColumns = function (keys, hideBy) {\n        hideBy = hideBy ? hideBy : 'headerText';\n        this.showHider.hide(keys, hideBy);\n    };\n    /**\n     * @hidden\n     * @returns {number} Returns the Frozen column\n     */\n    Grid.prototype.getFrozenColumns = function () {\n        return this.frozenColumns + this.getFrozenCount(this.columns, 0, 0);\n    };\n    /**\n     * @hidden\n     * @returns {number} Returns the Frozen Right column count\n     */\n    Grid.prototype.getFrozenRightColumnsCount = function () {\n        return this.frozenRightCount || this.rightcount;\n    };\n    /**\n     * @hidden\n     * @returns {number} Returns the Frozen Left column\n     */\n    Grid.prototype.getFrozenLeftColumnsCount = function () {\n        return this.frozenLeftCount || this.leftcount;\n    };\n    /**\n     * @hidden\n     * @returns {number} Returns the movable column count\n     */\n    Grid.prototype.getMovableColumnsCount = function () {\n        return this.movableCount || this.movablecount;\n    };\n    Grid.prototype.updateFrozenColumnsWidth = function () {\n        if (this.isFrozenGrid() && !this.enableColumnVirtualization) {\n            var gcol = this.getColumns();\n            var isAutoWidth = true;\n            var autoCol_1 = 0;\n            var difference_1 = 0;\n            var autoWidth_1 = 0;\n            var isFrozenAuto = gcol.some(function (data) {\n                return (data.freeze === 'Left' || data.freeze === 'Right'\n                    || data.freeze === 'Fixed' || data.isFrozen) && data.width === 'auto';\n            });\n            var _loop_2 = function (i) {\n                var col = gcol[parseInt(i.toString(), 10)];\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(col.width) && (col.freeze === 'Left' || col.freeze === 'Right' || col.freeze === 'Fixed' || col.isFrozen)) {\n                    col.width = Math.max(200, col.minWidth ? parseFloat(col.minWidth.toString()) : 0);\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(col.maxWidth) && parseFloat(col.maxWidth.toString()) < col.width) {\n                        col.width = col.maxWidth;\n                    }\n                }\n                if (col.width === 'auto' && isFrozenAuto) {\n                    var tWidth_1 = 0;\n                    if (isAutoWidth) {\n                        gcol.filter(function (cols) {\n                            if (cols.visible) {\n                                if (cols.width === 'auto') {\n                                    autoCol_1++;\n                                }\n                                if (cols.width !== 'auto') {\n                                    var width = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cols.width) ? parseFloat(cols.width.toString()) :\n                                        Math.max(200, cols.minWidth ? parseFloat(cols.minWidth.toString()) : 0);\n                                    tWidth_1 += width;\n                                }\n                            }\n                        });\n                        var gWidth = this_2.isPercentageWidthGrid() || this_2.width === 'auto' ? this_2.element.getBoundingClientRect().width :\n                            parseFloat(this_2.width.toString());\n                        difference_1 = this_2.height === 'auto' ? gWidth - tWidth_1 : ((gWidth - tWidth_1) - (0,_util__WEBPACK_IMPORTED_MODULE_9__.getScrollBarWidth)());\n                        if (difference_1 < 0) {\n                            difference_1 = 0;\n                        }\n                        autoWidth_1 = parseFloat((difference_1 / autoCol_1).toString());\n                        gcol.filter(function (col) {\n                            if (col.visible) {\n                                if (col.minWidth && parseFloat(col.minWidth.toString()) > autoWidth_1) {\n                                    difference_1 = difference_1 - parseFloat(col.minWidth.toString());\n                                    autoCol_1--;\n                                }\n                            }\n                        });\n                        isAutoWidth = false;\n                    }\n                    if (col.minWidth && parseFloat(col.minWidth.toString()) > autoWidth_1) {\n                        col.width = parseFloat(col.minWidth.toString());\n                    }\n                    else {\n                        col.width = difference_1 / autoCol_1;\n                    }\n                }\n            };\n            var this_2 = this;\n            for (var i = 0; i < gcol.length; i++) {\n                _loop_2(i);\n            }\n        }\n    };\n    Grid.prototype.refreshSplitFrozenColumn = function () {\n        this.splitFrozenCount(this.columns);\n        this.updateFrozenColumnsWidth();\n        this.isAutoGenerateColumns = true;\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.setFrozenCount = function () {\n        this.frozenLeftCount = this.frozenRightCount = this.movableCount = 0;\n        this.visibleFrozenLeft = this.visibleFrozenRight = this.visibleMovable = 0;\n        this.frozenLeftColumns = [];\n        this.frozenRightColumns = [];\n        this.movableColumns = [];\n        this.fixedColumns = [];\n        this.splitFrozenCount(this.columns);\n        this.leftcount = this.frozenLeftCount;\n        this.rightcount = this.frozenRightCount;\n        this.movablecount = this.movableCount;\n        // if (this.frozenColumns && (this.frozenLeftCount || this.frozenRightCount)) {\n        //     this.setProperties({ frozenColumns: 0 }, true);\n        // }\n        if (this.frozenLeftCount && !this.frozenRightCount) {\n            this.frozenName = 'Left';\n        }\n        else if (this.frozenRightCount && !this.frozenLeftCount) {\n            this.frozenName = 'Right';\n        }\n        else if (this.frozenLeftCount && this.frozenRightCount) {\n            this.frozenName = 'Left-Right';\n        }\n        else if (this.frozenColumns || this.frozenRows) {\n            this.frozenName = 'Left';\n        }\n        else {\n            this.frozenName = undefined;\n        }\n    };\n    /**\n     * @hidden\n     * @returns {number} Returns the visible Frozen left count\n     */\n    Grid.prototype.getVisibleFrozenLeftCount = function () {\n        return this.visibleFrozenLeft;\n    };\n    /**\n     * @hidden\n     * @returns {number} Returns the visible Frozen Right count\n     */\n    Grid.prototype.getVisibleFrozenRightCount = function () {\n        return this.visibleFrozenRight;\n    };\n    /**\n     * @hidden\n     * @returns {number} Returns the visible movable count\n     */\n    Grid.prototype.getVisibleMovableCount = function () {\n        return this.visibleMovable;\n    };\n    /**\n     * @hidden\n     * @returns {Column[]} Returns the column\n     */\n    Grid.prototype.getFrozenRightColumns = function () {\n        return this.frozenRightColumns;\n    };\n    /**\n     * @hidden\n     * @returns {Column[]} Returns the column\n     */\n    Grid.prototype.getFrozenLeftColumns = function () {\n        return this.frozenLeftColumns;\n    };\n    /**\n     * @hidden\n     * @returns {Column[]} Returns the column\n     */\n    Grid.prototype.getMovableColumns = function () {\n        return this.movableColumns;\n    };\n    Grid.prototype.splitStackedColumns = function (columns) {\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[parseInt(i.toString(), 10)].columns) {\n                this.splitStackedColumns(columns[parseInt(i.toString(), 10)].columns);\n            }\n            else {\n                if (columns[parseInt(i.toString(), 10)].freeze === 'Left' || columns[parseInt(i.toString(), 10)].isFrozen) {\n                    if (columns[parseInt(i.toString(), 10)].visible !== false) {\n                        this.visibleFrozenLeft++;\n                    }\n                    this.leftcount++;\n                }\n                else if (columns[parseInt(i.toString(), 10)].freeze === 'Right') {\n                    if (columns[parseInt(i.toString(), 10)].visible !== false) {\n                        this.visibleFrozenRight++;\n                    }\n                    this.rightcount++;\n                }\n                else if (columns[parseInt(i.toString(), 10)].freeze === 'Fixed') {\n                    if (columns[parseInt(i.toString(), 10)].visible !== false) {\n                        this.visibleFrozenFixed++;\n                    }\n                    this.fixedcount++;\n                }\n                else {\n                    if (columns[parseInt(i.toString(), 10)].visible !== false) {\n                        this.visibleMovable++;\n                    }\n                    this.movablecount++;\n                }\n            }\n        }\n    };\n    Grid.prototype.pushStackedColumns = function (columns, index, arr, col, stackedcol) {\n        arr[parseInt(index.toString(), 10)] = { headerText: col.headerText };\n        if (col.textAlign) {\n            arr[parseInt(index.toString(), 10)].textAlign = col.textAlign;\n        }\n        if (col.customAttributes) {\n            arr[parseInt(index.toString(), 10)].customAttributes = col.customAttributes;\n        }\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[parseInt(i.toString(), 10)].columns) {\n                index = index + 1;\n                this.pushStackedColumns(columns[parseInt(i.toString(), 10)].columns, index, arr, columns[parseInt(i.toString(), 10)], stackedcol);\n                index = index - 1;\n            }\n            else {\n                var stockCol = [];\n                stockCol = arr.slice().slice(0, index + 1);\n                if (columns[parseInt(i.toString(), 10)].freeze === 'Left' || columns[parseInt(i.toString(), 10)].isFrozen) {\n                    this.stackedLeft.push(stockCol);\n                    this.stackedarrayLeft.push(columns[parseInt(i.toString(), 10)]);\n                }\n                else if (columns[parseInt(i.toString(), 10)].freeze === 'Right') {\n                    this.stackedRight.push(stockCol);\n                    this.stackedarrayRight.push(columns[parseInt(i.toString(), 10)]);\n                }\n                else if (columns[parseInt(i.toString(), 10)].freeze === 'Fixed') {\n                    this.stackedFixed.push(stockCol);\n                    this.stackedarrayFixed.push(columns[parseInt(i.toString(), 10)]);\n                }\n                else {\n                    this.stackedMovable.push(stockCol);\n                    this.stackedarrayMovable.push(columns[parseInt(i.toString(), 10)]);\n                }\n            }\n        }\n    };\n    Grid.prototype.pushallcol = function (text, text1, col, columns, isTrue) {\n        if (col.headerText === text1.headerText) {\n            if (isTrue) {\n                col.columns.push(columns);\n            }\n            else {\n                var newColumn = { headerText: text.headerText, columns: [] };\n                if (text.textAlign) {\n                    newColumn.textAlign = text.textAlign;\n                }\n                if (text.customAttributes) {\n                    newColumn.customAttributes = text.customAttributes;\n                }\n                col.columns.push(newColumn);\n            }\n        }\n        else {\n            if (col.columns && col.columns.length) {\n                for (var i = 0; i < col.columns.length; i++) {\n                    this.pushallcol(text, text1, col.columns[parseInt(i.toString(), 10)], columns, isTrue);\n                }\n            }\n        }\n    };\n    Grid.prototype.resetStackedColumns = function (headercol, gridcolumns, freeze) {\n        var col = {};\n        var tempHead = [];\n        for (var i = 1; i <= headercol.length; i++) {\n            var firstcol = headercol[i - 1];\n            for (var j = 0; j < firstcol.length; j++) {\n                if (!col.columns && i === 1) {\n                    col = { headerText: firstcol[parseInt(j.toString(), 10)].headerText,\n                        textAlign: firstcol[parseInt(j.toString(), 10)].textAlign,\n                        customAttributes: firstcol[parseInt(j.toString(), 10)].customAttributes, columns: [] };\n                    tempHead.push(firstcol[parseInt(j.toString(), 10)]);\n                }\n                else {\n                    if (tempHead.indexOf(firstcol[parseInt(j.toString(), 10)]) === -1) {\n                        this.pushallcol(firstcol[parseInt(j.toString(), 10)], firstcol[j - 1], col);\n                        tempHead.push(firstcol[parseInt(j.toString(), 10)]);\n                    }\n                }\n                if (j === firstcol.length - 1) {\n                    this.pushallcol(null, firstcol[parseInt(j.toString(), 10)], col, gridcolumns[i - 1], true);\n                    var count = 0;\n                    while (count !== headercol.length - 1 && i !== headercol.length) {\n                        var firstColHeaders = firstcol.map(function (col) {\n                            return col.headerText;\n                        }).join(', ');\n                        var headerColHeaders = headercol[parseInt(i.toString(), 10)].map(function (item) { return item.headerText; }).join(', ');\n                        if (firstColHeaders === headerColHeaders) {\n                            i++;\n                            this.pushallcol(null, firstcol[parseInt(j.toString(), 10)], col, gridcolumns[i - 1], true);\n                        }\n                        count++;\n                    }\n                }\n            }\n        }\n        if (freeze === 'Left') {\n            this.frozenLeftColumns.push(col);\n        }\n        else if (freeze === 'Right') {\n            this.frozenRightColumns.push(col);\n        }\n        else {\n            this.movableColumns.push(col);\n        }\n    };\n    Grid.prototype.splitFrozenCount = function (columns) {\n        if (this.frozenColumns || (this.changedProperties && this.changedProperties.frozenColumns === 0)) {\n            var cols = !this.enableColumnVirtualization || (this.enableColumnVirtualization && this.isPreparedFrozenColumns) ?\n                this.enableColumnVirtualization && this.columnModel && this.columnModel.length ? this.columnModel :\n                    this.getColumns() : this.columns;\n            if (!this.changedProperties || (this.changedProperties && !this.changedProperties.frozenColumns)) {\n                for (var i = 0; i < cols.length; i++) {\n                    if (this.frozenColumns > i) {\n                        cols[parseInt(i.toString(), 10)].freeze = 'Left';\n                    }\n                    else if (cols[parseInt(i.toString(), 10)].freeze === 'Right' || cols[parseInt(i.toString(), 10)].freeze === 'Fixed') {\n                        cols[parseInt(i.toString(), 10)].freeze = cols[parseInt(i.toString(), 10)].freeze;\n                    }\n                    else {\n                        cols[parseInt(i.toString(), 10)].freeze = undefined;\n                    }\n                }\n            }\n        }\n        for (var i = 0; i < (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns) ? columns.length : 0); i++) {\n            if (columns[parseInt(i.toString(), 10)].columns) {\n                this.leftcount = 0;\n                this.rightcount = 0;\n                this.movablecount = 0;\n                this.fixedcount = 0;\n                var arr = [];\n                this.splitStackedColumns(columns[parseInt(i.toString(), 10)].columns);\n                if (this.leftcount && !this.rightcount && !this.movablecount && !this.fixedcount) {\n                    this.frozenLeftCount += this.leftcount;\n                    this.frozenLeftColumns.push(columns[parseInt(i.toString(), 10)]);\n                }\n                else if (this.rightcount && !this.leftcount && !this.movablecount && !this.fixedcount) {\n                    this.frozenRightCount += this.rightcount;\n                    this.frozenRightColumns.push(columns[parseInt(i.toString(), 10)]);\n                }\n                else if (this.movablecount && !this.leftcount && !this.rightcount && !this.fixedcount) {\n                    this.movableCount += this.movablecount;\n                    this.movableColumns.push(columns[parseInt(i.toString(), 10)]);\n                }\n                else if (this.fixedcount && !this.leftcount && !this.rightcount && !this.movablecount) {\n                    this.fixedCount += this.fixedcount;\n                    this.fixedColumns.push(columns[parseInt(i.toString(), 10)]);\n                    this.movableCount += this.movablecount;\n                    this.movableColumns.push(columns[parseInt(i.toString(), 10)]);\n                }\n                else {\n                    this.frozenLeftCount += this.leftcount;\n                    this.frozenRightCount += this.rightcount;\n                    this.movableCount += this.movablecount;\n                    this.fixedCount += this.fixedcount;\n                    this.leftcount = 0;\n                    this.rightcount = 0;\n                    this.movablecount = 0;\n                    this.fixedcount = 0;\n                    this.stackedLeft = [];\n                    this.stackedRight = [];\n                    this.stackedFixed = [];\n                    this.stackedMovable = [];\n                    this.stackedarrayLeft = [];\n                    this.stackedarrayRight = [];\n                    this.stackedarrayFixed = [];\n                    this.stackedarrayMovable = [];\n                    this.pushStackedColumns(columns[parseInt(i.toString(), 10)].columns, 0, arr, columns[parseInt(i.toString(), 10)], { headerText: columns[parseInt(i.toString(), 10)].headerText,\n                        textAlign: columns[parseInt(i.toString(), 10)].textAlign,\n                        customAttributes: columns[parseInt(i.toString(), 10)].customAttributes, columns: [] });\n                    if (this.stackedarrayLeft.length) {\n                        this.resetStackedColumns(this.stackedLeft, this.stackedarrayLeft, 'Left');\n                    }\n                    if (this.stackedarrayRight.length) {\n                        this.resetStackedColumns(this.stackedRight, this.stackedarrayRight, 'Right');\n                    }\n                    if (this.stackedarrayFixed.length) {\n                        this.resetStackedColumns(this.stackedFixed, this.stackedarrayFixed, 'Fixed');\n                    }\n                    if (this.stackedarrayMovable.length) {\n                        this.resetStackedColumns(this.stackedMovable, this.stackedarrayMovable, 'Movable');\n                    }\n                    this.stackedLeft = [];\n                    this.stackedRight = [];\n                    this.stackedMovable = [];\n                    this.stackedFixed = [];\n                    this.stackedarrayLeft = [];\n                    this.stackedarrayRight = [];\n                    this.stackedarrayMovable = [];\n                    this.stackedarrayFixed = [];\n                }\n            }\n            else {\n                if (columns[parseInt(i.toString(), 10)].freeze === 'Right') {\n                    if (columns[parseInt(i.toString(), 10)].visible !== false) {\n                        this.visibleFrozenRight++;\n                    }\n                    this.frozenRightColumns.push(columns[parseInt(i.toString(), 10)]);\n                    this.frozenRightCount++;\n                }\n                else if (columns[parseInt(i.toString(), 10)].freeze === 'Left' || columns[parseInt(i.toString(), 10)].isFrozen) {\n                    if (columns[parseInt(i.toString(), 10)].visible !== false) {\n                        this.visibleFrozenLeft++;\n                    }\n                    this.frozenLeftColumns.push(columns[parseInt(i.toString(), 10)]);\n                    this.frozenLeftCount++;\n                }\n                else if (columns[parseInt(i.toString(), 10)].freeze === 'Fixed') {\n                    this.fixedColumns.push(columns[parseInt(i.toString(), 10)]);\n                    this.fixedCount++;\n                    this.movableColumns.push(columns[parseInt(i.toString(), 10)]);\n                    this.movableCount++;\n                }\n                else {\n                    if (columns[parseInt(i.toString(), 10)].visible !== false) {\n                        this.visibleMovable++;\n                    }\n                    this.movableColumns.push(columns[parseInt(i.toString(), 10)]);\n                    this.movableCount++;\n                }\n            }\n        }\n        if (this.frozenLeftColumns.length) {\n            var cols = this.frozenLeftColumns[this.frozenLeftColumns.length - 1];\n            this.removeBorder(this.frozenLeftColumns);\n            this.frozenLeftBorderColumns(cols instanceof _models_column__WEBPACK_IMPORTED_MODULE_2__.Column ? this.lastVisibleLeftCol(this.frozenLeftColumns) : cols);\n        }\n        if (this.frozenRightColumns.length) {\n            var cols = this.frozenRightColumns[0];\n            this.removeBorder(this.frozenRightColumns);\n            this.frozenRightBorderColumns(cols instanceof _models_column__WEBPACK_IMPORTED_MODULE_2__.Column ? this.firstVisibleRightCol(this.frozenRightColumns) : cols);\n        }\n        if ((this.frozenLeftColumns.length || this.frozenRightColumns.length) && this.freezeColumnRefresh) {\n            var cols = (this.frozenLeftColumns.concat(this.movableColumns)).concat(this.frozenRightColumns);\n            this.setProperties({ columns: cols }, true);\n            this.freezeColumnRefresh = false;\n        }\n    };\n    Grid.prototype.removeBorder = function (columns) {\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[parseInt(i.toString(), 10)].columns && columns[parseInt(i.toString(), 10)].columns.length) {\n                if (columns[parseInt(i.toString(), 10)].border === 'Right' ||\n                    columns[parseInt(i.toString(), 10)].border === 'Left') {\n                    columns[parseInt(i.toString(), 10)].border = undefined;\n                }\n                this.removeBorder(columns[parseInt(i.toString(), 10)].columns);\n            }\n            else {\n                if (columns[parseInt(i.toString(), 10)].border === 'Right' ||\n                    columns[parseInt(i.toString(), 10)].border === 'Left') {\n                    columns[parseInt(i.toString(), 10)].border = undefined;\n                }\n            }\n        }\n    };\n    Grid.prototype.isVisibleColumns = function (column, arr) {\n        if (column.columns && column.columns.length) {\n            for (var i = 0; i < column.columns.length; i++) {\n                this.isVisibleColumns(column.columns[parseInt(i.toString(), 10)], arr);\n                if (column.columns[parseInt(i.toString(), 10)].visible &&\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.columns[parseInt(i.toString(), 10)].columns) &&\n                    (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.columns[parseInt(i.toString(), 10)].freeze) ||\n                        column.columns[parseInt(i.toString(), 10)].isFrozen)) {\n                    arr.push('true');\n                }\n            }\n        }\n        else {\n            if (column.visible && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.freeze) || column.isFrozen)) {\n                arr.push('true');\n            }\n        }\n    };\n    Grid.prototype.lastVisibleLeftCol = function (columns) {\n        var column;\n        for (var i = columns.length - 1; i >= 0; i--) {\n            var arr = [];\n            this.isVisibleColumns(columns[parseInt(i.toString(), 10)], arr);\n            if (columns[parseInt(i.toString(), 10)].visible && arr.indexOf('true') !== -1) {\n                column = columns[parseInt(i.toString(), 10)];\n                break;\n            }\n        }\n        return column;\n    };\n    Grid.prototype.firstVisibleRightCol = function (columns) {\n        var column;\n        for (var i = 0; i < columns.length; i++) {\n            var arr = [];\n            this.isVisibleColumns(columns[parseInt(i.toString(), 10)], arr);\n            if (columns[parseInt(i.toString(), 10)].visible && arr.indexOf('true') !== -1) {\n                column = columns[parseInt(i.toString(), 10)];\n                break;\n            }\n        }\n        return column;\n    };\n    Grid.prototype.frozenLeftBorderColumns = function (columns) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns)) {\n            return;\n        }\n        if (columns.columns && columns.columns.length) {\n            columns.border = 'Left';\n            var cols = columns.columns[columns.columns.length - 1];\n            this.frozenLeftBorderColumns(cols instanceof _models_column__WEBPACK_IMPORTED_MODULE_2__.Column && cols.columns ? this.lastVisibleLeftCol(columns.columns) : cols);\n        }\n        else {\n            columns.border = 'Left';\n        }\n    };\n    Grid.prototype.frozenRightBorderColumns = function (columns) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns)) {\n            return;\n        }\n        if (columns.columns && columns.columns.length) {\n            columns.border = 'Right';\n            var cols = columns.columns[0];\n            this.frozenRightBorderColumns(cols instanceof _models_column__WEBPACK_IMPORTED_MODULE_2__.Column && cols.columns ? this.firstVisibleRightCol(columns.columns) : cols);\n        }\n        else {\n            columns.border = 'Right';\n        }\n    };\n    /**\n     * @hidden\n     * @returns {number} Returns the visible frozen columns count\n     */\n    Grid.prototype.getVisibleFrozenColumns = function () {\n        return this.getVisibleFrozenColumnsCount() + this.getVisibleFrozenCount(this.columns, 0);\n    };\n    /**\n     * Get the current Filter operator and field.\n     *\n     * @returns {FilterUI} Returns the filter UI\n     */\n    Grid.prototype.getFilterUIInfo = function () {\n        return this.filterModule ? this.filterModule.getFilterUIInfo() : {};\n    };\n    Grid.prototype.getVisibleFrozenColumnsCount = function () {\n        var visibleFrozenColumns = 0;\n        var columns = this.columnModel;\n        for (var i = 0; i < this.frozenColumns; i++) {\n            if (columns[parseInt(i.toString(), 10)].visible) {\n                visibleFrozenColumns++;\n            }\n        }\n        if ((this.frozenLeftCount || this.leftcount) || (this.frozenRightCount || this.rightcount)) {\n            for (var i = 0; i < columns.length; i++) {\n                if (columns[parseInt(i.toString(), 10)].visible && (columns[parseInt(i.toString(), 10)].freeze === 'Left'\n                    || columns[parseInt(i.toString(), 10)].freeze === 'Right')) {\n                    visibleFrozenColumns++;\n                }\n            }\n        }\n        return visibleFrozenColumns;\n    };\n    Grid.prototype.getVisibleFrozenCount = function (cols, cnt) {\n        if ((!this.frozenLeftCount && !this.leftcount) && (!this.frozenRightCount || !this.rightcount)) {\n            for (var i = 0, len = cols.length; i < len; i++) {\n                if (cols[parseInt(i.toString(), 10)].columns) {\n                    cnt = this.getVisibleFrozenCount(cols[parseInt(i.toString(), 10)].columns, cnt);\n                }\n                else {\n                    if (cols[parseInt(i.toString(), 10)].isFrozen && cols[parseInt(i.toString(), 10)].visible) {\n                        cnt++;\n                    }\n                }\n            }\n        }\n        return cnt;\n    };\n    Grid.prototype.getFrozenCount = function (cols, cnt, index) {\n        for (var i = 0, len = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cols) ? cols.length : 0); i < len; i++) {\n            if (cols[parseInt(i.toString(), 10)].columns) {\n                cnt = this.getFrozenCount(cols[parseInt(i.toString(), 10)].columns, cnt, index);\n            }\n            else {\n                if (cols[parseInt(i.toString(), 10)].isFrozen && index > this.frozenColumns - 1) {\n                    cnt++;\n                }\n                index++;\n            }\n        }\n        return cnt;\n    };\n    /**\n     * Navigates to the specified target page.\n     *\n     * @param  {number} pageNo - Defines the page number to navigate.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.goToPage = function (pageNo) {\n        if (this.pagerModule) {\n            this.pagerModule.goToPage(pageNo);\n        }\n    };\n    /**\n     * Defines the text of external message.\n     *\n     * @param  {string} message - Defines the message to update.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.updateExternalMessage = function (message) {\n        if (this.pagerModule && !this.pagerTemplate) {\n            this.pagerModule.updateExternalMessage(message);\n        }\n    };\n    /**\n     * Sorts a column with the given options.\n     *\n     * @param {string} columnName - Defines the column name to be sorted.\n     * @param {SortDirection} direction - Defines the direction of sorting field.\n     * @param {boolean} isMultiSort - Specifies whether the previous sorted columns are to be maintained.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.sortColumn = function (columnName, direction, isMultiSort) {\n        if (this.sortModule) {\n            this.sortModule.sortColumn(columnName, direction, isMultiSort);\n        }\n    };\n    /**\n     * Remove the existing columns along with the grid actions like sorting, filtering, searching, grouping, aggregate, etc., and grid will refresh with new columns based on the updated new data source.\n     * > * If no columns are specified while changing the data source, then the columns are auto generated in the Grid based on the list of columns in the updated data source.\n     *\n     * @param {Object | DataManager | DataResult} dataSource -  Assign the new datasource.\n     * @param {Column[] | string[] | ColumnModel[]} columns - Defines columns.\n     * @returns {void}\n     *\n     *\n     * ```typescript\n     * <button id=\"btn\">change dataSource </button>\n     * <div id=\"Grid\"></div>\n     * <script>\n     * let gridObj: Grid = new Grid({\n     *     dataSource: employeeData,  // you can define the datamanager here if you are binding a data through datamanager\n     *     columns: [\n     *         { field: 'OrderID', headerText: 'Order ID', width:100 },\n     *         { field: 'EmployeeID', headerText: 'Employee ID' }],\n     * });\n     * gridObj.appendTo('#Grid');\n     * document.getElementById('btn').addEventListener(\"click\", function(){\n     * let newColumn: [\n     *     { field: 'CustomerID', headerText: 'Customer ID', width:100 },\n     *     { field: 'FirstName', headerText: 'Name' }];\n     * gridObj.changeDataSource(customerData, newColumn);\n     * });\n     * </script>\n     * ```\n     *\n     */\n    Grid.prototype.changeDataSource = function (dataSource, columns) {\n        this.isChangeDataSourceCall = true;\n        this.setProperties({ sortSettings: { columns: [] } }, true);\n        this.setProperties({ filterSettings: { columns: [] } }, true);\n        this.setProperties({ searchSettings: { key: '' } }, true);\n        if (this.allowGrouping) {\n            this.setProperties({ groupSettings: { columns: [] } }, true);\n        }\n        if (columns && columns.length) {\n            this.setProperties({ columns: columns }, true);\n        }\n        if (dataSource) {\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns)) {\n                this.setProperties({ columns: [] }, true);\n            }\n            this.setProperties({ dataSource: dataSource }, true);\n        }\n        this.freezeRefresh();\n        this.isChangeDataSourceCall = false;\n    };\n    /**\n     * Clears all the sorted columns of the Grid.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.clearSorting = function () {\n        if (this.sortModule) {\n            this.sortModule.clearSorting();\n        }\n    };\n    /**\n     * Remove sorted column by field name.\n     *\n     * @param {string} field - Defines the column field name to remove sort.\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.removeSortColumn = function (field) {\n        if (this.sortModule) {\n            this.sortModule.removeSortColumn(field);\n        }\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.clearGridActions = function () {\n        this.setProperties({ sortSettings: { columns: [] } }, true);\n        this.setProperties({ filterSettings: { columns: [] } }, true);\n        this.setProperties({ searchSettings: { key: '' } }, true);\n        if (this.allowGrouping) {\n            this.setProperties({ groupSettings: { columns: [] } }, false);\n        }\n        else {\n            this.freezeRefresh();\n        }\n    };\n    /**\n     * Filters grid row by column name with the given options.\n     *\n     * @param  {string} fieldName - Defines the field name of the column.\n     * @param  {string} filterOperator - Defines the operator to filter records.\n     * @param  {string | number | Date | boolean} filterValue - Defines the value used to filter records.\n     * @param  {string} predicate - Defines the relationship between one filter query and another by using AND or OR predicate.\n     * @param  {boolean} matchCase - If match case is set to true, the grid filters the records with exact match. if false, it filters case\n     * insensitive records (uppercase and lowercase letters treated the same).\n     * @param  {boolean} ignoreAccent - If ignoreAccent set to true,\n     * then filter ignores the diacritic characters or accents while filtering.\n     * @param  {string} actualFilterValue - Defines the actual filter value for the filter column.\n     * @param  {string} actualOperator - Defines the actual filter operator for the filter column.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.filterByColumn = function (fieldName, filterOperator, filterValue, predicate, matchCase, ignoreAccent, actualFilterValue, actualOperator) {\n        if (this.filterModule) {\n            this.filterModule.filterByColumn(fieldName, filterOperator, filterValue, predicate, matchCase, ignoreAccent, actualFilterValue, actualOperator);\n        }\n    };\n    /**\n     * Clears all the filtered rows of the Grid.\n     *\n     * @param {string[]} fields - Defines the Fields\n     * @returns {void}\n     */\n    Grid.prototype.clearFiltering = function (fields) {\n        if (this.filterModule) {\n            this.filterModule.clearFiltering(fields);\n        }\n    };\n    /**\n     * Removes filtered column by field name.\n     *\n     * @param  {string} field - Defines column field name to remove filter.\n     * @param  {boolean} isClearFilterBar -  Specifies whether the filter bar value needs to be cleared.\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.removeFilteredColsByField = function (field, isClearFilterBar) {\n        if (this.filterModule) {\n            this.filterModule.removeFilteredColsByField(field, isClearFilterBar);\n        }\n    };\n    /**\n     * Selects a row by given index.\n     *\n     * @param  {number} index - Defines the row index.\n     * @param  {boolean} isToggle - If set to true, then it toggles the selection.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.selectRow = function (index, isToggle) {\n        if (this.selectionModule) {\n            this.selectionModule.selectRow(index, isToggle);\n        }\n    };\n    /**\n     * Selects a collection of rows by indexes.\n     *\n     * @param  {number[]} rowIndexes - Specifies the row indexes.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.selectRows = function (rowIndexes) {\n        if (this.selectionModule) {\n            this.selectionModule.selectRows(rowIndexes);\n        }\n    };\n    /**\n     * Deselects the current selected rows and cells.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.clearSelection = function () {\n        if (this.selectionModule) {\n            this.selectionModule.clearSelection();\n        }\n    };\n    /**\n     * Selects a cell by the given index.\n     *\n     * @param  {IIndex} cellIndex - Defines the row and column indexes.\n     * @param  {boolean} isToggle - If set to true, then it toggles the selection.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.selectCell = function (cellIndex, isToggle) {\n        if (this.selectionModule) {\n            this.selectionModule.selectCell(cellIndex, isToggle);\n        }\n    };\n    /**\n     * Selects a range of cells from start and end indexes.\n     *\n     * @param  {IIndex} startIndex - Specifies the row and column's start index.\n     * @param  {IIndex} endIndex - Specifies the row and column's end index.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.selectCellsByRange = function (startIndex, endIndex) {\n        this.selectionModule.selectCellsByRange(startIndex, endIndex);\n    };\n    /**\n     * Searches Grid records using the given key.\n     * You can customize the default search option by using the\n     * [`searchSettings`](./#searchsettings/).\n     *\n     * @param  {string} searchString - Defines the key.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.search = function (searchString) {\n        if (this.searchModule) {\n            this.searchModule.search(searchString);\n        }\n    };\n    /**\n     * By default, prints all the pages of the Grid and hides the pager.\n     * > You can customize print options using the\n     * [`printMode`](./#printmode).\n     *\n     * @returns {void}\n     */\n    Grid.prototype.print = function () {\n        if (this.printModule) {\n            this.printModule.print();\n        }\n    };\n    /**\n     * Delete a record with Given options. If fieldname and data is not given then grid will delete the selected record.\n     * > `editSettings.allowDeleting` should be true.\n     *\n     * @param {string} fieldname - Defines the primary key field, 'Name of the column'.\n     * @param {Object} data - Defines the JSON data of the record to be deleted.\n     * @returns {void}\n     */\n    Grid.prototype.deleteRecord = function (fieldname, data) {\n        if (this.editModule) {\n            this.editModule.deleteRecord(fieldname, data);\n        }\n    };\n    /**\n     * Starts edit the selected row. At least one row must be selected before invoking this method.\n     * `editSettings.allowEditing` should be true.\n     * {% codeBlock src='grid/startEdit/index.md' %}{% endcodeBlock %}\n     *\n     * @returns {void}\n     */\n    Grid.prototype.startEdit = function () {\n        if (this.editModule) {\n            this.editModule.startEdit();\n        }\n    };\n    /**\n     * If Grid is in editable state, you can save a record by invoking endEdit.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.endEdit = function () {\n        if (this.editModule) {\n            this.editModule.endEdit();\n        }\n    };\n    /**\n     * Cancels edited state.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.closeEdit = function () {\n        if (this.editModule) {\n            this.editModule.closeEdit();\n        }\n    };\n    /**\n     * Adds a new record to the Grid. Without passing parameters, it adds empty rows.\n     * > `editSettings.allowEditing` should be true.\n     *\n     * @param {Object} data - Defines the new add record data.\n     * @param {number} index - Defines the row index to be added\n     * @returns {void}\n     */\n    Grid.prototype.addRecord = function (data, index) {\n        if (this.editModule) {\n            this.editModule.addRecord(data, index);\n        }\n    };\n    /**\n     * Delete any visible row by TR element.\n     *\n     * @param {HTMLTableRowElement} tr - Defines the table row element.\n     * @returns {void}\n     */\n    Grid.prototype.deleteRow = function (tr) {\n        if (this.editModule) {\n            this.editModule.deleteRow(tr);\n        }\n    };\n    /**\n     * Changes a particular cell into edited state based on the row index and field name provided in the `batch` mode.\n     *\n     * @param {number} index - Defines row index to edit a particular cell.\n     * @param {string} field - Defines the field name of the column to perform batch edit.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.editCell = function (index, field) {\n        if (this.editModule) {\n            this.editModule.editCell(index, field);\n        }\n    };\n    /**\n     * Saves the cell that is currently edited. It does not save the value to the DataSource.\n     *\n     * @returns {void}\n     * {% codeBlock src='grid/saveCell/index.md' %}{% endcodeBlock %}\n     */\n    Grid.prototype.saveCell = function () {\n        if (this.editModule) {\n            this.editModule.saveCell();\n        }\n    };\n    /**\n     * To update the specified cell by given value without changing into edited state.\n     *\n     * @param {number} rowIndex Defines the row index.\n     * @param {string} field Defines the column field.\n     * @param {string | number | boolean | Date} value - Defines the value to be changed.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.updateCell = function (rowIndex, field, value) {\n        if (this.editModule) {\n            this.editModule.updateCell(rowIndex, field, value);\n        }\n    };\n    /**\n     * To update the specified row by given values without changing into edited state.\n     *\n     * {% codeBlock src='grid/updateRow/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} index Defines the row index.\n     * @param {Object} data Defines the data object to be updated.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.updateRow = function (index, data) {\n        if (this.editModule) {\n            this.editModule.updateRow(index, data);\n        }\n    };\n    /**\n     * Gets the added, edited,and deleted data before bulk save to the DataSource in batch mode.\n     *\n     * @returns {Object} Returns the batch changes\n     */\n    Grid.prototype.getBatchChanges = function () {\n        if (this.editModule) {\n            return this.editModule.getBatchChanges();\n        }\n        return {};\n    };\n    /**\n     * Enables or disables ToolBar items.\n     *\n     * @param {string[]} items - Defines the collection of itemID of ToolBar items.\n     * @param {boolean} isEnable - Defines the items to be enabled or disabled.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.enableToolbarItems = function (items, isEnable) {\n        if (this.toolbarModule) {\n            this.toolbarModule.enableItems(items, isEnable);\n        }\n    };\n    /**\n     * Copy the selected rows or cells data into clipboard.\n     *\n     * @param {boolean} withHeader - Specifies whether the column header text needs to be copied along with rows or cells.\n     * @returns {void}\n     */\n    Grid.prototype.copy = function (withHeader) {\n        if (this.clipboardModule) {\n            this.clipboardModule.copy(withHeader);\n        }\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.recalcIndentWidth = function () {\n        var _this_1 = this;\n        if (!this.getHeaderTable().querySelector('.e-emptycell')) {\n            return;\n        }\n        if ((!this.groupSettings.columns.length && !this.isDetail() && !this.isRowDragable()) ||\n            this.getHeaderTable().querySelector('.e-emptycell.e-indentRefreshed') ||\n            !this.getContentTable()) {\n            return;\n        }\n        var indentWidth = this.getHeaderTable().querySelector('.e-emptycell').parentElement.offsetWidth;\n        var headerCol = [].slice.call(this.getHeaderTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.colGroup).childNodes);\n        var contentCol = [].slice.call(this.getContentTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.colGroup).childNodes);\n        var perPixel = indentWidth / 30;\n        var i = this.getFrozenMode() === 'Right' ? this.groupSettings.columns.length + this.getColumns().length : 0;\n        var parentOffset = this.element.offsetWidth;\n        var applyWidth = function (index, width) {\n            if ((0,_util__WEBPACK_IMPORTED_MODULE_9__.ispercentageWidth)(_this_1)) {\n                var newWidth = (width / parentOffset * 100).toFixed(1) + '%';\n                headerCol[parseInt(index.toString(), 10)].style.width = newWidth;\n                contentCol[parseInt(index.toString(), 10)].style.width = newWidth;\n            }\n            else {\n                headerCol[parseInt(index.toString(), 10)].style.width = width + 'px';\n                contentCol[parseInt(index.toString(), 10)].style.width = width + 'px';\n            }\n            _this_1.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.columnWidthChanged, { index: index, width: width });\n        };\n        if (perPixel >= 1) {\n            indentWidth = (30 / perPixel);\n        }\n        if (indentWidth < 1) {\n            indentWidth = 1;\n        }\n        if (this.enableColumnVirtualization || this.isAutoGen || (this.columns.length === this.groupSettings.columns.length)) {\n            indentWidth = 30;\n        }\n        while (i < this.groupSettings.columns.length) {\n            applyWidth(i, indentWidth);\n            i++;\n        }\n        if (this.isDetail()) {\n            applyWidth(i, indentWidth);\n            i++;\n        }\n        if (this.isRowDragable()) {\n            applyWidth(i, indentWidth);\n        }\n        this.isAutoGen = false;\n        this.getHeaderTable().querySelector('.e-emptycell').classList.add('e-indentRefreshed');\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.resetIndentWidth = function () {\n        if (this.isDestroyed) {\n            return;\n        }\n        if ((0,_util__WEBPACK_IMPORTED_MODULE_9__.ispercentageWidth)(this)) {\n            this.getHeaderTable().querySelector('.e-emptycell').classList.remove('e-indentRefreshed');\n            this.widthService.setWidthToColumns();\n            this.recalcIndentWidth();\n            if (this.autoFit) {\n                this.preventAdjustColumns();\n            }\n        }\n        if ((this.width === 'auto' || typeof (this.width) === 'string' && this.width.indexOf('%') !== -1)\n            && this.getColumns().filter(function (col) { return (!col.width || col.width === 'auto') && col.minWidth; }).length > 0) {\n            var tgridWidth = this.widthService.getTableWidth(this.getColumns(), true);\n            this.widthService.setMinwidthBycalculation(tgridWidth);\n        }\n        if (this.isFrozenGrid() && this.enableColumnVirtualization && this.widthService) {\n            this.widthService.refreshFrozenScrollbar();\n        }\n        if (this.allowTextWrap && this.textWrapSettings.wrapMode !== 'Content') {\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshHandlers, {});\n        }\n        if (this.frozenRows && this.scrollModule) {\n            this.scrollModule.resizeFrozenRowBorder();\n        }\n        if (this.enableStickyHeader) {\n            this.scrollModule.makeStickyHeader();\n        }\n        if (this.enableAutoFill && this.selectionSettings.type === 'Multiple' &&\n            this.selectionSettings.mode === 'Cell' && this.selectionModule.selectedRowCellIndexes.length) {\n            this.selectionModule.updateAutoFillPosition();\n            this.selectionModule.drawBorders();\n        }\n    };\n    /**\n     * @hidden\n     * @returns {boolean} Returns isRowDragable\n     */\n    Grid.prototype.isRowDragable = function () {\n        return this.allowRowDragAndDrop && !this.rowDropSettings.targetID;\n    };\n    /**\n     * Changes the Grid column positions by field names.\n     *\n     * @param  {string} fromFName - Defines the origin field name.\n     * @param  {string} toFName - Defines the destination field name.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.reorderColumns = function (fromFName, toFName) {\n        if (this.reorderModule) {\n            this.reorderModule.reorderColumns(fromFName, toFName);\n        }\n    };\n    /**\n     * Changes the Grid column positions by field index. If you invoke reorderColumnByIndex multiple times,\n     * then you won't get the same results every time.\n     *\n     * @param  {number} fromIndex - Defines the origin field index.\n     * @param  {number} toIndex - Defines the destination field index.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.reorderColumnByIndex = function (fromIndex, toIndex) {\n        if (this.reorderModule) {\n            this.reorderModule.reorderColumnByIndex(fromIndex, toIndex);\n        }\n    };\n    /**\n     * Changes the Grid column positions by field index. If you invoke reorderColumnByTargetIndex multiple times,\n     * then you will get the same results every time.\n     *\n     * @param  {string} fieldName - Defines the field name.\n     * @param  {number} toIndex - Defines the destination field index.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.reorderColumnByTargetIndex = function (fieldName, toIndex) {\n        if (this.reorderModule) {\n            this.reorderModule.reorderColumnByTargetIndex(fieldName, toIndex);\n        }\n    };\n    /**\n     * Changes the Grid Row position with given indexes.\n     *\n     * @param  {number} fromIndexes - Defines the origin Indexes.\n     * @param  {number} toIndex - Defines the destination Index.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.reorderRows = function (fromIndexes, toIndex) {\n        if (this.rowDragAndDropModule) {\n            this.rowDragAndDropModule.reorderRows(fromIndexes, toIndex);\n        }\n    };\n    /**\n     * @param {ReturnType} e - Defines the Return type\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.refreshDataSource = function (e) {\n        this.notify('refreshdataSource', e);\n    };\n    /**\n     * @param {boolean} enable -Defines the enable\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.disableRowDD = function (enable) {\n        var headerTable = this.getHeaderTable();\n        var contentTable = this.getContentTable();\n        var headerRows = headerTable.querySelectorAll('th.e-rowdragheader, th.e-mastercell');\n        var rows = this.getRows();\n        var disValue = enable ? 'none' : '';\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setStyleAttribute)(headerTable.querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.colGroup).childNodes[0], { 'display': disValue });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setStyleAttribute)(contentTable.querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.colGroup).childNodes[0], { 'display': disValue });\n        for (var i = 0; i < this.getRows().length; i++) {\n            var ele = rows[parseInt(i.toString(), 10)].firstElementChild;\n            if (enable) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([ele], 'e-hide');\n            }\n            else {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([ele], ['e-hide']);\n            }\n        }\n        for (var j = 0; j < headerTable.querySelectorAll('th.e-rowdragheader, th.e-mastercell').length; j++) {\n            var ele = headerRows[parseInt(j.toString(), 10)];\n            if (enable) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([ele], 'e-hide');\n            }\n            else {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([ele], ['e-hide']);\n            }\n        }\n    };\n    /**\n     * Changes the column width to automatically fit its content to ensure that the width shows the content without wrapping/hiding.\n     * > * This method ignores the hidden columns.\n     * > * Uses the `autoFitColumns` method in the `dataBound` event to resize at initial rendering.\n     * > * By specifying the start row index and end row index, providing the range within which the maximum width for that column should be considered when applying `autoFitColumns`.\n     * > * The width of header rows is always calculated. If the width of a header row exceeds the specified range, its width will be allocated to the specific content rows.\n     *\n     * @param  {string |string[]} fieldNames - Defines the column names.\n     * @param  {number} startRowIndex - Specifies the start index of the content row.\n     * @param  {number} endRowIndex - Specifies the end index of content row.\n     * @returns {void}\n     *\n     *\n     * ```typescript\n     * <div id=\"Grid\"></div>\n     * <script>\n     * let gridObj: Grid = new Grid({\n     *     dataSource: employeeData,\n     *     columns: [\n     *         { field: 'OrderID', headerText: 'Order ID', width:100 },\n     *         { field: 'EmployeeID', headerText: 'Employee ID' }],\n     *     dataBound: () => gridObj.autoFitColumns('EmployeeID');\n     * });\n     * gridObj.appendTo('#Grid');\n     * </script>\n     * ```\n     *\n     */\n    Grid.prototype.autoFitColumns = function (fieldNames, startRowIndex, endRowIndex) {\n        var injectedModules = this.getInjectedModules();\n        var resize = injectedModules.find(function (item) {\n            if (typeof item === 'function' && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(item.prototype)) {\n                return item.prototype.getModuleName() === 'resize';\n            }\n            else {\n                return item.name === 'Resize';\n            }\n        });\n        if (!this.resizeModule && resize) {\n            this.autoFitColumnsResize = true;\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.injectModules();\n        }\n        if (this.resizeModule) {\n            this.resizeModule.autoFitColumns(fieldNames, startRowIndex, endRowIndex);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.preventAdjustColumns = function () {\n        if ((this.enableAdaptiveUI && this.rowRenderingMode === 'Vertical')\n            || (this.allowResizing && this.resizeSettings.mode === 'Auto')) {\n            return;\n        }\n        var columns = this.getColumns();\n        var headerTable = this.getHeaderTable();\n        var tableWidth = 0;\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[parseInt(i.toString(), 10)].visible) {\n                if (this.groupSettings.columns.length\n                    && this.groupSettings.columns.indexOf(columns[parseInt(i.toString(), 10)].field) > -1) {\n                    var headerCol = [].slice.call(headerTable.querySelector('colgroup')\n                        .querySelectorAll(':not(.e-group-intent):not(.e-detail-intent):not(.e-drag-intent)'));\n                    if (headerCol[parseInt(i.toString(), 10)].style.display === 'none') {\n                        continue;\n                    }\n                }\n                if (columns[parseInt(i.toString(), 10)].width) {\n                    tableWidth += parseFloat(columns[parseInt(i.toString(), 10)].width.toString());\n                }\n                else {\n                    tableWidth = 0;\n                    break;\n                }\n            }\n        }\n        if (tableWidth) {\n            var percentageWidth = this.isPercentageWidthGrid();\n            var unit = this.widthUnit(percentageWidth);\n            var contentTable = this.getContentTable();\n            if (this.groupSettings.columns.length || this.isDetail() || this.isRowDragable()) {\n                var indentWidth = this.defaultIndentWidth(percentageWidth);\n                var indentWidthUnitFormat = indentWidth.toString() + unit;\n                var headerIndentCol = [].slice.call(headerTable.querySelector('colgroup')\n                    .querySelectorAll('.e-group-intent, .e-detail-intent, .e-drag-intent'));\n                var contentIndentCol = [].slice.call(contentTable.querySelector('colgroup')\n                    .querySelectorAll('.e-group-intent, .e-detail-intent, .e-drag-intent'));\n                for (var i = 0; i < headerIndentCol.length; i++) {\n                    headerIndentCol[parseInt(i.toString(), 10)].style.setProperty('width', indentWidthUnitFormat);\n                    contentIndentCol[parseInt(i.toString(), 10)].style.setProperty('width', indentWidthUnitFormat);\n                    tableWidth += indentWidth;\n                }\n            }\n            if ((percentageWidth && tableWidth < 100)\n                || (!percentageWidth && tableWidth < contentTable.parentElement.clientWidth)) {\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(contentTable.querySelector('.e-emptyrow'))) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([headerTable], ['e-tableborder']);\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([contentTable], ['e-tableborder']);\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([headerTable, contentTable], ['e-tableborder']);\n                }\n            }\n            var tableWidthUnitFormat = tableWidth.toString() + unit;\n            headerTable.style.setProperty('width', tableWidthUnitFormat);\n            contentTable.style.setProperty('width', tableWidthUnitFormat);\n        }\n        else {\n            this.restoreAdjustColumns();\n        }\n    };\n    Grid.prototype.restoreAdjustColumns = function () {\n        if ((this.enableAdaptiveUI && this.rowRenderingMode === 'Vertical')\n            || (this.allowResizing && this.resizeSettings.mode === 'Auto')) {\n            return;\n        }\n        var headerTable = this.getHeaderTable();\n        var contentTable = this.getContentTable();\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([headerTable, contentTable], ['e-tableborder']);\n        headerTable.style.removeProperty('width');\n        contentTable.style.removeProperty('width');\n        if (this.groupSettings.columns.length || this.isDetail() || this.isRowDragable()) {\n            var percentageWidth = this.isPercentageWidthGrid();\n            var indentWidthUnitFormat_1 = this.defaultIndentWidth(percentageWidth).toString() + this.widthUnit(percentageWidth);\n            var headerIndentCol = [].slice.call(headerTable.querySelector('colgroup')\n                .querySelectorAll('.e-group-intent, .e-detail-intent, .e-drag-intent'));\n            headerIndentCol.forEach(function (element) {\n                element.style.setProperty('width', indentWidthUnitFormat_1);\n            });\n            headerTable.querySelector('.e-emptycell').classList.remove('e-indentRefreshed');\n            this.recalcIndentWidth();\n        }\n    };\n    Grid.prototype.widthUnit = function (percentageWidth) {\n        return percentageWidth ? '%' : 'px';\n    };\n    Grid.prototype.defaultIndentWidth = function (percentageWidth) {\n        return percentageWidth ? parseFloat((30 / this.element.offsetWidth * 100).toFixed(1)) : 30;\n    };\n    Grid.prototype.isPercentageWidthGrid = function () {\n        var column = this.getColumns().find(function (col) { return !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(col.width); });\n        return column ? column.width.toString().indexOf('%') > -1 : false;\n    };\n    /**\n     * @param {number} x - Defines the number\n     * @param {number} y - Defines the number\n     * @param {Element} target - Defines the Element\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.createColumnchooser = function (x, y, target) {\n        if (this.columnChooserModule) {\n            this.columnChooserModule.renderColumnChooser(x, y, target);\n        }\n    };\n    Grid.prototype.initializeServices = function () {\n        this.serviceLocator.register('widthService', this.widthService = new _services_width_controller__WEBPACK_IMPORTED_MODULE_16__.ColumnWidthService(this));\n        this.serviceLocator.register('cellRendererFactory', new _services_cell_render_factory__WEBPACK_IMPORTED_MODULE_17__.CellRendererFactory);\n        this.serviceLocator.register('rendererFactory', new _services_renderer_factory__WEBPACK_IMPORTED_MODULE_18__.RendererFactory);\n        this.serviceLocator.register('localization', this.localeObj = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.L10n(this.getModuleName(), this.defaultLocale, this.locale));\n        this.serviceLocator.register('valueFormatter', this.valueFormatterService = new _services_value_formatter__WEBPACK_IMPORTED_MODULE_19__.ValueFormatter(this.locale));\n        this.serviceLocator.register('showHideService', this.showHider = new _actions_show_hide__WEBPACK_IMPORTED_MODULE_20__.ShowHide(this));\n        this.serviceLocator.register('ariaService', this.ariaService = new _services_aria_service__WEBPACK_IMPORTED_MODULE_21__.AriaService());\n        this.serviceLocator.register('focus', this.focusModule = new _services_focus_strategy__WEBPACK_IMPORTED_MODULE_22__.FocusStrategy(this));\n    };\n    Grid.prototype.processModel = function () {\n        var gCols = this.groupSettings.columns;\n        var sCols = this.sortSettings.columns;\n        var flag;\n        var j;\n        if (this.allowGrouping) {\n            var _loop_3 = function (i, len) {\n                flag = false;\n                j = 0;\n                for (var sLen = sCols.length; j < sLen; j++) {\n                    if (sCols[parseInt(j.toString(), 10)].field === gCols[parseInt(i.toString(), 10)]) {\n                        flag = true;\n                        break;\n                    }\n                }\n                if (!flag) {\n                    sCols.push({ field: gCols[parseInt(i.toString(), 10)], direction: 'Ascending', isFromGroup: true });\n                }\n                else {\n                    if (this_3.allowSorting) {\n                        this_3.sortedColumns.push(sCols[parseInt(j.toString(), 10)].field);\n                    }\n                    else {\n                        sCols[parseInt(j.toString(), 10)].direction = 'Ascending';\n                    }\n                }\n                if (!this_3.groupSettings.showGroupedColumn) {\n                    var column = this_3.enableColumnVirtualization ?\n                        this_3.columns.filter(function (c) { return c.field === gCols[parseInt(i.toString(), 10)]; })[0]\n                        : this_3.getColumnByField(gCols[parseInt(i.toString(), 10)]);\n                    if (column) {\n                        column.visible = false;\n                    }\n                    else {\n                        this_3.log('initial_action', { moduleName: 'group', columnName: gCols[parseInt(i.toString(), 10)] });\n                    }\n                }\n            };\n            var this_3 = this;\n            for (var i = 0, len = gCols.length; i < len; i++) {\n                _loop_3(i, len);\n            }\n        }\n        if (!gCols.length) {\n            for (var i = 0; i < sCols.length; i++) {\n                this.sortedColumns.push(sCols[parseInt(i.toString(), 10)].field);\n            }\n        }\n        this.rowTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.rowTemplate);\n        this.emptyRecordTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.emptyRecordTemplate);\n        this.detailTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.detailTemplate);\n        this.editTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.editSettings.template);\n        this.editHeaderTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.editSettings.headerTemplate);\n        this.editFooterTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.editSettings.footerTemplate);\n        this.columnChooserTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.columnChooserSettings.template);\n        this.columnChooserHeaderTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.columnChooserSettings.headerTemplate);\n        this.columnChooserFooterTemplateFn = (0,_util__WEBPACK_IMPORTED_MODULE_9__.templateCompiler)(this.columnChooserSettings.footerTemplate);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parentDetails)) {\n            var value = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parentDetails.parentKeyFieldValue) ? 'undefined' :\n                this.parentDetails.parentKeyFieldValue;\n            this.query.where(this.queryString, 'equal', value, true);\n        }\n        this.initForeignColumn();\n    };\n    Grid.prototype.initForeignColumn = function () {\n        if (this.isForeignKeyEnabled(this.getColumns())) {\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.initForeignKeyColumn, this.getForeignKeyColumns());\n        }\n    };\n    Grid.prototype.enableVerticalRendering = function () {\n        if (this.rowRenderingMode === 'Vertical') {\n            this.element.classList.add('e-row-responsive');\n        }\n        else {\n            this.element.classList.remove('e-row-responsive');\n        }\n    };\n    Grid.prototype.gridRender = function () {\n        var _a;\n        this.updateRTL();\n        if (this.rowRenderingMode === 'Vertical') {\n            this.element.classList.add('e-row-responsive');\n        }\n        if (this.enableHover) {\n            this.element.classList.add('e-gridhover');\n        }\n        if (/^((?!chrome|android).)*safari/i.test(navigator.userAgent) || _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isSafari()) {\n            this.element.classList.add('e-mac-safari');\n        }\n        if (_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice) {\n            this.element.classList.add('e-device');\n            if (this.adaptiveUIMode === 'Desktop') {\n                this.enableAdaptiveUI = false;\n            }\n        }\n        if (this.adaptiveUIMode === 'Mobile' && !(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice || this.rowRenderingMode === 'Vertical')) {\n            this.enableAdaptiveUI = false;\n        }\n        if (this.rowHeight) {\n            this.element.classList.add('e-grid-min-height');\n        }\n        if (this.cssClass) {\n            if (this.cssClass.indexOf(' ') !== -1) {\n                (_a = this.element.classList).add.apply(_a, this.cssClass.split(' '));\n            }\n            else {\n                this.element.classList.add(this.cssClass);\n            }\n        }\n        // If the below if statement is removed, then drag and drop between grids will not work in firefox browser.\n        if (this.allowRowDragAndDrop && this.rowDropSettings.targetID && _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.info.name === 'mozilla') {\n            this.element.classList.add('e-disableuserselect');\n        }\n        if (this.editSettings.showAddNewRow && (this.enableVirtualization || this.enableInfiniteScrolling)) {\n            this.editSettings.newRowPosition = 'Top';\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.element, ['e-responsive', 'e-default'], []);\n        var rendererFactory = this.serviceLocator.getService('rendererFactory');\n        this.headerModule = rendererFactory.getRenderer(_enum__WEBPACK_IMPORTED_MODULE_23__.RenderType.Header);\n        this.contentModule = rendererFactory.getRenderer(_enum__WEBPACK_IMPORTED_MODULE_23__.RenderType.Content);\n        this.printModule = new _actions_print__WEBPACK_IMPORTED_MODULE_24__.Print(this, this.scrollModule);\n        this.clipboardModule = new _actions_clipboard__WEBPACK_IMPORTED_MODULE_25__.Clipboard(this, this.serviceLocator);\n        this.renderModule.render();\n        this.eventInitializer();\n        this.createGridPopUpElement();\n        this.widthService.setWidthToColumns();\n        this.updateGridLines();\n        this.applyTextWrap();\n        this.createTooltip(); //for clip mode ellipsis\n        this.enableBoxSelection();\n    };\n    Grid.prototype.dataReady = function () {\n        this.scrollModule.setWidth();\n        this.scrollModule.setHeight();\n        if (this.height !== 'auto') {\n            this.scrollModule.setPadding();\n        }\n    };\n    Grid.prototype.updateRTL = function () {\n        if (this.enableRtl) {\n            this.element.classList.add('e-rtl');\n        }\n        else {\n            this.element.classList.remove('e-rtl');\n        }\n    };\n    Grid.prototype.createGridPopUpElement = function () {\n        var popup = this.createElement('div', { className: 'e-gridpopup' });\n        popup.style.display = 'none';\n        var content = this.createElement('div', { className: _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.content, attrs: { tabIndex: '-1' } });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.append)([content, this.createElement('div', { className: 'e-uptail e-tail' })], popup);\n        content.appendChild(this.createElement('span'));\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.append)([content, this.createElement('div', { className: 'e-downtail e-tail' })], popup);\n        this.element.appendChild(popup);\n    };\n    Grid.prototype.updateGridLines = function () {\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.element, [], ['e-verticallines', 'e-horizontallines', 'e-hidelines', 'e-bothlines']);\n        switch (this.gridLines) {\n            case 'Horizontal':\n                this.element.classList.add('e-horizontallines');\n                break;\n            case 'Vertical':\n                this.element.classList.add('e-verticallines');\n                break;\n            case 'None':\n                this.element.classList.add('e-hidelines');\n                break;\n            case 'Both':\n                this.element.classList.add('e-bothlines');\n                break;\n        }\n        this.updateResizeLines();\n    };\n    Grid.prototype.updateResizeLines = function () {\n        if (this.allowResizing &&\n            !(this.gridLines === 'Vertical' || this.gridLines === 'Both')) {\n            this.element.classList.add('e-resize-lines');\n        }\n        else {\n            this.element.classList.remove('e-resize-lines');\n        }\n    };\n    /**\n     * The function is used to apply text wrap\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.applyTextWrap = function () {\n        if (this.allowTextWrap) {\n            var headerRows = [].slice.call(this.element.getElementsByClassName('e-columnheader'));\n            switch (this.textWrapSettings.wrapMode) {\n                case 'Header':\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(this.element, false);\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(this.getContent(), false);\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(headerRows, true);\n                    break;\n                case 'Content':\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(this.getContent(), true);\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(this.element, false);\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(headerRows, false);\n                    break;\n                default:\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(this.element, true);\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(this.getContent(), false);\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(headerRows, false);\n            }\n            if (this.textWrapSettings.wrapMode !== 'Content') {\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshHandlers, {});\n            }\n        }\n    };\n    /**\n     * The function is used to remove text wrap\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.removeTextWrap = function () {\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(this.element, false);\n        var headerRows = [].slice.call(this.element.getElementsByClassName('e-columnheader'));\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(headerRows, false);\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.wrap)(this.getContent(), false);\n        if (this.textWrapSettings.wrapMode !== 'Content') {\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshHandlers, {});\n        }\n    };\n    /**\n     * The function is used to add Tooltip to the grid cell that has ellipsiswithtooltip clip mode.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.createTooltip = function () {\n        this.toolTipObj = new _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_26__.Tooltip({\n            opensOn: 'custom',\n            content: '',\n            cssClass: this.cssClass ? this.cssClass : null\n        }, this.element);\n    };\n    /** @hidden\n     * @returns {void}\n     */\n    Grid.prototype.freezeRefresh = function () {\n        if (this.enableVirtualization || this.enableInfiniteScrolling) {\n            this.pageSettings.currentPage = 1;\n        }\n        this.componentRefresh();\n    };\n    Grid.prototype.getTooltipStatus = function (element) {\n        var headerTable = this.getHeaderTable();\n        var headerDivTag = this.enableAdaptiveUI && this.rowRenderingMode === 'Vertical' ? 'e-gridcontent' : 'e-gridheader';\n        var htable = this.createTable(headerTable, headerDivTag, 'header');\n        var ctable = this.createTable(headerTable, headerDivTag, 'content');\n        var table = element.classList.contains('e-headercell') ? htable : ctable;\n        var ele = element.classList.contains('e-headercell') ? 'th' : 'tr';\n        table.querySelector(ele).className = element.className;\n        var targetElement = table.querySelector(ele);\n        targetElement.innerHTML = '';\n        Array.from(element.childNodes).forEach(function (child) {\n            targetElement.appendChild(child.cloneNode(true));\n        });\n        var width = table.querySelector(ele).getBoundingClientRect().width;\n        document.body.removeChild(htable);\n        document.body.removeChild(ctable);\n        if ((width > element.getBoundingClientRect().width && !element.classList.contains('e-editedbatchcell')) ||\n            (this.enableAdaptiveUI && this.rowRenderingMode === 'Vertical' &&\n                width > (element.getBoundingClientRect().width * 0.55) - (this.height !== 'auto' ? 16 : 0))) {\n            // 0.55 - defines the width of adaptive content cell, 16 - defines the scrollbar width\n            return true;\n        }\n        return false;\n    };\n    Grid.prototype.mouseMoveHandler = function (e) {\n        if (this.isEllipsisTooltip()) {\n            var element = (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-ellipsistooltip');\n            if (e.type === 'mouseout' && (this.prevElement !== element || element !== (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.relatedTarget, 'e-ellipsistooltip'))) {\n                this.toolTipObj.close();\n                this.prevElement = null;\n            }\n            var tagName = e.target.tagName;\n            var elemNames = ['A', 'BUTTON', 'INPUT'];\n            if (element && e.type !== 'mouseout' && !(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice && elemNames.indexOf(tagName) !== -1)) {\n                if (this.getTooltipStatus(element)) {\n                    var col = this.getColumns()[parseInt(element.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.ariaColIndex), 10) - 1];\n                    var domSetter = col && col.disableHtmlEncode ? 'innerText' : 'innerHTML';\n                    var contentDiv = this.createElement('div');\n                    if (element.getElementsByClassName('e-headertext').length) {\n                        var innerElement = element.getElementsByClassName('e-headertext')[0];\n                        contentDiv[\"\" + domSetter] = this.sanitize(innerElement.innerText);\n                        this.toolTipObj.content = contentDiv;\n                    }\n                    else {\n                        contentDiv[\"\" + domSetter] = this.sanitize(element.innerText);\n                        this.toolTipObj.content = contentDiv;\n                    }\n                    if (this.enableHtmlSanitizer) {\n                        this.toolTipObj.enableHtmlSanitizer = true;\n                    }\n                    if (col && col.disableHtmlEncode) {\n                        this.toolTipObj.enableHtmlParse = false;\n                    }\n                    if (element !== this.prevElement) {\n                        this.toolTipObj['open'](element);\n                    }\n                    this.prevElement = element;\n                }\n            }\n        }\n    };\n    Grid.prototype.isEllipsisTooltip = function () {\n        var cols = this.getColumns();\n        if (this.clipMode === 'EllipsisWithTooltip') {\n            return true;\n        }\n        for (var i = 0; i < cols.length; i++) {\n            if (cols[parseInt(i.toString(), 10)].clipMode === 'EllipsisWithTooltip') {\n                return true;\n            }\n        }\n        return false;\n    };\n    Grid.prototype.scrollHandler = function () {\n        if (this.isEllipsisTooltip()) {\n            this.toolTipObj.close();\n        }\n    };\n    /**\n     * To create table for ellipsiswithtooltip\n     *\n     * @param {Element} table - Defines the table\n     * @param {string} tag - Defines the tag\n     * @param {string} type - Defines the type\n     * @returns {HTMLDivElement} Returns the HTML div ELement\n     * @hidden\n     */\n    Grid.prototype.createTable = function (table, tag, type) {\n        var myTableDiv = this.createElement('div');\n        myTableDiv.className = this.element.className;\n        myTableDiv.style.cssText = 'display: inline-block;visibility:hidden;position:absolute';\n        var mySubDiv = this.createElement('div');\n        mySubDiv.className = tag;\n        var myTable = this.createElement('table');\n        myTable.className = table.className;\n        myTable.style.cssText = 'table-layout: auto;width: auto';\n        var ele = (type === 'header') ? 'th' : 'td';\n        var myTr = this.createElement('tr', { attrs: { role: 'row' } });\n        var mytd = this.createElement(ele);\n        myTr.appendChild(mytd);\n        myTable.appendChild(myTr);\n        mySubDiv.appendChild(myTable);\n        myTableDiv.appendChild(mySubDiv);\n        document.body.appendChild(myTableDiv);\n        return myTableDiv;\n    };\n    Grid.prototype.onKeyPressed = function (e) {\n        if (e.action === 'tab' || e.action === 'shiftTab') {\n            this.toolTipObj.close();\n        }\n    };\n    /**\n     * Binding events to the element while component creation.\n     *\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.wireEvents = function () {\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'click', this.mouseClickHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'touchend', this.mouseClickHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'focusout', this.focusOutHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'dblclick', this.dblClickHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'keydown', this.keyPressHandler, this);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(window, 'resize', this.resetIndentWidth, this);\n        if (this.allowKeyboard) {\n            this.element.tabIndex = this.element.tabIndex === -1 ? 0 : this.element.tabIndex;\n        }\n        this.keyboardModule = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.KeyboardEvents(this.element, {\n            keyAction: this.keyActionHandler.bind(this),\n            keyConfigs: this.keyConfigs,\n            eventName: 'keydown'\n        });\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.getContent().firstElementChild, 'scroll', this.scrollHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'mouseover', this.mouseMoveHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'mouseout', this.mouseMoveHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.getContent(), 'touchstart', this.tapEvent, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(document.body, 'keydown', this.keyDownHandler, this);\n    };\n    /**\n     * Unbinding events from the element while component destroy.\n     *\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.unwireEvents = function () {\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'click', this.mouseClickHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'touchend', this.mouseClickHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'focusout', this.focusOutHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'dblclick', this.dblClickHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.getContent().firstElementChild, 'scroll', this.scrollHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'mouseover', this.mouseMoveHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'mouseout', this.mouseMoveHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'keydown', this.keyPressHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.getContent(), 'touchstart', this.tapEvent);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(document.body, 'keydown', this.keyDownHandler);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(window, 'resize', this.resetIndentWidth);\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.addListener = function () {\n        if (this.isDestroyed) {\n            return;\n        }\n        this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.dataReady, this.dataReady, this);\n        this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.contentReady, this.recalcIndentWidth, this);\n        this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.headerRefreshed, this.recalcIndentWidth, this);\n        this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshFrozenPosition, this.refreshFrozenPosition, this);\n        this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshSplitFrozenColumn, this.refreshSplitFrozenColumn, this);\n        this.dataBoundFunction = this.refreshMediaCol.bind(this);\n        this.addEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_8__.dataBound, this.dataBoundFunction);\n        this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.keyPressed, this.onKeyPressed, this);\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.removeListener = function () {\n        if (this.isDestroyed) {\n            return;\n        }\n        this.off(_base_constant__WEBPACK_IMPORTED_MODULE_8__.dataReady, this.dataReady);\n        this.off(_base_constant__WEBPACK_IMPORTED_MODULE_8__.contentReady, this.recalcIndentWidth);\n        this.off(_base_constant__WEBPACK_IMPORTED_MODULE_8__.headerRefreshed, this.recalcIndentWidth);\n        this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshFrozenPosition, this.refreshFrozenPosition, this);\n        this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshSplitFrozenColumn, this.refreshSplitFrozenColumn, this);\n        this.removeEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_8__.dataBound, this.dataBoundFunction);\n        this.off(_base_constant__WEBPACK_IMPORTED_MODULE_8__.keyPressed, this.onKeyPressed);\n    };\n    /**\n     * Get current visible data of grid.\n     *\n     * @returns {Object[]} Returns the current view records\n     *\n     * @isGenericType true\n     */\n    Grid.prototype.getCurrentViewRecords = function () {\n        if ((0,_util__WEBPACK_IMPORTED_MODULE_9__.isGroupAdaptive)(this)) {\n            return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.currentViewData.records) ?\n                this.currentViewData : this.currentViewData.records;\n        }\n        if (this.groupSettings.enableLazyLoading) {\n            return this.currentViewData;\n        }\n        return (this.allowGrouping && this.groupSettings.columns.length && this.currentViewData.length\n            && this.currentViewData.records) ? this.currentViewData.records\n            : this.currentViewData;\n    };\n    Grid.prototype.mouseClickHandler = function (e) {\n        if (this.isChildGrid(e) || ((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-gridpopup') && e.touches) ||\n            this.element.getElementsByClassName('e-cloneproperties').length || this.checkEdit(e)) {\n            return;\n        }\n        if (((!this.allowRowDragAndDrop && ((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.gridContent) ||\n            e.target.tagName === 'TD')) || ((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-headercell') &&\n            (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-headercell').querySelector('.e-checkselectall')) ||\n            (!(this.allowGrouping || this.allowReordering) && (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-gridheader'))) &&\n            e.touches) {\n            return;\n        }\n        if ((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-gridheader') && this.allowRowDragAndDrop &&\n            !((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-filterbarcell')) && (e.target &&\n            ['A', 'BUTTON', 'INPUT'].indexOf(e.target.tagName) === -1)) {\n            e.preventDefault();\n        }\n        var args = this.getRowInfo(e.target);\n        var cancel = 'cancel';\n        args[\"\" + cancel] = false;\n        var isDataRow = false;\n        var tr = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, 'tr');\n        if (tr && tr.getAttribute('data-uid')) {\n            var rowObj = this.getRowObjectFromUID(tr.getAttribute('data-uid'));\n            isDataRow = rowObj ? rowObj.isDataRow : false;\n        }\n        if (isDataRow) {\n            this.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_8__.recordClick, args);\n        }\n        this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.click, e);\n    };\n    Grid.prototype.checkEdit = function (e) {\n        var tr = (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.row);\n        var isEdit = this.editSettings.mode !== 'Batch' &&\n            this.isEdit && tr && (tr.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.editedRow) || (tr.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.addedRow)) &&\n            !this.editSettings.showAddNewRow);\n        return !(0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-unboundcelldiv') && (isEdit || ((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.rowCell) &&\n            (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.rowCell).classList.contains('e-editedbatchcell')));\n    };\n    Grid.prototype.dblClickHandler = function (e) {\n        var grid = (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-grid');\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(grid) || grid.id !== this.element.id || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-unboundcelldiv')) {\n            return;\n        }\n        var dataRow = false;\n        var tr = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, 'tr');\n        if (tr && tr.getAttribute('data-uid')) {\n            var rowObj = this.getRowObjectFromUID(tr.getAttribute('data-uid'));\n            dataRow = rowObj ? rowObj.isDataRow : false;\n        }\n        var args = this.getRowInfo(e.target);\n        args.target = e.target;\n        if (dataRow) {\n            this.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_8__.recordDoubleClick, args);\n        }\n        this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.dblclick, e);\n    };\n    Grid.prototype.focusOutHandler = function (e) {\n        if (this.isChildGrid(e)) {\n            return;\n        }\n        if (!(0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-grid')) {\n            this.element.querySelector('.e-gridpopup').style.display = 'None';\n        }\n        var filterClear = this.element.querySelector('.e-cancel:not(.e-hide)');\n        if (filterClear && !filterClear.parentElement.classList.contains('e-tbar-btn')) {\n            filterClear.classList.add('e-hide');\n        }\n        var relatedTarget = e.relatedTarget;\n        var ariaOwns = relatedTarget ? relatedTarget.getAttribute('aria-owns') : null;\n        if ((!relatedTarget || (!(0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(relatedTarget, 'e-grid') &&\n            (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(ariaOwns) &&\n                (ariaOwns)) !== e.target.getAttribute('aria-owns')))\n            && !this.keyPress && this.isEdit && !_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice) {\n            if (this.editSettings.mode === 'Batch' && !((((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(relatedTarget, 'e-ddl') || (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(relatedTarget, 'e-ddt')) &&\n                ((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(relatedTarget, 'e-multi-select-list-wrapper') || (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(relatedTarget, 'e-input-filter'))) &&\n                (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(relatedTarget, 'e-input-group')) && ((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(relatedTarget, 'e-uploader') || (!(relatedTarget &&\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(relatedTarget, 'e-input-group'))) && !(0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'edit-custom-template')))) {\n                this.editModule.saveCell();\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.editNextValCell, {});\n            }\n            if (this.editSettings.mode === 'Normal' && !this.isWidgetsDestroyed) {\n                this.editModule.editFormValidate();\n            }\n        }\n        if (this.editSettings.showAddNewRow) {\n            this.editModule.isShowAddedRowValidate = false;\n        }\n        this.keyPress = false;\n    };\n    Grid.prototype.isChildGrid = function (e) {\n        var gridElement = (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-grid');\n        if ((gridElement && gridElement.id !== this.element.id) || ((0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-unboundcelldiv') &&\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gridElement))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @param {Object} persistedData - Defines the persisted data\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.mergePersistGridData = function (persistedData) {\n        var data = this.getLocalData();\n        if (!((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(data) || (data === '')) || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(persistedData)) {\n            var dataObj = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(persistedData) ? persistedData : JSON.parse(data);\n            var keys = Object.keys(dataObj);\n            this.isProtectedOnChange = true;\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n                var key = keys_1[_i];\n                if ((typeof this[\"\" + key] === 'object') && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this[\"\" + key])) {\n                    if (Array.isArray(this[\"\" + key]) && key === 'columns') {\n                        this.setFrozenCount();\n                        (0,_util__WEBPACK_IMPORTED_MODULE_9__.setColumnIndex)(this[\"\" + key]);\n                        this.mergeColumns(dataObj[\"\" + key], this[\"\" + key]);\n                        this.mergedColumns = true;\n                        this[\"\" + key] = dataObj[\"\" + key];\n                    }\n                    else {\n                        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(this[\"\" + key], dataObj[\"\" + key]);\n                    }\n                }\n                else {\n                    this[\"\" + key] = dataObj[\"\" + key];\n                }\n            }\n            this.isProtectedOnChange = false;\n        }\n    };\n    Grid.prototype.mergeColumns = function (storedColumn, columns) {\n        var storedColumns = storedColumn;\n        var isFrozenGrid = this.isFrozenGrid();\n        var _loop_4 = function (i) {\n            var localCol = columns.filter(function (tCol) { return isFrozenGrid ?\n                tCol.index === storedColumns[parseInt(i.toString(), 10)][\"\" + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.initialFrozenColumnIndex] :\n                tCol.index === storedColumns[parseInt(i.toString(), 10)].index; })[0];\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(localCol)) {\n                if (isFrozenGrid) {\n                    localCol = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, localCol, {}, true);\n                    localCol.freeze = storedColumns[parseInt(i.toString(), 10)].freeze;\n                }\n                if (localCol.columns && localCol.columns.length) {\n                    this_4.mergeColumns(storedColumns[parseInt(i.toString(), 10)].columns, localCol.columns);\n                    storedColumns[parseInt(i.toString(), 10)] = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(localCol, storedColumns[parseInt(i.toString(), 10)], {}, true);\n                }\n                else {\n                    storedColumns[parseInt(i.toString(), 10)] = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(localCol, storedColumns[parseInt(i.toString(), 10)], {}, true);\n                }\n            }\n        };\n        var this_4 = this;\n        for (var i = 0; i < storedColumns.length; i++) {\n            _loop_4(i);\n        }\n    };\n    /**\n     * @hidden\n     * @returns {boolean} Returns the isDetail\n     */\n    Grid.prototype.isDetail = function () {\n        return !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.detailTemplate) || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.childGrid);\n    };\n    Grid.prototype.isCommandColumn = function (columns) {\n        var _this_1 = this;\n        return columns.some(function (col) {\n            if (col.columns) {\n                return _this_1.isCommandColumn(col.columns);\n            }\n            return !!(col.commands || col.commandsTemplate);\n        });\n    };\n    Grid.prototype.isForeignKeyEnabled = function (columns) {\n        var _this_1 = this;\n        return columns.some(function (col) {\n            if (col.columns) {\n                return _this_1.isForeignKeyEnabled(col.columns);\n            }\n            return !!(col.dataSource && col.foreignKeyValue);\n        });\n    };\n    Grid.prototype.keyPressHandler = function (e) {\n        var presskey = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(e, { cancel: false });\n        this.trigger('keyPressed', presskey);\n        if (presskey.cancel === true || (this.isEdit && e && (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-gridform') &&\n            (0,_util__WEBPACK_IMPORTED_MODULE_9__.parentsUntil)(e.target, 'e-ddl') && e.action === 'open' && e.altKey === true && e.code === 'ArrowDown')) {\n            e.stopImmediatePropagation();\n        }\n    };\n    Grid.prototype.keyDownHandler = function (e) {\n        if (e.altKey) {\n            if (e.keyCode === 74) { //alt j\n                if (this.keyA) { //alt A J\n                    this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.groupCollapse, { target: e.target, collapse: false });\n                    this.keyA = false;\n                }\n                else {\n                    if (this.focusModule && this.focusModule.currentInfo && this.focusModule.currentInfo.element) {\n                        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([this.focusModule.currentInfo.element, this.focusModule.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n                        this.focusModule.currentInfo.element.tabIndex = -1;\n                    }\n                    if (!this.element.classList.contains('e-childgrid')) {\n                        this.element.focus();\n                    }\n                }\n            }\n            if (e.keyCode === 87) { //alt w\n                var focusModule = this.focusModule;\n                if (focusModule) {\n                    if (!this.currentViewData.length) {\n                        return;\n                    }\n                    focusModule.focusContent();\n                    focusModule.addOutline();\n                }\n            }\n            if (e.keyCode === 65) { //alt A\n                this.keyA = true;\n            }\n            if (e.keyCode === 72 && this.keyA) { //alt A H\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.groupCollapse, { target: e.target, collapse: true });\n                this.keyA = false;\n            }\n        }\n        if (e.keyCode === 13) {\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.enterKeyHandler, e);\n        }\n    };\n    Grid.prototype.keyActionHandler = function (e) {\n        if (this.isChildGrid(e) ||\n            (this.editModule && ((this.editModule.alertDObj && this.editModule.alertDObj.visible) ||\n                (this.editModule.dialogObj && this.editModule.dialogObj.visible))) ||\n            ((this.isEdit && (!this.editSettings.showAddNewRow || (this.editSettings.showAddNewRow &&\n                this.element.querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.editedRow)))) && e.action !== 'escape' && e.action !== 'enter'\n                && e.action !== 'shiftEnter' && e.action !== 'tab' && e.action !== 'shiftTab')) {\n            return;\n        }\n        else {\n            this.keyPress = true;\n        }\n        if (this.allowKeyboard) {\n            if (e.action === 'ctrlPlusP') {\n                e.preventDefault();\n                this.print();\n            }\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.keyPressed, e);\n        }\n    };\n    /**\n     * @param {Function[]} modules - Defines the modules\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.setInjectedModules = function (modules) {\n        this.injectedModules = modules;\n    };\n    Grid.prototype.updateColumnObject = function () {\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.prepareColumns)(this.columns, this.enableColumnVirtualization, this);\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.setColumnIndex)(this.columns);\n        this.initForeignColumn();\n        this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.autoCol, {});\n    };\n    Grid.prototype.refreshFrozenPosition = function (obj) {\n        if (obj && obj.isModeChg) {\n            this.refreshColumns();\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.refreshResizePosition, {});\n        }\n        else {\n            this.refreshColumns();\n        }\n    };\n    /**\n     * Gets the foreign columns from Grid.\n     *\n     * @returns {Column[]} Returns Foreign key column\n     */\n    Grid.prototype.getForeignKeyColumns = function () {\n        return this.getColumns().filter(function (col) {\n            return col.isForeignColumn();\n        });\n    };\n    /**\n     * @hidden\n     * @param {boolean} accurateHeight - Defines the accurate row height\n     * @returns {number} Returns row height\n     */\n    Grid.prototype.getRowHeight = function (accurateHeight) {\n        return this.rowHeight ? this.rowHeight : (0,_util__WEBPACK_IMPORTED_MODULE_9__.getRowHeight)(this.element, accurateHeight);\n    };\n    /**\n     * Refreshes the Grid column changes.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.refreshColumns = function () {\n        this.freezeColumnRefresh = true;\n        this.setFrozenCount();\n        this.updateFrozenColumnsWidth();\n        if (this.isFrozenGrid()) {\n            this.isPreventScrollEvent = true;\n        }\n        this.updateColumnObject();\n        this.checkLockColumns(this.getColumns());\n        this.refresh();\n        if (this.isFrozenGrid() && this.enableColumnVirtualization) {\n            var left = this.getContent().querySelector('.e-movablescrollbar').scrollLeft;\n            this.getHeaderContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.headerContent).scrollLeft = left;\n            this.getContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.content).scrollLeft = left;\n        }\n    };\n    /**\n     * Export Grid data to Excel file(.xlsx).\n     *\n     * @param  {ExcelExportProperties} excelExportProperties - Defines the export properties of the Grid.\n     * @param  {boolean} isMultipleExport - Define to enable multiple export.\n     * @param  {Workbook} workbook - Defines the Workbook if multiple export is enabled.\n     * @param  {boolean} isBlob - If 'isBlob' set to true, then it will be returned as blob data.\n     * @returns {Promise<any>} Returns the excelexport\n     */\n    Grid.prototype.excelExport = function (excelExportProperties, isMultipleExport, \n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    workbook, isBlob) {\n        if (this.exportGrids && this.exportGrids.length) {\n            var gridIds = this.exportGrids.slice();\n            return this.exportMultipleExcelGrids(gridIds, excelExportProperties, isMultipleExport, workbook, isBlob);\n        }\n        else {\n            return this.excelExportModule ?\n                this.excelExportModule.Map(this, excelExportProperties, isMultipleExport, workbook, false, isBlob) : null;\n        }\n    };\n    /**\n     * Export Grid data to CSV file.\n     *\n     * @param  {ExcelExportProperties} excelExportProperties - Defines the export properties of the Grid.\n     * @param  {boolean} isMultipleExport - Define to enable multiple export.\n     * @param  {Workbook} workbook - Defines the Workbook if multiple export is enabled.\n     * @param  {boolean} isBlob - If 'isBlob' set to true, then it will be returned as blob data.\n     * @returns {Promise<any>} Returns csv export\n     */\n    Grid.prototype.csvExport = function (excelExportProperties, \n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    isMultipleExport, workbook, isBlob) {\n        return this.excelExportModule ?\n            this.excelExportModule.Map(this, excelExportProperties, isMultipleExport, workbook, true, isBlob) : null;\n    };\n    /**\n     * Export Grid data to PDF document.\n     *\n     * @param {pdfExportProperties} pdfExportProperties - Defines the export properties of the Grid.\n     * @param {isMultipleExport} isMultipleExport - Define to enable multiple export.\n     * @param {pdfDoc} pdfDoc - Defined the Pdf Document if multiple export is enabled.\n     * @param {boolean} isBlob - If 'isBlob' set to true, then it will be returned as blob data.\n     *\n     * @returns {Promise<any>} Returns pdfexport\n     */\n    Grid.prototype.pdfExport = function (pdfExportProperties, isMultipleExport, pdfDoc, isBlob) {\n        if (this.exportGrids && this.exportGrids.length) {\n            var gridIds = this.exportGrids.slice();\n            return this.exportMultiplePdfGrids(gridIds, pdfExportProperties, isMultipleExport, pdfDoc, isBlob);\n        }\n        else {\n            return this.pdfExportModule ? this.pdfExportModule.Map(this, pdfExportProperties, isMultipleExport, pdfDoc, isBlob) : null;\n        }\n    };\n    Grid.prototype.exportMultiplePdfGrids = function (gridIds, pdfExportProperties, isMultipleExport, \n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    pdfDoc, isBlob) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var _this = this;\n        if (gridIds.length !== 0) {\n            var currentGridId = gridIds.shift();\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var currentGridInstance = document.getElementById(currentGridId).ej2_instances[0];\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var exportPromise = currentGridInstance.pdfExportModule ?\n                currentGridInstance.pdfExportModule.Map(currentGridInstance, pdfExportProperties, isMultipleExport, pdfDoc, isBlob)\n                : Promise.resolve();\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return exportPromise.then(function (exportedGridResults) {\n                isMultipleExport = gridIds.length === 1 ? false : true;\n                return _this.exportMultiplePdfGrids(gridIds, pdfExportProperties, isMultipleExport, exportedGridResults, isBlob);\n            });\n        }\n        return null;\n    };\n    Grid.prototype.exportMultipleExcelGrids = function (gridIds, excelExportProperties, isMultipleExport, \n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    workbook, isBlob) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var _this = this;\n        if (gridIds.length !== 0) {\n            var currentGridId = gridIds.shift();\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var currentGridInstance = document.getElementById(currentGridId).ej2_instances[0];\n            var exportPromise = currentGridInstance.excelExportModule ?\n                currentGridInstance.excelExportModule.Map(currentGridInstance, excelExportProperties, isMultipleExport, workbook, false, isBlob) : null;\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return exportPromise.then(function (exportedGridResults) {\n                isMultipleExport = gridIds.length === 1 ? false : true;\n                return _this.exportMultipleExcelGrids(gridIds, excelExportProperties, isMultipleExport, exportedGridResults, isBlob);\n            });\n        }\n        return null;\n    };\n    /**\n     * Groups a column by column name.\n     *\n     * @param  {string} columnName - Defines the column name to group.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.groupColumn = function (columnName) {\n        if (this.groupModule) {\n            this.groupModule.groupColumn(columnName);\n        }\n    };\n    /**\n     * Expands all the grouped rows of the Grid.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.groupExpandAll = function () {\n        if (this.groupModule) {\n            this.groupModule.expandAll();\n        }\n    };\n    /**\n     * Collapses all the grouped rows of the Grid.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.groupCollapseAll = function () {\n        if (this.groupModule) {\n            this.groupModule.collapseAll();\n        }\n    };\n    /**\n     * Expands or collapses grouped rows by target element.\n     *\n     * @param  {Element} target - Defines the target element of the grouped row.\n     * @returns {void}\n     */\n    // public expandCollapseRows(target: Element): void {\n    //     if (this.groupModule) {\n    //         this.groupModule.expandCollapseRows(target);\n    //     }\n    // }\n    /**\n     * Clears all the grouped columns of the Grid.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.clearGrouping = function () {\n        if (this.groupModule) {\n            this.groupModule.clearGrouping();\n        }\n    };\n    /**\n     * Ungroups a column by column name.\n     *\n     * {% codeBlock src='grid/ungroupColumn/index.md' %}{% endcodeBlock %}\n     *\n     * @param  {string} columnName - Defines the column name to ungroup.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.ungroupColumn = function (columnName) {\n        if (this.groupModule) {\n            this.groupModule.ungroupColumn(columnName);\n        }\n    };\n    /**\n     * Column chooser can be displayed on screen by given position(X and Y axis).\n     *\n     * @param {number} x - Defines the X axis.\n     * @param {number} y - Defines the Y axis.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.openColumnChooser = function (x, y) {\n        if (this.columnChooserModule) {\n            this.columnChooserModule.openColumnChooser(x, y);\n        }\n    };\n    Grid.prototype.scrollRefresh = function () {\n        var _this_1 = this;\n        var refresh = function () {\n            _this_1.scrollModule.refresh();\n            _this_1.off(_base_constant__WEBPACK_IMPORTED_MODULE_8__.contentReady, refresh);\n        };\n        this.on(_base_constant__WEBPACK_IMPORTED_MODULE_8__.contentReady, refresh, this);\n    };\n    /**\n     * Collapses a detail row with the given target.\n     *\n     * @param  {Element} target - Defines the expanded element to collapse.\n     * @returns {void}\n     */\n    // public detailCollapse(target: number | Element): void {\n    //     if (this.detailRowModule) {\n    //         this.detailRowModule.collapse(target);\n    //     }\n    // }\n    /**\n     * Collapses all the detail rows of the Grid.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.detailCollapseAll = function () {\n        if (this.detailRowModule) {\n            this.detailRowModule.collapseAll();\n        }\n    };\n    /**\n     * Expands a detail row with the given target.\n     *\n     * @param  {Element} target - Defines the collapsed element to expand.\n     * @returns {void}\n     */\n    // public detailExpand(target: number | Element): void {\n    //     if (this.detailRowModule) {\n    //         this.detailRowModule.expand(target);\n    //     }\n    // }\n    /**\n     * Expands all the detail rows of the Grid.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.detailExpandAll = function () {\n        if (this.detailRowModule) {\n            this.detailRowModule.expandAll();\n        }\n    };\n    /**\n     * Deselects the currently selected cells.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.clearCellSelection = function () {\n        if (this.selectionModule) {\n            this.selectionModule.clearCellSelection();\n        }\n    };\n    /**\n     * Deselects the currently selected rows.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.clearRowSelection = function () {\n        if (this.selectionModule) {\n            this.selectionModule.clearRowSelection();\n        }\n    };\n    /**\n     * Selects a collection of cells by row and column indexes.\n     *\n     * @param  {ISelectedCell[]} rowCellIndexes - Specifies the row and column indexes.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.selectCells = function (rowCellIndexes) {\n        if (this.selectionModule) {\n            this.selectionModule.selectCells(rowCellIndexes);\n        }\n    };\n    /**\n     * Selects a range of rows from start and end row indexes.\n     *\n     * @param  {number} startIndex - Specifies the start row index.\n     * @param  {number} endIndex - Specifies the end row index.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.selectRowsByRange = function (startIndex, endIndex) {\n        if (this.selectionModule) {\n            this.selectionModule.selectRowsByRange(startIndex, endIndex);\n        }\n    };\n    /**\n     * @hidden\n     * @returns {boolean} Returns whether context menu is open or not\n     */\n    Grid.prototype.isContextMenuOpen = function () {\n        return this.contextMenuModule && this.contextMenuModule.isOpen;\n    };\n    /**\n     * @param {Function} module - Defines the module\n     * @returns {boolean} return the injected modules\n     * @hidden\n     */\n    Grid.prototype.ensureModuleInjected = function (module) {\n        return this.getInjectedModules().indexOf(module) >= 0;\n    };\n    /**\n     * Destroys the given template reference.\n     *\n     * @param {string[]} propertyNames - Defines the collection of template name.\n     * @param {any} index - specifies the index\n     *\n     * @returns {void}\n     */\n    // eslint-disable-next-line\n    Grid.prototype.destroyTemplate = function (propertyNames, index) {\n        this.clearTemplate(propertyNames, index);\n    };\n    /**\n     * @param {string | string[]} type - Defines the type\n     * @param {Object} args - Defines the arguments\n     * @returns {void}\n     * @hidden\n     * @private\n     */\n    Grid.prototype.log = function (type, args) {\n        var injectedModules = this.getInjectedModules();\n        var logger = injectedModules.find(function (item) { return item.name === 'Logger'; });\n        if (!logger) {\n            Grid_1.Inject(_actions_logger__WEBPACK_IMPORTED_MODULE_27__.Logger);\n            this.enableLogger = true;\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.injectModules();\n        }\n        // eslint-disable-next-line\n        this.loggerModule ? this.loggerModule.log(type, args) : (function () { return 0; })();\n    };\n    /**\n     * @param {Element} element - Defines the element\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.applyBiggerTheme = function (element) {\n        if (this.element.classList.contains('e-bigger')) {\n            element.classList.add('e-bigger');\n        }\n    };\n    /**\n     * @hidden\n     * @returns {Object} Returns the previous row data\n     */\n    Grid.prototype.getPreviousRowData = function () {\n        var previousRowData = this.getRowsObject()[this.getRows().length - 1].data;\n        return previousRowData;\n    };\n    /**\n     * Hides the scrollbar placeholder of Grid content when grid content is not overflown.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.hideScroll = function () {\n        var content = this.getContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.content);\n        if (content.scrollHeight <= content.clientHeight) {\n            this.scrollModule.removePadding();\n            content.style.overflowY = 'auto';\n        }\n    };\n    /**\n     * Get row index by primary key or row data.\n     *\n     * @param  {string | Object} value - Defines the primary key value.\n     *\n     * @returns {number} Returns the index\n     */\n    Grid.prototype.getRowIndexByPrimaryKey = function (value) {\n        var pkName = this.getPrimaryKeyFieldNames()[0];\n        value = typeof value === 'object' ? value[\"\" + pkName] : value;\n        var rows = this.getRowsObject();\n        for (var i = 0; i < rows.length; i++) {\n            if (rows[parseInt(i.toString(), 10)].isDetailRow || rows[parseInt(i.toString(), 10)].isCaptionRow) {\n                continue;\n            }\n            var pKvalue = rows[parseInt(i.toString(), 10)].data[\"\" + pkName];\n            if (pkName.split('.').length > 1) {\n                pKvalue = (0,_util__WEBPACK_IMPORTED_MODULE_9__.performComplexDataOperation)(pkName, rows[parseInt(i.toString(), 10)].data);\n            }\n            if (pKvalue === value) {\n                return rows[parseInt(i.toString(), 10)].index;\n            }\n        }\n        return -1;\n    };\n    /**\n     * @param {string} field - Defines the field name\n     * @param {boolean} isForeignKey - Defines the foreign key\n     * @returns {Column} returns the column\n     * @hidden\n     */\n    // Need to have all columns while filtering with ColumnVirtualization.\n    Grid.prototype.grabColumnByFieldFromAllCols = function (field, isForeignKey) {\n        var column;\n        this.columnModel = [];\n        this.updateColumnModel(this.columns);\n        var gCols = this.columnModel;\n        for (var i = 0; i < gCols.length; i++) {\n            if ((!isForeignKey && field === gCols[parseInt(i.toString(), 10)].field) ||\n                (isForeignKey && gCols[parseInt(i.toString(), 10)].isForeignColumn() &&\n                    field === gCols[parseInt(i.toString(), 10)].foreignKeyValue)) {\n                column = gCols[parseInt(i.toString(), 10)];\n                break;\n            }\n        }\n        return column;\n    };\n    /**\n     * @param {string} uid - Defines the uid\n     * @returns {Column} returns the column\n     * @hidden\n     */\n    // Need to have all columns while filtering with ColumnVirtualization.\n    Grid.prototype.grabColumnByUidFromAllCols = function (uid) {\n        var column;\n        this.columnModel = [];\n        this.updateColumnModel(this.columns);\n        var gCols = this.columnModel;\n        for (var i = 0; i < gCols.length; i++) {\n            if (uid === gCols[parseInt(i.toString(), 10)].uid) {\n                column = gCols[parseInt(i.toString(), 10)];\n            }\n        }\n        return column;\n    };\n    /**\n     * Get all filtered records from the Grid and it returns array of objects for the local dataSource, returns a promise object if the Grid has remote data.\n     *\n     * @returns {Object[] | Promise<Object>} Returns the filtered records\n     */\n    Grid.prototype.getFilteredRecords = function () {\n        if ((this.allowFiltering && this.filterSettings.columns.length) || this.searchSettings.key.length) {\n            var query = this.renderModule.data.generateQuery(true);\n            if (this.dataSource && this.renderModule.data.isRemote() && this.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_11__.DataManager) {\n                return this.renderModule.data.getData(this.dataSource, query);\n            }\n            else {\n                if (this.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_11__.DataManager) {\n                    return this.dataSource.executeLocal(query);\n                }\n                else {\n                    return new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_11__.DataManager(this.dataSource, query).executeLocal(query);\n                }\n            }\n        }\n        return [];\n    };\n    Grid.prototype.getUserAgent = function () {\n        var userAgent = _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.userAgent.toLowerCase();\n        return /iphone|ipod|ipad|macintosh/.test(userAgent);\n    };\n    /**\n     * @param {TouchEventArgs} e - Defines the TouchEventArgs\n     * @returns {void}\n     * @hidden\n     */\n    // Need to have all columns while filtering with ColumnVirtualization.\n    // eslint-disable-next-line\n    Grid.prototype.tapEvent = function (e) {\n        if (this.getUserAgent()) {\n            if (!_util__WEBPACK_IMPORTED_MODULE_9__.Global.timer) {\n                _util__WEBPACK_IMPORTED_MODULE_9__.Global.timer = setTimeout(function () {\n                    _util__WEBPACK_IMPORTED_MODULE_9__.Global.timer = null;\n                }, 300);\n            }\n            else {\n                clearTimeout(_util__WEBPACK_IMPORTED_MODULE_9__.Global.timer);\n                _util__WEBPACK_IMPORTED_MODULE_9__.Global.timer = null;\n                this.dblClickHandler(e);\n                this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.doubleTap, e);\n            }\n        }\n    };\n    /**\n     * @param {string} prefix - specifies the prefix\n     * @returns {string} returns the row uid\n     * @hidden\n     */\n    Grid.prototype.getRowUid = function (prefix) {\n        return \"\" + prefix + this.rowUid++;\n    };\n    /**\n     * @param {string} uid - specifies the uid\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    Grid.prototype.getRowElementByUID = function (uid) {\n        var rowEle;\n        var rows = [];\n        var cntRows = [].slice.call(this.getContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody).children);\n        if (this.frozenRows) {\n            rows = [].slice.call(this.getHeaderContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody).children);\n            rows = rows.concat(cntRows);\n        }\n        else {\n            rows = cntRows;\n        }\n        for (var _i = 0, rows_2 = rows; _i < rows_2.length; _i++) {\n            var row = rows_2[_i];\n            if (row.getAttribute('data-uid') === uid) {\n                rowEle = row;\n                break;\n            }\n        }\n        return rowEle;\n    };\n    /**\n     * Gets the hidden columns from the Grid.\n     *\n     * @returns {Column[]} Returns the Column\n     */\n    Grid.prototype.getHiddenColumns = function () {\n        var cols = [];\n        for (var _i = 0, _a = this.columnModel; _i < _a.length; _i++) {\n            var col = _a[_i];\n            if (col.visible === false) {\n                cols.push(col);\n            }\n        }\n        return cols;\n    };\n    /**\n     * Calculates the page size by parent element height\n     *\n     * @param {number | string } containerHeight - specifies the container height\n     * @returns {number} returns the page size\n     */\n    Grid.prototype.calculatePageSizeByParentHeight = function (containerHeight) {\n        if (this.allowPaging) {\n            if ((this.allowTextWrap && this.textWrapSettings.wrapMode === 'Header') || (!this.allowTextWrap)) {\n                var pagesize = 0;\n                if (containerHeight.indexOf('%') !== -1) {\n                    containerHeight = parseInt(containerHeight, 10) / 100 * this.element.clientHeight;\n                }\n                var nonContentHeight = this.getNoncontentHeight() + this.getRowHeight();\n                if (containerHeight > nonContentHeight) {\n                    var contentHeight = 0;\n                    contentHeight = containerHeight - this.getNoncontentHeight();\n                    pagesize = (contentHeight / this.getRowHeight());\n                }\n                if (pagesize > 0) {\n                    return Math.floor(pagesize);\n                }\n            }\n        }\n        return 0;\n    };\n    Grid.prototype.getNoncontentHeight = function () {\n        var height = 0;\n        if (this.getHeaderContent() && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.getHeaderContent().clientHeight)) {\n            height += this.getHeaderContent().clientHeight;\n        }\n        if (this.toolbar && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.element.querySelector('.e-toolbar').clientHeight)) {\n            height += this.element.querySelector('.e-toolbar').clientHeight;\n        }\n        if (this.allowPaging && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.element.querySelector('.e-gridpager').clientHeight)) {\n            height += this.element.querySelector('.e-gridpager').clientHeight;\n        }\n        if (this.showColumnChooser && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.element.querySelector('.e-columnheader').clientHeight)) {\n            height += this.element.querySelector('.e-columnheader').clientHeight;\n        }\n        if (this.allowGrouping && this.groupSettings.showDropArea && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.element.querySelector('.e-groupdroparea').clientHeight)) {\n            height += this.element.querySelector('.e-groupdroparea').clientHeight;\n        }\n        if (this.aggregates.length > 0 && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.element.querySelector('.e-summaryrow').clientHeight)) {\n            for (var i = 0; i < this.element.getElementsByClassName('e-summaryrow').length; i++) {\n                height += this.element.getElementsByClassName('e-summaryrow')[parseInt(i.toString(), 10)].clientHeight;\n            }\n        }\n        return height;\n    };\n    /**\n     *To perform aggregate operation on a column.\n     *\n     * @param  {AggregateColumnModel} summaryCol - Pass Aggregate Column details.\n     * @param  {Object} summaryData - Pass JSON Array for which its field values to be calculated.\n     *\n     * @returns {number} returns the summary values\n     */\n    Grid.prototype.getSummaryValues = function (summaryCol, summaryData) {\n        return _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_12__.DataUtil.aggregates[summaryCol.type.toLowerCase()](summaryData, summaryCol.field);\n    };\n    /**\n     * Sends a Post request to export Grid to Excel file in server side.\n     *\n     * @param  {string} url - Pass Url for server side excel export action.\n     *\n     * @param  {ExportHeaders} headers - The headers to include in the export request.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.serverExcelExport = function (url, headers) {\n        this.isExcel = true;\n        this.exportGrid(url, headers);\n    };\n    /**\n     * Sends a Post request to export Grid to Pdf file in server side.\n     *\n     * @param  {string} url - Pass Url for server side pdf export action.\n     *\n     * @param  {ExportHeaders} headers - The headers to include in the export request.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.serverPdfExport = function (url, headers) {\n        this.isExcel = false;\n        this.exportGrid(url, headers);\n    };\n    /**\n     * Sends a Post request to export Grid to CSV file in server side.\n     *\n     * @param  {string} url - Pass Url for server side csv export action.\n     *\n     * @param  {ExportHeaders} headers - The headers to include in the export request.\n     *\n     * @returns {void}\n     */\n    Grid.prototype.serverCsvExport = function (url, headers) {\n        this.isExcel = true;\n        this.exportGrid(url, headers);\n    };\n    /**\n     * @param {string} url - Defines exporting url\n     * @param {ExportHeaders} headers - The optional headers for the export request.\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.exportGrid = function (url, headers) {\n        var _this_1 = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var grid = this;\n        var query = grid.getDataModule().generateQuery(true);\n        var state = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_28__.UrlAdaptor().processQuery(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_11__.DataManager({ url: '' }), query);\n        var queries = JSON.parse(state.data);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var gridModel = JSON.parse(this.addOnPersist(['allowGrouping', 'allowPaging', 'pageSettings', 'sortSettings', 'allowPdfExport', 'allowExcelExport', 'aggregates',\n            'filterSettings', 'groupSettings', 'columns', 'locale', 'searchSettings']));\n        var include = ['field', 'headerText', 'type', 'format', 'visible', 'foreignKeyValue', 'foreignKeyField',\n            'template', 'index', 'width', 'textAlign', 'headerTextAlign', 'columns'];\n        gridModel.filterSettings.columns = queries.where;\n        gridModel.searchSettings.fields = queries.search && queries.search[0]['fields'] || [];\n        gridModel.sortSettings.columns = queries.sorted;\n        gridModel.columns = this.setHeaderText(gridModel.columns, include);\n        var form = this.createElement('form', { id: 'ExportForm' });\n        form.style.display = 'none';\n        var gridInput = this.createElement('input', { id: 'gridInput', attrs: { name: 'gridModel' } });\n        gridInput.value = JSON.stringify(gridModel);\n        form.method = 'POST';\n        form.action = url;\n        form.appendChild(gridInput);\n        if (headers && headers.headers && Array.isArray(headers.headers)) {\n            headers.headers.forEach(function (header) {\n                Object.keys(header).forEach(function (key) {\n                    var value = typeof header[\"\" + key] === 'string' ? header[\"\" + key] : JSON.stringify(header[\"\" + key]);\n                    var headerInput = _this_1.createElement('input', { attrs: { name: key, value: value, type: 'hidden' } });\n                    form.appendChild(headerInput);\n                });\n            });\n        }\n        document.body.appendChild(form);\n        form.submit();\n        form.remove();\n    };\n    /**\n     * @param {Column[]} columns - Defines array of columns\n     * @param {string[]} include - Defines array of sting\n     * @returns {Column[]} returns array of columns\n     * @hidden\n     */\n    Grid.prototype.setHeaderText = function (columns, include) {\n        for (var i = 0; i < columns.length; i++) {\n            var column = this.getColumnByUid(columns[parseInt(i.toString(), 10)].uid);\n            columns[parseInt(i.toString(), 10)].headerText = column.headerText;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.template)) {\n                columns[parseInt(i.toString(), 10)].template = 'true';\n            }\n            if (columns[parseInt(i.toString(), 10)].format) {\n                columns[parseInt(i.toString(), 10)].format = (0,_util__WEBPACK_IMPORTED_MODULE_9__.getNumberFormat)(this.getFormat(columns[parseInt(i.toString(), 10)].format), columns[parseInt(i.toString(), 10)].type, false, _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.defaultCurrencyCode);\n                if (column.type === 'datetime' || column.type === 'date' || column.type === 'time') {\n                    columns[parseInt(i.toString(), 10)].format = columns[parseInt(i.toString(), 10)].format.toString().replace('AM/PM', 'tt');\n                }\n            }\n            if (columns[parseInt(i.toString(), 10)].columns) {\n                this.setHeaderText(columns[parseInt(i.toString(), 10)].columns, include);\n            }\n            var keys = Object.keys(columns[parseInt(i.toString(), 10)]);\n            for (var j = 0; j < keys.length; j++) {\n                if (include.indexOf(keys[parseInt(j.toString(), 10)]) < 0) {\n                    delete columns[parseInt(i.toString(), 10)][keys[parseInt(j.toString(), 10)]];\n                }\n            }\n        }\n        return columns;\n    };\n    Grid.prototype.getFormat = function (format) {\n        return typeof (format) === 'object' ? !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(format.format) ?\n            format.format : format.skeleton : format;\n    };\n    /**\n     * @hidden\n     * @returns {boolean} returns the isCollapseStateEnabled\n     */\n    Grid.prototype.isCollapseStateEnabled = function () {\n        var isExpanded = 'isExpanded';\n        return this[\"\" + isExpanded] === false;\n    };\n    /**\n     * @param {number} key - Defines the primary key value.\n     * @param {Object} rowData - Defines the rowData\n     * @returns {void}\n     */\n    Grid.prototype.updateRowValue = function (key, rowData) {\n        var args = {\n            requestType: 'save', data: rowData\n        };\n        this.showSpinner();\n        this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.updateData, args);\n        this.refresh();\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.setForeignKeyData = function () {\n        this.dataBind();\n        var colpending = this.getDataModule().getForeignKeyDataState();\n        if (colpending.isPending) {\n            this.getDataModule().setForeignKeyDataState({});\n            colpending.resolver();\n        }\n        else {\n            this.getDataModule().setForeignKeyDataState({ isDataChanged: false });\n            if (this.contentModule || this.headerModule) {\n                this.renderModule.render();\n            }\n        }\n    };\n    /**\n     * @param {string} field - specifies the field\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.resetFilterDlgPosition = function (field) {\n        var header = this.getColumnHeaderByField(field);\n        if (header) {\n            var target = header.querySelector('.e-filtermenudiv');\n            var filterDlg = this.element.querySelector('.e-filter-popup');\n            if (target) {\n                var gClient = this.element.getBoundingClientRect();\n                var fClient = target.getBoundingClientRect();\n                if (filterDlg) {\n                    if ((filterDlg.offsetWidth + fClient.right) > gClient.right) {\n                        filterDlg.style.left = ((fClient.right - filterDlg.offsetWidth) - gClient.left).toString() + 'px';\n                    }\n                    else {\n                        filterDlg.style.left = (fClient.right - gClient.left).toString() + 'px';\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @param {any} callBack - specifies the callBack method\n     * @returns {void}\n     * @hidden\n     */\n    // eslint-disable-next-line\n    Grid.prototype.renderTemplates = function (callBack) {\n        var isReactChild = this.parentDetails && this.parentDetails.parentInstObj && this.parentDetails.parentInstObj.isReact;\n        var isReactPrintGrid = this.printGridParent && this.printGridParent.isReact;\n        if ((isReactChild || isReactPrintGrid) && this['portals']) {\n            var parentInstObj = isReactPrintGrid ? this.printGridParent : this.parentDetails.parentInstObj;\n            parentInstObj['portals'] = parentInstObj['portals'].concat(this['portals']);\n            parentInstObj.renderTemplates(callBack);\n            this['portals'] = undefined;\n        }\n        else {\n            var portals = 'portals';\n            this.notify('reactTemplateRender', this[\"\" + portals]);\n            this.renderReactTemplates(callBack);\n        }\n    };\n    /**\n     * Apply the changes to the Grid without refreshing the rows.\n     *\n     * @param  {BatchChanges} changes - Defines changes to be updated.\n     * @returns {void}\n     */\n    Grid.prototype.batchUpdate = function (changes) {\n        this.processRowChanges(changes);\n    };\n    /**\n     * Apply the changes to the Grid in one batch after 50ms without refreshing the rows.\n     *\n     * @param  {BatchChanges} changes - Defines changes to be updated.\n     * @returns {void}\n     */\n    Grid.prototype.batchAsyncUpdate = function (changes) {\n        this.processBulkRowChanges(changes);\n    };\n    Grid.prototype.processBulkRowChanges = function (changes) {\n        var _this_1 = this;\n        if (!this.dataToBeUpdated) {\n            this.dataToBeUpdated = Object.assign({ addedRecords: [], changedRecords: [], deletedRecords: [] }, changes);\n            setTimeout(function () {\n                _this_1.processRowChanges(_this_1.dataToBeUpdated);\n                _this_1.dataToBeUpdated = null;\n            }, this.asyncTimeOut);\n        }\n        else {\n            var loopstring = [_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.addedRecords, _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.changedRecords, _base_string_literals__WEBPACK_IMPORTED_MODULE_10__.deletedRecords];\n            var keyField = this.getPrimaryKeyFieldNames()[0];\n            for (var i = 0; i < loopstring.length; i++) {\n                if (changes[loopstring[parseInt(i.toString(), 10)]]) {\n                    (0,_util__WEBPACK_IMPORTED_MODULE_9__.compareChanges)(this, changes, loopstring[parseInt(i.toString(), 10)], keyField);\n                }\n            }\n        }\n    };\n    Grid.prototype.processRowChanges = function (changes) {\n        var _this_1 = this;\n        var keyField = this.getPrimaryKeyFieldNames()[0];\n        changes = Object.assign({ addedRecords: [], changedRecords: [], deletedRecords: [] }, changes);\n        var promise = this.getDataModule().saveChanges(changes, keyField, {}, this.getDataModule().generateQuery().requiresCount());\n        if (this.getDataModule().isRemote()) {\n            promise.then(function () {\n                _this_1.setNewData();\n            });\n        }\n        else {\n            this.setNewData();\n        }\n    };\n    Grid.prototype.setNewData = function () {\n        var _this_1 = this;\n        var oldValues = JSON.parse(JSON.stringify(this.getCurrentViewRecords()));\n        var getData = this.getDataModule().getData({}, this.getDataModule().generateQuery().requiresCount());\n        getData.then(function (e) {\n            _this_1.bulkRefresh(e.result, oldValues, e.count);\n        });\n    };\n    Grid.prototype.deleteRowElement = function (row) {\n        var tr = this.getRowElementByUID(row.uid);\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(tr);\n    };\n    Grid.prototype.bulkRefresh = function (result, oldValues, count) {\n        var _this_1 = this;\n        var rowObj = this.getRowsObject();\n        var keyField = this.getPrimaryKeyFieldNames()[0];\n        var _loop_5 = function (i) {\n            if (!result.filter(function (e) { return e[\"\" + keyField] === rowObj[parseInt(i.toString(), 10)].data[\"\" + keyField]; }).length) {\n                this_5.deleteRowElement(rowObj[parseInt(i.toString(), 10)]);\n                rowObj.splice(i, 1);\n                i--;\n            }\n            out_i_1 = i;\n        };\n        var this_5 = this, out_i_1;\n        for (var i = 0; i < rowObj.length; i++) {\n            _loop_5(i);\n            i = out_i_1;\n        }\n        var _loop_6 = function (i) {\n            var isRowExist;\n            oldValues.filter(function (e) {\n                if (e[\"\" + keyField] === result[parseInt(i.toString(), 10)][\"\" + keyField]) {\n                    if (e !== result[parseInt(i.toString(), 10)]) {\n                        _this_1.setRowData(result[parseInt(i.toString(), 10)][\"\" + keyField], result[parseInt(i.toString(), 10)]);\n                    }\n                    isRowExist = true;\n                }\n            });\n            if (!isRowExist) {\n                this_6.renderRowElement(result[parseInt(i.toString(), 10)], i);\n            }\n        };\n        var this_6 = this;\n        for (var i = 0; i < result.length; i++) {\n            _loop_6(i);\n        }\n        this.currentViewData = result;\n        var rows = [].slice.call(this.getContentTable().getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.row));\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.resetRowIndex)(this, this.getRowsObject(), rows);\n        (0,_util__WEBPACK_IMPORTED_MODULE_9__.setRowElements)(this);\n        if (this.allowPaging) {\n            this.notify(_base_constant__WEBPACK_IMPORTED_MODULE_8__.inBoundModelChanged, { module: 'pager', properties: { totalRecordsCount: count } });\n        }\n    };\n    Grid.prototype.renderRowElement = function (data, index) {\n        var row = new _renderer_row_renderer__WEBPACK_IMPORTED_MODULE_15__.RowRenderer(this.serviceLocator, null, this);\n        var model = new _services_row_model_generator__WEBPACK_IMPORTED_MODULE_29__.RowModelGenerator(this);\n        var modelData = model.generateRows([data]);\n        var tr = row.render(modelData[0], this.getColumns());\n        this.addRowObject(modelData[0], index);\n        var tbody = this.getContentTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n        if (tbody.querySelector('.e-emptyrow')) {\n            var emptyRow = tbody.querySelector('.e-emptyrow');\n            emptyRow.parentNode.removeChild(emptyRow);\n            if (this.frozenRows && this.element.querySelector('.e-frozenrow-empty')) {\n                this.element.querySelector('.e-frozenrow-empty').classList.remove('e-frozenrow-empty');\n            }\n        }\n        if (this.frozenRows && index < this.frozenRows) {\n            tbody = this.getHeaderContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n        }\n        else {\n            tbody = this.getContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n        }\n        tbody = this.getContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n        tbody.appendChild(tr);\n    };\n    Grid.prototype.addRowObject = function (row, index) {\n        this.getRowsObject().splice(index, 1, row);\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    Grid.prototype.updateVisibleExpandCollapseRows = function () {\n        var rows = this.getRowsObject();\n        for (var i = 0, len = rows.length; i < len; i++) {\n            if ((rows[parseInt(i.toString(), 10)].isDataRow || rows[parseInt(i.toString(), 10)].isAggregateRow)\n                && this.getRowElementByUID(rows[parseInt(i.toString(), 10)].uid)\n                && this.getRowElementByUID(rows[parseInt(i.toString(), 10)].uid).style.display === 'none') {\n                rows[parseInt(i.toString(), 10)].visible = false;\n            }\n            else {\n                rows[parseInt(i.toString(), 10)].visible = true;\n            }\n        }\n    };\n    /**\n     * Method to sanitize any suspected untrusted strings and scripts before rendering them.\n     *\n     * @param {string} value - Specifies the html value to sanitize\n     * @returns {string} Returns the sanitized html string\n     * @hidden\n     */\n    Grid.prototype.sanitize = function (value) {\n        if (this.enableHtmlSanitizer) {\n            return _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.SanitizeHtmlHelper.sanitize(value);\n        }\n        return value;\n    };\n    /**\n     * @param {string | number} height - specifies the height\n     * @returns {number | string} - specifies the height number\n     * @hidden\n     */\n    Grid.prototype.getHeight = function (height) {\n        if (!Number.isInteger(height) && height.indexOf('%') !== -1) {\n            height = parseInt(height, 10) / 100 * this.element.clientHeight;\n        }\n        else if (!Number.isInteger(height) && this.height !== 'auto') {\n            height = parseInt(height, 10);\n        }\n        else {\n            height = this.height;\n        }\n        return height;\n    };\n    /**\n     * @hidden\n     * @returns {Element} - returns frozen right content\n\n     */\n    Grid.prototype.getFrozenRightContent = function () {\n        return this.contentModule.getPanel();\n    };\n    /**\n     * @hidden\n     * @returns {Element} - returns frozen right header\n\n     */\n    Grid.prototype.getFrozenRightHeader = function () {\n        return this.headerModule.getPanel();\n    };\n    /**\n     * @hidden\n     * @returns {Element} - returns movable header tbody\n\n     */\n    Grid.prototype.getMovableHeaderTbody = function () {\n        return this.getHeaderContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n    };\n    /**\n     * @hidden\n     * @returns {Element} - returns movable content tbody\n\n     */\n    Grid.prototype.getMovableContentTbody = function () {\n        return this.getContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n    };\n    /**\n     * @hidden\n     * @returns {Element} - returns frozen header tbody\n\n     */\n    Grid.prototype.getFrozenHeaderTbody = function () {\n        return this.getHeaderContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n    };\n    /**\n     * @hidden\n     * @returns {Element} - returns frozen left content tbody\n\n     */\n    Grid.prototype.getFrozenLeftContentTbody = function () {\n        return this.getContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n    };\n    /**\n     * @hidden\n     * @returns {Element} - returns frozen right header tbody\n\n     */\n    Grid.prototype.getFrozenRightHeaderTbody = function () {\n        return this.getHeaderContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n    };\n    /**\n     * @returns {Element} returns frozen right content tbody\n\n     * @hidden\n     */\n    Grid.prototype.getFrozenRightContentTbody = function () {\n        return this.getContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_10__.tbody);\n    };\n    /**\n     * @param {boolean} isCustom - Defines custom filter dialog open\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.showResponsiveCustomFilter = function (isCustom) {\n        if (this.filterModule) {\n            this.filterModule.showCustomFilter(isCustom || this.rowRenderingMode === 'Vertical');\n        }\n    };\n    /**\n     * @param {boolean} isCustom - Defines custom sort dialog open\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.showResponsiveCustomSort = function (isCustom) {\n        if (this.sortModule) {\n            this.sortModule.showCustomSort(isCustom || this.rowRenderingMode === 'Vertical');\n        }\n    };\n    /**\n     * @param {boolean} isCustom - Defines custom column chooser dialog open\n     * @returns {void}\n     * @hidden\n     */\n    Grid.prototype.showResponsiveCustomColumnChooser = function (isCustom) {\n        if (this.columnChooserModule) {\n            this.columnChooserModule.showCustomColumnChooser(isCustom || this.rowRenderingMode === 'Vertical');\n        }\n    };\n    /**\n     * To manually show the vertical row mode filter dialog\n     *\n     * @returns {void}\n     */\n    Grid.prototype.showAdaptiveFilterDialog = function () {\n        if (this.enableAdaptiveUI) {\n            this.showResponsiveCustomFilter(true);\n        }\n    };\n    /**\n     * To manually show the vertical row sort filter dialog\n     *\n     * @returns {void}\n     */\n    Grid.prototype.showAdaptiveSortDialog = function () {\n        if (this.enableAdaptiveUI) {\n            this.showResponsiveCustomSort(true);\n        }\n    };\n    /**\n     * @param {boolean} isColVirtualization - Defines column virtualization\n     * @returns {Column[]} returns array of column models\n     * @hidden\n     */\n    Grid.prototype.getCurrentVisibleColumns = function (isColVirtualization) {\n        var cols = [];\n        var gridCols = isColVirtualization ? this.getColumns() : this.columnModel;\n        for (var _i = 0, gridCols_1 = gridCols; _i < gridCols_1.length; _i++) {\n            var col = gridCols_1[_i];\n            if (col.visible) {\n                cols.push(col);\n            }\n        }\n        return cols;\n    };\n    Grid.prototype.enableInfiniteAggrgate = function () {\n        if (this.enableInfiniteScrolling && this.groupSettings.columns.length && !this.groupSettings.disablePageWiseAggregates\n            && !this.groupSettings.enableLazyLoading) {\n            this.setProperties({ groupSettings: { disablePageWiseAggregates: true } }, true);\n        }\n    };\n    var Grid_1;\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)([])\n    ], Grid.prototype, \"currentViewData\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"parentDetails\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"showHider\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)([])\n    ], Grid.prototype, \"columns\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], Grid.prototype, \"enableAltRow\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], Grid.prototype, \"enableHover\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"enableAutoFill\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], Grid.prototype, \"allowKeyboard\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"enableStickyHeader\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"enableHtmlSanitizer\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowTextWrap\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, TextWrapSettings)\n    ], Grid.prototype, \"textWrapSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, ResizeSettings)\n    ], Grid.prototype, \"resizeSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowPaging\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, _models_page_settings__WEBPACK_IMPORTED_MODULE_30__.PageSettings)\n    ], Grid.prototype, \"pageSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, LoadingIndicator)\n    ], Grid.prototype, \"loadingIndicator\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], Grid.prototype, \"enableVirtualMaskRow\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"enableVirtualization\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"enableColumnVirtualization\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"enableInfiniteScrolling\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, SearchSettings)\n    ], Grid.prototype, \"searchSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowSorting\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Ellipsis')\n    ], Grid.prototype, \"clipMode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], Grid.prototype, \"allowMultiSorting\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowExcelExport\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowPdfExport\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, SortSettings)\n    ], Grid.prototype, \"sortSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, InfiniteScrollSettings)\n    ], Grid.prototype, \"infiniteScrollSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], Grid.prototype, \"allowSelection\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(-1)\n    ], Grid.prototype, \"selectedRowIndex\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, SelectionSettings)\n    ], Grid.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowFiltering\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Horizontal')\n    ], Grid.prototype, \"rowRenderingMode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"enableAdaptiveUI\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Both')\n    ], Grid.prototype, \"adaptiveUIMode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowReordering\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowResizing\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowRowDragAndDrop\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, RowDropSettings)\n    ], Grid.prototype, \"rowDropSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, FilterSettings)\n    ], Grid.prototype, \"filterSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"allowGrouping\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"enableImmutableMode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"showColumnMenu\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"autoFit\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, GroupSettings)\n    ], Grid.prototype, \"groupSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, EditSettings)\n    ], Grid.prototype, \"editSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Collection)([], _models_aggregate__WEBPACK_IMPORTED_MODULE_31__.AggregateRow)\n    ], Grid.prototype, \"aggregates\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"showColumnChooser\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Complex)({}, _models_column_chooser_settings__WEBPACK_IMPORTED_MODULE_32__.ColumnChooserSettings)\n    ], Grid.prototype, \"columnChooserSettings\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Grid.prototype, \"enableHeaderFocus\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('auto')\n    ], Grid.prototype, \"height\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('auto')\n    ], Grid.prototype, \"width\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Default')\n    ], Grid.prototype, \"gridLines\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"rowTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"emptyRecordTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"detailTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"childGrid\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"queryString\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('AllPages')\n    ], Grid.prototype, \"printMode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('Expanded')\n    ], Grid.prototype, \"hierarchyPrintMode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)([])\n    ], Grid.prototype, \"dataSource\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(null)\n    ], Grid.prototype, \"rowHeight\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"query\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('USD')\n    ], Grid.prototype, \"currencyCode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"exportGrids\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"toolbar\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"contextMenuItems\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"columnMenuItems\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"toolbarTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Grid.prototype, \"pagerTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(0)\n    ], Grid.prototype, \"frozenRows\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(0)\n    ], Grid.prototype, \"frozenColumns\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('')\n    ], Grid.prototype, \"cssClass\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('All')\n    ], Grid.prototype, \"columnQueryMode\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)({})\n    ], Grid.prototype, \"currentAction\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('')\n    ], Grid.prototype, \"ej2StatePersistenceVersion\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"created\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"destroyed\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"load\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"rowDataBound\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"queryCellInfo\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"headerCellInfo\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"actionBegin\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"actionComplete\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"actionFailure\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"dataBound\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"recordDoubleClick\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"recordClick\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"rowSelecting\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"rowSelected\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"rowDeselecting\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"rowDeselected\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"cellSelecting\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"cellSelected\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"cellDeselecting\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"cellDeselected\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnSelecting\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnSelected\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnDeselecting\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnDeselected\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnDragStart\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnDrag\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnDrop\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"printComplete\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforePrint\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"pdfQueryCellInfo\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"pdfHeaderQueryCellInfo\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"pdfAggregateQueryCellInfo\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"excelAggregateQueryCellInfo\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"exportDetailDataBound\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"exportDetailTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"excelQueryCellInfo\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"excelHeaderQueryCellInfo\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeExcelExport\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"excelExportComplete\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforePdfExport\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"pdfExportComplete\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"rowDragStartHelper\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"detailDataBound\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"rowDragStart\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"rowDrag\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"rowDrop\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"toolbarClick\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeOpenColumnChooser\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeOpenAdaptiveDialog\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"batchAdd\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"batchDelete\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"batchCancel\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeBatchAdd\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeBatchDelete\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeBatchSave\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beginEdit\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"commandClick\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"cellEdit\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"cellSave\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"cellSaved\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"resizeStart\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"resizing\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"resizeStop\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"keyPressed\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeDataBound\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"contextMenuOpen\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"contextMenuClick\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnMenuOpen\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnMenuClick\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"checkBoxChange\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeCopy\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforePaste\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeAutoFill\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"columnDataStateChange\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"dataStateChange\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"dataSourceChanged\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"exportGroupCaption\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"lazyLoadGroupExpand\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"lazyLoadGroupCollapse\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Grid.prototype, \"beforeDetailTemplateDetach\", void 0);\n    Grid = Grid_1 = __decorate([\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.NotifyPropertyChanges\n    ], Grid);\n    return Grid;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Component));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9iYXNlL2dyaWQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsa0JBQWtCLFNBQUksSUFBSSxTQUFJO0FBQzlCO0FBQ0E7QUFDQSw2Q0FBNkMsUUFBUTtBQUNyRDtBQUNBO0FBQ2lIO0FBQ3ZCO0FBQ2lCO0FBQ0Y7QUFDckM7QUFDSztBQUNpQjtBQUNrRTtBQUN0QztBQUNPO0FBQ2xGO0FBQ0M7QUFDRjtBQUNOO0FBQ21CO0FBQ0U7QUFDYTtBQUNUO0FBQ0E7QUFDRTtBQUNHO0FBQ1g7QUFDSTtBQUNKO0FBQ21CO0FBQ3pCO0FBQ047QUFDSztBQUNMO0FBQ0Y7QUFDVTtBQUNGO0FBQ047QUFDeUI7QUFDVjtBQUNOO0FBQ2tCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLENBQUMsQ0FBQywrREFBYTtBQUNXO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsZ0VBQVU7QUFDbEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLENBQUMsQ0FBQywrREFBYTtBQUNTO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVEsR0FBRztBQUNuQjtBQUNBO0FBQ0EsUUFBUSw4REFBUSxHQUFHO0FBQ25CO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxDQUFDLENBQUMsK0RBQWE7QUFDTTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxDQUFDLENBQUMsK0RBQWE7QUFDbUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxnRUFBVTtBQUNsQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsQ0FBQyxDQUFDLCtEQUFhO0FBQ1c7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsQ0FBQyxDQUFDLCtEQUFhO0FBQ2M7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsQ0FBQyxDQUFDLCtEQUFhO0FBQ1c7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsQ0FBQyxDQUFDLCtEQUFhO0FBQ1k7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsQ0FBQyxDQUFDLCtEQUFhO0FBQ2E7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsQ0FBQyxDQUFDLCtEQUFhO0FBQ1c7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsQ0FBQyxDQUFDLCtEQUFhO0FBQ1U7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUSxHQUFHO0FBQ25CO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxDQUFDLENBQUMsK0RBQWE7QUFDUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxDQUFDLENBQUMsK0RBQWE7QUFDYTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLG1CQUFtQjtBQUNoRDtB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QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw2Q0FBNkM7QUFDckQ7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUscUJBQXFCO0FBQ3BDLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixRQUFRLDRDQUE0QztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsa0NBQWtDO0FBQ2pEO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNkNBQTZDO0FBQ3JEO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsVUFBVTtBQUN6QixlQUFlLFNBQVM7QUFDeEI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxTQUFTO0FBQ3hCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRSw0REFBaUI7QUFDM0YsNEVBQTRFLDREQUFpQjtBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3REFBaUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw4REFBeUIsSUFBSSw0QkFBNEI7QUFDcEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx3REFBaUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCw4REFBOEQ7QUFDdkg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMkRBQXNCLElBQUk7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUTtBQUN4QixnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixRQUFRO0FBQ3hCLGdCQUFnQixRQUFRO0FBQ3hCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVE7QUFDeEIsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVE7QUFDeEIsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFlBQVk7QUFDM0IsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUVBQWlCLDJCQUEyQiw0REFBaUIsbUJBQW1CLHFCQUFxQjtBQUM3RyxRQUFRLHVFQUFpQiw0QkFBNEIsNERBQWlCLG1CQUFtQixxQkFBcUI7QUFDOUcsd0JBQXdCLDJCQUEyQjtBQUNuRDtBQUNBO0FBQ0EsZ0JBQWdCLDhEQUFRO0FBQ3hCO0FBQ0E7QUFDQSxnQkFBZ0IsaUVBQVc7QUFDM0I7QUFDQTtBQUNBLHdCQUF3QixnRkFBZ0Y7QUFDeEc7QUFDQTtBQUNBLGdCQUFnQiw4REFBUTtBQUN4QjtBQUNBO0FBQ0EsZ0JBQWdCLGlFQUFXO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGtCQUFrQjtBQUNsQyxnQkFBZ0IsUUFBUTtBQUN4QixnQkFBZ0IsUUFBUTtBQUN4QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixxREFBcUQ7QUFDdEUsaUJBQWlCLGdEQUFnRDtBQUNqRTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLHVFQUFpQjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG9CQUFvQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLDRCQUE0QjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix1RUFBaUI7QUFDdEMsb0JBQW9CLDhEQUFRO0FBQzVCLG9CQUFvQixpRUFBVztBQUMvQjtBQUNBO0FBQ0Esb0JBQW9CLDhEQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFXO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELFFBQVEsdUVBQWlCLGNBQWM7QUFDcEc7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFNBQVM7QUFDeEIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkUsMkVBQWtCO0FBQy9GLGdFQUFnRSwrRUFBbUI7QUFDbkYsNERBQTRELHdFQUFlO0FBQzNFLDBFQUEwRSxzREFBSTtBQUM5RSx3RkFBd0Ysc0VBQWM7QUFDdEcsNkVBQTZFLHlEQUFRO0FBQ3JGLDJFQUEyRSxnRUFBVztBQUN0RixxRUFBcUUsb0VBQWE7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsVUFBVTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMscUZBQXFGO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsdURBQXVEO0FBQ3BIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsb0VBQW9FO0FBQzNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELFNBQVM7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsa0JBQWtCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qix1REFBZ0I7QUFDN0MscUNBQXFDLHVEQUFnQjtBQUNyRCxnQ0FBZ0MsdURBQWdCO0FBQ2hELDhCQUE4Qix1REFBZ0I7QUFDOUMsb0NBQW9DLHVEQUFnQjtBQUNwRCxvQ0FBb0MsdURBQWdCO0FBQ3BELHVDQUF1Qyx1REFBZ0I7QUFDdkQsNkNBQTZDLHVEQUFnQjtBQUM3RCw2Q0FBNkMsdURBQWdCO0FBQzdELGFBQWEsdUVBQWlCO0FBQzlCLHdCQUF3Qix1RUFBaUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0VBQTJCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEVBQTBFLHlEQUFPO0FBQ2pGO0FBQ0E7QUFDQSxZQUFZLHlEQUFPO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QseURBQU87QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlFQUF5RSx5REFBTztBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwrREFBUztBQUNqQjtBQUNBLHdEQUF3RCw4Q0FBVTtBQUNsRSx5REFBeUQsOENBQVU7QUFDbkUsK0JBQStCLGtEQUFLO0FBQ3BDLG1DQUFtQywwREFBUztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELDBCQUEwQjtBQUMxRTtBQUNBLGtEQUFrRCxXQUFXLDJEQUFnQixXQUFXLGtCQUFrQjtBQUMxRyxRQUFRLDREQUFNLHVDQUF1Qyw4QkFBOEI7QUFDbkY7QUFDQSxRQUFRLDREQUFNLHVDQUF1QyxnQ0FBZ0M7QUFDckY7QUFDQTtBQUNBO0FBQ0EsUUFBUSwrREFBUztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwyQ0FBSTtBQUN4QixvQkFBb0IsMkNBQUk7QUFDeEIsb0JBQW9CLDJDQUFJO0FBQ3hCO0FBQ0E7QUFDQSxvQkFBb0IsMkNBQUk7QUFDeEIsb0JBQW9CLDJDQUFJO0FBQ3hCLG9CQUFvQiwyQ0FBSTtBQUN4QjtBQUNBO0FBQ0Esb0JBQW9CLDJDQUFJO0FBQ3hCLG9CQUFvQiwyQ0FBSTtBQUN4QixvQkFBb0IsMkNBQUk7QUFDeEI7QUFDQTtBQUNBLDRCQUE0QiwyREFBc0IsSUFBSTtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsUUFBUSwyQ0FBSTtBQUNaO0FBQ0EsUUFBUSwyQ0FBSTtBQUNaLFFBQVEsMkNBQUk7QUFDWjtBQUNBLHdCQUF3QiwyREFBc0IsSUFBSTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw0REFBTztBQUNyQztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixtREFBWTtBQUN0QyxzRkFBc0YsbURBQVk7QUFDbEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCx5REFBTztBQUM3RDtBQUNBLDhFQUE4RSxnRUFBcUI7QUFDbkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlCQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxTQUFTO0FBQ3hCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsaUJBQWlCLGdCQUFnQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELGtCQUFrQjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBLDhDQUE4QyxTQUFTLGVBQWU7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsUUFBUSw4REFBWTtBQUNwQixRQUFRLDhEQUFZO0FBQ3BCLFFBQVEsOERBQVk7QUFDcEIsUUFBUSw4REFBWTtBQUNwQixRQUFRLDhEQUFZO0FBQ3BCO0FBQ0EsUUFBUSw4REFBWTtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZ0VBQWM7QUFDaEQ7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULFFBQVEsOERBQVk7QUFDcEIsUUFBUSw4REFBWTtBQUNwQixRQUFRLDhEQUFZO0FBQ3BCLFFBQVEsOERBQVk7QUFDcEIsUUFBUSw4REFBWTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxRQUFRLDhEQUFZO0FBQ3BCLFFBQVEsOERBQVk7QUFDcEIsUUFBUSw4REFBWTtBQUNwQixRQUFRLDhEQUFZO0FBQ3BCLFFBQVEsOERBQVk7QUFDcEIsUUFBUSw4REFBWTtBQUNwQixRQUFRLDhEQUFZO0FBQ3BCLFFBQVEsOERBQVk7QUFDcEIsUUFBUSw4REFBWTtBQUNwQixRQUFRLDhEQUFZO0FBQ3BCO0FBQ0EsUUFBUSw4REFBWTtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixxREFBZ0I7QUFDaEMsZ0JBQWdCLHdEQUFtQjtBQUNuQyxnQkFBZ0IsMkRBQXNCO0FBQ3RDLGdCQUFnQixpRUFBNEI7QUFDNUMsZ0JBQWdCLG9FQUErQjtBQUMvQztBQUNBLDhCQUE4QixxREFBZ0I7QUFDOUMsZ0JBQWdCLHNEQUFpQjtBQUNqQztBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixxREFBZ0I7QUFDakMsaUJBQWlCLHdEQUFtQjtBQUNwQyxpQkFBaUIsMkRBQXNCO0FBQ3ZDLGdCQUFnQixpRUFBNEI7QUFDNUMsZ0JBQWdCLG9FQUErQjtBQUMvQyxpQ0FBaUMscURBQWdCO0FBQ2pELGlCQUFpQixzREFBaUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsVUFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksc0RBQWU7QUFDM0IsbUJBQW1CLHVFQUFpQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxtREFBWTtBQUNoRDtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsbURBQVksV0FBVywrREFBb0I7QUFDdkYsNENBQTRDLG1EQUFZO0FBQ3hELFlBQVksbURBQVk7QUFDeEIsOERBQThELG1EQUFZO0FBQzFFO0FBQ0E7QUFDQTtBQUNBLFlBQVksbURBQVk7QUFDeEIsY0FBYyxtREFBWTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiw2REFBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVEQUFrQjtBQUMzQztBQUNBLG9CQUFvQixpREFBWTtBQUNoQztBQUNBO0FBQ0EsaUJBQWlCLG1EQUFZLFdBQVcsdURBQVk7QUFDcEQ7QUFDQSx3REFBd0QsNkRBQWtCLDRCQUE0Qiw0REFBaUI7QUFDdkg7QUFDQSxnQkFBZ0IsbURBQVksOENBQThDLG1EQUFZLFdBQVcsMkRBQWdCO0FBQ2pILFlBQVksbURBQVksV0FBVywyREFBZ0I7QUFDbkQ7QUFDQTtBQUNBLG1CQUFtQixtREFBWTtBQUMvQixZQUFZLHVFQUFpQix5Q0FBeUMsNkRBQU87QUFDN0U7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDZEQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDZEQUF3QjtBQUNqRDtBQUNBLG9CQUFvQixvREFBZTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxtREFBWTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1EQUFZO0FBQzdDLGNBQWMsdUVBQWlCO0FBQy9CO0FBQ0EsaURBQWlELHlEQUFPO0FBQ3hELDBEQUEwRCxtREFBWSw0QkFBNEIsbURBQVk7QUFDOUcsaUJBQWlCLG1EQUFZLGtEQUFrRCxtREFBWTtBQUMzRixnQkFBZ0IsbURBQVksc0NBQXNDLG1EQUFZO0FBQzlFLGdCQUFnQix1RUFBaUIsQ0FBQyxtREFBWSx1Q0FBdUMsbURBQVk7QUFDakc7QUFDQSw0QkFBNEIsMkRBQXNCLElBQUk7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixtREFBWTtBQUN0QyxvRUFBb0UsbURBQVk7QUFDaEYsWUFBWSx1RUFBaUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHVFQUFpQiw2QkFBNkIsdUVBQWlCO0FBQzdFLDJCQUEyQix1RUFBaUI7QUFDNUM7QUFDQTtBQUNBLDRDQUE0QyxvQkFBb0I7QUFDaEU7QUFDQSw2REFBNkQsdUVBQWlCO0FBQzlFO0FBQ0E7QUFDQSx3QkFBd0IscURBQWM7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0REFBTTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RCw4RUFBOEUsNEVBQWlDO0FBQy9HLGlGQUFpRjtBQUNqRixpQkFBaUIsdUVBQWlCO0FBQ2xDO0FBQ0EsK0JBQStCLDREQUFNLEdBQUcsY0FBYztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRSw0REFBTSx3REFBd0Q7QUFDOUg7QUFDQTtBQUNBLGdFQUFnRSw0REFBTSx3REFBd0Q7QUFDOUg7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMEJBQTBCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0EsZ0JBQWdCLHVFQUFpQiwwQkFBMEIsdUVBQWlCO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsdUJBQXVCLDREQUFNLE1BQU0sZUFBZTtBQUNsRDtBQUNBLDZEQUE2RCxtREFBWTtBQUN6RSxZQUFZLG1EQUFZO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEMsaUNBQWlDO0FBQ2pDLGdDQUFnQyx5REFBb0IsSUFBSSxtQ0FBbUM7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsaUVBQVc7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQSxpREFBaUQ7QUFDakQsNEJBQTRCLHlEQUFvQixJQUFJLGtDQUFrQztBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwyREFBc0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsNkRBQWtCO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0RBQWlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLGVBQWUsWUFBWTtBQUMzQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxxREFBYztBQUN0QixRQUFRLHFEQUFjO0FBQ3RCO0FBQ0Esb0JBQW9CLG1EQUFjLElBQUk7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsaUVBQTRCLElBQUk7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0EsaURBQWlELG1EQUFZO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELGlFQUFzQjtBQUM5RSxrREFBa0QsMkRBQWdCO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsdUJBQXVCO0FBQ3ZDLGdCQUFnQixTQUFTO0FBQ3pCLGdCQUFnQixVQUFVO0FBQzFCLGdCQUFnQixTQUFTO0FBQ3pCLGlCQUFpQixjQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHVCQUF1QjtBQUN2QyxnQkFBZ0IsU0FBUztBQUN6QixnQkFBZ0IsVUFBVTtBQUMxQixnQkFBZ0IsU0FBUztBQUN6QixpQkFBaUIsY0FBYztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUscUJBQXFCO0FBQ3BDLGVBQWUsa0JBQWtCO0FBQ2pDLGVBQWUsUUFBUTtBQUN2QixlQUFlLFNBQVM7QUFDeEI7QUFDQSxpQkFBaUIsY0FBYztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixRQUFRO0FBQ3hCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFNBQVM7QUFDekIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlEQUFpRDtBQUN6RDtBQUNBLGdCQUFnQixRQUFRO0FBQ3hCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isd0RBQW1CO0FBQzNDO0FBQ0EsZ0JBQWdCLHdEQUFtQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixTQUFTO0FBQ3pCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFNBQVM7QUFDekIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpQkFBaUI7QUFDakM7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVE7QUFDeEIsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixTQUFTO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFVBQVU7QUFDekIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsVUFBVTtBQUN6QixlQUFlLEtBQUs7QUFDcEI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxtQkFBbUI7QUFDbEMsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELGdDQUFnQztBQUM1RjtBQUNBLDBCQUEwQixvREFBTTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0VBQStFLFdBQVc7QUFDMUY7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsNERBQTRELDJEQUFnQjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlCQUFpQjtBQUNqQztBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsaUJBQWlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsa0VBQTJCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxTQUFTO0FBQ3hCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiw0QkFBNEI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtR0FBbUcsOERBQVc7QUFDOUc7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLDhEQUFXO0FBQzFEO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw4REFBVztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseURBQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0IsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix5Q0FBTTtBQUN2QixnQkFBZ0IseUNBQU07QUFDdEIsb0JBQW9CLHlDQUFNO0FBQzFCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsNkJBQTZCLHlDQUFNO0FBQ25DLGdCQUFnQix5Q0FBTTtBQUN0QjtBQUNBLDRCQUE0QixxREFBZ0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQixTQUFTO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0UseURBQWM7QUFDbEY7QUFDQSx1RUFBdUUseURBQWM7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxvQkFBb0I7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxnQkFBZ0I7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGtCQUFrQjtBQUNqQyxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLHVFQUFpQjtBQUN6RDtBQUNBO0FBQ0EsNkJBQTZCLHVFQUFpQjtBQUM5QztBQUNBO0FBQ0EsaUNBQWlDLHVFQUFpQjtBQUNsRDtBQUNBO0FBQ0EsdUNBQXVDLHVFQUFpQjtBQUN4RDtBQUNBO0FBQ0Esc0VBQXNFLHVFQUFpQjtBQUN2RjtBQUNBO0FBQ0EsMkNBQTJDLHVFQUFpQjtBQUM1RCw0QkFBNEIsZ0VBQWdFO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isc0JBQXNCO0FBQ3RDLGdCQUFnQixRQUFRO0FBQ3hCO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBLGVBQWUsMkRBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLGVBQWU7QUFDOUIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDZEQUFVLG9CQUFvQiw4REFBVyxHQUFHLFNBQVM7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Qsa0JBQWtCO0FBQ2xFO0FBQ0Esc0RBQXNELDBCQUEwQixxQkFBcUI7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVFQUF1RSxTQUFTLDJDQUEyQztBQUMzSDtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxVQUFVO0FBQ3pCLGVBQWUsVUFBVTtBQUN6QixpQkFBaUIsVUFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isb0JBQW9CO0FBQzVDO0FBQ0E7QUFDQSxpQkFBaUIsdUVBQWlCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxzREFBZSw4R0FBOEcscUVBQW1CO0FBQzdNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsaUJBQWlCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsdUVBQWlCO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHNEQUFpQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBEO0FBQzFEO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCxzQkFBc0I7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsS0FBSztBQUNwQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGNBQWM7QUFDOUIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGNBQWM7QUFDOUIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELDBEQUEwRDtBQUM3RztBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLDhCQUE4QixnRUFBcUIsRUFBRSxrRUFBdUIsRUFBRSxrRUFBdUI7QUFDckc7QUFDQSw0QkFBNEIsdUJBQXVCO0FBQ25EO0FBQ0Esb0JBQW9CLHFEQUFjO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDBEQUEwRDtBQUM1Riw0RUFBNEU7QUFDNUU7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQ7QUFDckQ7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxRQUFRLDREQUFNO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHFGQUFxRjtBQUNuSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixtQkFBbUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsbUJBQW1CO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLCtFQUErRSx1REFBWTtBQUMzRixRQUFRLG9EQUFhO0FBQ3JCLFFBQVEscURBQWM7QUFDdEI7QUFDQSx3QkFBd0IsK0RBQTBCLElBQUksK0JBQStCLDRCQUE0QjtBQUNqSDtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsZ0VBQVc7QUFDakMsd0JBQXdCLDZFQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQSx5REFBeUQseURBQWM7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCx5REFBYztBQUN4RTtBQUNBO0FBQ0Esb0RBQW9ELHlEQUFjO0FBQ2xFO0FBQ0EsZ0RBQWdELHlEQUFjO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxTQUFTO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLG9FQUFrQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsaUJBQWlCO0FBQ2hDLGlCQUFpQixpQkFBaUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUzs7QUFFMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQVM7O0FBRTFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixTQUFTOztBQUUxQjtBQUNBO0FBQ0EscURBQXFELHlEQUFjO0FBQ25FO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixTQUFTOztBQUUxQjtBQUNBO0FBQ0EsK0NBQStDLHlEQUFjO0FBQzdEO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixTQUFTOztBQUUxQjtBQUNBO0FBQ0EscURBQXFELHlEQUFjO0FBQ25FO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixTQUFTOztBQUUxQjtBQUNBO0FBQ0EsK0NBQStDLHlEQUFjO0FBQzdEO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixTQUFTOztBQUUxQjtBQUNBO0FBQ0EscURBQXFELHlEQUFjO0FBQ25FO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUzs7QUFFMUI7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLHlEQUFjO0FBQzdEO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixpQkFBaUIsVUFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELHdCQUF3QjtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxpQkFBaUIsbUNBQW1DO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw2REFBTyxHQUFHO0FBQ2xCO0FBQ0E7QUFDQSxRQUFRLDZEQUFPLEdBQUc7QUFDbEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsNkRBQU8sR0FBRyxFQUFFLGdFQUFZO0FBQ2hDO0FBQ0E7QUFDQSxRQUFRLDZEQUFPLEdBQUc7QUFDbEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsNkRBQU8sR0FBRztBQUNsQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw2REFBTyxHQUFHO0FBQ2xCO0FBQ0E7QUFDQSxRQUFRLDZEQUFPLEdBQUc7QUFDbEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsNkRBQU8sR0FBRztBQUNsQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw2REFBTyxHQUFHO0FBQ2xCO0FBQ0E7QUFDQSxRQUFRLDZEQUFPLEdBQUc7QUFDbEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsNkRBQU8sR0FBRztBQUNsQjtBQUNBO0FBQ0EsUUFBUSw2REFBTyxHQUFHO0FBQ2xCO0FBQ0E7QUFDQSxRQUFRLGdFQUFVLEtBQUssNERBQVk7QUFDbkM7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsNkRBQU8sR0FBRyxFQUFFLG1GQUFxQjtBQUN6QztBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUSxHQUFHO0FBQ25CO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSx1RUFBcUI7QUFDN0I7QUFDQTtBQUNBLENBQUMsQ0FBQywyREFBUztBQUNLIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvYmFzZS9ncmlkLmpzPzZhZWYiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG5pbXBvcnQgeyBpc051bGxPclVuZGVmaW5lZCwgc2V0VmFsdWUsIGdldFZhbHVlLCBkZWZhdWx0Q3VycmVuY3lDb2RlLCB1cGRhdGVDU1NUZXh0IH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBDaGlsZFByb3BlcnR5LCBCcm93c2VyLCBjbG9zZXN0LCBleHRlbmQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBhZGRDbGFzcywgcmVtb3ZlQ2xhc3MsIGFwcGVuZCwgcmVtb3ZlLCBjbGFzc0xpc3QsIHNldFN0eWxlQXR0cmlidXRlIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgUHJvcGVydHksIENvbGxlY3Rpb24sIENvbXBsZXgsIEV2ZW50LCBOb3RpZnlQcm9wZXJ0eUNoYW5nZXMsIEwxMG4gfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBFdmVudEhhbmRsZXIsIEtleWJvYXJkRXZlbnRzIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgRGF0YU1hbmFnZXIsIERhdGFVdGlsLCBVcmxBZGFwdG9yIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWRhdGEnO1xuaW1wb3J0IHsgY3JlYXRlU3Bpbm5lciwgaGlkZVNwaW5uZXIsIHNob3dTcGlubmVyLCBUb29sdGlwIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLXBvcHVwcyc7XG5pbXBvcnQgeyBpdGVyYXRlQXJyYXlPck9iamVjdCwgcHJlcGFyZUNvbHVtbnMsIHBhcmVudHNVbnRpbCwgd3JhcCwgdGVtcGxhdGVDb21waWxlciwgaXNHcm91cEFkYXB0aXZlLCByZWZyZXNoRm9yZWlnbkRhdGEsIGdldFNjcm9sbEJhcldpZHRoIH0gZnJvbSAnLi91dGlsJztcbmltcG9ydCB7IGdldFJvd0hlaWdodCwgc2V0Q29sdW1uSW5kZXgsIEdsb2JhbCwgaXNwZXJjZW50YWdlV2lkdGgsIGdldE51bWJlckZvcm1hdCwgZ2V0VHJhbnNmb3JtVmFsdWVzIH0gZnJvbSAnLi91dGlsJztcbmltcG9ydCB7IHNldFJvd0VsZW1lbnRzLCByZXNldFJvd0luZGV4LCBjb21wYXJlQ2hhbmdlcywgZ2V0Q2VsbEJ5Q29sQW5kUm93SW5kZXgsIHBlcmZvcm1Db21wbGV4RGF0YU9wZXJhdGlvbiB9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnLi4vYmFzZS9jb25zdGFudCc7XG5pbXBvcnQgeyBSZW5kZXIgfSBmcm9tICcuLi9yZW5kZXJlci9yZW5kZXInO1xuaW1wb3J0IHsgQ29sdW1uIH0gZnJvbSAnLi4vbW9kZWxzL2NvbHVtbic7XG5pbXBvcnQgeyBSZW5kZXJUeXBlIH0gZnJvbSAnLi9lbnVtJztcbmltcG9ydCB7IFJvd1JlbmRlcmVyIH0gZnJvbSAnLi4vcmVuZGVyZXIvcm93LXJlbmRlcmVyJztcbmltcG9ydCB7IENlbGxSZW5kZXJlciB9IGZyb20gJy4uL3JlbmRlcmVyL2NlbGwtcmVuZGVyZXInO1xuaW1wb3J0IHsgQ2VsbFJlbmRlcmVyRmFjdG9yeSB9IGZyb20gJy4uL3NlcnZpY2VzL2NlbGwtcmVuZGVyLWZhY3RvcnknO1xuaW1wb3J0IHsgU2VydmljZUxvY2F0b3IgfSBmcm9tICcuLi9zZXJ2aWNlcy9zZXJ2aWNlLWxvY2F0b3InO1xuaW1wb3J0IHsgVmFsdWVGb3JtYXR0ZXIgfSBmcm9tICcuLi9zZXJ2aWNlcy92YWx1ZS1mb3JtYXR0ZXInO1xuaW1wb3J0IHsgUmVuZGVyZXJGYWN0b3J5IH0gZnJvbSAnLi4vc2VydmljZXMvcmVuZGVyZXItZmFjdG9yeSc7XG5pbXBvcnQgeyBDb2x1bW5XaWR0aFNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy93aWR0aC1jb250cm9sbGVyJztcbmltcG9ydCB7IEFyaWFTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvYXJpYS1zZXJ2aWNlJztcbmltcG9ydCB7IEZvY3VzU3RyYXRlZ3kgfSBmcm9tICcuLi9zZXJ2aWNlcy9mb2N1cy1zdHJhdGVneSc7XG5pbXBvcnQgeyBQYWdlU2V0dGluZ3MgfSBmcm9tICcuLi9tb2RlbHMvcGFnZS1zZXR0aW5ncyc7XG5pbXBvcnQgeyBDb2x1bW5DaG9vc2VyU2V0dGluZ3MgfSBmcm9tICcuLi9tb2RlbHMvY29sdW1uLWNob29zZXItc2V0dGluZ3MnO1xuaW1wb3J0IHsgU2VsZWN0aW9uIH0gZnJvbSAnLi4vYWN0aW9ucy9zZWxlY3Rpb24nO1xuaW1wb3J0IHsgU2VhcmNoIH0gZnJvbSAnLi4vYWN0aW9ucy9zZWFyY2gnO1xuaW1wb3J0IHsgU2hvd0hpZGUgfSBmcm9tICcuLi9hY3Rpb25zL3Nob3ctaGlkZSc7XG5pbXBvcnQgeyBTY3JvbGwgfSBmcm9tICcuLi9hY3Rpb25zL3Njcm9sbCc7XG5pbXBvcnQgeyBQcmludCB9IGZyb20gJy4uL2FjdGlvbnMvcHJpbnQnO1xuaW1wb3J0IHsgQWdncmVnYXRlUm93IH0gZnJvbSAnLi4vbW9kZWxzL2FnZ3JlZ2F0ZSc7XG5pbXBvcnQgeyBDbGlwYm9hcmQgfSBmcm9tICcuLi9hY3Rpb25zL2NsaXBib2FyZCc7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuLi9hY3Rpb25zL2xvZ2dlcic7XG5pbXBvcnQgeyBSb3dNb2RlbEdlbmVyYXRvciB9IGZyb20gJy4uL3NlcnZpY2VzL3Jvdy1tb2RlbC1nZW5lcmF0b3InO1xuaW1wb3J0IHsgU2FuaXRpemVIdG1sSGVscGVyIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0ICogYXMgbGl0ZXJhbHMgZnJvbSAnLi4vYmFzZS9zdHJpbmctbGl0ZXJhbHMnO1xuaW1wb3J0IHsgSGVhZGVyQ2VsbFJlbmRlcmVyIH0gZnJvbSAnLi4vcmVuZGVyZXIvaGVhZGVyLWNlbGwtcmVuZGVyZXInO1xuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBmaWVsZCBuYW1lIGFuZCBkaXJlY3Rpb24gb2Ygc29ydCBjb2x1bW4uXG4gKi9cbnZhciBTb3J0RGVzY3JpcHRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU29ydERlc2NyaXB0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU29ydERlc2NyaXB0b3IoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBTb3J0RGVzY3JpcHRvci5wcm90b3R5cGUsIFwiZmllbGRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIFNvcnREZXNjcmlwdG9yLnByb3RvdHlwZSwgXCJkaXJlY3Rpb25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgU29ydERlc2NyaXB0b3IucHJvdG90eXBlLCBcImlzRnJvbUdyb3VwXCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIFNvcnREZXNjcmlwdG9yO1xufShDaGlsZFByb3BlcnR5KSk7XG5leHBvcnQgeyBTb3J0RGVzY3JpcHRvciB9O1xuLyoqXG4gKiBDb25maWd1cmVzIHRoZSBzb3J0aW5nIGJlaGF2aW9yIG9mIEdyaWQuXG4gKi9cbnZhciBTb3J0U2V0dGluZ3MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNvcnRTZXR0aW5ncywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTb3J0U2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIENvbGxlY3Rpb24oW10sIFNvcnREZXNjcmlwdG9yKVxuICAgIF0sIFNvcnRTZXR0aW5ncy5wcm90b3R5cGUsIFwiY29sdW1uc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSh0cnVlKVxuICAgIF0sIFNvcnRTZXR0aW5ncy5wcm90b3R5cGUsIFwiYWxsb3dVbnNvcnRcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gU29ydFNldHRpbmdzO1xufShDaGlsZFByb3BlcnR5KSk7XG5leHBvcnQgeyBTb3J0U2V0dGluZ3MgfTtcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgcHJlZGljYXRlIGZvciB0aGUgZmlsdGVyIGNvbHVtbi5cbiAqL1xudmFyIFByZWRpY2F0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUHJlZGljYXRlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFByZWRpY2F0ZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIFByZWRpY2F0ZS5wcm90b3R5cGUsIFwiZmllbGRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIFByZWRpY2F0ZS5wcm90b3R5cGUsIFwib3BlcmF0b3JcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIFByZWRpY2F0ZS5wcm90b3R5cGUsIFwidmFsdWVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIFByZWRpY2F0ZS5wcm90b3R5cGUsIFwibWF0Y2hDYXNlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIFByZWRpY2F0ZS5wcm90b3R5cGUsIFwiaWdub3JlQWNjZW50XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBQcmVkaWNhdGUucHJvdG90eXBlLCBcInByZWRpY2F0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSh7fSlcbiAgICBdLCBQcmVkaWNhdGUucHJvdG90eXBlLCBcImFjdHVhbEZpbHRlclZhbHVlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KHt9KVxuICAgIF0sIFByZWRpY2F0ZS5wcm90b3R5cGUsIFwiYWN0dWFsT3BlcmF0b3JcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIFByZWRpY2F0ZS5wcm90b3R5cGUsIFwidHlwZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgUHJlZGljYXRlLnByb3RvdHlwZSwgXCJlanByZWRpY2F0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgUHJlZGljYXRlLnByb3RvdHlwZSwgXCJ1aWRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIFByZWRpY2F0ZS5wcm90b3R5cGUsIFwiaXNGb3JlaWduS2V5XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBQcmVkaWNhdGUucHJvdG90eXBlLCBcImNvbmRpdGlvblwiLCB2b2lkIDApO1xuICAgIHJldHVybiBQcmVkaWNhdGU7XG59KENoaWxkUHJvcGVydHkpKTtcbmV4cG9ydCB7IFByZWRpY2F0ZSB9O1xuLyoqXG4gKiBDb25maWd1cmVzIHRoZSBpbmZpbml0ZSBzY3JvbGwgYmVoYXZpb3Igb2YgR3JpZC5cbiAqL1xudmFyIEluZmluaXRlU2Nyb2xsU2V0dGluZ3MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEluZmluaXRlU2Nyb2xsU2V0dGluZ3MsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW5maW5pdGVTY3JvbGxTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgSW5maW5pdGVTY3JvbGxTZXR0aW5ncy5wcm90b3R5cGUsIFwiZW5hYmxlQ2FjaGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoMylcbiAgICBdLCBJbmZpbml0ZVNjcm9sbFNldHRpbmdzLnByb3RvdHlwZSwgXCJtYXhCbG9ja3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoMylcbiAgICBdLCBJbmZpbml0ZVNjcm9sbFNldHRpbmdzLnByb3RvdHlwZSwgXCJpbml0aWFsQmxvY2tzXCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIEluZmluaXRlU2Nyb2xsU2V0dGluZ3M7XG59KENoaWxkUHJvcGVydHkpKTtcbmV4cG9ydCB7IEluZmluaXRlU2Nyb2xsU2V0dGluZ3MgfTtcbi8qKlxuICogQ29uZmlndXJlcyB0aGUgZmlsdGVyaW5nIGJlaGF2aW9yIG9mIHRoZSBHcmlkLlxuICovXG52YXIgRmlsdGVyU2V0dGluZ3MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZpbHRlclNldHRpbmdzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZpbHRlclNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBDb2xsZWN0aW9uKFtdLCBQcmVkaWNhdGUpXG4gICAgXSwgRmlsdGVyU2V0dGluZ3MucHJvdG90eXBlLCBcImNvbHVtbnNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ0ZpbHRlckJhcicpXG4gICAgXSwgRmlsdGVyU2V0dGluZ3MucHJvdG90eXBlLCBcInR5cGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ09uRW50ZXInKVxuICAgIF0sIEZpbHRlclNldHRpbmdzLnByb3RvdHlwZSwgXCJtb2RlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KHRydWUpXG4gICAgXSwgRmlsdGVyU2V0dGluZ3MucHJvdG90eXBlLCBcInNob3dGaWx0ZXJCYXJTdGF0dXNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoMTUwMClcbiAgICBdLCBGaWx0ZXJTZXR0aW5ncy5wcm90b3R5cGUsIFwiaW1tZWRpYXRlTW9kZURlbGF5XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBGaWx0ZXJTZXR0aW5ncy5wcm90b3R5cGUsIFwib3BlcmF0b3JzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEZpbHRlclNldHRpbmdzLnByb3RvdHlwZSwgXCJpZ25vcmVBY2NlbnRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgRmlsdGVyU2V0dGluZ3MucHJvdG90eXBlLCBcImVuYWJsZUluZmluaXRlU2Nyb2xsaW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KDUwKVxuICAgIF0sIEZpbHRlclNldHRpbmdzLnByb3RvdHlwZSwgXCJpdGVtc0NvdW50XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KCdTaGltbWVyJylcbiAgICBdLCBGaWx0ZXJTZXR0aW5ncy5wcm90b3R5cGUsIFwibG9hZGluZ0luZGljYXRvclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBGaWx0ZXJTZXR0aW5ncy5wcm90b3R5cGUsIFwiZW5hYmxlQ2FzZVNlbnNpdGl2aXR5XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEZpbHRlclNldHRpbmdzLnByb3RvdHlwZSwgXCJzaG93RmlsdGVyQmFyT3BlcmF0b3JcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gRmlsdGVyU2V0dGluZ3M7XG59KENoaWxkUHJvcGVydHkpKTtcbmV4cG9ydCB7IEZpbHRlclNldHRpbmdzIH07XG4vKipcbiAqIENvbmZpZ3VyZXMgdGhlIHNlbGVjdGlvbiBiZWhhdmlvciBvZiB0aGUgR3JpZC5cbiAqL1xudmFyIFNlbGVjdGlvblNldHRpbmdzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWxlY3Rpb25TZXR0aW5ncywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZWxlY3Rpb25TZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ1JvdycpXG4gICAgXSwgU2VsZWN0aW9uU2V0dGluZ3MucHJvdG90eXBlLCBcIm1vZGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ0Zsb3cnKVxuICAgIF0sIFNlbGVjdGlvblNldHRpbmdzLnByb3RvdHlwZSwgXCJjZWxsU2VsZWN0aW9uTW9kZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnU2luZ2xlJylcbiAgICBdLCBTZWxlY3Rpb25TZXR0aW5ncy5wcm90b3R5cGUsIFwidHlwZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBTZWxlY3Rpb25TZXR0aW5ncy5wcm90b3R5cGUsIFwiY2hlY2tib3hPbmx5XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIFNlbGVjdGlvblNldHRpbmdzLnByb3RvdHlwZSwgXCJwZXJzaXN0U2VsZWN0aW9uXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KCdEZWZhdWx0JylcbiAgICBdLCBTZWxlY3Rpb25TZXR0aW5ncy5wcm90b3R5cGUsIFwiY2hlY2tib3hNb2RlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIFNlbGVjdGlvblNldHRpbmdzLnByb3RvdHlwZSwgXCJlbmFibGVTaW1wbGVNdWx0aVJvd1NlbGVjdGlvblwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSh0cnVlKVxuICAgIF0sIFNlbGVjdGlvblNldHRpbmdzLnByb3RvdHlwZSwgXCJlbmFibGVUb2dnbGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgU2VsZWN0aW9uU2V0dGluZ3MucHJvdG90eXBlLCBcImFsbG93Q29sdW1uU2VsZWN0aW9uXCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIFNlbGVjdGlvblNldHRpbmdzO1xufShDaGlsZFByb3BlcnR5KSk7XG5leHBvcnQgeyBTZWxlY3Rpb25TZXR0aW5ncyB9O1xuLyoqXG4gKiBDb25maWd1cmVzIHRoZSBzZWFyY2ggYmVoYXZpb3Igb2YgdGhlIEdyaWQuXG4gKi9cbnZhciBTZWFyY2hTZXR0aW5ncyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VhcmNoU2V0dGluZ3MsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VhcmNoU2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KFtdKVxuICAgIF0sIFNlYXJjaFNldHRpbmdzLnByb3RvdHlwZSwgXCJmaWVsZHNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJycpXG4gICAgXSwgU2VhcmNoU2V0dGluZ3MucHJvdG90eXBlLCBcImtleVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnY29udGFpbnMnKVxuICAgIF0sIFNlYXJjaFNldHRpbmdzLnByb3RvdHlwZSwgXCJvcGVyYXRvclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSh0cnVlKVxuICAgIF0sIFNlYXJjaFNldHRpbmdzLnByb3RvdHlwZSwgXCJpZ25vcmVDYXNlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIFNlYXJjaFNldHRpbmdzLnByb3RvdHlwZSwgXCJpZ25vcmVBY2NlbnRcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gU2VhcmNoU2V0dGluZ3M7XG59KENoaWxkUHJvcGVydHkpKTtcbmV4cG9ydCB7IFNlYXJjaFNldHRpbmdzIH07XG4vKipcbiAqIENvbmZpZ3VyZXMgdGhlIHJvdyBkcm9wIHNldHRpbmdzIG9mIHRoZSBHcmlkLlxuICovXG52YXIgUm93RHJvcFNldHRpbmdzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhSb3dEcm9wU2V0dGluZ3MsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUm93RHJvcFNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgUm93RHJvcFNldHRpbmdzLnByb3RvdHlwZSwgXCJ0YXJnZXRJRFwiLCB2b2lkIDApO1xuICAgIHJldHVybiBSb3dEcm9wU2V0dGluZ3M7XG59KENoaWxkUHJvcGVydHkpKTtcbmV4cG9ydCB7IFJvd0Ryb3BTZXR0aW5ncyB9O1xuLyoqXG4gKiBDb25maWd1cmVzIHRoZSB0ZXh0IHdyYXAgc2V0dGluZ3Mgb2YgdGhlIEdyaWQuXG4gKi9cbnZhciBUZXh0V3JhcFNldHRpbmdzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUZXh0V3JhcFNldHRpbmdzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRXcmFwU2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KCdCb3RoJylcbiAgICBdLCBUZXh0V3JhcFNldHRpbmdzLnByb3RvdHlwZSwgXCJ3cmFwTW9kZVwiLCB2b2lkIDApO1xuICAgIHJldHVybiBUZXh0V3JhcFNldHRpbmdzO1xufShDaGlsZFByb3BlcnR5KSk7XG5leHBvcnQgeyBUZXh0V3JhcFNldHRpbmdzIH07XG4vKipcbiAqIENvbmZpZ3VyZXMgdGhlIHJlc2l6ZSBiZWhhdmlvciBvZiB0aGUgR3JpZC5cbiAqL1xudmFyIFJlc2l6ZVNldHRpbmdzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhSZXNpemVTZXR0aW5ncywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBSZXNpemVTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ05vcm1hbCcpXG4gICAgXSwgUmVzaXplU2V0dGluZ3MucHJvdG90eXBlLCBcIm1vZGVcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gUmVzaXplU2V0dGluZ3M7XG59KENoaWxkUHJvcGVydHkpKTtcbmV4cG9ydCB7IFJlc2l6ZVNldHRpbmdzIH07XG4vKipcbiAqIENvbmZpZ3VyZXMgdGhlIGdyb3VwIGJlaGF2aW9yIG9mIHRoZSBHcmlkLlxuICovXG52YXIgR3JvdXBTZXR0aW5ncyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoR3JvdXBTZXR0aW5ncywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBHcm91cFNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSh0cnVlKVxuICAgIF0sIEdyb3VwU2V0dGluZ3MucHJvdG90eXBlLCBcInNob3dEcm9wQXJlYVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcm91cFNldHRpbmdzLnByb3RvdHlwZSwgXCJhbGxvd1Jlb3JkZXJpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgR3JvdXBTZXR0aW5ncy5wcm90b3R5cGUsIFwic2hvd1RvZ2dsZUJ1dHRvblwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcm91cFNldHRpbmdzLnByb3RvdHlwZSwgXCJzaG93R3JvdXBlZENvbHVtblwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSh0cnVlKVxuICAgIF0sIEdyb3VwU2V0dGluZ3MucHJvdG90eXBlLCBcInNob3dVbmdyb3VwQnV0dG9uXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEdyb3VwU2V0dGluZ3MucHJvdG90eXBlLCBcImRpc2FibGVQYWdlV2lzZUFnZ3JlZ2F0ZXNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoW10pXG4gICAgXSwgR3JvdXBTZXR0aW5ncy5wcm90b3R5cGUsIFwiY29sdW1uc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgR3JvdXBTZXR0aW5ncy5wcm90b3R5cGUsIFwiY2FwdGlvblRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEdyb3VwU2V0dGluZ3MucHJvdG90eXBlLCBcImVuYWJsZUxhenlMb2FkaW5nXCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIEdyb3VwU2V0dGluZ3M7XG59KENoaWxkUHJvcGVydHkpKTtcbmV4cG9ydCB7IEdyb3VwU2V0dGluZ3MgfTtcbi8qKlxuICogQ29uZmlndXJlcyB0aGUgZWRpdCBiZWhhdmlvciBvZiB0aGUgR3JpZC5cbiAqL1xudmFyIEVkaXRTZXR0aW5ncyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRWRpdFNldHRpbmdzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEVkaXRTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgRWRpdFNldHRpbmdzLnByb3RvdHlwZSwgXCJhbGxvd0FkZGluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBFZGl0U2V0dGluZ3MucHJvdG90eXBlLCBcImFsbG93RWRpdGluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBFZGl0U2V0dGluZ3MucHJvdG90eXBlLCBcImFsbG93RGVsZXRpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ05vcm1hbCcpXG4gICAgXSwgRWRpdFNldHRpbmdzLnByb3RvdHlwZSwgXCJtb2RlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KHRydWUpXG4gICAgXSwgRWRpdFNldHRpbmdzLnByb3RvdHlwZSwgXCJhbGxvd0VkaXRPbkRibENsaWNrXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KHRydWUpXG4gICAgXSwgRWRpdFNldHRpbmdzLnByb3RvdHlwZSwgXCJzaG93Q29uZmlybURpYWxvZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBFZGl0U2V0dGluZ3MucHJvdG90eXBlLCBcInNob3dEZWxldGVDb25maXJtRGlhbG9nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBFZGl0U2V0dGluZ3MucHJvdG90eXBlLCBcInRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBFZGl0U2V0dGluZ3MucHJvdG90eXBlLCBcImhlYWRlclRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBFZGl0U2V0dGluZ3MucHJvdG90eXBlLCBcImZvb3RlclRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KCdUb3AnKVxuICAgIF0sIEVkaXRTZXR0aW5ncy5wcm90b3R5cGUsIFwibmV3Um93UG9zaXRpb25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoe30pXG4gICAgXSwgRWRpdFNldHRpbmdzLnByb3RvdHlwZSwgXCJkaWFsb2dcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgRWRpdFNldHRpbmdzLnByb3RvdHlwZSwgXCJhbGxvd05leHRSb3dFZGl0XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEVkaXRTZXR0aW5ncy5wcm90b3R5cGUsIFwic2hvd0FkZE5ld1Jvd1wiLCB2b2lkIDApO1xuICAgIHJldHVybiBFZGl0U2V0dGluZ3M7XG59KENoaWxkUHJvcGVydHkpKTtcbmV4cG9ydCB7IEVkaXRTZXR0aW5ncyB9O1xuLyoqXG4gKiBDb25maWd1cmVzIHRoZSBMb2FkaW5nIEluZGljYXRvciBvZiB0aGUgR3JpZC5cbiAqL1xudmFyIExvYWRpbmdJbmRpY2F0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExvYWRpbmdJbmRpY2F0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTG9hZGluZ0luZGljYXRvcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ1NwaW5uZXInKVxuICAgIF0sIExvYWRpbmdJbmRpY2F0b3IucHJvdG90eXBlLCBcImluZGljYXRvclR5cGVcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gTG9hZGluZ0luZGljYXRvcjtcbn0oQ2hpbGRQcm9wZXJ0eSkpO1xuZXhwb3J0IHsgTG9hZGluZ0luZGljYXRvciB9O1xuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBHcmlkIGNvbXBvbmVudC5cbiAqIGBgYGh0bWxcbiAqIDxkaXYgaWQ9XCJncmlkXCI+PC9kaXY+XG4gKiA8c2NyaXB0PlxuICogIHZhciBncmlkT2JqID0gbmV3IEdyaWQoeyBhbGxvd1BhZ2luZzogdHJ1ZSB9KTtcbiAqICBncmlkT2JqLmFwcGVuZFRvKFwiI2dyaWRcIik7XG4gKiA8L3NjcmlwdD5cbiAqIGBgYFxuICovXG52YXIgR3JpZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoR3JpZCwgX3N1cGVyKTtcbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvciBmb3IgY3JlYXRpbmcgdGhlIGNvbXBvbmVudFxuICAgICAqXG4gICAgICogQHBhcmFtIHtHcmlkTW9kZWx9IG9wdGlvbnMgLSBzcGVjaWZpZXMgdGhlIG9wdGlvbnNcbiAgICAgKiBAcGFyYW0ge3N0cmluZyB8IEhUTUxFbGVtZW50fSBlbGVtZW50IC0gc3BlY2lmaWVzIHRoZSBlbGVtZW50XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEdyaWQob3B0aW9ucywgZWxlbWVudCkge1xuICAgICAgICB2YXIgX3RoaXNfMSA9IF9zdXBlci5jYWxsKHRoaXMsIG9wdGlvbnMsIGVsZW1lbnQpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzXzEuaXNQcmV2ZW50U2Nyb2xsRXZlbnQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXNfMS5pblZpZXdJbmRleGVzID0gW107XG4gICAgICAgIF90aGlzXzEua2V5QSA9IGZhbHNlO1xuICAgICAgICBfdGhpc18xLmZyb3plblJpZ2h0Q291bnQgPSAwO1xuICAgICAgICBfdGhpc18xLmZyZWV6ZUNvbHVtblJlZnJlc2ggPSB0cnVlO1xuICAgICAgICBfdGhpc18xLnJpZ2h0Y291bnQgPSAwO1xuICAgICAgICBfdGhpc18xLmZyb3plbkxlZnRDb3VudCA9IDA7XG4gICAgICAgIF90aGlzXzEubGVmdGNvdW50ID0gMDtcbiAgICAgICAgX3RoaXNfMS50YWJsZXNDb3VudCA9IDE7XG4gICAgICAgIF90aGlzXzEubW92YWJsZUNvdW50ID0gMDtcbiAgICAgICAgX3RoaXNfMS5tb3ZhYmxlY291bnQgPSAwO1xuICAgICAgICBfdGhpc18xLmZpeGVkY291bnQgPSAwO1xuICAgICAgICBfdGhpc18xLmZpeGVkQ291bnQgPSAwO1xuICAgICAgICBfdGhpc18xLnZpc2libGVGcm96ZW5MZWZ0ID0gMDtcbiAgICAgICAgX3RoaXNfMS52aXNpYmxlRnJvemVuRml4ZWQgPSAwO1xuICAgICAgICBfdGhpc18xLmlzUHJlcGFyZWRGcm96ZW5Db2x1bW5zID0gZmFsc2U7XG4gICAgICAgIF90aGlzXzEudmlzaWJsZUZyb3plblJpZ2h0ID0gMDtcbiAgICAgICAgX3RoaXNfMS52aXNpYmxlTW92YWJsZSA9IDA7XG4gICAgICAgIF90aGlzXzEuZnJvemVuTGVmdENvbHVtbnMgPSBbXTtcbiAgICAgICAgX3RoaXNfMS5mcm96ZW5SaWdodENvbHVtbnMgPSBbXTtcbiAgICAgICAgX3RoaXNfMS5tb3ZhYmxlQ29sdW1ucyA9IFtdO1xuICAgICAgICBfdGhpc18xLmZpeGVkQ29sdW1ucyA9IFtdO1xuICAgICAgICBfdGhpc18xLnN0YWNrZWRMZWZ0ID0gW107XG4gICAgICAgIF90aGlzXzEuc3RhY2tlZFJpZ2h0ID0gW107XG4gICAgICAgIF90aGlzXzEuc3RhY2tlZEZpeGVkID0gW107XG4gICAgICAgIF90aGlzXzEuc3RhY2tlZE1vdmFibGUgPSBbXTtcbiAgICAgICAgX3RoaXNfMS5zdGFja2VkYXJyYXlMZWZ0ID0gW107XG4gICAgICAgIF90aGlzXzEuc3RhY2tlZGFycmF5UmlnaHQgPSBbXTtcbiAgICAgICAgX3RoaXNfMS5zdGFja2VkYXJyYXlGaXhlZCA9IFtdO1xuICAgICAgICBfdGhpc18xLnN0YWNrZWRhcnJheU1vdmFibGUgPSBbXTtcbiAgICAgICAgX3RoaXNfMS5tZWRpYSA9IHt9O1xuICAgICAgICBfdGhpc18xLmF1dG9GaXRDb2x1bW5zUmVzaXplID0gZmFsc2U7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEudGFibGVJbmRleCA9IDA7XG4gICAgICAgIF90aGlzXzEuY29tcG9uZW50UmVmcmVzaCA9IENvbXBvbmVudC5wcm90b3R5cGUucmVmcmVzaDtcbiAgICAgICAgX3RoaXNfMS5pc0NoYW5nZURhdGFTb3VyY2VDYWxsID0gZmFsc2U7XG4gICAgICAgIF90aGlzXzEubWVyZ2VkQ29sdW1ucyA9IGZhbHNlO1xuICAgICAgICAvKiogQGhpZGRlbiAqL1xuICAgICAgICBfdGhpc18xLmlzVmlydHVhbEFkYXB0aXZlID0gZmFsc2U7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIC8qKlxuICAgICAgICAgKiAqIElmIGByZXF1aXJlVGVtcGxhdGVSZWZgIGlzIHNldCB0byBmYWxzZSBpbiB0aGUgbG9hZCBldmVudCwgdGhlbiB0aGUgdGVtcGxhdGUgZWxlbWVudCBjYW4ndCBiZSBhY2Nlc3NlZCBpbiBncmlkIHF1ZXJ5Q2VsbEluZm8sIGFuZCByb3dEYXRhQm91bmQgZXZlbnRzLlxuICAgICAgICAgKiAqIEJ5IGRlZmF1bHQsIFJlYWN0J3MgZ3JpZCBxdWVyeUNlbGxJbmZvIGFuZCByb3dEYXRhQm91bmQgZXZlbnRzIGFsbG93IGFjY2VzcyB0byB0aGUgdGVtcGxhdGUgZWxlbWVudC5cbiAgICAgICAgICogKiBBdm9pZCBhY2Nlc3NpbmcgdGhlIHRlbXBsYXRlIGVsZW1lbnRzIGluIHRoZSBncmlkIHF1ZXJ5Q2VsbEluZm8gYW5kIHJvd0RhdGFCb3VuZCBldmVudHMgdG8gaW1wcm92ZSByZW5kZXJpbmcgcGVyZm9ybWFuY2UgYnkgc2V0dGluZyB0aGlzIHZhbHVlIGFzIGZhbHNlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICBfdGhpc18xLnJlcXVpcmVUZW1wbGF0ZVJlZiA9IHRydWU7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEudlJvd3MgPSBbXTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS52Y1Jvd3MgPSBbXTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS52R3JvdXBPZmZzZXRzID0ge307XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEucm93VWlkID0gMDtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS50cmFuc2xhdGVYID0gMDtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5pc01hbnVhbFJlZnJlc2ggPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5pc0F1dG9GaXRDb2x1bW5zID0gZmFsc2U7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEuZW5hYmxlRGVlcENvbXBhcmUgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS50b3RhbERhdGFSZWNvcmRzQ291bnQgPSAwO1xuICAgICAgICAvKiogQGhpZGRlbiAqL1xuICAgICAgICBfdGhpc18xLmRpc2FibGVTZWxlY3RlZFJlY29yZHMgPSBbXTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5wYXJ0aWFsU2VsZWN0ZWRSZWNvcmRzID0gW107XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEuaXNTcGFuID0gZmFsc2U7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEuaXNsYXp5bG9hZFJlcXVlc3QgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5pc0FkZE5ld1JvdyA9IGZhbHNlO1xuICAgICAgICAvKiogQGhpZGRlbiAqL1xuICAgICAgICBfdGhpc18xLmFkZE5ld1Jvd0ZvY3VzID0gdHJ1ZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5zZWxlY3RWaXJ0dWFsUm93T25BZGQgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5sb2NrY29sUG9zaXRpb25Db3VudCA9IDA7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEucHJldlBhZ2VNb3ZpbmcgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5wYWdlVGVtcGxhdGVDaGFuZ2UgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5pc0F1dG9HZW4gPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5pc0F1dG9HZW5lcmF0ZUNvbHVtbnMgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXNfMS5wYWdlUmVxdWlyZVJlZnJlc2ggPSB0cnVlO1xuICAgICAgICBfdGhpc18xLm1lZGlhQmluZEluc3RhbmNlID0ge307XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEuY29tbWFuZERlbEluZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICAvKiogQGhpZGRlbiAqL1xuICAgICAgICBfdGhpc18xLnByZXZlbnRBdXRvRml0ID0gZmFsc2U7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEuYXN5bmNUaW1lT3V0ID0gNTA7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEuaXNFeHBvcnRHcmlkID0gZmFsc2U7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzXzEuaXNXaWRnZXRzRGVzdHJveWVkID0gZmFsc2U7XG4gICAgICAgIF90aGlzXzEuZW5hYmxlTG9nZ2VyID0gZmFsc2U7XG4gICAgICAgIF90aGlzXzEubmVlZHNJRCA9IHRydWU7XG4gICAgICAgIEdyaWRfMS5JbmplY3QoU2VsZWN0aW9uKTtcbiAgICAgICAgc2V0VmFsdWUoJ21lcmdlUGVyc2lzdERhdGEnLCBfdGhpc18xLm1lcmdlUGVyc2lzdEdyaWREYXRhLCBfdGhpc18xKTtcbiAgICAgICAgcmV0dXJuIF90aGlzXzE7XG4gICAgfVxuICAgIEdyaWRfMSA9IEdyaWQ7XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBwcm9wZXJ0aWVzIHRvIGJlIG1haW50YWluZWQgaW4gdGhlIHBlcnNpc3RlZCBzdGF0ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgdGhlIHBlcnNpc3QgZGF0YVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFBlcnNpc3REYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIga2V5RW50aXR5ID0gWydwYWdlU2V0dGluZ3MnLCAnc29ydFNldHRpbmdzJyxcbiAgICAgICAgICAgICdmaWx0ZXJTZXR0aW5ncycsICdncm91cFNldHRpbmdzJywgJ2NvbHVtbnMnLCAnc2VhcmNoU2V0dGluZ3MnLCAnc2VsZWN0ZWRSb3dJbmRleCcsICdzY3JvbGxQb3NpdGlvbiddO1xuICAgICAgICB2YXIgaWdub3JlT25QZXJzaXN0ID0ge1xuICAgICAgICAgICAgcGFnZVNldHRpbmdzOiBbJ3RlbXBsYXRlJywgJ3BhZ2VTaXplcycsICdlbmFibGVRdWVyeVN0cmluZycsICd0b3RhbFJlY29yZHNDb3VudCcsICdwYWdlQ291bnQnXSxcbiAgICAgICAgICAgIGZpbHRlclNldHRpbmdzOiBbJ3R5cGUnLCAnbW9kZScsICdzaG93RmlsdGVyQmFyU3RhdHVzJywgJ2ltbWVkaWF0ZU1vZGVEZWxheScsICdpZ25vcmVBY2NlbnQnXSxcbiAgICAgICAgICAgIGdyb3VwU2V0dGluZ3M6IFsnc2hvd0Ryb3BBcmVhJywgJ3Nob3dUb2dnbGVCdXR0b24nLCAnc2hvd0dyb3VwZWRDb2x1bW4nLCAnc2hvd1VuZ3JvdXBCdXR0b24nLFxuICAgICAgICAgICAgICAgICdkaXNhYmxlUGFnZVdpc2VBZ2dyZWdhdGVzJywgJ2hpZGVDYXB0aW9uQ291bnQnXSxcbiAgICAgICAgICAgIHNlYXJjaFNldHRpbmdzOiBbJ2ZpZWxkcycsICdvcGVyYXRvcicsICdpZ25vcmVDYXNlJ10sXG4gICAgICAgICAgICBzb3J0U2V0dGluZ3M6IFtdLCBjb2x1bW5zOiBbXSwgc2VsZWN0ZWRSb3dJbmRleDogW10sIHNjcm9sbFBvc2l0aW9uOiBbXVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleUVudGl0eS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRPYmplY3QgPSB0aGlzW2tleUVudGl0eVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGlnbm9yZU9uUGVyc2lzdFtrZXlFbnRpdHlbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBjdXJyZW50T2JqZWN0W1wiXCIgKyB2YWxdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciB0ZW1wID0gdGhpcy5wYWdlU2V0dGluZ3MudGVtcGxhdGU7XG4gICAgICAgIHZhciBzZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oeyB0ZW1wbGF0ZTogdW5kZWZpbmVkIH0sIHRoaXMucGFnZVNldHRpbmdzKTtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgdGhpcy5lbmFibGVQZXJzaXN0ZW5jZSAmJiB0aGlzLmNvbnRlbnRNb2R1bGUgJiZcbiAgICAgICAgICAgIHRoaXMuY29udGVudE1vZHVsZS5nZXRQYWdlRnJvbVRvcCAmJiAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5zY3JvbGxQb3NpdGlvbikgJiZcbiAgICAgICAgICAgICFpc051bGxPclVuZGVmaW5lZCh0aGlzLnNjcm9sbFBvc2l0aW9uLnRvcCkpIHtcbiAgICAgICAgICAgIHNldHRpbmdzWydwcm9wZXJ0aWVzJ11bJ2N1cnJlbnRQYWdlJ10gPSB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0UGFnZUZyb21Ub3AodGhpcy5zY3JvbGxQb3NpdGlvbi50b3AsIHsgYmxvY2s6IDEgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgcGFnZVNldHRpbmdzOiBzZXR0aW5ncyB9LCB0cnVlKTtcbiAgICAgICAgdmFyIGNhcHRpb25UZW1wbGF0ZVJlZiA9IHRoaXMuZ3JvdXBTZXR0aW5ncy5jYXB0aW9uVGVtcGxhdGU7XG4gICAgICAgIHZhciBpc0FuZ3VsYXJDYXB0aW9uVGVtcGxhdGUgPSBjYXB0aW9uVGVtcGxhdGVSZWYgJiYgdGhpcy5pc0FuZ3VsYXI7XG4gICAgICAgIGlmIChpc0FuZ3VsYXJDYXB0aW9uVGVtcGxhdGUpIHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmdyb3VwU2V0dGluZ3NbJ3Byb3BlcnRpZXMnXVsnY2FwdGlvblRlbXBsYXRlJ107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYWdlVGVtcGxhdGVDaGFuZ2UgPSAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYWdlclRlbXBsYXRlKTtcbiAgICAgICAgdmFyIHBlcnNpc3REYXRhID0gdGhpcy5hZGRPblBlcnNpc3Qoa2V5RW50aXR5KTtcbiAgICAgICAgc2V0dGluZ3MudGVtcGxhdGUgPSB0ZW1wO1xuICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyBwYWdlU2V0dGluZ3M6IHNldHRpbmdzIH0sIHRydWUpO1xuICAgICAgICBpZiAoaXNBbmd1bGFyQ2FwdGlvblRlbXBsYXRlKSB7XG4gICAgICAgICAgICB0aGlzLmdyb3VwU2V0dGluZ3MuY2FwdGlvblRlbXBsYXRlID0gY2FwdGlvblRlbXBsYXRlUmVmO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwZXJzaXN0RGF0YTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRvIHByb3ZpZGUgdGhlIGFycmF5IG9mIG1vZHVsZXMgbmVlZGVkIGZvciBjb21wb25lbnQgcmVuZGVyaW5nXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7TW9kdWxlRGVjbGFyYXRpb25bXX0gUmV0dXJucyB0aGUgbW9kdWxlIERlY2xhcmF0aW9uXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnJlcXVpcmVkTW9kdWxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXRGcm96ZW5Db3VudCgpO1xuICAgICAgICB0aGlzLmVuYWJsZUluZmluaXRlQWdncmdhdGUoKTtcbiAgICAgICAgdmFyIG1vZHVsZXMgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBtb2R1bGVzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFsbG93RmlsdGVyaW5nKSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ2ZpbHRlcicsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXMsIHRoaXMuZmlsdGVyU2V0dGluZ3MsIHRoaXMuc2VydmljZUxvY2F0b3JdLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdGaWx0ZXInXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hbGxvd0V4Y2VsRXhwb3J0KSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ0V4Y2VsRXhwb3J0JyxcbiAgICAgICAgICAgICAgICBhcmdzOiBbdGhpcywgdGhpcy5zZXJ2aWNlTG9jYXRvcl0sXG4gICAgICAgICAgICAgICAgbmFtZTogJ0V4Y2VsRXhwb3J0J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWxsb3dQZGZFeHBvcnQpIHtcbiAgICAgICAgICAgIG1vZHVsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbWVtYmVyOiAnUGRmRXhwb3J0JyxcbiAgICAgICAgICAgICAgICBhcmdzOiBbdGhpc10sXG4gICAgICAgICAgICAgICAgbmFtZTogJ1BkZkV4cG9ydCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFsbG93U29ydGluZykge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6ICdzb3J0JyxcbiAgICAgICAgICAgICAgICBhcmdzOiBbdGhpcywgdGhpcy5zb3J0U2V0dGluZ3MsIHRoaXMuc29ydGVkQ29sdW1ucywgdGhpcy5zZXJ2aWNlTG9jYXRvcl0sXG4gICAgICAgICAgICAgICAgbmFtZTogJ1NvcnQnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hbGxvd1BhZ2luZykge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6ICdwYWdlcicsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXMsIHRoaXMucGFnZVNldHRpbmdzXSxcbiAgICAgICAgICAgICAgICBuYW1lOiAnUGFnZSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFsbG93U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ3NlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXMsIHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MsIHRoaXMuc2VydmljZUxvY2F0b3JdLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdTZWxlY3Rpb24nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXNpemVDaGVjaygpKSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ3Jlc2l6ZScsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXNdLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdSZXNpemUnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hbGxvd1Jlb3JkZXJpbmcpIHtcbiAgICAgICAgICAgIG1vZHVsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbWVtYmVyOiAncmVvcmRlcicsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXNdLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdSZW9yZGVyJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWxsb3dSb3dEcmFnQW5kRHJvcCkge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6ICdyb3dEcmFnQW5kRHJvcCcsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXNdLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdSb3dERCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFsbG93R3JvdXBpbmcpIHtcbiAgICAgICAgICAgIG1vZHVsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbWVtYmVyOiAnZ3JvdXAnLFxuICAgICAgICAgICAgICAgIGFyZ3M6IFt0aGlzLCB0aGlzLmdyb3VwU2V0dGluZ3MsIHRoaXMuc29ydGVkQ29sdW1ucywgdGhpcy5zZXJ2aWNlTG9jYXRvcl0sXG4gICAgICAgICAgICAgICAgbmFtZTogJ0dyb3VwJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWdncmVnYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIG1vZHVsZXMucHVzaCh7IG1lbWJlcjogJ2FnZ3JlZ2F0ZScsIGFyZ3M6IFt0aGlzLCB0aGlzLnNlcnZpY2VMb2NhdG9yXSwgbmFtZTogJ0FnZ3JlZ2F0ZScgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNEZXRhaWwoKSkge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6ICdkZXRhaWxSb3cnLFxuICAgICAgICAgICAgICAgIGFyZ3M6IFt0aGlzLCB0aGlzLnNlcnZpY2VMb2NhdG9yXSxcbiAgICAgICAgICAgICAgICBuYW1lOiAnRGV0YWlsUm93J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudG9vbGJhciB8fCB0aGlzLnRvb2xiYXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6ICd0b29sYmFyJyxcbiAgICAgICAgICAgICAgICBhcmdzOiBbdGhpcywgdGhpcy5zZXJ2aWNlTG9jYXRvcl0sXG4gICAgICAgICAgICAgICAgbmFtZTogJ1Rvb2xiYXInXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ3ZpcnR1YWxzY3JvbGwnLFxuICAgICAgICAgICAgICAgIGFyZ3M6IFt0aGlzLCB0aGlzLnNlcnZpY2VMb2NhdG9yXSxcbiAgICAgICAgICAgICAgICBuYW1lOiAnVmlydHVhbFNjcm9sbCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmdldEZyb3plbkNvbHVtbnMoKSB8fCB0aGlzLmZyb3plblJvd3MgfHwgdGhpcy5mcm96ZW5SaWdodENvdW50IHx8IHRoaXMuZnJvemVuTGVmdENvdW50KSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goeyBtZW1iZXI6ICdmcmVlemUnLCBhcmdzOiBbdGhpcywgdGhpcy5zZXJ2aWNlTG9jYXRvcl0sIG5hbWU6ICdGcmVlemUnIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jb2x1bW5zKSAmJiB0aGlzLmlzQ29tbWFuZENvbHVtbih0aGlzLmNvbHVtbnMpKSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ2NvbW1hbmRDb2x1bW4nLFxuICAgICAgICAgICAgICAgIGFyZ3M6IFt0aGlzLCB0aGlzLnNlcnZpY2VMb2NhdG9yXSxcbiAgICAgICAgICAgICAgICBuYW1lOiAnQ29tbWFuZENvbHVtbidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVkaXRTZXR0aW5ncy5hbGxvd0FkZGluZyB8fCB0aGlzLmVkaXRTZXR0aW5ncy5hbGxvd0RlbGV0aW5nIHx8IHRoaXMuZWRpdFNldHRpbmdzLmFsbG93RWRpdGluZykge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6ICdlZGl0JyxcbiAgICAgICAgICAgICAgICBhcmdzOiBbdGhpcywgdGhpcy5zZXJ2aWNlTG9jYXRvcl0sXG4gICAgICAgICAgICAgICAgbmFtZTogJ0VkaXQnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV4dGVuZFJlcXVpcmVkTW9kdWxlcyhtb2R1bGVzKTtcbiAgICAgICAgcmV0dXJuIG1vZHVsZXM7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5leHRlbmRSZXF1aXJlZE1vZHVsZXMgPSBmdW5jdGlvbiAobW9kdWxlcykge1xuICAgICAgICBpZiAodGhpcy5lbmFibGVJbmZpbml0ZVNjcm9sbGluZykge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6ICdpbmZpbml0ZVNjcm9sbCcsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXMsIHRoaXMuc2VydmljZUxvY2F0b3JdLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdJbmZpbml0ZVNjcm9sbCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmdyb3VwU2V0dGluZ3MuZW5hYmxlTGF6eUxvYWRpbmcpIHtcbiAgICAgICAgICAgIG1vZHVsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbWVtYmVyOiAnbGF6eUxvYWRHcm91cCcsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXMsIHRoaXMuc2VydmljZUxvY2F0b3JdLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdMYXp5TG9hZEdyb3VwJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29udGV4dE1lbnVJdGVtcykge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6ICdjb250ZXh0TWVudScsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXMsIHRoaXMuc2VydmljZUxvY2F0b3JdLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdDb250ZXh0TWVudSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNob3dDb2x1bW5NZW51KSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ2NvbHVtbk1lbnUnLFxuICAgICAgICAgICAgICAgIGFyZ3M6IFt0aGlzLCB0aGlzLnNlcnZpY2VMb2NhdG9yXSxcbiAgICAgICAgICAgICAgICBuYW1lOiAnQ29sdW1uTWVudSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNob3dDb2x1bW5DaG9vc2VyKSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ2NvbHVtbkNob29zZXInLFxuICAgICAgICAgICAgICAgIGFyZ3M6IFt0aGlzLCB0aGlzLnNlcnZpY2VMb2NhdG9yXSxcbiAgICAgICAgICAgICAgICBuYW1lOiAnQ29sdW1uQ2hvb3NlcidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jb2x1bW5zKSAmJiB0aGlzLmlzRm9yZWlnbktleUVuYWJsZWQodGhpcy5jb2x1bW5zKSkge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHsgbWVtYmVyOiAnZm9yZWlnbktleScsIGFyZ3M6IFt0aGlzLCB0aGlzLnNlcnZpY2VMb2NhdG9yXSwgbmFtZTogJ0ZvcmVpZ25LZXknIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUxvZ2dlcikge1xuICAgICAgICAgICAgbW9kdWxlcy5wdXNoKHsgbWVtYmVyOiAnbG9nZ2VyJywgYXJnczogW3RoaXNdLCBuYW1lOiAnTG9nZ2VyJyB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUucmVzaXplQ2hlY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhdXRvRml0Q29sdW1ucyA9IHRoaXMuZ2V0Q29sdW1ucygpLmZpbHRlcihmdW5jdGlvbiAoYykgeyByZXR1cm4gYy5hdXRvRml0ID09PSB0cnVlOyB9KS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jb2x1bW5Nb2RlbCkgJiYgdGhpcy5jb2x1bW5Nb2RlbC5sZW5ndGggJiYgISh0aGlzLmNvbHVtbk1vZGVsWzBdIGluc3RhbmNlb2YgQ29sdW1uKSkge1xuICAgICAgICAgICAgdGhpcy5jb2x1bW5Nb2RlbCA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb2x1bW5NZW51ID0gdGhpcy5zaG93Q29sdW1uTWVudSAmJiAoIXRoaXMuY29sdW1uTWVudUl0ZW1zIHx8IHRoaXMuY29sdW1uTWVudUl0ZW1zXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChjKSB7IHJldHVybiBjID09PSAnQXV0b0ZpdCcgfHwgYyA9PT0gJ0F1dG9GaXRBbGwnOyB9KS5sZW5ndGgpID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICB2YXIgY29udGV4dE1lbnUgPSB0aGlzLmNvbnRleHRNZW51SXRlbXMgJiYgdGhpcy5jb250ZXh0TWVudUl0ZW1zXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChjKSB7IHJldHVybiBjID09PSAnQXV0b0ZpdCcgfHwgYyA9PT0gJ0F1dG9GaXRBbGwnOyB9KS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIHJldHVybiB0aGlzLmFsbG93UmVzaXppbmcgfHwgdGhpcy5hdXRvRml0Q29sdW1uc1Jlc2l6ZSB8fCBhdXRvRml0Q29sdW1ucyB8fCBjb2x1bW5NZW51IHx8IGNvbnRleHRNZW51O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRm9yIGludGVybmFsIHVzZSBvbmx5IC0gSW5pdGlhbGl6ZSB0aGUgZXZlbnQgaGFuZGxlcjtcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUucHJlUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNlcnZpY2VMb2NhdG9yID0gbmV3IFNlcnZpY2VMb2NhdG9yO1xuICAgICAgICB0aGlzLmluaXRQcm9wZXJ0aWVzKCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZVNlcnZpY2VzKCk7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5pbml0UHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pc0luaXRpYWwgPSB0cnVlO1xuICAgICAgICB0aGlzLnNvcnRlZENvbHVtbnMgPSBbXTtcbiAgICAgICAgdGhpcy5pblZpZXdJbmRleGVzID0gW107XG4gICAgICAgIHRoaXMubWVkaWFDb2wgPSBbXTtcbiAgICAgICAgdGhpcy5pc0luaXRpYWxMb2FkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYWxsb3dTZXJ2ZXJEYXRhQmluZGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlnbm9yZUNvbGxlY3Rpb25XYXRjaCA9IHRydWU7XG4gICAgICAgIHRoaXMubWVyZ2VDZWxscyA9IHt9O1xuICAgICAgICB0aGlzLmlzRWRpdCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNoZWNrQWxsUm93cyA9ICdOb25lJztcbiAgICAgICAgdGhpcy5pc0NoZWNrQm94U2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNQZXJzaXN0U2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29tcG9uZW50UmVmcmVzaCA9IENvbXBvbmVudC5wcm90b3R5cGUucmVmcmVzaDtcbiAgICAgICAgdGhpcy5mcmVlemVDb2x1bW5SZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5maWx0ZXJPcGVyYXRvcnMgPSB7XG4gICAgICAgICAgICBjb250YWluczogJ2NvbnRhaW5zJywgZW5kc1dpdGg6ICdlbmRzd2l0aCcsIGVxdWFsOiAnZXF1YWwnLCBncmVhdGVyVGhhbjogJ2dyZWF0ZXJ0aGFuJywgZ3JlYXRlclRoYW5PckVxdWFsOiAnZ3JlYXRlcnRoYW5vcmVxdWFsJyxcbiAgICAgICAgICAgIGxlc3NUaGFuOiAnbGVzc3RoYW4nLCBsZXNzVGhhbk9yRXF1YWw6ICdsZXNzdGhhbm9yZXF1YWwnLCBub3RFcXVhbDogJ25vdGVxdWFsJywgc3RhcnRzV2l0aDogJ3N0YXJ0c3dpdGgnLCB3aWxkQ2FyZDogJ3dpbGRjYXJkJyxcbiAgICAgICAgICAgIGlzTnVsbDogJ2lzbnVsbCcsIG5vdE51bGw6ICdub3RudWxsJywgbGlrZTogJ2xpa2UnXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZGVmYXVsdExvY2FsZSA9IHtcbiAgICAgICAgICAgIEVtcHR5UmVjb3JkOiAnTm8gcmVjb3JkcyB0byBkaXNwbGF5JyxcbiAgICAgICAgICAgIFRydWU6ICd0cnVlJyxcbiAgICAgICAgICAgIEZhbHNlOiAnZmFsc2UnLFxuICAgICAgICAgICAgSW52YWxpZEZpbHRlck1lc3NhZ2U6ICdJbnZhbGlkIEZpbHRlciBEYXRhJyxcbiAgICAgICAgICAgIEdyb3VwRHJvcEFyZWE6ICdEcmFnIGEgY29sdW1uIGhlYWRlciBoZXJlIHRvIGdyb3VwIGl0cyBjb2x1bW4nLFxuICAgICAgICAgICAgVW5Hcm91cDogJ0NsaWNrIGhlcmUgdG8gdW5ncm91cCcsXG4gICAgICAgICAgICBVbkdyb3VwQnV0dG9uOiAnQ2xpY2sgaGVyZSB0byB1bmdyb3VwJyxcbiAgICAgICAgICAgIEdyb3VwRGlzYWJsZTogJ0dyb3VwaW5nIGlzIGRpc2FibGVkIGZvciB0aGlzIGNvbHVtbicsXG4gICAgICAgICAgICBGaWx0ZXJiYXJUaXRsZTogJ1xcJ3MgZmlsdGVyIGJhciBjZWxsJyxcbiAgICAgICAgICAgIEVtcHR5RGF0YVNvdXJjZUVycm9yOiAnRGF0YVNvdXJjZSBtdXN0IG5vdCBiZSBlbXB0eSBhdCBpbml0aWFsIGxvYWQgc2luY2UgY29sdW1ucyBhcmUgZ2VuZXJhdGVkIGZyb20gZGF0YVNvdXJjZSBpbiBBdXRvR2VuZXJhdGUgQ29sdW1uIEdyaWQnLFxuICAgICAgICAgICAgLy8gVG9vbGJhciBJdGVtc1xuICAgICAgICAgICAgQWRkOiAnQWRkJyxcbiAgICAgICAgICAgIEVkaXQ6ICdFZGl0JyxcbiAgICAgICAgICAgIENhbmNlbDogJ0NhbmNlbCcsXG4gICAgICAgICAgICBVcGRhdGU6ICdVcGRhdGUnLFxuICAgICAgICAgICAgRGVsZXRlOiAnRGVsZXRlJyxcbiAgICAgICAgICAgIFByaW50OiAnUHJpbnQnLFxuICAgICAgICAgICAgUGRmZXhwb3J0OiAnUERGIEV4cG9ydCcsXG4gICAgICAgICAgICBFeGNlbGV4cG9ydDogJ0V4Y2VsIEV4cG9ydCcsXG4gICAgICAgICAgICBXb3JkZXhwb3J0OiAnV29yZCBFeHBvcnQnLFxuICAgICAgICAgICAgQ3N2ZXhwb3J0OiAnQ1NWIEV4cG9ydCcsXG4gICAgICAgICAgICBTZWFyY2g6ICdTZWFyY2gnLFxuICAgICAgICAgICAgQ29sdW1uY2hvb3NlcjogJ0NvbHVtbnMnLFxuICAgICAgICAgICAgU2F2ZTogJ1NhdmUnLFxuICAgICAgICAgICAgSXRlbTogJ2l0ZW0nLFxuICAgICAgICAgICAgSXRlbXM6ICdpdGVtcycsXG4gICAgICAgICAgICBFZGl0T3BlcmF0aW9uQWxlcnQ6ICdObyByZWNvcmRzIHNlbGVjdGVkIGZvciBlZGl0IG9wZXJhdGlvbicsXG4gICAgICAgICAgICBEZWxldGVPcGVyYXRpb25BbGVydDogJ05vIHJlY29yZHMgc2VsZWN0ZWQgZm9yIGRlbGV0ZSBvcGVyYXRpb24nLFxuICAgICAgICAgICAgU2F2ZUJ1dHRvbjogJ1NhdmUnLFxuICAgICAgICAgICAgT0tCdXR0b246ICdPSycsXG4gICAgICAgICAgICBDYW5jZWxCdXR0b246ICdDYW5jZWwnLFxuICAgICAgICAgICAgRWRpdEZvcm1UaXRsZTogJ0RldGFpbHMgb2YgJyxcbiAgICAgICAgICAgIEFkZEZvcm1UaXRsZTogJ0FkZCBOZXcgUmVjb3JkJyxcbiAgICAgICAgICAgIEJhdGNoU2F2ZUNvbmZpcm06ICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gc2F2ZSBjaGFuZ2VzPycsXG4gICAgICAgICAgICBCYXRjaFNhdmVMb3N0Q2hhbmdlczogJ1Vuc2F2ZWQgY2hhbmdlcyB3aWxsIGJlIGxvc3QuIEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjb250aW51ZT8nLFxuICAgICAgICAgICAgQ29uZmlybURlbGV0ZTogJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBEZWxldGUgUmVjb3JkPycsXG4gICAgICAgICAgICBDYW5jZWxFZGl0OiAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIENhbmNlbCB0aGUgY2hhbmdlcz8nLFxuICAgICAgICAgICAgQ2hvb3NlQ29sdW1uczogJ0Nob29zZSBDb2x1bW4nLFxuICAgICAgICAgICAgQ29sdW1uTWVudTogJ0NvbHVtbiBNZW51JyxcbiAgICAgICAgICAgIFNlYXJjaENvbHVtbnM6ICdzZWFyY2ggY29sdW1ucycsXG4gICAgICAgICAgICBNYXRjaHM6ICdObyBtYXRjaGVzIGZvdW5kJyxcbiAgICAgICAgICAgIEZpbHRlckJ1dHRvbjogJ0ZpbHRlcicsXG4gICAgICAgICAgICBGaWx0ZXJUaXRsZTogJ0ZpbHRlcicsXG4gICAgICAgICAgICBGaWx0ZXJJY29uOiAnRmlsdGVyJyxcbiAgICAgICAgICAgIENsZWFyQnV0dG9uOiAnQ2xlYXInLFxuICAgICAgICAgICAgU3RhcnRzV2l0aDogJ1N0YXJ0cyBXaXRoJyxcbiAgICAgICAgICAgIE5vdFN0YXJ0c1dpdGg6ICdEb2VzIE5vdCBTdGFydCBXaXRoJyxcbiAgICAgICAgICAgIExpa2U6ICdMaWtlJyxcbiAgICAgICAgICAgIEVuZHNXaXRoOiAnRW5kcyBXaXRoJyxcbiAgICAgICAgICAgIE5vdEVuZHNXaXRoOiAnRG9lcyBOb3QgRW5kIFdpdGgnLFxuICAgICAgICAgICAgQ29udGFpbnM6ICdDb250YWlucycsXG4gICAgICAgICAgICBOb3RDb250YWluczogJ0RvZXMgTm90IENvbnRhaW4nLFxuICAgICAgICAgICAgSXNOdWxsOiAnTnVsbCcsXG4gICAgICAgICAgICBOb3ROdWxsOiAnTm90IE51bGwnLFxuICAgICAgICAgICAgSXNFbXB0eTogJ0VtcHR5JyxcbiAgICAgICAgICAgIElzTm90RW1wdHk6ICdOb3QgRW1wdHknLFxuICAgICAgICAgICAgRXF1YWw6ICdFcXVhbCcsXG4gICAgICAgICAgICBOb3RFcXVhbDogJ05vdCBFcXVhbCcsXG4gICAgICAgICAgICBMZXNzVGhhbjogJ0xlc3MgVGhhbicsXG4gICAgICAgICAgICBMZXNzVGhhbk9yRXF1YWw6ICdMZXNzIFRoYW4gT3IgRXF1YWwnLFxuICAgICAgICAgICAgR3JlYXRlclRoYW46ICdHcmVhdGVyIFRoYW4nLFxuICAgICAgICAgICAgR3JlYXRlclRoYW5PckVxdWFsOiAnR3JlYXRlciBUaGFuIE9yIEVxdWFsJyxcbiAgICAgICAgICAgIEluOiAnSW4nLFxuICAgICAgICAgICAgTm90SW46ICdOb3QgSW4nLFxuICAgICAgICAgICAgQ2hvb3NlRGF0ZTogJ0Nob29zZSBhIERhdGUnLFxuICAgICAgICAgICAgRW50ZXJWYWx1ZTogJ0VudGVyIHRoZSB2YWx1ZScsXG4gICAgICAgICAgICBDb3B5OiAnQ29weScsXG4gICAgICAgICAgICBHcm91cDogJ0dyb3VwIGJ5IHRoaXMgY29sdW1uJyxcbiAgICAgICAgICAgIFVuZ3JvdXA6ICdVbmdyb3VwIGJ5IHRoaXMgY29sdW1uJyxcbiAgICAgICAgICAgIEdyb3VwQnV0dG9uOiAnR3JvdXAgYnV0dG9uJyxcbiAgICAgICAgICAgIFVuR3JvdXBBcmlhOiAndW5ncm91cCBidXR0b24nLFxuICAgICAgICAgICAgR3JvdXBTZXBlcmF0b3I6ICdTZXBhcmF0b3IgZm9yIHRoZSBncm91cGVkIGNvbHVtbnMnLFxuICAgICAgICAgICAgVW5Hcm91cEljb246ICd1bmdyb3VwIHRoZSBncm91cGVkIGNvbHVtbiAnLFxuICAgICAgICAgICAgR3JvdXBlZFNvcnRJY29uOiAnc29ydCB0aGUgZ3JvdXBlZCBjb2x1bW4gJyxcbiAgICAgICAgICAgIEdyb3VwZWREcmFnOiAnRHJhZyB0aGUgZ3JvdXBlZCBjb2x1bW4nLFxuICAgICAgICAgICAgR3JvdXBDYXB0aW9uOiAnIGlzIGdyb3VwY2FwdGlvbiBjZWxsJyxcbiAgICAgICAgICAgIENoZWNrQm94TGFiZWw6ICdjaGVja2JveCcsXG4gICAgICAgICAgICBTZWxlY3RBbGxDaGVja2JveDogJ1NlbGVjdCBhbGwgY2hlY2tib3gnLFxuICAgICAgICAgICAgU2VsZWN0Um93OiAnU2VsZWN0IHJvdycsXG4gICAgICAgICAgICBhdXRvRml0QWxsOiAnQXV0b2ZpdCBhbGwgY29sdW1ucycsXG4gICAgICAgICAgICBhdXRvRml0OiAnQXV0b2ZpdCB0aGlzIGNvbHVtbicsXG4gICAgICAgICAgICBBdXRvRml0QWxsOiAnQXV0b2ZpdCBhbGwgY29sdW1ucycsXG4gICAgICAgICAgICBBdXRvRml0OiAnQXV0b2ZpdCB0aGlzIGNvbHVtbicsXG4gICAgICAgICAgICBFeHBvcnQ6ICdFeHBvcnQnLFxuICAgICAgICAgICAgRmlyc3RQYWdlOiAnRmlyc3QgUGFnZScsXG4gICAgICAgICAgICBMYXN0UGFnZTogJ0xhc3QgUGFnZScsXG4gICAgICAgICAgICBQcmV2aW91c1BhZ2U6ICdQcmV2aW91cyBQYWdlJyxcbiAgICAgICAgICAgIE5leHRQYWdlOiAnTmV4dCBQYWdlJyxcbiAgICAgICAgICAgIFNvcnRBc2NlbmRpbmc6ICdTb3J0IEFzY2VuZGluZycsXG4gICAgICAgICAgICBTb3J0RGVzY2VuZGluZzogJ1NvcnQgRGVzY2VuZGluZycsXG4gICAgICAgICAgICBFZGl0UmVjb3JkOiAnRWRpdCBSZWNvcmQnLFxuICAgICAgICAgICAgRGVsZXRlUmVjb3JkOiAnRGVsZXRlIFJlY29yZCcsXG4gICAgICAgICAgICBGaWx0ZXJNZW51OiAnRmlsdGVyJyxcbiAgICAgICAgICAgIFNlbGVjdEFsbDogJ1NlbGVjdCBBbGwnLFxuICAgICAgICAgICAgQWRkQ3VycmVudFNlbGVjdGlvbjogJ0FkZCBjdXJyZW50IHNlbGVjdGlvbiB0byBmaWx0ZXInLFxuICAgICAgICAgICAgQmxhbmtzOiAnQmxhbmtzJyxcbiAgICAgICAgICAgIEZpbHRlclRydWU6ICdUcnVlJyxcbiAgICAgICAgICAgIEZpbHRlckZhbHNlOiAnRmFsc2UnLFxuICAgICAgICAgICAgTm9SZXN1bHQ6ICdObyBtYXRjaGVzIGZvdW5kJyxcbiAgICAgICAgICAgIENsZWFyRmlsdGVyOiAnQ2xlYXIgRmlsdGVyJyxcbiAgICAgICAgICAgIENsZWFyOiAnQ2xlYXInLFxuICAgICAgICAgICAgTnVtYmVyRmlsdGVyOiAnTnVtYmVyIEZpbHRlcnMnLFxuICAgICAgICAgICAgVGV4dEZpbHRlcjogJ1RleHQgRmlsdGVycycsXG4gICAgICAgICAgICBEYXRlRmlsdGVyOiAnRGF0ZSBGaWx0ZXJzJyxcbiAgICAgICAgICAgIERhdGVUaW1lRmlsdGVyOiAnRGF0ZVRpbWUgRmlsdGVycycsXG4gICAgICAgICAgICBNYXRjaENhc2U6ICdNYXRjaCBDYXNlJyxcbiAgICAgICAgICAgIEJldHdlZW46ICdCZXR3ZWVuJyxcbiAgICAgICAgICAgIEN1c3RvbUZpbHRlcjogJ0N1c3RvbSBGaWx0ZXInLFxuICAgICAgICAgICAgQ3VzdG9tRmlsdGVyUGxhY2VIb2xkZXI6ICdFbnRlciB0aGUgdmFsdWUnLFxuICAgICAgICAgICAgQ3VzdG9tRmlsdGVyRGF0ZVBsYWNlSG9sZGVyOiAnQ2hvb3NlIGEgZGF0ZScsXG4gICAgICAgICAgICBBTkQ6ICdBTkQnLFxuICAgICAgICAgICAgT1I6ICdPUicsXG4gICAgICAgICAgICBTaG93Um93c1doZXJlOiAnU2hvdyByb3dzIHdoZXJlOicsXG4gICAgICAgICAgICBUb29sYmFyTWVudURpYWxvZ0FSSUE6ICdUb29sYmFyIG1lbnUgZGlhbG9nJyxcbiAgICAgICAgICAgIEZpbHRlck1lbnVEaWFsb2dBUklBOiAnRmlsdGVyIG1lbnUnLFxuICAgICAgICAgICAgRXhjZWxGaWx0ZXJEaWFsb2dBUklBOiAnRXhjZWwgZmlsdGVyJyxcbiAgICAgICAgICAgIENoZWNrQm94RmlsdGVyRGlhbG9nQVJJQTogJ0NoZWNrYm94IGZpbHRlcicsXG4gICAgICAgICAgICBEaWFsb2dFZGl0QVJJQTogJ0VkaXQgZGlhbG9nJyxcbiAgICAgICAgICAgIENvbHVtbk1lbnVEaWFsb2dBUklBOiAnQ29sdW1uIG1lbnUgZGlhbG9nJyxcbiAgICAgICAgICAgIEN1c3RvbUZpbHRlckRpYWxvZ0FSSUE6ICdDdXN0b21lciBmaWx0ZXIgZGlhbG9nJyxcbiAgICAgICAgICAgIFNvcnRBdG9aOiAnU29ydCBBIHRvIFonLFxuICAgICAgICAgICAgU29ydFp0b0E6ICdTb3J0IFogdG8gQScsXG4gICAgICAgICAgICBTb3J0QnlPbGRlc3Q6ICdTb3J0IGJ5IE9sZGVzdCcsXG4gICAgICAgICAgICBTb3J0QnlOZXdlc3Q6ICdTb3J0IGJ5IE5ld2VzdCcsXG4gICAgICAgICAgICBTb3J0U21hbGxlc3RUb0xhcmdlc3Q6ICdTb3J0IFNtYWxsZXN0IHRvIExhcmdlc3QnLFxuICAgICAgICAgICAgU29ydExhcmdlc3RUb1NtYWxsZXN0OiAnU29ydCBMYXJnZXN0IHRvIFNtYWxsZXN0JyxcbiAgICAgICAgICAgIFNvcnQ6ICdTb3J0JyxcbiAgICAgICAgICAgIFNvcnRJY29uOiAnU29ydCcsXG4gICAgICAgICAgICBGaWx0ZXJEZXNjcmlwdGlvbjogJ1ByZXNzIEFsdCBEb3duIHRvIG9wZW4gZmlsdGVyIE1lbnUnLFxuICAgICAgICAgICAgU29ydERlc2NyaXB0aW9uOiAnUHJlc3MgRW50ZXIgdG8gc29ydCcsXG4gICAgICAgICAgICBDb2x1bW5NZW51RGVzY3JpcHRpb246ICdQcmVzcyBBbHQgRG93biB0byBvcGVuIENvbHVtbiBNZW51JyxcbiAgICAgICAgICAgIEdyb3VwRGVzY3JpcHRpb246ICdQcmVzcyBDdHJsIHNwYWNlIHRvIGdyb3VwJyxcbiAgICAgICAgICAgIENvbHVtbkhlYWRlcjogJyBjb2x1bW4gaGVhZGVyICcsXG4gICAgICAgICAgICBUZW1wbGF0ZUNlbGw6ICcgaXMgdGVtcGxhdGUgY2VsbCcsXG4gICAgICAgICAgICBDb21tYW5kQ29sdW1uQXJpYTogJ2lzIENvbW1hbmQgY29sdW1uIGNvbHVtbiBoZWFkZXIgJyxcbiAgICAgICAgICAgIERpYWxvZ0VkaXQ6ICdEaWFsb2cgZWRpdCcsXG4gICAgICAgICAgICBDbGlwQm9hcmQ6ICdjbGlwYm9hcmQnLFxuICAgICAgICAgICAgQXNjZW5kaW5nVGV4dDogJ0FzY2VuZGluZycsXG4gICAgICAgICAgICBEZXNjZW5kaW5nVGV4dDogJ0Rlc2NlbmRpbmcnLFxuICAgICAgICAgICAgTm9uZVRleHQ6ICdOb25lJyxcbiAgICAgICAgICAgIEV4cGFuZGVkOiAnRXhwYW5kZWQnLFxuICAgICAgICAgICAgQ29sbGFwc2VkOiAnQ29sbGFwc2VkJ1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmtleUNvbmZpZ3MgPSB7XG4gICAgICAgICAgICBkb3duQXJyb3c6ICdkb3duYXJyb3cnLFxuICAgICAgICAgICAgdXBBcnJvdzogJ3VwYXJyb3cnLFxuICAgICAgICAgICAgcmlnaHRBcnJvdzogJ3JpZ2h0YXJyb3cnLFxuICAgICAgICAgICAgbGVmdEFycm93OiAnbGVmdGFycm93JyxcbiAgICAgICAgICAgIHNoaWZ0RG93bjogJ3NoaWZ0K2Rvd25hcnJvdycsXG4gICAgICAgICAgICBzaGlmdFVwOiAnc2hpZnQrdXBhcnJvdycsXG4gICAgICAgICAgICBzaGlmdFJpZ2h0OiAnc2hpZnQrcmlnaHRhcnJvdycsXG4gICAgICAgICAgICBzaGlmdExlZnQ6ICdzaGlmdCtsZWZ0YXJyb3cnLFxuICAgICAgICAgICAgaG9tZTogJ2hvbWUnLFxuICAgICAgICAgICAgZW5kOiAnZW5kJyxcbiAgICAgICAgICAgIGVzY2FwZTogJ2VzY2FwZScsXG4gICAgICAgICAgICBjdHJsSG9tZTogJ2N0cmwraG9tZScsXG4gICAgICAgICAgICBjdHJsRW5kOiAnY3RybCtlbmQnLFxuICAgICAgICAgICAgcGFnZVVwOiAncGFnZXVwJyxcbiAgICAgICAgICAgIHBhZ2VEb3duOiAncGFnZWRvd24nLFxuICAgICAgICAgICAgY3RybEFsdFBhZ2VVcDogJ2N0cmwrYWx0K3BhZ2V1cCcsXG4gICAgICAgICAgICBjdHJsQWx0UGFnZURvd246ICdjdHJsK2FsdCtwYWdlZG93bicsXG4gICAgICAgICAgICBhbHRQYWdlVXA6ICdhbHQrcGFnZXVwJyxcbiAgICAgICAgICAgIGFsdFBhZ2VEb3duOiAnYWx0K3BhZ2Vkb3duJyxcbiAgICAgICAgICAgIGFsdERvd25BcnJvdzogJ2FsdCtkb3duYXJyb3cnLFxuICAgICAgICAgICAgYWx0VXBBcnJvdzogJ2FsdCt1cGFycm93JyxcbiAgICAgICAgICAgIGN0cmxEb3duQXJyb3c6ICdjdHJsK2Rvd25hcnJvdycsXG4gICAgICAgICAgICBjdHJsVXBBcnJvdzogJ2N0cmwrdXBhcnJvdycsXG4gICAgICAgICAgICBjdHJsUGx1c0E6ICdjdHJsK0EnLFxuICAgICAgICAgICAgY3RybFBsdXNQOiAnY3RybCtQJyxcbiAgICAgICAgICAgIGluc2VydDogJ2luc2VydCcsXG4gICAgICAgICAgICBkZWxldGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgZjI6ICdmMicsXG4gICAgICAgICAgICBlbnRlcjogJ2VudGVyJyxcbiAgICAgICAgICAgIGN0cmxFbnRlcjogJ2N0cmwrZW50ZXInLFxuICAgICAgICAgICAgc2hpZnRFbnRlcjogJ3NoaWZ0K2VudGVyJyxcbiAgICAgICAgICAgIHRhYjogJ3RhYicsXG4gICAgICAgICAgICBzaGlmdFRhYjogJ3NoaWZ0K3RhYicsXG4gICAgICAgICAgICBzcGFjZTogJ3NwYWNlJyxcbiAgICAgICAgICAgIGN0cmxQbHVzQzogJ2N0cmwrQycsXG4gICAgICAgICAgICBjdHJsU2hpZnRQbHVzSDogJ2N0cmwrc2hpZnQrSCcsXG4gICAgICAgICAgICBjdHJsU3BhY2U6ICdjdHJsK3NwYWNlJyxcbiAgICAgICAgICAgIGN0cmxMZWZ0QXJyb3c6ICdjdHJsK2xlZnRhcnJvdycsXG4gICAgICAgICAgICBjdHJsUmlnaHRBcnJvdzogJ2N0cmwrcmlnaHRhcnJvdydcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZvciBpbnRlcm5hbCB1c2Ugb25seSAtIFRvIEluaXRpYWxpemUgdGhlIGNvbXBvbmVudCByZW5kZXJpbmcuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5sb2coWydtb2R1bGVfbWlzc2luZycsICdwcm9taXNlX2VuYWJsZWQnLCAnbG9jYWxlX21pc3NpbmcnLCAnY2hlY2tfZGF0YXNvdXJjZV9jb2x1bW5zJ10pO1xuICAgICAgICB0aGlzLmFyaWFTZXJ2aWNlLnNldE9wdGlvbnModGhpcy5lbGVtZW50LCB7IHJvbGU6ICdncmlkJyB9KTtcbiAgICAgICAgY3JlYXRlU3Bpbm5lcih7IHRhcmdldDogdGhpcy5lbGVtZW50LCBjc3NDbGFzczogdGhpcy5jc3NDbGFzcyA/IHRoaXMuY3NzQ2xhc3MgOiBudWxsIH0sIHRoaXMuY3JlYXRlRWxlbWVudCk7XG4gICAgICAgIHRoaXMucmVuZGVyTW9kdWxlID0gbmV3IFJlbmRlcih0aGlzLCB0aGlzLnNlcnZpY2VMb2NhdG9yKTtcbiAgICAgICAgdGhpcy5zZWFyY2hNb2R1bGUgPSBuZXcgU2VhcmNoKHRoaXMpO1xuICAgICAgICB0aGlzLnNjcm9sbE1vZHVsZSA9IG5ldyBTY3JvbGwodGhpcyk7XG4gICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5pbml0aWFsTG9hZCwge30pO1xuICAgICAgICBpZiAodGhpcy5wYWdlU2V0dGluZ3MuZW5hYmxlUXVlcnlTdHJpbmcpIHtcbiAgICAgICAgICAgIHZhciBwYWdlVmFsdWUgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKS5zZWFyY2hQYXJhbXMuZ2V0KCdwYWdlJyk7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHBhZ2VWYWx1ZSkgJiYgd2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZignP3BhZ2U9JykgPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRQYWdlVmFsdWUgPSBwYXJzZUludChwYWdlVmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyBwYWdlU2V0dGluZ3M6IHsgY3VycmVudFBhZ2U6IGN1cnJlbnRQYWdlVmFsdWUgfSB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZSA9IGN1cnJlbnRQYWdlVmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCh0aGlzLmdldERhdGFNb2R1bGUoKS5kYXRhTWFuYWdlci5kYXRhU291cmNlLm9mZmxpbmUgPT09IHRydWUgfHwgdGhpcy5nZXREYXRhTW9kdWxlKCkuZGF0YU1hbmFnZXIuZGF0YVNvdXJjZS51cmwgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICYmICEoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZGF0YVNvdXJjZSkgJiYgdGhpcy5kYXRhU291cmNlLnJlc3VsdCkpIHtcbiAgICAgICAgICAgIHRoaXMuaXNWaXJ0dWFsQWRhcHRpdmUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFnZ3JlZ2F0ZU1vZHVsZSAmJiB0aGlzLmFnZ3JlZ2F0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYWdncmVnYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5hZ2dyZWdhdGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2x1bW4gPSB0aGlzLmFnZ3JlZ2F0ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sdW1uWyd0eXBlcyddKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW4udHlwZSA9IGNvbHVtblsndHlwZXMnXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc1JlYWN0KSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IHsgcmVxdWlyZVRlbXBsYXRlUmVmOiB0aGlzLnJlcXVpcmVUZW1wbGF0ZVJlZiB9O1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKGV2ZW50cy5sb2FkLCBhcmdzKTtcbiAgICAgICAgICAgIGlmICghYXJncy5yZXF1aXJlVGVtcGxhdGVSZWYpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcXVpcmVUZW1wbGF0ZVJlZiA9IGFyZ3MucmVxdWlyZVRlbXBsYXRlUmVmO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKGV2ZW50cy5sb2FkKTtcbiAgICAgICAgfVxuICAgICAgICBwcmVwYXJlQ29sdW1ucyh0aGlzLmNvbHVtbnMsIHRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24sIHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJiB0aGlzLmlzQ2hhbmdlRGF0YVNvdXJjZUNhbGwgJiYgdGhpcy5jb2x1bW5Nb2RlbCkge1xuICAgICAgICAgICAgdGhpcy5jb2x1bW5Nb2RlbCA9IFtdO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVDb2x1bW5Nb2RlbCh0aGlzLmNvbHVtbnMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNQcmVwYXJlZEZyb3plbkNvbHVtbnMgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5lbmFibGVQZXJzaXN0ZW5jZSkge1xuICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLmNvbHVtbnNQcmVwYXJlZCwge30pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ2V0TWVkaWFDb2x1bW5zKCk7XG4gICAgICAgIHNldENvbHVtbkluZGV4KHRoaXMuY29sdW1ucyk7XG4gICAgICAgIGlmICh0aGlzLmlzRnJvemVuR3JpZCgpICYmICF0aGlzLm1lcmdlZENvbHVtbnMpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0SW5pdGlhbEZyb3plbkNvbHVtbkluZGV4KHRoaXMuY29sdW1ucyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jaGVja0xvY2tDb2x1bW5zKHRoaXMuY29sdW1ucyk7XG4gICAgICAgIHRoaXMuZ2V0Q29sdW1ucygpO1xuICAgICAgICB0aGlzLnByb2Nlc3NNb2RlbCgpO1xuICAgICAgICB0aGlzLmdyaWRSZW5kZXIoKTtcbiAgICAgICAgdGhpcy53aXJlRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuYWRkTGlzdGVuZXIoKTtcbiAgICAgICAgdGhpcy51cGRhdGVEZWZhdWx0Q3Vyc29yKCk7XG4gICAgICAgIHRoaXMudXBkYXRlU3RhY2tlZEZpbHRlcigpO1xuICAgICAgICBpZiAodGhpcy5sb2FkaW5nSW5kaWNhdG9yLmluZGljYXRvclR5cGUgPT09ICdTcGlubmVyJykge1xuICAgICAgICAgICAgdGhpcy5zaG93U3Bpbm5lcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5pbml0aWFsRW5kLCB7fSk7XG4gICAgICAgIGlmICh0aGlzLmxvYWRpbmdJbmRpY2F0b3IuaW5kaWNhdG9yVHlwZSA9PT0gJ1NoaW1tZXInKSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hNYXNrUm93KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVmcmVzaGluZykge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdjcmVhdGVkJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnNldEluaXRpYWxGcm96ZW5Db2x1bW5JbmRleCA9IGZ1bmN0aW9uIChjb2x1bW5zKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNvbHVtbiA9IGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgY29sdW1uW1wiXCIgKyBsaXRlcmFscy5pbml0aWFsRnJvemVuQ29sdW1uSW5kZXhdID0gY29sdW1uLmluZGV4O1xuICAgICAgICAgICAgaWYgKGNvbHVtbi5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRJbml0aWFsRnJvemVuQ29sdW1uSW5kZXgoY29sdW1uLmNvbHVtbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBCeSBkZWZhdWx0LCBncmlkIHNob3dzIHRoZSBzcGlubmVyIGZvciBhbGwgaXRzIGFjdGlvbnMuIFlvdSBjYW4gdXNlIHRoaXMgbWV0aG9kIHRvIHNob3cgc3Bpbm5lciBhdCB5b3VyIG5lZWRlZCB0aW1lLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2hvd1NwaW5uZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0V4cG9ydEdyaWQpIHtcbiAgICAgICAgICAgIHNob3dTcGlubmVyKHRoaXMuZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEJ5IGRlZmF1bHQsIGdyaWQgc2hvd3MgdGhlIHNwaW5uZXIgZm9yIGFsbCBpdHMgYWN0aW9ucy4gWW91IGNhbiB1c2UgdGhpcyBtZXRob2QgdG8gc2hvdyBzcGlubmVyIGF0IHlvdXIgbmVlZGVkIHRpbWUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5oaWRlU3Bpbm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzRXhwb3J0R3JpZCkge1xuICAgICAgICAgICAgaGlkZVNwaW5uZXIodGhpcy5lbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuc2hvd01hc2tSb3cgPSBmdW5jdGlvbiAoYXhpc0RpcmVjdGlvbiwgZGlhbG9nRWxlbWVudCkge1xuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQodGhpcy5oZWFkZXJNb2R1bGUpIHx8IGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuY29udGVudE1vZHVsZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ3JpZEhlYWRlciA9IHRoaXMuZ2V0SGVhZGVyQ29udGVudCgpLmZpcnN0Q2hpbGQ7XG4gICAgICAgIHZhciBncmlkQ29udGVudCA9IHRoaXMuZ2V0Q29udGVudCgpLmZpcnN0Q2hpbGQ7XG4gICAgICAgIHZhciBncmlkRm9vdGVyID0gdGhpcy5nZXRGb290ZXJDb250ZW50KCk7XG4gICAgICAgIGlmIChkaWFsb2dFbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgZGlhbG9nSG9sZGVyID0gZGlhbG9nRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1jaGVja2JveGxpc3QnKTtcbiAgICAgICAgICAgIHZhciBtYXNrUm93Q291bnQgPSBNYXRoLmZsb29yKGRpYWxvZ0hvbGRlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLyB0aGlzLmdldFJvd0hlaWdodCgpKTtcbiAgICAgICAgICAgIHZhciBtYXNrVGVtcGxhdGUgPSAnPGRpdiBjbGFzcz1cImUtZnRyY2hrIGUtbWFzay1mdHJjaGtcIj4nXG4gICAgICAgICAgICAgICAgKyAnPGRpdiBjbGFzcz1cImUtY2hlY2tib3gtd3JhcHBlclwiPjxpbnB1dCBjbGFzcz1cImUtY2hrLWhpZGRlblwiPidcbiAgICAgICAgICAgICAgICArIHRoaXMuZ2V0U2hpbW1lclRlbXBsYXRlKCkgKyB0aGlzLmdldFNoaW1tZXJUZW1wbGF0ZSgpICsgJzwvZGl2PjwvZGl2Pic7XG4gICAgICAgICAgICBkaWFsb2dIb2xkZXIuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hc2tSb3dDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZGlhbG9nSG9sZGVyLmlubmVySFRNTCArPSBtYXNrVGVtcGxhdGU7XG4gICAgICAgICAgICAgICAgZGlhbG9nSG9sZGVyLnF1ZXJ5U2VsZWN0b3IoJy5lLWZ0cmNoay5lLW1hc2stZnRyY2hrJykuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgICAgICAgICAgZGlhbG9nSG9sZGVyLnF1ZXJ5U2VsZWN0b3IoJy5lLWNoZWNrYm94LXdyYXBwZXInKS5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICAgICAgICAgICAgICB2YXIgbWFza1NwYW4gPSBbXS5zbGljZS5jYWxsKGRpYWxvZ0hvbGRlclxuICAgICAgICAgICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbCgnLmUtbWFzazpub3QoLmUtbWFzay1jaGVja2JveC1maWx0ZXItaW50ZW50KTpub3QoLmUtbWFzay1jaGVja2JveC1maWx0ZXItc3Bhbi1pbnRlbnQpJykpO1xuICAgICAgICAgICAgICAgIG1hc2tTcGFuWzBdLmNsYXNzTGlzdC5hZGQoJ2UtbWFzay1jaGVja2JveC1maWx0ZXItaW50ZW50Jyk7XG4gICAgICAgICAgICAgICAgbWFza1NwYW5bMV0uY2xhc3NMaXN0LmFkZCgnZS1tYXNrLWNoZWNrYm94LWZpbHRlci1zcGFuLWludGVudCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICgoIXRoaXMuZW5hYmxlUnRsICYmICF0aGlzLmdldEhlYWRlckNvbnRlbnQoKS5zdHlsZS5wYWRkaW5nUmlnaHQpXG4gICAgICAgICAgICB8fCAodGhpcy5lbmFibGVSdGwgJiYgIXRoaXMuZ2V0SGVhZGVyQ29udGVudCgpLnN0eWxlLnBhZGRpbmdMZWZ0KSkge1xuICAgICAgICAgICAgZ3JpZENvbnRlbnQuc3R5bGUub3ZlcmZsb3dZID0gJ2hpZGRlbic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmlzSW5pdGlhbExvYWQgJiYgIXRoaXMuZ2V0Q29sdW1ucygpLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGNvbnRlbnRIZWlnaHQgPSBncmlkQ29udGVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XG4gICAgICAgICAgICB2YXIgbWFza1RhYmxlSGVpZ2h0ID0gY29udGVudEhlaWdodCA9PT0gMCA/IHRoaXMuYWxsb3dQYWdpbmcgPyB0aGlzLnBhZ2VTZXR0aW5ncy5wYWdlU2l6ZSAqIHRoaXMuZ2V0Um93SGVpZ2h0KClcbiAgICAgICAgICAgICAgICA6IHdpbmRvdy5pbm5lckhlaWdodCA6IGNvbnRlbnRIZWlnaHQ7XG4gICAgICAgICAgICB2YXIgY29udGVudFJvd0NvdW50ID0gTWF0aC5jZWlsKG1hc2tUYWJsZUhlaWdodCAvIHRoaXMuZ2V0Um93SGVpZ2h0KCkpO1xuICAgICAgICAgICAgaWYgKHRoaXMucm93UmVuZGVyaW5nTW9kZSAhPT0gJ1ZlcnRpY2FsJykge1xuICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyTWFza1RhYmxlID0gdGhpcy5jcmVhdGVFbXB0eU1hc2tUYWJsZShncmlkSGVhZGVyLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29udGVudE1hc2tUYWJsZSA9IHRoaXMuY3JlYXRlRW1wdHlNYXNrVGFibGUoZ3JpZENvbnRlbnQsIGNvbnRlbnRSb3dDb3VudCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tYXNrUm93Q29udGVudFNjcm9sbCA9ICh0aGlzLmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8IHRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pICYmIGF4aXNEaXJlY3Rpb24gPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIGlmICghdGhpcy5jb250ZW50TWFza1RhYmxlKSB7XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IGdyaWRDb250ZW50O1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlVmlydHVhbGl6YXRpb24gfHwgdGhpcy5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbikge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXZpcnR1YWx0YWJsZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjb250ZW50LnF1ZXJ5U2VsZWN0b3IoJ3Rib2R5JykpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50TWFza1RhYmxlID0gdGhpcy5jcmVhdGVNYXNrVGFibGUoY29udGVudCwgdGhpcy5nZXRDb250ZW50TWFza0NvbHVtbnMoKSwgYXhpc0RpcmVjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmhlYWRlck1hc2tUYWJsZSAmJiAodGhpcy5pc0Zyb3plbkdyaWQoKSB8fCAodGhpcy5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJiBheGlzRGlyZWN0aW9uID09PSAnWCcpKSkge1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBncmlkSGVhZGVyO1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgYXhpc0RpcmVjdGlvbiA9PT0gJ1gnKSB7XG4gICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucXVlcnlTZWxlY3RvcignLmUtdmlydHVhbHRhYmxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmhlYWRlck1hc2tUYWJsZSA9IHRoaXMuY3JlYXRlTWFza1RhYmxlKGNvbnRlbnQsIHRoaXMuZ2V0Q29udGVudE1hc2tDb2x1bW5zKCksIGF4aXNEaXJlY3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChncmlkRm9vdGVyICYmIGdyaWRGb290ZXIucXVlcnlTZWxlY3RvcignLmUtc3VtbWFyeXJvdycpKSB7XG4gICAgICAgICAgICB2YXIgZ3JpZEZvb3RlckNvbnRlbnQgPSBncmlkRm9vdGVyLmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZm9vdGVyQ29udGVudE1hc2tUYWJsZSkge1xuICAgICAgICAgICAgICAgIHZhciBmb290ZXJDb250ZW50ID0gZ3JpZEZvb3RlckNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5mb290ZXJDb250ZW50TWFza1RhYmxlID0gdGhpcy5jcmVhdGVNYXNrVGFibGUoZm9vdGVyQ29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEodGhpcy5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiBheGlzRGlyZWN0aW9uKSkge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZChncmlkQ29udGVudCwgJ3Njcm9sbCcsIHRoaXMudHJhbnNsYXRlTWFza1JvdywgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmdldENvbnRlbnRNYXNrQ29sdW1ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29sdW1ucygpO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuY3JlYXRlRW1wdHlNYXNrVGFibGUgPSBmdW5jdGlvbiAobWFza0VsZW1lbnQsIHJvd0NvdW50KSB7XG4gICAgICAgIHZhciB0YWJsZSA9IHRoaXMuY3JlYXRlRWxlbWVudCgndGFibGUnLCB7IGNsYXNzTmFtZTogJ2UtdGFibGUgZS1tYXNrZWQtdGFibGUnIH0pO1xuICAgICAgICB2YXIgdGJvZHkgPSB0aGlzLmNyZWF0ZUVsZW1lbnQoJ3Rib2R5JywgeyBjbGFzc05hbWU6ICdlLW1hc2tlZC10Ym9keScgfSk7XG4gICAgICAgIHZhciByb3cgPSB0aGlzLmNyZWF0ZUVsZW1lbnQoJ3RyJywgeyBjbGFzc05hbWU6ICdlLW1hc2tlZC1yb3cgZS1yb3cnIH0pO1xuICAgICAgICByb3cuc3R5bGUuaGVpZ2h0ID0gdGhpcy5nZXRSb3dIZWlnaHQoKSArIFwicHhcIjtcbiAgICAgICAgdmFyIGNlbGwgPSB0aGlzLmNyZWF0ZUVsZW1lbnQoJ3RkJywgeyBjbGFzc05hbWU6ICdlLW1hc2tlZC1jZWxsIGUtcm93Y2VsbCcgfSk7XG4gICAgICAgIGNlbGwuaW5uZXJIVE1MID0gdGhpcy5nZXRTaGltbWVyVGVtcGxhdGUoKTtcbiAgICAgICAgcm93LmFwcGVuZENoaWxkKGNlbGwpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd0NvdW50OyBpKyspIHtcbiAgICAgICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvdy5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIHRhYmxlLmFwcGVuZENoaWxkKHRib2R5KTtcbiAgICAgICAgbWFza0VsZW1lbnQuYXBwZW5kQ2hpbGQodGFibGUpO1xuICAgICAgICByZXR1cm4gdGFibGU7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5jcmVhdGVNYXNrVGFibGUgPSBmdW5jdGlvbiAoZWxlbWVudCwgY29sdW1ucywgYXhpc0RpcmVjdGlvbikge1xuICAgICAgICB2YXIgcGFyZW50RWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHZhciBoZWFkZXIgPSBjbG9zZXN0KHBhcmVudEVsZW1lbnQsICcuZS1ncmlkaGVhZGVyJykgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIHZhciBjb250ZW50ID0gY2xvc2VzdChwYXJlbnRFbGVtZW50LCAnLmUtZ3JpZGNvbnRlbnQnKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgdmFyIGZvb3RlciA9IGNsb3Nlc3QocGFyZW50RWxlbWVudCwgJy5lLWdyaWRmb290ZXInKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgdmFyIGdyaWRDb250ZW50ID0gdGhpcy5nZXRDb250ZW50KCkuZmlyc3RDaGlsZDtcbiAgICAgICAgdmFyIGdyaWRDb250ZW50U2Nyb2xsSGVpZ2h0ID0gZ3JpZENvbnRlbnQuc2Nyb2xsSGVpZ2h0O1xuICAgICAgICB2YXIgdGFibGUgPSBwYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RhYmxlJyk7XG4gICAgICAgIHZhciBtYXNrVGFibGUgPSB0YWJsZS5jbG9uZU5vZGUoKTtcbiAgICAgICAgbWFza1RhYmxlLnJlbW92ZUF0dHJpYnV0ZSgncm9sZScpO1xuICAgICAgICBtYXNrVGFibGUucmVtb3ZlQXR0cmlidXRlKCdpZCcpO1xuICAgICAgICB1cGRhdGVDU1NUZXh0KG1hc2tUYWJsZSwgXCJwb3NpdGlvbjogYWJzb2x1dGU7IHotaW5kZXg6IDU7IHdpZHRoOiBcIiArIHRhYmxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoICsgXCJweDtcIik7XG4gICAgICAgIGlmIChoZWFkZXIgJiYgISh0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uICYmIGF4aXNEaXJlY3Rpb24gPT09ICdYJykpIHtcbiAgICAgICAgICAgIG1hc2tUYWJsZS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlKDBweCwnXG4gICAgICAgICAgICAgICAgKyB0YWJsZS5xdWVyeVNlbGVjdG9yKCd0aGVhZCcpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCArICdweCknO1xuICAgICAgICB9XG4gICAgICAgIG1hc2tUYWJsZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2UtdGFibGUgZS1tYXNrZWQtdGFibGUnKTtcbiAgICAgICAgdmFyIG1hc2tDb2xncm91cCA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3IoJ2NvbGdyb3VwJykuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICBtYXNrQ29sZ3JvdXAucmVtb3ZlQXR0cmlidXRlKCdpZCcpO1xuICAgICAgICBtYXNrQ29sZ3JvdXAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdlLW1hc2tlZC1jb2xncm91cCcpO1xuICAgICAgICBtYXNrVGFibGUuYXBwZW5kQ2hpbGQobWFza0NvbGdyb3VwKTtcbiAgICAgICAgaWYgKGhlYWRlciAmJiB0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uICYmIGF4aXNEaXJlY3Rpb24gPT09ICdYJykge1xuICAgICAgICAgICAgdmFyIHJvdyA9IHRoaXMuY3JlYXRlTWFza1JvdyhtYXNrQ29sZ3JvdXAsIGNvbHVtbnMpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJ6VGQgPSBbXS5zbGljZS5jYWxsKHJvdy5xdWVyeVNlbGVjdG9yQWxsKCcuZS1yb3djZWxsJykpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnJ6VGQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCB0aGlzLmZyb3plbkxlZnRDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZnJvemVuTGVmdENvdW50IC0gMSA9PT0gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyelRkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuYWRkKCdlLWZyZWV6ZWxlZnRib3JkZXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZyelRkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuYWRkKCdlLWxlZnRmcmVlemUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyelRkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnLCAoaSArIDEpLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJ6VGRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnN0eWxlLmxlZnQgPSAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmFsdWVYIC1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zbGF0ZVgpICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgoZnJ6VGQubGVuZ3RoIC0gdGhpcy5mcm96ZW5SaWdodENvdW50KSA8PSBpICYmIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGZyelRkLmxlbmd0aCAtIHRoaXMuZnJvemVuUmlnaHRDb3VudCkgPT09IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcnpUZFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZCgnZS1mcmVlemVyaWdodGJvcmRlcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZnJ6VGRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5hZGQoJ2UtcmlnaHRmcmVlemUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyelRkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnLCAoaSArIDEpLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJ6VGRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnN0eWxlLnJpZ2h0ID0gKHRoaXMudHJhbnNsYXRlWCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmFsdWVYKSArICdweCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGhlYWQgPSB0YWJsZS5xdWVyeVNlbGVjdG9yKCd0aGVhZCcpO1xuICAgICAgICAgICAgdmFyIHJvd3MgPSBbXS5zbGljZS5jYWxsKHRoZWFkLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyJykpO1xuICAgICAgICAgICAgdmFyIG1hc2tUSGVhZCA9IHRoZWFkLmNsb25lTm9kZSgpO1xuICAgICAgICAgICAgbWFza1RIZWFkLnJlbW92ZUF0dHJpYnV0ZSgncm9sZScpO1xuICAgICAgICAgICAgbWFza1RIZWFkLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnZS1tYXNrZWQtdGhlYWQnKTtcbiAgICAgICAgICAgIHZhciByb3dDb3VudCA9IHJvd3MubGVuZ3RoO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByb3dDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbWFza1RIZWFkLmFwcGVuZENoaWxkKHJvdy5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgICAgICAgICAgICAgIG1hc2tUSGVhZC5jaGlsZE5vZGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5zdHlsZVxuICAgICAgICAgICAgICAgICAgICAuaGVpZ2h0ID0gcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1hc2tUYWJsZS5hcHBlbmRDaGlsZChtYXNrVEhlYWQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtYXNrVEJvZHkgPSB0YWJsZS5xdWVyeVNlbGVjdG9yKCd0Ym9keScpLmNsb25lTm9kZSgpO1xuICAgICAgICBtYXNrVEJvZHkucmVtb3ZlQXR0cmlidXRlKCdyb2xlJyk7XG4gICAgICAgIG1hc2tUQm9keS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2UtbWFza2VkLXRib2R5Jyk7XG4gICAgICAgIHZhciB0Ym9keSA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3IoJ3Rib2R5Jyk7XG4gICAgICAgIGlmIChjb250ZW50IHx8IGhlYWRlcikge1xuICAgICAgICAgICAgdmFyIHJvd0NvdW50RWxlbWVudCA9IGdyaWRDb250ZW50O1xuICAgICAgICAgICAgdmFyIHJvd0NvdW50ID0gTWF0aC5jZWlsKHJvd0NvdW50RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLyB0aGlzLmdldFJvd0hlaWdodCgpKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmFsbG93UGFnaW5nICYmIHRoaXMucGFnZVNldHRpbmdzLnBhZ2VTaXplICE9PSB0aGlzLmN1cnJlbnRWaWV3RGF0YS5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2VyTW9kdWxlLnBhZ2VyT2JqLnRvdGFsUGFnZXMgIT09IHRoaXMucGFnZVNldHRpbmdzLmN1cnJlbnRQYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvdyA9IHRoaXMuY3JlYXRlTWFza1JvdyhtYXNrQ29sZ3JvdXAsIGNvbHVtbnMpO1xuICAgICAgICAgICAgICAgIHZhciBhbHRSb3cgPSByb3cuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICAgICAgICAgIGFsdFJvdy5jbGFzc0xpc3QuYWRkKCdlLWFsdHJvdycpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wYWdlU2V0dGluZ3MucGFnZVNpemUgLSB0aGlzLmN1cnJlbnRWaWV3RGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBtYXNrVEJvZHkuYXBwZW5kQ2hpbGQoKGkgJSAyID09PSAxKSA/IGFsdFJvdy5jbG9uZU5vZGUodHJ1ZSkgOiByb3cuY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGJvZHkucXVlcnlTZWxlY3RvcignLmUtZW1wdHlyb3cnKSB8fCAhdGJvZHkuY2hpbGROb2Rlcy5sZW5ndGggfHwgKGNvbnRlbnQgJiYgdGhpcy5jaGlsZEdyaWQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvdyA9IHRoaXMuY3JlYXRlTWFza1JvdyhtYXNrQ29sZ3JvdXAsIGNvbHVtbnMpO1xuICAgICAgICAgICAgICAgIHZhciBhbHRSb3cgPSByb3cuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICAgICAgICAgIGFsdFJvdy5jbGFzc0xpc3QuYWRkKCdlLWFsdHJvdycpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm93Q291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWx0TnVtYmVyID0gMTtcbiAgICAgICAgICAgICAgICAgICAgbWFza1RCb2R5LmFwcGVuZENoaWxkKChpICsgYWx0TnVtYmVyKSAlIDIgPT09IDAgPyBhbHRSb3cuY2xvbmVOb2RlKHRydWUpIDogcm93LmNsb25lTm9kZSh0cnVlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvd3NRdWVyeSA9ICd0cjpub3QoLmUtaGlkZSk6bm90KFtzdHlsZSo9XCJkaXNwbGF5Om5vbmVcIl0pOm5vdChbc3R5bGUqPVwiZGlzcGxheTogbm9uZVwiXSknO1xuICAgICAgICAgICAgICAgIHZhciByb3dzID0gW10uc2xpY2UuY2FsbCh0Ym9keS5xdWVyeVNlbGVjdG9yQWxsKHJvd3NRdWVyeSkpO1xuICAgICAgICAgICAgICAgIHZhciBhZGRFZGl0Um93ID0gdGJvZHkucXVlcnlTZWxlY3RvcignLmUtYWRkZWRyb3csIC5lLWVkaXRlZHJvdycpO1xuICAgICAgICAgICAgICAgIHZhciBhZGRFZGl0Um93SW5kZXggPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgaWYgKGFkZEVkaXRSb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkRWRpdFJvd0luZGV4ID0gcm93cy5pbmRleE9mKGFkZEVkaXRSb3cpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0Zyb3plbkdyaWQoKSAmJiB0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJ6VGQgPSBbXS5zbGljZS5jYWxsKHJvd3NbYWRkRWRpdFJvd0luZGV4ICsgMV0ucXVlcnlTZWxlY3RvckFsbCgnLmUtcm93Y2VsbCcpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnJ6VGQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHRoaXMuZnJvemVuTGVmdENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyelRkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuYWRkKCdlLWxlZnRmcmVlemUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJ6VGRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnNldEF0dHJpYnV0ZSgnYXJpYS1jb2xpbmRleCcsIChpICsgMSkudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyelRkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5zdHlsZS5sZWZ0ID0gKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZhbHVlWCAtIHRoaXMudHJhbnNsYXRlWCkgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgoZnJ6VGQubGVuZ3RoIC0gdGhpcy5mcm96ZW5SaWdodENvdW50KSA8PSBpICYmIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyelRkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuYWRkKCdlLXJpZ2h0ZnJlZXplJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyelRkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnLCAoaSArIDEpLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcnpUZFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uc3R5bGUucmlnaHQgPSAodGhpcy50cmFuc2xhdGVYICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZhbHVlWCkgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYWRkRWRpdFJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2UtYWRkZWRyb3cnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93cy5zcGxpY2UoYWRkRWRpdFJvd0luZGV4LCAyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd3Muc3BsaWNlKGFkZEVkaXRSb3dJbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcm93Q291bnQgPSAodGhpcy5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSAmJiBheGlzRGlyZWN0aW9uID8gcm93cy5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgOiByb3dDb3VudCA8PSByb3dzLmxlbmd0aCA/IHJvd0NvdW50IDogcm93cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByb3dDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hc2tUQm9keS5hcHBlbmRDaGlsZCh0aGlzLmFwcGx5TWFza1Jvdyhyb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbG9uZU5vZGUodHJ1ZSksIHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWRkRWRpdFJvdyAmJiBhZGRFZGl0Um93LmNsYXNzTGlzdC5jb250YWlucygnZS1lZGl0ZWRyb3cnKSAmJiBhZGRFZGl0Um93SW5kZXggPCByb3dDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWRkRWRpdE1hc2tSb3cgPSBtYXNrVEJvZHkuY2hpbGROb2Rlc1twYXJzZUludChhZGRFZGl0Um93SW5kZXgudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICAgICAgYWRkRWRpdE1hc2tSb3cuc3R5bGUuaGVpZ2h0ID0gdGhpcy5nZXRSb3dIZWlnaHQoKSArICdweCc7XG4gICAgICAgICAgICAgICAgICAgIGFkZEVkaXRNYXNrUm93LmNsYXNzTGlzdC5hZGQoJ2Utcm93Jyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhZGRFZGl0Um93LmNsYXNzTGlzdC5jb250YWlucygnZS1hbHRyb3cnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkRWRpdE1hc2tSb3cuY2xhc3NMaXN0LmFkZCgnZS1hbHRyb3cnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBtYXNrVGFibGUuYXBwZW5kQ2hpbGQobWFza1RCb2R5KTtcbiAgICAgICAgaWYgKGZvb3Rlcikge1xuICAgICAgICAgICAgdmFyIHRmb290ID0gdGFibGUucXVlcnlTZWxlY3RvcigndGZvb3QnKTtcbiAgICAgICAgICAgIHZhciBtYXNrVEZvb3QgPSB0Zm9vdC5jbG9uZU5vZGUoKTtcbiAgICAgICAgICAgIG1hc2tURm9vdC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2UtbWFza2VkLXRmb290Jyk7XG4gICAgICAgICAgICB2YXIgcm93cyA9IFtdLnNsaWNlLmNhbGwodGZvb3QucXVlcnlTZWxlY3RvckFsbCgndHInKSk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXNrVEZvb3QuYXBwZW5kQ2hpbGQodGhpcy5hcHBseU1hc2tSb3cocm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xvbmVOb2RlKHRydWUpLCByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1hc2tUYWJsZS5hcHBlbmRDaGlsZChtYXNrVEZvb3QpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoZWFkZXIgJiYgdGhpcy5pc0Zyb3plbkdyaWQoKSAmJiAhdGhpcy5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbikge1xuICAgICAgICAgICAgdGhpcy5nZXRIZWFkZXJDb250ZW50KCkucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5oZWFkZXJDb250ZW50KS5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG4gICAgICAgIH1cbiAgICAgICAgcGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUobWFza1RhYmxlLCBwYXJlbnRFbGVtZW50LmZpcnN0Q2hpbGQpO1xuICAgICAgICBpZiAoY29udGVudCAmJiAhKHRoaXMuZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgYXhpc0RpcmVjdGlvbikpIHtcbiAgICAgICAgICAgIHZhciBtaW5TY3JvbGxUb3AgPSBncmlkQ29udGVudFNjcm9sbEhlaWdodCAtIG1hc2tUYWJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XG4gICAgICAgICAgICBtaW5TY3JvbGxUb3AgPSBtaW5TY3JvbGxUb3AgPCAwID8gMCA6IG1pblNjcm9sbFRvcDtcbiAgICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSBncmlkQ29udGVudC5zY3JvbGxUb3AgPD0gbWluU2Nyb2xsVG9wID8gZ3JpZENvbnRlbnQuc2Nyb2xsVG9wIDogbWluU2Nyb2xsVG9wO1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgICAgICBzY3JvbGxUb3AgLT0gZ2V0VHJhbnNmb3JtVmFsdWVzKGNsb3Nlc3QocGFyZW50RWxlbWVudCwgJy5lLXZpcnR1YWx0YWJsZScpKS5oZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXNrVGFibGUuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgwcHgsJyArIHNjcm9sbFRvcCArICdweCknO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXNrVGFibGU7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5hcHBseU1hc2tSb3cgPSBmdW5jdGlvbiAocm93LCByb3dIZWlnaHQpIHtcbiAgICAgICAgdmFyIG1hc2tSb3cgPSByb3c7XG4gICAgICAgIG1hc2tSb3cucmVtb3ZlQXR0cmlidXRlKCdyb2xlJyk7XG4gICAgICAgIG1hc2tSb3cucmVtb3ZlQXR0cmlidXRlKCdhcmlhLXJvd2luZGV4Jyk7XG4gICAgICAgIG1hc2tSb3cucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXVpZCcpO1xuICAgICAgICBtYXNrUm93LmNsYXNzTGlzdC5hZGQoJ2UtbWFza2VkLXJvdycpO1xuICAgICAgICBtYXNrUm93LnN0eWxlLmhlaWdodCA9IHJvd0hlaWdodCArICdweCc7XG4gICAgICAgIHZhciBtYXNrQ2VsbHMgPSBbXS5zbGljZS5jYWxsKG1hc2tSb3cuY2hpbGROb2Rlcyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFza0NlbGxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgbWFza0NlbGwgPSBtYXNrQ2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgdmFyIGRpc3BsYXlBc0NoZWNrQm94Q2VsbCA9IG1hc2tDZWxsLmZpcnN0Q2hpbGQgJiYgbWFza0NlbGwuZmlyc3RDaGlsZC5jbGFzc0xpc3RcbiAgICAgICAgICAgICAgICAmJiBtYXNrQ2VsbC5maXJzdENoaWxkLmNsYXNzTGlzdC5jb250YWlucygnZS1jaGVja2JveC13cmFwcGVyJyk7XG4gICAgICAgICAgICBtYXNrQ2VsbC5yZW1vdmVBdHRyaWJ1dGUoJ3JvbGUnKTtcbiAgICAgICAgICAgIG1hc2tDZWxsLnJlbW92ZUF0dHJpYnV0ZSgndGFiaW5kZXgnKTtcbiAgICAgICAgICAgIG1hc2tDZWxsLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgbWFza0NlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWZpeGVkZnJlZXplJykpIHtcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhbbWFza0NlbGxdLCBbJ2UtZml4ZWRmcmVlemUnLCAnZS1mcmVlemVsZWZ0Ym9yZGVyJywgJ2UtZnJlZXplcmlnaHRib3JkZXInXSk7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoW21hc2tDZWxsXSwgWydlLXVuZnJlZXplJ10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWFza0NlbGwucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWNvbGluZGV4Jyk7XG4gICAgICAgICAgICBtYXNrQ2VsbC5yZW1vdmVBdHRyaWJ1dGUoJ2luZGV4Jyk7XG4gICAgICAgICAgICBtYXNrQ2VsbC5yZW1vdmVBdHRyaWJ1dGUoJ2VqLW1hcHBpbmduYW1lJyk7XG4gICAgICAgICAgICBtYXNrQ2VsbC5yZW1vdmVBdHRyaWJ1dGUoJ2VqLW1hcHBpbmd2YWx1ZScpO1xuICAgICAgICAgICAgbWFza0NlbGwucmVtb3ZlQXR0cmlidXRlKCdlLW1hcHBpbmd1aWQnKTtcbiAgICAgICAgICAgIG1hc2tDZWxsLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcpO1xuICAgICAgICAgICAgbWFza0NlbGwuY2xhc3NMaXN0LmFkZCgnZS1tYXNrZWQtY2VsbCcpO1xuICAgICAgICAgICAgbWFza0NlbGwuaW5uZXJIVE1MID0gdGhpcy5nZXRTaGltbWVyVGVtcGxhdGUoKTtcbiAgICAgICAgICAgIGlmIChtYXNrQ2VsbC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtcmVjb3JkcGx1c2V4cGFuZCcpIHx8IG1hc2tDZWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1yZWNvcmRwbHVzY29sbGFwc2UnKSkge1xuICAgICAgICAgICAgICAgIG1hc2tDZWxsLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LmFkZCgnZS1tYXNrLWdyb3VwLWludGVudCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobWFza0NlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWdyaWRjaGtib3gnKSB8fCBkaXNwbGF5QXNDaGVja0JveENlbGwpIHtcbiAgICAgICAgICAgICAgICBtYXNrQ2VsbC5maXJzdENoaWxkLmNsYXNzTGlzdC5hZGQoJ2UtbWFzay1jaGVja2JveC1pbnRlbnQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG1hc2tDZWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1yb3dkcmFnZHJvcCcpKSB7XG4gICAgICAgICAgICAgICAgbWFza0NlbGwuZmlyc3RDaGlsZC5jbGFzc0xpc3QuYWRkKCdlLW1hc2stZHJhZy1pbnRlbnQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG1hc2tDZWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1pbmRlbnRjZWxsJykpIHtcbiAgICAgICAgICAgICAgICBtYXNrQ2VsbC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWFza1JvdztcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmNyZWF0ZU1hc2tSb3cgPSBmdW5jdGlvbiAocmVmQ29sZ3JvdXAsIHJlZkNvbHVtbnMpIHtcbiAgICAgICAgdmFyIGNvbGdyb3VwID0gcmVmQ29sZ3JvdXA7XG4gICAgICAgIHZhciBjb2x1bW5zID0gcmVmQ29sdW1ucztcbiAgICAgICAgdmFyIHJvdyA9IHRoaXMuY3JlYXRlRWxlbWVudCgndHInLCB7IGNsYXNzTmFtZTogJ2UtbWFza2VkLXJvdyBlLXJvdycgfSk7XG4gICAgICAgIGlmICh0aGlzLnJvd1JlbmRlcmluZ01vZGUgIT09ICdWZXJ0aWNhbCcpIHtcbiAgICAgICAgICAgIHJvdy5zdHlsZS5oZWlnaHQgPSB0aGlzLmdldFJvd0hlaWdodCgpICsgJ3B4JztcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGQgPSB0aGlzLmNyZWF0ZUVsZW1lbnQoJ3RkJywgeyBjbGFzc05hbWU6ICdlLW1hc2tlZC1jZWxsIGUtcm93Y2VsbCcgfSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBjb2xJbmRleCA9IDA7IGkgPCBjb2xncm91cC5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY29sID0gY29sZ3JvdXAuY2hpbGROb2Rlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICB2YXIgbG9jYWxURCA9IHRkLmNsb25lTm9kZSgpO1xuICAgICAgICAgICAgbG9jYWxURC5pbm5lckhUTUwgPSB0aGlzLmdldFNoaW1tZXJUZW1wbGF0ZSgpO1xuICAgICAgICAgICAgaWYgKCEoY29sLmNsYXNzTGlzdC5jb250YWlucygnZS1ncm91cC1pbnRlbnQnKSB8fCBjb2wuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWRldGFpbC1pbnRlbnQnKVxuICAgICAgICAgICAgICAgIHx8IGNvbC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZHJhZy1pbnRlbnQnKSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yb3dSZW5kZXJpbmdNb2RlID09PSAnVmVydGljYWwnICYmIGNvbHVtbnNbcGFyc2VJbnQoY29sSW5kZXgudG9TdHJpbmcoKSwgMTApXSkge1xuICAgICAgICAgICAgICAgICAgICBsb2NhbFRELnNldEF0dHJpYnV0ZSgnZGF0YS1jZWxsJywgY29sdW1uc1twYXJzZUludChjb2xJbmRleC50b1N0cmluZygpLCAxMCldLmhlYWRlclRleHQgP1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChjb2xJbmRleC50b1N0cmluZygpLCAxMCldLmhlYWRlclRleHQgOiBjb2x1bW5zW3BhcnNlSW50KGNvbEluZGV4LnRvU3RyaW5nKCksIDEwKV0uZmllbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29sLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykge1xuICAgICAgICAgICAgICAgICAgICBsb2NhbFRELmNsYXNzTGlzdC5hZGQoJ2UtaGlkZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxURC5zdHlsZS50ZXh0QWxpZ24gPSBjb2x1bW5zW3BhcnNlSW50KGNvbEluZGV4LnRvU3RyaW5nKCksIDEwKV1cbiAgICAgICAgICAgICAgICAgICAgICAgICYmIGNvbHVtbnNbcGFyc2VJbnQoY29sSW5kZXgudG9TdHJpbmcoKSwgMTApXS50ZXh0QWxpZ24gP1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChjb2xJbmRleC50b1N0cmluZygpLCAxMCldLnRleHRBbGlnbi50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMuZW5hYmxlUnRsID8gJ3JpZ2h0JyA6ICdsZWZ0JztcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoY29sSW5kZXgudG9TdHJpbmcoKSwgMTApXSAmJiAoY29sdW1uc1twYXJzZUludChjb2xJbmRleC50b1N0cmluZygpLCAxMCldLnR5cGUgPT09ICdjaGVja2JveCdcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8IGNvbHVtbnNbcGFyc2VJbnQoY29sSW5kZXgudG9TdHJpbmcoKSwgMTApXS5kaXNwbGF5QXNDaGVja0JveCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsVEQuZmlyc3RDaGlsZC5jbGFzc0xpc3QuYWRkKCdlLW1hc2stY2hlY2tib3gtaW50ZW50Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29sSW5kZXgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjb2wuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWdyb3VwLWludGVudCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsVEQuZmlyc3RDaGlsZC5jbGFzc0xpc3QuYWRkKCdlLW1hc2stZ3JvdXAtaW50ZW50Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNvbC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZGV0YWlsLWludGVudCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsVEQuZmlyc3RDaGlsZC5jbGFzc0xpc3QuYWRkKCdlLW1hc2stZGV0YWlsLWludGVudCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjb2wuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWRyYWctaW50ZW50JykpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxURC5maXJzdENoaWxkLmNsYXNzTGlzdC5hZGQoJ2UtbWFzay1kcmFnLWludGVudCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChsb2NhbFREKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcm93O1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0U2hpbW1lclRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5tYXNrUm93Q29udGVudFNjcm9sbCkge1xuICAgICAgICAgICAgcmV0dXJuICc8c3BhbiBjbGFzcz1cImUtbWFzayBlLXNrZWxldG9uIGUtc2tlbGV0b24tdGV4dFwiPjwvc3Bhbj4nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnPHNwYW4gY2xhc3M9XCJlLW1hc2sgZS1za2VsZXRvbiBlLXNrZWxldG9uLXRleHQgZS1zaGltbWVyLXdhdmVcIj48L3NwYW4+JztcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmFkZFNoaW1tZXJFZmZlY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubWFza1Jvd0NvbnRlbnRTY3JvbGwgPSBmYWxzZTtcbiAgICAgICAgdmFyIG1hc2tTcGFuID0gW10uc2xpY2UuY2FsbCh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtbWFzazpub3QoLmUtc2hpbW1lci13YXZlKScpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXNrU3Bhbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKG1hc2tTcGFuW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSkge1xuICAgICAgICAgICAgICAgIG1hc2tTcGFuW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuYWRkKCdlLXNoaW1tZXItd2F2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS50cmFuc2xhdGVNYXNrUm93ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICB2YXIgbWFza1RhYmxlcyA9IHRhcmdldC5xdWVyeVNlbGVjdG9yQWxsKCcuZS1tYXNrZWQtdGFibGUnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXNrVGFibGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgbWFza1RhYmxlID0gbWFza1RhYmxlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICBpZiAobWFza1RhYmxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1pblNjcm9sbFRvcCA9IHRhcmdldC5zY3JvbGxIZWlnaHQgLSBtYXNrVGFibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIG1pblNjcm9sbFRvcCA9IG1pblNjcm9sbFRvcCA8IDAgPyAwIDogbWluU2Nyb2xsVG9wO1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSB0YXJnZXQuc2Nyb2xsVG9wIDw9IG1pblNjcm9sbFRvcCA/IHRhcmdldC5zY3JvbGxUb3AgOiBtaW5TY3JvbGxUb3A7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9wIC09IGdldFRyYW5zZm9ybVZhbHVlcyhjbG9zZXN0KG1hc2tUYWJsZSwgJy5lLXZpcnR1YWx0YWJsZScpKS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1hc2tUYWJsZS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlKDBweCwnICsgc2Nyb2xsVG9wICsgJ3B4KSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnJlbW92ZU1hc2tSb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jb250ZW50TW9kdWxlKSkge1xuICAgICAgICAgICAgdmFyIGdyaWRDb250ZW50ID0gdGhpcy5nZXRDb250ZW50KCkuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUoZ3JpZENvbnRlbnQsICdzY3JvbGwnLCB0aGlzLnRyYW5zbGF0ZU1hc2tSb3cpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmhlYWRlck1hc2tUYWJsZSAmJiB0aGlzLmlzRnJvemVuR3JpZCgpICYmICF0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmdldEhlYWRlckNvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmhlYWRlckNvbnRlbnQpLnN0eWxlLnBvc2l0aW9uID0gJyc7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1hc2tUYWJsZXMgPSBbdGhpcy5oZWFkZXJNYXNrVGFibGUsXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRNYXNrVGFibGUsIHRoaXMuZm9vdGVyQ29udGVudE1hc2tUYWJsZV07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFza1RhYmxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG1hc2tUYWJsZSA9IG1hc2tUYWJsZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgaWYgKG1hc2tUYWJsZSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZShtYXNrVGFibGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGVhZGVyTWFza1RhYmxlID0gbnVsbDtcbiAgICAgICAgdGhpcy5jb250ZW50TWFza1RhYmxlID0gbnVsbDtcbiAgICAgICAgdGhpcy5mb290ZXJDb250ZW50TWFza1RhYmxlID0gbnVsbDtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnJlZnJlc2hNYXNrUm93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ3JpZENvbnRlbnQgPSB0aGlzLmdldENvbnRlbnQoKS5maXJzdENoaWxkO1xuICAgICAgICBpZiAoIXRoaXMuaXNJbml0aWFsTG9hZCAmJiAhdGhpcy5nZXRDb2x1bW5zKCkubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29udGVudE1hc2tUYWJsZSAmJiBncmlkQ29udGVudC5xdWVyeVNlbGVjdG9yKCcuZS1tYXNrZWQtdGFibGUnKSkge1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBncmlkQ29udGVudDtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZVZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucXVlcnlTZWxlY3RvcignLmUtdmlydHVhbHRhYmxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hNYXNrUm93Q29sZ3JvdXBXaWR0aChjb250ZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUucmVmcmVzaE1hc2tSb3dDb2xncm91cFdpZHRoID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgdmFyIHRhYmxlID0gY29udGVudC5xdWVyeVNlbGVjdG9yKCd0YWJsZTpub3QoLmUtbWFza2VkLXRhYmxlKScpO1xuICAgICAgICB2YXIgY29sZ3JvdXAgPSB0YWJsZS5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLmNvbEdyb3VwKS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgIHZhciBtYXNrVGFibGUgPSBjb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLW1hc2tlZC10YWJsZScpO1xuICAgICAgICBjb2xncm91cC5yZW1vdmVBdHRyaWJ1dGUoJ2lkJyk7XG4gICAgICAgIGNvbGdyb3VwLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnZS1tYXNrZWQtY29sZ3JvdXAnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2xncm91cC5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb2xncm91cC5jaGlsZE5vZGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5yZW1vdmVBdHRyaWJ1dGUoJ2NsYXNzJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmVtb3ZlKG1hc2tUYWJsZS5xdWVyeVNlbGVjdG9yKCcuZS1tYXNrZWQtY29sZ3JvdXAnKSk7XG4gICAgICAgIG1hc2tUYWJsZS5pbnNlcnRCZWZvcmUoY29sZ3JvdXAsIG1hc2tUYWJsZS5maXJzdENoaWxkKTtcbiAgICAgICAgbWFza1RhYmxlLnN0eWxlLndpZHRoID0gdGFibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggKyAncHgnO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUudXBkYXRlU3RhY2tlZEZpbHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuYWxsb3dGaWx0ZXJpbmcgJiYgdGhpcy5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnRmlsdGVyQmFyJyAmJlxuICAgICAgICAgICAgdGhpcy5nZXRIZWFkZXJDb250ZW50KCkuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1zdGFja2VkaGVhZGVyY2VsbCcpLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5nZXRIZWFkZXJDb250ZW50KCkuY2xhc3NMaXN0LmFkZCgnZS1zdGFja2VkZmlsdGVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmdldEhlYWRlckNvbnRlbnQoKS5jbGFzc0xpc3QucmVtb3ZlKCdlLXN0YWNrZWRmaWx0ZXInKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0TWVkaWFDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgIHZhciBnY29sID0gdGhpcy5nZXRDb2x1bW5zKCk7XG4gICAgICAgICAgICB0aGlzLmdldFNob3dIaWRlU2VydmljZSA9IHRoaXMuc2VydmljZUxvY2F0b3IuZ2V0U2VydmljZSgnc2hvd0hpZGVTZXJ2aWNlJyk7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGdjb2wpKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGdjb2wubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZ2NvbFtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldLmhpZGVBdE1lZGlhKVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgKGlzTnVsbE9yVW5kZWZpbmVkKGdjb2xbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IGdjb2xbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wdXNoTWVkaWFDb2x1bW4oZ2NvbFtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVGcm96ZW5Db2x1bW5zV2lkdGgoKTtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnB1c2hNZWRpYUNvbHVtbiA9IGZ1bmN0aW9uIChjb2wsIGluZGV4KSB7XG4gICAgICAgIHRoaXMubWVkaWFDb2wucHVzaChjb2wpO1xuICAgICAgICB0aGlzLm1lZGlhW2NvbC51aWRdID0gd2luZG93Lm1hdGNoTWVkaWEoY29sLmhpZGVBdE1lZGlhKTtcbiAgICAgICAgdGhpcy5tZWRpYVF1ZXJ5VXBkYXRlKGluZGV4LCB0aGlzLm1lZGlhW2NvbC51aWRdKTtcbiAgICAgICAgdGhpcy5tZWRpYUJpbmRJbnN0YW5jZVtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldID0gdGhpcy5tZWRpYVF1ZXJ5VXBkYXRlLmJpbmQodGhpcywgaW5kZXgpO1xuICAgICAgICB0aGlzLm1lZGlhW2NvbC51aWRdLmFkZExpc3RlbmVyKHRoaXMubWVkaWFCaW5kSW5zdGFuY2VbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0NvbHVtbn0gY29sIC0gc3BlY2lmaWVzIHRoZSBjb2x1bW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUudXBkYXRlTWVkaWFDb2x1bW5zID0gZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuZ2V0Q29sdW1uSW5kZXhCeVVpZChjb2wudWlkKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tZWRpYUNvbC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChjb2wudWlkID09PSB0aGlzLm1lZGlhQ29sW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS51aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZWRpYUNvbC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnB1c2hNZWRpYUNvbHVtbihjb2wsIGluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNvbHVtbkluZGV4IC0gc3BlY2lmaWVzIHRoZSBjb2x1bW4gaW5kZXhcbiAgICAgKiBAcGFyYW0ge01lZGlhUXVlcnlMaXN0fSBlIC0gc3BlY2lmaWVzIHRoZSBNZWRpYVF1ZXJ5TGlzdFxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5tZWRpYVF1ZXJ5VXBkYXRlID0gZnVuY3Rpb24gKGNvbHVtbkluZGV4LCBlKSB7XG4gICAgICAgIHZhciBjb2wgPSB0aGlzLmdldENvbHVtbnMoKVtwYXJzZUludChjb2x1bW5JbmRleC50b1N0cmluZygpLCAxMCldO1xuICAgICAgICBpZiAodGhpcy5tZWRpYUNvbC5zb21lKGZ1bmN0aW9uIChtZWRpYUNvbHVtbikgeyByZXR1cm4gbWVkaWFDb2x1bW4udWlkID09PSBjb2wudWlkOyB9KSkge1xuICAgICAgICAgICAgY29sLnZpc2libGUgPSBlLm1hdGNoZXM7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxMb2FkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnZva2VkRnJvbU1lZGlhID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoY29sLnZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93SGlkZXIuc2hvdyhjb2wuaGVhZGVyVGV4dCwgJ2hlYWRlclRleHQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0hpZGVyLmhpZGUoY29sLmhlYWRlclRleHQsICdoZWFkZXJUZXh0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5yZWZyZXNoTWVkaWFDb2wgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNJbml0aWFsTG9hZCA9IHRydWU7XG4gICAgICAgIHZhciBmb290ZXJDb250ZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZEZvb3Rlcik7XG4gICAgICAgIGlmICh0aGlzLmFnZ3JlZ2F0ZXMubGVuZ3RoICYmIHRoaXMuZWxlbWVudC5zY3JvbGxIZWlnaHQgPiBwYXJzZUludCh0aGlzLmhlaWdodC50b1N0cmluZygpLCAxMCkgJiYgZm9vdGVyQ29udGVudCkge1xuICAgICAgICAgICAgYWRkQ2xhc3MoW2Zvb3RlckNvbnRlbnRdLCBbJ2UtZm9vdGVycGFkZGluZyddKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hlY2tib3hDb2x1bW4gPSB0aGlzLmdldENvbHVtbnMoKS5maWx0ZXIoZnVuY3Rpb24gKGNvbCkgeyByZXR1cm4gY29sLnR5cGUgPT09ICdjaGVja2JveCc7IH0pO1xuICAgICAgICBpZiAoY2hlY2tib3hDb2x1bW4ubGVuZ3RoID09PSAwIHx8IGNoZWNrYm94Q29sdW1uLmxlbmd0aCAmJiB0aGlzLnNlbGVjdGlvblNldHRpbmdzLmNoZWNrYm94TW9kZSA9PT0gJ1Jlc2V0T25Sb3dDbGljaycpIHtcbiAgICAgICAgICAgIHRoaXMuaXNDaGVja0JveFNlbGVjdGlvbiA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJvd1JlbmRlcmluZ01vZGUgPT09ICdWZXJ0aWNhbCcpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUhvdmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgZW5hYmxlQWRhcHRpdmVVSTogdHJ1ZSwgZW5hYmxlSG92ZXI6IGZhbHNlIH0sIHRydWUpO1xuICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKFt0aGlzLmVsZW1lbnRdLCAnZS1ncmlkaG92ZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lbmFibGVBZGFwdGl2ZVVJICYmIHRoaXMuc2Nyb2xsTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbE1vZHVsZS5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNGcm96ZW5HcmlkKCkgJiYgdGhpcy5pc0F1dG9HZW5lcmF0ZUNvbHVtbnMpIHtcbiAgICAgICAgICAgIHRoaXMud2lkdGhTZXJ2aWNlLnNldFdpZHRoVG9Db2x1bW5zKCk7XG4gICAgICAgICAgICB0aGlzLmlzQXV0b0dlbmVyYXRlQ29sdW1ucyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5yZW1vdmVNZWRpYUxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubWVkaWFDb2wubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMubWVkaWFbdGhpcy5tZWRpYUNvbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udWlkXVxuICAgICAgICAgICAgICAgIC5yZW1vdmVMaXN0ZW5lcih0aGlzLm1lZGlhQmluZEluc3RhbmNlW3RoaXMubWVkaWFDb2xbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmluZGV4XSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZvciBpbnRlcm5hbCB1c2Ugb25seSAtIEluaXRpYWxpemUgdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZXZlbnRJbml0aWFsaXplciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9ldmVudEluaXRpYWxpemVyXG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgY29tcG9uZW50IChkZXRhY2hlcy9yZW1vdmVzIGFsbCBldmVudCBoYW5kbGVycywgYXR0cmlidXRlcywgY2xhc3NlcywgYW5kIGVtcHRpZXMgdGhlIGNvbXBvbmVudCBlbGVtZW50KS5cbiAgICAgKlxuICAgICAqIEBmdW5jdGlvbiBkZXN0cm95XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdyaWRFbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuICAgICAgICBpZiAoIWdyaWRFbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhhc0dyaWRDaGlsZCA9IGdyaWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZEhlYWRlcikgJiZcbiAgICAgICAgICAgIGdyaWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZENvbnRlbnQpID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICBpZiAoaGFzR3JpZENoaWxkKSB7XG4gICAgICAgICAgICB0aGlzLnVud2lyZUV2ZW50cygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoKTtcbiAgICAgICAgdGhpcy5yZW1vdmVNZWRpYUxpc3RlbmVyKCk7XG4gICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5kZXN0cm95LCB7fSk7XG4gICAgICAgIHRoaXMuZGVzdHJveURlcGVuZGVudE1vZHVsZXMoKTtcbiAgICAgICAgaWYgKHRoaXMuaXNSZWFjdCkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95VGVtcGxhdGUoWyd0ZW1wbGF0ZSddKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc1Z1ZSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95VGVtcGxhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFzR3JpZENoaWxkKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRvb2xUaXBPYmouZGVzdHJveSgpO1xuICAgICAgICBpZiAodGhpcy5pc1JlYWN0ICYmICFCcm93c2VyLmlzSUUpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgfVxuICAgICAgICB2YXIgbW9kdWxlcyA9IFsncmVuZGVyTW9kdWxlJywgJ2hlYWRlck1vZHVsZScsICdjb250ZW50TW9kdWxlJywgJ3ZhbHVlRm9ybWF0dGVyU2VydmljZScsXG4gICAgICAgICAgICAnc2VydmljZUxvY2F0b3InLCAnYXJpYVNlcnZpY2UnLCAna2V5Ym9hcmRNb2R1bGUnLCAnd2lkdGhTZXJ2aWNlJywgJ3NlYXJjaE1vZHVsZScsICdzaG93SGlkZXInLFxuICAgICAgICAgICAgJ3Njcm9sbE1vZHVsZScsICdwcmludE1vZHVsZScsICdjbGlwYm9hcmRNb2R1bGUnLCAnZm9jdXNNb2R1bGUnXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpc1ttb2R1bGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0pIHtcbiAgICAgICAgICAgICAgICB0aGlzW21vZHVsZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9ICcnO1xuICAgICAgICBjbGFzc0xpc3QodGhpcy5lbGVtZW50LCBbXSwgWydlLXJ0bCcsICdlLWdyaWRob3ZlcicsICdlLXJlc3BvbnNpdmUnLCAnZS1kZWZhdWx0JywgJ2UtZGV2aWNlJywgJ2UtZ3JpZC1taW4taGVpZ2h0J10pO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZGVzdHJveURlcGVuZGVudE1vZHVsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBncmlkRWxlbWVudCA9IHRoaXMuZWxlbWVudDtcbiAgICAgICAgaWYgKCFncmlkRWxlbWVudCB8fCAoIWdyaWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZEhlYWRlcikgJiYgIWdyaWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZENvbnRlbnQpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5rZXlib2FyZE1vZHVsZS5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuZm9jdXNNb2R1bGUuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLmNsaXBib2FyZE1vZHVsZS5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMucHJpbnRNb2R1bGUuZGVzdHJveSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRm9yIGludGVybmFsIHVzZSBvbmx5IC0gR2V0IHRoZSBtb2R1bGUgbmFtZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgdGhlIG1vZHVsZSBuYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRNb2R1bGVOYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJ2dyaWQnO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZW5hYmxlQm94U2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5lbmFibGVBdXRvRmlsbCkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5jZWxsU2VsZWN0aW9uTW9kZSA9ICdCb3hXaXRoQm9yZGVyJztcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLWFmZW5hYmxlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2UtYWZlbmFibGVkJyk7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuZGVzdHJveUF1dG9GaWxsRWxlbWVudHMsIHt9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuc2V0Q1NTQ2xhc3MgPSBmdW5jdGlvbiAob2xkQ1NTQ2xhc3MpIHtcbiAgICAgICAgaWYgKHRoaXMuY3NzQ2xhc3MpIHtcbiAgICAgICAgICAgIGFkZENsYXNzKFt0aGlzLmVsZW1lbnRdLCB0aGlzLmNzc0NsYXNzLnNwbGl0KCcgJykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvbGRDU1NDbGFzcykge1xuICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoW3RoaXMuZWxlbWVudF0sIG9sZENTU0NsYXNzLnNwbGl0KCcgJykpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDYWxsZWQgaW50ZXJuYWxseSBpZiBhbnkgb2YgdGhlIHByb3BlcnR5IHZhbHVlIGNoYW5nZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0dyaWRNb2RlbH0gbmV3UHJvcCAtIERlZmluZXMgbmV3IHByb3BlcnRpZXNcbiAgICAgKiBAcGFyYW0ge0dyaWRNb2RlbH0gb2xkUHJvcCAtIERlZmluZXMgb2xkIHByb3BlcnRpZXNcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUub25Qcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAobmV3UHJvcCwgb2xkUHJvcCkge1xuICAgICAgICB2YXIgcmVxdWlyZVJlZnJlc2ggPSBmYWxzZTtcbiAgICAgICAgdmFyIHJlcXVpcmVHcmlkUmVmcmVzaCA9IGZhbHNlO1xuICAgICAgICB2YXIgZnJlZXplUmVmcmVzaCA9IGZhbHNlO1xuICAgICAgICB2YXIgY2hlY2tDdXJzb3I7XG4gICAgICAgIHZhciBhcmdzID0geyByZXF1ZXN0VHlwZTogJ3JlZnJlc2gnIH07XG4gICAgICAgIHZhciBjaGlsZEdyaWRQYXJlbnQgPSBudWxsO1xuICAgICAgICB2YXIgcGFyZW50SW5zdGFuY2UgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubG9nKCdtb2R1bGVfbWlzc2luZycpO1xuICAgICAgICBpZiAodGhpcy5pc0VsbGlwc2lzVG9vbHRpcCgpKSB7XG4gICAgICAgICAgICB0aGlzLnRvb2xUaXBPYmouY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJvcGVydGllcyA9IE9iamVjdC5rZXlzKG5ld1Byb3ApO1xuICAgICAgICBpZiAocHJvcGVydGllcy5pbmRleE9mKCdjb2x1bW5zJykgPiAtMSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbk1vZGVsID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbHVtbk9iamVjdCgpO1xuICAgICAgICAgICAgcmVxdWlyZUdyaWRSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHByb3BlcnRpZXNfMSA9IHByb3BlcnRpZXM7IF9pIDwgcHJvcGVydGllc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHByb3AgPSBwcm9wZXJ0aWVzXzFbX2ldO1xuICAgICAgICAgICAgc3dpdGNoIChwcm9wKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWxsb3dQYWdpbmcnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMudWlVcGRhdGUsIHsgbW9kdWxlOiAncGFnZXInLCBlbmFibGU6IHRoaXMuYWxsb3dQYWdpbmcgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaGVpZ2h0ID09PSAnMTAwJScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYWdlU2V0dGluZ3MnOlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYWdlVGVtcGxhdGVDaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZVRlbXBsYXRlQ2hhbmdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuaW5Cb3VuZE1vZGVsQ2hhbmdlZCwgeyBtb2R1bGU6ICdwYWdlcicsIHByb3BlcnRpZXM6IG5ld1Byb3AucGFnZVNldHRpbmdzIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFnZXJNb2R1bGUgJiYgdGhpcy5wYWdlck1vZHVsZS5pc0NhbmNlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlck1vZHVsZS5pc0NhbmNlbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5pbkJvdW5kTW9kZWxDaGFuZ2VkLCB7IG1vZHVsZTogJ3BhZ2VyJywgcHJvcGVydGllczogbmV3UHJvcC5wYWdlU2V0dGluZ3MgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChuZXdQcm9wLnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZSkgJiYgaXNOdWxsT3JVbmRlZmluZWQobmV3UHJvcC5wYWdlU2V0dGluZ3MucGFnZVNpemUpXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBpc051bGxPclVuZGVmaW5lZChuZXdQcm9wLnBhZ2VTZXR0aW5ncy50b3RhbFJlY29yZHNDb3VudClcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8ICFpc051bGxPclVuZGVmaW5lZChvbGRQcm9wLnBhZ2VTZXR0aW5ncykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKG5ld1Byb3AucGFnZVNldHRpbmdzLmN1cnJlbnRQYWdlICE9PSBvbGRQcm9wLnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgIXRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgIXRoaXMuZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgdGhpcy5wYWdlUmVxdWlyZVJlZnJlc2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5wYWdlU2V0dGluZ3MudG90YWxSZWNvcmRzQ291bnQgPD0gdGhpcy5wYWdlU2V0dGluZ3MucGFnZVNpemUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlUmVmcmVzaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnBhZ2VSZXF1aXJlUmVmcmVzaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlUmVxdWlyZVJlZnJlc2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhZ2VyTW9kdWxlICYmIHRoaXMucGFnZXJNb2R1bGUuaXNDYW5jZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZXJNb2R1bGUuaXNDYW5jZWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhbGxvd1NvcnRpbmcnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMudWlVcGRhdGUsIHsgbW9kdWxlOiAnc29ydCcsIGVuYWJsZTogdGhpcy5hbGxvd1NvcnRpbmcgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tDdXJzb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhbGxvd0ZpbHRlcmluZyc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhY2tlZEZpbHRlcigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMudWlVcGRhdGUsIHsgbW9kdWxlOiAnZmlsdGVyJywgZW5hYmxlOiB0aGlzLmFsbG93RmlsdGVyaW5nIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXF1aXJlUmVmcmVzaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpbHRlclNldHRpbmdzLnR5cGUgIT09ICdGaWx0ZXJCYXInIHx8ICh0aGlzLmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIHRoaXMuZmlsdGVyU2V0dGluZ3MudHlwZSA9PT0gJ0ZpbHRlckJhcicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hIZWFkZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhlaWdodCA9PT0gJzEwMCUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxNb2R1bGUucmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2hlaWdodCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnd2lkdGgnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMudWlVcGRhdGUsIHsgbW9kdWxlOiAnc2Nyb2xsJywgcHJvcGVydGllczogeyB3aWR0aDogbmV3UHJvcC53aWR0aCwgaGVpZ2h0OiBuZXdQcm9wLmhlaWdodCB9IH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hbGxvd1BhZ2luZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlck1vZHVsZS5yZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWxsb3dSZW9yZGVyaW5nJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJNb2R1bGUucmVmcmVzaFVJKCk7XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrQ3Vyc29yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWxsb3dSb3dEcmFnQW5kRHJvcCc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy51aVVwZGF0ZSwgeyBtb2R1bGU6ICdyb3dEcmFnQW5kRHJvcCcsIGVuYWJsZTogdGhpcy5hbGxvd1Jvd0RyYWdBbmREcm9wIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlck1vZHVsZS5yZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyTW9kdWxlLnJlZnJlc2hVSSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhbGxvd1NlbGVjdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy51aVVwZGF0ZSwgeyBtb2R1bGU6ICdzZWxlY3Rpb24nLCBlbmFibGU6IHRoaXMuYWxsb3dTZWxlY3Rpb24gfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTW9kdWxlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnY3NzQ2xhc3MnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldENTU0NsYXNzKG9sZFByb3AuY3NzQ2xhc3MpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdlbmFibGVBdXRvRmlsbCc6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbk1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmFibGVCb3hTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uTW9kdWxlLnVwZGF0ZUF1dG9GaWxsUG9zaXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdyb3dUZW1wbGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm93VGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIodGhpcy5yb3dUZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZW1wdHlSZWNvcmRUZW1wbGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1wdHlSZWNvcmRUZW1wbGF0ZUZuID0gdGVtcGxhdGVDb21waWxlcih0aGlzLmVtcHR5UmVjb3JkVGVtcGxhdGUpO1xuICAgICAgICAgICAgICAgICAgICByZXF1aXJlUmVmcmVzaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2RldGFpbFRlbXBsYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhaWxUZW1wbGF0ZUZuID0gdGVtcGxhdGVDb21waWxlcih0aGlzLmRldGFpbFRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZVJlZnJlc2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhbGxvd0dyb3VwaW5nJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLnVpVXBkYXRlLCB7IG1vZHVsZTogJ2dyb3VwJywgZW5hYmxlOiB0aGlzLmFsbG93R3JvdXBpbmcgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyTW9kdWxlLnJlZnJlc2hVSSgpO1xuICAgICAgICAgICAgICAgICAgICByZXF1aXJlUmVmcmVzaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrQ3Vyc29yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaGVpZ2h0ID09PSAnMTAwJScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdlbmFibGVJbmZpbml0ZVNjcm9sbGluZyc6XG4gICAgICAgICAgICAgICAgY2FzZSAnY2hpbGRHcmlkJzpcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZVJlZnJlc2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjaGlsZEdyaWRQYXJlbnQgPSB0aGlzLnBhcmVudERldGFpbHMgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgdGhpcy5wYXJlbnREZXRhaWxzLnBhcmVudElEKSA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudEluc3RhbmNlID0gY2hpbGRHcmlkUGFyZW50ID8gY2hpbGRHcmlkUGFyZW50LmVqMl9pbnN0YW5jZXNbMF0gOiBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGlsZEdyaWQgJiYgcGFyZW50SW5zdGFuY2UgJiYgaXNOdWxsT3JVbmRlZmluZWQocGFyZW50SW5zdGFuY2UuY2hpbGRHcmlkLmNoaWxkR3JpZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZEdyaWRPYmplY3QgPSBPYmplY3QuYXNzaWduKHt9LCBwYXJlbnRJbnN0YW5jZS5jaGlsZEdyaWQsIHsgY2hpbGRHcmlkOiBuZXdQcm9wLmNoaWxkR3JpZCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudEluc3RhbmNlLnNldFByb3BlcnRpZXMoeyBjaGlsZEdyaWQ6IGNoaWxkR3JpZE9iamVjdCB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICghaXNOdWxsT3JVbmRlZmluZWQocGFyZW50SW5zdGFuY2UucGFyZW50RGV0YWlscykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFBhcmVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjXCIgKyBwYXJlbnRJbnN0YW5jZS5wYXJlbnREZXRhaWxzLnBhcmVudElEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFBhcmVudEluc3RhbmNlID0gY3VycmVudFBhcmVudCA/IGN1cnJlbnRQYXJlbnQuZWoyX2luc3RhbmNlc1swXSA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRQYXJlbnRJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudENoaWxkT2JqZWN0ID0gT2JqZWN0LmFzc2lnbih7fSwgY3VycmVudFBhcmVudEluc3RhbmNlLmNoaWxkR3JpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDaGlsZE9iamVjdC5jaGlsZEdyaWQgPSBwYXJlbnRJbnN0YW5jZS5jaGlsZEdyaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXJlbnRJbnN0YW5jZS5zZXRQcm9wZXJ0aWVzKHsgY2hpbGRHcmlkOiBjdXJyZW50Q2hpbGRPYmplY3QgfSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudEluc3RhbmNlID0gY3VycmVudFBhcmVudEluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyTW9kdWxlLnJlZnJlc2hVSSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd0b29sYmFyJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLnVpVXBkYXRlLCB7IG1vZHVsZTogJ3Rvb2xiYXInIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oZWlnaHQgPT09ICcxMDAlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxNb2R1bGUucmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2dyb3VwU2V0dGluZ3MnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuaW5Cb3VuZE1vZGVsQ2hhbmdlZCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlOiAnZ3JvdXAnLCBwcm9wZXJ0aWVzOiBuZXdQcm9wLmdyb3VwU2V0dGluZ3MsXG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRQcm9wZXJ0aWVzOiBvbGRQcm9wLmdyb3VwU2V0dGluZ3NcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FnZ3JlZ2F0ZXMnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuYWdncmVnYXRlcy5sZW5ndGggJiYgdGhpcy5hbGxvd0dyb3VwaW5nICYmIHRoaXMuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZVJlZnJlc2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy51aVVwZGF0ZSwgeyBtb2R1bGU6ICdhZ2dyZWdhdGUnLCBwcm9wZXJ0aWVzOiBuZXdQcm9wIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oZWlnaHQgPT09ICcxMDAlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxNb2R1bGUucmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Zyb3plbkNvbHVtbnMnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2Zyb3plblJvd3MnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2VuYWJsZVZpcnR1YWxpemF0aW9uJzpcbiAgICAgICAgICAgICAgICBjYXNlICdlbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbic6XG4gICAgICAgICAgICAgICAgY2FzZSAnY3VycmVuY3lDb2RlJzpcbiAgICAgICAgICAgICAgICBjYXNlICdsb2NhbGUnOlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coJ2Zyb3plbl9yb3dzX2NvbHVtbnMnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmcmVlemVSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZUdyaWRSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGROZXdSb3dGb2N1cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3F1ZXJ5JzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmdldERhdGFNb2R1bGUoKS5pc1F1ZXJ5SW52b2tlZEZyb21EYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlUmVmcmVzaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXREYXRhTW9kdWxlKCkuaXNRdWVyeUludm9rZWRGcm9tRGF0YSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhdXRvRml0JzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYXV0b0ZpdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2ZW50QWRqdXN0Q29sdW1ucygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlQWRqdXN0Q29sdW1ucygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXh0ZW5kZWRQcm9wZXJ0eUNoYW5nZShwcm9wLCBuZXdQcm9wLCByZXF1aXJlR3JpZFJlZnJlc2gpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjaGVja0N1cnNvcikge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVEZWZhdWx0Q3Vyc29yKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlcXVpcmVHcmlkUmVmcmVzaCkge1xuICAgICAgICAgICAgaWYgKGZyZWV6ZVJlZnJlc2ggfHwgdGhpcy5nZXRGcm96ZW5Db2x1bW5zKCkgfHwgdGhpcy5mcm96ZW5Sb3dzXG4gICAgICAgICAgICAgICAgfHwgKHRoaXMuZnJvemVuTGVmdENvbHVtbnMubGVuZ3RoIHx8IHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zLmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZyZWV6ZVJlZnJlc2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJlcXVpcmVSZWZyZXNoKSB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMubW9kZWxDaGFuZ2VkLCBhcmdzKTtcbiAgICAgICAgICAgIHJlcXVpcmVSZWZyZXNoID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm1haW50YWluU2VsZWN0aW9uKG5ld1Byb3Auc2VsZWN0ZWRSb3dJbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmV4dGVuZGVkUHJvcGVydHlDaGFuZ2UgPSBmdW5jdGlvbiAocHJvcCwgbmV3UHJvcCwgcmVxdWlyZUdyaWRSZWZyZXNoKSB7XG4gICAgICAgIHN3aXRjaCAocHJvcCkge1xuICAgICAgICAgICAgY2FzZSAnZW5hYmxlUnRsJzpcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJUTCgpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFsbG93UGFnaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1ncmlkcGFnZXInKS5lajJfaW5zdGFuY2VzWzBdLmVuYWJsZVJ0bCA9IG5ld1Byb3AuZW5hYmxlUnRsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZ3JpZHBhZ2VyJykuZWoyX2luc3RhbmNlc1swXS5kYXRhQmluZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oZWlnaHQgIT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbE1vZHVsZS5yZW1vdmVQYWRkaW5nKCFuZXdQcm9wLmVuYWJsZVJ0bCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlLnNldFBhZGRpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudG9vbGJhciAmJiB0aGlzLnRvb2xiYXJNb2R1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b29sYmFyTW9kdWxlLmdldFRvb2xiYXIoKS5lajJfaW5zdGFuY2VzWzBdLmVuYWJsZVJ0bCA9IG5ld1Byb3AuZW5hYmxlUnRsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvb2xiYXJNb2R1bGUuZ2V0VG9vbGJhcigpLmVqMl9pbnN0YW5jZXNbMF0uZGF0YUJpbmQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29udGV4dE1lbnVJdGVtcyAmJiB0aGlzLmNvbnRleHRNZW51TW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dE1lbnVNb2R1bGUuZ2V0Q29udGV4dE1lbnUoKS5lajJfaW5zdGFuY2VzWzBdLmVuYWJsZVJ0bCA9IG5ld1Byb3AuZW5hYmxlUnRsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHRNZW51TW9kdWxlLmdldENvbnRleHRNZW51KCkuZWoyX2luc3RhbmNlc1swXS5kYXRhQmluZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaG93Q29sdW1uTWVudSAmJiB0aGlzLmNvbHVtbk1lbnVNb2R1bGUgJiYgIXRoaXMuZW5hYmxlQWRhcHRpdmVVSSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbk1lbnVNb2R1bGUuZ2V0Q29sdW1uTWVudSgpLmVqMl9pbnN0YW5jZXNbMF0uZW5hYmxlUnRsID0gbmV3UHJvcC5lbmFibGVSdGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uTWVudU1vZHVsZS5nZXRDb2x1bW5NZW51KCkuZWoyX2luc3RhbmNlc1swXS5kYXRhQmluZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnRmlsdGVyQmFyJyAmJiB0aGlzLmZpbHRlclNldHRpbmdzLnNob3dGaWx0ZXJCYXJPcGVyYXRvcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hIZWFkZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLnJ0bFVwZGF0ZWQsIHt9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2VuYWJsZUFsdFJvdyc6XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJNb2R1bGUucmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnYWxsb3dSZXNpemluZyc6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzaXplTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplTW9kdWxlLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmhlYWRlck1vZHVsZS5yZWZyZXNoVUkoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVJlc2l6ZUxpbmVzKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyb3dIZWlnaHQnOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvd0hlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhbdGhpcy5lbGVtZW50XSwgJ2UtZ3JpZC1taW4taGVpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhbdGhpcy5lbGVtZW50XSwgJ2UtZ3JpZC1taW4taGVpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTW9kdWxlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhlYWRlck1vZHVsZS5yZWZyZXNoVUkoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2dyaWRMaW5lcyc6XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVHcmlkTGluZXMoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Nob3dDb2x1bW5NZW51JzpcbiAgICAgICAgICAgICAgICB0aGlzLmhlYWRlck1vZHVsZS5yZWZyZXNoVUkoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMudWlVcGRhdGUsIHsgbW9kdWxlOiAnY29sdW1uTWVudScsIGVuYWJsZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2NvbHVtbk1lbnVJdGVtcyc6XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLnVpVXBkYXRlLCB7IG1vZHVsZTogJ2NvbHVtbk1lbnUnLCBlbmFibGU6IHRoaXMuY29sdW1uTWVudUl0ZW1zIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnY29udGV4dE1lbnVJdGVtcyc6XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLnVpVXBkYXRlLCB7IG1vZHVsZTogJ2NvbnRleHRNZW51JywgZW5hYmxlOiB0aGlzLmNvbnRleHRNZW51SXRlbXMgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzaG93Q29sdW1uQ2hvb3Nlcic6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudG9vbGJhck1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvb2xiYXJNb2R1bGUucmVmcmVzaFRvb2xiYXJJdGVtcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMudWlVcGRhdGUsIHsgbW9kdWxlOiAnY29sdW1uQ2hvb3NlcicsIGVuYWJsZTogdGhpcy5zaG93Q29sdW1uQ2hvb3NlciB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2ZpbHRlclNldHRpbmdzJzpcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YWNrZWRGaWx0ZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuaW5Cb3VuZE1vZGVsQ2hhbmdlZCwgeyBtb2R1bGU6ICdmaWx0ZXInLCBwcm9wZXJ0aWVzOiBuZXdQcm9wLmZpbHRlclNldHRpbmdzIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnc2VhcmNoU2V0dGluZ3MnOlxuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5pbkJvdW5kTW9kZWxDaGFuZ2VkLCB7IG1vZHVsZTogJ3NlYXJjaCcsIHByb3BlcnRpZXM6IG5ld1Byb3Auc2VhcmNoU2V0dGluZ3MgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzb3J0U2V0dGluZ3MnOlxuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5pbkJvdW5kTW9kZWxDaGFuZ2VkLCB7IG1vZHVsZTogJ3NvcnQnIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnc2VsZWN0aW9uU2V0dGluZ3MnOlxuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5pbkJvdW5kTW9kZWxDaGFuZ2VkLCB7IG1vZHVsZTogJ3NlbGVjdGlvbicsIHByb3BlcnRpZXM6IG5ld1Byb3Auc2VsZWN0aW9uU2V0dGluZ3MgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlZGl0U2V0dGluZ3MnOlxuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5pbkJvdW5kTW9kZWxDaGFuZ2VkLCB7IG1vZHVsZTogJ2VkaXQnLCBwcm9wZXJ0aWVzOiBuZXdQcm9wLmVkaXRTZXR0aW5ncyB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2FsbG93VGV4dFdyYXAnOlxuICAgICAgICAgICAgY2FzZSAndGV4dFdyYXBTZXR0aW5ncyc6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWxsb3dUZXh0V3JhcCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGx5VGV4dFdyYXAoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlVGV4dFdyYXAoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLmZyZWV6ZVJlbmRlciwgeyBjYXNlOiAndGV4dHdyYXAnLCBpc01vZGVDaGc6IChwcm9wID09PSAndGV4dFdyYXBTZXR0aW5ncycpIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaEhlYWRlcigpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhlaWdodCA9PT0gJzEwMCUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdkYXRhU291cmNlJzpcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY2FzZS1kZWNsYXJhdGlvbnNcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdFBlbmRpbmdTdGF0ZSA9IHRoaXMuZ2V0RGF0YU1vZHVsZSgpLmdldFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWxsb3dQYWdpbmcgJiYgdGhpcy5wYWdlU2V0dGluZ3MucGFnZVNpemVzICYmICF0aGlzLmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpXG4gICAgICAgICAgICAgICAgICAgICYmICEocmVxdWVzdFBlbmRpbmdTdGF0ZSAmJiByZXF1ZXN0UGVuZGluZ1N0YXRlLmlzUGVuZGluZykpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFnZXJNb2R1bGUucGFnZXJPYmouaXNBbGxQYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSB0aGlzLmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBEYXRhTWFuYWdlciA/IHRoaXMuZGF0YVNvdXJjZS5kYXRhU291cmNlLmpzb24ubGVuZ3RoIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmVzdWx0JyBpbiB0aGlzLmRhdGFTb3VyY2UgPyB0aGlzLmRhdGFTb3VyY2UuY291bnQgOiB0aGlzLmRhdGFTb3VyY2UubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQWxsUGFnZSA9IEFycmF5LmlzQXJyYXkodGhpcy5wYWdlU2V0dGluZ3MucGFnZVNpemVzKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZVNldHRpbmdzLnBhZ2VTaXplcy5pbmRleE9mKCdBbGwnKSA+IC0xID8gdHJ1ZSA6IHRoaXMucGFnZVNldHRpbmdzLnBhZ2VTaXplcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBbGxQYWdlICYmIHRoaXMucGFnZVNldHRpbmdzLnBhZ2VTaXplICE9PSBjb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZXJNb2R1bGUucGFnZXJPYmouaXNBbGxQYWdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyBwYWdlU2V0dGluZ3M6IHsgcGFnZVNpemU6IGNvdW50IH0gfSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlck1vZHVsZS5wYWdlck9iai5zZXRQcm9wZXJ0aWVzKHsgcGFnZVNpemU6IGNvdW50IH0sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFsbG93U2VsZWN0aW9uICYmIHRoaXMuaXNQZXJzaXN0U2VsZWN0aW9uICYmICEocmVxdWVzdFBlbmRpbmdTdGF0ZSAmJiByZXF1ZXN0UGVuZGluZ1N0YXRlLmlzUGVuZGluZykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZGF0YVNvdXJjZSkgJiYgdGhpcy5kYXRhU291cmNlLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzVmlydHVhbEFkYXB0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChPYmplY3QuZ2V0UHJvdG90eXBlT2YobmV3UHJvcCkuZGVlcFdhdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwS2V5RmllbGQgPSB0aGlzLmdldFByaW1hcnlLZXlGaWVsZE5hbWVzKClbMF07XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBwcm9wcyA9IE9iamVjdC5rZXlzKG5ld1Byb3AuZGF0YVNvdXJjZSk7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRSb3dEYXRhKGdldFZhbHVlKHBLZXlGaWVsZCwgdGhpcy5kYXRhU291cmNlW3Byb3BzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0pLCB0aGlzLmRhdGFTb3VyY2VbcHJvcHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocmVxdWVzdFBlbmRpbmdTdGF0ZS5pc1BlbmRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdSZXN1bHQgPSAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5kYXRhU291cmNlKSA/IHRoaXMuZGF0YVNvdXJjZS5yZXN1bHQgOiBbXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWVzID0gKHJlcXVlc3RQZW5kaW5nU3RhdGUuZ3JvdXAgfHwgW10pO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmFtZXMubGVuZ3RoICYmICF0aGlzLmdyb3VwU2V0dGluZ3MuZW5hYmxlTGF6eUxvYWRpbmcgJiYgIShnUmVzdWx0Lmxlbmd0aCAmJiBnUmVzdWx0WzBdLmZpZWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuYW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdSZXN1bHQgPSBEYXRhVXRpbC5ncm91cChnUmVzdWx0LCBuYW1lc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHJlcXVlc3RQZW5kaW5nU3RhdGUuYWdncmVnYXRlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBbXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhU291cmNlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBnUmVzdWx0LCBjb3VudDogdGhpcy5kYXRhU291cmNlLmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgYWdncmVnYXRlczogdGhpcy5kYXRhU291cmNlLmFnZ3JlZ2F0ZXNcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXREYXRhTW9kdWxlKCkuc2V0U3RhdGUoe30pO1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0UGVuZGluZ1N0YXRlLnJlc29sdmVyKHRoaXMuZGF0YVNvdXJjZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLmRhdGFTb3VyY2UpICYmIHRoaXMuZGF0YVNvdXJjZS5yZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHRoaXMuZGF0YVNvdXJjZS5jb3VudCAmJiB0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ1Jlc3VsdCA9IHRoaXMuZGF0YVNvdXJjZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZXMgPSB0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lcy5sZW5ndGggJiYgIShnUmVzdWx0Lmxlbmd0aCAmJiBnUmVzdWx0WzBdLmZpZWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1Jlc3VsdCA9IERhdGFVdGlsLmdyb3VwKGdSZXN1bHQsIG5hbWVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhU291cmNlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdDogZ1Jlc3VsdCwgY291bnQ6IHRoaXMuZGF0YVNvdXJjZS5jb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldERhdGFNb2R1bGUoKS5zZXRTdGF0ZSh7IGlzRGF0YUNoYW5nZWQ6IGZhbHNlIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuZGF0YVNvdXJjZU1vZGlmaWVkLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVxdWlyZUdyaWRSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlck1vZHVsZS5yZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0NoZWNrQm94U2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLmJlZm9yZVJlZnJlc2hPbkRhdGFDaGFuZ2UsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2VuYWJsZUhvdmVyJzpcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY2FzZS1kZWNsYXJhdGlvbnNcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gbmV3UHJvcC5lbmFibGVIb3ZlciA/IGFkZENsYXNzIDogcmVtb3ZlQ2xhc3M7XG4gICAgICAgICAgICAgICAgYWN0aW9uKFt0aGlzLmVsZW1lbnRdLCAnZS1ncmlkaG92ZXInKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdGVkUm93SW5kZXgnOlxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc1NlbGVjdGVkUm93SW5kZXhVcGRhdGluZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFJvdyhuZXdQcm9wLnNlbGVjdGVkUm93SW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmlzU2VsZWN0ZWRSb3dJbmRleFVwZGF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyZXNpemVTZXR0aW5ncyc6XG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aFNlcnZpY2Uuc2V0V2lkdGhUb1RhYmxlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlbmFibGVBZGFwdGl2ZVVJJzpcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuc2V0RnVsbFNjcmVlbkRpYWxvZywge30pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncm93UmVuZGVyaW5nTW9kZSc6XG4gICAgICAgICAgICAgICAgdGhpcy5lbmFibGVWZXJ0aWNhbFJlbmRlcmluZygpO1xuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5yb3dNb2RlQ2hhbmdlLCB7fSk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlbmFibGVTdGlja3lIZWFkZXInOlxuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlLmFkZFN0aWNreUxpc3RlbmVyKG5ld1Byb3AuZW5hYmxlU3RpY2t5SGVhZGVyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2FsbG93UGRmRXhwb3J0JzpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50b29sYmFyTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9vbGJhck1vZHVsZS5yZWZyZXNoVG9vbGJhckl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnYWxsb3dFeGNlbEV4cG9ydCc6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudG9vbGJhck1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvb2xiYXJNb2R1bGUucmVmcmVzaFRvb2xiYXJJdGVtcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUubWFpbnRhaW5TZWxlY3Rpb24gPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIF90aGlzXzEgPSB0aGlzO1xuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICB2YXIgZm5fMSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpc18xLnNlbGVjdFJvdyhpbmRleCk7XG4gICAgICAgICAgICAgICAgX3RoaXNfMS5vZmYoZXZlbnRzLmNvbnRlbnRSZWFkeSwgZm5fMSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5vbihldmVudHMuY29udGVudFJlYWR5LCBmbl8xLCB0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHByb3AgLSBEZWZpbmVzIHRoZSBwcm9wZXJ0eVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbXV0ZU9uQ2hhbmdlIC0gRGVmaW5lcyB0aGUgbXV0ZSBvbiBjaGFuZ2VcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNldFByb3BlcnRpZXMgPSBmdW5jdGlvbiAocHJvcCwgbXV0ZU9uQ2hhbmdlKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuc2V0UHJvcGVydGllcy5jYWxsKHRoaXMsIHByb3AsIG11dGVPbkNoYW5nZSk7XG4gICAgICAgIHZhciBmaWx0ZXJTZXR0aW5ncyA9ICdmaWx0ZXJTZXR0aW5ncyc7XG4gICAgICAgIGlmIChwcm9wW1wiXCIgKyBmaWx0ZXJTZXR0aW5nc10gJiYgdGhpcy5maWx0ZXJNb2R1bGUgJiYgbXV0ZU9uQ2hhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlck1vZHVsZS5yZWZyZXNoRmlsdGVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAtIFJldHVybnMgdGhlIHRhYmxlcyBjb3VudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFRhYmxlc0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50YWJsZXNDb3VudDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS51cGRhdGVEZWZhdWx0Q3Vyc29yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaGVhZGVyQ2VsbHMgPSBbXS5zbGljZS5jYWxsKHRoaXMuZ2V0SGVhZGVyQ29udGVudCgpLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLWhlYWRlcmNlbGw6bm90KC5lLXN0YWNrZWRoZWFkZXJjZWxsKScpKTtcbiAgICAgICAgdmFyIHN0ZEhkckNlbGwgPSBbXS5zbGljZS5jYWxsKHRoaXMuZ2V0SGVhZGVyQ29udGVudCgpLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Utc3RhY2tlZGhlYWRlcmNlbGwnKSk7XG4gICAgICAgIHZhciBjb2xzID0gdGhpcy5nZXRDb2x1bW5zKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGVhZGVyQ2VsbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjZWxsID0gaGVhZGVyQ2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgaWYgKHRoaXMuYWxsb3dHcm91cGluZyB8fCB0aGlzLmFsbG93UmVvcmRlcmluZyB8fCB0aGlzLmFsbG93U29ydGluZykge1xuICAgICAgICAgICAgICAgIGlmICghY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uYWxsb3dSZW9yZGVyaW5nIHx8ICFjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5hbGxvd1NvcnRpbmdcbiAgICAgICAgICAgICAgICAgICAgfHwgIWNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmFsbG93R3JvdXBpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdlLWRlZmF1bHRjdXJzb3InKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnZS1tb3VzZXBvaW50ZXInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgY291bnQgPSAwOyBjb3VudCA8IHN0ZEhkckNlbGwubGVuZ3RoOyBjb3VudCsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbGxvd1Jlb3JkZXJpbmcpIHtcbiAgICAgICAgICAgICAgICBzdGRIZHJDZWxsW3BhcnNlSW50KGNvdW50LnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZCgnZS1tb3VzZXBvaW50ZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUudXBkYXRlQ29sdW1uTW9kZWwgPSBmdW5jdGlvbiAoY29sdW1ucywgaXNSZWN1cnNpb24pIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9ICghaXNOdWxsT3JVbmRlZmluZWQoY29sdW1ucykgPyBjb2x1bW5zLmxlbmd0aCA6IDApOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb2x1bW5Nb2RlbChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uTW9kZWwucHVzaChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGlzUmVjdXJzaW9uKSB8fCAhaXNSZWN1cnNpb24pIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTG9ja2FibGVDb2x1bW5zKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZyb3plbkxlZnRDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RnJvemVuQ29sdW1ucygpIHx8IHRoaXMuZ2V0RnJvemVuTGVmdENvbHVtbnNDb3VudCgpO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuaXNGcm96ZW5HcmlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRGcm96ZW5Db2x1bW5zKCkgIT09IDAgfHwgdGhpcy5mcm96ZW5MZWZ0Q29sdW1ucy5sZW5ndGggIT09IDAgfHwgdGhpcy5mcm96ZW5SaWdodENvbHVtbnMubGVuZ3RoICE9PSAwIHx8XG4gICAgICAgICAgICB0aGlzLmZpeGVkQ29sdW1ucy5sZW5ndGggIT09IDA7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5nZXRGcm96ZW5Nb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mcm96ZW5OYW1lO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUudXBkYXRlTG9ja2FibGVDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29scyA9IHRoaXMuY29sdW1uTW9kZWw7XG4gICAgICAgIHZhciBmcm96ZW5Db3VudCA9IDA7XG4gICAgICAgIHZhciBtb3ZhYmxlQ291bnQgPSAwO1xuICAgICAgICB2YXIgZnJvemVuQ29sdW1ucyA9IHRoaXMuZ2V0RnJvemVuQ29sdW1ucygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5sb2NrQ29sdW1uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgPCBmcm96ZW5Db2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHMuc3BsaWNlKGZyb3plbkNvdW50LCAwLCBjb2xzLnNwbGljZShpLCAxKVswXSk7XG4gICAgICAgICAgICAgICAgICAgIGZyb3plbkNvdW50Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb2xzLnNwbGljZShmcm96ZW5Db2x1bW5zICsgbW92YWJsZUNvdW50LCAwLCBjb2xzLnNwbGljZShpLCAxKVswXSk7XG4gICAgICAgICAgICAgICAgICAgIG1vdmFibGVDb3VudCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuY2hlY2tMb2NrQ29sdW1ucyA9IGZ1bmN0aW9uIChjb2xzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrTG9ja0NvbHVtbnMoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5sb2NrQ29sdW1uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2NrY29sUG9zaXRpb25Db3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcG9zaXRpb24gLSBzcGVjaWZpZXMgcG9zaXRpb25cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSByZXR1cm5zIHRoZSB3aWR0aFxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5sZWZ0cmlnaHRDb2x1bW5XaWR0aCA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICB2YXIgY29scyA9IHBvc2l0aW9uID09PSAnbGVmdCcgPyB0aGlzLmdldEZyb3plbkxlZnRDb2x1bW5zKCkgOiBwb3NpdGlvbiA9PT0gJ3JpZ2h0JyA/IHRoaXMuZ2V0RnJvemVuUmlnaHRDb2x1bW5zKCkgOiBbXTtcbiAgICAgICAgdmFyIHdpZHRoID0gMDtcbiAgICAgICAgY29scy5maWx0ZXIoZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgaWYgKGNvbC52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgd2lkdGggKz0gcGFyc2VJbnQoY29sLndpZHRoLnRvU3RyaW5nKCksIDEwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB3aWR0aDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGNvbHVtbnMgZnJvbSB0aGUgR3JpZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNSZWZyZXNoIC0gRGVmaW5lcyB0aGUgYm9vbGVhbiB3aGV0aGVyIHRvIHJlZnJlc2hcbiAgICAgKiBAcmV0dXJucyB7Q29sdW1uW119IC0gcmV0dXJucyB0aGUgY29sdW1uXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Q29sdW1ucyA9IGZ1bmN0aW9uIChpc1JlZnJlc2gpIHtcbiAgICAgICAgdmFyIF90aGlzXzEgPSB0aGlzO1xuICAgICAgICB2YXIgaW52aWV3ID0gdGhpcy5pblZpZXdJbmRleGVzLm1hcChmdW5jdGlvbiAodikgeyByZXR1cm4gdiAtIF90aGlzXzEuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aDsgfSkuZmlsdGVyKGZ1bmN0aW9uICh2KSB7IHJldHVybiB2ID4gLTE7IH0pO1xuICAgICAgICB2YXIgdkxlbiA9IGludmlldy5sZW5ndGg7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiB8fCBpc051bGxPclVuZGVmaW5lZCh0aGlzLmNvbHVtbk1vZGVsKSB8fCB0aGlzLmNvbHVtbk1vZGVsLmxlbmd0aCA9PT0gMCB8fCBpc1JlZnJlc2gpIHtcbiAgICAgICAgICAgIHRoaXMuY29sdW1uTW9kZWwgPSBbXTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29sdW1uTW9kZWwodGhpcy5jb2x1bW5zKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29sdW1ucyA9IHZMZW4gPT09IDAgPyB0aGlzLmNvbHVtbk1vZGVsIDpcbiAgICAgICAgICAgIHRoaXMuZ2V0VmlzaWJsZUNvbHVtbnMoKS5zbGljZShpbnZpZXdbMF0sIGludmlld1t2TGVuIC0gMV0gKyAxKTtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIHZhciBtb3ZhYmxlID0gW107XG4gICAgICAgIHZhciBpc0xlZnRSaWdodEZyb3plbiA9IHRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgdGhpcy5pc1ByZXBhcmVkRnJvemVuQ29sdW1ucyAmJiB2TGVuID09PSAwO1xuICAgICAgICBpZiAoaXNMZWZ0UmlnaHRGcm96ZW4pIHtcbiAgICAgICAgICAgIHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zID0gW107XG4gICAgICAgICAgICB0aGlzLmZyb3plbkxlZnRDb2x1bW5zID0gW107XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnTGVmdCcgfHwgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNGcm96ZW4pIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIGlmIChpc0xlZnRSaWdodEZyb3plbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyb3plbkxlZnRDb2x1bW5zLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZyZWV6ZSA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIGlmIChpc0xlZnRSaWdodEZyb3plbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyb3plblJpZ2h0Q29sdW1ucy5wdXNoKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBtb3ZhYmxlLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uICYmIHRoaXMuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmZyb3plbkxlZnRDb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGxlZnQgPSB0aGlzLmZyb3plbkxlZnRDb2x1bW5zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJpZ2h0ID0gdGhpcy5mcm96ZW5SaWdodENvbHVtbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxlZnQuY29uY2F0KG1vdmFibGUpLmNvbmNhdChyaWdodCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdGFja2VkSGVhZGVyIC0gRGVmaW5lcyB0aGUgc3RhY2tlZCBoZWFkZXJcbiAgICAgKiBAcGFyYW0ge0NvbHVtbltdfSBjb2wgLSBEZWZpbmVzIHRoZSBjb2x1bW5cbiAgICAgKiBAcmV0dXJucyB7Q29sdW1ufSBSZXR1cm5zIHRoZSBDb2x1bW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRTdGFja2VkSGVhZGVyQ29sdW1uQnlIZWFkZXJUZXh0ID0gZnVuY3Rpb24gKHN0YWNrZWRIZWFkZXIsIGNvbCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGluZGl2aWR1YWxDb2x1bW4gPSBjb2xbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgaWYgKGluZGl2aWR1YWxDb2x1bW4uZmllbGQgPT09IHN0YWNrZWRIZWFkZXIgfHwgaW5kaXZpZHVhbENvbHVtbi5oZWFkZXJUZXh0ID09PSBzdGFja2VkSGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkQ29sdW1uID0gaW5kaXZpZHVhbENvbHVtbjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGluZGl2aWR1YWxDb2x1bW4uY29sdW1ucykge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U3RhY2tlZEhlYWRlckNvbHVtbkJ5SGVhZGVyVGV4dChzdGFja2VkSGVhZGVyLCBpbmRpdmlkdWFsQ29sdW1uLmNvbHVtbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnN0YWNrZWRDb2x1bW47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEByZXR1cm5zIHtudW1iZXJbXX0gUmV0dXJucyB0aGUgY29sdW1uIGluZGV4ZXNcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRDb2x1bW5JbmRleGVzSW5WaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pblZpZXdJbmRleGVzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IC0gcmV0dXJucyB0aGUgcXVlcnlcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRRdWVyeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcnk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IC0gcmV0dXJucyB0aGUgbG9jYWxlIGNvbnN0YW50c1xuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldExvY2FsZUNvbnN0YW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdExvY2FsZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IGluZGV4ZXMgLSBzcGVjaWZpZXMgdGhlIGluZGV4ZXNcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNldENvbHVtbkluZGV4ZXNJblZpZXcgPSBmdW5jdGlvbiAoaW5kZXhlcykge1xuICAgICAgICB0aGlzLmluVmlld0luZGV4ZXMgPSBpbmRleGVzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgdmlzaWJsZSBjb2x1bW5zIGZyb20gdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Q29sdW1uW119IHJldHVybnMgdGhlIGNvbHVtblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFZpc2libGVDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRDdXJyZW50VmlzaWJsZUNvbHVtbnMoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGhlYWRlciBkaXYgb2YgdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gLSBSZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0SGVhZGVyQ29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyTW9kdWxlLmdldFBhbmVsKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBoZWFkZXIgZGl2IG9mIHRoZSBHcmlkIHRvIHJlcGxhY2UgdGhlIG9sZCBoZWFkZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtFbGVtZW50fSBlbGVtZW50IC0gU3BlY2lmaWVzIHRoZSBHcmlkIGhlYWRlci5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNldEdyaWRIZWFkZXJDb250ZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJNb2R1bGUuc2V0UGFuZWwoZWxlbWVudCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb250ZW50IHRhYmxlIG9mIHRoZSBHcmlkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IC0gUmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldENvbnRlbnRUYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudE1vZHVsZS5nZXRUYWJsZSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY29udGVudCB0YWJsZSBvZiB0aGUgR3JpZCB0byByZXBsYWNlIHRoZSBvbGQgY29udGVudCB0YWJsZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0VsZW1lbnR9IGVsZW1lbnQgLSBTcGVjaWZpZXMgdGhlIEdyaWQgY29udGVudCB0YWJsZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNldEdyaWRDb250ZW50VGFibGUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICB0aGlzLmNvbnRlbnRNb2R1bGUuc2V0VGFibGUoZWxlbWVudCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb250ZW50IGRpdiBvZiB0aGUgR3JpZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSBSZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Q29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudE1vZHVsZS5nZXRQYW5lbCgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY29udGVudCBkaXYgb2YgdGhlIEdyaWQgdG8gcmVwbGFjZSB0aGUgb2xkIEdyaWQgY29udGVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0VsZW1lbnR9IGVsZW1lbnQgLSBTcGVjaWZpZXMgdGhlIEdyaWQgY29udGVudC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNldEdyaWRDb250ZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5jb250ZW50TW9kdWxlLnNldFBhbmVsKGVsZW1lbnQpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgaGVhZGVyIHRhYmxlIGVsZW1lbnQgb2YgdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEhlYWRlclRhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oZWFkZXJNb2R1bGUuZ2V0VGFibGUoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGhlYWRlciB0YWJsZSBvZiB0aGUgR3JpZCB0byByZXBsYWNlIHRoZSBvbGQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7RWxlbWVudH0gZWxlbWVudCAtIFNwZWNpZmllcyB0aGUgR3JpZCBoZWFkZXIgdGFibGUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zZXRHcmlkSGVhZGVyVGFibGUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICB0aGlzLmhlYWRlck1vZHVsZS5zZXRUYWJsZShlbGVtZW50KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGZvb3RlciBkaXYgb2YgdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZvb3RlckNvbnRlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZm9vdGVyRWxlbWVudCA9IHRoaXMuZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGxpdGVyYWxzLmdyaWRGb290ZXIpWzBdO1xuICAgICAgICByZXR1cm4gdGhpcy5mb290ZXJFbGVtZW50O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgZm9vdGVyIHRhYmxlIGVsZW1lbnQgb2YgdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZvb3RlckNvbnRlbnRUYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5mb290ZXJFbGVtZW50ID0gdGhpcy5lbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUobGl0ZXJhbHMuZ3JpZEZvb3RlcilbMF07XG4gICAgICAgIHJldHVybiB0aGlzLmZvb3RlckVsZW1lbnQuZmlyc3RDaGlsZC5maXJzdENoaWxkO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgcGFnZXIgb2YgdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFBhZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ncmlkUGFnZXI7IC8vZ2V0IGVsZW1lbnQgZnJvbSBwYWdlclxuICAgIH07XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcGFnZXIgb2YgdGhlIEdyaWQgdG8gcmVwbGFjZSB0aGUgb2xkIHBhZ2VyLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7RWxlbWVudH0gZWxlbWVudCAtIFNwZWNpZmllcyB0aGUgR3JpZCBwYWdlci5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNldEdyaWRQYWdlciA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuZ3JpZFBhZ2VyID0gZWxlbWVudDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSByb3cgYnkgaW5kZXguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGluZGV4IC0gU3BlY2lmaWVzIHRoZSByb3cgaW5kZXguXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFJvd0J5SW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgdGhpcy5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sYXp5TG9hZFJlbmRlci5nZXRSb3dCeUluZGV4KGluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0Um93QnlJbmRleChpbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBtb3ZhYmxlIHRhYmxlcyByb3cgYnkgaW5kZXguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGluZGV4IC0gU3BlY2lmaWVzIHRoZSByb3cgaW5kZXguXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0TW92YWJsZVJvd0J5SW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudE1vZHVsZS5nZXRSb3dCeUluZGV4KGluZGV4KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBmcm96ZW4gdGFibGVzIHJvdyBieSBpbmRleC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gaW5kZXggLSBTcGVjaWZpZXMgdGhlIHJvdyBpbmRleC5cbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RnJvemVuUm93QnlJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50TW9kdWxlLmdldFJvd0J5SW5kZXgoaW5kZXgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgdGhlIGRhdGEgcm93cyBvZiB0aGUgR3JpZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50W119IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRSb3dzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50TW9kdWxlLmdldFJvd0VsZW1lbnRzKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIGEgZnJvemVuIHJpZ2h0IHRhYmxlcyByb3cgZWxlbWVudCBieSBpbmRleC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gaW5kZXggLSBTcGVjaWZpZXMgdGhlIHJvdyBpbmRleC5cbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RnJvemVuUmlnaHRSb3dCeUluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0Um93QnlJbmRleChpbmRleCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgYSByb3cgaW5mb3JtYXRpb24gYmFzZWQgb24gY2VsbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50IHwgRXZlbnRUYXJnZXR9IHRhcmdldCAtIHNwZWNpZmllcyB0aGUgZWxlbWVudFxuICAgICAqXG4gICAgICogQHJldHVybnMge1Jvd0luZm99IHJldHVybnMgdGhlIHJvdyBpbmZvXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Um93SW5mbyA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgdmFyIGVsZSA9IHRhcmdldDtcbiAgICAgICAgdmFyIGFyZ3MgPSB7IHRhcmdldDogdGFyZ2V0IH07XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGFyZ2V0KSAmJiBpc051bGxPclVuZGVmaW5lZChwYXJlbnRzVW50aWwoZWxlLCAnZS1kZXRhaWxyb3djb2xsYXBzZScpXG4gICAgICAgICAgICAmJiBpc051bGxPclVuZGVmaW5lZChwYXJlbnRzVW50aWwoZWxlLCAnZS1yZWNvcmRwbHVzZXhwYW5kJykpKSkge1xuICAgICAgICAgICAgdmFyIGNlbGwgPSBjbG9zZXN0KGVsZSwgJy4nICsgbGl0ZXJhbHMucm93Q2VsbCk7XG4gICAgICAgICAgICBpZiAoIWNlbGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgcm93XzEgPSBjbG9zZXN0KGVsZSwgJy4nICsgbGl0ZXJhbHMucm93KTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHJvd18xKSAmJiAhcm93XzEuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWFkZGVkcm93JykpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvd09iaiA9IHRoaXMuZ2V0Um93T2JqZWN0RnJvbVVJRChyb3dfMS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdWlkJykpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm93SW5kZXggPSBwYXJzZUludChyb3dfMS5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSwgMTApIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgYXJncyA9IHsgcm93OiByb3dfMSwgcm93RGF0YTogcm93T2JqLmRhdGEsIHJvd0luZGV4OiByb3dJbmRleCB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYXJncztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjZWxsSW5kZXggPSBwYXJzZUludChjZWxsLmdldEF0dHJpYnV0ZShsaXRlcmFscy5hcmlhQ29sSW5kZXgpLCAxMCkgLSAxO1xuICAgICAgICAgICAgdmFyIHJvd18yID0gY2xvc2VzdChjZWxsLCAnLicgKyBsaXRlcmFscy5yb3cpO1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjZWxsKSAmJiAhaXNOYU4oY2VsbEluZGV4KSAmJiAhaXNOdWxsT3JVbmRlZmluZWQocm93XzIpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvd0luZGV4ID0gcGFyc2VJbnQocm93XzIuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICAgICAgdmFyIHJvd3MgPSB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0Um93cygpO1xuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGNlbGxJbmRleCArIHRoaXMuZ2V0SW5kZW50Q291bnQoKTtcbiAgICAgICAgICAgICAgICB2YXIgcm93c09iamVjdCA9IHJvd3MuZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnVpZCA9PT0gcm93XzIuZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpOyB9KTtcbiAgICAgICAgICAgICAgICB2YXIgcm93RGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgIHZhciBjb2x1bW4gPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHJvd3NPYmplY3QpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByb3dEYXRhID0gcm93c09iamVjdFswXS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSByb3dzT2JqZWN0WzBdLmNlbGxzW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0uY29sdW1uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhcmdzID0geyBjZWxsOiBjZWxsLCBjZWxsSW5kZXg6IGNlbGxJbmRleCwgcm93OiByb3dfMiwgcm93SW5kZXg6IHJvd0luZGV4LCByb3dEYXRhOiByb3dEYXRhLCBjb2x1bW46IGNvbHVtbiwgdGFyZ2V0OiB0YXJnZXQgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJncztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIEdyaWQncyBtb3ZhYmxlIGNvbnRlbnQgcm93cyBmcm9tIGZyb3plbiBncmlkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0VsZW1lbnRbXX0gcmV0dXJucyB0aGUgZWxlbWVudFxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0TW92YWJsZVJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0Um93RWxlbWVudHMoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIEdyaWQncyBmcm96ZW4gcmlnaHQgY29udGVudCByb3dzIGZyb20gZnJvemVuIGdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudFtdfSByZXR1cm5zIHRoZSBlbGVtZW50XG5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRGcm96ZW5SaWdodFJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0Um93RWxlbWVudHMoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIHRoZSBHcmlkJ3MgZGF0YSByb3dzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0VsZW1lbnRbXX0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldERhdGFSb3dzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxEYXRhUm93cygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpbmNsdWRlQWRkIC0gc3BlY2lmaWVzIGluY2x1ZGVBZGRcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudFtdfSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEFsbERhdGFSb3dzID0gZnVuY3Rpb24gKGluY2x1ZGVBZGQpIHtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZ2V0Q29udGVudFRhYmxlKCkucXVlcnlTZWxlY3RvcihsaXRlcmFscy50Ym9keSkpKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRib2R5ID0gdGhpcy5nZXRDb250ZW50VGFibGUoKS5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLnRib2R5KTtcbiAgICAgICAgdmFyIHJvd3MgPSBbXS5zbGljZS5jYWxsKHRib2R5LmNoaWxkcmVuKTtcbiAgICAgICAgaWYgKHRoaXMuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cpIHtcbiAgICAgICAgICAgIGlmIChyb3dzWzBdLmNsYXNzTGlzdC5jb250YWlucygnZS1hZGRlZHJvdycpKSB7XG4gICAgICAgICAgICAgICAgcm93cy5zaGlmdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocm93c1tyb3dzLmxlbmd0aCAtIDFdLmNsYXNzTGlzdC5jb250YWlucygnZS1hZGRlZHJvdycpKSB7XG4gICAgICAgICAgICAgICAgcm93cy5wb3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5mcm96ZW5Sb3dzKSB7XG4gICAgICAgICAgICB2YXIgaGRyVGJvZHkgPSB0aGlzLmdldEhlYWRlclRhYmxlKCkucXVlcnlTZWxlY3RvcihsaXRlcmFscy50Ym9keSk7XG4gICAgICAgICAgICB2YXIgZnJlZXplUm93cyA9IFtdLnNsaWNlLmNhbGwoaGRyVGJvZHkuY2hpbGRyZW4pO1xuICAgICAgICAgICAgcm93cyA9IHRoaXMuYWRkTW92YWJsZVJvd3MoZnJlZXplUm93cywgcm93cyk7XG4gICAgICAgICAgICBpZiAodGhpcy5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJiBmcmVlemVSb3dzWzBdLmNsYXNzTGlzdC5jb250YWlucygnZS1hZGRlZHJvdycpKSB7XG4gICAgICAgICAgICAgICAgZnJlZXplUm93cy5zaGlmdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBkYXRhUm93cyA9IHRoaXMuZ2VuZXJhdGVEYXRhUm93cyhyb3dzLCBpbmNsdWRlQWRkKTtcbiAgICAgICAgcmV0dXJuIGRhdGFSb3dzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudFtdfSBmUm93cyAtIERlZmluZXMgdGhlIGZyb3plbiBSb3dzXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudFtdfSBtcm93cyAtIERlZmluZXMgdGhlIG1vdmFibGUgUm93c1xuICAgICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudFtdfSBSZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmFkZE1vdmFibGVSb3dzID0gZnVuY3Rpb24gKGZSb3dzLCBtcm93cykge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbXJvd3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGZSb3dzLnB1c2gobXJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZlJvd3M7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5nZW5lcmF0ZURhdGFSb3dzID0gZnVuY3Rpb24gKHJvd3MsIGluY2x1ZEFkZCkge1xuICAgICAgICB2YXIgZFJvd3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJvd3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChyb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMucm93KVxuICAgICAgICAgICAgICAgICYmICghcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWhpZGRlbnJvdycpIHx8IGluY2x1ZEFkZCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0NvbGxhcHNlU3RhdGVFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZFJvd3NbcGFyc2VJbnQocm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZ2V0QXR0cmlidXRlKCdhcmlhLXJvd2luZGV4JyksIDEwKSAtIDFdID0gcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkUm93cy5wdXNoKHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRSb3dzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgdGhlIEdyaWQncyBtb3ZhYmxlIHRhYmxlIGRhdGEgcm93cy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50W119IFJldHVybnMgdGhlIGVsZW1lbnRcblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldE1vdmFibGVEYXRhUm93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsTW92YWJsZURhdGFSb3dzKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGluY2x1ZGVBZGQgRGVmaW5lcyB0aGUgaW5jbHVkZSBhZGQgaW4gYm9vbGVhblxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50W119IFJldHVybnMgdGhlIGVsZW1lbnRcblxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRBbGxNb3ZhYmxlRGF0YVJvd3MgPSBmdW5jdGlvbiAoaW5jbHVkZUFkZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxEYXRhUm93cyhpbmNsdWRlQWRkKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIHRoZSBHcmlkJ3MgZnJvemVuIHRhYmxlIGRhdGEgcm93cy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50W119IHJldHVybnMgdGhlIGVsZW1lbnRcblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZyb3plbkRhdGFSb3dzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxGcm96ZW5EYXRhUm93cygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpbmNsdWRlQWRkIERlZmluZXMgdGhlIGluY2x1ZGUgYWRkIGluIGJvb2xlYW5cbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudFtdfSBSZXR1cm5zIHRoZSBlbGVtZW50XG5cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0QWxsRnJvemVuRGF0YVJvd3MgPSBmdW5jdGlvbiAoaW5jbHVkZUFkZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxEYXRhUm93cyhpbmNsdWRlQWRkKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIHRoZSBHcmlkJ3MgZnJvemVuIHJpZ2h0IHRhYmxlIGRhdGEgcm93cy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50W119IFJldHVybnMgdGhlIEVsZW1lbnRcblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZyb3plblJpZ2h0RGF0YVJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEFsbEZyb3plblJpZ2h0RGF0YVJvd3MoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaW5jbHVkZUFkZCBEZWZpbmVzIHRoZSBpbmNsdWRlIGFkZCBpbiBib29sZWFuXG4gICAgICogQHJldHVybnMge0VsZW1lbnRbXX0gUmV0dXJucyB0aGUgZWxlbWVudFxuXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEFsbEZyb3plblJpZ2h0RGF0YVJvd3MgPSBmdW5jdGlvbiAoaW5jbHVkZUFkZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxEYXRhUm93cyhpbmNsdWRlQWRkKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgcGFydGljdWxhciBjZWxsIHZhbHVlIGJhc2VkIG9uIHRoZSBnaXZlbiBwcmltYXJ5IGtleSB2YWx1ZS5cbiAgICAgKiA+IFByaW1hcnkga2V5IGNvbHVtbiBtdXN0IGJlIHNwZWNpZmllZCB1c2luZyBgY29sdW1ucy5pc1ByaW1hcnlLZXlgIHByb3BlcnR5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd8IG51bWJlcn0ga2V5IC0gU3BlY2lmaWVzIHRoZSBQcmltYXJ5S2V5IHZhbHVlIG9mIGRhdGFTb3VyY2UuXG4gICAgICogQHBhcmFtIHtzdHJpbmcgfSBmaWVsZCAtIFNwZWNpZmllcyB0aGUgZmllbGQgbmFtZSB3aGljaCB5b3Ugd2FudCB0byB1cGRhdGUuXG4gICAgICogQHBhcmFtIHtzdHJpbmcgfCBudW1iZXIgfCBib29sZWFuIHwgRGF0ZX0gdmFsdWUgLSBUbyB1cGRhdGUgbmV3IHZhbHVlIGZvciB0aGUgcGFydGljdWxhciBjZWxsLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2V0Q2VsbFZhbHVlID0gZnVuY3Rpb24gKGtleSwgZmllbGQsIHZhbHVlKSB7XG4gICAgICAgIHZhciBjZWxscyA9ICdjZWxscyc7XG4gICAgICAgIHZhciByb3dEYXRhID0gJ2RhdGEnO1xuICAgICAgICB2YXIgcm93SWR4ID0gJ2luZGV4JztcbiAgICAgICAgdmFyIHJvd3VJRCA9ICd1aWQnO1xuICAgICAgICB2YXIgcGtOYW1lID0gdGhpcy5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpWzBdO1xuICAgICAgICB2YXIgY2VsbCA9IG5ldyBDZWxsUmVuZGVyZXIodGhpcywgdGhpcy5zZXJ2aWNlTG9jYXRvcik7XG4gICAgICAgIHZhciBmaWVsZElkeCA9IHRoaXMuZ2V0Q29sdW1uSW5kZXhCeUZpZWxkKGZpZWxkKTtcbiAgICAgICAgdmFyIGNvbCA9IHRoaXMuZ2V0Q29sdW1uQnlGaWVsZChmaWVsZCk7XG4gICAgICAgIHZhciByb3dPYmplY3RzID0gdGhpcy5jb250ZW50TW9kdWxlLmdldFJvd3MoKTtcbiAgICAgICAgdmFyIHNlbGVjdGVkUm93ID0gcm93T2JqZWN0cy5maWx0ZXIoZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRWYWx1ZShwa05hbWUsIHIuZGF0YSkgPT09IGtleTtcbiAgICAgICAgfSlbMF07XG4gICAgICAgIHZhciB0ciA9IHNlbGVjdGVkUm93ID8gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXVpZD0nICsgc2VsZWN0ZWRSb3dbXCJcIiArIHJvd3VJRF0gKyAnXScpIDogbnVsbDtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh0cikpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLnNhbml0aXplKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldFZhbHVlKGZpZWxkLCB2YWx1ZSwgc2VsZWN0ZWRSb3dbXCJcIiArIHJvd0RhdGFdKTtcbiAgICAgICAgICAgIHZhciB0ZCA9IHRoaXMuZW5hYmxlVmlydHVhbGl6YXRpb24gPyB0ci5jaGlsZHJlbltwYXJzZUludChmaWVsZElkeC50b1N0cmluZygpLCAxMCldXG4gICAgICAgICAgICAgICAgOiB0aGlzLmdldENlbGxGcm9tSW5kZXgoc2VsZWN0ZWRSb3dbXCJcIiArIHJvd0lkeF0sIGZpZWxkSWR4KTtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIElkeCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZElkeCA9IGZpZWxkSWR4ICsgdGhpcy5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGlsZEdyaWQgfHwgdGhpcy5kZXRhaWxUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZElkeCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1Jvd0RyYWdhYmxlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRJZHgrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNSb3cgPSBzZWxlY3RlZFJvd1tcIlwiICsgY2VsbHNdW2ZpZWxkSWR4IC0gSWR4XTtcbiAgICAgICAgICAgICAgICBjZWxsLnJlZnJlc2hURCh0ZCwgc1Jvdywgc2VsZWN0ZWRSb3dbXCJcIiArIHJvd0RhdGFdLCB7IGluZGV4OiBzZWxlY3RlZFJvd1tcIlwiICsgcm93SWR4XSB9KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JlYWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRkID0gdGhpcy5lbmFibGVWaXJ0dWFsaXphdGlvbiA/IHRyLmNoaWxkcmVuW3BhcnNlSW50KGZpZWxkSWR4LnRvU3RyaW5nKCksIDEwKV1cbiAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5nZXRDZWxsRnJvbUluZGV4KHNlbGVjdGVkUm93W1wiXCIgKyByb3dJZHhdLCBmaWVsZElkeCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFnZ3JlZ2F0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMucmVmcmVzaEZvb3RlclJlbmRlcmVyLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuZ3JvdXBBZ2dyZWdhdGVzLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyogdHNsaW50OmRpc2FibGU6bm8tc3RyaW5nLWxpdGVyYWwgKi9cbiAgICAgICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHNlbGVjdGVkUm93KSAmJiAhaXNOdWxsT3JVbmRlZmluZWQoc2VsZWN0ZWRSb3dbJ2NoYW5nZXMnXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3dbJ2NoYW5nZXMnXVtcIlwiICsgZmllbGRdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qIHRzbGludDpkaXNhYmxlOm5vLXN0cmluZy1saXRlcmFsICovXG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKGV2ZW50cy5xdWVyeUNlbGxJbmZvLCB7XG4gICAgICAgICAgICAgICAgICAgIGNlbGw6IHRkLCBjb2x1bW46IGNvbCwgZGF0YTogc2VsZWN0ZWRSb3dbXCJcIiArIHJvd0RhdGFdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNSZWFjdCAmJiB0ZC5nZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JykgPT09ICcwJyAmJiB0ZC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZm9jdXNlZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRkLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sdW1uVWlkIC0gRGVmaW5lcyBjb2x1bW4gdWlkXG4gICAgICogQHBhcmFtIHtib29sZWFufSByZW5kZXJUZW1wbGF0ZXMgLSBEZWZpbmVzIHJlbmRlclRlbXBsYXRlcyBuZWVkIHRvIGludm9rZVxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5yZWZyZXNoUmVhY3RDb2x1bW5UZW1wbGF0ZUJ5VWlkID0gZnVuY3Rpb24gKGNvbHVtblVpZCwgcmVuZGVyVGVtcGxhdGVzKSB7XG4gICAgICAgIHZhciBfdGhpc18xID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuaXNSZWFjdCkge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIHRoaXMuY2xlYXJUZW1wbGF0ZShbJ2NvbHVtblRlbXBsYXRlJ10sIHVuZGVmaW5lZCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBpc0NoaWxkR3JpZCA9IF90aGlzXzEuY2hpbGRHcmlkICYmIF90aGlzXzEuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZS1jaGlsZGdyaWQnKS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIHJvd3MgPSBpc0NoaWxkR3JpZCA/IF90aGlzXzEuZ2V0Q29udGVudFRhYmxlKCkucXVlcnlTZWxlY3RvckFsbCgnLmUtcm93JykgOlxuICAgICAgICAgICAgICAgICAgICBfdGhpc18xLmdldERhdGFSb3dzKCk7XG4gICAgICAgICAgICAgICAgX3RoaXNfMS5yZWZyZXNoUmVhY3RUZW1wbGF0ZVREKHJvd3MsIGlzQ2hpbGRHcmlkKTtcbiAgICAgICAgICAgICAgICBpZiAocmVuZGVyVGVtcGxhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzXzEucmVuZGVyVGVtcGxhdGVzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudFtdIHwgTm9kZUxpc3RPZjxFbGVtZW50Pn0gcm93cyAtIERlZmluZXMgdGhlIHJvd3NcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzQ2hpbGRHcmlkIC0gRGVmaW5lcyB3aGV0aGVyIGl0IGlzIGEgSGllcmFyY2h5IEdyaWQuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0Zyb3plbiAtIERlZmluZXMgd2hldGhlciBpdCBpcyBhIEZyb3plbiBHcmlkXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnJlZnJlc2hSZWFjdFRlbXBsYXRlVEQgPSBmdW5jdGlvbiAocm93cywgaXNDaGlsZEdyaWQsIGlzRnJvemVuKSB7XG4gICAgICAgIHZhciBjZWxscyA9ICdjZWxscyc7XG4gICAgICAgIHZhciByb3dJZHggPSAnaW5kZXgnO1xuICAgICAgICB2YXIgaW5kZW50ID0gdGhpcy5nZXRJbmRlbnRDb3VudCgpO1xuICAgICAgICB2YXIgY2hpbGRJbmRlbnQgPSAwO1xuICAgICAgICB2YXIgaXNDaGlsZFJvdyA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJvd3MubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHZhciByb3dzT2JqID0gdGhpcy5nZXRSb3dPYmplY3RGcm9tVUlEKHJvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmdldEF0dHJpYnV0ZSgnZGF0YS11aWQnKSk7XG4gICAgICAgICAgICBpZiAoaXNDaGlsZEdyaWQgJiYgIXJvd3NPYmogJiYgcGFyZW50c1VudGlsKHJvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLCAnZS1jaGlsZGdyaWQnKSkge1xuICAgICAgICAgICAgICAgIHZhciBncmlkT2JqID0gcGFyZW50c1VudGlsKHJvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLCAnZS1jaGlsZGdyaWQnKS5lajJfaW5zdGFuY2VzWzBdO1xuICAgICAgICAgICAgICAgIHJvd3NPYmogPSBncmlkT2JqLmdldFJvd09iamVjdEZyb21VSUQocm93c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpKTtcbiAgICAgICAgICAgICAgICBjaGlsZEluZGVudCA9IGdyaWRPYmouZ2V0SW5kZW50Q291bnQoKTtcbiAgICAgICAgICAgICAgICBpc0NoaWxkUm93ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyb3dzT2JqICYmIHJvd3NPYmouaXNEYXRhUm93ICYmICFpc051bGxPclVuZGVmaW5lZChyb3dzT2JqLmluZGV4KSAmJlxuICAgICAgICAgICAgICAgICFyb3dzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZWRpdGVkcm93JykpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd3NPYmpbXCJcIiArIGNlbGxzXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbCA9IHJvd3NPYmpbXCJcIiArIGNlbGxzXVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChjZWxsLmlzVGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjZWxsUmVuZGVyZXIgPSBuZXcgQ2VsbFJlbmRlcmVyKHRoaXMsIHRoaXMuc2VydmljZUxvY2F0b3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRkID0gaXNDaGlsZEdyaWQgPyByb3dzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jaGlsZHJlbltjZWxsLmluZGV4ICsgKGlzQ2hpbGRSb3cgPyBjaGlsZEluZGVudCA6IGluZGVudCldIDogdGhpcy5nZXRDZWxsRnJvbUluZGV4KGosIGlzRnJvemVuID8gY2VsbC5pbmRleCA6IGkgLSBpbmRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbFJlbmRlcmVyLnJlZnJlc2hURCh0ZCwgY2VsbCwgcm93c09iai5kYXRhLCB7IGluZGV4OiByb3dzT2JqW1wiXCIgKyByb3dJZHhdIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXNDaGlsZFJvdyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUucmVmcmVzaEdyb3VwQ2FwdGlvbkZvb3RlclRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaXNDaGlsZEdyaWQgPSB0aGlzLmNoaWxkR3JpZCAmJiB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtY2hpbGRncmlkJykubGVuZ3RoID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICB2YXIgcm93cyA9IHRoaXMuZ2V0Q29udGVudFRhYmxlKCkucXVlcnlTZWxlY3RvckFsbCgnLmUtZ3JvdXBjYXB0aW9ucm93LCAuZS1ncm91cGZvb3RlcnJvdycpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhc1xuICAgICAgICAgICAgdmFyIGdyaWRPYmogPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHJvd3NPYmogPSB0aGlzLmdldFJvd09iamVjdEZyb21VSUQocm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpKTtcbiAgICAgICAgICAgIGlmIChpc0NoaWxkR3JpZCAmJiAhcm93c09iaiAmJiBwYXJlbnRzVW50aWwocm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sICdlLWNoaWxkZ3JpZCcpKSB7XG4gICAgICAgICAgICAgICAgZ3JpZE9iaiA9IHBhcmVudHNVbnRpbChyb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgJ2UtY2hpbGRncmlkJykuZWoyX2luc3RhbmNlc1swXTtcbiAgICAgICAgICAgICAgICByb3dzT2JqID0gZ3JpZE9iai5nZXRSb3dPYmplY3RGcm9tVUlEKHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmdldEF0dHJpYnV0ZSgnZGF0YS11aWQnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocm93c09iaikge1xuICAgICAgICAgICAgICAgIHZhciBjZWxscyA9IHJvd3NPYmouY2VsbHMuZmlsdGVyKGZ1bmN0aW9uIChjZWxsKSB7IHJldHVybiBjZWxsLmlzRGF0YUNlbGw7IH0pO1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0geyBjZWxsczogY2VsbHMsIGRhdGE6IHJvd3NPYmouZGF0YSwgZGF0YVVpZDogcm93c09iai51aWQgfTtcbiAgICAgICAgICAgICAgICBncmlkT2JqLm5vdGlmeShldmVudHMucmVmcmVzaEFnZ3JlZ2F0ZUNlbGwsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sdW1uVWlkIC0gRGVmaW5lcyBjb2x1bW4gdWlkXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnJlZnJlc2hSZWFjdEhlYWRlclRlbXBsYXRlQnlVaWQgPSBmdW5jdGlvbiAoY29sdW1uVWlkKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUmVhY3QpIHtcbiAgICAgICAgICAgIHZhciBjZWxscyA9ICdjZWxscyc7XG4gICAgICAgICAgICB2YXIgcm93c09iaiA9IHRoaXMuaGVhZGVyTW9kdWxlLnJvd3M7XG4gICAgICAgICAgICB2YXIgY2VsbEluZGV4ID0gdGhpcy5nZXROb3JtYWxpemVkQ29sdW1uSW5kZXgoY29sdW1uVWlkKTtcbiAgICAgICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKGopIHtcbiAgICAgICAgICAgICAgICB2YXIgY2VsbCA9IHJvd3NPYmpbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldW1wiXCIgKyBjZWxsc11bcGFyc2VJbnQoY2VsbEluZGV4LnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgaWYgKGNlbGwgJiYgY2VsbC5jb2x1bW4udWlkID09PSBjb2x1bW5VaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlckNlbGxSZW5kZXJlciA9IG5ldyBIZWFkZXJDZWxsUmVuZGVyZXIodGhpc18xLCB0aGlzXzEuc2VydmljZUxvY2F0b3IpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGQgPSBwYXJlbnRzVW50aWwodGhpc18xLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2UtbWFwcGluZ3VpZD0nICsgY29sdW1uVWlkICsgJ10nKVswXSwgJ2UtdGVtcGxhdGVjZWxsJyk7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlckNlbGxSZW5kZXJlci5yZWZyZXNoKGNlbGwsIHRkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbHMgPSB0aGlzXzEuc29ydFNldHRpbmdzLmNvbHVtbnM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2x1bW5JbmRleCA9IGNvbHMuZmluZEluZGV4KGZ1bmN0aW9uIChjb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2wuZmllbGQgPT09IGNlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sdW1uLmZpZWxkO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHVtbkluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlciA9IHRoaXNfMS5nZXRDb2x1bW5IZWFkZXJCeUZpZWxkKGNlbGwuY29sdW1uLmZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNfMS5hcmlhU2VydmljZS5zZXRTb3J0KGhlYWRlciwgKGNvbHNbcGFyc2VJbnQoY29sdW1uSW5kZXgudG9TdHJpbmcoKSwgMTApXS5kaXJlY3Rpb24pLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZS1oZWFkZXJjZWxsZGl2JykuaW5zZXJ0QmVmb3JlKHRoaXNfMS5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICdlLXNvcnRudW1iZXInLCBpbm5lckhUTUw6IChjb2x1bW5JbmRleCArIDEpLnRvU3RyaW5nKCkgfSksIGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZS1oZWFkZXJ0ZXh0JykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlckVsZW1lbnQgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmUtc29ydGZpbHRlcmRpdicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoY29sdW1uSW5kZXgudG9TdHJpbmcoKSwgMTApXS5kaXJlY3Rpb24gPT09ICdBc2NlbmRpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NMaXN0KGZpbHRlckVsZW1lbnQsIFsnZS1hc2NlbmRpbmcnLCAnZS1pY29uLWFzY2VuZGluZyddLCBbXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc0xpc3QoZmlsdGVyRWxlbWVudCwgWydlLWRlc2NlbmRpbmcnLCAnZS1pY29uLWRlc2NlbmRpbmcnXSwgW10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciB0aGlzXzEgPSB0aGlzO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByb3dzT2JqLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgX2xvb3BfMShqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyBhbmQgcmVmcmVzaCB0aGUgcGFydGljdWxhciByb3cgdmFsdWVzIGJhc2VkIG9uIHRoZSBnaXZlbiBwcmltYXJ5IGtleSB2YWx1ZS5cbiAgICAgKiA+IFByaW1hcnkga2V5IGNvbHVtbiBtdXN0IGJlIHNwZWNpZmllZCB1c2luZyBgY29sdW1ucy5pc1ByaW1hcnlLZXlgIHByb3BlcnR5LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd8IG51bWJlcn0ga2V5IC0gU3BlY2lmaWVzIHRoZSBQcmltYXJ5S2V5IHZhbHVlIG9mIGRhdGFTb3VyY2UuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHJvd0RhdGEgLSBUbyB1cGRhdGUgbmV3IGRhdGEgZm9yIHRoZSBwYXJ0aWN1bGFyIHJvdy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNldFJvd0RhdGEgPSBmdW5jdGlvbiAoa2V5LCByb3dEYXRhKSB7XG4gICAgICAgIHZhciByb3d1SUQgPSAndWlkJztcbiAgICAgICAgdmFyIHJvd09iamVjdHMgPSB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0Um93cygpO1xuICAgICAgICB2YXIgcGtOYW1lID0gdGhpcy5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpWzBdO1xuICAgICAgICBpZiAodGhpcy5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoID4gMCAmJiB0aGlzLmFnZ3JlZ2F0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcm93T2JqZWN0cyA9IHJvd09iamVjdHMuZmlsdGVyKGZ1bmN0aW9uIChyb3cpIHsgcmV0dXJuIHJvdy5pc0RhdGFSb3c7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWxlY3RlZFJvdyA9IHJvd09iamVjdHMuZmlsdGVyKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0VmFsdWUocGtOYW1lLCByLmRhdGEpID09PSBrZXk7XG4gICAgICAgIH0pWzBdO1xuICAgICAgICB2YXIgc2VsZWN0Um93RWxlID0gc2VsZWN0ZWRSb3cgPyBbXS5zbGljZS5jYWxsKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS11aWQ9JyArIHNlbGVjdGVkUm93W1wiXCIgKyByb3d1SURdICsgJ10nKSkgOiB1bmRlZmluZWQ7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoc2VsZWN0ZWRSb3cpICYmIHNlbGVjdFJvd0VsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkUm93LmNoYW5nZXMgPSByb3dEYXRhO1xuICAgICAgICAgICAgaWYgKHRoaXMuZnJvemVuUm93cykge1xuICAgICAgICAgICAgICAgIHZhciBmUm93VHIgPSB0aGlzLmdldFJvd3NPYmplY3QoKVtzZWxlY3RlZFJvdy5pbmRleF07XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGcm96ZW5Sb3dEYXRhKGZSb3dUciwgcm93RGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEZyb3plblJvd0RhdGEoc2VsZWN0ZWRSb3csIHJvd0RhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuYWdncmVnYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLnJlZnJlc2hGb290ZXJSZW5kZXJlciwge30pO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5ncm91cEFnZ3JlZ2F0ZXMsIHt9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnNldEZyb3plblJvd0RhdGEgPSBmdW5jdGlvbiAoZlRyLCByb3dEYXRhKSB7XG4gICAgICAgIHZhciByb3dSZW5kZXJlciA9IG5ldyBSb3dSZW5kZXJlcih0aGlzLnNlcnZpY2VMb2NhdG9yLCBudWxsLCB0aGlzKTtcbiAgICAgICAgZlRyLmNoYW5nZXMgPSByb3dEYXRhO1xuICAgICAgICByZWZyZXNoRm9yZWlnbkRhdGEoZlRyLCB0aGlzLmdldEZvcmVpZ25LZXlDb2x1bW5zKCksIGZUci5jaGFuZ2VzKTtcbiAgICAgICAgcm93UmVuZGVyZXIucmVmcmVzaChmVHIsIHRoaXMuZ2V0Q29sdW1ucygpLCB0cnVlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBjZWxsIGJ5IHJvdyBhbmQgY29sdW1uIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSByb3dJbmRleCAtIFNwZWNpZmllcyB0aGUgcm93IGluZGV4LlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sdW1uSW5kZXggLSBTcGVjaWZpZXMgdGhlIGNvbHVtbiBpbmRleC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSBSZXR1cm5zIHRoZSBFbGVtZW50XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Q2VsbEZyb21JbmRleCA9IGZ1bmN0aW9uIChyb3dJbmRleCwgY29sdW1uSW5kZXgpIHtcbiAgICAgICAgdmFyIGNvbCA9IHRoaXMuZ2V0Q29sdW1uQnlJbmRleChjb2x1bW5JbmRleCk7XG4gICAgICAgIHJldHVybiBnZXRDZWxsQnlDb2xBbmRSb3dJbmRleCh0aGlzLCBjb2wsIHJvd0luZGV4LCBjb2x1bW5JbmRleCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIGEgbW92YWJsZSB0YWJsZSBjZWxsIGJ5IHJvdyBhbmQgY29sdW1uIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSByb3dJbmRleCAtIFNwZWNpZmllcyB0aGUgcm93IGluZGV4LlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sdW1uSW5kZXggLSBTcGVjaWZpZXMgdGhlIGNvbHVtbiBpbmRleC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSBSZXR1cm5zIHRoZSBFbGVtZW50XG5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRNb3ZhYmxlQ2VsbEZyb21JbmRleCA9IGZ1bmN0aW9uIChyb3dJbmRleCwgY29sdW1uSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2VsbEZyb21JbmRleChyb3dJbmRleCwgY29sdW1uSW5kZXgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhIGZyb3plbiByaWdodCB0YWJsZSBjZWxsIGJ5IHJvdyBhbmQgY29sdW1uIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSByb3dJbmRleCAtIFNwZWNpZmllcyB0aGUgcm93IGluZGV4LlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gY29sdW1uSW5kZXggLSBTcGVjaWZpZXMgdGhlIGNvbHVtbiBpbmRleC5cbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gUmV0dXJucyB0aGUgRWxlbWVudFxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RnJvemVuUmlnaHRDZWxsRnJvbUluZGV4ID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjb2x1bW5JbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRDZWxsRnJvbUluZGV4KHJvd0luZGV4LCBjb2x1bW5JbmRleCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIGEgY29sdW1uIGhlYWRlciBieSBjb2x1bW4gaW5kZXguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGluZGV4IC0gU3BlY2lmaWVzIHRoZSBjb2x1bW4gaW5kZXguXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gUmV0dXJucyB0aGUgRWxlbWVudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldENvbHVtbkhlYWRlckJ5SW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SGVhZGVyVGFibGUoKS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlLWhlYWRlcmNlbGwnKVtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhIG1vdmFibGUgY29sdW1uIGhlYWRlciBieSBjb2x1bW4gaW5kZXguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGluZGV4IC0gU3BlY2lmaWVzIHRoZSBjb2x1bW4gaW5kZXguXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IFJldHVybnMgdGhlIEVsZW1lbnRcblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldE1vdmFibGVDb2x1bW5IZWFkZXJCeUluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldENvbHVtbkhlYWRlckJ5SW5kZXgoaW5kZXgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhIGZyb3plbiByaWdodCBjb2x1bW4gaGVhZGVyIGJ5IGNvbHVtbiBpbmRleC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gaW5kZXggLSBTcGVjaWZpZXMgdGhlIGNvbHVtbiBpbmRleC5cbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gUmV0dXJucyB0aGUgRWxlbWVudFxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RnJvemVuUmlnaHRDb2x1bW5IZWFkZXJCeUluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldENvbHVtbkhlYWRlckJ5SW5kZXgoaW5kZXgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhIGZyb3plbiBsZWZ0IGNvbHVtbiBoZWFkZXIgYnkgY29sdW1uIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBpbmRleCAtIFNwZWNpZmllcyB0aGUgY29sdW1uIGluZGV4LlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSBSZXR1cm5zIHRoZSBFbGVtZW50XG5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRGcm96ZW5MZWZ0Q29sdW1uSGVhZGVyQnlJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2x1bW5IZWFkZXJCeUluZGV4KGluZGV4KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1aWQgLSBEZWZpbmVzIHRoZSB1aWRcbiAgICAgKiBAcmV0dXJucyB7Um93PENvbHVtbj59IFJldHVybnMgdGhlIHJvdyBvYmplY3RcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Um93T2JqZWN0RnJvbVVJRCA9IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgdmFyIHJvd3MgPSB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0Um93cygpO1xuICAgICAgICB2YXIgcm93ID0gdGhpcy5yb3dPYmplY3Qocm93cywgdWlkKTtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHJvdykgJiYgdGhpcy5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiB0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByb3cgPSB0aGlzLnJvd09iamVjdCh0aGlzLnZSb3dzLCB1aWQpO1xuICAgICAgICAgICAgcmV0dXJuIHJvdztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcm93O1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUucm93T2JqZWN0ID0gZnVuY3Rpb24gKHJvd3MsIHVpZCkge1xuICAgICAgICBpZiAocm93cykge1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCByb3dzXzEgPSByb3dzOyBfaSA8IHJvd3NfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcm93ID0gcm93c18xW19pXTtcbiAgICAgICAgICAgICAgICBpZiAocm93LnVpZCA9PT0gdWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByb3c7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IGFuIGFycmF5IG9mIHJvdyBvYmplY3RzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge1JvdzxDb2x1bW4+W119IFJldHVybnMgdGhlIFJvdyBvYmplY3RcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRSb3dzT2JqZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50TW9kdWxlLmdldFJvd3MoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7Um93PENvbHVtbj5bXX0gUmV0dXJucyB0aGUgUm93IG9iamVjdFxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0TW92YWJsZVJvd3NPYmplY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0Um93cygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtSb3c8Q29sdW1uPltdfSBSZXR1cm5zIHRoZSBSb3cgb2JqZWN0XG5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRGcm96ZW5SaWdodFJvd3NPYmplY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRNb2R1bGUuZ2V0Um93cygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhIGNvbHVtbiBoZWFkZXIgYnkgY29sdW1uIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGZpZWxkIC0gU3BlY2lmaWVzIHRoZSBjb2x1bW4gbmFtZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSAtIFJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRDb2x1bW5IZWFkZXJCeUZpZWxkID0gZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgIHZhciBjb2x1bW4gPSB0aGlzLmdldENvbHVtbkJ5RmllbGQoZmllbGQpO1xuICAgICAgICByZXR1cm4gY29sdW1uID8gdGhpcy5nZXRDb2x1bW5IZWFkZXJCeVVpZChjb2x1bW4udWlkKSA6IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBjb2x1bW4gaGVhZGVyIGJ5IFVJRC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1aWQgLSBTcGVjaWZpZXMgdGhlIGNvbHVtbiB1aWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gLSBSZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Q29sdW1uSGVhZGVyQnlVaWQgPSBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5nZXRIZWFkZXJDb250ZW50KCkucXVlcnlTZWxlY3RvcignW2UtbWFwcGluZ3VpZD0nICsgdWlkICsgJ10nKTtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQgPyBlbGVtZW50LnBhcmVudEVsZW1lbnQgOiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gRGVmaW5lcyB0aGUgaW5kZXhcbiAgICAgKiBAcmV0dXJucyB7Q29sdW1ufSBSZXR1cm5zIHRoZSBjb2x1bW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRDb2x1bW5CeUluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciBjb2x1bW47XG4gICAgICAgIHRoaXMuZ2V0Q29sdW1ucygpLnNvbWUoZnVuY3Rpb24gKGNvbCwgaSkge1xuICAgICAgICAgICAgY29sdW1uID0gY29sO1xuICAgICAgICAgICAgcmV0dXJuIGkgPT09IGluZGV4O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNvbHVtbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBDb2x1bW4gYnkgY29sdW1uIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGZpZWxkIC0gU3BlY2lmaWVzIHRoZSBjb2x1bW4gbmFtZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtDb2x1bW59IFJldHVybnMgdGhlIGNvbHVtblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldENvbHVtbkJ5RmllbGQgPSBmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhdGVBcnJheU9yT2JqZWN0KHRoaXMuZ2V0Q29sdW1ucygpLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgaWYgKGl0ZW0uZmllbGQgPT09IGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9KVswXTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBjb2x1bW4gaW5kZXggYnkgY29sdW1uIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGZpZWxkIC0gU3BlY2lmaWVzIHRoZSBjb2x1bW4gbmFtZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IGJ5IGZpZWxkXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Q29sdW1uSW5kZXhCeUZpZWxkID0gZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgIHZhciBjb2xzID0gdGhpcy5nZXRDb2x1bW5zKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkID09PSBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBjb2x1bW4gYnkgVUlELlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSB1aWQgLSBTcGVjaWZpZXMgdGhlIGNvbHVtbiBVSUQuXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gaXNDb2x1bW5zIC0gRGVmaW5lcyB0aGUgYWxsIGNvbHVtbnMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Q29sdW1ufSBSZXR1cm5zIHRoZSBjb2x1bW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRDb2x1bW5CeVVpZCA9IGZ1bmN0aW9uICh1aWQsIGlzQ29sdW1ucykge1xuICAgICAgICB2YXIgY29scyA9IGlzQ29sdW1ucyA/IHRoaXMuY29sdW1ucyA6IHRoaXMuZ2V0Q29sdW1ucygpO1xuICAgICAgICByZXR1cm4gaXRlcmF0ZUFycmF5T3JPYmplY3QoY29scy5jb25jYXQodGhpcy5nZXRTdGFja2VkQ29sdW1ucyh0aGlzLmNvbHVtbnMpKSwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIGlmIChpdGVtLnVpZCA9PT0gdWlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9KVswXTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Q29sdW1uW119IGNvbHVtbnMgLSBEZWZpbmVzIHRoZSBjb2x1bW5zXG4gICAgICogQHBhcmFtIHtDb2x1bW5bXX0gc3RhY2tlZENvbHVtbiAtIERlZmluZXMgdGhlIHN0YWNrZWQgY29sdW1uc1xuICAgICAqIEByZXR1cm5zIHtDb2x1bW5bXX0gUmV0dXJucyB0aGUgY29sdW1uc1xuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRTdGFja2VkQ29sdW1ucyA9IGZ1bmN0aW9uIChjb2x1bW5zLCBzdGFja2VkQ29sdW1uKSB7XG4gICAgICAgIGlmIChzdGFja2VkQ29sdW1uID09PSB2b2lkIDApIHsgc3RhY2tlZENvbHVtbiA9IFtdOyB9XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgY29sdW1uc18xID0gY29sdW1uczsgX2kgPCBjb2x1bW5zXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1uID0gY29sdW1uc18xW19pXTtcbiAgICAgICAgICAgIGlmIChjb2x1bW4uY29sdW1ucykge1xuICAgICAgICAgICAgICAgIHN0YWNrZWRDb2x1bW4ucHVzaChjb2x1bW4pO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U3RhY2tlZENvbHVtbnMoY29sdW1uLmNvbHVtbnMsIHN0YWNrZWRDb2x1bW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdGFja2VkQ29sdW1uO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhIGNvbHVtbiBpbmRleCBieSBVSUQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IHVpZCAtIFNwZWNpZmllcyB0aGUgY29sdW1uIFVJRC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGNvbHVtbiBieSBpbmRleFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldENvbHVtbkluZGV4QnlVaWQgPSBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHZhciBpbmRleCA9IGl0ZXJhdGVBcnJheU9yT2JqZWN0KHRoaXMuZ2V0Q29sdW1ucygpLCBmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmIChpdGVtLnVpZCA9PT0gdWlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSlbMF07XG4gICAgICAgIHJldHVybiAhaXNOdWxsT3JVbmRlZmluZWQoaW5kZXgpID8gaW5kZXggOiAtMTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgVUlEIGJ5IGNvbHVtbiBuYW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBmaWVsZCAtIFNwZWNpZmllcyB0aGUgY29sdW1uIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBjb2x1bW4gYnkgZmllbGRcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRVaWRCeUNvbHVtbkZpZWxkID0gZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRlQXJyYXlPck9iamVjdCh0aGlzLmdldENvbHVtbnMoKSwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIGlmIChpdGVtLmZpZWxkID09PSBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnVpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0pWzBdO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBjb2x1bW4gaW5kZXggYnkgY29sdW1uIHVpZCB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSB1aWQgLSBTcGVjaWZpZXMgdGhlIGNvbHVtbiB1aWQuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgY29sdW1uIGJ5IGZpZWxkXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Tm9ybWFsaXplZENvbHVtbkluZGV4ID0gZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmdldENvbHVtbkluZGV4QnlVaWQodWlkKTtcbiAgICAgICAgcmV0dXJuIGluZGV4ICsgdGhpcy5nZXRJbmRlbnRDb3VudCgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBpbmRlbnQgY2VsbCBjb3VudC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZW50IGNvdW50XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0SW5kZW50Q291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgIGlmICh0aGlzLmFsbG93R3JvdXBpbmcpIHtcbiAgICAgICAgICAgIGluZGV4ICs9IHRoaXMuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc0RldGFpbCgpKSB7XG4gICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzUm93RHJhZ2FibGUoKSAmJiBpc051bGxPclVuZGVmaW5lZCh0aGlzLnJvd0Ryb3BTZXR0aW5ncy50YXJnZXRJRCkpIHtcbiAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRPRE86IGluZGV4IG5vcm1hbGl6YXRpb24gYmFzZWQgb24gdGhlIHN0YWNrZWQgaGVhZGVyLCBncm91cGluZyBhbmQgZGV0YWlsVGVtcGxhdGVcbiAgICAgICAgICogYW5kIGZyb3plbiBzaG91bGQgYmUgaGFuZGxlZCBoZXJlXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb2xsZWN0aW9uIG9mIGNvbHVtbiBmaWVsZHMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nW119IFJldHVybnMgdGhlIEZpZWxkIG5hbWVzXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Q29sdW1uRmllbGROYW1lcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbHVtbk5hbWVzID0gW107XG4gICAgICAgIHZhciBjb2x1bW47XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLmdldENvbHVtbnMoKS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgY29sdW1uID0gdGhpcy5nZXRDb2x1bW5zKClbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgaWYgKGNvbHVtbi52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uTmFtZXMucHVzaChjb2x1bW4uZmllbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb2x1bW5OYW1lcztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBjb21waWxlZCByb3cgdGVtcGxhdGUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIHJvdyBURW1wbGF0ZVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Um93VGVtcGxhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvd1RlbXBsYXRlRm47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIGEgY29tcGlsZWQgZW1wdHkgUmVjb3JkIHRlbXBsYXRlLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBlbXB0eSBSZWNvcmQgdGVtcGxhdGVcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEVtcHR5UmVjb3JkVGVtcGxhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVtcHR5UmVjb3JkVGVtcGxhdGVGbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBjb21waWxlZCBkZXRhaWwgcm93IHRlbXBsYXRlLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIERldGFpbCB0ZW1wbGF0ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldERldGFpbFRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZXRhaWxUZW1wbGF0ZUZuO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhIGNvbXBpbGVkIGRpYWxvZyBlZGl0IHRlbXBsYXRlLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIEVkaXQgdGVtcGxhdGVcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRFZGl0VGVtcGxhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRUZW1wbGF0ZUZuO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyBhIGNvbXBpbGVkIGRpYWxvZyBlZGl0IGhlYWRlciB0ZW1wbGF0ZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSByZXR1cm5zIHRlbXBsYXRlIGZ1bmN0aW9uXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RWRpdEhlYWRlclRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lZGl0SGVhZGVyVGVtcGxhdGVGbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBjb21waWxlZCBkaWFsb2cgZWRpdCBmb290ZXIgdGVtcGxhdGUuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgRm9vdGVyIHRlbXBsYXRlXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RWRpdEZvb3RlclRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lZGl0Rm9vdGVyVGVtcGxhdGVGbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgYSBjb21waWxlZCBjb2x1bW4gY2hvb3NlciB0ZW1wbGF0ZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSB0ZW1wbGF0ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldENvbHVtbkNob29zZXJUZW1wbGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sdW1uQ2hvb3NlclRlbXBsYXRlRm47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIGEgY29tcGlsZWQgY29sdW1uIGNob29zZXIgaGVhZGVyIHRlbXBsYXRlLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IHJldHVybnMgdGhlIGhlYWRlciB0ZW1wbGF0ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldENvbHVtbkNob29zZXJIZWFkZXJUZW1wbGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sdW1uQ2hvb3NlckhlYWRlclRlbXBsYXRlRm47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIGEgY29tcGlsZWQgY29sdW1uIGNob29zZXIgZm9vdGVyIHRlbXBsYXRlLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIEZvb3RlciB0ZW1wbGF0ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldENvbHVtbkNob29zZXJGb290ZXJUZW1wbGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sdW1uQ2hvb3NlckZvb3RlclRlbXBsYXRlRm47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIG5hbWVzIG9mIHRoZSBwcmltYXJ5IGtleSBjb2x1bW5zIG9mIHRoZSBHcmlkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfSBSZXR1cm5zIHRoZSBmaWVsZCBuYW1lc1xuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFByaW1hcnlLZXlGaWVsZE5hbWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIga2V5cyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHRoaXMuY29sdW1uTW9kZWwubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbHVtbk1vZGVsW3BhcnNlSW50KGsudG9TdHJpbmcoKSwgMTApXS5pc1ByaW1hcnlLZXkpIHtcbiAgICAgICAgICAgICAgICBrZXlzLnB1c2godGhpcy5jb2x1bW5Nb2RlbFtwYXJzZUludChrLnRvU3RyaW5nKCksIDEwKV0uZmllbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBrZXlzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVmcmVzaGVzIHRoZSBHcmlkIGhlYWRlciBhbmQgY29udGVudC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgdGhpcy5pc01hbnVhbFJlZnJlc2ggPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5oZWFkZXJNb2R1bGUucmVmcmVzaFVJKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YWNrZWRGaWx0ZXIoKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyTW9kdWxlLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVmcmVzaGVzIHRoZSBHcmlkIGhlYWRlci5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnJlZnJlc2hIZWFkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaGVhZGVyTW9kdWxlLnJlZnJlc2hVSSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgY29sbGVjdGlvbiBvZiBzZWxlY3RlZCByb3dzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0VsZW1lbnRbXX0gUmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFNlbGVjdGVkUm93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uTW9kdWxlID8gdGhpcy5zZWxlY3Rpb25Nb2R1bGUuc2VsZWN0ZWRSZWNvcmRzIDogW107XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb2xsZWN0aW9uIG9mIHNlbGVjdGVkIHJvdyBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcltdfSBSZXR1cm5zIHRoZSBTZWxlY3RlZCByb3cgaW5kZXhlc1xuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFNlbGVjdGVkUm93SW5kZXhlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uTW9kdWxlID8gdGhpcy5zZWxlY3Rpb25Nb2R1bGUuc2VsZWN0ZWRSb3dJbmRleGVzIDogW107XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb2xsZWN0aW9uIG9mIHNlbGVjdGVkIHJvdyBhbmQgY2VsbCBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcltdfSBSZXR1cm5zIHRoZSBTZWxlY3RlZCByb3cgY2VsbCBpbmRleGVzXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0U2VsZWN0ZWRSb3dDZWxsSW5kZXhlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uTW9kdWxlID8gdGhpcy5zZWxlY3Rpb25Nb2R1bGUuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcyA6IFtdO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgY29sbGVjdGlvbiBvZiBzZWxlY3RlZCByZWNvcmRzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge09iamVjdFtdfSBSZXR1cm5zIHRoZSBzZWxlY3RlZCByZWNvcmRzXG4gICAgICogQGlzR2VuZXJpY1R5cGUgdHJ1ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFNlbGVjdGVkUmVjb3JkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uTW9kdWxlID8gdGhpcy5zZWxlY3Rpb25Nb2R1bGUuZ2V0U2VsZWN0ZWRSZWNvcmRzKCkgOiBbXTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGNvbGxlY3Rpb24gb2Ygc2VsZWN0ZWQgY29sdW1ucyB1aWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nW119IFJldHVybnMgdGhlIHNlbGVjdGVkIGNvbHVtbiB1aWRcbiAgICAgKiBAaXNHZW5lcmljVHlwZSB0cnVlXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0U2VsZWN0ZWRDb2x1bW5zVWlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXNfMSA9IHRoaXM7XG4gICAgICAgIHZhciB1aWQgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbk1vZHVsZS5zZWxlY3RlZENvbHVtbnNJbmRleGVzLmZpbHRlcihmdW5jdGlvbiAoaSkgeyByZXR1cm4gdWlkLnB1c2goX3RoaXNfMS5nZXRDb2x1bW5zKClbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1aWQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBkYXRhIG1vZHVsZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtEYXRhfSBSZXR1cm5zIHRoZSBkYXRhXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RGF0YU1vZHVsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyTW9kdWxlLmRhdGE7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTaG93cyBhIGNvbHVtbiBieSBpdHMgY29sdW1uIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd8c3RyaW5nW119IGtleXMgLSBEZWZpbmVzIGEgc2luZ2xlIG9yIGNvbGxlY3Rpb24gb2YgY29sdW1uIG5hbWVzLlxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gc2hvd0J5IC0gRGVmaW5lcyB0aGUgY29sdW1uIGtleSBlaXRoZXIgYXMgZmllbGQgbmFtZSBvciBoZWFkZXIgdGV4dC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNob3dDb2x1bW5zID0gZnVuY3Rpb24gKGtleXMsIHNob3dCeSkge1xuICAgICAgICBzaG93QnkgPSBzaG93QnkgPyBzaG93QnkgOiAnaGVhZGVyVGV4dCc7XG4gICAgICAgIHRoaXMuc2hvd0hpZGVyLnNob3coa2V5cywgc2hvd0J5KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEhpZGVzIGEgY29sdW1uIGJ5IGNvbHVtbiBuYW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfHN0cmluZ1tdfSBrZXlzIC0gRGVmaW5lcyBhIHNpbmdsZSBvciBjb2xsZWN0aW9uIG9mIGNvbHVtbiBuYW1lcy5cbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGhpZGVCeSAtIERlZmluZXMgdGhlIGNvbHVtbiBrZXkgZWl0aGVyIGFzIGZpZWxkIG5hbWUgb3IgaGVhZGVyIHRleHQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5oaWRlQ29sdW1ucyA9IGZ1bmN0aW9uIChrZXlzLCBoaWRlQnkpIHtcbiAgICAgICAgaGlkZUJ5ID0gaGlkZUJ5ID8gaGlkZUJ5IDogJ2hlYWRlclRleHQnO1xuICAgICAgICB0aGlzLnNob3dIaWRlci5oaWRlKGtleXMsIGhpZGVCeSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgRnJvemVuIGNvbHVtblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZyb3plbkNvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZyb3plbkNvbHVtbnMgKyB0aGlzLmdldEZyb3plbkNvdW50KHRoaXMuY29sdW1ucywgMCwgMCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgRnJvemVuIFJpZ2h0IGNvbHVtbiBjb3VudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZyb3plblJpZ2h0Q29sdW1uc0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mcm96ZW5SaWdodENvdW50IHx8IHRoaXMucmlnaHRjb3VudDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBGcm96ZW4gTGVmdCBjb2x1bW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRGcm96ZW5MZWZ0Q29sdW1uc0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mcm96ZW5MZWZ0Q291bnQgfHwgdGhpcy5sZWZ0Y291bnQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgbW92YWJsZSBjb2x1bW4gY291bnRcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRNb3ZhYmxlQ29sdW1uc0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tb3ZhYmxlQ291bnQgfHwgdGhpcy5tb3ZhYmxlY291bnQ7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS51cGRhdGVGcm96ZW5Db2x1bW5zV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRnJvemVuR3JpZCgpICYmICF0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICB2YXIgZ2NvbCA9IHRoaXMuZ2V0Q29sdW1ucygpO1xuICAgICAgICAgICAgdmFyIGlzQXV0b1dpZHRoID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBhdXRvQ29sXzEgPSAwO1xuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2VfMSA9IDA7XG4gICAgICAgICAgICB2YXIgYXV0b1dpZHRoXzEgPSAwO1xuICAgICAgICAgICAgdmFyIGlzRnJvemVuQXV0byA9IGdjb2wuc29tZShmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoZGF0YS5mcmVlemUgPT09ICdMZWZ0JyB8fCBkYXRhLmZyZWV6ZSA9PT0gJ1JpZ2h0J1xuICAgICAgICAgICAgICAgICAgICB8fCBkYXRhLmZyZWV6ZSA9PT0gJ0ZpeGVkJyB8fCBkYXRhLmlzRnJvemVuKSAmJiBkYXRhLndpZHRoID09PSAnYXV0byc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBfbG9vcF8yID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29sID0gZ2NvbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGNvbC53aWR0aCkgJiYgKGNvbC5mcmVlemUgPT09ICdMZWZ0JyB8fCBjb2wuZnJlZXplID09PSAnUmlnaHQnIHx8IGNvbC5mcmVlemUgPT09ICdGaXhlZCcgfHwgY29sLmlzRnJvemVuKSkge1xuICAgICAgICAgICAgICAgICAgICBjb2wud2lkdGggPSBNYXRoLm1heCgyMDAsIGNvbC5taW5XaWR0aCA/IHBhcnNlRmxvYXQoY29sLm1pbldpZHRoLnRvU3RyaW5nKCkpIDogMCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY29sLm1heFdpZHRoKSAmJiBwYXJzZUZsb2F0KGNvbC5tYXhXaWR0aC50b1N0cmluZygpKSA8IGNvbC53aWR0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sLndpZHRoID0gY29sLm1heFdpZHRoO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjb2wud2lkdGggPT09ICdhdXRvJyAmJiBpc0Zyb3plbkF1dG8pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRXaWR0aF8xID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQXV0b1dpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnY29sLmZpbHRlcihmdW5jdGlvbiAoY29scykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2xzLnZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHMud2lkdGggPT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0NvbF8xKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHMud2lkdGggIT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gIWlzTnVsbE9yVW5kZWZpbmVkKGNvbHMud2lkdGgpID8gcGFyc2VGbG9hdChjb2xzLndpZHRoLnRvU3RyaW5nKCkpIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heCgyMDAsIGNvbHMubWluV2lkdGggPyBwYXJzZUZsb2F0KGNvbHMubWluV2lkdGgudG9TdHJpbmcoKSkgOiAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRXaWR0aF8xICs9IHdpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ1dpZHRoID0gdGhpc18yLmlzUGVyY2VudGFnZVdpZHRoR3JpZCgpIHx8IHRoaXNfMi53aWR0aCA9PT0gJ2F1dG8nID8gdGhpc18yLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQodGhpc18yLndpZHRoLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZmVyZW5jZV8xID0gdGhpc18yLmhlaWdodCA9PT0gJ2F1dG8nID8gZ1dpZHRoIC0gdFdpZHRoXzEgOiAoKGdXaWR0aCAtIHRXaWR0aF8xKSAtIGdldFNjcm9sbEJhcldpZHRoKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpZmZlcmVuY2VfMSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmZXJlbmNlXzEgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1dpZHRoXzEgPSBwYXJzZUZsb2F0KChkaWZmZXJlbmNlXzEgLyBhdXRvQ29sXzEpLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2NvbC5maWx0ZXIoZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2wudmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29sLm1pbldpZHRoICYmIHBhcnNlRmxvYXQoY29sLm1pbldpZHRoLnRvU3RyaW5nKCkpID4gYXV0b1dpZHRoXzEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VfMSA9IGRpZmZlcmVuY2VfMSAtIHBhcnNlRmxvYXQoY29sLm1pbldpZHRoLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0NvbF8xLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQXV0b1dpZHRoID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbC5taW5XaWR0aCAmJiBwYXJzZUZsb2F0KGNvbC5taW5XaWR0aC50b1N0cmluZygpKSA+IGF1dG9XaWR0aF8xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wud2lkdGggPSBwYXJzZUZsb2F0KGNvbC5taW5XaWR0aC50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbC53aWR0aCA9IGRpZmZlcmVuY2VfMSAvIGF1dG9Db2xfMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgdGhpc18yID0gdGhpcztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ2NvbC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIF9sb29wXzIoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnJlZnJlc2hTcGxpdEZyb3plbkNvbHVtbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zcGxpdEZyb3plbkNvdW50KHRoaXMuY29sdW1ucyk7XG4gICAgICAgIHRoaXMudXBkYXRlRnJvemVuQ29sdW1uc1dpZHRoKCk7XG4gICAgICAgIHRoaXMuaXNBdXRvR2VuZXJhdGVDb2x1bW5zID0gdHJ1ZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zZXRGcm96ZW5Db3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5mcm96ZW5MZWZ0Q291bnQgPSB0aGlzLmZyb3plblJpZ2h0Q291bnQgPSB0aGlzLm1vdmFibGVDb3VudCA9IDA7XG4gICAgICAgIHRoaXMudmlzaWJsZUZyb3plbkxlZnQgPSB0aGlzLnZpc2libGVGcm96ZW5SaWdodCA9IHRoaXMudmlzaWJsZU1vdmFibGUgPSAwO1xuICAgICAgICB0aGlzLmZyb3plbkxlZnRDb2x1bW5zID0gW107XG4gICAgICAgIHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zID0gW107XG4gICAgICAgIHRoaXMubW92YWJsZUNvbHVtbnMgPSBbXTtcbiAgICAgICAgdGhpcy5maXhlZENvbHVtbnMgPSBbXTtcbiAgICAgICAgdGhpcy5zcGxpdEZyb3plbkNvdW50KHRoaXMuY29sdW1ucyk7XG4gICAgICAgIHRoaXMubGVmdGNvdW50ID0gdGhpcy5mcm96ZW5MZWZ0Q291bnQ7XG4gICAgICAgIHRoaXMucmlnaHRjb3VudCA9IHRoaXMuZnJvemVuUmlnaHRDb3VudDtcbiAgICAgICAgdGhpcy5tb3ZhYmxlY291bnQgPSB0aGlzLm1vdmFibGVDb3VudDtcbiAgICAgICAgLy8gaWYgKHRoaXMuZnJvemVuQ29sdW1ucyAmJiAodGhpcy5mcm96ZW5MZWZ0Q291bnQgfHwgdGhpcy5mcm96ZW5SaWdodENvdW50KSkge1xuICAgICAgICAvLyAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgZnJvemVuQ29sdW1uczogMCB9LCB0cnVlKTtcbiAgICAgICAgLy8gfVxuICAgICAgICBpZiAodGhpcy5mcm96ZW5MZWZ0Q291bnQgJiYgIXRoaXMuZnJvemVuUmlnaHRDb3VudCkge1xuICAgICAgICAgICAgdGhpcy5mcm96ZW5OYW1lID0gJ0xlZnQnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuZnJvemVuUmlnaHRDb3VudCAmJiAhdGhpcy5mcm96ZW5MZWZ0Q291bnQpIHtcbiAgICAgICAgICAgIHRoaXMuZnJvemVuTmFtZSA9ICdSaWdodCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5mcm96ZW5MZWZ0Q291bnQgJiYgdGhpcy5mcm96ZW5SaWdodENvdW50KSB7XG4gICAgICAgICAgICB0aGlzLmZyb3plbk5hbWUgPSAnTGVmdC1SaWdodCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5mcm96ZW5Db2x1bW5zIHx8IHRoaXMuZnJvemVuUm93cykge1xuICAgICAgICAgICAgdGhpcy5mcm96ZW5OYW1lID0gJ0xlZnQnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5mcm96ZW5OYW1lID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgdmlzaWJsZSBGcm96ZW4gbGVmdCBjb3VudFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFZpc2libGVGcm96ZW5MZWZ0Q291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpc2libGVGcm96ZW5MZWZ0O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHZpc2libGUgRnJvemVuIFJpZ2h0IGNvdW50XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0VmlzaWJsZUZyb3plblJpZ2h0Q291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpc2libGVGcm96ZW5SaWdodDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSB2aXNpYmxlIG1vdmFibGUgY291bnRcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRWaXNpYmxlTW92YWJsZUNvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52aXNpYmxlTW92YWJsZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7Q29sdW1uW119IFJldHVybnMgdGhlIGNvbHVtblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZyb3plblJpZ2h0Q29sdW1ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtDb2x1bW5bXX0gUmV0dXJucyB0aGUgY29sdW1uXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RnJvemVuTGVmdENvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZyb3plbkxlZnRDb2x1bW5zO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtDb2x1bW5bXX0gUmV0dXJucyB0aGUgY29sdW1uXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0TW92YWJsZUNvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vdmFibGVDb2x1bW5zO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuc3BsaXRTdGFja2VkQ29sdW1ucyA9IGZ1bmN0aW9uIChjb2x1bW5zKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0U3RhY2tlZENvbHVtbnMoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnTGVmdCcgfHwgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNGcm96ZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpc2libGVGcm96ZW5MZWZ0Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sZWZ0Y291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aXNpYmxlRnJvemVuUmlnaHQrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0Y291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnRml4ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aXNpYmxlRnJvemVuRml4ZWQrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpeGVkY291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aXNpYmxlTW92YWJsZSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW92YWJsZWNvdW50Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5wdXNoU3RhY2tlZENvbHVtbnMgPSBmdW5jdGlvbiAoY29sdW1ucywgaW5kZXgsIGFyciwgY29sLCBzdGFja2VkY29sKSB7XG4gICAgICAgIGFycltwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldID0geyBoZWFkZXJUZXh0OiBjb2wuaGVhZGVyVGV4dCB9O1xuICAgICAgICBpZiAoY29sLnRleHRBbGlnbikge1xuICAgICAgICAgICAgYXJyW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0udGV4dEFsaWduID0gY29sLnRleHRBbGlnbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29sLmN1c3RvbUF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGFycltwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldLmN1c3RvbUF0dHJpYnV0ZXMgPSBjb2wuY3VzdG9tQXR0cmlidXRlcztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleCArIDE7XG4gICAgICAgICAgICAgICAgdGhpcy5wdXNoU3RhY2tlZENvbHVtbnMoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucywgaW5kZXgsIGFyciwgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHN0YWNrZWRjb2wpO1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaW5kZXggLSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0b2NrQ29sID0gW107XG4gICAgICAgICAgICAgICAgc3RvY2tDb2wgPSBhcnIuc2xpY2UoKS5zbGljZSgwLCBpbmRleCArIDEpO1xuICAgICAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mcmVlemUgPT09ICdMZWZ0JyB8fCBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0Zyb3plbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWNrZWRMZWZ0LnB1c2goc3RvY2tDb2wpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWNrZWRhcnJheUxlZnQucHVzaChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZyZWV6ZSA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWNrZWRSaWdodC5wdXNoKHN0b2NrQ29sKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkYXJyYXlSaWdodC5wdXNoKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnRml4ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhY2tlZEZpeGVkLnB1c2goc3RvY2tDb2wpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWNrZWRhcnJheUZpeGVkLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkTW92YWJsZS5wdXNoKHN0b2NrQ29sKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkYXJyYXlNb3ZhYmxlLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUucHVzaGFsbGNvbCA9IGZ1bmN0aW9uICh0ZXh0LCB0ZXh0MSwgY29sLCBjb2x1bW5zLCBpc1RydWUpIHtcbiAgICAgICAgaWYgKGNvbC5oZWFkZXJUZXh0ID09PSB0ZXh0MS5oZWFkZXJUZXh0KSB7XG4gICAgICAgICAgICBpZiAoaXNUcnVlKSB7XG4gICAgICAgICAgICAgICAgY29sLmNvbHVtbnMucHVzaChjb2x1bW5zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBuZXdDb2x1bW4gPSB7IGhlYWRlclRleHQ6IHRleHQuaGVhZGVyVGV4dCwgY29sdW1uczogW10gfTtcbiAgICAgICAgICAgICAgICBpZiAodGV4dC50ZXh0QWxpZ24pIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29sdW1uLnRleHRBbGlnbiA9IHRleHQudGV4dEFsaWduO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGV4dC5jdXN0b21BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbHVtbi5jdXN0b21BdHRyaWJ1dGVzID0gdGV4dC5jdXN0b21BdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb2wuY29sdW1ucy5wdXNoKG5ld0NvbHVtbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoY29sLmNvbHVtbnMgJiYgY29sLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2wuY29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnB1c2hhbGxjb2wodGV4dCwgdGV4dDEsIGNvbC5jb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgY29sdW1ucywgaXNUcnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnJlc2V0U3RhY2tlZENvbHVtbnMgPSBmdW5jdGlvbiAoaGVhZGVyY29sLCBncmlkY29sdW1ucywgZnJlZXplKSB7XG4gICAgICAgIHZhciBjb2wgPSB7fTtcbiAgICAgICAgdmFyIHRlbXBIZWFkID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IGhlYWRlcmNvbC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGZpcnN0Y29sID0gaGVhZGVyY29sW2kgLSAxXTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZmlyc3Rjb2wubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoIWNvbC5jb2x1bW5zICYmIGkgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sID0geyBoZWFkZXJUZXh0OiBmaXJzdGNvbFtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uaGVhZGVyVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogZmlyc3Rjb2xbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXM6IGZpcnN0Y29sW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5jdXN0b21BdHRyaWJ1dGVzLCBjb2x1bW5zOiBbXSB9O1xuICAgICAgICAgICAgICAgICAgICB0ZW1wSGVhZC5wdXNoKGZpcnN0Y29sW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGVtcEhlYWQuaW5kZXhPZihmaXJzdGNvbFtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0pID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wdXNoYWxsY29sKGZpcnN0Y29sW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXSwgZmlyc3Rjb2xbaiAtIDFdLCBjb2wpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcEhlYWQucHVzaChmaXJzdGNvbFtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChqID09PSBmaXJzdGNvbC5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHVzaGFsbGNvbChudWxsLCBmaXJzdGNvbFtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0sIGNvbCwgZ3JpZGNvbHVtbnNbaSAtIDFdLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGNvdW50ICE9PSBoZWFkZXJjb2wubGVuZ3RoIC0gMSAmJiBpICE9PSBoZWFkZXJjb2wubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlyc3RDb2xIZWFkZXJzID0gZmlyc3Rjb2wubWFwKGZ1bmN0aW9uIChjb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sLmhlYWRlclRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5qb2luKCcsICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlckNvbEhlYWRlcnMgPSBoZWFkZXJjb2xbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gaXRlbS5oZWFkZXJUZXh0OyB9KS5qb2luKCcsICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0Q29sSGVhZGVycyA9PT0gaGVhZGVyQ29sSGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnB1c2hhbGxjb2wobnVsbCwgZmlyc3Rjb2xbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLCBjb2wsIGdyaWRjb2x1bW5zW2kgLSAxXSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChmcmVlemUgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgdGhpcy5mcm96ZW5MZWZ0Q29sdW1ucy5wdXNoKGNvbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZnJlZXplID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICB0aGlzLmZyb3plblJpZ2h0Q29sdW1ucy5wdXNoKGNvbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1vdmFibGVDb2x1bW5zLnB1c2goY29sKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuc3BsaXRGcm96ZW5Db3VudCA9IGZ1bmN0aW9uIChjb2x1bW5zKSB7XG4gICAgICAgIGlmICh0aGlzLmZyb3plbkNvbHVtbnMgfHwgKHRoaXMuY2hhbmdlZFByb3BlcnRpZXMgJiYgdGhpcy5jaGFuZ2VkUHJvcGVydGllcy5mcm96ZW5Db2x1bW5zID09PSAwKSkge1xuICAgICAgICAgICAgdmFyIGNvbHMgPSAhdGhpcy5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiB8fCAodGhpcy5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJiB0aGlzLmlzUHJlcGFyZWRGcm96ZW5Db2x1bW5zKSA/XG4gICAgICAgICAgICAgICAgdGhpcy5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJiB0aGlzLmNvbHVtbk1vZGVsICYmIHRoaXMuY29sdW1uTW9kZWwubGVuZ3RoID8gdGhpcy5jb2x1bW5Nb2RlbCA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29sdW1ucygpIDogdGhpcy5jb2x1bW5zO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNoYW5nZWRQcm9wZXJ0aWVzIHx8ICh0aGlzLmNoYW5nZWRQcm9wZXJ0aWVzICYmICF0aGlzLmNoYW5nZWRQcm9wZXJ0aWVzLmZyb3plbkNvbHVtbnMpKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZyb3plbkNvbHVtbnMgPiBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mcmVlemUgPSAnTGVmdCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnUmlnaHQnIHx8IGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZyZWV6ZSA9PT0gJ0ZpeGVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID0gY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgKCFpc051bGxPclVuZGVmaW5lZChjb2x1bW5zKSA/IGNvbHVtbnMubGVuZ3RoIDogMCk7IGkrKykge1xuICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxlZnRjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmFibGVjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5maXhlZGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpdFN0YWNrZWRDb2x1bW5zKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxlZnRjb3VudCAmJiAhdGhpcy5yaWdodGNvdW50ICYmICF0aGlzLm1vdmFibGVjb3VudCAmJiAhdGhpcy5maXhlZGNvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZnJvemVuTGVmdENvdW50ICs9IHRoaXMubGVmdGNvdW50O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyb3plbkxlZnRDb2x1bW5zLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnJpZ2h0Y291bnQgJiYgIXRoaXMubGVmdGNvdW50ICYmICF0aGlzLm1vdmFibGVjb3VudCAmJiAhdGhpcy5maXhlZGNvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZnJvemVuUmlnaHRDb3VudCArPSB0aGlzLnJpZ2h0Y291bnQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLm1vdmFibGVjb3VudCAmJiAhdGhpcy5sZWZ0Y291bnQgJiYgIXRoaXMucmlnaHRjb3VudCAmJiAhdGhpcy5maXhlZGNvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW92YWJsZUNvdW50ICs9IHRoaXMubW92YWJsZWNvdW50O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmFibGVDb2x1bW5zLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmZpeGVkY291bnQgJiYgIXRoaXMubGVmdGNvdW50ICYmICF0aGlzLnJpZ2h0Y291bnQgJiYgIXRoaXMubW92YWJsZWNvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRDb3VudCArPSB0aGlzLmZpeGVkY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRDb2x1bW5zLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmFibGVDb3VudCArPSB0aGlzLm1vdmFibGVjb3VudDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3ZhYmxlQ29sdW1ucy5wdXNoKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZnJvemVuTGVmdENvdW50ICs9IHRoaXMubGVmdGNvdW50O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyb3plblJpZ2h0Q291bnQgKz0gdGhpcy5yaWdodGNvdW50O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmFibGVDb3VudCArPSB0aGlzLm1vdmFibGVjb3VudDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXhlZENvdW50ICs9IHRoaXMuZml4ZWRjb3VudDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sZWZ0Y291bnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0Y291bnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmFibGVjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhY2tlZExlZnQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkUmlnaHQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkRml4ZWQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkTW92YWJsZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWNrZWRhcnJheUxlZnQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkYXJyYXlSaWdodCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWNrZWRhcnJheUZpeGVkID0gW107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhY2tlZGFycmF5TW92YWJsZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnB1c2hTdGFja2VkQ29sdW1ucyhjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zLCAwLCBhcnIsIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCB7IGhlYWRlclRleHQ6IGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmhlYWRlclRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246IGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnRleHRBbGlnbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbUF0dHJpYnV0ZXM6IGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmN1c3RvbUF0dHJpYnV0ZXMsIGNvbHVtbnM6IFtdIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGFja2VkYXJyYXlMZWZ0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldFN0YWNrZWRDb2x1bW5zKHRoaXMuc3RhY2tlZExlZnQsIHRoaXMuc3RhY2tlZGFycmF5TGVmdCwgJ0xlZnQnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGFja2VkYXJyYXlSaWdodC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRTdGFja2VkQ29sdW1ucyh0aGlzLnN0YWNrZWRSaWdodCwgdGhpcy5zdGFja2VkYXJyYXlSaWdodCwgJ1JpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2tlZGFycmF5Rml4ZWQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0U3RhY2tlZENvbHVtbnModGhpcy5zdGFja2VkRml4ZWQsIHRoaXMuc3RhY2tlZGFycmF5Rml4ZWQsICdGaXhlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YWNrZWRhcnJheU1vdmFibGUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0U3RhY2tlZENvbHVtbnModGhpcy5zdGFja2VkTW92YWJsZSwgdGhpcy5zdGFja2VkYXJyYXlNb3ZhYmxlLCAnTW92YWJsZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhY2tlZExlZnQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkUmlnaHQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkTW92YWJsZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWNrZWRGaXhlZCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWNrZWRhcnJheUxlZnQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkYXJyYXlSaWdodCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWNrZWRhcnJheU1vdmFibGUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFja2VkYXJyYXlGaXhlZCA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mcmVlemUgPT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpc2libGVGcm96ZW5SaWdodCsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyb3plblJpZ2h0Q291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnTGVmdCcgfHwgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNGcm96ZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpc2libGVGcm96ZW5MZWZ0Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mcm96ZW5MZWZ0Q29sdW1ucy5wdXNoKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mcm96ZW5MZWZ0Q291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnRml4ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRDb2x1bW5zLnB1c2goY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpeGVkQ291bnQrKztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3ZhYmxlQ29sdW1ucy5wdXNoKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3ZhYmxlQ291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aXNpYmxlTW92YWJsZSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW92YWJsZUNvbHVtbnMucHVzaChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW92YWJsZUNvdW50Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZyb3plbkxlZnRDb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGNvbHMgPSB0aGlzLmZyb3plbkxlZnRDb2x1bW5zW3RoaXMuZnJvemVuTGVmdENvbHVtbnMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUJvcmRlcih0aGlzLmZyb3plbkxlZnRDb2x1bW5zKTtcbiAgICAgICAgICAgIHRoaXMuZnJvemVuTGVmdEJvcmRlckNvbHVtbnMoY29scyBpbnN0YW5jZW9mIENvbHVtbiA/IHRoaXMubGFzdFZpc2libGVMZWZ0Q29sKHRoaXMuZnJvemVuTGVmdENvbHVtbnMpIDogY29scyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGNvbHMgPSB0aGlzLmZyb3plblJpZ2h0Q29sdW1uc1swXTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQm9yZGVyKHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zKTtcbiAgICAgICAgICAgIHRoaXMuZnJvemVuUmlnaHRCb3JkZXJDb2x1bW5zKGNvbHMgaW5zdGFuY2VvZiBDb2x1bW4gPyB0aGlzLmZpcnN0VmlzaWJsZVJpZ2h0Q29sKHRoaXMuZnJvemVuUmlnaHRDb2x1bW5zKSA6IGNvbHMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgodGhpcy5mcm96ZW5MZWZ0Q29sdW1ucy5sZW5ndGggfHwgdGhpcy5mcm96ZW5SaWdodENvbHVtbnMubGVuZ3RoKSAmJiB0aGlzLmZyZWV6ZUNvbHVtblJlZnJlc2gpIHtcbiAgICAgICAgICAgIHZhciBjb2xzID0gKHRoaXMuZnJvemVuTGVmdENvbHVtbnMuY29uY2F0KHRoaXMubW92YWJsZUNvbHVtbnMpKS5jb25jYXQodGhpcy5mcm96ZW5SaWdodENvbHVtbnMpO1xuICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgY29sdW1uczogY29scyB9LCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuZnJlZXplQ29sdW1uUmVmcmVzaCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5yZW1vdmVCb3JkZXIgPSBmdW5jdGlvbiAoY29sdW1ucykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zICYmIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmJvcmRlciA9PT0gJ1JpZ2h0JyB8fFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5ib3JkZXIgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5ib3JkZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQm9yZGVyKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmJvcmRlciA9PT0gJ1JpZ2h0JyB8fFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5ib3JkZXIgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5ib3JkZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5pc1Zpc2libGVDb2x1bW5zID0gZnVuY3Rpb24gKGNvbHVtbiwgYXJyKSB7XG4gICAgICAgIGlmIChjb2x1bW4uY29sdW1ucyAmJiBjb2x1bW4uY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sdW1uLmNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzVmlzaWJsZUNvbHVtbnMoY29sdW1uLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBhcnIpO1xuICAgICAgICAgICAgICAgIGlmIChjb2x1bW4uY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSAmJlxuICAgICAgICAgICAgICAgICAgICBpc051bGxPclVuZGVmaW5lZChjb2x1bW4uY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucykgJiZcbiAgICAgICAgICAgICAgICAgICAgKCFpc051bGxPclVuZGVmaW5lZChjb2x1bW4uY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzRnJvemVuKSkge1xuICAgICAgICAgICAgICAgICAgICBhcnIucHVzaCgndHJ1ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW4udmlzaWJsZSAmJiAoIWlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbi5mcmVlemUpIHx8IGNvbHVtbi5pc0Zyb3plbikpIHtcbiAgICAgICAgICAgICAgICBhcnIucHVzaCgndHJ1ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5sYXN0VmlzaWJsZUxlZnRDb2wgPSBmdW5jdGlvbiAoY29sdW1ucykge1xuICAgICAgICB2YXIgY29sdW1uO1xuICAgICAgICBmb3IgKHZhciBpID0gY29sdW1ucy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGFyciA9IFtdO1xuICAgICAgICAgICAgdGhpcy5pc1Zpc2libGVDb2x1bW5zKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBhcnIpO1xuICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUgJiYgYXJyLmluZGV4T2YoJ3RydWUnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBjb2x1bW4gPSBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29sdW1uO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZmlyc3RWaXNpYmxlUmlnaHRDb2wgPSBmdW5jdGlvbiAoY29sdW1ucykge1xuICAgICAgICB2YXIgY29sdW1uO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuaXNWaXNpYmxlQ29sdW1ucyhjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgYXJyKTtcbiAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlICYmIGFyci5pbmRleE9mKCd0cnVlJykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uID0gY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbHVtbjtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmZyb3plbkxlZnRCb3JkZXJDb2x1bW5zID0gZnVuY3Rpb24gKGNvbHVtbnMpIHtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbnMpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbnMuY29sdW1ucyAmJiBjb2x1bW5zLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb2x1bW5zLmJvcmRlciA9ICdMZWZ0JztcbiAgICAgICAgICAgIHZhciBjb2xzID0gY29sdW1ucy5jb2x1bW5zW2NvbHVtbnMuY29sdW1ucy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIHRoaXMuZnJvemVuTGVmdEJvcmRlckNvbHVtbnMoY29scyBpbnN0YW5jZW9mIENvbHVtbiAmJiBjb2xzLmNvbHVtbnMgPyB0aGlzLmxhc3RWaXNpYmxlTGVmdENvbChjb2x1bW5zLmNvbHVtbnMpIDogY29scyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb2x1bW5zLmJvcmRlciA9ICdMZWZ0JztcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZnJvemVuUmlnaHRCb3JkZXJDb2x1bW5zID0gZnVuY3Rpb24gKGNvbHVtbnMpIHtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbnMpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbnMuY29sdW1ucyAmJiBjb2x1bW5zLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb2x1bW5zLmJvcmRlciA9ICdSaWdodCc7XG4gICAgICAgICAgICB2YXIgY29scyA9IGNvbHVtbnMuY29sdW1uc1swXTtcbiAgICAgICAgICAgIHRoaXMuZnJvemVuUmlnaHRCb3JkZXJDb2x1bW5zKGNvbHMgaW5zdGFuY2VvZiBDb2x1bW4gJiYgY29scy5jb2x1bW5zID8gdGhpcy5maXJzdFZpc2libGVSaWdodENvbChjb2x1bW5zLmNvbHVtbnMpIDogY29scyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb2x1bW5zLmJvcmRlciA9ICdSaWdodCc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSB2aXNpYmxlIGZyb3plbiBjb2x1bW5zIGNvdW50XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0VmlzaWJsZUZyb3plbkNvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFZpc2libGVGcm96ZW5Db2x1bW5zQ291bnQoKSArIHRoaXMuZ2V0VmlzaWJsZUZyb3plbkNvdW50KHRoaXMuY29sdW1ucywgMCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgRmlsdGVyIG9wZXJhdG9yIGFuZCBmaWVsZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtGaWx0ZXJVSX0gUmV0dXJucyB0aGUgZmlsdGVyIFVJXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RmlsdGVyVUlJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXJNb2R1bGUgPyB0aGlzLmZpbHRlck1vZHVsZS5nZXRGaWx0ZXJVSUluZm8oKSA6IHt9O1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0VmlzaWJsZUZyb3plbkNvbHVtbnNDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpc2libGVGcm96ZW5Db2x1bW5zID0gMDtcbiAgICAgICAgdmFyIGNvbHVtbnMgPSB0aGlzLmNvbHVtbk1vZGVsO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZnJvemVuQ29sdW1uczsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSkge1xuICAgICAgICAgICAgICAgIHZpc2libGVGcm96ZW5Db2x1bW5zKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCh0aGlzLmZyb3plbkxlZnRDb3VudCB8fCB0aGlzLmxlZnRjb3VudCkgfHwgKHRoaXMuZnJvemVuUmlnaHRDb3VudCB8fCB0aGlzLnJpZ2h0Y291bnQpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSAmJiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnTGVmdCdcbiAgICAgICAgICAgICAgICAgICAgfHwgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnUmlnaHQnKSkge1xuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlRnJvemVuQ29sdW1ucysrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmlzaWJsZUZyb3plbkNvbHVtbnM7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5nZXRWaXNpYmxlRnJvemVuQ291bnQgPSBmdW5jdGlvbiAoY29scywgY250KSB7XG4gICAgICAgIGlmICgoIXRoaXMuZnJvemVuTGVmdENvdW50ICYmICF0aGlzLmxlZnRjb3VudCkgJiYgKCF0aGlzLmZyb3plblJpZ2h0Q291bnQgfHwgIXRoaXMucmlnaHRjb3VudCkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb2xzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgY250ID0gdGhpcy5nZXRWaXNpYmxlRnJvemVuQ291bnQoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucywgY250KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0Zyb3plbiAmJiBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbnQrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY250O1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RnJvemVuQ291bnQgPSBmdW5jdGlvbiAoY29scywgY250LCBpbmRleCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gKCFpc051bGxPclVuZGVmaW5lZChjb2xzKSA/IGNvbHMubGVuZ3RoIDogMCk7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICBjbnQgPSB0aGlzLmdldEZyb3plbkNvdW50KGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMsIGNudCwgaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzRnJvemVuICYmIGluZGV4ID4gdGhpcy5mcm96ZW5Db2x1bW5zIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBjbnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY250O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogTmF2aWdhdGVzIHRvIHRoZSBzcGVjaWZpZWQgdGFyZ2V0IHBhZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHBhZ2VObyAtIERlZmluZXMgdGhlIHBhZ2UgbnVtYmVyIHRvIG5hdmlnYXRlLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ29Ub1BhZ2UgPSBmdW5jdGlvbiAocGFnZU5vKSB7XG4gICAgICAgIGlmICh0aGlzLnBhZ2VyTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2VyTW9kdWxlLmdvVG9QYWdlKHBhZ2VObyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIERlZmluZXMgdGhlIHRleHQgb2YgZXh0ZXJuYWwgbWVzc2FnZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gbWVzc2FnZSAtIERlZmluZXMgdGhlIG1lc3NhZ2UgdG8gdXBkYXRlLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUudXBkYXRlRXh0ZXJuYWxNZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKHRoaXMucGFnZXJNb2R1bGUgJiYgIXRoaXMucGFnZXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5wYWdlck1vZHVsZS51cGRhdGVFeHRlcm5hbE1lc3NhZ2UobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNvcnRzIGEgY29sdW1uIHdpdGggdGhlIGdpdmVuIG9wdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sdW1uTmFtZSAtIERlZmluZXMgdGhlIGNvbHVtbiBuYW1lIHRvIGJlIHNvcnRlZC5cbiAgICAgKiBAcGFyYW0ge1NvcnREaXJlY3Rpb259IGRpcmVjdGlvbiAtIERlZmluZXMgdGhlIGRpcmVjdGlvbiBvZiBzb3J0aW5nIGZpZWxkLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNNdWx0aVNvcnQgLSBTcGVjaWZpZXMgd2hldGhlciB0aGUgcHJldmlvdXMgc29ydGVkIGNvbHVtbnMgYXJlIHRvIGJlIG1haW50YWluZWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zb3J0Q29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbk5hbWUsIGRpcmVjdGlvbiwgaXNNdWx0aVNvcnQpIHtcbiAgICAgICAgaWYgKHRoaXMuc29ydE1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5zb3J0TW9kdWxlLnNvcnRDb2x1bW4oY29sdW1uTmFtZSwgZGlyZWN0aW9uLCBpc011bHRpU29ydCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgZXhpc3RpbmcgY29sdW1ucyBhbG9uZyB3aXRoIHRoZSBncmlkIGFjdGlvbnMgbGlrZSBzb3J0aW5nLCBmaWx0ZXJpbmcsIHNlYXJjaGluZywgZ3JvdXBpbmcsIGFnZ3JlZ2F0ZSwgZXRjLiwgYW5kIGdyaWQgd2lsbCByZWZyZXNoIHdpdGggbmV3IGNvbHVtbnMgYmFzZWQgb24gdGhlIHVwZGF0ZWQgbmV3IGRhdGEgc291cmNlLlxuICAgICAqID4gKiBJZiBubyBjb2x1bW5zIGFyZSBzcGVjaWZpZWQgd2hpbGUgY2hhbmdpbmcgdGhlIGRhdGEgc291cmNlLCB0aGVuIHRoZSBjb2x1bW5zIGFyZSBhdXRvIGdlbmVyYXRlZCBpbiB0aGUgR3JpZCBiYXNlZCBvbiB0aGUgbGlzdCBvZiBjb2x1bW5zIGluIHRoZSB1cGRhdGVkIGRhdGEgc291cmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3QgfCBEYXRhTWFuYWdlciB8IERhdGFSZXN1bHR9IGRhdGFTb3VyY2UgLSAgQXNzaWduIHRoZSBuZXcgZGF0YXNvdXJjZS5cbiAgICAgKiBAcGFyYW0ge0NvbHVtbltdIHwgc3RyaW5nW10gfCBDb2x1bW5Nb2RlbFtdfSBjb2x1bW5zIC0gRGVmaW5lcyBjb2x1bW5zLlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqXG4gICAgICpcbiAgICAgKiBgYGB0eXBlc2NyaXB0XG4gICAgICogPGJ1dHRvbiBpZD1cImJ0blwiPmNoYW5nZSBkYXRhU291cmNlIDwvYnV0dG9uPlxuICAgICAqIDxkaXYgaWQ9XCJHcmlkXCI+PC9kaXY+XG4gICAgICogPHNjcmlwdD5cbiAgICAgKiBsZXQgZ3JpZE9iajogR3JpZCA9IG5ldyBHcmlkKHtcbiAgICAgKiAgICAgZGF0YVNvdXJjZTogZW1wbG95ZWVEYXRhLCAgLy8geW91IGNhbiBkZWZpbmUgdGhlIGRhdGFtYW5hZ2VyIGhlcmUgaWYgeW91IGFyZSBiaW5kaW5nIGEgZGF0YSB0aHJvdWdoIGRhdGFtYW5hZ2VyXG4gICAgICogICAgIGNvbHVtbnM6IFtcbiAgICAgKiAgICAgICAgIHsgZmllbGQ6ICdPcmRlcklEJywgaGVhZGVyVGV4dDogJ09yZGVyIElEJywgd2lkdGg6MTAwIH0sXG4gICAgICogICAgICAgICB7IGZpZWxkOiAnRW1wbG95ZWVJRCcsIGhlYWRlclRleHQ6ICdFbXBsb3llZSBJRCcgfV0sXG4gICAgICogfSk7XG4gICAgICogZ3JpZE9iai5hcHBlbmRUbygnI0dyaWQnKTtcbiAgICAgKiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuJykuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCl7XG4gICAgICogbGV0IG5ld0NvbHVtbjogW1xuICAgICAqICAgICB7IGZpZWxkOiAnQ3VzdG9tZXJJRCcsIGhlYWRlclRleHQ6ICdDdXN0b21lciBJRCcsIHdpZHRoOjEwMCB9LFxuICAgICAqICAgICB7IGZpZWxkOiAnRmlyc3ROYW1lJywgaGVhZGVyVGV4dDogJ05hbWUnIH1dO1xuICAgICAqIGdyaWRPYmouY2hhbmdlRGF0YVNvdXJjZShjdXN0b21lckRhdGEsIG5ld0NvbHVtbik7XG4gICAgICogfSk7XG4gICAgICogPC9zY3JpcHQ+XG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5jaGFuZ2VEYXRhU291cmNlID0gZnVuY3Rpb24gKGRhdGFTb3VyY2UsIGNvbHVtbnMpIHtcbiAgICAgICAgdGhpcy5pc0NoYW5nZURhdGFTb3VyY2VDYWxsID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgc29ydFNldHRpbmdzOiB7IGNvbHVtbnM6IFtdIH0gfSwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh7IGZpbHRlclNldHRpbmdzOiB7IGNvbHVtbnM6IFtdIH0gfSwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh7IHNlYXJjaFNldHRpbmdzOiB7IGtleTogJycgfSB9LCB0cnVlKTtcbiAgICAgICAgaWYgKHRoaXMuYWxsb3dHcm91cGluZykge1xuICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgZ3JvdXBTZXR0aW5nczogeyBjb2x1bW5zOiBbXSB9IH0sIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2x1bW5zICYmIGNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyBjb2x1bW5zOiBjb2x1bW5zIH0sIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRhU291cmNlKSB7XG4gICAgICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoY29sdW1ucykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyBjb2x1bW5zOiBbXSB9LCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh7IGRhdGFTb3VyY2U6IGRhdGFTb3VyY2UgfSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5mcmVlemVSZWZyZXNoKCk7XG4gICAgICAgIHRoaXMuaXNDaGFuZ2VEYXRhU291cmNlQ2FsbCA9IGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2xlYXJzIGFsbCB0aGUgc29ydGVkIGNvbHVtbnMgb2YgdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5jbGVhclNvcnRpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnNvcnRNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuc29ydE1vZHVsZS5jbGVhclNvcnRpbmcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHNvcnRlZCBjb2x1bW4gYnkgZmllbGQgbmFtZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCAtIERlZmluZXMgdGhlIGNvbHVtbiBmaWVsZCBuYW1lIHRvIHJlbW92ZSBzb3J0LlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5yZW1vdmVTb3J0Q29sdW1uID0gZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgIGlmICh0aGlzLnNvcnRNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuc29ydE1vZHVsZS5yZW1vdmVTb3J0Q29sdW1uKGZpZWxkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmNsZWFyR3JpZEFjdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh7IHNvcnRTZXR0aW5nczogeyBjb2x1bW5zOiBbXSB9IH0sIHRydWUpO1xuICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyBmaWx0ZXJTZXR0aW5nczogeyBjb2x1bW5zOiBbXSB9IH0sIHRydWUpO1xuICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyBzZWFyY2hTZXR0aW5nczogeyBrZXk6ICcnIH0gfSwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLmFsbG93R3JvdXBpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh7IGdyb3VwU2V0dGluZ3M6IHsgY29sdW1uczogW10gfSB9LCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZyZWV6ZVJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRmlsdGVycyBncmlkIHJvdyBieSBjb2x1bW4gbmFtZSB3aXRoIHRoZSBnaXZlbiBvcHRpb25zLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBmaWVsZE5hbWUgLSBEZWZpbmVzIHRoZSBmaWVsZCBuYW1lIG9mIHRoZSBjb2x1bW4uXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBmaWx0ZXJPcGVyYXRvciAtIERlZmluZXMgdGhlIG9wZXJhdG9yIHRvIGZpbHRlciByZWNvcmRzLlxuICAgICAqIEBwYXJhbSAge3N0cmluZyB8IG51bWJlciB8IERhdGUgfCBib29sZWFufSBmaWx0ZXJWYWx1ZSAtIERlZmluZXMgdGhlIHZhbHVlIHVzZWQgdG8gZmlsdGVyIHJlY29yZHMuXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBwcmVkaWNhdGUgLSBEZWZpbmVzIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBvbmUgZmlsdGVyIHF1ZXJ5IGFuZCBhbm90aGVyIGJ5IHVzaW5nIEFORCBvciBPUiBwcmVkaWNhdGUuXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gbWF0Y2hDYXNlIC0gSWYgbWF0Y2ggY2FzZSBpcyBzZXQgdG8gdHJ1ZSwgdGhlIGdyaWQgZmlsdGVycyB0aGUgcmVjb3JkcyB3aXRoIGV4YWN0IG1hdGNoLiBpZiBmYWxzZSwgaXQgZmlsdGVycyBjYXNlXG4gICAgICogaW5zZW5zaXRpdmUgcmVjb3JkcyAodXBwZXJjYXNlIGFuZCBsb3dlcmNhc2UgbGV0dGVycyB0cmVhdGVkIHRoZSBzYW1lKS5cbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBpZ25vcmVBY2NlbnQgLSBJZiBpZ25vcmVBY2NlbnQgc2V0IHRvIHRydWUsXG4gICAgICogdGhlbiBmaWx0ZXIgaWdub3JlcyB0aGUgZGlhY3JpdGljIGNoYXJhY3RlcnMgb3IgYWNjZW50cyB3aGlsZSBmaWx0ZXJpbmcuXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBhY3R1YWxGaWx0ZXJWYWx1ZSAtIERlZmluZXMgdGhlIGFjdHVhbCBmaWx0ZXIgdmFsdWUgZm9yIHRoZSBmaWx0ZXIgY29sdW1uLlxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gYWN0dWFsT3BlcmF0b3IgLSBEZWZpbmVzIHRoZSBhY3R1YWwgZmlsdGVyIG9wZXJhdG9yIGZvciB0aGUgZmlsdGVyIGNvbHVtbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmZpbHRlckJ5Q29sdW1uID0gZnVuY3Rpb24gKGZpZWxkTmFtZSwgZmlsdGVyT3BlcmF0b3IsIGZpbHRlclZhbHVlLCBwcmVkaWNhdGUsIG1hdGNoQ2FzZSwgaWdub3JlQWNjZW50LCBhY3R1YWxGaWx0ZXJWYWx1ZSwgYWN0dWFsT3BlcmF0b3IpIHtcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlck1vZHVsZS5maWx0ZXJCeUNvbHVtbihmaWVsZE5hbWUsIGZpbHRlck9wZXJhdG9yLCBmaWx0ZXJWYWx1ZSwgcHJlZGljYXRlLCBtYXRjaENhc2UsIGlnbm9yZUFjY2VudCwgYWN0dWFsRmlsdGVyVmFsdWUsIGFjdHVhbE9wZXJhdG9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2xlYXJzIGFsbCB0aGUgZmlsdGVyZWQgcm93cyBvZiB0aGUgR3JpZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nW119IGZpZWxkcyAtIERlZmluZXMgdGhlIEZpZWxkc1xuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmNsZWFyRmlsdGVyaW5nID0gZnVuY3Rpb24gKGZpZWxkcykge1xuICAgICAgICBpZiAodGhpcy5maWx0ZXJNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyTW9kdWxlLmNsZWFyRmlsdGVyaW5nKGZpZWxkcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgZmlsdGVyZWQgY29sdW1uIGJ5IGZpZWxkIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGZpZWxkIC0gRGVmaW5lcyBjb2x1bW4gZmllbGQgbmFtZSB0byByZW1vdmUgZmlsdGVyLlxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IGlzQ2xlYXJGaWx0ZXJCYXIgLSAgU3BlY2lmaWVzIHdoZXRoZXIgdGhlIGZpbHRlciBiYXIgdmFsdWUgbmVlZHMgdG8gYmUgY2xlYXJlZC5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUucmVtb3ZlRmlsdGVyZWRDb2xzQnlGaWVsZCA9IGZ1bmN0aW9uIChmaWVsZCwgaXNDbGVhckZpbHRlckJhcikge1xuICAgICAgICBpZiAodGhpcy5maWx0ZXJNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyTW9kdWxlLnJlbW92ZUZpbHRlcmVkQ29sc0J5RmllbGQoZmllbGQsIGlzQ2xlYXJGaWx0ZXJCYXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZWxlY3RzIGEgcm93IGJ5IGdpdmVuIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBpbmRleCAtIERlZmluZXMgdGhlIHJvdyBpbmRleC5cbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBpc1RvZ2dsZSAtIElmIHNldCB0byB0cnVlLCB0aGVuIGl0IHRvZ2dsZXMgdGhlIHNlbGVjdGlvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNlbGVjdFJvdyA9IGZ1bmN0aW9uIChpbmRleCwgaXNUb2dnbGUpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbk1vZHVsZS5zZWxlY3RSb3coaW5kZXgsIGlzVG9nZ2xlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VsZWN0cyBhIGNvbGxlY3Rpb24gb2Ygcm93cyBieSBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyW119IHJvd0luZGV4ZXMgLSBTcGVjaWZpZXMgdGhlIHJvdyBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2VsZWN0Um93cyA9IGZ1bmN0aW9uIChyb3dJbmRleGVzKSB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbk1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25Nb2R1bGUuc2VsZWN0Um93cyhyb3dJbmRleGVzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRGVzZWxlY3RzIHRoZSBjdXJyZW50IHNlbGVjdGVkIHJvd3MgYW5kIGNlbGxzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuY2xlYXJTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbk1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25Nb2R1bGUuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VsZWN0cyBhIGNlbGwgYnkgdGhlIGdpdmVuIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7SUluZGV4fSBjZWxsSW5kZXggLSBEZWZpbmVzIHRoZSByb3cgYW5kIGNvbHVtbiBpbmRleGVzLlxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IGlzVG9nZ2xlIC0gSWYgc2V0IHRvIHRydWUsIHRoZW4gaXQgdG9nZ2xlcyB0aGUgc2VsZWN0aW9uLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2VsZWN0Q2VsbCA9IGZ1bmN0aW9uIChjZWxsSW5kZXgsIGlzVG9nZ2xlKSB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbk1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25Nb2R1bGUuc2VsZWN0Q2VsbChjZWxsSW5kZXgsIGlzVG9nZ2xlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VsZWN0cyBhIHJhbmdlIG9mIGNlbGxzIGZyb20gc3RhcnQgYW5kIGVuZCBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7SUluZGV4fSBzdGFydEluZGV4IC0gU3BlY2lmaWVzIHRoZSByb3cgYW5kIGNvbHVtbidzIHN0YXJ0IGluZGV4LlxuICAgICAqIEBwYXJhbSAge0lJbmRleH0gZW5kSW5kZXggLSBTcGVjaWZpZXMgdGhlIHJvdyBhbmQgY29sdW1uJ3MgZW5kIGluZGV4LlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2VsZWN0Q2VsbHNCeVJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uTW9kdWxlLnNlbGVjdENlbGxzQnlSYW5nZShzdGFydEluZGV4LCBlbmRJbmRleCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZWFyY2hlcyBHcmlkIHJlY29yZHMgdXNpbmcgdGhlIGdpdmVuIGtleS5cbiAgICAgKiBZb3UgY2FuIGN1c3RvbWl6ZSB0aGUgZGVmYXVsdCBzZWFyY2ggb3B0aW9uIGJ5IHVzaW5nIHRoZVxuICAgICAqIFtgc2VhcmNoU2V0dGluZ3NgXSguLyNzZWFyY2hzZXR0aW5ncy8pLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBzZWFyY2hTdHJpbmcgLSBEZWZpbmVzIHRoZSBrZXkuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbiAoc2VhcmNoU3RyaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLnNlYXJjaE1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hNb2R1bGUuc2VhcmNoKHNlYXJjaFN0cmluZyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEJ5IGRlZmF1bHQsIHByaW50cyBhbGwgdGhlIHBhZ2VzIG9mIHRoZSBHcmlkIGFuZCBoaWRlcyB0aGUgcGFnZXIuXG4gICAgICogPiBZb3UgY2FuIGN1c3RvbWl6ZSBwcmludCBvcHRpb25zIHVzaW5nIHRoZVxuICAgICAqIFtgcHJpbnRNb2RlYF0oLi8jcHJpbnRtb2RlKS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnByaW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wcmludE1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5wcmludE1vZHVsZS5wcmludCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBEZWxldGUgYSByZWNvcmQgd2l0aCBHaXZlbiBvcHRpb25zLiBJZiBmaWVsZG5hbWUgYW5kIGRhdGEgaXMgbm90IGdpdmVuIHRoZW4gZ3JpZCB3aWxsIGRlbGV0ZSB0aGUgc2VsZWN0ZWQgcmVjb3JkLlxuICAgICAqID4gYGVkaXRTZXR0aW5ncy5hbGxvd0RlbGV0aW5nYCBzaG91bGQgYmUgdHJ1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZG5hbWUgLSBEZWZpbmVzIHRoZSBwcmltYXJ5IGtleSBmaWVsZCwgJ05hbWUgb2YgdGhlIGNvbHVtbicuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgLSBEZWZpbmVzIHRoZSBKU09OIGRhdGEgb2YgdGhlIHJlY29yZCB0byBiZSBkZWxldGVkLlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmRlbGV0ZVJlY29yZCA9IGZ1bmN0aW9uIChmaWVsZG5hbWUsIGRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMuZWRpdE1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5lZGl0TW9kdWxlLmRlbGV0ZVJlY29yZChmaWVsZG5hbWUsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTdGFydHMgZWRpdCB0aGUgc2VsZWN0ZWQgcm93LiBBdCBsZWFzdCBvbmUgcm93IG11c3QgYmUgc2VsZWN0ZWQgYmVmb3JlIGludm9raW5nIHRoaXMgbWV0aG9kLlxuICAgICAqIGBlZGl0U2V0dGluZ3MuYWxsb3dFZGl0aW5nYCBzaG91bGQgYmUgdHJ1ZS5cbiAgICAgKiB7JSBjb2RlQmxvY2sgc3JjPSdncmlkL3N0YXJ0RWRpdC9pbmRleC5tZCcgJX17JSBlbmRjb2RlQmxvY2sgJX1cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnN0YXJ0RWRpdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWRpdE1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5lZGl0TW9kdWxlLnN0YXJ0RWRpdCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBJZiBHcmlkIGlzIGluIGVkaXRhYmxlIHN0YXRlLCB5b3UgY2FuIHNhdmUgYSByZWNvcmQgYnkgaW52b2tpbmcgZW5kRWRpdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmVuZEVkaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmVkaXRNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdE1vZHVsZS5lbmRFZGl0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENhbmNlbHMgZWRpdGVkIHN0YXRlLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuY2xvc2VFZGl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5lZGl0TW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRNb2R1bGUuY2xvc2VFZGl0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFkZHMgYSBuZXcgcmVjb3JkIHRvIHRoZSBHcmlkLiBXaXRob3V0IHBhc3NpbmcgcGFyYW1ldGVycywgaXQgYWRkcyBlbXB0eSByb3dzLlxuICAgICAqID4gYGVkaXRTZXR0aW5ncy5hbGxvd0VkaXRpbmdgIHNob3VsZCBiZSB0cnVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgLSBEZWZpbmVzIHRoZSBuZXcgYWRkIHJlY29yZCBkYXRhLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIERlZmluZXMgdGhlIHJvdyBpbmRleCB0byBiZSBhZGRlZFxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmFkZFJlY29yZCA9IGZ1bmN0aW9uIChkYXRhLCBpbmRleCkge1xuICAgICAgICBpZiAodGhpcy5lZGl0TW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRNb2R1bGUuYWRkUmVjb3JkKGRhdGEsIGluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRGVsZXRlIGFueSB2aXNpYmxlIHJvdyBieSBUUiBlbGVtZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtIVE1MVGFibGVSb3dFbGVtZW50fSB0ciAtIERlZmluZXMgdGhlIHRhYmxlIHJvdyBlbGVtZW50LlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmRlbGV0ZVJvdyA9IGZ1bmN0aW9uICh0cikge1xuICAgICAgICBpZiAodGhpcy5lZGl0TW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRNb2R1bGUuZGVsZXRlUm93KHRyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyBhIHBhcnRpY3VsYXIgY2VsbCBpbnRvIGVkaXRlZCBzdGF0ZSBiYXNlZCBvbiB0aGUgcm93IGluZGV4IGFuZCBmaWVsZCBuYW1lIHByb3ZpZGVkIGluIHRoZSBgYmF0Y2hgIG1vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBEZWZpbmVzIHJvdyBpbmRleCB0byBlZGl0IGEgcGFydGljdWxhciBjZWxsLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCAtIERlZmluZXMgdGhlIGZpZWxkIG5hbWUgb2YgdGhlIGNvbHVtbiB0byBwZXJmb3JtIGJhdGNoIGVkaXQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5lZGl0Q2VsbCA9IGZ1bmN0aW9uIChpbmRleCwgZmllbGQpIHtcbiAgICAgICAgaWYgKHRoaXMuZWRpdE1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5lZGl0TW9kdWxlLmVkaXRDZWxsKGluZGV4LCBmaWVsZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNhdmVzIHRoZSBjZWxsIHRoYXQgaXMgY3VycmVudGx5IGVkaXRlZC4gSXQgZG9lcyBub3Qgc2F2ZSB0aGUgdmFsdWUgdG8gdGhlIERhdGFTb3VyY2UuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiB7JSBjb2RlQmxvY2sgc3JjPSdncmlkL3NhdmVDZWxsL2luZGV4Lm1kJyAlfXslIGVuZGNvZGVCbG9jayAlfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNhdmVDZWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5lZGl0TW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRNb2R1bGUuc2F2ZUNlbGwoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVG8gdXBkYXRlIHRoZSBzcGVjaWZpZWQgY2VsbCBieSBnaXZlbiB2YWx1ZSB3aXRob3V0IGNoYW5naW5nIGludG8gZWRpdGVkIHN0YXRlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJvd0luZGV4IERlZmluZXMgdGhlIHJvdyBpbmRleC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRGVmaW5lcyB0aGUgY29sdW1uIGZpZWxkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiB8IERhdGV9IHZhbHVlIC0gRGVmaW5lcyB0aGUgdmFsdWUgdG8gYmUgY2hhbmdlZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnVwZGF0ZUNlbGwgPSBmdW5jdGlvbiAocm93SW5kZXgsIGZpZWxkLCB2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5lZGl0TW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRNb2R1bGUudXBkYXRlQ2VsbChyb3dJbmRleCwgZmllbGQsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVG8gdXBkYXRlIHRoZSBzcGVjaWZpZWQgcm93IGJ5IGdpdmVuIHZhbHVlcyB3aXRob3V0IGNoYW5naW5nIGludG8gZWRpdGVkIHN0YXRlLlxuICAgICAqXG4gICAgICogeyUgY29kZUJsb2NrIHNyYz0nZ3JpZC91cGRhdGVSb3cvaW5kZXgubWQnICV9eyUgZW5kY29kZUJsb2NrICV9XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggRGVmaW5lcyB0aGUgcm93IGluZGV4LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIERlZmluZXMgdGhlIGRhdGEgb2JqZWN0IHRvIGJlIHVwZGF0ZWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS51cGRhdGVSb3cgPSBmdW5jdGlvbiAoaW5kZXgsIGRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMuZWRpdE1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5lZGl0TW9kdWxlLnVwZGF0ZVJvdyhpbmRleCwgZGF0YSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGFkZGVkLCBlZGl0ZWQsYW5kIGRlbGV0ZWQgZGF0YSBiZWZvcmUgYnVsayBzYXZlIHRvIHRoZSBEYXRhU291cmNlIGluIGJhdGNoIG1vZGUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBiYXRjaCBjaGFuZ2VzXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0QmF0Y2hDaGFuZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5lZGl0TW9kdWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lZGl0TW9kdWxlLmdldEJhdGNoQ2hhbmdlcygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEVuYWJsZXMgb3IgZGlzYWJsZXMgVG9vbEJhciBpdGVtcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nW119IGl0ZW1zIC0gRGVmaW5lcyB0aGUgY29sbGVjdGlvbiBvZiBpdGVtSUQgb2YgVG9vbEJhciBpdGVtcy5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzRW5hYmxlIC0gRGVmaW5lcyB0aGUgaXRlbXMgdG8gYmUgZW5hYmxlZCBvciBkaXNhYmxlZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmVuYWJsZVRvb2xiYXJJdGVtcyA9IGZ1bmN0aW9uIChpdGVtcywgaXNFbmFibGUpIHtcbiAgICAgICAgaWYgKHRoaXMudG9vbGJhck1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy50b29sYmFyTW9kdWxlLmVuYWJsZUl0ZW1zKGl0ZW1zLCBpc0VuYWJsZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENvcHkgdGhlIHNlbGVjdGVkIHJvd3Mgb3IgY2VsbHMgZGF0YSBpbnRvIGNsaXBib2FyZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gd2l0aEhlYWRlciAtIFNwZWNpZmllcyB3aGV0aGVyIHRoZSBjb2x1bW4gaGVhZGVyIHRleHQgbmVlZHMgdG8gYmUgY29waWVkIGFsb25nIHdpdGggcm93cyBvciBjZWxscy5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKHdpdGhIZWFkZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuY2xpcGJvYXJkTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmNsaXBib2FyZE1vZHVsZS5jb3B5KHdpdGhIZWFkZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUucmVjYWxjSW5kZW50V2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpc18xID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLmdldEhlYWRlclRhYmxlKCkucXVlcnlTZWxlY3RvcignLmUtZW1wdHljZWxsJykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKCF0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiYgIXRoaXMuaXNEZXRhaWwoKSAmJiAhdGhpcy5pc1Jvd0RyYWdhYmxlKCkpIHx8XG4gICAgICAgICAgICB0aGlzLmdldEhlYWRlclRhYmxlKCkucXVlcnlTZWxlY3RvcignLmUtZW1wdHljZWxsLmUtaW5kZW50UmVmcmVzaGVkJykgfHxcbiAgICAgICAgICAgICF0aGlzLmdldENvbnRlbnRUYWJsZSgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGVudFdpZHRoID0gdGhpcy5nZXRIZWFkZXJUYWJsZSgpLnF1ZXJ5U2VsZWN0b3IoJy5lLWVtcHR5Y2VsbCcpLnBhcmVudEVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgICAgIHZhciBoZWFkZXJDb2wgPSBbXS5zbGljZS5jYWxsKHRoaXMuZ2V0SGVhZGVyVGFibGUoKS5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLmNvbEdyb3VwKS5jaGlsZE5vZGVzKTtcbiAgICAgICAgdmFyIGNvbnRlbnRDb2wgPSBbXS5zbGljZS5jYWxsKHRoaXMuZ2V0Q29udGVudFRhYmxlKCkucXVlcnlTZWxlY3RvcihsaXRlcmFscy5jb2xHcm91cCkuY2hpbGROb2Rlcyk7XG4gICAgICAgIHZhciBwZXJQaXhlbCA9IGluZGVudFdpZHRoIC8gMzA7XG4gICAgICAgIHZhciBpID0gdGhpcy5nZXRGcm96ZW5Nb2RlKCkgPT09ICdSaWdodCcgPyB0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggKyB0aGlzLmdldENvbHVtbnMoKS5sZW5ndGggOiAwO1xuICAgICAgICB2YXIgcGFyZW50T2Zmc2V0ID0gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoO1xuICAgICAgICB2YXIgYXBwbHlXaWR0aCA9IGZ1bmN0aW9uIChpbmRleCwgd2lkdGgpIHtcbiAgICAgICAgICAgIGlmIChpc3BlcmNlbnRhZ2VXaWR0aChfdGhpc18xKSkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdXaWR0aCA9ICh3aWR0aCAvIHBhcmVudE9mZnNldCAqIDEwMCkudG9GaXhlZCgxKSArICclJztcbiAgICAgICAgICAgICAgICBoZWFkZXJDb2xbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS5zdHlsZS53aWR0aCA9IG5ld1dpZHRoO1xuICAgICAgICAgICAgICAgIGNvbnRlbnRDb2xbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS5zdHlsZS53aWR0aCA9IG5ld1dpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyQ29sW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0uc3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XG4gICAgICAgICAgICAgICAgY29udGVudENvbFtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldLnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXNfMS5ub3RpZnkoZXZlbnRzLmNvbHVtbldpZHRoQ2hhbmdlZCwgeyBpbmRleDogaW5kZXgsIHdpZHRoOiB3aWR0aCB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHBlclBpeGVsID49IDEpIHtcbiAgICAgICAgICAgIGluZGVudFdpZHRoID0gKDMwIC8gcGVyUGl4ZWwpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbmRlbnRXaWR0aCA8IDEpIHtcbiAgICAgICAgICAgIGluZGVudFdpZHRoID0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiB8fCB0aGlzLmlzQXV0b0dlbiB8fCAodGhpcy5jb2x1bW5zLmxlbmd0aCA9PT0gdGhpcy5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKSkge1xuICAgICAgICAgICAgaW5kZW50V2lkdGggPSAzMDtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoaSA8IHRoaXMuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgYXBwbHlXaWR0aChpLCBpbmRlbnRXaWR0aCk7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNEZXRhaWwoKSkge1xuICAgICAgICAgICAgYXBwbHlXaWR0aChpLCBpbmRlbnRXaWR0aCk7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNSb3dEcmFnYWJsZSgpKSB7XG4gICAgICAgICAgICBhcHBseVdpZHRoKGksIGluZGVudFdpZHRoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzQXV0b0dlbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLmdldEhlYWRlclRhYmxlKCkucXVlcnlTZWxlY3RvcignLmUtZW1wdHljZWxsJykuY2xhc3NMaXN0LmFkZCgnZS1pbmRlbnRSZWZyZXNoZWQnKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5yZXNldEluZGVudFdpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc3BlcmNlbnRhZ2VXaWR0aCh0aGlzKSkge1xuICAgICAgICAgICAgdGhpcy5nZXRIZWFkZXJUYWJsZSgpLnF1ZXJ5U2VsZWN0b3IoJy5lLWVtcHR5Y2VsbCcpLmNsYXNzTGlzdC5yZW1vdmUoJ2UtaW5kZW50UmVmcmVzaGVkJyk7XG4gICAgICAgICAgICB0aGlzLndpZHRoU2VydmljZS5zZXRXaWR0aFRvQ29sdW1ucygpO1xuICAgICAgICAgICAgdGhpcy5yZWNhbGNJbmRlbnRXaWR0aCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuYXV0b0ZpdCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJldmVudEFkanVzdENvbHVtbnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoKHRoaXMud2lkdGggPT09ICdhdXRvJyB8fCB0eXBlb2YgKHRoaXMud2lkdGgpID09PSAnc3RyaW5nJyAmJiB0aGlzLndpZHRoLmluZGV4T2YoJyUnKSAhPT0gLTEpXG4gICAgICAgICAgICAmJiB0aGlzLmdldENvbHVtbnMoKS5maWx0ZXIoZnVuY3Rpb24gKGNvbCkgeyByZXR1cm4gKCFjb2wud2lkdGggfHwgY29sLndpZHRoID09PSAnYXV0bycpICYmIGNvbC5taW5XaWR0aDsgfSkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIHRncmlkV2lkdGggPSB0aGlzLndpZHRoU2VydmljZS5nZXRUYWJsZVdpZHRoKHRoaXMuZ2V0Q29sdW1ucygpLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMud2lkdGhTZXJ2aWNlLnNldE1pbndpZHRoQnljYWxjdWxhdGlvbih0Z3JpZFdpZHRoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc0Zyb3plbkdyaWQoKSAmJiB0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uICYmIHRoaXMud2lkdGhTZXJ2aWNlKSB7XG4gICAgICAgICAgICB0aGlzLndpZHRoU2VydmljZS5yZWZyZXNoRnJvemVuU2Nyb2xsYmFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWxsb3dUZXh0V3JhcCAmJiB0aGlzLnRleHRXcmFwU2V0dGluZ3Mud3JhcE1vZGUgIT09ICdDb250ZW50Jykge1xuICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLnJlZnJlc2hIYW5kbGVycywge30pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZyb3plblJvd3MgJiYgdGhpcy5zY3JvbGxNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlLnJlc2l6ZUZyb3plblJvd0JvcmRlcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZVN0aWNreUhlYWRlcikge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxNb2R1bGUubWFrZVN0aWNreUhlYWRlcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUF1dG9GaWxsICYmIHRoaXMuc2VsZWN0aW9uU2V0dGluZ3MudHlwZSA9PT0gJ011bHRpcGxlJyAmJlxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TZXR0aW5ncy5tb2RlID09PSAnQ2VsbCcgJiYgdGhpcy5zZWxlY3Rpb25Nb2R1bGUuc2VsZWN0ZWRSb3dDZWxsSW5kZXhlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uTW9kdWxlLnVwZGF0ZUF1dG9GaWxsUG9zaXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uTW9kdWxlLmRyYXdCb3JkZXJzKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBpc1Jvd0RyYWdhYmxlXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuaXNSb3dEcmFnYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsb3dSb3dEcmFnQW5kRHJvcCAmJiAhdGhpcy5yb3dEcm9wU2V0dGluZ3MudGFyZ2V0SUQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBHcmlkIGNvbHVtbiBwb3NpdGlvbnMgYnkgZmllbGQgbmFtZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGZyb21GTmFtZSAtIERlZmluZXMgdGhlIG9yaWdpbiBmaWVsZCBuYW1lLlxuICAgICAqIEBwYXJhbSAge3N0cmluZ30gdG9GTmFtZSAtIERlZmluZXMgdGhlIGRlc3RpbmF0aW9uIGZpZWxkIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5yZW9yZGVyQ29sdW1ucyA9IGZ1bmN0aW9uIChmcm9tRk5hbWUsIHRvRk5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMucmVvcmRlck1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5yZW9yZGVyTW9kdWxlLnJlb3JkZXJDb2x1bW5zKGZyb21GTmFtZSwgdG9GTmFtZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIEdyaWQgY29sdW1uIHBvc2l0aW9ucyBieSBmaWVsZCBpbmRleC4gSWYgeW91IGludm9rZSByZW9yZGVyQ29sdW1uQnlJbmRleCBtdWx0aXBsZSB0aW1lcyxcbiAgICAgKiB0aGVuIHlvdSB3b24ndCBnZXQgdGhlIHNhbWUgcmVzdWx0cyBldmVyeSB0aW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSBmcm9tSW5kZXggLSBEZWZpbmVzIHRoZSBvcmlnaW4gZmllbGQgaW5kZXguXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSB0b0luZGV4IC0gRGVmaW5lcyB0aGUgZGVzdGluYXRpb24gZmllbGQgaW5kZXguXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5yZW9yZGVyQ29sdW1uQnlJbmRleCA9IGZ1bmN0aW9uIChmcm9tSW5kZXgsIHRvSW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVvcmRlck1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5yZW9yZGVyTW9kdWxlLnJlb3JkZXJDb2x1bW5CeUluZGV4KGZyb21JbmRleCwgdG9JbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIEdyaWQgY29sdW1uIHBvc2l0aW9ucyBieSBmaWVsZCBpbmRleC4gSWYgeW91IGludm9rZSByZW9yZGVyQ29sdW1uQnlUYXJnZXRJbmRleCBtdWx0aXBsZSB0aW1lcyxcbiAgICAgKiB0aGVuIHlvdSB3aWxsIGdldCB0aGUgc2FtZSByZXN1bHRzIGV2ZXJ5IHRpbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGZpZWxkTmFtZSAtIERlZmluZXMgdGhlIGZpZWxkIG5hbWUuXG4gICAgICogQHBhcmFtICB7bnVtYmVyfSB0b0luZGV4IC0gRGVmaW5lcyB0aGUgZGVzdGluYXRpb24gZmllbGQgaW5kZXguXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5yZW9yZGVyQ29sdW1uQnlUYXJnZXRJbmRleCA9IGZ1bmN0aW9uIChmaWVsZE5hbWUsIHRvSW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVvcmRlck1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5yZW9yZGVyTW9kdWxlLnJlb3JkZXJDb2x1bW5CeVRhcmdldEluZGV4KGZpZWxkTmFtZSwgdG9JbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIEdyaWQgUm93IHBvc2l0aW9uIHdpdGggZ2l2ZW4gaW5kZXhlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gZnJvbUluZGV4ZXMgLSBEZWZpbmVzIHRoZSBvcmlnaW4gSW5kZXhlcy5cbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHRvSW5kZXggLSBEZWZpbmVzIHRoZSBkZXN0aW5hdGlvbiBJbmRleC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnJlb3JkZXJSb3dzID0gZnVuY3Rpb24gKGZyb21JbmRleGVzLCB0b0luZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLnJvd0RyYWdBbmREcm9wTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLnJvd0RyYWdBbmREcm9wTW9kdWxlLnJlb3JkZXJSb3dzKGZyb21JbmRleGVzLCB0b0luZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtSZXR1cm5UeXBlfSBlIC0gRGVmaW5lcyB0aGUgUmV0dXJuIHR5cGVcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUucmVmcmVzaERhdGFTb3VyY2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB0aGlzLm5vdGlmeSgncmVmcmVzaGRhdGFTb3VyY2UnLCBlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZW5hYmxlIC1EZWZpbmVzIHRoZSBlbmFibGVcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZGlzYWJsZVJvd0REID0gZnVuY3Rpb24gKGVuYWJsZSkge1xuICAgICAgICB2YXIgaGVhZGVyVGFibGUgPSB0aGlzLmdldEhlYWRlclRhYmxlKCk7XG4gICAgICAgIHZhciBjb250ZW50VGFibGUgPSB0aGlzLmdldENvbnRlbnRUYWJsZSgpO1xuICAgICAgICB2YXIgaGVhZGVyUm93cyA9IGhlYWRlclRhYmxlLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoLmUtcm93ZHJhZ2hlYWRlciwgdGguZS1tYXN0ZXJjZWxsJyk7XG4gICAgICAgIHZhciByb3dzID0gdGhpcy5nZXRSb3dzKCk7XG4gICAgICAgIHZhciBkaXNWYWx1ZSA9IGVuYWJsZSA/ICdub25lJyA6ICcnO1xuICAgICAgICBzZXRTdHlsZUF0dHJpYnV0ZShoZWFkZXJUYWJsZS5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLmNvbEdyb3VwKS5jaGlsZE5vZGVzWzBdLCB7ICdkaXNwbGF5JzogZGlzVmFsdWUgfSk7XG4gICAgICAgIHNldFN0eWxlQXR0cmlidXRlKGNvbnRlbnRUYWJsZS5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLmNvbEdyb3VwKS5jaGlsZE5vZGVzWzBdLCB7ICdkaXNwbGF5JzogZGlzVmFsdWUgfSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5nZXRSb3dzKCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlbGUgPSByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgICAgICAgICBhZGRDbGFzcyhbZWxlXSwgJ2UtaGlkZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoW2VsZV0sIFsnZS1oaWRlJ10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaGVhZGVyVGFibGUucXVlcnlTZWxlY3RvckFsbCgndGguZS1yb3dkcmFnaGVhZGVyLCB0aC5lLW1hc3RlcmNlbGwnKS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgdmFyIGVsZSA9IGhlYWRlclJvd3NbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgaWYgKGVuYWJsZSkge1xuICAgICAgICAgICAgICAgIGFkZENsYXNzKFtlbGVdLCAnZS1oaWRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhbZWxlXSwgWydlLWhpZGUnXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIGNvbHVtbiB3aWR0aCB0byBhdXRvbWF0aWNhbGx5IGZpdCBpdHMgY29udGVudCB0byBlbnN1cmUgdGhhdCB0aGUgd2lkdGggc2hvd3MgdGhlIGNvbnRlbnQgd2l0aG91dCB3cmFwcGluZy9oaWRpbmcuXG4gICAgICogPiAqIFRoaXMgbWV0aG9kIGlnbm9yZXMgdGhlIGhpZGRlbiBjb2x1bW5zLlxuICAgICAqID4gKiBVc2VzIHRoZSBgYXV0b0ZpdENvbHVtbnNgIG1ldGhvZCBpbiB0aGUgYGRhdGFCb3VuZGAgZXZlbnQgdG8gcmVzaXplIGF0IGluaXRpYWwgcmVuZGVyaW5nLlxuICAgICAqID4gKiBCeSBzcGVjaWZ5aW5nIHRoZSBzdGFydCByb3cgaW5kZXggYW5kIGVuZCByb3cgaW5kZXgsIHByb3ZpZGluZyB0aGUgcmFuZ2Ugd2l0aGluIHdoaWNoIHRoZSBtYXhpbXVtIHdpZHRoIGZvciB0aGF0IGNvbHVtbiBzaG91bGQgYmUgY29uc2lkZXJlZCB3aGVuIGFwcGx5aW5nIGBhdXRvRml0Q29sdW1uc2AuXG4gICAgICogPiAqIFRoZSB3aWR0aCBvZiBoZWFkZXIgcm93cyBpcyBhbHdheXMgY2FsY3VsYXRlZC4gSWYgdGhlIHdpZHRoIG9mIGEgaGVhZGVyIHJvdyBleGNlZWRzIHRoZSBzcGVjaWZpZWQgcmFuZ2UsIGl0cyB3aWR0aCB3aWxsIGJlIGFsbG9jYXRlZCB0byB0aGUgc3BlY2lmaWMgY29udGVudCByb3dzLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nIHxzdHJpbmdbXX0gZmllbGROYW1lcyAtIERlZmluZXMgdGhlIGNvbHVtbiBuYW1lcy5cbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHN0YXJ0Um93SW5kZXggLSBTcGVjaWZpZXMgdGhlIHN0YXJ0IGluZGV4IG9mIHRoZSBjb250ZW50IHJvdy5cbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IGVuZFJvd0luZGV4IC0gU3BlY2lmaWVzIHRoZSBlbmQgaW5kZXggb2YgY29udGVudCByb3cuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICpcbiAgICAgKlxuICAgICAqIGBgYHR5cGVzY3JpcHRcbiAgICAgKiA8ZGl2IGlkPVwiR3JpZFwiPjwvZGl2PlxuICAgICAqIDxzY3JpcHQ+XG4gICAgICogbGV0IGdyaWRPYmo6IEdyaWQgPSBuZXcgR3JpZCh7XG4gICAgICogICAgIGRhdGFTb3VyY2U6IGVtcGxveWVlRGF0YSxcbiAgICAgKiAgICAgY29sdW1uczogW1xuICAgICAqICAgICAgICAgeyBmaWVsZDogJ09yZGVySUQnLCBoZWFkZXJUZXh0OiAnT3JkZXIgSUQnLCB3aWR0aDoxMDAgfSxcbiAgICAgKiAgICAgICAgIHsgZmllbGQ6ICdFbXBsb3llZUlEJywgaGVhZGVyVGV4dDogJ0VtcGxveWVlIElEJyB9XSxcbiAgICAgKiAgICAgZGF0YUJvdW5kOiAoKSA9PiBncmlkT2JqLmF1dG9GaXRDb2x1bW5zKCdFbXBsb3llZUlEJyk7XG4gICAgICogfSk7XG4gICAgICogZ3JpZE9iai5hcHBlbmRUbygnI0dyaWQnKTtcbiAgICAgKiA8L3NjcmlwdD5cbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmF1dG9GaXRDb2x1bW5zID0gZnVuY3Rpb24gKGZpZWxkTmFtZXMsIHN0YXJ0Um93SW5kZXgsIGVuZFJvd0luZGV4KSB7XG4gICAgICAgIHZhciBpbmplY3RlZE1vZHVsZXMgPSB0aGlzLmdldEluamVjdGVkTW9kdWxlcygpO1xuICAgICAgICB2YXIgcmVzaXplID0gaW5qZWN0ZWRNb2R1bGVzLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ2Z1bmN0aW9uJyAmJiAhaXNOdWxsT3JVbmRlZmluZWQoaXRlbS5wcm90b3R5cGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucHJvdG90eXBlLmdldE1vZHVsZU5hbWUoKSA9PT0gJ3Jlc2l6ZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5uYW1lID09PSAnUmVzaXplJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghdGhpcy5yZXNpemVNb2R1bGUgJiYgcmVzaXplKSB7XG4gICAgICAgICAgICB0aGlzLmF1dG9GaXRDb2x1bW5zUmVzaXplID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB0aGlzLmluamVjdE1vZHVsZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yZXNpemVNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMucmVzaXplTW9kdWxlLmF1dG9GaXRDb2x1bW5zKGZpZWxkTmFtZXMsIHN0YXJ0Um93SW5kZXgsIGVuZFJvd0luZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnByZXZlbnRBZGp1c3RDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoKHRoaXMuZW5hYmxlQWRhcHRpdmVVSSAmJiB0aGlzLnJvd1JlbmRlcmluZ01vZGUgPT09ICdWZXJ0aWNhbCcpXG4gICAgICAgICAgICB8fCAodGhpcy5hbGxvd1Jlc2l6aW5nICYmIHRoaXMucmVzaXplU2V0dGluZ3MubW9kZSA9PT0gJ0F1dG8nKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb2x1bW5zID0gdGhpcy5nZXRDb2x1bW5zKCk7XG4gICAgICAgIHZhciBoZWFkZXJUYWJsZSA9IHRoaXMuZ2V0SGVhZGVyVGFibGUoKTtcbiAgICAgICAgdmFyIHRhYmxlV2lkdGggPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5pbmRleE9mKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZWFkZXJDb2wgPSBbXS5zbGljZS5jYWxsKGhlYWRlclRhYmxlLnF1ZXJ5U2VsZWN0b3IoJ2NvbGdyb3VwJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKCc6bm90KC5lLWdyb3VwLWludGVudCk6bm90KC5lLWRldGFpbC1pbnRlbnQpOm5vdCguZS1kcmFnLWludGVudCknKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoZWFkZXJDb2xbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLndpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlV2lkdGggKz0gcGFyc2VGbG9hdChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS53aWR0aC50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlV2lkdGggPSAwO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhYmxlV2lkdGgpIHtcbiAgICAgICAgICAgIHZhciBwZXJjZW50YWdlV2lkdGggPSB0aGlzLmlzUGVyY2VudGFnZVdpZHRoR3JpZCgpO1xuICAgICAgICAgICAgdmFyIHVuaXQgPSB0aGlzLndpZHRoVW5pdChwZXJjZW50YWdlV2lkdGgpO1xuICAgICAgICAgICAgdmFyIGNvbnRlbnRUYWJsZSA9IHRoaXMuZ2V0Q29udGVudFRhYmxlKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoIHx8IHRoaXMuaXNEZXRhaWwoKSB8fCB0aGlzLmlzUm93RHJhZ2FibGUoKSkge1xuICAgICAgICAgICAgICAgIHZhciBpbmRlbnRXaWR0aCA9IHRoaXMuZGVmYXVsdEluZGVudFdpZHRoKHBlcmNlbnRhZ2VXaWR0aCk7XG4gICAgICAgICAgICAgICAgdmFyIGluZGVudFdpZHRoVW5pdEZvcm1hdCA9IGluZGVudFdpZHRoLnRvU3RyaW5nKCkgKyB1bml0O1xuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJJbmRlbnRDb2wgPSBbXS5zbGljZS5jYWxsKGhlYWRlclRhYmxlLnF1ZXJ5U2VsZWN0b3IoJ2NvbGdyb3VwJylcbiAgICAgICAgICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLWdyb3VwLWludGVudCwgLmUtZGV0YWlsLWludGVudCwgLmUtZHJhZy1pbnRlbnQnKSk7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRJbmRlbnRDb2wgPSBbXS5zbGljZS5jYWxsKGNvbnRlbnRUYWJsZS5xdWVyeVNlbGVjdG9yKCdjb2xncm91cCcpXG4gICAgICAgICAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKCcuZS1ncm91cC1pbnRlbnQsIC5lLWRldGFpbC1pbnRlbnQsIC5lLWRyYWctaW50ZW50JykpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGVhZGVySW5kZW50Q29sLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlckluZGVudENvbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uc3R5bGUuc2V0UHJvcGVydHkoJ3dpZHRoJywgaW5kZW50V2lkdGhVbml0Rm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudEluZGVudENvbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uc3R5bGUuc2V0UHJvcGVydHkoJ3dpZHRoJywgaW5kZW50V2lkdGhVbml0Rm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVXaWR0aCArPSBpbmRlbnRXaWR0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKHBlcmNlbnRhZ2VXaWR0aCAmJiB0YWJsZVdpZHRoIDwgMTAwKVxuICAgICAgICAgICAgICAgIHx8ICghcGVyY2VudGFnZVdpZHRoICYmIHRhYmxlV2lkdGggPCBjb250ZW50VGFibGUucGFyZW50RWxlbWVudC5jbGllbnRXaWR0aCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGNvbnRlbnRUYWJsZS5xdWVyeVNlbGVjdG9yKCcuZS1lbXB0eXJvdycpKSkge1xuICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhbaGVhZGVyVGFibGVdLCBbJ2UtdGFibGVib3JkZXInXSk7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKFtjb250ZW50VGFibGVdLCBbJ2UtdGFibGVib3JkZXInXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhbaGVhZGVyVGFibGUsIGNvbnRlbnRUYWJsZV0sIFsnZS10YWJsZWJvcmRlciddKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGFibGVXaWR0aFVuaXRGb3JtYXQgPSB0YWJsZVdpZHRoLnRvU3RyaW5nKCkgKyB1bml0O1xuICAgICAgICAgICAgaGVhZGVyVGFibGUuc3R5bGUuc2V0UHJvcGVydHkoJ3dpZHRoJywgdGFibGVXaWR0aFVuaXRGb3JtYXQpO1xuICAgICAgICAgICAgY29udGVudFRhYmxlLnN0eWxlLnNldFByb3BlcnR5KCd3aWR0aCcsIHRhYmxlV2lkdGhVbml0Rm9ybWF0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVzdG9yZUFkanVzdENvbHVtbnMoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUucmVzdG9yZUFkanVzdENvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICgodGhpcy5lbmFibGVBZGFwdGl2ZVVJICYmIHRoaXMucm93UmVuZGVyaW5nTW9kZSA9PT0gJ1ZlcnRpY2FsJylcbiAgICAgICAgICAgIHx8ICh0aGlzLmFsbG93UmVzaXppbmcgJiYgdGhpcy5yZXNpemVTZXR0aW5ncy5tb2RlID09PSAnQXV0bycpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhlYWRlclRhYmxlID0gdGhpcy5nZXRIZWFkZXJUYWJsZSgpO1xuICAgICAgICB2YXIgY29udGVudFRhYmxlID0gdGhpcy5nZXRDb250ZW50VGFibGUoKTtcbiAgICAgICAgcmVtb3ZlQ2xhc3MoW2hlYWRlclRhYmxlLCBjb250ZW50VGFibGVdLCBbJ2UtdGFibGVib3JkZXInXSk7XG4gICAgICAgIGhlYWRlclRhYmxlLnN0eWxlLnJlbW92ZVByb3BlcnR5KCd3aWR0aCcpO1xuICAgICAgICBjb250ZW50VGFibGUuc3R5bGUucmVtb3ZlUHJvcGVydHkoJ3dpZHRoJyk7XG4gICAgICAgIGlmICh0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggfHwgdGhpcy5pc0RldGFpbCgpIHx8IHRoaXMuaXNSb3dEcmFnYWJsZSgpKSB7XG4gICAgICAgICAgICB2YXIgcGVyY2VudGFnZVdpZHRoID0gdGhpcy5pc1BlcmNlbnRhZ2VXaWR0aEdyaWQoKTtcbiAgICAgICAgICAgIHZhciBpbmRlbnRXaWR0aFVuaXRGb3JtYXRfMSA9IHRoaXMuZGVmYXVsdEluZGVudFdpZHRoKHBlcmNlbnRhZ2VXaWR0aCkudG9TdHJpbmcoKSArIHRoaXMud2lkdGhVbml0KHBlcmNlbnRhZ2VXaWR0aCk7XG4gICAgICAgICAgICB2YXIgaGVhZGVySW5kZW50Q29sID0gW10uc2xpY2UuY2FsbChoZWFkZXJUYWJsZS5xdWVyeVNlbGVjdG9yKCdjb2xncm91cCcpXG4gICAgICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLWdyb3VwLWludGVudCwgLmUtZGV0YWlsLWludGVudCwgLmUtZHJhZy1pbnRlbnQnKSk7XG4gICAgICAgICAgICBoZWFkZXJJbmRlbnRDb2wuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJ3dpZHRoJywgaW5kZW50V2lkdGhVbml0Rm9ybWF0XzEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBoZWFkZXJUYWJsZS5xdWVyeVNlbGVjdG9yKCcuZS1lbXB0eWNlbGwnKS5jbGFzc0xpc3QucmVtb3ZlKCdlLWluZGVudFJlZnJlc2hlZCcpO1xuICAgICAgICAgICAgdGhpcy5yZWNhbGNJbmRlbnRXaWR0aCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS53aWR0aFVuaXQgPSBmdW5jdGlvbiAocGVyY2VudGFnZVdpZHRoKSB7XG4gICAgICAgIHJldHVybiBwZXJjZW50YWdlV2lkdGggPyAnJScgOiAncHgnO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZGVmYXVsdEluZGVudFdpZHRoID0gZnVuY3Rpb24gKHBlcmNlbnRhZ2VXaWR0aCkge1xuICAgICAgICByZXR1cm4gcGVyY2VudGFnZVdpZHRoID8gcGFyc2VGbG9hdCgoMzAgLyB0aGlzLmVsZW1lbnQub2Zmc2V0V2lkdGggKiAxMDApLnRvRml4ZWQoMSkpIDogMzA7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5pc1BlcmNlbnRhZ2VXaWR0aEdyaWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb2x1bW4gPSB0aGlzLmdldENvbHVtbnMoKS5maW5kKGZ1bmN0aW9uIChjb2wpIHsgcmV0dXJuICFpc051bGxPclVuZGVmaW5lZChjb2wud2lkdGgpOyB9KTtcbiAgICAgICAgcmV0dXJuIGNvbHVtbiA/IGNvbHVtbi53aWR0aC50b1N0cmluZygpLmluZGV4T2YoJyUnKSA+IC0xIDogZmFsc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geCAtIERlZmluZXMgdGhlIG51bWJlclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gRGVmaW5lcyB0aGUgbnVtYmVyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSB0YXJnZXQgLSBEZWZpbmVzIHRoZSBFbGVtZW50XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmNyZWF0ZUNvbHVtbmNob29zZXIgPSBmdW5jdGlvbiAoeCwgeSwgdGFyZ2V0KSB7XG4gICAgICAgIGlmICh0aGlzLmNvbHVtbkNob29zZXJNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuY29sdW1uQ2hvb3Nlck1vZHVsZS5yZW5kZXJDb2x1bW5DaG9vc2VyKHgsIHksIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmluaXRpYWxpemVTZXJ2aWNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTG9jYXRvci5yZWdpc3Rlcignd2lkdGhTZXJ2aWNlJywgdGhpcy53aWR0aFNlcnZpY2UgPSBuZXcgQ29sdW1uV2lkdGhTZXJ2aWNlKHRoaXMpKTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTG9jYXRvci5yZWdpc3RlcignY2VsbFJlbmRlcmVyRmFjdG9yeScsIG5ldyBDZWxsUmVuZGVyZXJGYWN0b3J5KTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTG9jYXRvci5yZWdpc3RlcigncmVuZGVyZXJGYWN0b3J5JywgbmV3IFJlbmRlcmVyRmFjdG9yeSk7XG4gICAgICAgIHRoaXMuc2VydmljZUxvY2F0b3IucmVnaXN0ZXIoJ2xvY2FsaXphdGlvbicsIHRoaXMubG9jYWxlT2JqID0gbmV3IEwxMG4odGhpcy5nZXRNb2R1bGVOYW1lKCksIHRoaXMuZGVmYXVsdExvY2FsZSwgdGhpcy5sb2NhbGUpKTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTG9jYXRvci5yZWdpc3RlcigndmFsdWVGb3JtYXR0ZXInLCB0aGlzLnZhbHVlRm9ybWF0dGVyU2VydmljZSA9IG5ldyBWYWx1ZUZvcm1hdHRlcih0aGlzLmxvY2FsZSkpO1xuICAgICAgICB0aGlzLnNlcnZpY2VMb2NhdG9yLnJlZ2lzdGVyKCdzaG93SGlkZVNlcnZpY2UnLCB0aGlzLnNob3dIaWRlciA9IG5ldyBTaG93SGlkZSh0aGlzKSk7XG4gICAgICAgIHRoaXMuc2VydmljZUxvY2F0b3IucmVnaXN0ZXIoJ2FyaWFTZXJ2aWNlJywgdGhpcy5hcmlhU2VydmljZSA9IG5ldyBBcmlhU2VydmljZSgpKTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTG9jYXRvci5yZWdpc3RlcignZm9jdXMnLCB0aGlzLmZvY3VzTW9kdWxlID0gbmV3IEZvY3VzU3RyYXRlZ3kodGhpcykpO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUucHJvY2Vzc01vZGVsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ0NvbHMgPSB0aGlzLmdyb3VwU2V0dGluZ3MuY29sdW1ucztcbiAgICAgICAgdmFyIHNDb2xzID0gdGhpcy5zb3J0U2V0dGluZ3MuY29sdW1ucztcbiAgICAgICAgdmFyIGZsYWc7XG4gICAgICAgIHZhciBqO1xuICAgICAgICBpZiAodGhpcy5hbGxvd0dyb3VwaW5nKSB7XG4gICAgICAgICAgICB2YXIgX2xvb3BfMyA9IGZ1bmN0aW9uIChpLCBsZW4pIHtcbiAgICAgICAgICAgICAgICBmbGFnID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaiA9IDA7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgc0xlbiA9IHNDb2xzLmxlbmd0aDsgaiA8IHNMZW47IGorKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc0NvbHNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmZpZWxkID09PSBnQ29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFmbGFnKSB7XG4gICAgICAgICAgICAgICAgICAgIHNDb2xzLnB1c2goeyBmaWVsZDogZ0NvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBkaXJlY3Rpb246ICdBc2NlbmRpbmcnLCBpc0Zyb21Hcm91cDogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzXzMuYWxsb3dTb3J0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzXzMuc29ydGVkQ29sdW1ucy5wdXNoKHNDb2xzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5maWVsZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzQ29sc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uZGlyZWN0aW9uID0gJ0FzY2VuZGluZyc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzXzMuZ3JvdXBTZXR0aW5ncy5zaG93R3JvdXBlZENvbHVtbikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sdW1uID0gdGhpc18zLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uID9cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNfMy5jb2x1bW5zLmZpbHRlcihmdW5jdGlvbiAoYykgeyByZXR1cm4gYy5maWVsZCA9PT0gZ0NvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldOyB9KVswXVxuICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzXzMuZ2V0Q29sdW1uQnlGaWVsZChnQ29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sdW1uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW4udmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc18zLmxvZygnaW5pdGlhbF9hY3Rpb24nLCB7IG1vZHVsZU5hbWU6ICdncm91cCcsIGNvbHVtbk5hbWU6IGdDb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgdGhpc18zID0gdGhpcztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBnQ29scy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIF9sb29wXzMoaSwgbGVuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWdDb2xzLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzQ29scy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuc29ydGVkQ29sdW1ucy5wdXNoKHNDb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maWVsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yb3dUZW1wbGF0ZUZuID0gdGVtcGxhdGVDb21waWxlcih0aGlzLnJvd1RlbXBsYXRlKTtcbiAgICAgICAgdGhpcy5lbXB0eVJlY29yZFRlbXBsYXRlRm4gPSB0ZW1wbGF0ZUNvbXBpbGVyKHRoaXMuZW1wdHlSZWNvcmRUZW1wbGF0ZSk7XG4gICAgICAgIHRoaXMuZGV0YWlsVGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIodGhpcy5kZXRhaWxUZW1wbGF0ZSk7XG4gICAgICAgIHRoaXMuZWRpdFRlbXBsYXRlRm4gPSB0ZW1wbGF0ZUNvbXBpbGVyKHRoaXMuZWRpdFNldHRpbmdzLnRlbXBsYXRlKTtcbiAgICAgICAgdGhpcy5lZGl0SGVhZGVyVGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIodGhpcy5lZGl0U2V0dGluZ3MuaGVhZGVyVGVtcGxhdGUpO1xuICAgICAgICB0aGlzLmVkaXRGb290ZXJUZW1wbGF0ZUZuID0gdGVtcGxhdGVDb21waWxlcih0aGlzLmVkaXRTZXR0aW5ncy5mb290ZXJUZW1wbGF0ZSk7XG4gICAgICAgIHRoaXMuY29sdW1uQ2hvb3NlclRlbXBsYXRlRm4gPSB0ZW1wbGF0ZUNvbXBpbGVyKHRoaXMuY29sdW1uQ2hvb3NlclNldHRpbmdzLnRlbXBsYXRlKTtcbiAgICAgICAgdGhpcy5jb2x1bW5DaG9vc2VySGVhZGVyVGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIodGhpcy5jb2x1bW5DaG9vc2VyU2V0dGluZ3MuaGVhZGVyVGVtcGxhdGUpO1xuICAgICAgICB0aGlzLmNvbHVtbkNob29zZXJGb290ZXJUZW1wbGF0ZUZuID0gdGVtcGxhdGVDb21waWxlcih0aGlzLmNvbHVtbkNob29zZXJTZXR0aW5ncy5mb290ZXJUZW1wbGF0ZSk7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnREZXRhaWxzKSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnREZXRhaWxzLnBhcmVudEtleUZpZWxkVmFsdWUpID8gJ3VuZGVmaW5lZCcgOlxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50RGV0YWlscy5wYXJlbnRLZXlGaWVsZFZhbHVlO1xuICAgICAgICAgICAgdGhpcy5xdWVyeS53aGVyZSh0aGlzLnF1ZXJ5U3RyaW5nLCAnZXF1YWwnLCB2YWx1ZSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0Rm9yZWlnbkNvbHVtbigpO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuaW5pdEZvcmVpZ25Db2x1bW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRm9yZWlnbktleUVuYWJsZWQodGhpcy5nZXRDb2x1bW5zKCkpKSB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuaW5pdEZvcmVpZ25LZXlDb2x1bW4sIHRoaXMuZ2V0Rm9yZWlnbktleUNvbHVtbnMoKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmVuYWJsZVZlcnRpY2FsUmVuZGVyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5yb3dSZW5kZXJpbmdNb2RlID09PSAnVmVydGljYWwnKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1yb3ctcmVzcG9uc2l2ZScpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Utcm93LXJlc3BvbnNpdmUnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZ3JpZFJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB0aGlzLnVwZGF0ZVJUTCgpO1xuICAgICAgICBpZiAodGhpcy5yb3dSZW5kZXJpbmdNb2RlID09PSAnVmVydGljYWwnKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1yb3ctcmVzcG9uc2l2ZScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUhvdmVyKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1ncmlkaG92ZXInKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoL14oKD8hY2hyb21lfGFuZHJvaWQpLikqc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSB8fCBCcm93c2VyLmlzU2FmYXJpKCkpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLW1hYy1zYWZhcmknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoQnJvd3Nlci5pc0RldmljZSkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2UtZGV2aWNlJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5hZGFwdGl2ZVVJTW9kZSA9PT0gJ0Rlc2t0b3AnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmFibGVBZGFwdGl2ZVVJID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWRhcHRpdmVVSU1vZGUgPT09ICdNb2JpbGUnICYmICEoQnJvd3Nlci5pc0RldmljZSB8fCB0aGlzLnJvd1JlbmRlcmluZ01vZGUgPT09ICdWZXJ0aWNhbCcpKSB7XG4gICAgICAgICAgICB0aGlzLmVuYWJsZUFkYXB0aXZlVUkgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5yb3dIZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLWdyaWQtbWluLWhlaWdodCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNzc0NsYXNzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jc3NDbGFzcy5pbmRleE9mKCcgJykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgKF9hID0gdGhpcy5lbGVtZW50LmNsYXNzTGlzdCkuYWRkLmFwcGx5KF9hLCB0aGlzLmNzc0NsYXNzLnNwbGl0KCcgJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5jc3NDbGFzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgdGhlIGJlbG93IGlmIHN0YXRlbWVudCBpcyByZW1vdmVkLCB0aGVuIGRyYWcgYW5kIGRyb3AgYmV0d2VlbiBncmlkcyB3aWxsIG5vdCB3b3JrIGluIGZpcmVmb3ggYnJvd3Nlci5cbiAgICAgICAgaWYgKHRoaXMuYWxsb3dSb3dEcmFnQW5kRHJvcCAmJiB0aGlzLnJvd0Ryb3BTZXR0aW5ncy50YXJnZXRJRCAmJiBCcm93c2VyLmluZm8ubmFtZSA9PT0gJ21vemlsbGEnKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1kaXNhYmxldXNlcnNlbGVjdCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmICh0aGlzLmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8IHRoaXMuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRTZXR0aW5ncy5uZXdSb3dQb3NpdGlvbiA9ICdUb3AnO1xuICAgICAgICB9XG4gICAgICAgIGNsYXNzTGlzdCh0aGlzLmVsZW1lbnQsIFsnZS1yZXNwb25zaXZlJywgJ2UtZGVmYXVsdCddLCBbXSk7XG4gICAgICAgIHZhciByZW5kZXJlckZhY3RvcnkgPSB0aGlzLnNlcnZpY2VMb2NhdG9yLmdldFNlcnZpY2UoJ3JlbmRlcmVyRmFjdG9yeScpO1xuICAgICAgICB0aGlzLmhlYWRlck1vZHVsZSA9IHJlbmRlcmVyRmFjdG9yeS5nZXRSZW5kZXJlcihSZW5kZXJUeXBlLkhlYWRlcik7XG4gICAgICAgIHRoaXMuY29udGVudE1vZHVsZSA9IHJlbmRlcmVyRmFjdG9yeS5nZXRSZW5kZXJlcihSZW5kZXJUeXBlLkNvbnRlbnQpO1xuICAgICAgICB0aGlzLnByaW50TW9kdWxlID0gbmV3IFByaW50KHRoaXMsIHRoaXMuc2Nyb2xsTW9kdWxlKTtcbiAgICAgICAgdGhpcy5jbGlwYm9hcmRNb2R1bGUgPSBuZXcgQ2xpcGJvYXJkKHRoaXMsIHRoaXMuc2VydmljZUxvY2F0b3IpO1xuICAgICAgICB0aGlzLnJlbmRlck1vZHVsZS5yZW5kZXIoKTtcbiAgICAgICAgdGhpcy5ldmVudEluaXRpYWxpemVyKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlR3JpZFBvcFVwRWxlbWVudCgpO1xuICAgICAgICB0aGlzLndpZHRoU2VydmljZS5zZXRXaWR0aFRvQ29sdW1ucygpO1xuICAgICAgICB0aGlzLnVwZGF0ZUdyaWRMaW5lcygpO1xuICAgICAgICB0aGlzLmFwcGx5VGV4dFdyYXAoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVUb29sdGlwKCk7IC8vZm9yIGNsaXAgbW9kZSBlbGxpcHNpc1xuICAgICAgICB0aGlzLmVuYWJsZUJveFNlbGVjdGlvbigpO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZGF0YVJlYWR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNjcm9sbE1vZHVsZS5zZXRXaWR0aCgpO1xuICAgICAgICB0aGlzLnNjcm9sbE1vZHVsZS5zZXRIZWlnaHQoKTtcbiAgICAgICAgaWYgKHRoaXMuaGVpZ2h0ICE9PSAnYXV0bycpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlLnNldFBhZGRpbmcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUudXBkYXRlUlRMID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5lbmFibGVSdGwpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLXJ0bCcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2UtcnRsJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmNyZWF0ZUdyaWRQb3BVcEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwb3B1cCA9IHRoaXMuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLWdyaWRwb3B1cCcgfSk7XG4gICAgICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogbGl0ZXJhbHMuY29udGVudCwgYXR0cnM6IHsgdGFiSW5kZXg6ICctMScgfSB9KTtcbiAgICAgICAgYXBwZW5kKFtjb250ZW50LCB0aGlzLmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnZS11cHRhaWwgZS10YWlsJyB9KV0sIHBvcHVwKTtcbiAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKSk7XG4gICAgICAgIGFwcGVuZChbY29udGVudCwgdGhpcy5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtZG93bnRhaWwgZS10YWlsJyB9KV0sIHBvcHVwKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHBvcHVwKTtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnVwZGF0ZUdyaWRMaW5lcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xhc3NMaXN0KHRoaXMuZWxlbWVudCwgW10sIFsnZS12ZXJ0aWNhbGxpbmVzJywgJ2UtaG9yaXpvbnRhbGxpbmVzJywgJ2UtaGlkZWxpbmVzJywgJ2UtYm90aGxpbmVzJ10pO1xuICAgICAgICBzd2l0Y2ggKHRoaXMuZ3JpZExpbmVzKSB7XG4gICAgICAgICAgICBjYXNlICdIb3Jpem9udGFsJzpcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1ob3Jpem9udGFsbGluZXMnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ1ZlcnRpY2FsJzpcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS12ZXJ0aWNhbGxpbmVzJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdOb25lJzpcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1oaWRlbGluZXMnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ0JvdGgnOlxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLWJvdGhsaW5lcycpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlUmVzaXplTGluZXMoKTtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnVwZGF0ZVJlc2l6ZUxpbmVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5hbGxvd1Jlc2l6aW5nICYmXG4gICAgICAgICAgICAhKHRoaXMuZ3JpZExpbmVzID09PSAnVmVydGljYWwnIHx8IHRoaXMuZ3JpZExpbmVzID09PSAnQm90aCcpKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1yZXNpemUtbGluZXMnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdlLXJlc2l6ZS1saW5lcycpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGUgZnVuY3Rpb24gaXMgdXNlZCB0byBhcHBseSB0ZXh0IHdyYXBcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5hcHBseVRleHRXcmFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5hbGxvd1RleHRXcmFwKSB7XG4gICAgICAgICAgICB2YXIgaGVhZGVyUm93cyA9IFtdLnNsaWNlLmNhbGwodGhpcy5lbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2UtY29sdW1uaGVhZGVyJykpO1xuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnRleHRXcmFwU2V0dGluZ3Mud3JhcE1vZGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdIZWFkZXInOlxuICAgICAgICAgICAgICAgICAgICB3cmFwKHRoaXMuZWxlbWVudCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB3cmFwKHRoaXMuZ2V0Q29udGVudCgpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHdyYXAoaGVhZGVyUm93cywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0NvbnRlbnQnOlxuICAgICAgICAgICAgICAgICAgICB3cmFwKHRoaXMuZ2V0Q29udGVudCgpLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgd3JhcCh0aGlzLmVsZW1lbnQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgd3JhcChoZWFkZXJSb3dzLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHdyYXAodGhpcy5lbGVtZW50LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgd3JhcCh0aGlzLmdldENvbnRlbnQoKSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB3cmFwKGhlYWRlclJvd3MsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnRleHRXcmFwU2V0dGluZ3Mud3JhcE1vZGUgIT09ICdDb250ZW50Jykge1xuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5yZWZyZXNoSGFuZGxlcnMsIHt9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVtb3ZlIHRleHQgd3JhcFxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnJlbW92ZVRleHRXcmFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB3cmFwKHRoaXMuZWxlbWVudCwgZmFsc2UpO1xuICAgICAgICB2YXIgaGVhZGVyUm93cyA9IFtdLnNsaWNlLmNhbGwodGhpcy5lbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2UtY29sdW1uaGVhZGVyJykpO1xuICAgICAgICB3cmFwKGhlYWRlclJvd3MsIGZhbHNlKTtcbiAgICAgICAgd3JhcCh0aGlzLmdldENvbnRlbnQoKSwgZmFsc2UpO1xuICAgICAgICBpZiAodGhpcy50ZXh0V3JhcFNldHRpbmdzLndyYXBNb2RlICE9PSAnQ29udGVudCcpIHtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5yZWZyZXNoSGFuZGxlcnMsIHt9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIHVzZWQgdG8gYWRkIFRvb2x0aXAgdG8gdGhlIGdyaWQgY2VsbCB0aGF0IGhhcyBlbGxpcHNpc3dpdGh0b29sdGlwIGNsaXAgbW9kZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5jcmVhdGVUb29sdGlwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnRvb2xUaXBPYmogPSBuZXcgVG9vbHRpcCh7XG4gICAgICAgICAgICBvcGVuc09uOiAnY3VzdG9tJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxuICAgICAgICAgICAgY3NzQ2xhc3M6IHRoaXMuY3NzQ2xhc3MgPyB0aGlzLmNzc0NsYXNzIDogbnVsbFxuICAgICAgICB9LCB0aGlzLmVsZW1lbnQpO1xuICAgIH07XG4gICAgLyoqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5mcmVlemVSZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb21wb25lbnRSZWZyZXNoKCk7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5nZXRUb29sdGlwU3RhdHVzID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgdmFyIGhlYWRlclRhYmxlID0gdGhpcy5nZXRIZWFkZXJUYWJsZSgpO1xuICAgICAgICB2YXIgaGVhZGVyRGl2VGFnID0gdGhpcy5lbmFibGVBZGFwdGl2ZVVJICYmIHRoaXMucm93UmVuZGVyaW5nTW9kZSA9PT0gJ1ZlcnRpY2FsJyA/ICdlLWdyaWRjb250ZW50JyA6ICdlLWdyaWRoZWFkZXInO1xuICAgICAgICB2YXIgaHRhYmxlID0gdGhpcy5jcmVhdGVUYWJsZShoZWFkZXJUYWJsZSwgaGVhZGVyRGl2VGFnLCAnaGVhZGVyJyk7XG4gICAgICAgIHZhciBjdGFibGUgPSB0aGlzLmNyZWF0ZVRhYmxlKGhlYWRlclRhYmxlLCBoZWFkZXJEaXZUYWcsICdjb250ZW50Jyk7XG4gICAgICAgIHZhciB0YWJsZSA9IGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWhlYWRlcmNlbGwnKSA/IGh0YWJsZSA6IGN0YWJsZTtcbiAgICAgICAgdmFyIGVsZSA9IGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWhlYWRlcmNlbGwnKSA/ICd0aCcgOiAndHInO1xuICAgICAgICB0YWJsZS5xdWVyeVNlbGVjdG9yKGVsZSkuY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWU7XG4gICAgICAgIHZhciB0YXJnZXRFbGVtZW50ID0gdGFibGUucXVlcnlTZWxlY3RvcihlbGUpO1xuICAgICAgICB0YXJnZXRFbGVtZW50LmlubmVySFRNTCA9ICcnO1xuICAgICAgICBBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2RlcykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIHRhcmdldEVsZW1lbnQuYXBwZW5kQ2hpbGQoY2hpbGQuY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciB3aWR0aCA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3IoZWxlKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChodGFibGUpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGN0YWJsZSk7XG4gICAgICAgIGlmICgod2lkdGggPiBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoICYmICFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1lZGl0ZWRiYXRjaGNlbGwnKSkgfHxcbiAgICAgICAgICAgICh0aGlzLmVuYWJsZUFkYXB0aXZlVUkgJiYgdGhpcy5yb3dSZW5kZXJpbmdNb2RlID09PSAnVmVydGljYWwnICYmXG4gICAgICAgICAgICAgICAgd2lkdGggPiAoZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCAqIDAuNTUpIC0gKHRoaXMuaGVpZ2h0ICE9PSAnYXV0bycgPyAxNiA6IDApKSkge1xuICAgICAgICAgICAgLy8gMC41NSAtIGRlZmluZXMgdGhlIHdpZHRoIG9mIGFkYXB0aXZlIGNvbnRlbnQgY2VsbCwgMTYgLSBkZWZpbmVzIHRoZSBzY3JvbGxiYXIgd2lkdGhcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLm1vdXNlTW92ZUhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodGhpcy5pc0VsbGlwc2lzVG9vbHRpcCgpKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZWxsaXBzaXN0b29sdGlwJyk7XG4gICAgICAgICAgICBpZiAoZS50eXBlID09PSAnbW91c2VvdXQnICYmICh0aGlzLnByZXZFbGVtZW50ICE9PSBlbGVtZW50IHx8IGVsZW1lbnQgIT09IHBhcmVudHNVbnRpbChlLnJlbGF0ZWRUYXJnZXQsICdlLWVsbGlwc2lzdG9vbHRpcCcpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbFRpcE9iai5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJldkVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRhZ05hbWUgPSBlLnRhcmdldC50YWdOYW1lO1xuICAgICAgICAgICAgdmFyIGVsZW1OYW1lcyA9IFsnQScsICdCVVRUT04nLCAnSU5QVVQnXTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50ICYmIGUudHlwZSAhPT0gJ21vdXNlb3V0JyAmJiAhKEJyb3dzZXIuaXNEZXZpY2UgJiYgZWxlbU5hbWVzLmluZGV4T2YodGFnTmFtZSkgIT09IC0xKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldFRvb2x0aXBTdGF0dXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbCA9IHRoaXMuZ2V0Q29sdW1ucygpW3BhcnNlSW50KGVsZW1lbnQuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDFdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZG9tU2V0dGVyID0gY29sICYmIGNvbC5kaXNhYmxlSHRtbEVuY29kZSA/ICdpbm5lclRleHQnIDogJ2lubmVySFRNTCc7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50RGl2ID0gdGhpcy5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1oZWFkZXJ0ZXh0JykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5uZXJFbGVtZW50ID0gZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlLWhlYWRlcnRleHQnKVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnREaXZbXCJcIiArIGRvbVNldHRlcl0gPSB0aGlzLnNhbml0aXplKGlubmVyRWxlbWVudC5pbm5lclRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b29sVGlwT2JqLmNvbnRlbnQgPSBjb250ZW50RGl2O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudERpdltcIlwiICsgZG9tU2V0dGVyXSA9IHRoaXMuc2FuaXRpemUoZWxlbWVudC5pbm5lclRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b29sVGlwT2JqLmNvbnRlbnQgPSBjb250ZW50RGl2O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUh0bWxTYW5pdGl6ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9vbFRpcE9iai5lbmFibGVIdG1sU2FuaXRpemVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sICYmIGNvbC5kaXNhYmxlSHRtbEVuY29kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b29sVGlwT2JqLmVuYWJsZUh0bWxQYXJzZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50ICE9PSB0aGlzLnByZXZFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvb2xUaXBPYmpbJ29wZW4nXShlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZFbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmlzRWxsaXBzaXNUb29sdGlwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29scyA9IHRoaXMuZ2V0Q29sdW1ucygpO1xuICAgICAgICBpZiAodGhpcy5jbGlwTW9kZSA9PT0gJ0VsbGlwc2lzV2l0aFRvb2x0aXAnKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGlwTW9kZSA9PT0gJ0VsbGlwc2lzV2l0aFRvb2x0aXAnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuc2Nyb2xsSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNFbGxpcHNpc1Rvb2x0aXAoKSkge1xuICAgICAgICAgICAgdGhpcy50b29sVGlwT2JqLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRvIGNyZWF0ZSB0YWJsZSBmb3IgZWxsaXBzaXN3aXRodG9vbHRpcFxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSB0YWJsZSAtIERlZmluZXMgdGhlIHRhYmxlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRhZyAtIERlZmluZXMgdGhlIHRhZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gRGVmaW5lcyB0aGUgdHlwZVxuICAgICAqIEByZXR1cm5zIHtIVE1MRGl2RWxlbWVudH0gUmV0dXJucyB0aGUgSFRNTCBkaXYgRUxlbWVudFxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5jcmVhdGVUYWJsZSA9IGZ1bmN0aW9uICh0YWJsZSwgdGFnLCB0eXBlKSB7XG4gICAgICAgIHZhciBteVRhYmxlRGl2ID0gdGhpcy5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbXlUYWJsZURpdi5jbGFzc05hbWUgPSB0aGlzLmVsZW1lbnQuY2xhc3NOYW1lO1xuICAgICAgICBteVRhYmxlRGl2LnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogaW5saW5lLWJsb2NrO3Zpc2liaWxpdHk6aGlkZGVuO3Bvc2l0aW9uOmFic29sdXRlJztcbiAgICAgICAgdmFyIG15U3ViRGl2ID0gdGhpcy5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbXlTdWJEaXYuY2xhc3NOYW1lID0gdGFnO1xuICAgICAgICB2YXIgbXlUYWJsZSA9IHRoaXMuY3JlYXRlRWxlbWVudCgndGFibGUnKTtcbiAgICAgICAgbXlUYWJsZS5jbGFzc05hbWUgPSB0YWJsZS5jbGFzc05hbWU7XG4gICAgICAgIG15VGFibGUuc3R5bGUuY3NzVGV4dCA9ICd0YWJsZS1sYXlvdXQ6IGF1dG87d2lkdGg6IGF1dG8nO1xuICAgICAgICB2YXIgZWxlID0gKHR5cGUgPT09ICdoZWFkZXInKSA/ICd0aCcgOiAndGQnO1xuICAgICAgICB2YXIgbXlUciA9IHRoaXMuY3JlYXRlRWxlbWVudCgndHInLCB7IGF0dHJzOiB7IHJvbGU6ICdyb3cnIH0gfSk7XG4gICAgICAgIHZhciBteXRkID0gdGhpcy5jcmVhdGVFbGVtZW50KGVsZSk7XG4gICAgICAgIG15VHIuYXBwZW5kQ2hpbGQobXl0ZCk7XG4gICAgICAgIG15VGFibGUuYXBwZW5kQ2hpbGQobXlUcik7XG4gICAgICAgIG15U3ViRGl2LmFwcGVuZENoaWxkKG15VGFibGUpO1xuICAgICAgICBteVRhYmxlRGl2LmFwcGVuZENoaWxkKG15U3ViRGl2KTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChteVRhYmxlRGl2KTtcbiAgICAgICAgcmV0dXJuIG15VGFibGVEaXY7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5vbktleVByZXNzZWQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoZS5hY3Rpb24gPT09ICd0YWInIHx8IGUuYWN0aW9uID09PSAnc2hpZnRUYWInKSB7XG4gICAgICAgICAgICB0aGlzLnRvb2xUaXBPYmouY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQmluZGluZyBldmVudHMgdG8gdGhlIGVsZW1lbnQgd2hpbGUgY29tcG9uZW50IGNyZWF0aW9uLlxuICAgICAqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLndpcmVFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5lbGVtZW50LCAnY2xpY2snLCB0aGlzLm1vdXNlQ2xpY2tIYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmVsZW1lbnQsICd0b3VjaGVuZCcsIHRoaXMubW91c2VDbGlja0hhbmRsZXIsIHRoaXMpO1xuICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMuZWxlbWVudCwgJ2ZvY3Vzb3V0JywgdGhpcy5mb2N1c091dEhhbmRsZXIsIHRoaXMpO1xuICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMuZWxlbWVudCwgJ2RibGNsaWNrJywgdGhpcy5kYmxDbGlja0hhbmRsZXIsIHRoaXMpO1xuICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMuZWxlbWVudCwgJ2tleWRvd24nLCB0aGlzLmtleVByZXNzSGFuZGxlciwgdGhpcyk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQod2luZG93LCAncmVzaXplJywgdGhpcy5yZXNldEluZGVudFdpZHRoLCB0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuYWxsb3dLZXlib2FyZCkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRhYkluZGV4ID0gdGhpcy5lbGVtZW50LnRhYkluZGV4ID09PSAtMSA/IDAgOiB0aGlzLmVsZW1lbnQudGFiSW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXlib2FyZE1vZHVsZSA9IG5ldyBLZXlib2FyZEV2ZW50cyh0aGlzLmVsZW1lbnQsIHtcbiAgICAgICAgICAgIGtleUFjdGlvbjogdGhpcy5rZXlBY3Rpb25IYW5kbGVyLmJpbmQodGhpcyksXG4gICAgICAgICAgICBrZXlDb25maWdzOiB0aGlzLmtleUNvbmZpZ3MsXG4gICAgICAgICAgICBldmVudE5hbWU6ICdrZXlkb3duJ1xuICAgICAgICB9KTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmdldENvbnRlbnQoKS5maXJzdEVsZW1lbnRDaGlsZCwgJ3Njcm9sbCcsIHRoaXMuc2Nyb2xsSGFuZGxlciwgdGhpcyk7XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5lbGVtZW50LCAnbW91c2VvdmVyJywgdGhpcy5tb3VzZU1vdmVIYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmVsZW1lbnQsICdtb3VzZW91dCcsIHRoaXMubW91c2VNb3ZlSGFuZGxlciwgdGhpcyk7XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5nZXRDb250ZW50KCksICd0b3VjaHN0YXJ0JywgdGhpcy50YXBFdmVudCwgdGhpcyk7XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQoZG9jdW1lbnQuYm9keSwgJ2tleWRvd24nLCB0aGlzLmtleURvd25IYW5kbGVyLCB0aGlzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFVuYmluZGluZyBldmVudHMgZnJvbSB0aGUgZWxlbWVudCB3aGlsZSBjb21wb25lbnQgZGVzdHJveS5cbiAgICAgKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS51bndpcmVFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5lbGVtZW50LCAnY2xpY2snLCB0aGlzLm1vdXNlQ2xpY2tIYW5kbGVyKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmVsZW1lbnQsICd0b3VjaGVuZCcsIHRoaXMubW91c2VDbGlja0hhbmRsZXIpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZWxlbWVudCwgJ2ZvY3Vzb3V0JywgdGhpcy5mb2N1c091dEhhbmRsZXIpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZWxlbWVudCwgJ2RibGNsaWNrJywgdGhpcy5kYmxDbGlja0hhbmRsZXIpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZ2V0Q29udGVudCgpLmZpcnN0RWxlbWVudENoaWxkLCAnc2Nyb2xsJywgdGhpcy5zY3JvbGxIYW5kbGVyKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmVsZW1lbnQsICdtb3VzZW92ZXInLCB0aGlzLm1vdXNlTW92ZUhhbmRsZXIpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZWxlbWVudCwgJ21vdXNlb3V0JywgdGhpcy5tb3VzZU1vdmVIYW5kbGVyKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmVsZW1lbnQsICdrZXlkb3duJywgdGhpcy5rZXlQcmVzc0hhbmRsZXIpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZ2V0Q29udGVudCgpLCAndG91Y2hzdGFydCcsIHRoaXMudGFwRXZlbnQpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKGRvY3VtZW50LmJvZHksICdrZXlkb3duJywgdGhpcy5rZXlEb3duSGFuZGxlcik7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUod2luZG93LCAncmVzaXplJywgdGhpcy5yZXNldEluZGVudFdpZHRoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uKGV2ZW50cy5kYXRhUmVhZHksIHRoaXMuZGF0YVJlYWR5LCB0aGlzKTtcbiAgICAgICAgdGhpcy5vbihldmVudHMuY29udGVudFJlYWR5LCB0aGlzLnJlY2FsY0luZGVudFdpZHRoLCB0aGlzKTtcbiAgICAgICAgdGhpcy5vbihldmVudHMuaGVhZGVyUmVmcmVzaGVkLCB0aGlzLnJlY2FsY0luZGVudFdpZHRoLCB0aGlzKTtcbiAgICAgICAgdGhpcy5vbihldmVudHMucmVmcmVzaEZyb3plblBvc2l0aW9uLCB0aGlzLnJlZnJlc2hGcm96ZW5Qb3NpdGlvbiwgdGhpcyk7XG4gICAgICAgIHRoaXMub24oZXZlbnRzLnJlZnJlc2hTcGxpdEZyb3plbkNvbHVtbiwgdGhpcy5yZWZyZXNoU3BsaXRGcm96ZW5Db2x1bW4sIHRoaXMpO1xuICAgICAgICB0aGlzLmRhdGFCb3VuZEZ1bmN0aW9uID0gdGhpcy5yZWZyZXNoTWVkaWFDb2wuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKGV2ZW50cy5kYXRhQm91bmQsIHRoaXMuZGF0YUJvdW5kRnVuY3Rpb24pO1xuICAgICAgICB0aGlzLm9uKGV2ZW50cy5rZXlQcmVzc2VkLCB0aGlzLm9uS2V5UHJlc3NlZCwgdGhpcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vZmYoZXZlbnRzLmRhdGFSZWFkeSwgdGhpcy5kYXRhUmVhZHkpO1xuICAgICAgICB0aGlzLm9mZihldmVudHMuY29udGVudFJlYWR5LCB0aGlzLnJlY2FsY0luZGVudFdpZHRoKTtcbiAgICAgICAgdGhpcy5vZmYoZXZlbnRzLmhlYWRlclJlZnJlc2hlZCwgdGhpcy5yZWNhbGNJbmRlbnRXaWR0aCk7XG4gICAgICAgIHRoaXMub24oZXZlbnRzLnJlZnJlc2hGcm96ZW5Qb3NpdGlvbiwgdGhpcy5yZWZyZXNoRnJvemVuUG9zaXRpb24sIHRoaXMpO1xuICAgICAgICB0aGlzLm9uKGV2ZW50cy5yZWZyZXNoU3BsaXRGcm96ZW5Db2x1bW4sIHRoaXMucmVmcmVzaFNwbGl0RnJvemVuQ29sdW1uLCB0aGlzKTtcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50cy5kYXRhQm91bmQsIHRoaXMuZGF0YUJvdW5kRnVuY3Rpb24pO1xuICAgICAgICB0aGlzLm9mZihldmVudHMua2V5UHJlc3NlZCwgdGhpcy5vbktleVByZXNzZWQpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgdmlzaWJsZSBkYXRhIG9mIGdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0W119IFJldHVybnMgdGhlIGN1cnJlbnQgdmlldyByZWNvcmRzXG4gICAgICpcbiAgICAgKiBAaXNHZW5lcmljVHlwZSB0cnVlXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Q3VycmVudFZpZXdSZWNvcmRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoaXNHcm91cEFkYXB0aXZlKHRoaXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jdXJyZW50Vmlld0RhdGEucmVjb3JkcykgP1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFZpZXdEYXRhIDogdGhpcy5jdXJyZW50Vmlld0RhdGEucmVjb3JkcztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50Vmlld0RhdGE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICh0aGlzLmFsbG93R3JvdXBpbmcgJiYgdGhpcy5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICYmIHRoaXMuY3VycmVudFZpZXdEYXRhLmxlbmd0aFxuICAgICAgICAgICAgJiYgdGhpcy5jdXJyZW50Vmlld0RhdGEucmVjb3JkcykgPyB0aGlzLmN1cnJlbnRWaWV3RGF0YS5yZWNvcmRzXG4gICAgICAgICAgICA6IHRoaXMuY3VycmVudFZpZXdEYXRhO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUubW91c2VDbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodGhpcy5pc0NoaWxkR3JpZChlKSB8fCAocGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1ncmlkcG9wdXAnKSAmJiBlLnRvdWNoZXMpIHx8XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1jbG9uZXByb3BlcnRpZXMnKS5sZW5ndGggfHwgdGhpcy5jaGVja0VkaXQoZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKCghdGhpcy5hbGxvd1Jvd0RyYWdBbmREcm9wICYmIChwYXJlbnRzVW50aWwoZS50YXJnZXQsIGxpdGVyYWxzLmdyaWRDb250ZW50KSB8fFxuICAgICAgICAgICAgZS50YXJnZXQudGFnTmFtZSA9PT0gJ1REJykpIHx8IChwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLWhlYWRlcmNlbGwnKSAmJlxuICAgICAgICAgICAgcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1oZWFkZXJjZWxsJykucXVlcnlTZWxlY3RvcignLmUtY2hlY2tzZWxlY3RhbGwnKSkgfHxcbiAgICAgICAgICAgICghKHRoaXMuYWxsb3dHcm91cGluZyB8fCB0aGlzLmFsbG93UmVvcmRlcmluZykgJiYgcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1ncmlkaGVhZGVyJykpKSAmJlxuICAgICAgICAgICAgZS50b3VjaGVzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JpZGhlYWRlcicpICYmIHRoaXMuYWxsb3dSb3dEcmFnQW5kRHJvcCAmJlxuICAgICAgICAgICAgIShwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLWZpbHRlcmJhcmNlbGwnKSkgJiYgKGUudGFyZ2V0ICYmXG4gICAgICAgICAgICBbJ0EnLCAnQlVUVE9OJywgJ0lOUFVUJ10uaW5kZXhPZihlLnRhcmdldC50YWdOYW1lKSA9PT0gLTEpKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFyZ3MgPSB0aGlzLmdldFJvd0luZm8oZS50YXJnZXQpO1xuICAgICAgICB2YXIgY2FuY2VsID0gJ2NhbmNlbCc7XG4gICAgICAgIGFyZ3NbXCJcIiArIGNhbmNlbF0gPSBmYWxzZTtcbiAgICAgICAgdmFyIGlzRGF0YVJvdyA9IGZhbHNlO1xuICAgICAgICB2YXIgdHIgPSBjbG9zZXN0KGUudGFyZ2V0LCAndHInKTtcbiAgICAgICAgaWYgKHRyICYmIHRyLmdldEF0dHJpYnV0ZSgnZGF0YS11aWQnKSkge1xuICAgICAgICAgICAgdmFyIHJvd09iaiA9IHRoaXMuZ2V0Um93T2JqZWN0RnJvbVVJRCh0ci5nZXRBdHRyaWJ1dGUoJ2RhdGEtdWlkJykpO1xuICAgICAgICAgICAgaXNEYXRhUm93ID0gcm93T2JqID8gcm93T2JqLmlzRGF0YVJvdyA6IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0RhdGFSb3cpIHtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcihldmVudHMucmVjb3JkQ2xpY2ssIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5jbGljaywgZSk7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5jaGVja0VkaXQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgdHIgPSBwYXJlbnRzVW50aWwoZS50YXJnZXQsIGxpdGVyYWxzLnJvdyk7XG4gICAgICAgIHZhciBpc0VkaXQgPSB0aGlzLmVkaXRTZXR0aW5ncy5tb2RlICE9PSAnQmF0Y2gnICYmXG4gICAgICAgICAgICB0aGlzLmlzRWRpdCAmJiB0ciAmJiAodHIuY2xhc3NMaXN0LmNvbnRhaW5zKGxpdGVyYWxzLmVkaXRlZFJvdykgfHwgKHRyLmNsYXNzTGlzdC5jb250YWlucyhsaXRlcmFscy5hZGRlZFJvdykpICYmXG4gICAgICAgICAgICAhdGhpcy5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1Jvdyk7XG4gICAgICAgIHJldHVybiAhcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS11bmJvdW5kY2VsbGRpdicpICYmIChpc0VkaXQgfHwgKHBhcmVudHNVbnRpbChlLnRhcmdldCwgbGl0ZXJhbHMucm93Q2VsbCkgJiZcbiAgICAgICAgICAgIHBhcmVudHNVbnRpbChlLnRhcmdldCwgbGl0ZXJhbHMucm93Q2VsbCkuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWVkaXRlZGJhdGNoY2VsbCcpKSk7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5kYmxDbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgZ3JpZCA9IHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JpZCcpO1xuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoZ3JpZCkgfHwgZ3JpZC5pZCAhPT0gdGhpcy5lbGVtZW50LmlkIHx8IGNsb3Nlc3QoZS50YXJnZXQsICcuZS11bmJvdW5kY2VsbGRpdicpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRhdGFSb3cgPSBmYWxzZTtcbiAgICAgICAgdmFyIHRyID0gY2xvc2VzdChlLnRhcmdldCwgJ3RyJyk7XG4gICAgICAgIGlmICh0ciAmJiB0ci5nZXRBdHRyaWJ1dGUoJ2RhdGEtdWlkJykpIHtcbiAgICAgICAgICAgIHZhciByb3dPYmogPSB0aGlzLmdldFJvd09iamVjdEZyb21VSUQodHIuZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpKTtcbiAgICAgICAgICAgIGRhdGFSb3cgPSByb3dPYmogPyByb3dPYmouaXNEYXRhUm93IDogZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFyZ3MgPSB0aGlzLmdldFJvd0luZm8oZS50YXJnZXQpO1xuICAgICAgICBhcmdzLnRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICBpZiAoZGF0YVJvdykge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKGV2ZW50cy5yZWNvcmREb3VibGVDbGljaywgYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLmRibGNsaWNrLCBlKTtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmZvY3VzT3V0SGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0aGlzLmlzQ2hpbGRHcmlkKGUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLWdyaWQnKSkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWdyaWRwb3B1cCcpLnN0eWxlLmRpc3BsYXkgPSAnTm9uZSc7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbHRlckNsZWFyID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWNhbmNlbDpub3QoLmUtaGlkZSknKTtcbiAgICAgICAgaWYgKGZpbHRlckNsZWFyICYmICFmaWx0ZXJDbGVhci5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS10YmFyLWJ0bicpKSB7XG4gICAgICAgICAgICBmaWx0ZXJDbGVhci5jbGFzc0xpc3QuYWRkKCdlLWhpZGUnKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVsYXRlZFRhcmdldCA9IGUucmVsYXRlZFRhcmdldDtcbiAgICAgICAgdmFyIGFyaWFPd25zID0gcmVsYXRlZFRhcmdldCA/IHJlbGF0ZWRUYXJnZXQuZ2V0QXR0cmlidXRlKCdhcmlhLW93bnMnKSA6IG51bGw7XG4gICAgICAgIGlmICgoIXJlbGF0ZWRUYXJnZXQgfHwgKCFwYXJlbnRzVW50aWwocmVsYXRlZFRhcmdldCwgJ2UtZ3JpZCcpICYmXG4gICAgICAgICAgICAoIWlzTnVsbE9yVW5kZWZpbmVkKGFyaWFPd25zKSAmJlxuICAgICAgICAgICAgICAgIChhcmlhT3ducykpICE9PSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2FyaWEtb3ducycpKSlcbiAgICAgICAgICAgICYmICF0aGlzLmtleVByZXNzICYmIHRoaXMuaXNFZGl0ICYmICFCcm93c2VyLmlzRGV2aWNlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ0JhdGNoJyAmJiAhKCgocGFyZW50c1VudGlsKHJlbGF0ZWRUYXJnZXQsICdlLWRkbCcpIHx8IHBhcmVudHNVbnRpbChyZWxhdGVkVGFyZ2V0LCAnZS1kZHQnKSkgJiZcbiAgICAgICAgICAgICAgICAocGFyZW50c1VudGlsKHJlbGF0ZWRUYXJnZXQsICdlLW11bHRpLXNlbGVjdC1saXN0LXdyYXBwZXInKSB8fCBwYXJlbnRzVW50aWwocmVsYXRlZFRhcmdldCwgJ2UtaW5wdXQtZmlsdGVyJykpKSAmJlxuICAgICAgICAgICAgICAgIHBhcmVudHNVbnRpbChyZWxhdGVkVGFyZ2V0LCAnZS1pbnB1dC1ncm91cCcpKSAmJiAocGFyZW50c1VudGlsKHJlbGF0ZWRUYXJnZXQsICdlLXVwbG9hZGVyJykgfHwgKCEocmVsYXRlZFRhcmdldCAmJlxuICAgICAgICAgICAgICAgIGlzTnVsbE9yVW5kZWZpbmVkKHBhcmVudHNVbnRpbChyZWxhdGVkVGFyZ2V0LCAnZS1pbnB1dC1ncm91cCcpKSkgJiYgIXBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2VkaXQtY3VzdG9tLXRlbXBsYXRlJykpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZWRpdE1vZHVsZS5zYXZlQ2VsbCgpO1xuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5lZGl0TmV4dFZhbENlbGwsIHt9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmVkaXRTZXR0aW5ncy5tb2RlID09PSAnTm9ybWFsJyAmJiAhdGhpcy5pc1dpZGdldHNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRNb2R1bGUuZWRpdEZvcm1WYWxpZGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93KSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRNb2R1bGUuaXNTaG93QWRkZWRSb3dWYWxpZGF0ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMua2V5UHJlc3MgPSBmYWxzZTtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmlzQ2hpbGRHcmlkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIGdyaWRFbGVtZW50ID0gcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1ncmlkJyk7XG4gICAgICAgIGlmICgoZ3JpZEVsZW1lbnQgJiYgZ3JpZEVsZW1lbnQuaWQgIT09IHRoaXMuZWxlbWVudC5pZCkgfHwgKHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtdW5ib3VuZGNlbGxkaXYnKSAmJlxuICAgICAgICAgICAgaXNOdWxsT3JVbmRlZmluZWQoZ3JpZEVsZW1lbnQpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHBlcnNpc3RlZERhdGEgLSBEZWZpbmVzIHRoZSBwZXJzaXN0ZWQgZGF0YVxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5tZXJnZVBlcnNpc3RHcmlkRGF0YSA9IGZ1bmN0aW9uIChwZXJzaXN0ZWREYXRhKSB7XG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5nZXRMb2NhbERhdGEoKTtcbiAgICAgICAgaWYgKCEoaXNOdWxsT3JVbmRlZmluZWQoZGF0YSkgfHwgKGRhdGEgPT09ICcnKSkgfHwgIWlzTnVsbE9yVW5kZWZpbmVkKHBlcnNpc3RlZERhdGEpKSB7XG4gICAgICAgICAgICB2YXIgZGF0YU9iaiA9ICFpc051bGxPclVuZGVmaW5lZChwZXJzaXN0ZWREYXRhKSA/IHBlcnNpc3RlZERhdGEgOiBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkYXRhT2JqKTtcbiAgICAgICAgICAgIHRoaXMuaXNQcm90ZWN0ZWRPbkNoYW5nZSA9IHRydWU7XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGtleXNfMSA9IGtleXM7IF9pIDwga2V5c18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzXzFbX2ldO1xuICAgICAgICAgICAgICAgIGlmICgodHlwZW9mIHRoaXNbXCJcIiArIGtleV0gPT09ICdvYmplY3QnKSAmJiAhaXNOdWxsT3JVbmRlZmluZWQodGhpc1tcIlwiICsga2V5XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpc1tcIlwiICsga2V5XSkgJiYga2V5ID09PSAnY29sdW1ucycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0RnJvemVuQ291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldENvbHVtbkluZGV4KHRoaXNbXCJcIiArIGtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXJnZUNvbHVtbnMoZGF0YU9ialtcIlwiICsga2V5XSwgdGhpc1tcIlwiICsga2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lcmdlZENvbHVtbnMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tcIlwiICsga2V5XSA9IGRhdGFPYmpbXCJcIiArIGtleV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlbmQodGhpc1tcIlwiICsga2V5XSwgZGF0YU9ialtcIlwiICsga2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNbXCJcIiArIGtleV0gPSBkYXRhT2JqW1wiXCIgKyBrZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaXNQcm90ZWN0ZWRPbkNoYW5nZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5tZXJnZUNvbHVtbnMgPSBmdW5jdGlvbiAoc3RvcmVkQ29sdW1uLCBjb2x1bW5zKSB7XG4gICAgICAgIHZhciBzdG9yZWRDb2x1bW5zID0gc3RvcmVkQ29sdW1uO1xuICAgICAgICB2YXIgaXNGcm96ZW5HcmlkID0gdGhpcy5pc0Zyb3plbkdyaWQoKTtcbiAgICAgICAgdmFyIF9sb29wXzQgPSBmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgdmFyIGxvY2FsQ29sID0gY29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKHRDb2wpIHsgcmV0dXJuIGlzRnJvemVuR3JpZCA/XG4gICAgICAgICAgICAgICAgdENvbC5pbmRleCA9PT0gc3RvcmVkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIGxpdGVyYWxzLmluaXRpYWxGcm96ZW5Db2x1bW5JbmRleF0gOlxuICAgICAgICAgICAgICAgIHRDb2wuaW5kZXggPT09IHN0b3JlZENvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmluZGV4OyB9KVswXTtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQobG9jYWxDb2wpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRnJvemVuR3JpZCkge1xuICAgICAgICAgICAgICAgICAgICBsb2NhbENvbCA9IGV4dGVuZCh7fSwgbG9jYWxDb2wsIHt9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxDb2wuZnJlZXplID0gc3RvcmVkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobG9jYWxDb2wuY29sdW1ucyAmJiBsb2NhbENvbC5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzXzQubWVyZ2VDb2x1bW5zKHN0b3JlZENvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMsIGxvY2FsQ29sLmNvbHVtbnMpO1xuICAgICAgICAgICAgICAgICAgICBzdG9yZWRDb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IGV4dGVuZChsb2NhbENvbCwgc3RvcmVkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHt9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3JlZENvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID0gZXh0ZW5kKGxvY2FsQ29sLCBzdG9yZWRDb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwge30sIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRoaXNfNCA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RvcmVkQ29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgX2xvb3BfNChpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRoZSBpc0RldGFpbFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmlzRGV0YWlsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZGV0YWlsVGVtcGxhdGUpIHx8ICFpc051bGxPclVuZGVmaW5lZCh0aGlzLmNoaWxkR3JpZCk7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5pc0NvbW1hbmRDb2x1bW4gPSBmdW5jdGlvbiAoY29sdW1ucykge1xuICAgICAgICB2YXIgX3RoaXNfMSA9IHRoaXM7XG4gICAgICAgIHJldHVybiBjb2x1bW5zLnNvbWUoZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgaWYgKGNvbC5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzXzEuaXNDb21tYW5kQ29sdW1uKGNvbC5jb2x1bW5zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhIShjb2wuY29tbWFuZHMgfHwgY29sLmNvbW1hbmRzVGVtcGxhdGUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmlzRm9yZWlnbktleUVuYWJsZWQgPSBmdW5jdGlvbiAoY29sdW1ucykge1xuICAgICAgICB2YXIgX3RoaXNfMSA9IHRoaXM7XG4gICAgICAgIHJldHVybiBjb2x1bW5zLnNvbWUoZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgaWYgKGNvbC5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzXzEuaXNGb3JlaWduS2V5RW5hYmxlZChjb2wuY29sdW1ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gISEoY29sLmRhdGFTb3VyY2UgJiYgY29sLmZvcmVpZ25LZXlWYWx1ZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUua2V5UHJlc3NIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHByZXNza2V5ID0gZXh0ZW5kKGUsIHsgY2FuY2VsOiBmYWxzZSB9KTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdrZXlQcmVzc2VkJywgcHJlc3NrZXkpO1xuICAgICAgICBpZiAocHJlc3NrZXkuY2FuY2VsID09PSB0cnVlIHx8ICh0aGlzLmlzRWRpdCAmJiBlICYmIHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JpZGZvcm0nKSAmJlxuICAgICAgICAgICAgcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1kZGwnKSAmJiBlLmFjdGlvbiA9PT0gJ29wZW4nICYmIGUuYWx0S2V5ID09PSB0cnVlICYmIGUuY29kZSA9PT0gJ0Fycm93RG93bicpKSB7XG4gICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5rZXlEb3duSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChlLmFsdEtleSkge1xuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gNzQpIHsgLy9hbHQgalxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmtleUEpIHsgLy9hbHQgQSBKXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5ncm91cENvbGxhcHNlLCB7IHRhcmdldDogZS50YXJnZXQsIGNvbGxhcHNlOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5rZXlBID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mb2N1c01vZHVsZSAmJiB0aGlzLmZvY3VzTW9kdWxlLmN1cnJlbnRJbmZvICYmIHRoaXMuZm9jdXNNb2R1bGUuY3VycmVudEluZm8uZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoW3RoaXMuZm9jdXNNb2R1bGUuY3VycmVudEluZm8uZWxlbWVudCwgdGhpcy5mb2N1c01vZHVsZS5jdXJyZW50SW5mby5lbGVtZW50VG9Gb2N1c10sIFsnZS1mb2N1c2VkJywgJ2UtZm9jdXMnXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzTW9kdWxlLmN1cnJlbnRJbmZvLmVsZW1lbnQudGFiSW5kZXggPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY2hpbGRncmlkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gODcpIHsgLy9hbHQgd1xuICAgICAgICAgICAgICAgIHZhciBmb2N1c01vZHVsZSA9IHRoaXMuZm9jdXNNb2R1bGU7XG4gICAgICAgICAgICAgICAgaWYgKGZvY3VzTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jdXJyZW50Vmlld0RhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9jdXNNb2R1bGUuZm9jdXNDb250ZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzTW9kdWxlLmFkZE91dGxpbmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSA2NSkgeyAvL2FsdCBBXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlBID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDcyICYmIHRoaXMua2V5QSkgeyAvL2FsdCBBIEhcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuZ3JvdXBDb2xsYXBzZSwgeyB0YXJnZXQ6IGUudGFyZ2V0LCBjb2xsYXBzZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmtleUEgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAxMykge1xuICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLmVudGVyS2V5SGFuZGxlciwgZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmtleUFjdGlvbkhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodGhpcy5pc0NoaWxkR3JpZChlKSB8fFxuICAgICAgICAgICAgKHRoaXMuZWRpdE1vZHVsZSAmJiAoKHRoaXMuZWRpdE1vZHVsZS5hbGVydERPYmogJiYgdGhpcy5lZGl0TW9kdWxlLmFsZXJ0RE9iai52aXNpYmxlKSB8fFxuICAgICAgICAgICAgICAgICh0aGlzLmVkaXRNb2R1bGUuZGlhbG9nT2JqICYmIHRoaXMuZWRpdE1vZHVsZS5kaWFsb2dPYmoudmlzaWJsZSkpKSB8fFxuICAgICAgICAgICAgKCh0aGlzLmlzRWRpdCAmJiAoIXRoaXMuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cgfHwgKHRoaXMuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihsaXRlcmFscy5lZGl0ZWRSb3cpKSkpICYmIGUuYWN0aW9uICE9PSAnZXNjYXBlJyAmJiBlLmFjdGlvbiAhPT0gJ2VudGVyJ1xuICAgICAgICAgICAgICAgICYmIGUuYWN0aW9uICE9PSAnc2hpZnRFbnRlcicgJiYgZS5hY3Rpb24gIT09ICd0YWInICYmIGUuYWN0aW9uICE9PSAnc2hpZnRUYWInKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5rZXlQcmVzcyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWxsb3dLZXlib2FyZCkge1xuICAgICAgICAgICAgaWYgKGUuYWN0aW9uID09PSAnY3RybFBsdXNQJykge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMua2V5UHJlc3NlZCwgZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb25bXX0gbW9kdWxlcyAtIERlZmluZXMgdGhlIG1vZHVsZXNcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2V0SW5qZWN0ZWRNb2R1bGVzID0gZnVuY3Rpb24gKG1vZHVsZXMpIHtcbiAgICAgICAgdGhpcy5pbmplY3RlZE1vZHVsZXMgPSBtb2R1bGVzO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUudXBkYXRlQ29sdW1uT2JqZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBwcmVwYXJlQ29sdW1ucyh0aGlzLmNvbHVtbnMsIHRoaXMuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24sIHRoaXMpO1xuICAgICAgICBzZXRDb2x1bW5JbmRleCh0aGlzLmNvbHVtbnMpO1xuICAgICAgICB0aGlzLmluaXRGb3JlaWduQ29sdW1uKCk7XG4gICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5hdXRvQ29sLCB7fSk7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5yZWZyZXNoRnJvemVuUG9zaXRpb24gPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIGlmIChvYmogJiYgb2JqLmlzTW9kZUNoZykge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoQ29sdW1ucygpO1xuICAgICAgICAgICAgdGhpcy5ub3RpZnkoZXZlbnRzLnJlZnJlc2hSZXNpemVQb3NpdGlvbiwge30pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoQ29sdW1ucygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBmb3JlaWduIGNvbHVtbnMgZnJvbSBHcmlkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0NvbHVtbltdfSBSZXR1cm5zIEZvcmVpZ24ga2V5IGNvbHVtblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZvcmVpZ25LZXlDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2x1bW5zKCkuZmlsdGVyKGZ1bmN0aW9uIChjb2wpIHtcbiAgICAgICAgICAgIHJldHVybiBjb2wuaXNGb3JlaWduQ29sdW1uKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gYWNjdXJhdGVIZWlnaHQgLSBEZWZpbmVzIHRoZSBhY2N1cmF0ZSByb3cgaGVpZ2h0XG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyByb3cgaGVpZ2h0XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Um93SGVpZ2h0ID0gZnVuY3Rpb24gKGFjY3VyYXRlSGVpZ2h0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvd0hlaWdodCA/IHRoaXMucm93SGVpZ2h0IDogZ2V0Um93SGVpZ2h0KHRoaXMuZWxlbWVudCwgYWNjdXJhdGVIZWlnaHQpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVmcmVzaGVzIHRoZSBHcmlkIGNvbHVtbiBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUucmVmcmVzaENvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZnJlZXplQ29sdW1uUmVmcmVzaCA9IHRydWU7XG4gICAgICAgIHRoaXMuc2V0RnJvemVuQ291bnQoKTtcbiAgICAgICAgdGhpcy51cGRhdGVGcm96ZW5Db2x1bW5zV2lkdGgoKTtcbiAgICAgICAgaWYgKHRoaXMuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgIHRoaXMuaXNQcmV2ZW50U2Nyb2xsRXZlbnQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlQ29sdW1uT2JqZWN0KCk7XG4gICAgICAgIHRoaXMuY2hlY2tMb2NrQ29sdW1ucyh0aGlzLmdldENvbHVtbnMoKSk7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICBpZiAodGhpcy5pc0Zyb3plbkdyaWQoKSAmJiB0aGlzLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICB2YXIgbGVmdCA9IHRoaXMuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy5lLW1vdmFibGVzY3JvbGxiYXInKS5zY3JvbGxMZWZ0O1xuICAgICAgICAgICAgdGhpcy5nZXRIZWFkZXJDb250ZW50KCkucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5oZWFkZXJDb250ZW50KS5zY3JvbGxMZWZ0ID0gbGVmdDtcbiAgICAgICAgICAgIHRoaXMuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuY29udGVudCkuc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEV4cG9ydCBHcmlkIGRhdGEgdG8gRXhjZWwgZmlsZSgueGxzeCkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtFeGNlbEV4cG9ydFByb3BlcnRpZXN9IGV4Y2VsRXhwb3J0UHJvcGVydGllcyAtIERlZmluZXMgdGhlIGV4cG9ydCBwcm9wZXJ0aWVzIG9mIHRoZSBHcmlkLlxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IGlzTXVsdGlwbGVFeHBvcnQgLSBEZWZpbmUgdG8gZW5hYmxlIG11bHRpcGxlIGV4cG9ydC5cbiAgICAgKiBAcGFyYW0gIHtXb3JrYm9va30gd29ya2Jvb2sgLSBEZWZpbmVzIHRoZSBXb3JrYm9vayBpZiBtdWx0aXBsZSBleHBvcnQgaXMgZW5hYmxlZC5cbiAgICAgKiBAcGFyYW0gIHtib29sZWFufSBpc0Jsb2IgLSBJZiAnaXNCbG9iJyBzZXQgdG8gdHJ1ZSwgdGhlbiBpdCB3aWxsIGJlIHJldHVybmVkIGFzIGJsb2IgZGF0YS5cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fSBSZXR1cm5zIHRoZSBleGNlbGV4cG9ydFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmV4Y2VsRXhwb3J0ID0gZnVuY3Rpb24gKGV4Y2VsRXhwb3J0UHJvcGVydGllcywgaXNNdWx0aXBsZUV4cG9ydCwgXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICB3b3JrYm9vaywgaXNCbG9iKSB7XG4gICAgICAgIGlmICh0aGlzLmV4cG9ydEdyaWRzICYmIHRoaXMuZXhwb3J0R3JpZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgZ3JpZElkcyA9IHRoaXMuZXhwb3J0R3JpZHMuc2xpY2UoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmV4cG9ydE11bHRpcGxlRXhjZWxHcmlkcyhncmlkSWRzLCBleGNlbEV4cG9ydFByb3BlcnRpZXMsIGlzTXVsdGlwbGVFeHBvcnQsIHdvcmtib29rLCBpc0Jsb2IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXhjZWxFeHBvcnRNb2R1bGUgP1xuICAgICAgICAgICAgICAgIHRoaXMuZXhjZWxFeHBvcnRNb2R1bGUuTWFwKHRoaXMsIGV4Y2VsRXhwb3J0UHJvcGVydGllcywgaXNNdWx0aXBsZUV4cG9ydCwgd29ya2Jvb2ssIGZhbHNlLCBpc0Jsb2IpIDogbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRXhwb3J0IEdyaWQgZGF0YSB0byBDU1YgZmlsZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0V4Y2VsRXhwb3J0UHJvcGVydGllc30gZXhjZWxFeHBvcnRQcm9wZXJ0aWVzIC0gRGVmaW5lcyB0aGUgZXhwb3J0IHByb3BlcnRpZXMgb2YgdGhlIEdyaWQuXG4gICAgICogQHBhcmFtICB7Ym9vbGVhbn0gaXNNdWx0aXBsZUV4cG9ydCAtIERlZmluZSB0byBlbmFibGUgbXVsdGlwbGUgZXhwb3J0LlxuICAgICAqIEBwYXJhbSAge1dvcmtib29rfSB3b3JrYm9vayAtIERlZmluZXMgdGhlIFdvcmtib29rIGlmIG11bHRpcGxlIGV4cG9ydCBpcyBlbmFibGVkLlxuICAgICAqIEBwYXJhbSAge2Jvb2xlYW59IGlzQmxvYiAtIElmICdpc0Jsb2InIHNldCB0byB0cnVlLCB0aGVuIGl0IHdpbGwgYmUgcmV0dXJuZWQgYXMgYmxvYiBkYXRhLlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59IFJldHVybnMgY3N2IGV4cG9ydFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmNzdkV4cG9ydCA9IGZ1bmN0aW9uIChleGNlbEV4cG9ydFByb3BlcnRpZXMsIFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgaXNNdWx0aXBsZUV4cG9ydCwgd29ya2Jvb2ssIGlzQmxvYikge1xuICAgICAgICByZXR1cm4gdGhpcy5leGNlbEV4cG9ydE1vZHVsZSA/XG4gICAgICAgICAgICB0aGlzLmV4Y2VsRXhwb3J0TW9kdWxlLk1hcCh0aGlzLCBleGNlbEV4cG9ydFByb3BlcnRpZXMsIGlzTXVsdGlwbGVFeHBvcnQsIHdvcmtib29rLCB0cnVlLCBpc0Jsb2IpIDogbnVsbDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEV4cG9ydCBHcmlkIGRhdGEgdG8gUERGIGRvY3VtZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtwZGZFeHBvcnRQcm9wZXJ0aWVzfSBwZGZFeHBvcnRQcm9wZXJ0aWVzIC0gRGVmaW5lcyB0aGUgZXhwb3J0IHByb3BlcnRpZXMgb2YgdGhlIEdyaWQuXG4gICAgICogQHBhcmFtIHtpc011bHRpcGxlRXhwb3J0fSBpc011bHRpcGxlRXhwb3J0IC0gRGVmaW5lIHRvIGVuYWJsZSBtdWx0aXBsZSBleHBvcnQuXG4gICAgICogQHBhcmFtIHtwZGZEb2N9IHBkZkRvYyAtIERlZmluZWQgdGhlIFBkZiBEb2N1bWVudCBpZiBtdWx0aXBsZSBleHBvcnQgaXMgZW5hYmxlZC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzQmxvYiAtIElmICdpc0Jsb2InIHNldCB0byB0cnVlLCB0aGVuIGl0IHdpbGwgYmUgcmV0dXJuZWQgYXMgYmxvYiBkYXRhLlxuICAgICAqXG4gICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0gUmV0dXJucyBwZGZleHBvcnRcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5wZGZFeHBvcnQgPSBmdW5jdGlvbiAocGRmRXhwb3J0UHJvcGVydGllcywgaXNNdWx0aXBsZUV4cG9ydCwgcGRmRG9jLCBpc0Jsb2IpIHtcbiAgICAgICAgaWYgKHRoaXMuZXhwb3J0R3JpZHMgJiYgdGhpcy5leHBvcnRHcmlkcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBncmlkSWRzID0gdGhpcy5leHBvcnRHcmlkcy5zbGljZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXhwb3J0TXVsdGlwbGVQZGZHcmlkcyhncmlkSWRzLCBwZGZFeHBvcnRQcm9wZXJ0aWVzLCBpc011bHRpcGxlRXhwb3J0LCBwZGZEb2MsIGlzQmxvYik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wZGZFeHBvcnRNb2R1bGUgPyB0aGlzLnBkZkV4cG9ydE1vZHVsZS5NYXAodGhpcywgcGRmRXhwb3J0UHJvcGVydGllcywgaXNNdWx0aXBsZUV4cG9ydCwgcGRmRG9jLCBpc0Jsb2IpIDogbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZXhwb3J0TXVsdGlwbGVQZGZHcmlkcyA9IGZ1bmN0aW9uIChncmlkSWRzLCBwZGZFeHBvcnRQcm9wZXJ0aWVzLCBpc011bHRpcGxlRXhwb3J0LCBcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIHBkZkRvYywgaXNCbG9iKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhc1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoZ3JpZElkcy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50R3JpZElkID0gZ3JpZElkcy5zaGlmdCgpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIHZhciBjdXJyZW50R3JpZEluc3RhbmNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY3VycmVudEdyaWRJZCkuZWoyX2luc3RhbmNlc1swXTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB2YXIgZXhwb3J0UHJvbWlzZSA9IGN1cnJlbnRHcmlkSW5zdGFuY2UucGRmRXhwb3J0TW9kdWxlID9cbiAgICAgICAgICAgICAgICBjdXJyZW50R3JpZEluc3RhbmNlLnBkZkV4cG9ydE1vZHVsZS5NYXAoY3VycmVudEdyaWRJbnN0YW5jZSwgcGRmRXhwb3J0UHJvcGVydGllcywgaXNNdWx0aXBsZUV4cG9ydCwgcGRmRG9jLCBpc0Jsb2IpXG4gICAgICAgICAgICAgICAgOiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0UHJvbWlzZS50aGVuKGZ1bmN0aW9uIChleHBvcnRlZEdyaWRSZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgaXNNdWx0aXBsZUV4cG9ydCA9IGdyaWRJZHMubGVuZ3RoID09PSAxID8gZmFsc2UgOiB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5leHBvcnRNdWx0aXBsZVBkZkdyaWRzKGdyaWRJZHMsIHBkZkV4cG9ydFByb3BlcnRpZXMsIGlzTXVsdGlwbGVFeHBvcnQsIGV4cG9ydGVkR3JpZFJlc3VsdHMsIGlzQmxvYik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmV4cG9ydE11bHRpcGxlRXhjZWxHcmlkcyA9IGZ1bmN0aW9uIChncmlkSWRzLCBleGNlbEV4cG9ydFByb3BlcnRpZXMsIGlzTXVsdGlwbGVFeHBvcnQsIFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgd29ya2Jvb2ssIGlzQmxvYikge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXNcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKGdyaWRJZHMubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudEdyaWRJZCA9IGdyaWRJZHMuc2hpZnQoKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB2YXIgY3VycmVudEdyaWRJbnN0YW5jZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGN1cnJlbnRHcmlkSWQpLmVqMl9pbnN0YW5jZXNbMF07XG4gICAgICAgICAgICB2YXIgZXhwb3J0UHJvbWlzZSA9IGN1cnJlbnRHcmlkSW5zdGFuY2UuZXhjZWxFeHBvcnRNb2R1bGUgP1xuICAgICAgICAgICAgICAgIGN1cnJlbnRHcmlkSW5zdGFuY2UuZXhjZWxFeHBvcnRNb2R1bGUuTWFwKGN1cnJlbnRHcmlkSW5zdGFuY2UsIGV4Y2VsRXhwb3J0UHJvcGVydGllcywgaXNNdWx0aXBsZUV4cG9ydCwgd29ya2Jvb2ssIGZhbHNlLCBpc0Jsb2IpIDogbnVsbDtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0UHJvbWlzZS50aGVuKGZ1bmN0aW9uIChleHBvcnRlZEdyaWRSZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgaXNNdWx0aXBsZUV4cG9ydCA9IGdyaWRJZHMubGVuZ3RoID09PSAxID8gZmFsc2UgOiB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5leHBvcnRNdWx0aXBsZUV4Y2VsR3JpZHMoZ3JpZElkcywgZXhjZWxFeHBvcnRQcm9wZXJ0aWVzLCBpc011bHRpcGxlRXhwb3J0LCBleHBvcnRlZEdyaWRSZXN1bHRzLCBpc0Jsb2IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHcm91cHMgYSBjb2x1bW4gYnkgY29sdW1uIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGNvbHVtbk5hbWUgLSBEZWZpbmVzIHRoZSBjb2x1bW4gbmFtZSB0byBncm91cC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdyb3VwQ29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbk5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZ3JvdXBNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuZ3JvdXBNb2R1bGUuZ3JvdXBDb2x1bW4oY29sdW1uTmFtZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEV4cGFuZHMgYWxsIHRoZSBncm91cGVkIHJvd3Mgb2YgdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5ncm91cEV4cGFuZEFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuZ3JvdXBNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuZ3JvdXBNb2R1bGUuZXhwYW5kQWxsKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENvbGxhcHNlcyBhbGwgdGhlIGdyb3VwZWQgcm93cyBvZiB0aGUgR3JpZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdyb3VwQ29sbGFwc2VBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmdyb3VwTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmdyb3VwTW9kdWxlLmNvbGxhcHNlQWxsKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEV4cGFuZHMgb3IgY29sbGFwc2VzIGdyb3VwZWQgcm93cyBieSB0YXJnZXQgZWxlbWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0VsZW1lbnR9IHRhcmdldCAtIERlZmluZXMgdGhlIHRhcmdldCBlbGVtZW50IG9mIHRoZSBncm91cGVkIHJvdy5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICAvLyBwdWJsaWMgZXhwYW5kQ29sbGFwc2VSb3dzKHRhcmdldDogRWxlbWVudCk6IHZvaWQge1xuICAgIC8vICAgICBpZiAodGhpcy5ncm91cE1vZHVsZSkge1xuICAgIC8vICAgICAgICAgdGhpcy5ncm91cE1vZHVsZS5leHBhbmRDb2xsYXBzZVJvd3ModGFyZ2V0KTtcbiAgICAvLyAgICAgfVxuICAgIC8vIH1cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgYWxsIHRoZSBncm91cGVkIGNvbHVtbnMgb2YgdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5jbGVhckdyb3VwaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5ncm91cE1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5ncm91cE1vZHVsZS5jbGVhckdyb3VwaW5nKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFVuZ3JvdXBzIGEgY29sdW1uIGJ5IGNvbHVtbiBuYW1lLlxuICAgICAqXG4gICAgICogeyUgY29kZUJsb2NrIHNyYz0nZ3JpZC91bmdyb3VwQ29sdW1uL2luZGV4Lm1kJyAlfXslIGVuZGNvZGVCbG9jayAlfVxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBjb2x1bW5OYW1lIC0gRGVmaW5lcyB0aGUgY29sdW1uIG5hbWUgdG8gdW5ncm91cC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnVuZ3JvdXBDb2x1bW4gPSBmdW5jdGlvbiAoY29sdW1uTmFtZSkge1xuICAgICAgICBpZiAodGhpcy5ncm91cE1vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5ncm91cE1vZHVsZS51bmdyb3VwQ29sdW1uKGNvbHVtbk5hbWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDb2x1bW4gY2hvb3NlciBjYW4gYmUgZGlzcGxheWVkIG9uIHNjcmVlbiBieSBnaXZlbiBwb3NpdGlvbihYIGFuZCBZIGF4aXMpLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHggLSBEZWZpbmVzIHRoZSBYIGF4aXMuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHkgLSBEZWZpbmVzIHRoZSBZIGF4aXMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5vcGVuQ29sdW1uQ2hvb3NlciA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgIGlmICh0aGlzLmNvbHVtbkNob29zZXJNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuY29sdW1uQ2hvb3Nlck1vZHVsZS5vcGVuQ29sdW1uQ2hvb3Nlcih4LCB5KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuc2Nyb2xsUmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzXzEgPSB0aGlzO1xuICAgICAgICB2YXIgcmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzXzEuc2Nyb2xsTW9kdWxlLnJlZnJlc2goKTtcbiAgICAgICAgICAgIF90aGlzXzEub2ZmKGV2ZW50cy5jb250ZW50UmVhZHksIHJlZnJlc2gpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uKGV2ZW50cy5jb250ZW50UmVhZHksIHJlZnJlc2gsIHRoaXMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29sbGFwc2VzIGEgZGV0YWlsIHJvdyB3aXRoIHRoZSBnaXZlbiB0YXJnZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtFbGVtZW50fSB0YXJnZXQgLSBEZWZpbmVzIHRoZSBleHBhbmRlZCBlbGVtZW50IHRvIGNvbGxhcHNlLlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIC8vIHB1YmxpYyBkZXRhaWxDb2xsYXBzZSh0YXJnZXQ6IG51bWJlciB8IEVsZW1lbnQpOiB2b2lkIHtcbiAgICAvLyAgICAgaWYgKHRoaXMuZGV0YWlsUm93TW9kdWxlKSB7XG4gICAgLy8gICAgICAgICB0aGlzLmRldGFpbFJvd01vZHVsZS5jb2xsYXBzZSh0YXJnZXQpO1xuICAgIC8vICAgICB9XG4gICAgLy8gfVxuICAgIC8qKlxuICAgICAqIENvbGxhcHNlcyBhbGwgdGhlIGRldGFpbCByb3dzIG9mIHRoZSBHcmlkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZGV0YWlsQ29sbGFwc2VBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmRldGFpbFJvd01vZHVsZSkge1xuICAgICAgICAgICAgdGhpcy5kZXRhaWxSb3dNb2R1bGUuY29sbGFwc2VBbGwoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRXhwYW5kcyBhIGRldGFpbCByb3cgd2l0aCB0aGUgZ2l2ZW4gdGFyZ2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7RWxlbWVudH0gdGFyZ2V0IC0gRGVmaW5lcyB0aGUgY29sbGFwc2VkIGVsZW1lbnQgdG8gZXhwYW5kLlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIC8vIHB1YmxpYyBkZXRhaWxFeHBhbmQodGFyZ2V0OiBudW1iZXIgfCBFbGVtZW50KTogdm9pZCB7XG4gICAgLy8gICAgIGlmICh0aGlzLmRldGFpbFJvd01vZHVsZSkge1xuICAgIC8vICAgICAgICAgdGhpcy5kZXRhaWxSb3dNb2R1bGUuZXhwYW5kKHRhcmdldCk7XG4gICAgLy8gICAgIH1cbiAgICAvLyB9XG4gICAgLyoqXG4gICAgICogRXhwYW5kcyBhbGwgdGhlIGRldGFpbCByb3dzIG9mIHRoZSBHcmlkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZGV0YWlsRXhwYW5kQWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5kZXRhaWxSb3dNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuZGV0YWlsUm93TW9kdWxlLmV4cGFuZEFsbCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBEZXNlbGVjdHMgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBjZWxscy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmNsZWFyQ2VsbFNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbk1vZHVsZS5jbGVhckNlbGxTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogRGVzZWxlY3RzIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgcm93cy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmNsZWFyUm93U2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uTW9kdWxlLmNsZWFyUm93U2VsZWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNlbGVjdHMgYSBjb2xsZWN0aW9uIG9mIGNlbGxzIGJ5IHJvdyBhbmQgY29sdW1uIGluZGV4ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtJU2VsZWN0ZWRDZWxsW119IHJvd0NlbGxJbmRleGVzIC0gU3BlY2lmaWVzIHRoZSByb3cgYW5kIGNvbHVtbiBpbmRleGVzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2VsZWN0Q2VsbHMgPSBmdW5jdGlvbiAocm93Q2VsbEluZGV4ZXMpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uTW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbk1vZHVsZS5zZWxlY3RDZWxscyhyb3dDZWxsSW5kZXhlcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNlbGVjdHMgYSByYW5nZSBvZiByb3dzIGZyb20gc3RhcnQgYW5kIGVuZCByb3cgaW5kZXhlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gc3RhcnRJbmRleCAtIFNwZWNpZmllcyB0aGUgc3RhcnQgcm93IGluZGV4LlxuICAgICAqIEBwYXJhbSAge251bWJlcn0gZW5kSW5kZXggLSBTcGVjaWZpZXMgdGhlIGVuZCByb3cgaW5kZXguXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zZWxlY3RSb3dzQnlSYW5nZSA9IGZ1bmN0aW9uIChzdGFydEluZGV4LCBlbmRJbmRleCkge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uTW9kdWxlLnNlbGVjdFJvd3NCeVJhbmdlKHN0YXJ0SW5kZXgsIGVuZEluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHdoZXRoZXIgY29udGV4dCBtZW51IGlzIG9wZW4gb3Igbm90XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuaXNDb250ZXh0TWVudU9wZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHRNZW51TW9kdWxlICYmIHRoaXMuY29udGV4dE1lbnVNb2R1bGUuaXNPcGVuO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbW9kdWxlIC0gRGVmaW5lcyB0aGUgbW9kdWxlXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJldHVybiB0aGUgaW5qZWN0ZWQgbW9kdWxlc1xuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5lbnN1cmVNb2R1bGVJbmplY3RlZCA9IGZ1bmN0aW9uIChtb2R1bGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SW5qZWN0ZWRNb2R1bGVzKCkuaW5kZXhPZihtb2R1bGUpID49IDA7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyB0aGUgZ2l2ZW4gdGVtcGxhdGUgcmVmZXJlbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gcHJvcGVydHlOYW1lcyAtIERlZmluZXMgdGhlIGNvbGxlY3Rpb24gb2YgdGVtcGxhdGUgbmFtZS5cbiAgICAgKiBAcGFyYW0ge2FueX0gaW5kZXggLSBzcGVjaWZpZXMgdGhlIGluZGV4XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICBHcmlkLnByb3RvdHlwZS5kZXN0cm95VGVtcGxhdGUgPSBmdW5jdGlvbiAocHJvcGVydHlOYW1lcywgaW5kZXgpIHtcbiAgICAgICAgdGhpcy5jbGVhclRlbXBsYXRlKHByb3BlcnR5TmFtZXMsIGluZGV4KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgc3RyaW5nW119IHR5cGUgLSBEZWZpbmVzIHRoZSB0eXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGFyZ3MgLSBEZWZpbmVzIHRoZSBhcmd1bWVudHNcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAodHlwZSwgYXJncykge1xuICAgICAgICB2YXIgaW5qZWN0ZWRNb2R1bGVzID0gdGhpcy5nZXRJbmplY3RlZE1vZHVsZXMoKTtcbiAgICAgICAgdmFyIGxvZ2dlciA9IGluamVjdGVkTW9kdWxlcy5maW5kKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBpdGVtLm5hbWUgPT09ICdMb2dnZXInOyB9KTtcbiAgICAgICAgaWYgKCFsb2dnZXIpIHtcbiAgICAgICAgICAgIEdyaWRfMS5JbmplY3QoTG9nZ2VyKTtcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlTG9nZ2VyID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB0aGlzLmluamVjdE1vZHVsZXMoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgdGhpcy5sb2dnZXJNb2R1bGUgPyB0aGlzLmxvZ2dlck1vZHVsZS5sb2codHlwZSwgYXJncykgOiAoZnVuY3Rpb24gKCkgeyByZXR1cm4gMDsgfSkoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIERlZmluZXMgdGhlIGVsZW1lbnRcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuYXBwbHlCaWdnZXJUaGVtZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWJpZ2dlcicpKSB7XG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2UtYmlnZ2VyJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBwcmV2aW91cyByb3cgZGF0YVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFByZXZpb3VzUm93RGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHByZXZpb3VzUm93RGF0YSA9IHRoaXMuZ2V0Um93c09iamVjdCgpW3RoaXMuZ2V0Um93cygpLmxlbmd0aCAtIDFdLmRhdGE7XG4gICAgICAgIHJldHVybiBwcmV2aW91c1Jvd0RhdGE7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBIaWRlcyB0aGUgc2Nyb2xsYmFyIHBsYWNlaG9sZGVyIG9mIEdyaWQgY29udGVudCB3aGVuIGdyaWQgY29udGVudCBpcyBub3Qgb3ZlcmZsb3duLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuaGlkZVNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSB0aGlzLmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmNvbnRlbnQpO1xuICAgICAgICBpZiAoY29udGVudC5zY3JvbGxIZWlnaHQgPD0gY29udGVudC5jbGllbnRIZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsTW9kdWxlLnJlbW92ZVBhZGRpbmcoKTtcbiAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgcm93IGluZGV4IGJ5IHByaW1hcnkga2V5IG9yIHJvdyBkYXRhLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nIHwgT2JqZWN0fSB2YWx1ZSAtIERlZmluZXMgdGhlIHByaW1hcnkga2V5IHZhbHVlLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZXhcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRSb3dJbmRleEJ5UHJpbWFyeUtleSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcGtOYW1lID0gdGhpcy5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpWzBdO1xuICAgICAgICB2YWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgPyB2YWx1ZVtcIlwiICsgcGtOYW1lXSA6IHZhbHVlO1xuICAgICAgICB2YXIgcm93cyA9IHRoaXMuZ2V0Um93c09iamVjdCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChyb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0RldGFpbFJvdyB8fCByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0NhcHRpb25Sb3cpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwS3ZhbHVlID0gcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZGF0YVtcIlwiICsgcGtOYW1lXTtcbiAgICAgICAgICAgIGlmIChwa05hbWUuc3BsaXQoJy4nKS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgcEt2YWx1ZSA9IHBlcmZvcm1Db21wbGV4RGF0YU9wZXJhdGlvbihwa05hbWUsIHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHBLdmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCAtIERlZmluZXMgdGhlIGZpZWxkIG5hbWVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzRm9yZWlnbktleSAtIERlZmluZXMgdGhlIGZvcmVpZ24ga2V5XG4gICAgICogQHJldHVybnMge0NvbHVtbn0gcmV0dXJucyB0aGUgY29sdW1uXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIC8vIE5lZWQgdG8gaGF2ZSBhbGwgY29sdW1ucyB3aGlsZSBmaWx0ZXJpbmcgd2l0aCBDb2x1bW5WaXJ0dWFsaXphdGlvbi5cbiAgICBHcmlkLnByb3RvdHlwZS5ncmFiQ29sdW1uQnlGaWVsZEZyb21BbGxDb2xzID0gZnVuY3Rpb24gKGZpZWxkLCBpc0ZvcmVpZ25LZXkpIHtcbiAgICAgICAgdmFyIGNvbHVtbjtcbiAgICAgICAgdGhpcy5jb2x1bW5Nb2RlbCA9IFtdO1xuICAgICAgICB0aGlzLnVwZGF0ZUNvbHVtbk1vZGVsKHRoaXMuY29sdW1ucyk7XG4gICAgICAgIHZhciBnQ29scyA9IHRoaXMuY29sdW1uTW9kZWw7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ0NvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICgoIWlzRm9yZWlnbktleSAmJiBmaWVsZCA9PT0gZ0NvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkKSB8fFxuICAgICAgICAgICAgICAgIChpc0ZvcmVpZ25LZXkgJiYgZ0NvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzRm9yZWlnbkNvbHVtbigpICYmXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkID09PSBnQ29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZm9yZWlnbktleVZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGNvbHVtbiA9IGdDb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29sdW1uO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVpZCAtIERlZmluZXMgdGhlIHVpZFxuICAgICAqIEByZXR1cm5zIHtDb2x1bW59IHJldHVybnMgdGhlIGNvbHVtblxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICAvLyBOZWVkIHRvIGhhdmUgYWxsIGNvbHVtbnMgd2hpbGUgZmlsdGVyaW5nIHdpdGggQ29sdW1uVmlydHVhbGl6YXRpb24uXG4gICAgR3JpZC5wcm90b3R5cGUuZ3JhYkNvbHVtbkJ5VWlkRnJvbUFsbENvbHMgPSBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHZhciBjb2x1bW47XG4gICAgICAgIHRoaXMuY29sdW1uTW9kZWwgPSBbXTtcbiAgICAgICAgdGhpcy51cGRhdGVDb2x1bW5Nb2RlbCh0aGlzLmNvbHVtbnMpO1xuICAgICAgICB2YXIgZ0NvbHMgPSB0aGlzLmNvbHVtbk1vZGVsO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGdDb2xzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodWlkID09PSBnQ29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udWlkKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uID0gZ0NvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb2x1bW47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgYWxsIGZpbHRlcmVkIHJlY29yZHMgZnJvbSB0aGUgR3JpZCBhbmQgaXQgcmV0dXJucyBhcnJheSBvZiBvYmplY3RzIGZvciB0aGUgbG9jYWwgZGF0YVNvdXJjZSwgcmV0dXJucyBhIHByb21pc2Ugb2JqZWN0IGlmIHRoZSBHcmlkIGhhcyByZW1vdGUgZGF0YS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtPYmplY3RbXSB8IFByb21pc2U8T2JqZWN0Pn0gUmV0dXJucyB0aGUgZmlsdGVyZWQgcmVjb3Jkc1xuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZpbHRlcmVkUmVjb3JkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCh0aGlzLmFsbG93RmlsdGVyaW5nICYmIHRoaXMuZmlsdGVyU2V0dGluZ3MuY29sdW1ucy5sZW5ndGgpIHx8IHRoaXMuc2VhcmNoU2V0dGluZ3Mua2V5Lmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy5yZW5kZXJNb2R1bGUuZGF0YS5nZW5lcmF0ZVF1ZXJ5KHRydWUpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGF0YVNvdXJjZSAmJiB0aGlzLnJlbmRlck1vZHVsZS5kYXRhLmlzUmVtb3RlKCkgJiYgdGhpcy5kYXRhU291cmNlIGluc3RhbmNlb2YgRGF0YU1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJNb2R1bGUuZGF0YS5nZXREYXRhKHRoaXMuZGF0YVNvdXJjZSwgcXVlcnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGF0YVNvdXJjZSBpbnN0YW5jZW9mIERhdGFNYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFTb3VyY2UuZXhlY3V0ZUxvY2FsKHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0YU1hbmFnZXIodGhpcy5kYXRhU291cmNlLCBxdWVyeSkuZXhlY3V0ZUxvY2FsKHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0VXNlckFnZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdXNlckFnZW50ID0gQnJvd3Nlci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgcmV0dXJuIC9pcGhvbmV8aXBvZHxpcGFkfG1hY2ludG9zaC8udGVzdCh1c2VyQWdlbnQpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtUb3VjaEV2ZW50QXJnc30gZSAtIERlZmluZXMgdGhlIFRvdWNoRXZlbnRBcmdzXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIC8vIE5lZWQgdG8gaGF2ZSBhbGwgY29sdW1ucyB3aGlsZSBmaWx0ZXJpbmcgd2l0aCBDb2x1bW5WaXJ0dWFsaXphdGlvbi5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICBHcmlkLnByb3RvdHlwZS50YXBFdmVudCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0aGlzLmdldFVzZXJBZ2VudCgpKSB7XG4gICAgICAgICAgICBpZiAoIUdsb2JhbC50aW1lcikge1xuICAgICAgICAgICAgICAgIEdsb2JhbC50aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBHbG9iYWwudGltZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0sIDMwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoR2xvYmFsLnRpbWVyKTtcbiAgICAgICAgICAgICAgICBHbG9iYWwudGltZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuZGJsQ2xpY2tIYW5kbGVyKGUpO1xuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5kb3VibGVUYXAsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJlZml4IC0gc3BlY2lmaWVzIHRoZSBwcmVmaXhcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSByZXR1cm5zIHRoZSByb3cgdWlkXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldFJvd1VpZCA9IGZ1bmN0aW9uIChwcmVmaXgpIHtcbiAgICAgICAgcmV0dXJuIFwiXCIgKyBwcmVmaXggKyB0aGlzLnJvd1VpZCsrO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVpZCAtIHNwZWNpZmllcyB0aGUgdWlkXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0Um93RWxlbWVudEJ5VUlEID0gZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICB2YXIgcm93RWxlO1xuICAgICAgICB2YXIgcm93cyA9IFtdO1xuICAgICAgICB2YXIgY250Um93cyA9IFtdLnNsaWNlLmNhbGwodGhpcy5nZXRDb250ZW50KCkucXVlcnlTZWxlY3RvcihsaXRlcmFscy50Ym9keSkuY2hpbGRyZW4pO1xuICAgICAgICBpZiAodGhpcy5mcm96ZW5Sb3dzKSB7XG4gICAgICAgICAgICByb3dzID0gW10uc2xpY2UuY2FsbCh0aGlzLmdldEhlYWRlckNvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLnRib2R5KS5jaGlsZHJlbik7XG4gICAgICAgICAgICByb3dzID0gcm93cy5jb25jYXQoY250Um93cyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByb3dzID0gY250Um93cztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJvd3NfMiA9IHJvd3M7IF9pIDwgcm93c18yLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHJvdyA9IHJvd3NfMltfaV07XG4gICAgICAgICAgICBpZiAocm93LmdldEF0dHJpYnV0ZSgnZGF0YS11aWQnKSA9PT0gdWlkKSB7XG4gICAgICAgICAgICAgICAgcm93RWxlID0gcm93O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByb3dFbGU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBoaWRkZW4gY29sdW1ucyBmcm9tIHRoZSBHcmlkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0NvbHVtbltdfSBSZXR1cm5zIHRoZSBDb2x1bW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRIaWRkZW5Db2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29scyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5jb2x1bW5Nb2RlbDsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBjb2wgPSBfYVtfaV07XG4gICAgICAgICAgICBpZiAoY29sLnZpc2libGUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgY29scy5wdXNoKGNvbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbHM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGVzIHRoZSBwYWdlIHNpemUgYnkgcGFyZW50IGVsZW1lbnQgaGVpZ2h0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlciB8IHN0cmluZyB9IGNvbnRhaW5lckhlaWdodCAtIHNwZWNpZmllcyB0aGUgY29udGFpbmVyIGhlaWdodFxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHJldHVybnMgdGhlIHBhZ2Ugc2l6ZVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmNhbGN1bGF0ZVBhZ2VTaXplQnlQYXJlbnRIZWlnaHQgPSBmdW5jdGlvbiAoY29udGFpbmVySGVpZ2h0KSB7XG4gICAgICAgIGlmICh0aGlzLmFsbG93UGFnaW5nKSB7XG4gICAgICAgICAgICBpZiAoKHRoaXMuYWxsb3dUZXh0V3JhcCAmJiB0aGlzLnRleHRXcmFwU2V0dGluZ3Mud3JhcE1vZGUgPT09ICdIZWFkZXInKSB8fCAoIXRoaXMuYWxsb3dUZXh0V3JhcCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFnZXNpemUgPSAwO1xuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXJIZWlnaHQuaW5kZXhPZignJScpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXJIZWlnaHQgPSBwYXJzZUludChjb250YWluZXJIZWlnaHQsIDEwKSAvIDEwMCAqIHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBub25Db250ZW50SGVpZ2h0ID0gdGhpcy5nZXROb25jb250ZW50SGVpZ2h0KCkgKyB0aGlzLmdldFJvd0hlaWdodCgpO1xuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXJIZWlnaHQgPiBub25Db250ZW50SGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50SGVpZ2h0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudEhlaWdodCA9IGNvbnRhaW5lckhlaWdodCAtIHRoaXMuZ2V0Tm9uY29udGVudEhlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICBwYWdlc2l6ZSA9IChjb250ZW50SGVpZ2h0IC8gdGhpcy5nZXRSb3dIZWlnaHQoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwYWdlc2l6ZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IocGFnZXNpemUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmdldE5vbmNvbnRlbnRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBoZWlnaHQgPSAwO1xuICAgICAgICBpZiAodGhpcy5nZXRIZWFkZXJDb250ZW50KCkgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZ2V0SGVhZGVyQ29udGVudCgpLmNsaWVudEhlaWdodCkpIHtcbiAgICAgICAgICAgIGhlaWdodCArPSB0aGlzLmdldEhlYWRlckNvbnRlbnQoKS5jbGllbnRIZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudG9vbGJhciAmJiAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXRvb2xiYXInKS5jbGllbnRIZWlnaHQpKSB7XG4gICAgICAgICAgICBoZWlnaHQgKz0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXRvb2xiYXInKS5jbGllbnRIZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWxsb3dQYWdpbmcgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1ncmlkcGFnZXInKS5jbGllbnRIZWlnaHQpKSB7XG4gICAgICAgICAgICBoZWlnaHQgKz0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWdyaWRwYWdlcicpLmNsaWVudEhlaWdodDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zaG93Q29sdW1uQ2hvb3NlciAmJiAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWNvbHVtbmhlYWRlcicpLmNsaWVudEhlaWdodCkpIHtcbiAgICAgICAgICAgIGhlaWdodCArPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtY29sdW1uaGVhZGVyJykuY2xpZW50SGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFsbG93R3JvdXBpbmcgJiYgdGhpcy5ncm91cFNldHRpbmdzLnNob3dEcm9wQXJlYSAmJiAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWdyb3VwZHJvcGFyZWEnKS5jbGllbnRIZWlnaHQpKSB7XG4gICAgICAgICAgICBoZWlnaHQgKz0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWdyb3VwZHJvcGFyZWEnKS5jbGllbnRIZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWdncmVnYXRlcy5sZW5ndGggPiAwICYmICFpc051bGxPclVuZGVmaW5lZCh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtc3VtbWFyeXJvdycpLmNsaWVudEhlaWdodCkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5lbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Utc3VtbWFyeXJvdycpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ICs9IHRoaXMuZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlLXN1bW1hcnlyb3cnKVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoZWlnaHQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKlRvIHBlcmZvcm0gYWdncmVnYXRlIG9wZXJhdGlvbiBvbiBhIGNvbHVtbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0FnZ3JlZ2F0ZUNvbHVtbk1vZGVsfSBzdW1tYXJ5Q29sIC0gUGFzcyBBZ2dyZWdhdGUgQ29sdW1uIGRldGFpbHMuXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBzdW1tYXJ5RGF0YSAtIFBhc3MgSlNPTiBBcnJheSBmb3Igd2hpY2ggaXRzIGZpZWxkIHZhbHVlcyB0byBiZSBjYWxjdWxhdGVkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn0gcmV0dXJucyB0aGUgc3VtbWFyeSB2YWx1ZXNcbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRTdW1tYXJ5VmFsdWVzID0gZnVuY3Rpb24gKHN1bW1hcnlDb2wsIHN1bW1hcnlEYXRhKSB7XG4gICAgICAgIHJldHVybiBEYXRhVXRpbC5hZ2dyZWdhdGVzW3N1bW1hcnlDb2wudHlwZS50b0xvd2VyQ2FzZSgpXShzdW1tYXJ5RGF0YSwgc3VtbWFyeUNvbC5maWVsZCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZW5kcyBhIFBvc3QgcmVxdWVzdCB0byBleHBvcnQgR3JpZCB0byBFeGNlbCBmaWxlIGluIHNlcnZlciBzaWRlLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSB1cmwgLSBQYXNzIFVybCBmb3Igc2VydmVyIHNpZGUgZXhjZWwgZXhwb3J0IGFjdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0V4cG9ydEhlYWRlcnN9IGhlYWRlcnMgLSBUaGUgaGVhZGVycyB0byBpbmNsdWRlIGluIHRoZSBleHBvcnQgcmVxdWVzdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNlcnZlckV4Y2VsRXhwb3J0ID0gZnVuY3Rpb24gKHVybCwgaGVhZGVycykge1xuICAgICAgICB0aGlzLmlzRXhjZWwgPSB0cnVlO1xuICAgICAgICB0aGlzLmV4cG9ydEdyaWQodXJsLCBoZWFkZXJzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgUG9zdCByZXF1ZXN0IHRvIGV4cG9ydCBHcmlkIHRvIFBkZiBmaWxlIGluIHNlcnZlciBzaWRlLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSB1cmwgLSBQYXNzIFVybCBmb3Igc2VydmVyIHNpZGUgcGRmIGV4cG9ydCBhY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtFeHBvcnRIZWFkZXJzfSBoZWFkZXJzIC0gVGhlIGhlYWRlcnMgdG8gaW5jbHVkZSBpbiB0aGUgZXhwb3J0IHJlcXVlc3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zZXJ2ZXJQZGZFeHBvcnQgPSBmdW5jdGlvbiAodXJsLCBoZWFkZXJzKSB7XG4gICAgICAgIHRoaXMuaXNFeGNlbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmV4cG9ydEdyaWQodXJsLCBoZWFkZXJzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgUG9zdCByZXF1ZXN0IHRvIGV4cG9ydCBHcmlkIHRvIENTViBmaWxlIGluIHNlcnZlciBzaWRlLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSB1cmwgLSBQYXNzIFVybCBmb3Igc2VydmVyIHNpZGUgY3N2IGV4cG9ydCBhY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtFeHBvcnRIZWFkZXJzfSBoZWFkZXJzIC0gVGhlIGhlYWRlcnMgdG8gaW5jbHVkZSBpbiB0aGUgZXhwb3J0IHJlcXVlc3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zZXJ2ZXJDc3ZFeHBvcnQgPSBmdW5jdGlvbiAodXJsLCBoZWFkZXJzKSB7XG4gICAgICAgIHRoaXMuaXNFeGNlbCA9IHRydWU7XG4gICAgICAgIHRoaXMuZXhwb3J0R3JpZCh1cmwsIGhlYWRlcnMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIERlZmluZXMgZXhwb3J0aW5nIHVybFxuICAgICAqIEBwYXJhbSB7RXhwb3J0SGVhZGVyc30gaGVhZGVycyAtIFRoZSBvcHRpb25hbCBoZWFkZXJzIGZvciB0aGUgZXhwb3J0IHJlcXVlc3QuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmV4cG9ydEdyaWQgPSBmdW5jdGlvbiAodXJsLCBoZWFkZXJzKSB7XG4gICAgICAgIHZhciBfdGhpc18xID0gdGhpcztcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzXG4gICAgICAgIHZhciBncmlkID0gdGhpcztcbiAgICAgICAgdmFyIHF1ZXJ5ID0gZ3JpZC5nZXREYXRhTW9kdWxlKCkuZ2VuZXJhdGVRdWVyeSh0cnVlKTtcbiAgICAgICAgdmFyIHN0YXRlID0gbmV3IFVybEFkYXB0b3IoKS5wcm9jZXNzUXVlcnkobmV3IERhdGFNYW5hZ2VyKHsgdXJsOiAnJyB9KSwgcXVlcnkpO1xuICAgICAgICB2YXIgcXVlcmllcyA9IEpTT04ucGFyc2Uoc3RhdGUuZGF0YSk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHZhciBncmlkTW9kZWwgPSBKU09OLnBhcnNlKHRoaXMuYWRkT25QZXJzaXN0KFsnYWxsb3dHcm91cGluZycsICdhbGxvd1BhZ2luZycsICdwYWdlU2V0dGluZ3MnLCAnc29ydFNldHRpbmdzJywgJ2FsbG93UGRmRXhwb3J0JywgJ2FsbG93RXhjZWxFeHBvcnQnLCAnYWdncmVnYXRlcycsXG4gICAgICAgICAgICAnZmlsdGVyU2V0dGluZ3MnLCAnZ3JvdXBTZXR0aW5ncycsICdjb2x1bW5zJywgJ2xvY2FsZScsICdzZWFyY2hTZXR0aW5ncyddKSk7XG4gICAgICAgIHZhciBpbmNsdWRlID0gWydmaWVsZCcsICdoZWFkZXJUZXh0JywgJ3R5cGUnLCAnZm9ybWF0JywgJ3Zpc2libGUnLCAnZm9yZWlnbktleVZhbHVlJywgJ2ZvcmVpZ25LZXlGaWVsZCcsXG4gICAgICAgICAgICAndGVtcGxhdGUnLCAnaW5kZXgnLCAnd2lkdGgnLCAndGV4dEFsaWduJywgJ2hlYWRlclRleHRBbGlnbicsICdjb2x1bW5zJ107XG4gICAgICAgIGdyaWRNb2RlbC5maWx0ZXJTZXR0aW5ncy5jb2x1bW5zID0gcXVlcmllcy53aGVyZTtcbiAgICAgICAgZ3JpZE1vZGVsLnNlYXJjaFNldHRpbmdzLmZpZWxkcyA9IHF1ZXJpZXMuc2VhcmNoICYmIHF1ZXJpZXMuc2VhcmNoWzBdWydmaWVsZHMnXSB8fCBbXTtcbiAgICAgICAgZ3JpZE1vZGVsLnNvcnRTZXR0aW5ncy5jb2x1bW5zID0gcXVlcmllcy5zb3J0ZWQ7XG4gICAgICAgIGdyaWRNb2RlbC5jb2x1bW5zID0gdGhpcy5zZXRIZWFkZXJUZXh0KGdyaWRNb2RlbC5jb2x1bW5zLCBpbmNsdWRlKTtcbiAgICAgICAgdmFyIGZvcm0gPSB0aGlzLmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nLCB7IGlkOiAnRXhwb3J0Rm9ybScgfSk7XG4gICAgICAgIGZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgdmFyIGdyaWRJbnB1dCA9IHRoaXMuY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7IGlkOiAnZ3JpZElucHV0JywgYXR0cnM6IHsgbmFtZTogJ2dyaWRNb2RlbCcgfSB9KTtcbiAgICAgICAgZ3JpZElucHV0LnZhbHVlID0gSlNPTi5zdHJpbmdpZnkoZ3JpZE1vZGVsKTtcbiAgICAgICAgZm9ybS5tZXRob2QgPSAnUE9TVCc7XG4gICAgICAgIGZvcm0uYWN0aW9uID0gdXJsO1xuICAgICAgICBmb3JtLmFwcGVuZENoaWxkKGdyaWRJbnB1dCk7XG4gICAgICAgIGlmIChoZWFkZXJzICYmIGhlYWRlcnMuaGVhZGVycyAmJiBBcnJheS5pc0FycmF5KGhlYWRlcnMuaGVhZGVycykpIHtcbiAgICAgICAgICAgIGhlYWRlcnMuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhoZWFkZXIpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB0eXBlb2YgaGVhZGVyW1wiXCIgKyBrZXldID09PSAnc3RyaW5nJyA/IGhlYWRlcltcIlwiICsga2V5XSA6IEpTT04uc3RyaW5naWZ5KGhlYWRlcltcIlwiICsga2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZWFkZXJJbnB1dCA9IF90aGlzXzEuY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7IGF0dHJzOiB7IG5hbWU6IGtleSwgdmFsdWU6IHZhbHVlLCB0eXBlOiAnaGlkZGVuJyB9IH0pO1xuICAgICAgICAgICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKGhlYWRlcklucHV0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZm9ybSk7XG4gICAgICAgIGZvcm0uc3VibWl0KCk7XG4gICAgICAgIGZvcm0ucmVtb3ZlKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0NvbHVtbltdfSBjb2x1bW5zIC0gRGVmaW5lcyBhcnJheSBvZiBjb2x1bW5zXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gaW5jbHVkZSAtIERlZmluZXMgYXJyYXkgb2Ygc3RpbmdcbiAgICAgKiBAcmV0dXJucyB7Q29sdW1uW119IHJldHVybnMgYXJyYXkgb2YgY29sdW1uc1xuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zZXRIZWFkZXJUZXh0ID0gZnVuY3Rpb24gKGNvbHVtbnMsIGluY2x1ZGUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1uID0gdGhpcy5nZXRDb2x1bW5CeVVpZChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS51aWQpO1xuICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaGVhZGVyVGV4dCA9IGNvbHVtbi5oZWFkZXJUZXh0O1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjb2x1bW4udGVtcGxhdGUpKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udGVtcGxhdGUgPSAndHJ1ZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZm9ybWF0ID0gZ2V0TnVtYmVyRm9ybWF0KHRoaXMuZ2V0Rm9ybWF0KGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZvcm1hdCksIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnR5cGUsIGZhbHNlLCBkZWZhdWx0Q3VycmVuY3lDb2RlKTtcbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uLnR5cGUgPT09ICdkYXRldGltZScgfHwgY29sdW1uLnR5cGUgPT09ICdkYXRlJyB8fCBjb2x1bW4udHlwZSA9PT0gJ3RpbWUnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZvcm1hdCA9IGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZvcm1hdC50b1N0cmluZygpLnJlcGxhY2UoJ0FNL1BNJywgJ3R0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEhlYWRlclRleHQoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucywgaW5jbHVkZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwga2V5cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGlmIChpbmNsdWRlLmluZGV4T2Yoa2V5c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0pIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1ba2V5c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29sdW1ucztcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZvcm1hdCA9IGZ1bmN0aW9uIChmb3JtYXQpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiAoZm9ybWF0KSA9PT0gJ29iamVjdCcgPyAhaXNOdWxsT3JVbmRlZmluZWQoZm9ybWF0LmZvcm1hdCkgP1xuICAgICAgICAgICAgZm9ybWF0LmZvcm1hdCA6IGZvcm1hdC5za2VsZXRvbiA6IGZvcm1hdDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmV0dXJucyB0aGUgaXNDb2xsYXBzZVN0YXRlRW5hYmxlZFxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmlzQ29sbGFwc2VTdGF0ZUVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpc0V4cGFuZGVkID0gJ2lzRXhwYW5kZWQnO1xuICAgICAgICByZXR1cm4gdGhpc1tcIlwiICsgaXNFeHBhbmRlZF0gPT09IGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGtleSAtIERlZmluZXMgdGhlIHByaW1hcnkga2V5IHZhbHVlLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSByb3dEYXRhIC0gRGVmaW5lcyB0aGUgcm93RGF0YVxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnVwZGF0ZVJvd1ZhbHVlID0gZnVuY3Rpb24gKGtleSwgcm93RGF0YSkge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIHJlcXVlc3RUeXBlOiAnc2F2ZScsIGRhdGE6IHJvd0RhdGFcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zaG93U3Bpbm5lcigpO1xuICAgICAgICB0aGlzLm5vdGlmeShldmVudHMudXBkYXRlRGF0YSwgYXJncyk7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNldEZvcmVpZ25LZXlEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmRhdGFCaW5kKCk7XG4gICAgICAgIHZhciBjb2xwZW5kaW5nID0gdGhpcy5nZXREYXRhTW9kdWxlKCkuZ2V0Rm9yZWlnbktleURhdGFTdGF0ZSgpO1xuICAgICAgICBpZiAoY29scGVuZGluZy5pc1BlbmRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0RGF0YU1vZHVsZSgpLnNldEZvcmVpZ25LZXlEYXRhU3RhdGUoe30pO1xuICAgICAgICAgICAgY29scGVuZGluZy5yZXNvbHZlcigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5nZXREYXRhTW9kdWxlKCkuc2V0Rm9yZWlnbktleURhdGFTdGF0ZSh7IGlzRGF0YUNoYW5nZWQ6IGZhbHNlIH0pO1xuICAgICAgICAgICAgaWYgKHRoaXMuY29udGVudE1vZHVsZSB8fCB0aGlzLmhlYWRlck1vZHVsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTW9kdWxlLnJlbmRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSBzcGVjaWZpZXMgdGhlIGZpZWxkXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnJlc2V0RmlsdGVyRGxnUG9zaXRpb24gPSBmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgdmFyIGhlYWRlciA9IHRoaXMuZ2V0Q29sdW1uSGVhZGVyQnlGaWVsZChmaWVsZCk7XG4gICAgICAgIGlmIChoZWFkZXIpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmUtZmlsdGVybWVudWRpdicpO1xuICAgICAgICAgICAgdmFyIGZpbHRlckRsZyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1maWx0ZXItcG9wdXAnKTtcbiAgICAgICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZ0NsaWVudCA9IHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICB2YXIgZkNsaWVudCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICBpZiAoZmlsdGVyRGxnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoZmlsdGVyRGxnLm9mZnNldFdpZHRoICsgZkNsaWVudC5yaWdodCkgPiBnQ2xpZW50LnJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJEbGcuc3R5bGUubGVmdCA9ICgoZkNsaWVudC5yaWdodCAtIGZpbHRlckRsZy5vZmZzZXRXaWR0aCkgLSBnQ2xpZW50LmxlZnQpLnRvU3RyaW5nKCkgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyRGxnLnN0eWxlLmxlZnQgPSAoZkNsaWVudC5yaWdodCAtIGdDbGllbnQubGVmdCkudG9TdHJpbmcoKSArICdweCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7YW55fSBjYWxsQmFjayAtIHNwZWNpZmllcyB0aGUgY2FsbEJhY2sgbWV0aG9kXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgIEdyaWQucHJvdG90eXBlLnJlbmRlclRlbXBsYXRlcyA9IGZ1bmN0aW9uIChjYWxsQmFjaykge1xuICAgICAgICB2YXIgaXNSZWFjdENoaWxkID0gdGhpcy5wYXJlbnREZXRhaWxzICYmIHRoaXMucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqICYmIHRoaXMucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqLmlzUmVhY3Q7XG4gICAgICAgIHZhciBpc1JlYWN0UHJpbnRHcmlkID0gdGhpcy5wcmludEdyaWRQYXJlbnQgJiYgdGhpcy5wcmludEdyaWRQYXJlbnQuaXNSZWFjdDtcbiAgICAgICAgaWYgKChpc1JlYWN0Q2hpbGQgfHwgaXNSZWFjdFByaW50R3JpZCkgJiYgdGhpc1sncG9ydGFscyddKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50SW5zdE9iaiA9IGlzUmVhY3RQcmludEdyaWQgPyB0aGlzLnByaW50R3JpZFBhcmVudCA6IHRoaXMucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqO1xuICAgICAgICAgICAgcGFyZW50SW5zdE9ialsncG9ydGFscyddID0gcGFyZW50SW5zdE9ialsncG9ydGFscyddLmNvbmNhdCh0aGlzWydwb3J0YWxzJ10pO1xuICAgICAgICAgICAgcGFyZW50SW5zdE9iai5yZW5kZXJUZW1wbGF0ZXMoY2FsbEJhY2spO1xuICAgICAgICAgICAgdGhpc1sncG9ydGFscyddID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHBvcnRhbHMgPSAncG9ydGFscyc7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeSgncmVhY3RUZW1wbGF0ZVJlbmRlcicsIHRoaXNbXCJcIiArIHBvcnRhbHNdKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUmVhY3RUZW1wbGF0ZXMoY2FsbEJhY2spO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBcHBseSB0aGUgY2hhbmdlcyB0byB0aGUgR3JpZCB3aXRob3V0IHJlZnJlc2hpbmcgdGhlIHJvd3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtCYXRjaENoYW5nZXN9IGNoYW5nZXMgLSBEZWZpbmVzIGNoYW5nZXMgdG8gYmUgdXBkYXRlZC5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5iYXRjaFVwZGF0ZSA9IGZ1bmN0aW9uIChjaGFuZ2VzKSB7XG4gICAgICAgIHRoaXMucHJvY2Vzc1Jvd0NoYW5nZXMoY2hhbmdlcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBcHBseSB0aGUgY2hhbmdlcyB0byB0aGUgR3JpZCBpbiBvbmUgYmF0Y2ggYWZ0ZXIgNTBtcyB3aXRob3V0IHJlZnJlc2hpbmcgdGhlIHJvd3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtCYXRjaENoYW5nZXN9IGNoYW5nZXMgLSBEZWZpbmVzIGNoYW5nZXMgdG8gYmUgdXBkYXRlZC5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5iYXRjaEFzeW5jVXBkYXRlID0gZnVuY3Rpb24gKGNoYW5nZXMpIHtcbiAgICAgICAgdGhpcy5wcm9jZXNzQnVsa1Jvd0NoYW5nZXMoY2hhbmdlcyk7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5wcm9jZXNzQnVsa1Jvd0NoYW5nZXMgPSBmdW5jdGlvbiAoY2hhbmdlcykge1xuICAgICAgICB2YXIgX3RoaXNfMSA9IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5kYXRhVG9CZVVwZGF0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YVRvQmVVcGRhdGVkID0gT2JqZWN0LmFzc2lnbih7IGFkZGVkUmVjb3JkczogW10sIGNoYW5nZWRSZWNvcmRzOiBbXSwgZGVsZXRlZFJlY29yZHM6IFtdIH0sIGNoYW5nZXMpO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXNfMS5wcm9jZXNzUm93Q2hhbmdlcyhfdGhpc18xLmRhdGFUb0JlVXBkYXRlZCk7XG4gICAgICAgICAgICAgICAgX3RoaXNfMS5kYXRhVG9CZVVwZGF0ZWQgPSBudWxsO1xuICAgICAgICAgICAgfSwgdGhpcy5hc3luY1RpbWVPdXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGxvb3BzdHJpbmcgPSBbbGl0ZXJhbHMuYWRkZWRSZWNvcmRzLCBsaXRlcmFscy5jaGFuZ2VkUmVjb3JkcywgbGl0ZXJhbHMuZGVsZXRlZFJlY29yZHNdO1xuICAgICAgICAgICAgdmFyIGtleUZpZWxkID0gdGhpcy5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpWzBdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsb29wc3RyaW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoYW5nZXNbbG9vcHN0cmluZ1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmVDaGFuZ2VzKHRoaXMsIGNoYW5nZXMsIGxvb3BzdHJpbmdbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBrZXlGaWVsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5wcm9jZXNzUm93Q2hhbmdlcyA9IGZ1bmN0aW9uIChjaGFuZ2VzKSB7XG4gICAgICAgIHZhciBfdGhpc18xID0gdGhpcztcbiAgICAgICAgdmFyIGtleUZpZWxkID0gdGhpcy5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpWzBdO1xuICAgICAgICBjaGFuZ2VzID0gT2JqZWN0LmFzc2lnbih7IGFkZGVkUmVjb3JkczogW10sIGNoYW5nZWRSZWNvcmRzOiBbXSwgZGVsZXRlZFJlY29yZHM6IFtdIH0sIGNoYW5nZXMpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXMuZ2V0RGF0YU1vZHVsZSgpLnNhdmVDaGFuZ2VzKGNoYW5nZXMsIGtleUZpZWxkLCB7fSwgdGhpcy5nZXREYXRhTW9kdWxlKCkuZ2VuZXJhdGVRdWVyeSgpLnJlcXVpcmVzQ291bnQoKSk7XG4gICAgICAgIGlmICh0aGlzLmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpKSB7XG4gICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzXzEuc2V0TmV3RGF0YSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldE5ld0RhdGEoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuc2V0TmV3RGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzXzEgPSB0aGlzO1xuICAgICAgICB2YXIgb2xkVmFsdWVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmdldEN1cnJlbnRWaWV3UmVjb3JkcygpKSk7XG4gICAgICAgIHZhciBnZXREYXRhID0gdGhpcy5nZXREYXRhTW9kdWxlKCkuZ2V0RGF0YSh7fSwgdGhpcy5nZXREYXRhTW9kdWxlKCkuZ2VuZXJhdGVRdWVyeSgpLnJlcXVpcmVzQ291bnQoKSk7XG4gICAgICAgIGdldERhdGEudGhlbihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgX3RoaXNfMS5idWxrUmVmcmVzaChlLnJlc3VsdCwgb2xkVmFsdWVzLCBlLmNvdW50KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5kZWxldGVSb3dFbGVtZW50ID0gZnVuY3Rpb24gKHJvdykge1xuICAgICAgICB2YXIgdHIgPSB0aGlzLmdldFJvd0VsZW1lbnRCeVVJRChyb3cudWlkKTtcbiAgICAgICAgcmVtb3ZlKHRyKTtcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmJ1bGtSZWZyZXNoID0gZnVuY3Rpb24gKHJlc3VsdCwgb2xkVmFsdWVzLCBjb3VudCkge1xuICAgICAgICB2YXIgX3RoaXNfMSA9IHRoaXM7XG4gICAgICAgIHZhciByb3dPYmogPSB0aGlzLmdldFJvd3NPYmplY3QoKTtcbiAgICAgICAgdmFyIGtleUZpZWxkID0gdGhpcy5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpWzBdO1xuICAgICAgICB2YXIgX2xvb3BfNSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICBpZiAoIXJlc3VsdC5maWx0ZXIoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGVbXCJcIiArIGtleUZpZWxkXSA9PT0gcm93T2JqW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5kYXRhW1wiXCIgKyBrZXlGaWVsZF07IH0pLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXNfNS5kZWxldGVSb3dFbGVtZW50KHJvd09ialtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIHJvd09iai5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgaS0tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0X2lfMSA9IGk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB0aGlzXzUgPSB0aGlzLCBvdXRfaV8xO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd09iai5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgX2xvb3BfNShpKTtcbiAgICAgICAgICAgIGkgPSBvdXRfaV8xO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfbG9vcF82ID0gZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIHZhciBpc1Jvd0V4aXN0O1xuICAgICAgICAgICAgb2xkVmFsdWVzLmZpbHRlcihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmIChlW1wiXCIgKyBrZXlGaWVsZF0gPT09IHJlc3VsdFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIGtleUZpZWxkXSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZSAhPT0gcmVzdWx0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXNfMS5zZXRSb3dEYXRhKHJlc3VsdFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIGtleUZpZWxkXSwgcmVzdWx0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaXNSb3dFeGlzdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIWlzUm93RXhpc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzXzYucmVuZGVyUm93RWxlbWVudChyZXN1bHRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRoaXNfNiA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBfbG9vcF82KGkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3VycmVudFZpZXdEYXRhID0gcmVzdWx0O1xuICAgICAgICB2YXIgcm93cyA9IFtdLnNsaWNlLmNhbGwodGhpcy5nZXRDb250ZW50VGFibGUoKS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGxpdGVyYWxzLnJvdykpO1xuICAgICAgICByZXNldFJvd0luZGV4KHRoaXMsIHRoaXMuZ2V0Um93c09iamVjdCgpLCByb3dzKTtcbiAgICAgICAgc2V0Um93RWxlbWVudHModGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmFsbG93UGFnaW5nKSB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeShldmVudHMuaW5Cb3VuZE1vZGVsQ2hhbmdlZCwgeyBtb2R1bGU6ICdwYWdlcicsIHByb3BlcnRpZXM6IHsgdG90YWxSZWNvcmRzQ291bnQ6IGNvdW50IH0gfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLnJlbmRlclJvd0VsZW1lbnQgPSBmdW5jdGlvbiAoZGF0YSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIHJvdyA9IG5ldyBSb3dSZW5kZXJlcih0aGlzLnNlcnZpY2VMb2NhdG9yLCBudWxsLCB0aGlzKTtcbiAgICAgICAgdmFyIG1vZGVsID0gbmV3IFJvd01vZGVsR2VuZXJhdG9yKHRoaXMpO1xuICAgICAgICB2YXIgbW9kZWxEYXRhID0gbW9kZWwuZ2VuZXJhdGVSb3dzKFtkYXRhXSk7XG4gICAgICAgIHZhciB0ciA9IHJvdy5yZW5kZXIobW9kZWxEYXRhWzBdLCB0aGlzLmdldENvbHVtbnMoKSk7XG4gICAgICAgIHRoaXMuYWRkUm93T2JqZWN0KG1vZGVsRGF0YVswXSwgaW5kZXgpO1xuICAgICAgICB2YXIgdGJvZHkgPSB0aGlzLmdldENvbnRlbnRUYWJsZSgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpO1xuICAgICAgICBpZiAodGJvZHkucXVlcnlTZWxlY3RvcignLmUtZW1wdHlyb3cnKSkge1xuICAgICAgICAgICAgdmFyIGVtcHR5Um93ID0gdGJvZHkucXVlcnlTZWxlY3RvcignLmUtZW1wdHlyb3cnKTtcbiAgICAgICAgICAgIGVtcHR5Um93LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZW1wdHlSb3cpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZnJvemVuUm93cyAmJiB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZnJvemVucm93LWVtcHR5JykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZnJvemVucm93LWVtcHR5JykuY2xhc3NMaXN0LnJlbW92ZSgnZS1mcm96ZW5yb3ctZW1wdHknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5mcm96ZW5Sb3dzICYmIGluZGV4IDwgdGhpcy5mcm96ZW5Sb3dzKSB7XG4gICAgICAgICAgICB0Ym9keSA9IHRoaXMuZ2V0SGVhZGVyQ29udGVudCgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGJvZHkgPSB0aGlzLmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLnRib2R5KTtcbiAgICAgICAgfVxuICAgICAgICB0Ym9keSA9IHRoaXMuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpO1xuICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZCh0cik7XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5hZGRSb3dPYmplY3QgPSBmdW5jdGlvbiAocm93LCBpbmRleCkge1xuICAgICAgICB0aGlzLmdldFJvd3NPYmplY3QoKS5zcGxpY2UoaW5kZXgsIDEsIHJvdyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUudXBkYXRlVmlzaWJsZUV4cGFuZENvbGxhcHNlUm93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJvd3MgPSB0aGlzLmdldFJvd3NPYmplY3QoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJvd3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmICgocm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNEYXRhUm93IHx8IHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzQWdncmVnYXRlUm93KVxuICAgICAgICAgICAgICAgICYmIHRoaXMuZ2V0Um93RWxlbWVudEJ5VUlEKHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZClcbiAgICAgICAgICAgICAgICAmJiB0aGlzLmdldFJvd0VsZW1lbnRCeVVJRChyb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS51aWQpLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykge1xuICAgICAgICAgICAgICAgIHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBNZXRob2QgdG8gc2FuaXRpemUgYW55IHN1c3BlY3RlZCB1bnRydXN0ZWQgc3RyaW5ncyBhbmQgc2NyaXB0cyBiZWZvcmUgcmVuZGVyaW5nIHRoZW0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBTcGVjaWZpZXMgdGhlIGh0bWwgdmFsdWUgdG8gc2FuaXRpemVcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBzYW5pdGl6ZWQgaHRtbCBzdHJpbmdcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2FuaXRpemUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlSHRtbFNhbml0aXplcikge1xuICAgICAgICAgICAgcmV0dXJuIFNhbml0aXplSHRtbEhlbHBlci5zYW5pdGl6ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmcgfCBudW1iZXJ9IGhlaWdodCAtIHNwZWNpZmllcyB0aGUgaGVpZ2h0XG4gICAgICogQHJldHVybnMge251bWJlciB8IHN0cmluZ30gLSBzcGVjaWZpZXMgdGhlIGhlaWdodCBudW1iZXJcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKGhlaWdodCkge1xuICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoaGVpZ2h0KSAmJiBoZWlnaHQuaW5kZXhPZignJScpICE9PSAtMSkge1xuICAgICAgICAgICAgaGVpZ2h0ID0gcGFyc2VJbnQoaGVpZ2h0LCAxMCkgLyAxMDAgKiB0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGhlaWdodCkgJiYgdGhpcy5oZWlnaHQgIT09ICdhdXRvJykge1xuICAgICAgICAgICAgaGVpZ2h0ID0gcGFyc2VJbnQoaGVpZ2h0LCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmhlaWdodDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGVpZ2h0O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSAtIHJldHVybnMgZnJvemVuIHJpZ2h0IGNvbnRlbnRcblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEZyb3plblJpZ2h0Q29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudE1vZHVsZS5nZXRQYW5lbCgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSAtIHJldHVybnMgZnJvemVuIHJpZ2h0IGhlYWRlclxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RnJvemVuUmlnaHRIZWFkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhlYWRlck1vZHVsZS5nZXRQYW5lbCgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSAtIHJldHVybnMgbW92YWJsZSBoZWFkZXIgdGJvZHlcblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldE1vdmFibGVIZWFkZXJUYm9keSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SGVhZGVyQ29udGVudCgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSAtIHJldHVybnMgbW92YWJsZSBjb250ZW50IHRib2R5XG5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRNb3ZhYmxlQ29udGVudFRib2R5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRDb250ZW50KCkucXVlcnlTZWxlY3RvcihsaXRlcmFscy50Ym9keSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IC0gcmV0dXJucyBmcm96ZW4gaGVhZGVyIHRib2R5XG5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRGcm96ZW5IZWFkZXJUYm9keSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SGVhZGVyQ29udGVudCgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSAtIHJldHVybnMgZnJvemVuIGxlZnQgY29udGVudCB0Ym9keVxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RnJvemVuTGVmdENvbnRlbnRUYm9keSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSAtIHJldHVybnMgZnJvemVuIHJpZ2h0IGhlYWRlciB0Ym9keVxuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0RnJvemVuUmlnaHRIZWFkZXJUYm9keSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SGVhZGVyQ29udGVudCgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgZnJvemVuIHJpZ2h0IGNvbnRlbnQgdGJvZHlcblxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5nZXRGcm96ZW5SaWdodENvbnRlbnRUYm9keSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0N1c3RvbSAtIERlZmluZXMgY3VzdG9tIGZpbHRlciBkaWFsb2cgb3BlblxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zaG93UmVzcG9uc2l2ZUN1c3RvbUZpbHRlciA9IGZ1bmN0aW9uIChpc0N1c3RvbSkge1xuICAgICAgICBpZiAodGhpcy5maWx0ZXJNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyTW9kdWxlLnNob3dDdXN0b21GaWx0ZXIoaXNDdXN0b20gfHwgdGhpcy5yb3dSZW5kZXJpbmdNb2RlID09PSAnVmVydGljYWwnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0N1c3RvbSAtIERlZmluZXMgY3VzdG9tIHNvcnQgZGlhbG9nIG9wZW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2hvd1Jlc3BvbnNpdmVDdXN0b21Tb3J0ID0gZnVuY3Rpb24gKGlzQ3VzdG9tKSB7XG4gICAgICAgIGlmICh0aGlzLnNvcnRNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuc29ydE1vZHVsZS5zaG93Q3VzdG9tU29ydChpc0N1c3RvbSB8fCB0aGlzLnJvd1JlbmRlcmluZ01vZGUgPT09ICdWZXJ0aWNhbCcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzQ3VzdG9tIC0gRGVmaW5lcyBjdXN0b20gY29sdW1uIGNob29zZXIgZGlhbG9nIG9wZW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JpZC5wcm90b3R5cGUuc2hvd1Jlc3BvbnNpdmVDdXN0b21Db2x1bW5DaG9vc2VyID0gZnVuY3Rpb24gKGlzQ3VzdG9tKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbHVtbkNob29zZXJNb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuY29sdW1uQ2hvb3Nlck1vZHVsZS5zaG93Q3VzdG9tQ29sdW1uQ2hvb3Nlcihpc0N1c3RvbSB8fCB0aGlzLnJvd1JlbmRlcmluZ01vZGUgPT09ICdWZXJ0aWNhbCcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUbyBtYW51YWxseSBzaG93IHRoZSB2ZXJ0aWNhbCByb3cgbW9kZSBmaWx0ZXIgZGlhbG9nXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBHcmlkLnByb3RvdHlwZS5zaG93QWRhcHRpdmVGaWx0ZXJEaWFsb2cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUFkYXB0aXZlVUkpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd1Jlc3BvbnNpdmVDdXN0b21GaWx0ZXIodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRvIG1hbnVhbGx5IHNob3cgdGhlIHZlcnRpY2FsIHJvdyBzb3J0IGZpbHRlciBkaWFsb2dcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLnNob3dBZGFwdGl2ZVNvcnREaWFsb2cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUFkYXB0aXZlVUkpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd1Jlc3BvbnNpdmVDdXN0b21Tb3J0KHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzQ29sVmlydHVhbGl6YXRpb24gLSBEZWZpbmVzIGNvbHVtbiB2aXJ0dWFsaXphdGlvblxuICAgICAqIEByZXR1cm5zIHtDb2x1bW5bXX0gcmV0dXJucyBhcnJheSBvZiBjb2x1bW4gbW9kZWxzXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyaWQucHJvdG90eXBlLmdldEN1cnJlbnRWaXNpYmxlQ29sdW1ucyA9IGZ1bmN0aW9uIChpc0NvbFZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgIHZhciBjb2xzID0gW107XG4gICAgICAgIHZhciBncmlkQ29scyA9IGlzQ29sVmlydHVhbGl6YXRpb24gPyB0aGlzLmdldENvbHVtbnMoKSA6IHRoaXMuY29sdW1uTW9kZWw7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgZ3JpZENvbHNfMSA9IGdyaWRDb2xzOyBfaSA8IGdyaWRDb2xzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgY29sID0gZ3JpZENvbHNfMVtfaV07XG4gICAgICAgICAgICBpZiAoY29sLnZpc2libGUpIHtcbiAgICAgICAgICAgICAgICBjb2xzLnB1c2goY29sKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29scztcbiAgICB9O1xuICAgIEdyaWQucHJvdG90eXBlLmVuYWJsZUluZmluaXRlQWdncmdhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nICYmIHRoaXMuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAmJiAhdGhpcy5ncm91cFNldHRpbmdzLmRpc2FibGVQYWdlV2lzZUFnZ3JlZ2F0ZXNcbiAgICAgICAgICAgICYmICF0aGlzLmdyb3VwU2V0dGluZ3MuZW5hYmxlTGF6eUxvYWRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh7IGdyb3VwU2V0dGluZ3M6IHsgZGlzYWJsZVBhZ2VXaXNlQWdncmVnYXRlczogdHJ1ZSB9IH0sIHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgR3JpZF8xO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShbXSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjdXJyZW50Vmlld0RhdGFcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInBhcmVudERldGFpbHNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInNob3dIaWRlclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShbXSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjb2x1bW5zXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KHRydWUpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZW5hYmxlQWx0Um93XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KHRydWUpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZW5hYmxlSG92ZXJcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZW5hYmxlQXV0b0ZpbGxcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkodHJ1ZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJhbGxvd0tleWJvYXJkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImVuYWJsZVN0aWNreUhlYWRlclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJlbmFibGVIdG1sU2FuaXRpemVyXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImFsbG93VGV4dFdyYXBcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgQ29tcGxleCh7fSwgVGV4dFdyYXBTZXR0aW5ncylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJ0ZXh0V3JhcFNldHRpbmdzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIENvbXBsZXgoe30sIFJlc2l6ZVNldHRpbmdzKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInJlc2l6ZVNldHRpbmdzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImFsbG93UGFnaW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIENvbXBsZXgoe30sIFBhZ2VTZXR0aW5ncylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJwYWdlU2V0dGluZ3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgQ29tcGxleCh7fSwgTG9hZGluZ0luZGljYXRvcilcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJsb2FkaW5nSW5kaWNhdG9yXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KHRydWUpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZW5hYmxlVmlydHVhbE1hc2tSb3dcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZW5hYmxlVmlydHVhbGl6YXRpb25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZW5hYmxlSW5maW5pdGVTY3JvbGxpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgQ29tcGxleCh7fSwgU2VhcmNoU2V0dGluZ3MpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwic2VhcmNoU2V0dGluZ3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYWxsb3dTb3J0aW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KCdFbGxpcHNpcycpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY2xpcE1vZGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkodHJ1ZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJhbGxvd011bHRpU29ydGluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJhbGxvd0V4Y2VsRXhwb3J0XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImFsbG93UGRmRXhwb3J0XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIENvbXBsZXgoe30sIFNvcnRTZXR0aW5ncylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJzb3J0U2V0dGluZ3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgQ29tcGxleCh7fSwgSW5maW5pdGVTY3JvbGxTZXR0aW5ncylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJpbmZpbml0ZVNjcm9sbFNldHRpbmdzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KHRydWUpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYWxsb3dTZWxlY3Rpb25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoLTEpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwic2VsZWN0ZWRSb3dJbmRleFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBDb21wbGV4KHt9LCBTZWxlY3Rpb25TZXR0aW5ncylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJzZWxlY3Rpb25TZXR0aW5nc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJhbGxvd0ZpbHRlcmluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnSG9yaXpvbnRhbCcpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicm93UmVuZGVyaW5nTW9kZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJlbmFibGVBZGFwdGl2ZVVJXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KCdCb3RoJylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJhZGFwdGl2ZVVJTW9kZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJhbGxvd1Jlb3JkZXJpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYWxsb3dSZXNpemluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJhbGxvd1Jvd0RyYWdBbmREcm9wXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIENvbXBsZXgoe30sIFJvd0Ryb3BTZXR0aW5ncylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJyb3dEcm9wU2V0dGluZ3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgQ29tcGxleCh7fSwgRmlsdGVyU2V0dGluZ3MpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZmlsdGVyU2V0dGluZ3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYWxsb3dHcm91cGluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJlbmFibGVJbW11dGFibGVNb2RlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInNob3dDb2x1bW5NZW51XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImF1dG9GaXRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgQ29tcGxleCh7fSwgR3JvdXBTZXR0aW5ncylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJncm91cFNldHRpbmdzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIENvbXBsZXgoe30sIEVkaXRTZXR0aW5ncylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJlZGl0U2V0dGluZ3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgQ29sbGVjdGlvbihbXSwgQWdncmVnYXRlUm93KVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImFnZ3JlZ2F0ZXNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwic2hvd0NvbHVtbkNob29zZXJcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgQ29tcGxleCh7fSwgQ29sdW1uQ2hvb3NlclNldHRpbmdzKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImNvbHVtbkNob29zZXJTZXR0aW5nc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJlbmFibGVIZWFkZXJGb2N1c1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnYXV0bycpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiaGVpZ2h0XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KCdhdXRvJylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJ3aWR0aFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnRGVmYXVsdCcpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZ3JpZExpbmVzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJyb3dUZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZW1wdHlSZWNvcmRUZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZGV0YWlsVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImNoaWxkR3JpZFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicXVlcnlTdHJpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ0FsbFBhZ2VzJylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJwcmludE1vZGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ0V4cGFuZGVkJylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJoaWVyYXJjaHlQcmludE1vZGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoW10pXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZGF0YVNvdXJjZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShudWxsKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInJvd0hlaWdodFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicXVlcnlcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoJ1VTRCcpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY3VycmVuY3lDb2RlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJleHBvcnRHcmlkc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwidG9vbGJhclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY29udGV4dE1lbnVJdGVtc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY29sdW1uTWVudUl0ZW1zXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJ0b29sYmFyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInBhZ2VyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoMClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJmcm96ZW5Sb3dzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KDApXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZnJvemVuQ29sdW1uc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnJylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjc3NDbGFzc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnQWxsJylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjb2x1bW5RdWVyeU1vZGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoe30pXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY3VycmVudEFjdGlvblwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnJylcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJlajJTdGF0ZVBlcnNpc3RlbmNlVmVyc2lvblwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY3JlYXRlZFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZGVzdHJveWVkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJsb2FkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJyb3dEYXRhQm91bmRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInF1ZXJ5Q2VsbEluZm9cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImhlYWRlckNlbGxJbmZvXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJhY3Rpb25CZWdpblwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYWN0aW9uQ29tcGxldGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImFjdGlvbkZhaWx1cmVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImRhdGFCb3VuZFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicmVjb3JkRG91YmxlQ2xpY2tcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInJlY29yZENsaWNrXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJyb3dTZWxlY3RpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInJvd1NlbGVjdGVkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJyb3dEZXNlbGVjdGluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicm93RGVzZWxlY3RlZFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY2VsbFNlbGVjdGluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY2VsbFNlbGVjdGVkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjZWxsRGVzZWxlY3RpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImNlbGxEZXNlbGVjdGVkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjb2x1bW5TZWxlY3RpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImNvbHVtblNlbGVjdGVkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjb2x1bW5EZXNlbGVjdGluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY29sdW1uRGVzZWxlY3RlZFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY29sdW1uRHJhZ1N0YXJ0XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjb2x1bW5EcmFnXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjb2x1bW5Ecm9wXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJwcmludENvbXBsZXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJiZWZvcmVQcmludFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicGRmUXVlcnlDZWxsSW5mb1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicGRmSGVhZGVyUXVlcnlDZWxsSW5mb1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicGRmQWdncmVnYXRlUXVlcnlDZWxsSW5mb1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZXhjZWxBZ2dyZWdhdGVRdWVyeUNlbGxJbmZvXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJleHBvcnREZXRhaWxEYXRhQm91bmRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImV4cG9ydERldGFpbFRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJleGNlbFF1ZXJ5Q2VsbEluZm9cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImV4Y2VsSGVhZGVyUXVlcnlDZWxsSW5mb1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYmVmb3JlRXhjZWxFeHBvcnRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImV4Y2VsRXhwb3J0Q29tcGxldGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImJlZm9yZVBkZkV4cG9ydFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicGRmRXhwb3J0Q29tcGxldGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInJvd0RyYWdTdGFydEhlbHBlclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiZGV0YWlsRGF0YUJvdW5kXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJyb3dEcmFnU3RhcnRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInJvd0RyYWdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInJvd0Ryb3BcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInRvb2xiYXJDbGlja1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYmVmb3JlT3BlbkNvbHVtbkNob29zZXJcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImJlZm9yZU9wZW5BZGFwdGl2ZURpYWxvZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYmF0Y2hBZGRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImJhdGNoRGVsZXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJiYXRjaENhbmNlbFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYmVmb3JlQmF0Y2hBZGRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImJlZm9yZUJhdGNoRGVsZXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJiZWZvcmVCYXRjaFNhdmVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImJlZ2luRWRpdFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY29tbWFuZENsaWNrXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJjZWxsRWRpdFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY2VsbFNhdmVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImNlbGxTYXZlZFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwicmVzaXplU3RhcnRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcInJlc2l6aW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJyZXNpemVTdG9wXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJrZXlQcmVzc2VkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJiZWZvcmVEYXRhQm91bmRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImNvbnRleHRNZW51T3BlblwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY29udGV4dE1lbnVDbGlja1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY29sdW1uTWVudU9wZW5cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImNvbHVtbk1lbnVDbGlja1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY2hlY2tCb3hDaGFuZ2VcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImJlZm9yZUNvcHlcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImJlZm9yZVBhc3RlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJiZWZvcmVBdXRvRmlsbFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiY29sdW1uRGF0YVN0YXRlQ2hhbmdlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJkYXRhU3RhdGVDaGFuZ2VcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImRhdGFTb3VyY2VDaGFuZ2VkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIEV2ZW50KClcbiAgICBdLCBHcmlkLnByb3RvdHlwZSwgXCJleHBvcnRHcm91cENhcHRpb25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImxhenlMb2FkR3JvdXBFeHBhbmRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgRXZlbnQoKVxuICAgIF0sIEdyaWQucHJvdG90eXBlLCBcImxhenlMb2FkR3JvdXBDb2xsYXBzZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgR3JpZC5wcm90b3R5cGUsIFwiYmVmb3JlRGV0YWlsVGVtcGxhdGVEZXRhY2hcIiwgdm9pZCAwKTtcbiAgICBHcmlkID0gR3JpZF8xID0gX19kZWNvcmF0ZShbXG4gICAgICAgIE5vdGlmeVByb3BlcnR5Q2hhbmdlc1xuICAgIF0sIEdyaWQpO1xuICAgIHJldHVybiBHcmlkO1xufShDb21wb25lbnQpKTtcbmV4cG9ydCB7IEdyaWQgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/grid.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addedRecords: () => (/* binding */ addedRecords),\n/* harmony export */   addedRow: () => (/* binding */ addedRow),\n/* harmony export */   ariaColIndex: () => (/* binding */ ariaColIndex),\n/* harmony export */   ariaRowIndex: () => (/* binding */ ariaRowIndex),\n/* harmony export */   beforeOpen: () => (/* binding */ beforeOpen),\n/* harmony export */   change: () => (/* binding */ change),\n/* harmony export */   changedRecords: () => (/* binding */ changedRecords),\n/* harmony export */   colGroup: () => (/* binding */ colGroup),\n/* harmony export */   content: () => (/* binding */ content),\n/* harmony export */   create: () => (/* binding */ create),\n/* harmony export */   deletedRecords: () => (/* binding */ deletedRecords),\n/* harmony export */   downArrow: () => (/* binding */ downArrow),\n/* harmony export */   editedRow: () => (/* binding */ editedRow),\n/* harmony export */   enter: () => (/* binding */ enter),\n/* harmony export */   focus: () => (/* binding */ focus),\n/* harmony export */   frozenContent: () => (/* binding */ frozenContent),\n/* harmony export */   frozenHeader: () => (/* binding */ frozenHeader),\n/* harmony export */   frozenLeft: () => (/* binding */ frozenLeft),\n/* harmony export */   frozenRight: () => (/* binding */ frozenRight),\n/* harmony export */   gridChkBox: () => (/* binding */ gridChkBox),\n/* harmony export */   gridContent: () => (/* binding */ gridContent),\n/* harmony export */   gridFooter: () => (/* binding */ gridFooter),\n/* harmony export */   gridHeader: () => (/* binding */ gridHeader),\n/* harmony export */   groupCaptionRow: () => (/* binding */ groupCaptionRow),\n/* harmony export */   headerContent: () => (/* binding */ headerContent),\n/* harmony export */   initialFrozenColumnIndex: () => (/* binding */ initialFrozenColumnIndex),\n/* harmony export */   leftRight: () => (/* binding */ leftRight),\n/* harmony export */   movableContent: () => (/* binding */ movableContent),\n/* harmony export */   movableHeader: () => (/* binding */ movableHeader),\n/* harmony export */   open: () => (/* binding */ open),\n/* harmony export */   pageDown: () => (/* binding */ pageDown),\n/* harmony export */   pageUp: () => (/* binding */ pageUp),\n/* harmony export */   row: () => (/* binding */ row),\n/* harmony export */   rowCell: () => (/* binding */ rowCell),\n/* harmony export */   shiftEnter: () => (/* binding */ shiftEnter),\n/* harmony export */   shiftTab: () => (/* binding */ shiftTab),\n/* harmony export */   tab: () => (/* binding */ tab),\n/* harmony export */   table: () => (/* binding */ table),\n/* harmony export */   tbody: () => (/* binding */ tbody),\n/* harmony export */   upArrow: () => (/* binding */ upArrow)\n/* harmony export */ });\n/**\n * Specifies class names\n */\n/** @hidden */\nvar rowCell = 'e-rowcell';\n/** @hidden */\nvar gridHeader = 'e-gridheader';\n/** @hidden */\nvar gridContent = 'e-gridcontent';\n/** @hidden */\nvar gridFooter = 'e-gridfooter';\n/** @hidden */\nvar headerContent = 'e-headercontent';\n/** @hidden */\nvar movableContent = 'e-movablecontent';\n/** @hidden */\nvar movableHeader = 'e-movableheader';\n/** @hidden */\nvar frozenContent = 'e-frozencontent';\n/** @hidden */\nvar frozenHeader = 'e-frozenheader';\n/** @hidden */\nvar content = 'e-content';\n/** @hidden */\nvar table = 'e-table';\n/** @hidden */\nvar row = 'e-row';\n/** @hidden */\nvar gridChkBox = 'e-gridchkbox';\n/** @hidden */\nvar editedRow = 'e-editedrow';\n/** @hidden */\nvar addedRow = 'e-addedrow';\n/** @hidden */\nvar groupCaptionRow = 'e-groupcaptionrow';\n/**\n * Specifies repeated strings\n */\n/** @hidden */\nvar changedRecords = 'changedRecords';\n/** @hidden */\nvar addedRecords = 'addedRecords';\n/** @hidden */\nvar deletedRecords = 'deletedRecords';\n/** @hidden */\nvar leftRight = 'Left-Right';\n/** @hidden */\nvar frozenRight = 'frozen-right';\n/** @hidden */\nvar frozenLeft = 'frozen-left';\n/** @hidden */\nvar ariaColIndex = 'aria-colindex';\n/** @hidden */\nvar ariaRowIndex = 'aria-rowindex';\n/** @hidden */\nvar tbody = 'tbody';\n/** @hidden */\nvar colGroup = 'colgroup';\n/** @hidden */\nvar open = 'open';\n/** @hidden */\nvar change = 'change';\n/** @hidden */\nvar focus = 'focus';\n/** @hidden */\nvar create = 'created';\n/** @hidden */\nvar beforeOpen = 'beforeOpen';\n/** @hidden */\nvar downArrow = 'downArrow';\n/** @hidden */\nvar upArrow = 'upArrow';\n/** @hidden */\nvar pageUp = 'PageUp';\n/** @hidden */\nvar pageDown = 'PageDown';\n/** @hidden */\nvar enter = 'enter';\n/** @hidden */\nvar shiftEnter = 'shiftEnter';\n/** @hidden */\nvar tab = 'tab';\n/** @hidden */\nvar shiftTab = 'shiftTab';\n/** @hidden */\nvar initialFrozenColumnIndex = 'initialFrozenColumnIndex';\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9iYXNlL3N0cmluZy1saXRlcmFscy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTztBQUNQO0FBQ087QUFDUDtBQUNPO0FBQ1A7QUFDTyIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL2Jhc2Uvc3RyaW5nLWxpdGVyYWxzLmpzPzk1NmMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTcGVjaWZpZXMgY2xhc3MgbmFtZXNcbiAqL1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgcm93Q2VsbCA9ICdlLXJvd2NlbGwnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZ3JpZEhlYWRlciA9ICdlLWdyaWRoZWFkZXInO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgZ3JpZENvbnRlbnQgPSAnZS1ncmlkY29udGVudCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBncmlkRm9vdGVyID0gJ2UtZ3JpZGZvb3Rlcic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBoZWFkZXJDb250ZW50ID0gJ2UtaGVhZGVyY29udGVudCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBtb3ZhYmxlQ29udGVudCA9ICdlLW1vdmFibGVjb250ZW50Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIG1vdmFibGVIZWFkZXIgPSAnZS1tb3ZhYmxlaGVhZGVyJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZyb3plbkNvbnRlbnQgPSAnZS1mcm96ZW5jb250ZW50Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZyb3plbkhlYWRlciA9ICdlLWZyb3plbmhlYWRlcic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjb250ZW50ID0gJ2UtY29udGVudCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB0YWJsZSA9ICdlLXRhYmxlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHJvdyA9ICdlLXJvdyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBncmlkQ2hrQm94ID0gJ2UtZ3JpZGNoa2JveCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBlZGl0ZWRSb3cgPSAnZS1lZGl0ZWRyb3cnO1xuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCB2YXIgYWRkZWRSb3cgPSAnZS1hZGRlZHJvdyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBncm91cENhcHRpb25Sb3cgPSAnZS1ncm91cGNhcHRpb25yb3cnO1xuLyoqXG4gKiBTcGVjaWZpZXMgcmVwZWF0ZWQgc3RyaW5nc1xuICovXG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjaGFuZ2VkUmVjb3JkcyA9ICdjaGFuZ2VkUmVjb3Jkcyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBhZGRlZFJlY29yZHMgPSAnYWRkZWRSZWNvcmRzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGRlbGV0ZWRSZWNvcmRzID0gJ2RlbGV0ZWRSZWNvcmRzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGxlZnRSaWdodCA9ICdMZWZ0LVJpZ2h0Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZyb3plblJpZ2h0ID0gJ2Zyb3plbi1yaWdodCc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBmcm96ZW5MZWZ0ID0gJ2Zyb3plbi1sZWZ0Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGFyaWFDb2xJbmRleCA9ICdhcmlhLWNvbGluZGV4Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGFyaWFSb3dJbmRleCA9ICdhcmlhLXJvd2luZGV4Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHRib2R5ID0gJ3Rib2R5Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNvbEdyb3VwID0gJ2NvbGdyb3VwJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIG9wZW4gPSAnb3Blbic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBjaGFuZ2UgPSAnY2hhbmdlJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGZvY3VzID0gJ2ZvY3VzJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGNyZWF0ZSA9ICdjcmVhdGVkJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGJlZm9yZU9wZW4gPSAnYmVmb3JlT3Blbic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBkb3duQXJyb3cgPSAnZG93bkFycm93Jztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHVwQXJyb3cgPSAndXBBcnJvdyc7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciBwYWdlVXAgPSAnUGFnZVVwJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHBhZ2VEb3duID0gJ1BhZ2VEb3duJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGVudGVyID0gJ2VudGVyJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHNoaWZ0RW50ZXIgPSAnc2hpZnRFbnRlcic7XG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IHZhciB0YWIgPSAndGFiJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIHNoaWZ0VGFiID0gJ3NoaWZ0VGFiJztcbi8qKiBAaGlkZGVuICovXG5leHBvcnQgdmFyIGluaXRpYWxGcm96ZW5Db2x1bW5JbmRleCA9ICdpbml0aWFsRnJvemVuQ29sdW1uSW5kZXgnO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Global: () => (/* binding */ Global),\n/* harmony export */   addBiggerDialog: () => (/* binding */ addBiggerDialog),\n/* harmony export */   addFixedColumnBorder: () => (/* binding */ addFixedColumnBorder),\n/* harmony export */   addRemoveActiveClasses: () => (/* binding */ addRemoveActiveClasses),\n/* harmony export */   addRemoveEventListener: () => (/* binding */ addRemoveEventListener),\n/* harmony export */   addStickyColumnPosition: () => (/* binding */ addStickyColumnPosition),\n/* harmony export */   appendChildren: () => (/* binding */ appendChildren),\n/* harmony export */   applyBiggerTheme: () => (/* binding */ applyBiggerTheme),\n/* harmony export */   applyStickyLeftRightPosition: () => (/* binding */ applyStickyLeftRightPosition),\n/* harmony export */   calculateAggregate: () => (/* binding */ calculateAggregate),\n/* harmony export */   capitalizeFirstLetter: () => (/* binding */ capitalizeFirstLetter),\n/* harmony export */   checkDepth: () => (/* binding */ checkDepth),\n/* harmony export */   checkIsVirtual: () => (/* binding */ checkIsVirtual),\n/* harmony export */   clearReactVueTemplates: () => (/* binding */ clearReactVueTemplates),\n/* harmony export */   compareChanges: () => (/* binding */ compareChanges),\n/* harmony export */   createCboxWithWrap: () => (/* binding */ createCboxWithWrap),\n/* harmony export */   createEditElement: () => (/* binding */ createEditElement),\n/* harmony export */   distinctStringValues: () => (/* binding */ distinctStringValues),\n/* harmony export */   doesImplementInterface: () => (/* binding */ doesImplementInterface),\n/* harmony export */   ensureFirstRow: () => (/* binding */ ensureFirstRow),\n/* harmony export */   ensureLastRow: () => (/* binding */ ensureLastRow),\n/* harmony export */   eventPromise: () => (/* binding */ eventPromise),\n/* harmony export */   extend: () => (/* binding */ extend),\n/* harmony export */   extendObjWithFn: () => (/* binding */ extendObjWithFn),\n/* harmony export */   findCellIndex: () => (/* binding */ findCellIndex),\n/* harmony export */   frozenDirection: () => (/* binding */ frozenDirection),\n/* harmony export */   generateExpandPredicates: () => (/* binding */ generateExpandPredicates),\n/* harmony export */   getActualPropFromColl: () => (/* binding */ getActualPropFromColl),\n/* harmony export */   getActualProperties: () => (/* binding */ getActualProperties),\n/* harmony export */   getActualRowHeight: () => (/* binding */ getActualRowHeight),\n/* harmony export */   getCellByColAndRowIndex: () => (/* binding */ getCellByColAndRowIndex),\n/* harmony export */   getCellFromRow: () => (/* binding */ getCellFromRow),\n/* harmony export */   getCellsByTableName: () => (/* binding */ getCellsByTableName),\n/* harmony export */   getCollapsedRowsCount: () => (/* binding */ getCollapsedRowsCount),\n/* harmony export */   getColumnByForeignKeyValue: () => (/* binding */ getColumnByForeignKeyValue),\n/* harmony export */   getColumnModelByFieldName: () => (/* binding */ getColumnModelByFieldName),\n/* harmony export */   getColumnModelByUid: () => (/* binding */ getColumnModelByUid),\n/* harmony export */   getComplexFieldID: () => (/* binding */ getComplexFieldID),\n/* harmony export */   getCustomDateFormat: () => (/* binding */ getCustomDateFormat),\n/* harmony export */   getDatePredicate: () => (/* binding */ getDatePredicate),\n/* harmony export */   getEditedDataIndex: () => (/* binding */ getEditedDataIndex),\n/* harmony export */   getElementIndex: () => (/* binding */ getElementIndex),\n/* harmony export */   getExpandedState: () => (/* binding */ getExpandedState),\n/* harmony export */   getFilterMenuPostion: () => (/* binding */ getFilterMenuPostion),\n/* harmony export */   getForeignData: () => (/* binding */ getForeignData),\n/* harmony export */   getGroupKeysAndFields: () => (/* binding */ getGroupKeysAndFields),\n/* harmony export */   getListHeight: () => (/* binding */ getListHeight),\n/* harmony export */   getNumberFormat: () => (/* binding */ getNumberFormat),\n/* harmony export */   getObject: () => (/* binding */ getObject),\n/* harmony export */   getParentIns: () => (/* binding */ getParentIns),\n/* harmony export */   getParsedFieldID: () => (/* binding */ getParsedFieldID),\n/* harmony export */   getPosition: () => (/* binding */ getPosition),\n/* harmony export */   getPredicates: () => (/* binding */ getPredicates),\n/* harmony export */   getPrintGridModel: () => (/* binding */ getPrintGridModel),\n/* harmony export */   getPrototypesOfObj: () => (/* binding */ getPrototypesOfObj),\n/* harmony export */   getRowHeight: () => (/* binding */ getRowHeight),\n/* harmony export */   getRowIndexFromElement: () => (/* binding */ getRowIndexFromElement),\n/* harmony export */   getScrollBarWidth: () => (/* binding */ getScrollBarWidth),\n/* harmony export */   getScrollWidth: () => (/* binding */ getScrollWidth),\n/* harmony export */   getStateEventArgument: () => (/* binding */ getStateEventArgument),\n/* harmony export */   getTransformValues: () => (/* binding */ getTransformValues),\n/* harmony export */   getUid: () => (/* binding */ getUid),\n/* harmony export */   getUpdateUsingRaf: () => (/* binding */ getUpdateUsingRaf),\n/* harmony export */   getVisiblePage: () => (/* binding */ getVisiblePage),\n/* harmony export */   getZIndexCalcualtion: () => (/* binding */ getZIndexCalcualtion),\n/* harmony export */   groupCaptionRowLeftRightPos: () => (/* binding */ groupCaptionRowLeftRightPos),\n/* harmony export */   groupReorderRowObject: () => (/* binding */ groupReorderRowObject),\n/* harmony export */   headerValueAccessor: () => (/* binding */ headerValueAccessor),\n/* harmony export */   inArray: () => (/* binding */ inArray),\n/* harmony export */   infiniteAppendElements: () => (/* binding */ infiniteAppendElements),\n/* harmony export */   infiniteRemoveElements: () => (/* binding */ infiniteRemoveElements),\n/* harmony export */   isActionPrevent: () => (/* binding */ isActionPrevent),\n/* harmony export */   isCellHaveWidth: () => (/* binding */ isCellHaveWidth),\n/* harmony export */   isChildColumn: () => (/* binding */ isChildColumn),\n/* harmony export */   isComplexField: () => (/* binding */ isComplexField),\n/* harmony export */   isEditable: () => (/* binding */ isEditable),\n/* harmony export */   isExportColumns: () => (/* binding */ isExportColumns),\n/* harmony export */   isGroupAdaptive: () => (/* binding */ isGroupAdaptive),\n/* harmony export */   isRowEnteredInGrid: () => (/* binding */ isRowEnteredInGrid),\n/* harmony export */   ispercentageWidth: () => (/* binding */ ispercentageWidth),\n/* harmony export */   iterateArrayOrObject: () => (/* binding */ iterateArrayOrObject),\n/* harmony export */   iterateExtend: () => (/* binding */ iterateExtend),\n/* harmony export */   measureColumnDepth: () => (/* binding */ measureColumnDepth),\n/* harmony export */   padZero: () => (/* binding */ padZero),\n/* harmony export */   parents: () => (/* binding */ parents),\n/* harmony export */   parentsUntil: () => (/* binding */ parentsUntil),\n/* harmony export */   performComplexDataOperation: () => (/* binding */ performComplexDataOperation),\n/* harmony export */   prepareColumns: () => (/* binding */ prepareColumns),\n/* harmony export */   pushuid: () => (/* binding */ pushuid),\n/* harmony export */   recursive: () => (/* binding */ recursive),\n/* harmony export */   refreshFilteredColsUid: () => (/* binding */ refreshFilteredColsUid),\n/* harmony export */   refreshForeignData: () => (/* binding */ refreshForeignData),\n/* harmony export */   registerEventHandlers: () => (/* binding */ registerEventHandlers),\n/* harmony export */   removeAddCboxClasses: () => (/* binding */ removeAddCboxClasses),\n/* harmony export */   removeElement: () => (/* binding */ removeElement),\n/* harmony export */   removeEventHandlers: () => (/* binding */ removeEventHandlers),\n/* harmony export */   resetCachedRowIndex: () => (/* binding */ resetCachedRowIndex),\n/* harmony export */   resetColandRowSpanStickyPosition: () => (/* binding */ resetColandRowSpanStickyPosition),\n/* harmony export */   resetColspanGroupCaption: () => (/* binding */ resetColspanGroupCaption),\n/* harmony export */   resetDialogAppend: () => (/* binding */ resetDialogAppend),\n/* harmony export */   resetRowIndex: () => (/* binding */ resetRowIndex),\n/* harmony export */   setChecked: () => (/* binding */ setChecked),\n/* harmony export */   setColumnIndex: () => (/* binding */ setColumnIndex),\n/* harmony export */   setComplexFieldID: () => (/* binding */ setComplexFieldID),\n/* harmony export */   setCssInGridPopUp: () => (/* binding */ setCssInGridPopUp),\n/* harmony export */   setDisplayValue: () => (/* binding */ setDisplayValue),\n/* harmony export */   setFormatter: () => (/* binding */ setFormatter),\n/* harmony export */   setRowElements: () => (/* binding */ setRowElements),\n/* harmony export */   setStyleAndAttributes: () => (/* binding */ setStyleAndAttributes),\n/* harmony export */   setValidationRuels: () => (/* binding */ setValidationRuels),\n/* harmony export */   sliceElements: () => (/* binding */ sliceElements),\n/* harmony export */   templateCompiler: () => (/* binding */ templateCompiler),\n/* harmony export */   toggleFilterUI: () => (/* binding */ toggleFilterUI),\n/* harmony export */   toogleCheckbox: () => (/* binding */ toogleCheckbox),\n/* harmony export */   updateColumnTypeForExportColumns: () => (/* binding */ updateColumnTypeForExportColumns),\n/* harmony export */   updatecloneRow: () => (/* binding */ updatecloneRow),\n/* harmony export */   valueAccessor: () => (/* binding */ valueAccessor),\n/* harmony export */   wrap: () => (/* binding */ wrap)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/util.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/query.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/manager.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/adaptors.js\");\n/* harmony import */ var _models_column__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../models/column */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column.js\");\n/* harmony import */ var _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-popups */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-popups@29.1.37/node_modules/@syncfusion/ej2-popups/src/common/position.js\");\n/* harmony import */ var _actions_print__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../actions/print */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/print.js\");\n/* harmony import */ var _common_checkbox_filter_base__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common/checkbox-filter-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/common/checkbox-filter-base.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n\n\n\n\n//https://typescript.codeplex.com/discussions/401501\n/**\n * Function to check whether target object implement specific interface\n *\n * @param  {Object} target - specifies the target\n * @param  {string} checkFor - specifies the checkfors\n * @returns {boolean} returns the boolean\n * @hidden\n */\nfunction doesImplementInterface(target, checkFor) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return target.prototype && checkFor in target.prototype;\n}\n/**\n * Function to get value from provided data\n *\n * @param  {string} field - specifies the field\n * @param  {Object} data - specifies the data\n * @param  {ColumnModel} column - specifies the column\n * @returns {Object} returns the object\n * @hidden\n */\n// eslint-disable-next-line\nfunction valueAccessor(field, data, column) {\n    return ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(field) || field === '') ? '' : _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.DataUtil.getObject(field, data);\n}\n/**\n * Defines the method used to apply custom header cell values from external function and display this on each header cell rendered.\n *\n * @param  {string} field - specifies the field\n * @param  {ColumnModel} column - specifies the column\n * @returns {object} headerValueAccessor\n * @hidden\n */\nfunction headerValueAccessor(field, column) {\n    return ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(field) || field === '') ? '' : _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.DataUtil.getObject(field, column);\n}\n/**\n * The function used to update Dom using requestAnimationFrame.\n *\n * @param {Function} updateFunction - Function that contains the actual action\n * @param {object} callBack - defines the callback\n * @returns {void}\n * @hidden\n */\n// eslint-disable-next-line\nfunction getUpdateUsingRaf(updateFunction, callBack) {\n    requestAnimationFrame(function () {\n        try {\n            callBack(null, updateFunction());\n        }\n        catch (e) {\n            callBack(e);\n        }\n    });\n}\n/**\n * @hidden\n * @param {PdfExportProperties | ExcelExportProperties} exportProperties - Defines the export properties\n * @returns {boolean} Returns isExportColumns\n */\nfunction isExportColumns(exportProperties) {\n    return !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(exportProperties) &&\n        !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(exportProperties.columns) && exportProperties.columns.length > 0;\n}\n/**\n * @param {PdfExportProperties | ExcelExportProperties} exportProperties - Defines the export properties\n * @param {IGrid} gObj - Defines the grid object\n * @returns {void}\n * @hidden\n */\nfunction updateColumnTypeForExportColumns(exportProperties, gObj) {\n    var exportColumns = exportProperties.columns;\n    var gridColumns = gObj.columns;\n    for (var i = 0; i < exportColumns.length; i++) {\n        if (gridColumns.length - 1 >= i) {\n            if (gridColumns[parseInt(i.toString(), 10)].columns) {\n                for (var j = 0; j < gridColumns[parseInt(i.toString(), 10)].columns.length; j++) {\n                    exportColumns[parseInt(i.toString(), 10)].columns[parseInt(j.toString(), 10)]\n                        .type = gridColumns[parseInt(i.toString(), 10)].columns[parseInt(j.toString(), 10)].type;\n                }\n            }\n            else {\n                exportColumns[parseInt(i.toString(), 10)].type = gridColumns[parseInt(i.toString(), 10)].type;\n            }\n        }\n    }\n}\n/**\n * @hidden\n * @param {IGrid} grid - Defines the grid\n * @returns {void}\n */\nfunction updatecloneRow(grid) {\n    var nRows = [];\n    var actualRows = grid.vRows;\n    for (var i = 0; i < actualRows.length; i++) {\n        if (actualRows[parseInt(i.toString(), 10)].isDataRow) {\n            nRows.push(actualRows[parseInt(i.toString(), 10)]);\n        }\n        else if (!actualRows[parseInt(i.toString(), 10)].isDataRow) {\n            nRows.push(actualRows[parseInt(i.toString(), 10)]);\n            if (!actualRows[parseInt(i.toString(), 10)].isExpand && actualRows[parseInt(i.toString(), 10)].isCaptionRow) {\n                i += getCollapsedRowsCount(actualRows[parseInt(i.toString(), 10)], grid);\n            }\n        }\n    }\n    grid.vcRows = nRows;\n}\nvar count = 0;\n/**\n * @hidden\n * @param {Row<Column>} val - Defines the value\n * @param {IGrid} grid - Defines the grid\n * @returns {number} Returns the collapsed row count\n */\nfunction getCollapsedRowsCount(val, grid) {\n    count = 0;\n    var gSummary = 'gSummary';\n    var total = 'count';\n    var gLen = grid.groupSettings.columns.length;\n    var records = 'records';\n    var items = 'items';\n    var value = val[\"\" + gSummary];\n    var dataRowCnt = 0;\n    var agrCnt = 'aggregatesCount';\n    if (value === val.data[\"\" + total]) {\n        if (grid.groupSettings.columns.length && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(val[\"\" + agrCnt]) && val[\"\" + agrCnt]) {\n            if (grid.groupSettings.columns.length !== 1) {\n                count += (val.indent !== 0 && (value) < 2) ? (val[\"\" + gSummary] * ((gLen - val.indent) + (gLen - val.indent) * val[\"\" + agrCnt])) :\n                    (val[\"\" + gSummary] * ((gLen - val.indent) + (gLen - val.indent - 1) * val[\"\" + agrCnt])) + val[\"\" + agrCnt];\n            }\n            else if (grid.groupSettings.columns.length === 1) {\n                count += (val[\"\" + gSummary] * (gLen - val.indent)) + val[\"\" + agrCnt];\n            }\n        }\n        else if (grid.groupSettings.columns.length) {\n            if (grid.groupSettings.columns.length !== 1) {\n                count += val[\"\" + gSummary] * (grid.groupSettings.columns.length - val.indent);\n            }\n            else {\n                count += val[\"\" + gSummary];\n            }\n        }\n        return count;\n    }\n    else {\n        for (var i = 0, len = val.data[\"\" + items].length; i < len; i++) {\n            var gLevel = val.data[\"\" + items][parseInt(i.toString(), 10)];\n            count += gLevel[\"\" + items].length + ((gLen !== grid.columns.length) &&\n                !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gLevel[\"\" + items][\"\" + records]) ? gLevel[\"\" + items][\"\" + records].length : 0);\n            dataRowCnt += (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gLevel[\"\" + items][\"\" + records]) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(val[\"\" + agrCnt])) ? gLevel[\"\" + items][\"\" + records].length :\n                gLevel[\"\" + items].length;\n            if (gLevel[\"\" + items].GroupGuid && gLevel[\"\" + items].childLevels !== 0) {\n                recursive(gLevel);\n            }\n        }\n        count += val.data[\"\" + items].length;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(val[\"\" + agrCnt])) {\n            if (val[\"\" + agrCnt] && count && dataRowCnt !== 0) {\n                count += ((count - dataRowCnt) * val[\"\" + agrCnt]) + val[\"\" + agrCnt];\n            }\n        }\n    }\n    return count;\n}\n/**\n * @param {Object[]} row - Defines the row\n * @returns {void}\n * @hidden\n */\nfunction recursive(row) {\n    var items = 'items';\n    var rCount = 'count';\n    for (var j = 0, length_1 = row[\"\" + items].length; j < length_1; j++) {\n        var nLevel = row[\"\" + items][parseInt(j.toString(), 10)];\n        count += nLevel[\"\" + rCount];\n        if (nLevel[\"\" + items].childLevels !== 0) {\n            recursive(nLevel);\n        }\n    }\n}\n/**\n * @param {Object[]} collection - Defines the array\n * @param {Object} predicate - Defines the predicate\n * @returns {Object} Returns the object\n * @hidden\n */\nfunction iterateArrayOrObject(collection, predicate) {\n    var result = [];\n    for (var i = 0, len = collection.length; i < len; i++) {\n        var pred = predicate(collection[parseInt(i.toString(), 10)], i);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(pred)) {\n            result.push(pred);\n        }\n    }\n    return result;\n}\n/**\n * @param {Object[]} array - Defines the array\n * @returns {Object} Returns the object\n * @hidden\n */\nfunction iterateExtend(array) {\n    var obj = [];\n    for (var i = 0; i < array.length; i++) {\n        obj.push((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, getActualProperties(array[parseInt(i.toString(), 10)]), {}, true));\n    }\n    return obj;\n}\n/**\n * @param {string | Function} template - Defines the template\n * @returns {Function} Returns the function\n * @hidden\n */\nfunction templateCompiler(template) {\n    if (template) {\n        try {\n            var validSelector = template[0] !== '<';\n            if (typeof template === 'function') {\n                return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(template);\n            }\n            else if (validSelector && document.querySelectorAll(template).length) {\n                return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(document.querySelector(template).innerHTML.trim());\n            }\n            else {\n                return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(template);\n            }\n        }\n        catch (e) {\n            return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(template);\n        }\n    }\n    return undefined;\n}\n/**\n * @param {Element} node - Defines the column\n * @param {Object} customAttributes - Defines the index\n * @returns {void}\n * @hidden\n */\nfunction setStyleAndAttributes(node, customAttributes) {\n    var copyAttr = {};\n    var literals = ['style', 'class'];\n    //Dont touch the original object - make a copy\n    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(copyAttr, customAttributes, {});\n    if ('style' in copyAttr) {\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setStyleAttribute)(node, copyAttr[literals[0]]);\n        delete copyAttr[literals[0]];\n    }\n    if ('class' in copyAttr) {\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([node], copyAttr[literals[1]]);\n        delete copyAttr[literals[1]];\n    }\n    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(node, copyAttr);\n}\n/**\n * @param {Object} copied - Defines the column\n * @param {Object} first - Defines the inndex\n * @param {Object} second - Defines the second object\n * @param {string[]} exclude - Defines the exclude\n * @returns {Object} Returns the object\n * @hidden\n */\nfunction extend(copied, first, second, exclude) {\n    var moved = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(copied, first, second);\n    var values = Object.keys(moved);\n    for (var i = 0; i < values.length; i++) {\n        if (exclude && exclude.indexOf(values[parseInt(i.toString(), 10)]) !== -1) {\n            delete moved[values[parseInt(i.toString(), 10)]];\n        }\n    }\n    return moved;\n}\n/**\n * @param {Column[]} columnModel - Defines the column\n * @param {number} ind - Defines the inndex\n * @returns {number} - Returns the columnindex\n * @hidden\n */\nfunction setColumnIndex(columnModel, ind) {\n    if (ind === void 0) { ind = 0; }\n    for (var i = 0, len = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columnModel) ? columnModel.length : 0); i < len; i++) {\n        if (columnModel[parseInt(i.toString(), 10)].columns) {\n            columnModel[parseInt(i.toString(), 10)].index = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columnModel[parseInt(i.toString(), 10)].index) ? ind\n                : columnModel[parseInt(i.toString(), 10)].index;\n            ind++;\n            ind = setColumnIndex(columnModel[parseInt(i.toString(), 10)].columns, ind);\n        }\n        else {\n            columnModel[parseInt(i.toString(), 10)].index = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columnModel[parseInt(i.toString(), 10)].index) ? ind\n                : columnModel[parseInt(i.toString(), 10)].index;\n            ind++;\n        }\n    }\n    return ind;\n}\n/**\n * @param {Column[] | string[] | ColumnModel[]} columns - Defines the column\n * @param {boolean} autoWidth - Defines the autowidth\n * @param {IGrid} gObj - Defines the class name\n * @returns {Column} - Returns the columns\n * @hidden\n */\nfunction prepareColumns(columns, autoWidth, gObj) {\n    for (var c = 0, len = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns) ? columns.length : 0); c < len; c++) {\n        var column = void 0;\n        if (typeof columns[parseInt(c.toString(), 10)] === 'string') {\n            column = new _models_column__WEBPACK_IMPORTED_MODULE_2__.Column({ field: columns[parseInt(c.toString(), 10)] }, gObj);\n        }\n        else if (!(columns[parseInt(c.toString(), 10)] instanceof _models_column__WEBPACK_IMPORTED_MODULE_2__.Column) || columns[parseInt(c.toString(), 10)].columns) {\n            if (!columns[parseInt(c.toString(), 10)].columns) {\n                column = new _models_column__WEBPACK_IMPORTED_MODULE_2__.Column(columns[parseInt(c.toString(), 10)], gObj);\n            }\n            else {\n                columns[parseInt(c.toString(), 10)].columns = prepareColumns(columns[parseInt(c.toString(), 10)].columns, null, gObj);\n                column = new _models_column__WEBPACK_IMPORTED_MODULE_2__.Column(columns[parseInt(c.toString(), 10)], gObj);\n            }\n        }\n        else {\n            column = columns[parseInt(c.toString(), 10)];\n        }\n        if (column.type && column.type.toLowerCase() === 'checkbox') {\n            column.allowReordering = false;\n        }\n        column.headerText = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.headerText) ? column.foreignKeyValue || column.field || '' : column.headerText;\n        column.foreignKeyField = column.foreignKeyField || column.field;\n        column.valueAccessor = (typeof column.valueAccessor === 'string' ? (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(column.valueAccessor, window)\n            : column.valueAccessor) || valueAccessor;\n        column.headerValueAccessor = typeof column.headerValueAccessor === 'string' ? (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(column.headerValueAccessor, window)\n            : column.headerValueAccessor;\n        column.width = autoWidth && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.width) ? 200 : column.width;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.visible)) {\n            column.visible = true;\n        }\n        columns[parseInt(c.toString(), 10)] = column;\n    }\n    return columns;\n}\n/**\n * @param {HTMLElement} popUp - Defines the popup element\n * @param {MouseEvent | TouchEvent} e - Defines the moouse event\n * @param {string} className - Defines the class name\n * @returns {void}\n * @hidden\n */\nfunction setCssInGridPopUp(popUp, e, className) {\n    var popUpSpan = popUp.querySelector('span');\n    var position = popUp.parentElement.getBoundingClientRect();\n    var targetPosition = e.target.getBoundingClientRect();\n    popUpSpan.className = className;\n    popUp.style.display = '';\n    var isBottomTail = ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.clientY) ? e.changedTouches[0].clientY :\n        e.clientY) > popUp.offsetHeight + 10;\n    popUp.style.top = targetPosition.top - position.top +\n        (isBottomTail ? -(popUp.offsetHeight + 10) : popUp.offsetHeight + 10) + 'px'; //10px for tail element\n    popUp.style.left = getPopupLeftPosition(popUp, e, targetPosition, position.left) + 'px';\n    if (isBottomTail) {\n        popUp.querySelector('.e-downtail').style.display = '';\n        popUp.querySelector('.e-uptail').style.display = 'none';\n    }\n    else {\n        popUp.querySelector('.e-downtail').style.display = 'none';\n        popUp.querySelector('.e-uptail').style.display = '';\n    }\n}\n/**\n * @param {HTMLElement} popup - Defines the popup element\n * @param {MouseEvent | TouchEvent} e  - Defines the mouse event\n * @param {Object} targetPosition - Defines the target position\n * @param {number} targetPosition.top - Defines the top position\n * @param {number} targetPosition.left  - Defines the left position\n * @param {number} targetPosition.right  - Defines the right position\n * @param {number} left - Defines the left position\n * @returns {number} Returns the popup left position\n * @hidden\n */\nfunction getPopupLeftPosition(popup, e, targetPosition, left) {\n    var width = popup.offsetWidth / 2;\n    var x = getPosition(e).x;\n    if (x - targetPosition.left < width) {\n        return targetPosition.left - left;\n    }\n    else if (targetPosition.right - x < width) {\n        return targetPosition.right - left - width * 2;\n    }\n    else {\n        return x - left - width;\n    }\n}\n/**\n * @param {Object} obj - Defines the object\n * @returns {Object} Returns the Properties\n * @hidden\n */\nfunction getActualProperties(obj) {\n    if (obj instanceof _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty) {\n        return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)('properties', obj);\n    }\n    else {\n        return obj;\n    }\n}\n/**\n * @param {Element} elem - Defines the element\n * @param {string} selector - Defines the string selector\n * @param {boolean} isID - Defines the isID\n * @returns {Element} Returns the element\n * @hidden\n */\nfunction parentsUntil(elem, selector, isID) {\n    var parent = elem;\n    while (parent) {\n        if (isID ? parent.id === selector : parent.classList.contains(selector)) {\n            break;\n        }\n        parent = parent.parentElement;\n    }\n    return parent;\n}\n/**\n * @param {Element} element - Defines the element\n * @param {Element} elements - Defines the element\n * @returns {number} Returns the element index\n * @hidden\n */\nfunction getElementIndex(element, elements) {\n    var index = -1;\n    for (var i = 0, len = elements.length; i < len; i++) {\n        if (elements[parseInt(i.toString(), 10)].isEqualNode(element)) {\n            index = i;\n            break;\n        }\n    }\n    return index;\n}\n/**\n * @param {Object} value - Defines the value\n * @param {Object} collection - defines the collection\n * @returns {number} Returns the array\n * @hidden\n */\nfunction inArray(value, collection) {\n    for (var i = 0, len = collection.length; i < len; i++) {\n        if (collection[parseInt(i.toString(), 10)] === value) {\n            return i;\n        }\n    }\n    return -1;\n}\n/**\n * @param {Object} collection - Defines the collection\n * @returns {Object} Returns the object\n * @hidden\n */\nfunction getActualPropFromColl(collection) {\n    var coll = [];\n    for (var i = 0, len = collection.length; i < len; i++) {\n        // eslint-disable-next-line no-prototype-builtins\n        if (collection[parseInt(i.toString(), 10)].hasOwnProperty('properties')) {\n            coll.push(collection[parseInt(i.toString(), 10)].properties);\n        }\n        else {\n            coll.push(collection[parseInt(i.toString(), 10)]);\n        }\n    }\n    return coll;\n}\n/**\n * @param {Element} target - Defines the target element\n * @param {string} selector - Defines the selector\n * @returns {void}\n * @hidden\n */\nfunction removeElement(target, selector) {\n    var elements = [].slice.call(target.querySelectorAll(selector));\n    for (var i = 0; i < elements.length; i++) {\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(elements[parseInt(i.toString(), 10)]);\n    }\n}\n/**\n * @param {MouseEvent | TouchEvent} e Defines the mouse event\n * @returns {IPosition} Returns the position\n * @hidden\n */\nfunction getPosition(e) {\n    var position = {};\n    position.x = ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.clientX) ? e.changedTouches[0].clientX :\n        e.clientX);\n    position.y = ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.clientY) ? e.changedTouches[0].clientY :\n        e.clientY);\n    return position;\n}\nvar uid = 0;\n/**\n * @param {string} prefix - Defines the prefix string\n * @returns {string} Returns the uid\n * @hidden\n */\nfunction getUid(prefix) {\n    return prefix + uid++;\n}\n/**\n * @param {Element | DocumentFragment} elem - Defines the element\n * @param {Element[] | NodeList} children - Defines the Element\n * @returns {Element} Returns the element\n * @hidden\n */\nfunction appendChildren(elem, children) {\n    for (var i = 0, len = children.length; i < len; i++) {\n        if (len === children.length) {\n            elem.appendChild(children[parseInt(i.toString(), 10)]);\n        }\n        else {\n            elem.appendChild(children[0]);\n        }\n    }\n    return elem;\n}\n/**\n * @param {Element} elem - Defines the element\n * @param {string} selector - Defines the selector\n * @param {boolean} isID - Defines isID\n * @returns {Element} Return the element\n * @hidden\n */\nfunction parents(elem, selector, isID) {\n    var parent = elem;\n    var parents = [];\n    while (parent) {\n        if (isID ? parent.id === selector : parent.classList.contains(selector)) {\n            parents.push(parent);\n        }\n        parent = parent.parentElement;\n    }\n    return parents;\n}\n/**\n * @param {AggregateType | string} type - Defines the type\n * @param {Object} data - Defines the data\n * @param {AggregateColumnModel} column - Defines the column\n * @param {Object} context - Defines the context\n * @returns {Object} Returns the calculated aggragate\n * @hidden\n */\nfunction calculateAggregate(type, data, column, context) {\n    if (type === 'Custom') {\n        var temp = column.customAggregate;\n        if (typeof temp === 'string') {\n            temp = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(temp, window);\n        }\n        return temp ? temp.call(context, data, column) : '';\n    }\n    return (column.field in data || data instanceof Array) ? _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.DataUtil.aggregates[type.toLowerCase()](data, column.field) : null;\n}\n/** @hidden */\nvar scrollWidth = null;\n/** @hidden\n * @returns {number} - Returns the scrollbarwidth\n */\nfunction getScrollBarWidth() {\n    if (scrollWidth !== null) {\n        return scrollWidth;\n    }\n    var divNode = document.createElement('div');\n    var value = 0;\n    divNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n    document.body.appendChild(divNode);\n    value = (divNode.offsetWidth - divNode.clientWidth) | 0;\n    document.body.removeChild(divNode);\n    return scrollWidth = value;\n}\n/** @hidden */\nvar rowHeight;\n/** @hidden */\nvar accurateRowHeight;\n/**\n * @param {HTMLElement} element - Defines the element\n * @param {boolean} accurateHeight - Defines the accurate row height\n * @returns {number} Returns the roww height\n * @hidden\n */\nfunction getRowHeight(element, accurateHeight) {\n    if (accurateHeight && accurateRowHeight !== undefined) {\n        return accurateRowHeight;\n    }\n    if (rowHeight !== undefined) {\n        return rowHeight;\n    }\n    var table = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('table', { className: _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.table, attrs: { role: 'grid' } });\n    table.style.visibility = 'hidden';\n    table.innerHTML = '<tr><td class=\"e-rowcell\">A<td></tr>';\n    element.appendChild(table);\n    var rect = table.querySelector('td').getBoundingClientRect();\n    element.removeChild(table);\n    accurateRowHeight = rect.height;\n    rowHeight = Math.ceil(rect.height);\n    if (accurateHeight) {\n        return accurateRowHeight;\n    }\n    return rowHeight;\n}\n/**\n * @param {HTMLElement} element - Defines the HTMl element\n * @returns {number} Returns the row height\n * @hidden\n */\nfunction getActualRowHeight(element) {\n    var table = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('table', { className: _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.table, attrs: { role: 'grid' } });\n    table.style.visibility = 'hidden';\n    table.innerHTML = '<tr><td class=\"e-rowcell\">A<td></tr>';\n    element.appendChild(table);\n    var rect = table.querySelector('tr').getBoundingClientRect();\n    element.removeChild(table);\n    return rect.height;\n}\n/**\n * @param {string} field - Defines the field\n * @returns {boolean} - Returns is complex field\n * @hidden\n */\nfunction isComplexField(field) {\n    return field.split('.').length > 1;\n}\n/**\n * @param {string} field - Defines the field\n * @returns {string} - Returns the get complex field ID\n * @hidden\n */\nfunction getComplexFieldID(field) {\n    if (field === void 0) { field = ''; }\n    return field.replace(/\\./g, '___');\n}\n/**\n * @param {string} field - Defines the field\n * @returns {string} - Returns the parsed column field id\n * @hidden\n */\nfunction getParsedFieldID(field) {\n    if (field === void 0) { field = ''; }\n    return field.replace(/[^a-zA-Z0-9_.]/g, '\\\\$&');\n}\n/**\n * @param {string} field - Defines the field\n * @returns {string} - Returns the set complex field ID\n * @hidden\n */\nfunction setComplexFieldID(field) {\n    if (field === void 0) { field = ''; }\n    return field.replace(/___/g, '.');\n}\n/**\n * @param {Column} col - Defines the column\n * @param {string} type - Defines the type\n * @param {Element} elem - Defines th element\n * @returns {boolean} Returns is Editable\n * @hidden\n */\nfunction isEditable(col, type, elem) {\n    var row = parentsUntil(elem, _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.row);\n    var isOldRow = !row ? true : row && !row.classList.contains('e-insertedrow');\n    if (type === 'beginEdit' && isOldRow) {\n        if (col.isIdentity || col.isPrimaryKey || !col.allowEditing) {\n            return false;\n        }\n        return true;\n    }\n    else if (type === 'add' && col.isIdentity) {\n        return false;\n    }\n    else {\n        if (isOldRow && !col.allowEditing && !col.isIdentity && !col.isPrimaryKey) {\n            return false;\n        }\n        return true;\n    }\n}\n/**\n * @param {Element} elem - Defines th element\n * @returns {boolean} Returns is Editable\n * @hidden\n */\nfunction isCellHaveWidth(elem) {\n    return elem.getBoundingClientRect().width === 0 ? false : true;\n}\n/**\n * @param {IGrid} inst - Defines the IGrid\n * @returns {boolean} Returns is action prevent in boolean\n * @hidden\n */\nfunction isActionPrevent(inst) {\n    var dlg = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.select)('#' + inst.element.id + 'EditConfirm', inst.element);\n    return inst.editSettings.mode === 'Batch' &&\n        ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.selectAll)('.e-updatedtd', inst.element).length || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.selectAll)('.e-gridform.e-formvalidator', inst.element).length)\n        && inst.editSettings.showConfirmDialog && (dlg ? dlg.classList.contains('e-popup-close') : true);\n}\n/**\n * @param {any} elem - Defines the element\n * @param {boolean} action - Defines the boolean for action\n * @returns {void}\n * @hidden\n */\n// eslint-disable-next-line\nfunction wrap(elem, action) {\n    var clName = 'e-wrap';\n    elem = elem instanceof Array ? elem : [elem];\n    for (var i = 0; i < elem.length; i++) {\n        if (action) {\n            elem[parseInt(i.toString(), 10)].classList.add(clName);\n        }\n        else {\n            elem[parseInt(i.toString(), 10)].classList.remove(clName);\n        }\n    }\n}\n/**\n * @param {ServiceLocator} serviceLocator - Defines the service locator\n * @param {Column} column  - Defines the column\n * @returns {void}\n * @hidden\n */\nfunction setFormatter(serviceLocator, column) {\n    var fmtr = serviceLocator.getService('valueFormatter');\n    var format = 'format';\n    var args;\n    if (column.type === 'date' || column.type === 'datetime' || column.type === 'dateonly') {\n        args = { type: column.type === 'dateonly' ? 'date' : column.type, skeleton: column.format };\n        if ((typeof (column.format) === 'string') && column.format !== 'yMd') {\n            args[\"\" + format] = column.format;\n        }\n    }\n    switch (column.type) {\n        case 'date':\n            column.setFormatter(fmtr.getFormatFunction(args));\n            column.setParser(fmtr.getParserFunction(args));\n            break;\n        case 'dateonly':\n            column.setFormatter(fmtr.getFormatFunction(args));\n            column.setParser(fmtr.getParserFunction(args));\n            break;\n        case 'datetime':\n            column.setFormatter(fmtr.getFormatFunction(args));\n            column.setParser(fmtr.getParserFunction(args));\n            break;\n        case 'number':\n            column.setFormatter(fmtr.getFormatFunction({ format: column.format }));\n            column.setParser(fmtr.getParserFunction({ format: column.format }));\n            break;\n    }\n}\n/**\n * @param {Element} cells - Defines the cell element\n * @param {boolean} add - Defines the add\n * @param {string} args - Defines the args\n * @returns {void}\n * @hidden\n */\nfunction addRemoveActiveClasses(cells, add) {\n    var args = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        args[_i - 2] = arguments[_i];\n    }\n    for (var i = 0, len = cells.length; i < len; i++) {\n        if (add) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(cells[parseInt(i.toString(), 10)], args.slice(), []);\n            cells[parseInt(i.toString(), 10)].setAttribute('aria-selected', 'true');\n        }\n        else {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(cells[parseInt(i.toString(), 10)], [], args.slice());\n            cells[parseInt(i.toString(), 10)].removeAttribute('aria-selected');\n        }\n    }\n}\n/**\n * @param {string} result - Defines th string\n * @returns {string} Returns the distinct staing values\n * @hidden\n */\nfunction distinctStringValues(result) {\n    var temp = {};\n    var res = [];\n    for (var i = 0; i < result.length; i++) {\n        if (!(result[parseInt(i.toString(), 10)] in temp)) {\n            res.push(result[parseInt(i.toString(), 10)].toString());\n            temp[result[parseInt(i.toString(), 10)]] = 1;\n        }\n    }\n    return res;\n}\n/**\n * @param {Element} target - Defines the target\n * @param {Dialog} dialogObj - Defines the dialog\n * @returns {void}\n * @hidden\n */\nfunction getFilterMenuPostion(target, dialogObj) {\n    var elementVisible = dialogObj.element.style.display;\n    dialogObj.element.style.display = 'block';\n    var dlgWidth = dialogObj.width;\n    var newpos = (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__.calculateRelativeBasedPosition)(target, dialogObj.element);\n    dialogObj.element.style.display = elementVisible;\n    dialogObj.element.style.top = (newpos.top + target.getBoundingClientRect().height) - 5 + 'px';\n    var leftPos = ((newpos.left - dlgWidth) + target.clientWidth);\n    if (leftPos < 1) {\n        dialogObj.element.style.left = (dlgWidth + leftPos) - 16 + 'px'; // right calculation\n    }\n    else {\n        dialogObj.element.style.left = leftPos + -4 + 'px';\n    }\n}\n/**\n * @param {Object} args - Defines the args\n * @param {Popup} args.popup - Defines the args for popup\n * @param {Dialog} dialogObj - Defines the dialog obj\n * @returns {void}\n * @hidden\n */\nfunction getZIndexCalcualtion(args, dialogObj) {\n    args.popup.element.style.zIndex = (dialogObj.zIndex + 1).toString();\n}\n/**\n * @param {string} operator - Defines the operator\n * @param {string} columnUid - Defines the column uid\n * @param {Column} column - Defines the column\n * @param {string} columnType - Defines the column type\n * @param {Dialog} dlgObj - Defines the dialog\n * @param {string} previousValue - Defines the previous operator\n * @returns {void}\n * @hidden\n */\nfunction toggleFilterUI(operator, columnUid, column, columnType, dlgObj, previousValue) {\n    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.filterTemplate)) {\n        var columnID = '';\n        if (columnType === 'string') {\n            columnID = 'strui-' + columnUid;\n        }\n        else if (columnType === 'number') {\n            columnID = 'numberui-' + columnUid;\n        }\n        else if (columnType === 'boolean') {\n            columnID = 'bool-ui-' + columnUid;\n        }\n        else if (columnType === 'date') {\n            columnID = 'dateui-' + columnUid;\n        }\n        var isPreviousValue = previousValue === 'in' || previousValue === 'notin';\n        var isMultiSelect = operator === 'in' || operator === 'notin';\n        var multiselectParent = parentsUntil(dlgObj.element.querySelector(\"#multiselect\" + columnID), 'e-control-wrapper');\n        var singleInputParent = parentsUntil(dlgObj.element.querySelector(\"#\" + columnID), 'e-popup-flmenu');\n        if (multiselectParent) {\n            multiselectParent.style.display = isMultiSelect ? 'inline-flex' : 'none';\n        }\n        if (singleInputParent) {\n            singleInputParent.style.display = isMultiSelect ? 'none' : 'inline-flex';\n        }\n    }\n}\n/**\n * @param {Element} elem - Defines the element\n * @returns {void}\n * @hidden\n */\nfunction toogleCheckbox(elem) {\n    var span = elem.querySelector('.e-frame');\n    var input = span.previousSibling;\n    if (span.classList.contains('e-check')) {\n        input.checked = false;\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(span, ['e-uncheck'], ['e-check']);\n    }\n    else {\n        input.checked = true;\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(span, ['e-check'], ['e-uncheck']);\n    }\n}\n/**\n * @param {HTMLInputElement} elem - Defines the element\n * @param {boolean} checked - Defines is checked\n * @returns {void}\n * @hidden\n */\nfunction setChecked(elem, checked) {\n    elem.checked = checked;\n}\n/**\n * @param {string} uid - Defines the string\n * @param {Element} elem - Defines the Element\n * @param {string} className - Defines the classname\n * @returns {Element} Returns the box wrap\n * @hidden\n */\nfunction createCboxWithWrap(uid, elem, className) {\n    var div = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', { className: className });\n    div.appendChild(elem);\n    div.setAttribute('uid', uid);\n    return div;\n}\n/**\n * @param {Element} elem - Defines the element\n * @param {boolean} checked - Defines is checked\n * @returns {void}\n * @hidden\n */\nfunction removeAddCboxClasses(elem, checked) {\n    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([elem], ['e-check', 'e-stop', 'e-uncheck']);\n    if (checked) {\n        elem.classList.add('e-check');\n    }\n    else {\n        elem.classList.add('e-uncheck');\n    }\n}\n/**\n * Refresh the Row model's foreign data.\n *\n * @param {IRow<Column>} row - Grid Row model object.\n * @param {Column[]} columns - Foreign columns array.\n * @param {Object} data - Updated Row data.\n * @returns {void}\n * @hidden\n */\nfunction refreshForeignData(row, columns, data) {\n    for (var i = 0; i < (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns) ? columns.length : 0); i++) {\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setValue)(columns[parseInt(i.toString(), 10)].field, getForeignData(columns[parseInt(i.toString(), 10)], data), row.foreignKeyData);\n    }\n    var cells = row.cells;\n    for (var i = 0; i < cells.length; i++) {\n        if (cells[parseInt(i.toString(), 10)].isForeignKey) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setValue)('foreignKeyData', (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(cells[parseInt(i.toString(), 10)].column.field, row.foreignKeyData), cells[parseInt(i.toString(), 10)]);\n        }\n    }\n}\n/**\n * Get the foreign data for the corresponding cell value.\n *\n * @param {Column} column - Foreign Key column\n * @param {Object} data - Row data.\n * @param {string | number} lValue - cell value.\n * @param {Object} foreignKeyData - foreign data source.\n * @returns {Object} Returns the object\n * @hidden\n */\nfunction getForeignData(column, data, lValue, foreignKeyData) {\n    var fField = column.foreignKeyField;\n    var key = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(lValue) ? lValue : valueAccessor(column.field, data, column));\n    key = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(key) ? '' : key;\n    var query = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Query();\n    var fdata = foreignKeyData || ((column.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_6__.DataManager) && column.dataSource.dataSource.json.length ?\n        column.dataSource.dataSource.json : column.columnData);\n    if (key.getDay) {\n        query.where(getDatePredicate({ field: fField, operator: 'equal', value: key, matchCase: false }));\n    }\n    else {\n        query.where(fField, '==', key, false);\n    }\n    return new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_6__.DataManager(fdata).executeLocal(query);\n}\n/**\n * To use to get the column's object by the foreign key value.\n *\n * @param {string} foreignKeyValue - Defines ForeignKeyValue.\n * @param {Column[]} columns - Array of column object.\n * @returns {Column} Returns the element\n * @hidden\n */\nfunction getColumnByForeignKeyValue(foreignKeyValue, columns) {\n    var column;\n    return columns.some(function (col) {\n        column = col;\n        return col.foreignKeyValue === foreignKeyValue;\n    }) && column;\n}\n/**\n * @param {number} value - Defines the date or month value\n * @returns {string} Returns string\n * @hidden\n */\nfunction padZero(value) {\n    if (value < 10) {\n        return '0' + value;\n    }\n    return String(value);\n}\n/**\n * @param {PredicateModel} filterObject - Defines the filterObject\n * @param {string} type - Defines the type\n * @param {boolean} isExecuteLocal - Defines whether the data actions performed in client and used for dateonly type field\n * @returns {Predicate} Returns the Predicate\n * @hidden\n */\nfunction getDatePredicate(filterObject, type, isExecuteLocal) {\n    var datePredicate;\n    var prevDate;\n    var nextDate;\n    var prevObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, getActualProperties(filterObject));\n    var nextObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, getActualProperties(filterObject));\n    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(filterObject.value) || filterObject.value === '') {\n        datePredicate = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Predicate(prevObj.field, prevObj.operator, prevObj.value, false);\n        return datePredicate;\n    }\n    var value = new Date(filterObject.value);\n    if (type === 'dateonly' && !isExecuteLocal) {\n        if (typeof (prevObj.value) === 'string') {\n            prevObj.value = new Date(prevObj.value);\n        }\n        var dateOnlyString = prevObj.value.getFullYear() + '-' + padZero(prevObj.value.getMonth() + 1) + '-' + padZero(prevObj.value.getDate());\n        var predicates = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Predicate(prevObj.field, prevObj.operator, dateOnlyString, false);\n        datePredicate = predicates;\n    }\n    else {\n        filterObject.operator = filterObject.operator.toLowerCase();\n        if (filterObject.operator === 'equal' || filterObject.operator === 'notequal') {\n            if (type === 'datetime') {\n                prevDate = new Date(value.setSeconds(value.getSeconds() - 1));\n                nextDate = new Date(value.setSeconds(value.getSeconds() + 2));\n                filterObject.value = new Date(value.setSeconds(nextDate.getSeconds() - 1));\n            }\n            else {\n                prevDate = new Date(value.setHours(0) - 1);\n                nextDate = new Date(value.setHours(24));\n            }\n            prevObj.value = prevDate;\n            nextObj.value = nextDate;\n            if (filterObject.operator === 'equal') {\n                prevObj.operator = 'greaterthan';\n                nextObj.operator = 'lessthan';\n            }\n            else if (filterObject.operator === 'notequal') {\n                prevObj.operator = 'lessthanorequal';\n                nextObj.operator = 'greaterthanorequal';\n            }\n            var predicateSt = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Predicate(prevObj.field, prevObj.operator, prevObj.value, false);\n            var predicateEnd = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Predicate(nextObj.field, nextObj.operator, nextObj.value, false);\n            datePredicate = filterObject.operator === 'equal' ? predicateSt.and(predicateEnd) : predicateSt.or(predicateEnd);\n        }\n        else {\n            if (type === 'date' && (filterObject.operator === 'lessthanorequal' || filterObject.operator === 'greaterthan')) {\n                prevObj.value = new Date(value.setHours(24) - 1);\n            }\n            if (typeof (prevObj.value) === 'string') {\n                prevObj.value = new Date(prevObj.value);\n            }\n            var predicates = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Predicate(prevObj.field, prevObj.operator, prevObj.value, false);\n            datePredicate = predicates;\n        }\n    }\n    if (filterObject.setProperties) {\n        filterObject.setProperties({ ejpredicate: datePredicate }, true);\n    }\n    else {\n        filterObject.ejpredicate = datePredicate;\n    }\n    return datePredicate;\n}\n/**\n * @param {IGrid} grid - Defines the IGrid\n * @returns {boolean} Returns true if group adaptive is true\n * @hidden\n */\nfunction isGroupAdaptive(grid) {\n    return grid.enableVirtualization && grid.groupSettings.columns.length > 0 && grid.isVirtualAdaptive &&\n        !grid.groupSettings.enableLazyLoading;\n}\n/**\n * @param {string} field - Defines the Field\n * @param {Object} object - Defines the objec\n * @returns {any} Returns the object\n * @hidden\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction getObject(field, object) {\n    if (field === void 0) { field = ''; }\n    if (field) {\n        var value = object;\n        var splits = field.split('.');\n        for (var i = 0; i < splits.length && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value); i++) {\n            value = value[splits[parseInt(i.toString(), 10)]];\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(value)) {\n                var newCase = splits[parseInt(i.toString(), 10)].charAt(0).toUpperCase()\n                    + splits[parseInt(i.toString(), 10)].slice(1);\n                value = object[\"\" + newCase] || object[(\"\" + newCase).charAt(0).toLowerCase() + (\"\" + newCase).slice(1)];\n            }\n        }\n        return value;\n    }\n}\n/**\n * @param {string | Object} format - defines the format\n * @param {string} colType - Defines the coltype\n * @returns {string} Returns the custom Data format\n * @hidden\n */\nfunction getCustomDateFormat(format, colType) {\n    var intl = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Internationalization();\n    var formatvalue;\n    var formatter = 'format';\n    var type = 'type';\n    if (colType === 'date') {\n        formatvalue = typeof (format) === 'object' ?\n            intl.getDatePattern({ type: format[\"\" + type] ? format[\"\" + type] : 'date', format: format[\"\" + formatter] }, false) :\n            intl.getDatePattern({ type: 'dateTime', skeleton: format }, false);\n    }\n    else {\n        formatvalue = typeof (format) === 'object' ?\n            intl.getDatePattern({ type: format[\"\" + type] ? format[\"\" + type] : 'dateTime', format: format[\"\" + formatter] }, false) :\n            intl.getDatePattern({ type: 'dateTime', skeleton: format }, false);\n    }\n    return formatvalue;\n}\n/**\n * @param {IGrid} gObj - Defines the IGrid\n * @param {HierarchyGridPrintMode} hierarchyPrintMode - Defines the hierarchyPrintMode\n * @returns {Object} Returns the object\n * @hidden\n */\nfunction getExpandedState(gObj, hierarchyPrintMode) {\n    var rows = gObj.getRowsObject();\n    var obj = {};\n    for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n        var row = rows_1[_i];\n        if (row.isExpand && !row.isDetailRow) {\n            var index = gObj.allowPaging && gObj.printMode === 'AllPages' ? row.index +\n                (gObj.pageSettings.currentPage * gObj.pageSettings.pageSize) - gObj.pageSettings.pageSize : row.index;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(index)) {\n                obj[parseInt(index.toString(), 10)] = {};\n                obj[parseInt(index.toString(), 10)].isExpand = true;\n                if (gObj.childGrid) {\n                    obj[parseInt(index.toString(), 10)].gridModel = getPrintGridModel(row.childGrid, hierarchyPrintMode);\n                    obj[parseInt(index.toString(), 10)].gridModel.query = gObj.childGrid.query;\n                }\n            }\n        }\n    }\n    return obj;\n}\n/**\n * @param {IGrid} gObj - Defines the grid objct\n * @param {HierarchyGridPrintMode} hierarchyPrintMode - Defines the hierarchyPrintMode\n * @returns {IGrid} Returns the IGrid\n * @hidden\n */\nfunction getPrintGridModel(gObj, hierarchyPrintMode) {\n    if (hierarchyPrintMode === void 0) { hierarchyPrintMode = 'Expanded'; }\n    var printGridModel = {};\n    if (!gObj) {\n        return printGridModel;\n    }\n    for (var _i = 0, _a = _actions_print__WEBPACK_IMPORTED_MODULE_7__.Print.printGridProp; _i < _a.length; _i++) {\n        var key = _a[_i];\n        if (key === 'columns') {\n            printGridModel[\"\" + key] = getActualPropFromColl(gObj[\"\" + key]);\n        }\n        else if (key === 'allowPaging') {\n            printGridModel[\"\" + key] = gObj.printMode === 'CurrentPage';\n        }\n        else {\n            printGridModel[\"\" + key] = getActualProperties(gObj[\"\" + key]);\n        }\n    }\n    printGridModel['enableHover'] = false;\n    if ((gObj.childGrid || gObj.detailTemplate) && hierarchyPrintMode !== 'None') {\n        printGridModel.expandedRows = getExpandedState(gObj, hierarchyPrintMode);\n    }\n    return printGridModel;\n}\n/**\n * @param {Object} copied - Defines the copied object\n * @param {Object} first - Defines the first object\n * @param {Object} second - Defines the second object\n * @param {boolean} deep - Defines the deep\n * @returns {Object} Returns the extended object\n * @hidden\n */\nfunction extendObjWithFn(copied, first, second, deep) {\n    var res = copied || {};\n    var len = arguments.length;\n    if (deep) {\n        len = len - 1;\n    }\n    for (var i = 1; i < len; i++) {\n        // eslint-disable-next-line prefer-rest-params\n        if (!arguments[parseInt(i.toString(), 10)]) {\n            continue;\n        }\n        // eslint-disable-next-line prefer-rest-params\n        var obj1 = arguments[parseInt(i.toString(), 10)];\n        var keys = Object.keys(Object.getPrototypeOf(obj1)).length ?\n            Object.keys(obj1).concat(getPrototypesOfObj(obj1)) : Object.keys(obj1);\n        for (var i_1 = 0; i_1 < keys.length; i_1++) {\n            var source = res[keys[parseInt(i_1.toString(), 10)]];\n            var cpy = obj1[keys[parseInt(i_1.toString(), 10)]];\n            var cln = void 0;\n            if (deep && ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isObject)(cpy) || Array.isArray(cpy))) {\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isObject)(cpy)) {\n                    cln = source ? source : {};\n                    res[keys[parseInt(i_1.toString(), 10)]] = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, cln, cpy, deep);\n                }\n                else {\n                    cln = source ? source : [];\n                    res[keys[parseInt(i_1.toString(), 10)]] = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)([], cln, cpy, deep);\n                }\n            }\n            else {\n                res[keys[parseInt(i_1.toString(), 10)]] = cpy;\n            }\n        }\n    }\n    return res;\n}\n/**\n * @param {Object} obj - Defines the obj\n * @returns {string[]} Returns the string\n * @hidden\n */\nfunction getPrototypesOfObj(obj) {\n    var keys = [];\n    while (Object.getPrototypeOf(obj) && Object.keys(Object.getPrototypeOf(obj)).length) {\n        keys = keys.concat(Object.keys(Object.getPrototypeOf(obj)));\n        obj = Object.getPrototypeOf(obj);\n    }\n    return keys;\n}\n/**\n * @param {Column[]} column - Defines the Column\n * @returns {number} Returns the column Depth\n * @hidden\n */\nfunction measureColumnDepth(column) {\n    var max = 0;\n    for (var i = 0; i < (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column) ? column.length : 0); i++) {\n        var depth = checkDepth(column[parseInt(i.toString(), 10)], 0);\n        if (max < depth) {\n            max = depth;\n        }\n    }\n    return max + 1;\n}\n/**\n * @param {Column} col - Defines the Column\n * @param {number} index - Defines the index\n * @returns {number} Returns the depth\n * @hidden\n */\nfunction checkDepth(col, index) {\n    var max = index;\n    var indices = [];\n    if (col.columns) {\n        index++;\n        for (var i = 0; i < col.columns.length; i++) {\n            indices[parseInt(i.toString(), 10)] = checkDepth(col.columns[parseInt(i.toString(), 10)], index);\n        }\n        for (var j = 0; j < indices.length; j++) {\n            if (max < indices[parseInt(j.toString(), 10)]) {\n                max = indices[parseInt(j.toString(), 10)];\n            }\n        }\n        index = max;\n    }\n    return index;\n}\n/**\n * @param {IGrid} gObj - Defines the IGrid\n * @param {PredicateModel[]} filteredCols - Defines the PredicateModel\n * @returns {void}\n * @hidden\n */\nfunction refreshFilteredColsUid(gObj, filteredCols) {\n    for (var i = 0; i < filteredCols.length; i++) {\n        filteredCols[parseInt(i.toString(), 10)].uid = filteredCols[parseInt(i.toString(), 10)].isForeignKey ?\n            getColumnByForeignKeyValue(filteredCols[parseInt(i.toString(), 10)].field, gObj.getForeignKeyColumns()).uid\n            : gObj.enableColumnVirtualization ? getColumnModelByFieldName(gObj, filteredCols[parseInt(i.toString(), 10)].field).uid\n                : gObj.getColumnByField(filteredCols[parseInt(i.toString(), 10)].field).uid;\n    }\n}\n/** @hidden */\n// eslint-disable-next-line @typescript-eslint/no-namespace\nvar Global;\n(function (Global) {\n    // eslint-disable-next-line prefer-const\n    Global.timer = null;\n})(Global || (Global = {}));\n/**\n * @param {Element} element - Defines the element\n * @returns {Object} Returns the transform values\n * @hidden\n */\nfunction getTransformValues(element) {\n    var style = document.defaultView.getComputedStyle(element, null);\n    var transformV = style.getPropertyValue('transform');\n    var replacedTv = transformV.replace(/,/g, '');\n    var translateX = parseFloat((replacedTv).split(' ')[4]);\n    var translateY = parseFloat((replacedTv).split(' ')[5]);\n    return { width: translateX, height: translateY };\n}\n/**\n * @param {Element} rootElement - Defines the root Element\n * @param {Element} element - Defines the element\n * @returns {void}\n * @hidden\n */\nfunction applyBiggerTheme(rootElement, element) {\n    if (rootElement.classList.contains('e-bigger')) {\n        element.classList.add('e-bigger');\n    }\n}\n/**\n * @param {IGrid} gObj - Defines grid object\n * @returns {number}  - Returns scroll width\n * @hidden\n */\nfunction getScrollWidth(gObj) {\n    var scrollElem = gObj.getContent().firstElementChild;\n    return scrollElem.scrollWidth > scrollElem.offsetWidth ? getScrollBarWidth() : 0;\n}\n/**\n * @param {IGrid} gObj - Defines grid object\n * @param {number} idx - Defines the index\n * @returns {number} Returns colSpan index\n * @hidden\n */\nfunction resetColspanGroupCaption(gObj, idx) {\n    var colspan = 0;\n    var cols = gObj.getColumns();\n    var width = idx * 30;\n    if (gObj.isRowDragable()) {\n        colspan++;\n        width += 30;\n    }\n    colspan += (gObj.groupSettings.columns.length - idx);\n    width += (30 * (gObj.groupSettings.columns.length - idx));\n    var gridWidth = (gObj.width === 'auto' ? gObj.element.offsetWidth : gObj.width.toString().indexOf('%') !== -1 ?\n        gObj.element.getBoundingClientRect().width : parseInt(gObj.width.toString(), 10)) - getScrollWidth(gObj);\n    for (var i = 0; i < cols.length; i++) {\n        if (cols[parseInt(i.toString(), 10)].visible) {\n            width += parseInt(cols[parseInt(i.toString(), 10)].width.toString(), 10);\n            colspan++;\n        }\n        if (width > gridWidth) {\n            colspan--;\n            break;\n        }\n    }\n    return colspan;\n}\n/**\n * @param {HTMLElement} tr - Defines the tr Element\n * @param {IGrid} gObj - Defines grid object\n * @returns {void}\n * @hidden\n */\nfunction groupCaptionRowLeftRightPos(tr, gObj) {\n    var width = 0;\n    var idx = 0;\n    var frozenCount = gObj.getVisibleFrozenLeftCount();\n    for (var j = 0; j < tr.childNodes.length; j++) {\n        var td = tr.childNodes[parseInt(j.toString(), 10)];\n        if (frozenCount === idx) {\n            break;\n        }\n        if (td.classList.contains('e-groupcaption') || td.classList.contains('e-summarycell')) {\n            idx += parseInt(td.getAttribute('colspan'), 10);\n        }\n        td.classList.add('e-leftfreeze');\n        if (td.classList.contains('e-groupcaption') && parseInt(td.getAttribute('colspan'), 10) === 1) {\n            td.classList.add('e-freezeleftborder');\n        }\n        applyStickyLeftRightPosition(td, width, gObj.enableRtl, 'Left');\n        if (td.classList.contains('e-indentcell') || td.classList.contains('e-recordplusexpand') ||\n            td.classList.contains('e-recordpluscollapse')) {\n            width += 30;\n        }\n        if (td.classList.contains('e-groupcaption')) {\n            var colspan = parseInt(td.getAttribute('colspan'), 10);\n            if (gObj.isRowDragable()) {\n                colspan--;\n                width += 30;\n            }\n            colspan = colspan - (gObj.groupSettings.columns.length - j);\n            width = width + (30 * (gObj.groupSettings.columns.length - j));\n            var cols = gObj.getColumns();\n            for (var i = 0; i < cols.length; i++) {\n                if ((parseInt(td.getAttribute('colspan'), 10) > 1) &&\n                    (parseInt(cols[parseInt(i.toString(), 10)].width.toString(), 10)\n                        + width) > (parseInt(gObj.width.toString(), 10) - getScrollWidth(gObj))) {\n                    var newColspan = resetColspanGroupCaption(gObj, j);\n                    td.setAttribute('colspan', newColspan.toString());\n                    break;\n                }\n                if (cols[parseInt(i.toString(), 10)].visible) {\n                    width += parseInt(cols[parseInt(i.toString(), 10)].width.toString(), 10);\n                    colspan--;\n                }\n                if (colspan === 0) {\n                    break;\n                }\n            }\n        }\n        if (td.classList.contains('e-summarycell')) {\n            var uid_1 = td.getAttribute('e-mappinguid');\n            var column = gObj.getColumnByUid(uid_1);\n            width += parseInt(column.width.toString(), 10);\n        }\n    }\n}\n/**\n * @param {Element} row - Defines row element\n * @param {IGrid} gridObj - Defines grid object\n * @returns {boolean} Returns isRowEnteredInGrid\n * @hidden\n */\nfunction ensureLastRow(row, gridObj) {\n    var content = gridObj.getContent().firstElementChild;\n    return row && (row.getBoundingClientRect().top - content.getBoundingClientRect().top +\n        gridObj.getRowHeight()) > content.offsetHeight;\n}\n/**\n * @param {Element} row - Defines row element\n * @param {number} rowTop - Defines row top number\n * @returns {boolean} Returns first row is true\n * @hidden\n */\nfunction ensureFirstRow(row, rowTop) {\n    return row && row.getBoundingClientRect().top < rowTop;\n}\n/**\n * @param {number} index - Defines index\n * @param {IGrid} gObj - Defines grid object\n * @returns {boolean} Returns isRowEnteredInGrid\n * @hidden\n */\nfunction isRowEnteredInGrid(index, gObj) {\n    var rowHeight = gObj.getRowHeight();\n    var startIndex = gObj.getContent().firstElementChild.scrollTop / rowHeight;\n    var endIndex = startIndex + (gObj.getContent().firstElementChild.offsetHeight / rowHeight);\n    return index < endIndex && index > startIndex;\n}\n/**\n * @param {IGrid} gObj - Defines the grid object\n * @param {Object} data - Defines the query\n * @returns {number} Returns the edited data index\n * @hidden\n */\nfunction getEditedDataIndex(gObj, data) {\n    var keyField = gObj.getPrimaryKeyFieldNames()[0];\n    var dataIndex;\n    gObj.getCurrentViewRecords().filter(function (e, index) {\n        if (keyField.includes('.')) {\n            var currentValue = getObject(keyField, e);\n            var originalValue = getObject(keyField, data);\n            if (currentValue === originalValue) {\n                dataIndex = index;\n            }\n        }\n        else {\n            if (e[\"\" + keyField] === data[\"\" + keyField]) {\n                dataIndex = index;\n            }\n        }\n    });\n    return dataIndex;\n}\n/**\n * @param {Object} args - Defines the argument\n * @param {Query} query - Defines the query\n * @returns {FilterStateObj} Returns the filter state object\n * @hidden\n */\nfunction eventPromise(args, query) {\n    var state = getStateEventArgument(query);\n    var def = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_6__.Deferred();\n    state.dataSource = def.resolve;\n    state.action = args;\n    return { state: state, deffered: def };\n}\n/**\n * @param {Query} query - Defines the query\n * @returns {Object} Returns the state event argument\n * @hidden\n */\nfunction getStateEventArgument(query) {\n    var adaptr = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_8__.UrlAdaptor();\n    var dm = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_6__.DataManager({ url: '', adaptor: new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_8__.UrlAdaptor });\n    var state = adaptr.processQuery(dm, query);\n    var data = JSON.parse(state.data);\n    return data;\n}\n/**\n * @param {IGrid} gObj - Defines the Igrid\n * @returns {boolean} Returns the ispercentageWidth\n * @hidden\n */\nfunction ispercentageWidth(gObj) {\n    var columns = gObj.getVisibleColumns();\n    var percentageCol = 0;\n    var undefinedWidthCol = 0;\n    for (var i = 0; i < columns.length; i++) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isUndefined)(columns[parseInt(i.toString(), 10)].width)) {\n            undefinedWidthCol++;\n        }\n        else if (columns[parseInt(i.toString(), 10)].width.toString().indexOf('%') !== -1) {\n            percentageCol++;\n        }\n    }\n    return (gObj.width === 'auto' || typeof (gObj.width) === 'string' && gObj.width.indexOf('%') !== -1) &&\n        !gObj.groupSettings.showGroupedColumn && gObj.groupSettings.columns.length\n        && percentageCol && !undefinedWidthCol;\n}\n/**\n * @param {IGrid} gObj - Defines the IGrid\n * @param {Row<Column>[]} rows - Defines the row\n * @param {HTMLTableRowElement[]} rowElms - Row elements\n * @param {number} index - Row index\n * @param {number} startRowIndex - Start Row Index\n * @returns {void}\n * @hidden\n */\nfunction resetRowIndex(gObj, rows, rowElms, index, startRowIndex) {\n    var startIndex = index ? index : 0;\n    for (var i = startRowIndex ? startRowIndex : 0; i < rows.length; i++) {\n        if (rows[parseInt(i.toString(), 10)] && rows[parseInt(i.toString(), 10)].isDataRow) {\n            rows[parseInt(i.toString(), 10)].index = startIndex;\n            rows[parseInt(i.toString(), 10)].isAltRow = gObj.enableAltRow ? startIndex % 2 !== 0 : false;\n            rowElms[parseInt(i.toString(), 10)].setAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_3__.ariaRowIndex, (startIndex + 1).toString());\n            if (rows[parseInt(i.toString(), 10)].isAltRow) {\n                rowElms[parseInt(i.toString(), 10)].classList.add('e-altrow');\n            }\n            else {\n                rowElms[parseInt(i.toString(), 10)].classList.remove('e-altrow');\n            }\n            for (var j = 0; j < rowElms[parseInt(i.toString(), 10)].cells.length; j++) {\n                rowElms[parseInt(i.toString(), 10)].cells[parseInt(j.toString(), 10)].setAttribute('index', startIndex.toString());\n            }\n            startIndex++;\n        }\n    }\n    if (!rows.length) {\n        gObj.renderModule.emptyRow(true);\n    }\n}\n/**\n * @param {IGrid} gObj - Defines the IGrid\n * @returns {void}\n * @hidden\n */\nfunction resetCachedRowIndex(gObj) {\n    var rowObjects = gObj.enableInfiniteScrolling && gObj.infiniteScrollSettings.enableCache ?\n        gObj.getRowsObject() : gObj.vRows;\n    var rowElements = gObj.getRows();\n    for (var i = 0, startIndex = 0, k = 0; i < rowObjects.length; i++) {\n        var rowObject = rowObjects[parseInt(i.toString(), 10)];\n        if (rowObject.isDataRow) {\n            rowObject.index = startIndex;\n            rowObject.isAltRow = gObj.enableAltRow ? startIndex % 2 !== 0 : false;\n            var rowElement = gObj.getRowElementByUID(rowObject.uid);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(rowElement)) {\n                rowElements[parseInt(k.toString(), 10)] = rowElement;\n                rowElement.setAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_3__.ariaRowIndex, (startIndex + 1).toString());\n                if (rowObject.isAltRow) {\n                    rowElement.classList.add('e-altrow');\n                }\n                else {\n                    rowElement.classList.remove('e-altrow');\n                }\n                for (var j = 0; j < rowElement.cells.length; j++) {\n                    rowElement.cells[parseInt(j.toString(), 10)].setAttribute('index', startIndex.toString());\n                }\n                k++;\n            }\n            startIndex++;\n        }\n    }\n    if (gObj.enableInfiniteScrolling && gObj.infiniteScrollSettings.enableCache) {\n        gObj.infiniteScrollModule.resetInfiniteCache(rowObjects);\n    }\n}\n/**\n * @param {IGrid} gObj - Defines the IGrid\n * @param {RowDropEventArgs} args - Defines the row drop event argument\n * @param {HTMLTableRowElement[]} tr - Row elements\n * @param {Row<Column>} dropRObj - dropped row object\n * @returns {void}\n * @hidden\n */\nfunction groupReorderRowObject(gObj, args, tr, dropRObj) {\n    var rowObjects = gObj.enableVirtualization ? gObj.vRows : gObj.getRowsObject();\n    var orderChangeRowObjects = [];\n    var dropRowObject = dropRObj ? dropRObj :\n        gObj.getRowObjectFromUID(args.target.closest('tr').getAttribute('data-uid'));\n    var rowObjectDropIndex;\n    for (var i = 0; i < args.rows.length; i++) {\n        var orderChangeRowObject = gObj.getRowObjectFromUID(args.rows[parseInt(i.toString(), 10)].getAttribute('data-uid'));\n        if (dropRowObject === orderChangeRowObject) {\n            rowObjectDropIndex = rowObjects.indexOf(dropRowObject);\n        }\n        orderChangeRowObjects.push(rowObjects.splice(rowObjects.indexOf(orderChangeRowObject), 1)[0]);\n    }\n    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(rowObjectDropIndex)) {\n        rowObjectDropIndex = rowObjects.indexOf(dropRowObject);\n        if (args.fromIndex > args.dropIndex) {\n            rowObjects.splice.apply(rowObjects, [rowObjectDropIndex, 0].concat(orderChangeRowObjects));\n        }\n        else {\n            rowObjects.splice.apply(rowObjects, [rowObjectDropIndex + 1, 0].concat(orderChangeRowObjects));\n        }\n    }\n    else {\n        rowObjects.splice.apply(rowObjects, [rowObjectDropIndex, 0].concat(orderChangeRowObjects));\n    }\n    if (!gObj.enableVirtualization && !gObj.infiniteScrollSettings.enableCache) {\n        var record = {};\n        var currentViewData = gObj.getCurrentViewRecords();\n        for (var i = 0, len = tr.length; i < len; i++) {\n            var index = parseInt(tr[parseInt(i.toString(), 10)].getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_3__.ariaRowIndex), 10) - 1;\n            record[parseInt(i.toString(), 10)] = currentViewData[parseInt(index.toString(), 10)];\n        }\n        var rows = gObj.getRows();\n        for (var i = 0, len = tr.length; i < len; i++) {\n            rows[parseInt(i.toString(), 10)] = tr[parseInt(i.toString(), 10)];\n            currentViewData[parseInt(i.toString(), 10)] = record[parseInt(i.toString(), 10)];\n        }\n    }\n    if (gObj.enableInfiniteScrolling && gObj.infiniteScrollSettings.enableCache) {\n        gObj.infiniteScrollModule.resetInfiniteCache(rowObjects);\n    }\n}\n/**\n * @param {IGrid} gObj - Defines the grid object\n * @param {Object} changes - Defines the changes\n * @param {string} type - Defines the type\n * @param {string} keyField - Defines the keyfield\n * @returns {void}\n * @hidden\n */\nfunction compareChanges(gObj, changes, type, keyField) {\n    var newArray = gObj.dataToBeUpdated[\"\" + type].concat(changes[\"\" + type]).reduce(function (r, o) {\n        r[o[\"\" + keyField]] = r[o[\"\" + keyField]] === undefined ? o : Object.assign(r[o[\"\" + keyField]], o);\n        return r;\n    }, {});\n    gObj.dataToBeUpdated[\"\" + type] = Object.keys(newArray).map(function (k) { return newArray[\"\" + k]; });\n}\n/**\n * @param {IGrid} gObj - Defines the grid object\n * @returns {void}\n * @hidden\n */\nfunction setRowElements(gObj) {\n    if (gObj.enableInfiniteScrolling && (gObj.childGrid || gObj.detailTemplate)) {\n        (gObj).contentModule.rowElements = [].slice.call(gObj.getContentTable().rows)\n            .filter(function (row) { return (row.classList.contains('e-row') || row.classList.contains('e-detailrow'))\n            && !row.classList.contains('e-addedrow'); });\n        return;\n    }\n    (gObj).contentModule.rowElements =\n        [].slice.call(gObj.element.querySelectorAll('.e-row:not(.e-addedrow):not(.e-cloneproperties .e-row)'));\n}\n/**\n * @param {Element} row - Defines the row\n * @param {number} start - Defines the start index\n * @param {number} end - Defines the end index\n * @returns {void}\n * @hidden\n */\nfunction sliceElements(row, start, end) {\n    var cells = row.children;\n    var len = cells.length;\n    var k = 0;\n    for (var i = 0; i < len; i++, k++) {\n        if (i >= start && i < end) {\n            continue;\n        }\n        row.removeChild(row.children[parseInt(k.toString(), 10)]);\n        k--;\n    }\n}\n/**\n * @param {IGrid} gObj - Defines the grid\n * @param {Dialog} dlgObj - Defines the dialog\n * @returns {void}\n * @hidden\n */\nfunction resetDialogAppend(gObj, dlgObj) {\n    var element = gObj.createElement('div', { className: 'e-grid-popup', id: gObj.element.id + '_e-popup' });\n    var pos = (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__.calculatePosition)(gObj.element, 'left', 'Top');\n    if (document.getElementById(gObj.element.id + '_e-popup')) {\n        element = document.getElementById(gObj.element.id + '_e-popup');\n    }\n    element.style.top = pos.top + 'px';\n    element.style.left = pos.left + 'px';\n    element.style.zIndex = (dlgObj.zIndex).toString();\n    element.style.width = dlgObj.element.offsetWidth + 'px';\n    element.appendChild(dlgObj.element);\n    var sbPanel = parentsUntil(gObj.element, 'sb-demo-section') || parentsUntil(gObj.element, 'e-grid-dialog-fixed');\n    if (sbPanel) {\n        var sbPos = (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_4__.calculateRelativeBasedPosition)(gObj.element, sbPanel);\n        element.style.top = sbPos.top + 'px';\n        element.style.left = sbPos.left + 'px';\n        sbPanel.insertBefore(element, sbPanel.firstChild);\n    }\n    else {\n        document.body.insertBefore(element, document.body.firstChild);\n    }\n}\n/**\n * @param {Column} column - Defines the column\n * @param {string} uid - Defines the uid\n * @returns {boolean} Returns is child column\n * @hidden\n */\nfunction isChildColumn(column, uid) {\n    var uids = [];\n    uids.push(column.uid);\n    pushuid(column, uids);\n    if (uids.indexOf(uid) > -1) {\n        return true;\n    }\n    else {\n        return false;\n    }\n}\n/**\n * @param {Column} column - Defines the column\n * @param {string[]} uids - Defines the uid\n * @returns {void}\n * @hidden\n */\nfunction pushuid(column, uids) {\n    for (var i = 0; i < column.columns.length; i++) {\n        if (column.columns[parseInt(i.toString(), 10)].uid) {\n            uids.push(column.columns[parseInt(i.toString(), 10)].uid);\n        }\n        if (column.columns[parseInt(i.toString(), 10)].columns &&\n            column.columns[parseInt(i.toString(), 10)].columns.length) {\n            pushuid(column.columns[parseInt(i.toString(), 10)], uids);\n        }\n    }\n}\n/**\n * @param {Column} column - Defines the column\n * @returns {string} Returns the direction\n * @hidden\n */\nfunction frozenDirection(column) {\n    if (column.columns[0].freeze || column.columns[0].isFrozen) {\n        if (column.columns[0].freeze === 'Left' || column.columns[0].isFrozen) {\n            return 'Left';\n        }\n        else if (column.columns[0].freeze === 'Right') {\n            return 'Right';\n        }\n        else if (column.columns[0].freeze === 'Fixed') {\n            return 'Fixed';\n        }\n        else {\n            return 'None';\n        }\n    }\n    else {\n        if (column.columns[0].columns && column.columns[0].columns.length) {\n            return frozenDirection(column.columns[0]);\n        }\n        else {\n            return 'None';\n        }\n    }\n}\n/**\n * @param {Element} row - Defines the row\n * @returns {void}\n * @hidden\n */\nfunction addFixedColumnBorder(row) {\n    if (row.querySelector('.e-fixedfreeze')) {\n        var cells = [].slice.call(row.querySelectorAll('.e-filterbarcell:not(.e-hide),.e-summarycell:not(.e-hide),.e-headercell:not(.e-hide),.e-rowcell:not(.e-hide)'));\n        for (var j = 0; j < cells.length; j++) {\n            if (cells[parseInt(j.toString(), 10)].classList.contains('e-fixedfreeze') && (!(cells[j - 1]) ||\n                (cells[j - 1] && !cells[j - 1].classList.contains('e-fixedfreeze')))) {\n                cells[parseInt(j.toString(), 10)].classList.add('e-freezeleftborder');\n            }\n            if (cells[parseInt(j.toString(), 10)].classList.contains('e-fixedfreeze') && (!(cells[j + 1]) ||\n                (cells[j + 1] && !cells[j + 1].classList.contains('e-fixedfreeze')))) {\n                cells[parseInt(j.toString(), 10)].classList.add('e-freezerightborder');\n            }\n        }\n    }\n}\n/**\n * @param {HTMLElement} node - Defines the row\n * @param {number} width - Defines the width\n * @param {boolean} isRtl - Boolean property\n * @param {string} position - Defines the position\n * @returns {void}\n * @hidden\n */\nfunction applyStickyLeftRightPosition(node, width, isRtl, position) {\n    if (position === 'Left') {\n        if (isRtl) {\n            node.style.right = width + 'px';\n        }\n        else {\n            node.style.left = width + 'px';\n        }\n    }\n    if (position === 'Right') {\n        if (isRtl) {\n            node.style.left = width + 'px';\n        }\n        else {\n            node.style.right = width + 'px';\n        }\n    }\n}\n/**\n * @param {IGrid} gObj - Defines the grid\n * @param {Column} column - Defines the column\n * @param {Element} node - Defines the Element\n * @param {number} colSpan - Defines the colSpan value\n * @returns {void}\n * @hidden\n */\nfunction resetColandRowSpanStickyPosition(gObj, column, node, colSpan) {\n    var columns = gObj.getColumns();\n    var index = column.index;\n    if (column.freeze === 'Left' && column.border !== 'Left') {\n        var idx = index + (colSpan - 1);\n        while (columns[parseInt(idx.toString(), 10)].visible === false) {\n            idx++;\n        }\n        if (columns[parseInt(idx.toString(), 10)].border === 'Left') {\n            node.classList.add('e-freezeleftborder');\n        }\n    }\n    else if (column.freeze === 'Right' || column.freeze === 'Fixed') {\n        var width = 0;\n        for (var j = index + 1; j < index + colSpan; j++) {\n            if (j === columns.length) {\n                break;\n            }\n            if (columns[parseInt(j.toString(), 10)].visible) {\n                width += parseInt(columns[parseInt(j.toString(), 10)].width.toString(), 10);\n            }\n            else {\n                colSpan++;\n            }\n        }\n        if (gObj.enableRtl) {\n            node.style.left = parseInt(node.style.left, 10) - width + 'px';\n        }\n        else {\n            node.style.right = parseInt(node.style.right, 10) - width + 'px';\n        }\n    }\n}\n/**\n * @param {IGrid} gObj - Defines the grid\n * @param {number} rowIndex - Defines the row index\n * @param {number} colIndex - Defines the colum index\n * @returns {void}\n * @hidden\n */\nfunction getCellFromRow(gObj, rowIndex, colIndex) {\n    var row = (gObj.getRowByIndex(rowIndex));\n    for (var i = 0; i < row.cells.length; i++) {\n        if (parseInt(row.cells[parseInt(i.toString(), 10)].getAttribute('aria-colindex').toString(), 10) - 1 === colIndex) {\n            return row.cells[parseInt(i.toString(), 10)];\n        }\n    }\n    return null;\n}\n/**\n * @param {IGrid} gObj - Defines the grid\n * @param {Column} column - Defines the column\n * @param {Element} node - Defines the Element\n * @returns {void}\n * @hidden\n */\nfunction addStickyColumnPosition(gObj, column, node) {\n    if (column.freeze === 'Left' || column.isFrozen) {\n        node.classList.add('e-leftfreeze');\n        if (column.border === 'Left') {\n            node.classList.add('e-freezeleftborder');\n        }\n        if (column.index === 0) {\n            applyStickyLeftRightPosition(node, (gObj.getIndentCount() * 30), gObj.enableRtl, 'Left');\n            if (gObj.enableColumnVirtualization) {\n                column.valueX = (gObj.getIndentCount() * 30);\n            }\n        }\n        else {\n            var cols = gObj.getColumns();\n            var width = gObj.getIndentCount() * 30;\n            for (var i = 0; i < cols.length; i++) {\n                if (column.uid === cols[parseInt(i.toString(), 10)].uid) {\n                    break;\n                }\n                if (cols[parseInt(i.toString(), 10)].visible) {\n                    width += parseFloat(cols[parseInt(i.toString(), 10)].width.toString());\n                }\n            }\n            applyStickyLeftRightPosition(node, width, gObj.enableRtl, 'Left');\n            if (gObj.enableColumnVirtualization) {\n                column.valueX = width;\n            }\n        }\n    }\n    else if (column.freeze === 'Right') {\n        node.classList.add('e-rightfreeze');\n        var cols = gObj.getColumns();\n        if (column.border === 'Right') {\n            node.classList.add('e-freezerightborder');\n        }\n        if (column.index === cols[cols.length - 1].index) {\n            var width = gObj.getFrozenMode() === 'Right' && gObj.isRowDragable() ? 30 : 0;\n            applyStickyLeftRightPosition(node, width, gObj.enableRtl, 'Right');\n            if (gObj.enableColumnVirtualization) {\n                column.valueX = width;\n            }\n        }\n        else {\n            var width = gObj.getFrozenMode() === 'Right' && gObj.isRowDragable() ? 30 : 0;\n            for (var i = cols.length - 1; i >= 0; i--) {\n                if (column.uid === cols[parseInt(i.toString(), 10)].uid) {\n                    break;\n                }\n                if (cols[parseInt(i.toString(), 10)].visible) {\n                    width += parseFloat(cols[parseInt(i.toString(), 10)].width.toString());\n                }\n            }\n            applyStickyLeftRightPosition(node, width, gObj.enableRtl, 'Right');\n            if (gObj.enableColumnVirtualization) {\n                column.valueX = width;\n            }\n        }\n    }\n    else if (column.freeze === 'Fixed') {\n        node.classList.add('e-fixedfreeze');\n        var cols = gObj.getColumns();\n        var width = 0;\n        if (gObj.getVisibleFrozenLeftCount()) {\n            width = gObj.getIndentCount() * 30;\n        }\n        else if (gObj.getFrozenMode() === 'Right') {\n            width = gObj.groupSettings.columns.length * 30;\n        }\n        for (var i = 0; i < cols.length; i++) {\n            if (column.uid === cols[parseInt(i.toString(), 10)].uid) {\n                break;\n            }\n            if ((cols[parseInt(i.toString(), 10)].freeze === 'Left' || cols[parseInt(i.toString(), 10)].isFrozen) ||\n                cols[parseInt(i.toString(), 10)].freeze === 'Fixed') {\n                if (cols[parseInt(i.toString(), 10)].visible) {\n                    width += parseFloat(cols[parseInt(i.toString(), 10)].width.toString());\n                }\n            }\n        }\n        applyStickyLeftRightPosition(node, (width - 1), gObj.enableRtl, 'Left');\n        width = gObj.getFrozenMode() === 'Right' && gObj.isRowDragable() ? 30 : 0;\n        for (var i = cols.length - 1; i >= 0; i--) {\n            if (column.uid === cols[parseInt(i.toString(), 10)].uid) {\n                break;\n            }\n            if (cols[parseInt(i.toString(), 10)].freeze === 'Right' || cols[parseInt(i.toString(), 10)].freeze === 'Fixed') {\n                if (cols[parseInt(i.toString(), 10)].visible) {\n                    width += parseFloat(cols[parseInt(i.toString(), 10)].width.toString());\n                }\n            }\n        }\n        applyStickyLeftRightPosition(node, (width - 1), gObj.enableRtl, 'Right');\n    }\n    else {\n        node.classList.add('e-unfreeze');\n    }\n}\n/**\n * @param {IGrid} gObj - Defines the grid Object\n * @param {Column} col - Defines the column\n * @param {number} rowIndex - Defines the rowindex\n * @returns {Element} Returns the element\n * @hidden\n */\nfunction getCellsByTableName(gObj, col, rowIndex) {\n    return [].slice.call(gObj.getDataRows()[parseInt(rowIndex.toString(), 10)].getElementsByClassName(_base_string_literals__WEBPACK_IMPORTED_MODULE_3__.rowCell));\n}\n/**\n * @param {IGrid} gObj - Defines the column\n * @param {Column} col - Defines the index\n * @param {number} rowIndex - Defines the rules\n * @param {number} index - Defines the movable column rules\n * @returns {Element} Returns the Element\n * @hidden\n */\nfunction getCellByColAndRowIndex(gObj, col, rowIndex, index) {\n    return getCellsByTableName(gObj, col, rowIndex)[parseInt(index.toString(), 10)];\n}\n/**\n * @param {Column} col - Defines the column\n * @param {number} index - Defines the index\n * @param {Object} rules - Defines the rules\n * @param {Object} mRules - Defines the movable column rules\n * @param {Object} frRules - Defines the Frozen rules\n * @param {number} len - Defines the length\n * @param {boolean} isCustom - Defines custom form validation\n * @returns {void}\n * @hidden\n */\nfunction setValidationRuels(col, index, rules, mRules, frRules, len, isCustom) {\n    if (isCustom) {\n        rules[getComplexFieldID(col.field)] = col.validationRules;\n    }\n    else {\n        if (col.getFreezeTableName() === _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.frozenLeft\n            || (!index && col.getFreezeTableName() === _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.frozenRight) || len === 1) {\n            rules[getComplexFieldID(col.field)] = col.validationRules;\n        }\n        else if (col.getFreezeTableName() === 'movable' || !col.getFreezeTableName()) {\n            mRules[getComplexFieldID(col.field)] = col.validationRules;\n        }\n        else if (col.getFreezeTableName() === _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.frozenRight) {\n            frRules[getComplexFieldID(col.field)] = col.validationRules;\n        }\n    }\n}\n/**\n * @param {string} numberFormat - Format\n * @param {string} type - Value type\n * @param {boolean} isExcel - Boolean property\n * @param {string} currencyCode - Specifies the currency code to be used for formatting.\n * @returns {string} returns formated value\n * @hidden\n */\nfunction getNumberFormat(numberFormat, type, isExcel, currencyCode) {\n    var format;\n    var intl = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Internationalization();\n    if (type === 'number') {\n        try {\n            format = intl.getNumberPattern({ format: numberFormat, currency: currencyCode, useGrouping: true }, true);\n        }\n        catch (error) {\n            format = numberFormat;\n        }\n    }\n    else if (type === 'date' || type === 'time' || type === 'datetime') {\n        try {\n            format = intl.getDatePattern({ skeleton: numberFormat, type: type }, isExcel);\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(format)) {\n                // eslint-disable-next-line\n                throw 'error';\n            }\n        }\n        catch (error) {\n            try {\n                format = intl.getDatePattern({ format: numberFormat, type: type }, isExcel);\n            }\n            catch (error) {\n                format = numberFormat;\n            }\n        }\n    }\n    else {\n        format = numberFormat;\n    }\n    if (type !== 'number') {\n        var patternRegex = /G|H|c|'| a|yy|y|EEEE|E/g;\n        var mtch_1 = { 'G': '', 'H': 'h', 'c': 'd', '\\'': '\"', ' a': ' AM/PM', 'yy': 'yy', 'y': 'yyyy', 'EEEE': 'dddd', 'E': 'ddd' };\n        format = format.replace(patternRegex, function (pattern) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return mtch_1[\"\" + pattern];\n        });\n    }\n    return format;\n}\n/**\n * @param {IGrid} gObj - Grid instance\n * @returns {void}\n * @hidden\n */\nfunction addBiggerDialog(gObj) {\n    if (gObj.enableAdaptiveUI) {\n        var dialogs = document.getElementsByClassName('e-responsive-dialog');\n        for (var i = 0; i < dialogs.length; i++) {\n            dialogs[parseInt(i.toString(), 10)].classList.add('e-bigger');\n        }\n    }\n}\n/**\n * @param {string} value - specifies the trr\n * @param {Object} mapObject - specifies the idx\n * @returns {Object | string} returns object or string\n * @hidden\n */\nfunction performComplexDataOperation(value, mapObject) {\n    var returnObj;\n    var length = value.split('.').length;\n    var splits = value.split('.');\n    var duplicateMap = mapObject;\n    for (var i = 0; i < length; i++) {\n        returnObj = duplicateMap[splits[parseInt(i.toString(), 10)]];\n        duplicateMap = returnObj;\n    }\n    return returnObj;\n}\n/**\n * @param {Object} tr - specifies the trr\n * @param {number} idx - specifies the idx\n * @param {string} displayVal - specifies the displayval\n * @param {Row<Column>} rows - specifies the rows\n * @param {IGrid} parent - Grid instance\n * @param {boolean} isContent - check for content renderer\n * @returns {void}\n * @hidden\n */\nfunction setDisplayValue(tr, idx, displayVal, rows, parent, isContent) {\n    var trs = Object.keys(tr);\n    var actualIndex = idx;\n    for (var i = 0; i < trs.length; i++) {\n        var td = tr[trs[parseInt(i.toString(), 10)]].querySelectorAll('td.e-rowcell')[parseInt(idx.toString(), 10)];\n        if (parent && !parent.isFrozenGrid() && !parent.isRowDragable()) {\n            td = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(td) && (parseInt(td.getAttribute('aria-colindex'), 10) - 1 === idx ||\n                (parentsUntil(td, 'e-addedrow') && td.parentElement.childNodes[parseInt(idx.toString(), 10)] === td)))\n                ? td : tr[parseInt(i.toString(), 10)].querySelector(\"td[aria-colindex=\\\"\" + (idx + 1) + \"\\\"]\");\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(td)) {\n                continue;\n            }\n            else {\n                idx = (parent.getContentTable().querySelector('.e-detailrowcollapse, .e-detailrowexpand')) ?\n                    (td.cellIndex - 1) : td.cellIndex;\n            }\n        }\n        if (tr[trs[parseInt(i.toString(), 10)]].querySelectorAll('td.e-rowcell').length && td) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setStyleAttribute)(tr[trs[parseInt(i.toString(), 10)]].querySelectorAll('td.e-rowcell')[parseInt(idx.toString(), 10)], { 'display': displayVal });\n            if (tr[trs[parseInt(i.toString(), 10)]].querySelectorAll('td.e-rowcell')[parseInt(idx.toString(), 10)].classList.contains('e-hide')) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([tr[trs[parseInt(i.toString(), 10)]].querySelectorAll('td.e-rowcell')[parseInt(idx.toString(), 10)]], ['e-hide']);\n            }\n            if ((isContent && parent.isRowDragable()) || (parent && parent.isDetail())) {\n                var index = idx + 1;\n                rows[trs[parseInt(i.toString(), 10)]].cells[parseInt(index.toString(), 10)].visible = displayVal === '' ? true : false;\n            }\n            else {\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(rows[trs[parseInt(i.toString(), 10)]])) {\n                    rows[trs[parseInt(i.toString(), 10)]].cells[parseInt(idx.toString(), 10)].visible = displayVal === '' ? true : false;\n                    if (rows[trs[parseInt(i.toString(), 10)]].cells[parseInt(idx.toString(), 10)].visible === false) {\n                        tr[trs[parseInt(i.toString(), 10)]].querySelectorAll('td.e-rowcell')[parseInt(idx.toString(), 10)].classList.add('e-hide');\n                    }\n                }\n            }\n            idx = actualIndex;\n        }\n    }\n}\n// eslint-disable-next-line\n/** @hidden */\nfunction addRemoveEventListener(parent, evt, isOn, module) {\n    for (var _i = 0, evt_1 = evt; _i < evt_1.length; _i++) {\n        var inst = evt_1[_i];\n        if (isOn) {\n            parent.on(inst.event, inst.handler, module);\n        }\n        else {\n            parent.off(inst.event, inst.handler);\n        }\n    }\n}\n// eslint-disable-next-line\n/** @hidden */\nfunction createEditElement(parent, column, classNames, attr) {\n    var complexFieldName = getComplexFieldID(column.field);\n    attr = Object.assign(attr, {\n        id: parent.element.id + complexFieldName,\n        name: complexFieldName, 'e-mappinguid': column.uid\n    });\n    return parent.createElement('input', {\n        className: classNames, attrs: attr\n    });\n}\n/**\n * @param {IGrid} gObj - Grid instance\n * @param {string} uid - Defines column's uid\n * @returns {Column} returns column model\n * @hidden\n */\nfunction getColumnModelByUid(gObj, uid) {\n    var column;\n    for (var _i = 0, _a = (gObj.columnModel); _i < _a.length; _i++) {\n        var col = _a[_i];\n        if (col.uid === uid) {\n            column = col;\n            break;\n        }\n    }\n    return column;\n}\n/**\n * @param {IGrid} gObj - Grid instance\n * @param {string} field - Defines column's uid\n * @returns {Column} returns column model\n * @hidden\n */\nfunction getColumnModelByFieldName(gObj, field) {\n    var column;\n    if (!gObj.columnModel) {\n        gObj.getColumns();\n    }\n    for (var _i = 0, _a = (gObj.columnModel); _i < _a.length; _i++) {\n        var col = _a[_i];\n        if (col.field === field) {\n            column = col;\n            break;\n        }\n    }\n    return column;\n}\n/**\n * @param {string} id - Defines component id\n * @param {string[]} evts - Defines events\n * @param {object} handlers - Defines event handlers\n * @param {any} instance - Defines class instance\n * @returns {void}\n * @hidden\n */\n// eslint-disable-next-line\nfunction registerEventHandlers(id, evts, handlers, instance) {\n    instance.eventHandlers[\"\" + id] = {};\n    for (var i = 0; i < evts.length; i++) {\n        instance.eventHandlers[\"\" + id][evts[parseInt(i.toString(), 10)]] = handlers[evts[parseInt(i.toString(), 10)]];\n    }\n}\n/**\n * @param {any} component - Defines component instance\n * @param {string[]} evts - Defines events\n * @param {any} instance - Defines class instance\n * @returns {void}\n * @hidden\n */\n// eslint-disable-next-line\nfunction removeEventHandlers(component, evts, instance) {\n    for (var i = 0; i < evts.length; i++) {\n        if (component.isDestroyed) {\n            break;\n        }\n        component.removeEventListener(evts[parseInt(i.toString(), 10)], instance.eventHandlers[component.element.id][evts[parseInt(i.toString(), 10)]]);\n    }\n}\n/**\n * @param {IGrid | IXLFilter} parent - Defines parent instance\n * @param {string[]} templates - Defines the templates name which are needs to clear\n * @returns {void}\n * @hidden\n */\nfunction clearReactVueTemplates(parent, templates) {\n    parent.destroyTemplate(templates);\n    if (parent.isReact) {\n        parent.renderTemplates();\n    }\n}\n/**\n *\n * @param { HTMLElement[] } removeElem - Defines checkbox wrapper element\n * @returns {void}\n * @hidden\n */\nfunction infiniteRemoveElements(removeElem) {\n    for (var i = 0; i < removeElem.length; i++) {\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(removeElem[i]);\n    }\n}\n/**\n *\n * @param { HTMLElement[] } appendElem - Defines checkbox wrapper element\n * @param { HTMLElement } ulElement - Defines ul element\n * @returns {void}\n * @hidden\n */\nfunction infiniteAppendElements(appendElem, ulElement) {\n    for (var i = 0; i < appendElem.length; i++) {\n        ulElement.insertBefore(appendElem[i], ulElement.children[i]);\n    }\n}\n/**\n *\n * @param { HTMLElement } element - Defines checkbox wrapper element\n * @param { boolean } isChooser - Defines checkbox filter column chooser\n * @returns { number } list height value\n * @hidden\n */\nfunction getListHeight(element, isChooser) {\n    var listDiv = isChooser ? (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('li', { className: 'e-cclist' })\n        : (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', { className: 'e-ftrchk' });\n    listDiv.style.visibility = 'hidden';\n    if (isChooser) {\n        listDiv.style.listStyle = 'none';\n    }\n    listDiv.innerHTML = isChooser ? '<div class=\"e-ccheck\"><div class=\"e-checkbox-wrapper\"><span class=\"e-frame e-icons e-check\"></span><span class=\"e-label\">A</span></div></div>' :\n        '<div class=\"e-checkbox-wrapper\"><span class=\"e-frame e-icons e-check\"></span><span class=\"e-label e-checkboxfiltertext\">A</div></span>';\n    element.appendChild(listDiv);\n    var rect = listDiv.getBoundingClientRect();\n    element.removeChild(listDiv);\n    var listHeight = Math.round(rect.height);\n    return listHeight;\n}\n/**\n *\n * @param { Element } row - Defines row element\n * @returns { number } row index\n */\nfunction getRowIndexFromElement(row) {\n    return parseInt(row.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_3__.ariaRowIndex), 10) - 1;\n}\n/**\n *\n * @param { IGrid } grid - Defines grid instance\n * @returns { IGrid } returns parent grid instance\n */\nfunction getParentIns(grid) {\n    return grid.parentDetails && grid.parentDetails.parentInstObj ?\n        getParentIns(grid.parentDetails.parentInstObj) : grid;\n}\n/**\n *\n * @param { string[] } fields - Defines grouped fields\n * @param { values } values - Defines caption keys\n * @param { any } instance - Defines dynamic class instance\n * @returns { Predicate } returns filter predicate\n */\n// eslint-disable-next-line\nfunction generateExpandPredicates(fields, values, instance) {\n    var filterCols = [];\n    for (var i = 0; i < fields.length; i++) {\n        var column = instance.parent.getColumnByField(fields[parseInt(i.toString(), 10)]);\n        var value = values[parseInt(i.toString(), 10)] === 'null' ? null : values[parseInt(i.toString(), 10)];\n        var pred = {\n            field: fields[parseInt(i.toString(), 10)], predicate: 'or', uid: column.uid, operator: 'equal', type: column.type,\n            matchCase: instance.allowCaseSensitive, ignoreAccent: instance.parent.filterSettings.ignoreAccent\n        };\n        if (value === '' || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value)) {\n            filterCols = filterCols.concat(_common_checkbox_filter_base__WEBPACK_IMPORTED_MODULE_9__.CheckBoxFilterBase.generateNullValuePredicates(pred));\n        }\n        else {\n            filterCols.push(extend({}, { value: value }, pred));\n        }\n    }\n    return _common_checkbox_filter_base__WEBPACK_IMPORTED_MODULE_9__.CheckBoxFilterBase.getPredicate(filterCols);\n}\n/**\n *\n * @param { Predicate } pred - Defines filter predicate\n * @returns { Predicate[] } Returns formed predicate\n */\nfunction getPredicates(pred) {\n    var predicateList = [];\n    for (var _i = 0, _a = Object.keys(pred); _i < _a.length; _i++) {\n        var prop = _a[_i];\n        predicateList.push(pred[\"\" + prop]);\n    }\n    return predicateList;\n}\n/**\n *\n * @param { number } index - Defines group caption indent\n * @param { Row<Column>[] } rowsObject - Defines rows object\n * @returns { { fields: string[], keys: string[] } } Returns grouped keys and values\n */\nfunction getGroupKeysAndFields(index, rowsObject) {\n    var fields = [];\n    var keys = [];\n    for (var i = index; i >= 0; i--) {\n        if (rowsObject[parseInt(i.toString(), 10)].isCaptionRow\n            && fields.indexOf(rowsObject[parseInt(i.toString(), 10)].data.field) === -1\n            && (rowsObject[parseInt(i.toString(), 10)].indent < rowsObject[parseInt(index.toString(), 10)].indent || i === index)) {\n            fields.push(rowsObject[parseInt(i.toString(), 10)].data.field);\n            keys.push(rowsObject[parseInt(i.toString(), 10)].data.key);\n            if (rowsObject[parseInt(i.toString(), 10)].indent === 0) {\n                break;\n            }\n        }\n    }\n    return { fields: fields, keys: keys };\n}\n// eslint-disable-next-line\n/**\n *\n * @param { number[][] } checkActiveMatrix - Defines matrix to check\n * @param { number[] } checkCellIndex - Defines index to check\n * @param { boolean } next - Defines select next or previous index\n * @returns { number[] } - Returns next active current index\n */\nfunction findCellIndex(checkActiveMatrix, checkCellIndex, next) {\n    var activeMatrix = checkActiveMatrix;\n    var cellIndex = checkCellIndex;\n    var currentCellIndexPass = false;\n    if (next) {\n        for (var i = cellIndex[0]; i < activeMatrix.length; i++) {\n            var rowCell = activeMatrix[parseInt(i.toString(), 10)];\n            for (var j = 0; j < rowCell.length; j++) {\n                if (currentCellIndexPass && activeMatrix[parseInt(i.toString(), 10)][parseInt(j.toString(), 10)] === 1) {\n                    cellIndex = [i, j];\n                    return cellIndex;\n                }\n                if (!currentCellIndexPass && cellIndex.toString() === [i, j].toString()) {\n                    currentCellIndexPass = true;\n                }\n            }\n        }\n    }\n    else {\n        for (var i = cellIndex[0]; i >= 0; i--) {\n            var rowCell = activeMatrix[parseInt(i.toString(), 10)];\n            for (var j = rowCell.length - 1; j >= 0; j--) {\n                if (currentCellIndexPass && activeMatrix[parseInt(i.toString(), 10)][parseInt(j.toString(), 10)] === 1) {\n                    cellIndex = [i, j];\n                    return cellIndex;\n                }\n                if (!currentCellIndexPass && cellIndex.toString() === [i, j].toString()) {\n                    currentCellIndexPass = true;\n                }\n            }\n        }\n    }\n    return cellIndex;\n}\n/**\n *\n * @param { string } string - Defines string need to capitalized first letter\n * @returns { string } - Returns capitalized first letter string\n */\nfunction capitalizeFirstLetter(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n}\n/**\n *\n * @param { IGrid } grid - Defines parent instance\n * @returns { boolean } - Returns is virtual\n */\nfunction checkIsVirtual(grid) {\n    return !(isGroupAdaptive(grid) || grid.groupSettings.enableLazyLoading\n        || (!grid.enableVirtualization && grid.enableColumnVirtualization));\n}\n/**\n *\n * @param { number[] } blockes - Defines block indexes\n * @returns { number[] } - Returns is visible page\n */\nfunction getVisiblePage(blockes) {\n    var visiblePage = [];\n    for (var i = 0; i < blockes.length; i++) {\n        var page = Math.ceil(blockes[parseInt(i.toString(), 10)] / 2);\n        if (visiblePage.indexOf(page) === -1) {\n            visiblePage.push(page);\n        }\n    }\n    return visiblePage;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9iYXNlL3V0aWwuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBbUk7QUFDL0I7QUFDZTtBQUNoRDtBQUNrQztBQUMzRDtBQUNpRDtBQUNsRDtBQUMyQjtBQUNoQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksUUFBUTtBQUNwQixZQUFZLFFBQVE7QUFDcEIsYUFBYSxTQUFTO0FBQ3RCO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksUUFBUTtBQUNwQixZQUFZLFFBQVE7QUFDcEIsWUFBWSxhQUFhO0FBQ3pCLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDTztBQUNQLFlBQVksdUVBQWlCLGdDQUFnQywwREFBUTtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksUUFBUTtBQUNwQixZQUFZLGFBQWE7QUFDekIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDTztBQUNQLFlBQVksdUVBQWlCLGdDQUFnQywwREFBUTtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsVUFBVTtBQUNyQixXQUFXLFFBQVE7QUFDbkIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsV0FBVyw2Q0FBNkM7QUFDeEQsYUFBYSxTQUFTO0FBQ3RCO0FBQ087QUFDUCxZQUFZLHVFQUFpQjtBQUM3QixTQUFTLHVFQUFp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LGdCQUFnQixxQ0FBcUM7QUFDckQ7QUFDTztBQUNQO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksYUFBYTtBQUN6QixZQUFZLFdBQVc7QUFDdkIsWUFBWSxVQUFVO0FBQ3RCLGNBQWMsV0FBVztBQUN6QjtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMseUJBQXlCO0FBQzVEO0FBQ0EsNEJBQTRCLG9CQUFvQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLFFBQVE7QUFDM0M7QUFDQSw2Q0FBNkMsUUFBUTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxTQUFTO0FBQ3JCLGNBQWMsU0FBUztBQUN2QjtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFFBQVE7QUFDcEIsY0FBYyxVQUFVO0FBQ3hCO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxXQUFXO0FBQ3ZCLGNBQWMsV0FBVztBQUN6QjtBQUNPO0FBQ1A7QUFDQSxvQkFBb0Isb0JBQW9CO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvYmFzZS91dGlsLmpzPzU2ZDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hpbGRQcm9wZXJ0eSwgY29tcGlsZSBhcyBiYXNlVGVtcGxhdGVDb21wbGllciwgc2V0VmFsdWUsIEludGVybmF0aW9uYWxpemF0aW9uLCBpc1VuZGVmaW5lZCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IGV4dGVuZCBhcyBiYXNlRXh0ZW5kLCBpc051bGxPclVuZGVmaW5lZCwgZ2V0VmFsdWUsIGNsYXNzTGlzdCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IHNldFN0eWxlQXR0cmlidXRlLCBhZGRDbGFzcywgYXR0cmlidXRlcywgcmVtb3ZlLCBjcmVhdGVFbGVtZW50LCByZW1vdmVDbGFzcyB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IGlzT2JqZWN0LCBzZWxlY3QsIHNlbGVjdEFsbCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IERhdGFVdGlsLCBRdWVyeSwgRGF0YU1hbmFnZXIsIFByZWRpY2F0ZSwgVXJsQWRhcHRvciwgRGVmZXJyZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItZGF0YSc7XG5pbXBvcnQgeyBDb2x1bW4gfSBmcm9tICcuLi9tb2RlbHMvY29sdW1uJztcbmltcG9ydCB7IGNhbGN1bGF0ZVJlbGF0aXZlQmFzZWRQb3NpdGlvbiwgY2FsY3VsYXRlUG9zaXRpb24gfSBmcm9tICdAc3luY2Z1c2lvbi9lajItcG9wdXBzJztcbmltcG9ydCB7IFByaW50IH0gZnJvbSAnLi4vYWN0aW9ucy9wcmludCc7XG5pbXBvcnQgeyBDaGVja0JveEZpbHRlckJhc2UgfSBmcm9tICcuLi9jb21tb24vY2hlY2tib3gtZmlsdGVyLWJhc2UnO1xuaW1wb3J0ICogYXMgbGl0ZXJhbHMgZnJvbSAnLi4vYmFzZS9zdHJpbmctbGl0ZXJhbHMnO1xuLy9odHRwczovL3R5cGVzY3JpcHQuY29kZXBsZXguY29tL2Rpc2N1c3Npb25zLzQwMTUwMVxuLyoqXG4gKiBGdW5jdGlvbiB0byBjaGVjayB3aGV0aGVyIHRhcmdldCBvYmplY3QgaW1wbGVtZW50IHNwZWNpZmljIGludGVyZmFjZVxuICpcbiAqIEBwYXJhbSAge09iamVjdH0gdGFyZ2V0IC0gc3BlY2lmaWVzIHRoZSB0YXJnZXRcbiAqIEBwYXJhbSAge3N0cmluZ30gY2hlY2tGb3IgLSBzcGVjaWZpZXMgdGhlIGNoZWNrZm9yc1xuICogQHJldHVybnMge2Jvb2xlYW59IHJldHVybnMgdGhlIGJvb2xlYW5cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRvZXNJbXBsZW1lbnRJbnRlcmZhY2UodGFyZ2V0LCBjaGVja0Zvcikge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgcmV0dXJuIHRhcmdldC5wcm90b3R5cGUgJiYgY2hlY2tGb3IgaW4gdGFyZ2V0LnByb3RvdHlwZTtcbn1cbi8qKlxuICogRnVuY3Rpb24gdG8gZ2V0IHZhbHVlIGZyb20gcHJvdmlkZWQgZGF0YVxuICpcbiAqIEBwYXJhbSAge3N0cmluZ30gZmllbGQgLSBzcGVjaWZpZXMgdGhlIGZpZWxkXG4gKiBAcGFyYW0gIHtPYmplY3R9IGRhdGEgLSBzcGVjaWZpZXMgdGhlIGRhdGFcbiAqIEBwYXJhbSAge0NvbHVtbk1vZGVsfSBjb2x1bW4gLSBzcGVjaWZpZXMgdGhlIGNvbHVtblxuICogQHJldHVybnMge09iamVjdH0gcmV0dXJucyB0aGUgb2JqZWN0XG4gKiBAaGlkZGVuXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuZXhwb3J0IGZ1bmN0aW9uIHZhbHVlQWNjZXNzb3IoZmllbGQsIGRhdGEsIGNvbHVtbikge1xuICAgIHJldHVybiAoaXNOdWxsT3JVbmRlZmluZWQoZmllbGQpIHx8IGZpZWxkID09PSAnJykgPyAnJyA6IERhdGFVdGlsLmdldE9iamVjdChmaWVsZCwgZGF0YSk7XG59XG4vKipcbiAqIERlZmluZXMgdGhlIG1ldGhvZCB1c2VkIHRvIGFwcGx5IGN1c3RvbSBoZWFkZXIgY2VsbCB2YWx1ZXMgZnJvbSBleHRlcm5hbCBmdW5jdGlvbiBhbmQgZGlzcGxheSB0aGlzIG9uIGVhY2ggaGVhZGVyIGNlbGwgcmVuZGVyZWQuXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfSBmaWVsZCAtIHNwZWNpZmllcyB0aGUgZmllbGRcbiAqIEBwYXJhbSAge0NvbHVtbk1vZGVsfSBjb2x1bW4gLSBzcGVjaWZpZXMgdGhlIGNvbHVtblxuICogQHJldHVybnMge29iamVjdH0gaGVhZGVyVmFsdWVBY2Nlc3NvclxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gaGVhZGVyVmFsdWVBY2Nlc3NvcihmaWVsZCwgY29sdW1uKSB7XG4gICAgcmV0dXJuIChpc051bGxPclVuZGVmaW5lZChmaWVsZCkgfHwgZmllbGQgPT09ICcnKSA/ICcnIDogRGF0YVV0aWwuZ2V0T2JqZWN0KGZpZWxkLCBjb2x1bW4pO1xufVxuLyoqXG4gKiBUaGUgZnVuY3Rpb24gdXNlZCB0byB1cGRhdGUgRG9tIHVzaW5nIHJlcXVlc3RBbmltYXRpb25GcmFtZS5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSB1cGRhdGVGdW5jdGlvbiAtIEZ1bmN0aW9uIHRoYXQgY29udGFpbnMgdGhlIGFjdHVhbCBhY3Rpb25cbiAqIEBwYXJhbSB7b2JqZWN0fSBjYWxsQmFjayAtIGRlZmluZXMgdGhlIGNhbGxiYWNrXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG5leHBvcnQgZnVuY3Rpb24gZ2V0VXBkYXRlVXNpbmdSYWYodXBkYXRlRnVuY3Rpb24sIGNhbGxCYWNrKSB7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNhbGxCYWNrKG51bGwsIHVwZGF0ZUZ1bmN0aW9uKCkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjYWxsQmFjayhlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuLyoqXG4gKiBAaGlkZGVuXG4gKiBAcGFyYW0ge1BkZkV4cG9ydFByb3BlcnRpZXMgfCBFeGNlbEV4cG9ydFByb3BlcnRpZXN9IGV4cG9ydFByb3BlcnRpZXMgLSBEZWZpbmVzIHRoZSBleHBvcnQgcHJvcGVydGllc1xuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgaXNFeHBvcnRDb2x1bW5zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0V4cG9ydENvbHVtbnMoZXhwb3J0UHJvcGVydGllcykge1xuICAgIHJldHVybiAhaXNOdWxsT3JVbmRlZmluZWQoZXhwb3J0UHJvcGVydGllcykgJiZcbiAgICAgICAgIWlzTnVsbE9yVW5kZWZpbmVkKGV4cG9ydFByb3BlcnRpZXMuY29sdW1ucykgJiYgZXhwb3J0UHJvcGVydGllcy5jb2x1bW5zLmxlbmd0aCA+IDA7XG59XG4vKipcbiAqIEBwYXJhbSB7UGRmRXhwb3J0UHJvcGVydGllcyB8IEV4Y2VsRXhwb3J0UHJvcGVydGllc30gZXhwb3J0UHJvcGVydGllcyAtIERlZmluZXMgdGhlIGV4cG9ydCBwcm9wZXJ0aWVzXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgZ3JpZCBvYmplY3RcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQ29sdW1uVHlwZUZvckV4cG9ydENvbHVtbnMoZXhwb3J0UHJvcGVydGllcywgZ09iaikge1xuICAgIHZhciBleHBvcnRDb2x1bW5zID0gZXhwb3J0UHJvcGVydGllcy5jb2x1bW5zO1xuICAgIHZhciBncmlkQ29sdW1ucyA9IGdPYmouY29sdW1ucztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV4cG9ydENvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGdyaWRDb2x1bW5zLmxlbmd0aCAtIDEgPj0gaSkge1xuICAgICAgICAgICAgaWYgKGdyaWRDb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBncmlkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRDb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXVxuICAgICAgICAgICAgICAgICAgICAgICAgLnR5cGUgPSBncmlkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1uc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0udHlwZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBleHBvcnRDb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS50eXBlID0gZ3JpZENvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnR5cGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEBoaWRkZW5cbiAqIEBwYXJhbSB7SUdyaWR9IGdyaWQgLSBEZWZpbmVzIHRoZSBncmlkXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZWNsb25lUm93KGdyaWQpIHtcbiAgICB2YXIgblJvd3MgPSBbXTtcbiAgICB2YXIgYWN0dWFsUm93cyA9IGdyaWQudlJvd3M7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhY3R1YWxSb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhY3R1YWxSb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0RhdGFSb3cpIHtcbiAgICAgICAgICAgIG5Sb3dzLnB1c2goYWN0dWFsUm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFhY3R1YWxSb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0RhdGFSb3cpIHtcbiAgICAgICAgICAgIG5Sb3dzLnB1c2goYWN0dWFsUm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgaWYgKCFhY3R1YWxSb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0V4cGFuZCAmJiBhY3R1YWxSb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0NhcHRpb25Sb3cpIHtcbiAgICAgICAgICAgICAgICBpICs9IGdldENvbGxhcHNlZFJvd3NDb3VudChhY3R1YWxSb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgZ3JpZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ3JpZC52Y1Jvd3MgPSBuUm93cztcbn1cbnZhciBjb3VudCA9IDA7XG4vKipcbiAqIEBoaWRkZW5cbiAqIEBwYXJhbSB7Um93PENvbHVtbj59IHZhbCAtIERlZmluZXMgdGhlIHZhbHVlXG4gKiBAcGFyYW0ge0lHcmlkfSBncmlkIC0gRGVmaW5lcyB0aGUgZ3JpZFxuICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgY29sbGFwc2VkIHJvdyBjb3VudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29sbGFwc2VkUm93c0NvdW50KHZhbCwgZ3JpZCkge1xuICAgIGNvdW50ID0gMDtcbiAgICB2YXIgZ1N1bW1hcnkgPSAnZ1N1bW1hcnknO1xuICAgIHZhciB0b3RhbCA9ICdjb3VudCc7XG4gICAgdmFyIGdMZW4gPSBncmlkLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGg7XG4gICAgdmFyIHJlY29yZHMgPSAncmVjb3Jkcyc7XG4gICAgdmFyIGl0ZW1zID0gJ2l0ZW1zJztcbiAgICB2YXIgdmFsdWUgPSB2YWxbXCJcIiArIGdTdW1tYXJ5XTtcbiAgICB2YXIgZGF0YVJvd0NudCA9IDA7XG4gICAgdmFyIGFnckNudCA9ICdhZ2dyZWdhdGVzQ291bnQnO1xuICAgIGlmICh2YWx1ZSA9PT0gdmFsLmRhdGFbXCJcIiArIHRvdGFsXSkge1xuICAgICAgICBpZiAoZ3JpZC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICYmICFpc051bGxPclVuZGVmaW5lZCh2YWxbXCJcIiArIGFnckNudF0pICYmIHZhbFtcIlwiICsgYWdyQ250XSkge1xuICAgICAgICAgICAgaWYgKGdyaWQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgICAgIGNvdW50ICs9ICh2YWwuaW5kZW50ICE9PSAwICYmICh2YWx1ZSkgPCAyKSA/ICh2YWxbXCJcIiArIGdTdW1tYXJ5XSAqICgoZ0xlbiAtIHZhbC5pbmRlbnQpICsgKGdMZW4gLSB2YWwuaW5kZW50KSAqIHZhbFtcIlwiICsgYWdyQ250XSkpIDpcbiAgICAgICAgICAgICAgICAgICAgKHZhbFtcIlwiICsgZ1N1bW1hcnldICogKChnTGVuIC0gdmFsLmluZGVudCkgKyAoZ0xlbiAtIHZhbC5pbmRlbnQgLSAxKSAqIHZhbFtcIlwiICsgYWdyQ250XSkpICsgdmFsW1wiXCIgKyBhZ3JDbnRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZ3JpZC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgY291bnQgKz0gKHZhbFtcIlwiICsgZ1N1bW1hcnldICogKGdMZW4gLSB2YWwuaW5kZW50KSkgKyB2YWxbXCJcIiArIGFnckNudF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZ3JpZC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoZ3JpZC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgY291bnQgKz0gdmFsW1wiXCIgKyBnU3VtbWFyeV0gKiAoZ3JpZC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoIC0gdmFsLmluZGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb3VudCArPSB2YWxbXCJcIiArIGdTdW1tYXJ5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY291bnQ7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdmFsLmRhdGFbXCJcIiArIGl0ZW1zXS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGdMZXZlbCA9IHZhbC5kYXRhW1wiXCIgKyBpdGVtc11bcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgY291bnQgKz0gZ0xldmVsW1wiXCIgKyBpdGVtc10ubGVuZ3RoICsgKChnTGVuICE9PSBncmlkLmNvbHVtbnMubGVuZ3RoKSAmJlxuICAgICAgICAgICAgICAgICFpc051bGxPclVuZGVmaW5lZChnTGV2ZWxbXCJcIiArIGl0ZW1zXVtcIlwiICsgcmVjb3Jkc10pID8gZ0xldmVsW1wiXCIgKyBpdGVtc11bXCJcIiArIHJlY29yZHNdLmxlbmd0aCA6IDApO1xuICAgICAgICAgICAgZGF0YVJvd0NudCArPSAoIWlzTnVsbE9yVW5kZWZpbmVkKGdMZXZlbFtcIlwiICsgaXRlbXNdW1wiXCIgKyByZWNvcmRzXSkgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKHZhbFtcIlwiICsgYWdyQ250XSkpID8gZ0xldmVsW1wiXCIgKyBpdGVtc11bXCJcIiArIHJlY29yZHNdLmxlbmd0aCA6XG4gICAgICAgICAgICAgICAgZ0xldmVsW1wiXCIgKyBpdGVtc10ubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKGdMZXZlbFtcIlwiICsgaXRlbXNdLkdyb3VwR3VpZCAmJiBnTGV2ZWxbXCJcIiArIGl0ZW1zXS5jaGlsZExldmVscyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZShnTGV2ZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvdW50ICs9IHZhbC5kYXRhW1wiXCIgKyBpdGVtc10ubGVuZ3RoO1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHZhbFtcIlwiICsgYWdyQ250XSkpIHtcbiAgICAgICAgICAgIGlmICh2YWxbXCJcIiArIGFnckNudF0gJiYgY291bnQgJiYgZGF0YVJvd0NudCAhPT0gMCkge1xuICAgICAgICAgICAgICAgIGNvdW50ICs9ICgoY291bnQgLSBkYXRhUm93Q250KSAqIHZhbFtcIlwiICsgYWdyQ250XSkgKyB2YWxbXCJcIiArIGFnckNudF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvdW50O1xufVxuLyoqXG4gKiBAcGFyYW0ge09iamVjdFtdfSByb3cgLSBEZWZpbmVzIHRoZSByb3dcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjdXJzaXZlKHJvdykge1xuICAgIHZhciBpdGVtcyA9ICdpdGVtcyc7XG4gICAgdmFyIHJDb3VudCA9ICdjb3VudCc7XG4gICAgZm9yICh2YXIgaiA9IDAsIGxlbmd0aF8xID0gcm93W1wiXCIgKyBpdGVtc10ubGVuZ3RoOyBqIDwgbGVuZ3RoXzE7IGorKykge1xuICAgICAgICB2YXIgbkxldmVsID0gcm93W1wiXCIgKyBpdGVtc11bcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldO1xuICAgICAgICBjb3VudCArPSBuTGV2ZWxbXCJcIiArIHJDb3VudF07XG4gICAgICAgIGlmIChuTGV2ZWxbXCJcIiArIGl0ZW1zXS5jaGlsZExldmVscyAhPT0gMCkge1xuICAgICAgICAgICAgcmVjdXJzaXZlKG5MZXZlbCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0W119IGNvbGxlY3Rpb24gLSBEZWZpbmVzIHRoZSBhcnJheVxuICogQHBhcmFtIHtPYmplY3R9IHByZWRpY2F0ZSAtIERlZmluZXMgdGhlIHByZWRpY2F0ZVxuICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgb2JqZWN0XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpdGVyYXRlQXJyYXlPck9iamVjdChjb2xsZWN0aW9uLCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNvbGxlY3Rpb24ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdmFyIHByZWQgPSBwcmVkaWNhdGUoY29sbGVjdGlvbltwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGkpO1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHByZWQpKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChwcmVkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuLyoqXG4gKiBAcGFyYW0ge09iamVjdFtdfSBhcnJheSAtIERlZmluZXMgdGhlIGFycmF5XG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBvYmplY3RcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGl0ZXJhdGVFeHRlbmQoYXJyYXkpIHtcbiAgICB2YXIgb2JqID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICBvYmoucHVzaChiYXNlRXh0ZW5kKHt9LCBnZXRBY3R1YWxQcm9wZXJ0aWVzKGFycmF5W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSksIHt9LCB0cnVlKSk7XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG59XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nIHwgRnVuY3Rpb259IHRlbXBsYXRlIC0gRGVmaW5lcyB0aGUgdGVtcGxhdGVcbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgZnVuY3Rpb25cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRlbXBsYXRlQ29tcGlsZXIodGVtcGxhdGUpIHtcbiAgICBpZiAodGVtcGxhdGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciB2YWxpZFNlbGVjdG9yID0gdGVtcGxhdGVbMF0gIT09ICc8JztcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGVtcGxhdGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZVRlbXBsYXRlQ29tcGxpZXIodGVtcGxhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsaWRTZWxlY3RvciAmJiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRlbXBsYXRlKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZVRlbXBsYXRlQ29tcGxpZXIoZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0ZW1wbGF0ZSkuaW5uZXJIVE1MLnRyaW0oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZVRlbXBsYXRlQ29tcGxpZXIodGVtcGxhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gYmFzZVRlbXBsYXRlQ29tcGxpZXIodGVtcGxhdGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59XG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gbm9kZSAtIERlZmluZXMgdGhlIGNvbHVtblxuICogQHBhcmFtIHtPYmplY3R9IGN1c3RvbUF0dHJpYnV0ZXMgLSBEZWZpbmVzIHRoZSBpbmRleFxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRTdHlsZUFuZEF0dHJpYnV0ZXMobm9kZSwgY3VzdG9tQXR0cmlidXRlcykge1xuICAgIHZhciBjb3B5QXR0ciA9IHt9O1xuICAgIHZhciBsaXRlcmFscyA9IFsnc3R5bGUnLCAnY2xhc3MnXTtcbiAgICAvL0RvbnQgdG91Y2ggdGhlIG9yaWdpbmFsIG9iamVjdCAtIG1ha2UgYSBjb3B5XG4gICAgYmFzZUV4dGVuZChjb3B5QXR0ciwgY3VzdG9tQXR0cmlidXRlcywge30pO1xuICAgIGlmICgnc3R5bGUnIGluIGNvcHlBdHRyKSB7XG4gICAgICAgIHNldFN0eWxlQXR0cmlidXRlKG5vZGUsIGNvcHlBdHRyW2xpdGVyYWxzWzBdXSk7XG4gICAgICAgIGRlbGV0ZSBjb3B5QXR0cltsaXRlcmFsc1swXV07XG4gICAgfVxuICAgIGlmICgnY2xhc3MnIGluIGNvcHlBdHRyKSB7XG4gICAgICAgIGFkZENsYXNzKFtub2RlXSwgY29weUF0dHJbbGl0ZXJhbHNbMV1dKTtcbiAgICAgICAgZGVsZXRlIGNvcHlBdHRyW2xpdGVyYWxzWzFdXTtcbiAgICB9XG4gICAgYXR0cmlidXRlcyhub2RlLCBjb3B5QXR0cik7XG59XG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb3BpZWQgLSBEZWZpbmVzIHRoZSBjb2x1bW5cbiAqIEBwYXJhbSB7T2JqZWN0fSBmaXJzdCAtIERlZmluZXMgdGhlIGlubmRleFxuICogQHBhcmFtIHtPYmplY3R9IHNlY29uZCAtIERlZmluZXMgdGhlIHNlY29uZCBvYmplY3RcbiAqIEBwYXJhbSB7c3RyaW5nW119IGV4Y2x1ZGUgLSBEZWZpbmVzIHRoZSBleGNsdWRlXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBvYmplY3RcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuZChjb3BpZWQsIGZpcnN0LCBzZWNvbmQsIGV4Y2x1ZGUpIHtcbiAgICB2YXIgbW92ZWQgPSBiYXNlRXh0ZW5kKGNvcGllZCwgZmlyc3QsIHNlY29uZCk7XG4gICAgdmFyIHZhbHVlcyA9IE9iamVjdC5rZXlzKG1vdmVkKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoZXhjbHVkZSAmJiBleGNsdWRlLmluZGV4T2YodmFsdWVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSkgIT09IC0xKSB7XG4gICAgICAgICAgICBkZWxldGUgbW92ZWRbdmFsdWVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1vdmVkO1xufVxuLyoqXG4gKiBAcGFyYW0ge0NvbHVtbltdfSBjb2x1bW5Nb2RlbCAtIERlZmluZXMgdGhlIGNvbHVtblxuICogQHBhcmFtIHtudW1iZXJ9IGluZCAtIERlZmluZXMgdGhlIGlubmRleFxuICogQHJldHVybnMge251bWJlcn0gLSBSZXR1cm5zIHRoZSBjb2x1bW5pbmRleFxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q29sdW1uSW5kZXgoY29sdW1uTW9kZWwsIGluZCkge1xuICAgIGlmIChpbmQgPT09IHZvaWQgMCkgeyBpbmQgPSAwOyB9XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9ICghaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uTW9kZWwpID8gY29sdW1uTW9kZWwubGVuZ3RoIDogMCk7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoY29sdW1uTW9kZWxbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpIHtcbiAgICAgICAgICAgIGNvbHVtbk1vZGVsW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRleCA9IGlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbk1vZGVsW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRleCkgPyBpbmRcbiAgICAgICAgICAgICAgICA6IGNvbHVtbk1vZGVsW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRleDtcbiAgICAgICAgICAgIGluZCsrO1xuICAgICAgICAgICAgaW5kID0gc2V0Q29sdW1uSW5kZXgoY29sdW1uTW9kZWxbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMsIGluZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb2x1bW5Nb2RlbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZXggPSBpc051bGxPclVuZGVmaW5lZChjb2x1bW5Nb2RlbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZXgpID8gaW5kXG4gICAgICAgICAgICAgICAgOiBjb2x1bW5Nb2RlbFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZXg7XG4gICAgICAgICAgICBpbmQrKztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaW5kO1xufVxuLyoqXG4gKiBAcGFyYW0ge0NvbHVtbltdIHwgc3RyaW5nW10gfCBDb2x1bW5Nb2RlbFtdfSBjb2x1bW5zIC0gRGVmaW5lcyB0aGUgY29sdW1uXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGF1dG9XaWR0aCAtIERlZmluZXMgdGhlIGF1dG93aWR0aFxuICogQHBhcmFtIHtJR3JpZH0gZ09iaiAtIERlZmluZXMgdGhlIGNsYXNzIG5hbWVcbiAqIEByZXR1cm5zIHtDb2x1bW59IC0gUmV0dXJucyB0aGUgY29sdW1uc1xuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gcHJlcGFyZUNvbHVtbnMoY29sdW1ucywgYXV0b1dpZHRoLCBnT2JqKSB7XG4gICAgZm9yICh2YXIgYyA9IDAsIGxlbiA9ICghaXNOdWxsT3JVbmRlZmluZWQoY29sdW1ucykgPyBjb2x1bW5zLmxlbmd0aCA6IDApOyBjIDwgbGVuOyBjKyspIHtcbiAgICAgICAgdmFyIGNvbHVtbiA9IHZvaWQgMDtcbiAgICAgICAgaWYgKHR5cGVvZiBjb2x1bW5zW3BhcnNlSW50KGMudG9TdHJpbmcoKSwgMTApXSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbHVtbiA9IG5ldyBDb2x1bW4oeyBmaWVsZDogY29sdW1uc1twYXJzZUludChjLnRvU3RyaW5nKCksIDEwKV0gfSwgZ09iaik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIShjb2x1bW5zW3BhcnNlSW50KGMudG9TdHJpbmcoKSwgMTApXSBpbnN0YW5jZW9mIENvbHVtbikgfHwgY29sdW1uc1twYXJzZUludChjLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucykge1xuICAgICAgICAgICAgaWYgKCFjb2x1bW5zW3BhcnNlSW50KGMudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uID0gbmV3IENvbHVtbihjb2x1bW5zW3BhcnNlSW50KGMudG9TdHJpbmcoKSwgMTApXSwgZ09iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5zW3BhcnNlSW50KGMudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zID0gcHJlcGFyZUNvbHVtbnMoY29sdW1uc1twYXJzZUludChjLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucywgbnVsbCwgZ09iaik7XG4gICAgICAgICAgICAgICAgY29sdW1uID0gbmV3IENvbHVtbihjb2x1bW5zW3BhcnNlSW50KGMudG9TdHJpbmcoKSwgMTApXSwgZ09iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb2x1bW4gPSBjb2x1bW5zW3BhcnNlSW50KGMudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29sdW1uLnR5cGUgJiYgY29sdW1uLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ2NoZWNrYm94Jykge1xuICAgICAgICAgICAgY29sdW1uLmFsbG93UmVvcmRlcmluZyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbHVtbi5oZWFkZXJUZXh0ID0gaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLmhlYWRlclRleHQpID8gY29sdW1uLmZvcmVpZ25LZXlWYWx1ZSB8fCBjb2x1bW4uZmllbGQgfHwgJycgOiBjb2x1bW4uaGVhZGVyVGV4dDtcbiAgICAgICAgY29sdW1uLmZvcmVpZ25LZXlGaWVsZCA9IGNvbHVtbi5mb3JlaWduS2V5RmllbGQgfHwgY29sdW1uLmZpZWxkO1xuICAgICAgICBjb2x1bW4udmFsdWVBY2Nlc3NvciA9ICh0eXBlb2YgY29sdW1uLnZhbHVlQWNjZXNzb3IgPT09ICdzdHJpbmcnID8gZ2V0VmFsdWUoY29sdW1uLnZhbHVlQWNjZXNzb3IsIHdpbmRvdylcbiAgICAgICAgICAgIDogY29sdW1uLnZhbHVlQWNjZXNzb3IpIHx8IHZhbHVlQWNjZXNzb3I7XG4gICAgICAgIGNvbHVtbi5oZWFkZXJWYWx1ZUFjY2Vzc29yID0gdHlwZW9mIGNvbHVtbi5oZWFkZXJWYWx1ZUFjY2Vzc29yID09PSAnc3RyaW5nJyA/IGdldFZhbHVlKGNvbHVtbi5oZWFkZXJWYWx1ZUFjY2Vzc29yLCB3aW5kb3cpXG4gICAgICAgICAgICA6IGNvbHVtbi5oZWFkZXJWYWx1ZUFjY2Vzc29yO1xuICAgICAgICBjb2x1bW4ud2lkdGggPSBhdXRvV2lkdGggJiYgaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLndpZHRoKSA/IDIwMCA6IGNvbHVtbi53aWR0aDtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbi52aXNpYmxlKSkge1xuICAgICAgICAgICAgY29sdW1uLnZpc2libGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbHVtbnNbcGFyc2VJbnQoYy50b1N0cmluZygpLCAxMCldID0gY29sdW1uO1xuICAgIH1cbiAgICByZXR1cm4gY29sdW1ucztcbn1cbi8qKlxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gcG9wVXAgLSBEZWZpbmVzIHRoZSBwb3B1cCBlbGVtZW50XG4gKiBAcGFyYW0ge01vdXNlRXZlbnQgfCBUb3VjaEV2ZW50fSBlIC0gRGVmaW5lcyB0aGUgbW9vdXNlIGV2ZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIC0gRGVmaW5lcyB0aGUgY2xhc3MgbmFtZVxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRDc3NJbkdyaWRQb3BVcChwb3BVcCwgZSwgY2xhc3NOYW1lKSB7XG4gICAgdmFyIHBvcFVwU3BhbiA9IHBvcFVwLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcbiAgICB2YXIgcG9zaXRpb24gPSBwb3BVcC5wYXJlbnRFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHZhciB0YXJnZXRQb3NpdGlvbiA9IGUudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHBvcFVwU3Bhbi5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgcG9wVXAuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgIHZhciBpc0JvdHRvbVRhaWwgPSAoaXNOdWxsT3JVbmRlZmluZWQoZS5jbGllbnRZKSA/IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WSA6XG4gICAgICAgIGUuY2xpZW50WSkgPiBwb3BVcC5vZmZzZXRIZWlnaHQgKyAxMDtcbiAgICBwb3BVcC5zdHlsZS50b3AgPSB0YXJnZXRQb3NpdGlvbi50b3AgLSBwb3NpdGlvbi50b3AgK1xuICAgICAgICAoaXNCb3R0b21UYWlsID8gLShwb3BVcC5vZmZzZXRIZWlnaHQgKyAxMCkgOiBwb3BVcC5vZmZzZXRIZWlnaHQgKyAxMCkgKyAncHgnOyAvLzEwcHggZm9yIHRhaWwgZWxlbWVudFxuICAgIHBvcFVwLnN0eWxlLmxlZnQgPSBnZXRQb3B1cExlZnRQb3NpdGlvbihwb3BVcCwgZSwgdGFyZ2V0UG9zaXRpb24sIHBvc2l0aW9uLmxlZnQpICsgJ3B4JztcbiAgICBpZiAoaXNCb3R0b21UYWlsKSB7XG4gICAgICAgIHBvcFVwLnF1ZXJ5U2VsZWN0b3IoJy5lLWRvd250YWlsJykuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICBwb3BVcC5xdWVyeVNlbGVjdG9yKCcuZS11cHRhaWwnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcG9wVXAucXVlcnlTZWxlY3RvcignLmUtZG93bnRhaWwnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBwb3BVcC5xdWVyeVNlbGVjdG9yKCcuZS11cHRhaWwnKS5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBwb3B1cCAtIERlZmluZXMgdGhlIHBvcHVwIGVsZW1lbnRcbiAqIEBwYXJhbSB7TW91c2VFdmVudCB8IFRvdWNoRXZlbnR9IGUgIC0gRGVmaW5lcyB0aGUgbW91c2UgZXZlbnRcbiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQb3NpdGlvbiAtIERlZmluZXMgdGhlIHRhcmdldCBwb3NpdGlvblxuICogQHBhcmFtIHtudW1iZXJ9IHRhcmdldFBvc2l0aW9uLnRvcCAtIERlZmluZXMgdGhlIHRvcCBwb3NpdGlvblxuICogQHBhcmFtIHtudW1iZXJ9IHRhcmdldFBvc2l0aW9uLmxlZnQgIC0gRGVmaW5lcyB0aGUgbGVmdCBwb3NpdGlvblxuICogQHBhcmFtIHtudW1iZXJ9IHRhcmdldFBvc2l0aW9uLnJpZ2h0ICAtIERlZmluZXMgdGhlIHJpZ2h0IHBvc2l0aW9uXG4gKiBAcGFyYW0ge251bWJlcn0gbGVmdCAtIERlZmluZXMgdGhlIGxlZnQgcG9zaXRpb25cbiAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHBvcHVwIGxlZnQgcG9zaXRpb25cbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gZ2V0UG9wdXBMZWZ0UG9zaXRpb24ocG9wdXAsIGUsIHRhcmdldFBvc2l0aW9uLCBsZWZ0KSB7XG4gICAgdmFyIHdpZHRoID0gcG9wdXAub2Zmc2V0V2lkdGggLyAyO1xuICAgIHZhciB4ID0gZ2V0UG9zaXRpb24oZSkueDtcbiAgICBpZiAoeCAtIHRhcmdldFBvc2l0aW9uLmxlZnQgPCB3aWR0aCkge1xuICAgICAgICByZXR1cm4gdGFyZ2V0UG9zaXRpb24ubGVmdCAtIGxlZnQ7XG4gICAgfVxuICAgIGVsc2UgaWYgKHRhcmdldFBvc2l0aW9uLnJpZ2h0IC0geCA8IHdpZHRoKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXRQb3NpdGlvbi5yaWdodCAtIGxlZnQgLSB3aWR0aCAqIDI7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4geCAtIGxlZnQgLSB3aWR0aDtcbiAgICB9XG59XG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmogLSBEZWZpbmVzIHRoZSBvYmplY3RcbiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIFByb3BlcnRpZXNcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFjdHVhbFByb3BlcnRpZXMob2JqKSB7XG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIENoaWxkUHJvcGVydHkpIHtcbiAgICAgICAgcmV0dXJuIGdldFZhbHVlKCdwcm9wZXJ0aWVzJywgb2JqKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW0gLSBEZWZpbmVzIHRoZSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3IgLSBEZWZpbmVzIHRoZSBzdHJpbmcgc2VsZWN0b3JcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNJRCAtIERlZmluZXMgdGhlIGlzSURcbiAqIEByZXR1cm5zIHtFbGVtZW50fSBSZXR1cm5zIHRoZSBlbGVtZW50XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJlbnRzVW50aWwoZWxlbSwgc2VsZWN0b3IsIGlzSUQpIHtcbiAgICB2YXIgcGFyZW50ID0gZWxlbTtcbiAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICAgIGlmIChpc0lEID8gcGFyZW50LmlkID09PSBzZWxlY3RvciA6IHBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50RWxlbWVudDtcbiAgICB9XG4gICAgcmV0dXJuIHBhcmVudDtcbn1cbi8qKlxuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC0gRGVmaW5lcyB0aGUgZWxlbWVudFxuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50cyAtIERlZmluZXMgdGhlIGVsZW1lbnRcbiAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGVsZW1lbnQgaW5kZXhcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRJbmRleChlbGVtZW50LCBlbGVtZW50cykge1xuICAgIHZhciBpbmRleCA9IC0xO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBlbGVtZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoZWxlbWVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzRXF1YWxOb2RlKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaW5kZXg7XG59XG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWx1ZSAtIERlZmluZXMgdGhlIHZhbHVlXG4gKiBAcGFyYW0ge09iamVjdH0gY29sbGVjdGlvbiAtIGRlZmluZXMgdGhlIGNvbGxlY3Rpb25cbiAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGFycmF5XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbkFycmF5KHZhbHVlLCBjb2xsZWN0aW9uKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNvbGxlY3Rpb24ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKGNvbGxlY3Rpb25bcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIC0xO1xufVxuLyoqXG4gKiBAcGFyYW0ge09iamVjdH0gY29sbGVjdGlvbiAtIERlZmluZXMgdGhlIGNvbGxlY3Rpb25cbiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG9iamVjdFxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWN0dWFsUHJvcEZyb21Db2xsKGNvbGxlY3Rpb24pIHtcbiAgICB2YXIgY29sbCA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb2xsZWN0aW9uLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbiAgICAgICAgaWYgKGNvbGxlY3Rpb25bcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmhhc093blByb3BlcnR5KCdwcm9wZXJ0aWVzJykpIHtcbiAgICAgICAgICAgIGNvbGwucHVzaChjb2xsZWN0aW9uW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5wcm9wZXJ0aWVzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbGwucHVzaChjb2xsZWN0aW9uW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvbGw7XG59XG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gdGFyZ2V0IC0gRGVmaW5lcyB0aGUgdGFyZ2V0IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvciAtIERlZmluZXMgdGhlIHNlbGVjdG9yXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQodGFyZ2V0LCBzZWxlY3Rvcikge1xuICAgIHZhciBlbGVtZW50cyA9IFtdLnNsaWNlLmNhbGwodGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHJlbW92ZShlbGVtZW50c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgIH1cbn1cbi8qKlxuICogQHBhcmFtIHtNb3VzZUV2ZW50IHwgVG91Y2hFdmVudH0gZSBEZWZpbmVzIHRoZSBtb3VzZSBldmVudFxuICogQHJldHVybnMge0lQb3NpdGlvbn0gUmV0dXJucyB0aGUgcG9zaXRpb25cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBvc2l0aW9uKGUpIHtcbiAgICB2YXIgcG9zaXRpb24gPSB7fTtcbiAgICBwb3NpdGlvbi54ID0gKGlzTnVsbE9yVW5kZWZpbmVkKGUuY2xpZW50WCkgPyBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFggOlxuICAgICAgICBlLmNsaWVudFgpO1xuICAgIHBvc2l0aW9uLnkgPSAoaXNOdWxsT3JVbmRlZmluZWQoZS5jbGllbnRZKSA/IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WSA6XG4gICAgICAgIGUuY2xpZW50WSk7XG4gICAgcmV0dXJuIHBvc2l0aW9uO1xufVxudmFyIHVpZCA9IDA7XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcmVmaXggLSBEZWZpbmVzIHRoZSBwcmVmaXggc3RyaW5nXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSB1aWRcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFVpZChwcmVmaXgpIHtcbiAgICByZXR1cm4gcHJlZml4ICsgdWlkKys7XG59XG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudCB8IERvY3VtZW50RnJhZ21lbnR9IGVsZW0gLSBEZWZpbmVzIHRoZSBlbGVtZW50XG4gKiBAcGFyYW0ge0VsZW1lbnRbXSB8IE5vZGVMaXN0fSBjaGlsZHJlbiAtIERlZmluZXMgdGhlIEVsZW1lbnRcbiAqIEByZXR1cm5zIHtFbGVtZW50fSBSZXR1cm5zIHRoZSBlbGVtZW50XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcHBlbmRDaGlsZHJlbihlbGVtLCBjaGlsZHJlbikge1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAobGVuID09PSBjaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgIGVsZW0uYXBwZW5kQ2hpbGQoY2hpbGRyZW5bcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVsZW0uYXBwZW5kQ2hpbGQoY2hpbGRyZW5bMF0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlbGVtO1xufVxuLyoqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW0gLSBEZWZpbmVzIHRoZSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3IgLSBEZWZpbmVzIHRoZSBzZWxlY3RvclxuICogQHBhcmFtIHtib29sZWFufSBpc0lEIC0gRGVmaW5lcyBpc0lEXG4gKiBAcmV0dXJucyB7RWxlbWVudH0gUmV0dXJuIHRoZSBlbGVtZW50XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJlbnRzKGVsZW0sIHNlbGVjdG9yLCBpc0lEKSB7XG4gICAgdmFyIHBhcmVudCA9IGVsZW07XG4gICAgdmFyIHBhcmVudHMgPSBbXTtcbiAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICAgIGlmIChpc0lEID8gcGFyZW50LmlkID09PSBzZWxlY3RvciA6IHBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICBwYXJlbnRzLnB1c2gocGFyZW50KTtcbiAgICAgICAgfVxuICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50RWxlbWVudDtcbiAgICB9XG4gICAgcmV0dXJuIHBhcmVudHM7XG59XG4vKipcbiAqIEBwYXJhbSB7QWdncmVnYXRlVHlwZSB8IHN0cmluZ30gdHlwZSAtIERlZmluZXMgdGhlIHR5cGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gRGVmaW5lcyB0aGUgZGF0YVxuICogQHBhcmFtIHtBZ2dyZWdhdGVDb2x1bW5Nb2RlbH0gY29sdW1uIC0gRGVmaW5lcyB0aGUgY29sdW1uXG4gKiBAcGFyYW0ge09iamVjdH0gY29udGV4dCAtIERlZmluZXMgdGhlIGNvbnRleHRcbiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNhbGN1bGF0ZWQgYWdncmFnYXRlXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVBZ2dyZWdhdGUodHlwZSwgZGF0YSwgY29sdW1uLCBjb250ZXh0KSB7XG4gICAgaWYgKHR5cGUgPT09ICdDdXN0b20nKSB7XG4gICAgICAgIHZhciB0ZW1wID0gY29sdW1uLmN1c3RvbUFnZ3JlZ2F0ZTtcbiAgICAgICAgaWYgKHR5cGVvZiB0ZW1wID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGVtcCA9IGdldFZhbHVlKHRlbXAsIHdpbmRvdyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRlbXAgPyB0ZW1wLmNhbGwoY29udGV4dCwgZGF0YSwgY29sdW1uKSA6ICcnO1xuICAgIH1cbiAgICByZXR1cm4gKGNvbHVtbi5maWVsZCBpbiBkYXRhIHx8IGRhdGEgaW5zdGFuY2VvZiBBcnJheSkgPyBEYXRhVXRpbC5hZ2dyZWdhdGVzW3R5cGUudG9Mb3dlckNhc2UoKV0oZGF0YSwgY29sdW1uLmZpZWxkKSA6IG51bGw7XG59XG4vKiogQGhpZGRlbiAqL1xudmFyIHNjcm9sbFdpZHRoID0gbnVsbDtcbi8qKiBAaGlkZGVuXG4gKiBAcmV0dXJucyB7bnVtYmVyfSAtIFJldHVybnMgdGhlIHNjcm9sbGJhcndpZHRoXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTY3JvbGxCYXJXaWR0aCgpIHtcbiAgICBpZiAoc2Nyb2xsV2lkdGggIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHNjcm9sbFdpZHRoO1xuICAgIH1cbiAgICB2YXIgZGl2Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHZhciB2YWx1ZSA9IDA7XG4gICAgZGl2Tm9kZS5zdHlsZS5jc3NUZXh0ID0gJ3dpZHRoOjEwMHB4O2hlaWdodDogMTAwcHg7b3ZlcmZsb3c6IHNjcm9sbDtwb3NpdGlvbjogYWJzb2x1dGU7dG9wOiAtOTk5OXB4Oyc7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaXZOb2RlKTtcbiAgICB2YWx1ZSA9IChkaXZOb2RlLm9mZnNldFdpZHRoIC0gZGl2Tm9kZS5jbGllbnRXaWR0aCkgfCAwO1xuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZGl2Tm9kZSk7XG4gICAgcmV0dXJuIHNjcm9sbFdpZHRoID0gdmFsdWU7XG59XG4vKiogQGhpZGRlbiAqL1xudmFyIHJvd0hlaWdodDtcbi8qKiBAaGlkZGVuICovXG52YXIgYWNjdXJhdGVSb3dIZWlnaHQ7XG4vKipcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnQgLSBEZWZpbmVzIHRoZSBlbGVtZW50XG4gKiBAcGFyYW0ge2Jvb2xlYW59IGFjY3VyYXRlSGVpZ2h0IC0gRGVmaW5lcyB0aGUgYWNjdXJhdGUgcm93IGhlaWdodFxuICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgcm93dyBoZWlnaHRcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJvd0hlaWdodChlbGVtZW50LCBhY2N1cmF0ZUhlaWdodCkge1xuICAgIGlmIChhY2N1cmF0ZUhlaWdodCAmJiBhY2N1cmF0ZVJvd0hlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBhY2N1cmF0ZVJvd0hlaWdodDtcbiAgICB9XG4gICAgaWYgKHJvd0hlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiByb3dIZWlnaHQ7XG4gICAgfVxuICAgIHZhciB0YWJsZSA9IGNyZWF0ZUVsZW1lbnQoJ3RhYmxlJywgeyBjbGFzc05hbWU6IGxpdGVyYWxzLnRhYmxlLCBhdHRyczogeyByb2xlOiAnZ3JpZCcgfSB9KTtcbiAgICB0YWJsZS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgdGFibGUuaW5uZXJIVE1MID0gJzx0cj48dGQgY2xhc3M9XCJlLXJvd2NlbGxcIj5BPHRkPjwvdHI+JztcbiAgICBlbGVtZW50LmFwcGVuZENoaWxkKHRhYmxlKTtcbiAgICB2YXIgcmVjdCA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3IoJ3RkJykuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgZWxlbWVudC5yZW1vdmVDaGlsZCh0YWJsZSk7XG4gICAgYWNjdXJhdGVSb3dIZWlnaHQgPSByZWN0LmhlaWdodDtcbiAgICByb3dIZWlnaHQgPSBNYXRoLmNlaWwocmVjdC5oZWlnaHQpO1xuICAgIGlmIChhY2N1cmF0ZUhlaWdodCkge1xuICAgICAgICByZXR1cm4gYWNjdXJhdGVSb3dIZWlnaHQ7XG4gICAgfVxuICAgIHJldHVybiByb3dIZWlnaHQ7XG59XG4vKipcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnQgLSBEZWZpbmVzIHRoZSBIVE1sIGVsZW1lbnRcbiAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHJvdyBoZWlnaHRcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFjdHVhbFJvd0hlaWdodChlbGVtZW50KSB7XG4gICAgdmFyIHRhYmxlID0gY3JlYXRlRWxlbWVudCgndGFibGUnLCB7IGNsYXNzTmFtZTogbGl0ZXJhbHMudGFibGUsIGF0dHJzOiB7IHJvbGU6ICdncmlkJyB9IH0pO1xuICAgIHRhYmxlLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICB0YWJsZS5pbm5lckhUTUwgPSAnPHRyPjx0ZCBjbGFzcz1cImUtcm93Y2VsbFwiPkE8dGQ+PC90cj4nO1xuICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQodGFibGUpO1xuICAgIHZhciByZWN0ID0gdGFibGUucXVlcnlTZWxlY3RvcigndHInKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBlbGVtZW50LnJlbW92ZUNoaWxkKHRhYmxlKTtcbiAgICByZXR1cm4gcmVjdC5oZWlnaHQ7XG59XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCAtIERlZmluZXMgdGhlIGZpZWxkXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBSZXR1cm5zIGlzIGNvbXBsZXggZmllbGRcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQ29tcGxleEZpZWxkKGZpZWxkKSB7XG4gICAgcmV0dXJuIGZpZWxkLnNwbGl0KCcuJykubGVuZ3RoID4gMTtcbn1cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIC0gRGVmaW5lcyB0aGUgZmllbGRcbiAqIEByZXR1cm5zIHtzdHJpbmd9IC0gUmV0dXJucyB0aGUgZ2V0IGNvbXBsZXggZmllbGQgSURcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbXBsZXhGaWVsZElEKGZpZWxkKSB7XG4gICAgaWYgKGZpZWxkID09PSB2b2lkIDApIHsgZmllbGQgPSAnJzsgfVxuICAgIHJldHVybiBmaWVsZC5yZXBsYWNlKC9cXC4vZywgJ19fXycpO1xufVxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSBEZWZpbmVzIHRoZSBmaWVsZFxuICogQHJldHVybnMge3N0cmluZ30gLSBSZXR1cm5zIHRoZSBwYXJzZWQgY29sdW1uIGZpZWxkIGlkXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXJzZWRGaWVsZElEKGZpZWxkKSB7XG4gICAgaWYgKGZpZWxkID09PSB2b2lkIDApIHsgZmllbGQgPSAnJzsgfVxuICAgIHJldHVybiBmaWVsZC5yZXBsYWNlKC9bXmEtekEtWjAtOV8uXS9nLCAnXFxcXCQmJyk7XG59XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCAtIERlZmluZXMgdGhlIGZpZWxkXG4gKiBAcmV0dXJucyB7c3RyaW5nfSAtIFJldHVybnMgdGhlIHNldCBjb21wbGV4IGZpZWxkIElEXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRDb21wbGV4RmllbGRJRChmaWVsZCkge1xuICAgIGlmIChmaWVsZCA9PT0gdm9pZCAwKSB7IGZpZWxkID0gJyc7IH1cbiAgICByZXR1cm4gZmllbGQucmVwbGFjZSgvX19fL2csICcuJyk7XG59XG4vKipcbiAqIEBwYXJhbSB7Q29sdW1ufSBjb2wgLSBEZWZpbmVzIHRoZSBjb2x1bW5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gRGVmaW5lcyB0aGUgdHlwZVxuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtIC0gRGVmaW5lcyB0aCBlbGVtZW50XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBpcyBFZGl0YWJsZVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFZGl0YWJsZShjb2wsIHR5cGUsIGVsZW0pIHtcbiAgICB2YXIgcm93ID0gcGFyZW50c1VudGlsKGVsZW0sIGxpdGVyYWxzLnJvdyk7XG4gICAgdmFyIGlzT2xkUm93ID0gIXJvdyA/IHRydWUgOiByb3cgJiYgIXJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaW5zZXJ0ZWRyb3cnKTtcbiAgICBpZiAodHlwZSA9PT0gJ2JlZ2luRWRpdCcgJiYgaXNPbGRSb3cpIHtcbiAgICAgICAgaWYgKGNvbC5pc0lkZW50aXR5IHx8IGNvbC5pc1ByaW1hcnlLZXkgfHwgIWNvbC5hbGxvd0VkaXRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZSA9PT0gJ2FkZCcgJiYgY29sLmlzSWRlbnRpdHkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGlzT2xkUm93ICYmICFjb2wuYWxsb3dFZGl0aW5nICYmICFjb2wuaXNJZGVudGl0eSAmJiAhY29sLmlzUHJpbWFyeUtleSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cbi8qKlxuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtIC0gRGVmaW5lcyB0aCBlbGVtZW50XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBpcyBFZGl0YWJsZVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDZWxsSGF2ZVdpZHRoKGVsZW0pIHtcbiAgICByZXR1cm4gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCA9PT0gMCA/IGZhbHNlIDogdHJ1ZTtcbn1cbi8qKlxuICogQHBhcmFtIHtJR3JpZH0gaW5zdCAtIERlZmluZXMgdGhlIElHcmlkXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBpcyBhY3Rpb24gcHJldmVudCBpbiBib29sZWFuXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0FjdGlvblByZXZlbnQoaW5zdCkge1xuICAgIHZhciBkbGcgPSBzZWxlY3QoJyMnICsgaW5zdC5lbGVtZW50LmlkICsgJ0VkaXRDb25maXJtJywgaW5zdC5lbGVtZW50KTtcbiAgICByZXR1cm4gaW5zdC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ0JhdGNoJyAmJlxuICAgICAgICAoc2VsZWN0QWxsKCcuZS11cGRhdGVkdGQnLCBpbnN0LmVsZW1lbnQpLmxlbmd0aCB8fCBzZWxlY3RBbGwoJy5lLWdyaWRmb3JtLmUtZm9ybXZhbGlkYXRvcicsIGluc3QuZWxlbWVudCkubGVuZ3RoKVxuICAgICAgICAmJiBpbnN0LmVkaXRTZXR0aW5ncy5zaG93Q29uZmlybURpYWxvZyAmJiAoZGxnID8gZGxnLmNsYXNzTGlzdC5jb250YWlucygnZS1wb3B1cC1jbG9zZScpIDogdHJ1ZSk7XG59XG4vKipcbiAqIEBwYXJhbSB7YW55fSBlbGVtIC0gRGVmaW5lcyB0aGUgZWxlbWVudFxuICogQHBhcmFtIHtib29sZWFufSBhY3Rpb24gLSBEZWZpbmVzIHRoZSBib29sZWFuIGZvciBhY3Rpb25cbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbmV4cG9ydCBmdW5jdGlvbiB3cmFwKGVsZW0sIGFjdGlvbikge1xuICAgIHZhciBjbE5hbWUgPSAnZS13cmFwJztcbiAgICBlbGVtID0gZWxlbSBpbnN0YW5jZW9mIEFycmF5ID8gZWxlbSA6IFtlbGVtXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFjdGlvbikge1xuICAgICAgICAgICAgZWxlbVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZChjbE5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZWxlbVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LnJlbW92ZShjbE5hbWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge1NlcnZpY2VMb2NhdG9yfSBzZXJ2aWNlTG9jYXRvciAtIERlZmluZXMgdGhlIHNlcnZpY2UgbG9jYXRvclxuICogQHBhcmFtIHtDb2x1bW59IGNvbHVtbiAgLSBEZWZpbmVzIHRoZSBjb2x1bW5cbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Rm9ybWF0dGVyKHNlcnZpY2VMb2NhdG9yLCBjb2x1bW4pIHtcbiAgICB2YXIgZm10ciA9IHNlcnZpY2VMb2NhdG9yLmdldFNlcnZpY2UoJ3ZhbHVlRm9ybWF0dGVyJyk7XG4gICAgdmFyIGZvcm1hdCA9ICdmb3JtYXQnO1xuICAgIHZhciBhcmdzO1xuICAgIGlmIChjb2x1bW4udHlwZSA9PT0gJ2RhdGUnIHx8IGNvbHVtbi50eXBlID09PSAnZGF0ZXRpbWUnIHx8IGNvbHVtbi50eXBlID09PSAnZGF0ZW9ubHknKSB7XG4gICAgICAgIGFyZ3MgPSB7IHR5cGU6IGNvbHVtbi50eXBlID09PSAnZGF0ZW9ubHknID8gJ2RhdGUnIDogY29sdW1uLnR5cGUsIHNrZWxldG9uOiBjb2x1bW4uZm9ybWF0IH07XG4gICAgICAgIGlmICgodHlwZW9mIChjb2x1bW4uZm9ybWF0KSA9PT0gJ3N0cmluZycpICYmIGNvbHVtbi5mb3JtYXQgIT09ICd5TWQnKSB7XG4gICAgICAgICAgICBhcmdzW1wiXCIgKyBmb3JtYXRdID0gY29sdW1uLmZvcm1hdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzd2l0Y2ggKGNvbHVtbi50eXBlKSB7XG4gICAgICAgIGNhc2UgJ2RhdGUnOlxuICAgICAgICAgICAgY29sdW1uLnNldEZvcm1hdHRlcihmbXRyLmdldEZvcm1hdEZ1bmN0aW9uKGFyZ3MpKTtcbiAgICAgICAgICAgIGNvbHVtbi5zZXRQYXJzZXIoZm10ci5nZXRQYXJzZXJGdW5jdGlvbihhcmdzKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGF0ZW9ubHknOlxuICAgICAgICAgICAgY29sdW1uLnNldEZvcm1hdHRlcihmbXRyLmdldEZvcm1hdEZ1bmN0aW9uKGFyZ3MpKTtcbiAgICAgICAgICAgIGNvbHVtbi5zZXRQYXJzZXIoZm10ci5nZXRQYXJzZXJGdW5jdGlvbihhcmdzKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxuICAgICAgICAgICAgY29sdW1uLnNldEZvcm1hdHRlcihmbXRyLmdldEZvcm1hdEZ1bmN0aW9uKGFyZ3MpKTtcbiAgICAgICAgICAgIGNvbHVtbi5zZXRQYXJzZXIoZm10ci5nZXRQYXJzZXJGdW5jdGlvbihhcmdzKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgICAgIGNvbHVtbi5zZXRGb3JtYXR0ZXIoZm10ci5nZXRGb3JtYXRGdW5jdGlvbih7IGZvcm1hdDogY29sdW1uLmZvcm1hdCB9KSk7XG4gICAgICAgICAgICBjb2x1bW4uc2V0UGFyc2VyKGZtdHIuZ2V0UGFyc2VyRnVuY3Rpb24oeyBmb3JtYXQ6IGNvbHVtbi5mb3JtYXQgfSkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGNlbGxzIC0gRGVmaW5lcyB0aGUgY2VsbCBlbGVtZW50XG4gKiBAcGFyYW0ge2Jvb2xlYW59IGFkZCAtIERlZmluZXMgdGhlIGFkZFxuICogQHBhcmFtIHtzdHJpbmd9IGFyZ3MgLSBEZWZpbmVzIHRoZSBhcmdzXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFJlbW92ZUFjdGl2ZUNsYXNzZXMoY2VsbHMsIGFkZCkge1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNlbGxzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChhZGQpIHtcbiAgICAgICAgICAgIGNsYXNzTGlzdChjZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGFyZ3Muc2xpY2UoKSwgW10pO1xuICAgICAgICAgICAgY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICd0cnVlJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjbGFzc0xpc3QoY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBbXSwgYXJncy5zbGljZSgpKTtcbiAgICAgICAgICAgIGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHJlc3VsdCAtIERlZmluZXMgdGggc3RyaW5nXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBkaXN0aW5jdCBzdGFpbmcgdmFsdWVzXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaXN0aW5jdFN0cmluZ1ZhbHVlcyhyZXN1bHQpIHtcbiAgICB2YXIgdGVtcCA9IHt9O1xuICAgIHZhciByZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoIShyZXN1bHRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldIGluIHRlbXApKSB7XG4gICAgICAgICAgICByZXMucHVzaChyZXN1bHRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgdGVtcFtyZXN1bHRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSA9IDE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cbi8qKlxuICogQHBhcmFtIHtFbGVtZW50fSB0YXJnZXQgLSBEZWZpbmVzIHRoZSB0YXJnZXRcbiAqIEBwYXJhbSB7RGlhbG9nfSBkaWFsb2dPYmogLSBEZWZpbmVzIHRoZSBkaWFsb2dcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmlsdGVyTWVudVBvc3Rpb24odGFyZ2V0LCBkaWFsb2dPYmopIHtcbiAgICB2YXIgZWxlbWVudFZpc2libGUgPSBkaWFsb2dPYmouZWxlbWVudC5zdHlsZS5kaXNwbGF5O1xuICAgIGRpYWxvZ09iai5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIHZhciBkbGdXaWR0aCA9IGRpYWxvZ09iai53aWR0aDtcbiAgICB2YXIgbmV3cG9zID0gY2FsY3VsYXRlUmVsYXRpdmVCYXNlZFBvc2l0aW9uKHRhcmdldCwgZGlhbG9nT2JqLmVsZW1lbnQpO1xuICAgIGRpYWxvZ09iai5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBlbGVtZW50VmlzaWJsZTtcbiAgICBkaWFsb2dPYmouZWxlbWVudC5zdHlsZS50b3AgPSAobmV3cG9zLnRvcCArIHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQpIC0gNSArICdweCc7XG4gICAgdmFyIGxlZnRQb3MgPSAoKG5ld3Bvcy5sZWZ0IC0gZGxnV2lkdGgpICsgdGFyZ2V0LmNsaWVudFdpZHRoKTtcbiAgICBpZiAobGVmdFBvcyA8IDEpIHtcbiAgICAgICAgZGlhbG9nT2JqLmVsZW1lbnQuc3R5bGUubGVmdCA9IChkbGdXaWR0aCArIGxlZnRQb3MpIC0gMTYgKyAncHgnOyAvLyByaWdodCBjYWxjdWxhdGlvblxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZGlhbG9nT2JqLmVsZW1lbnQuc3R5bGUubGVmdCA9IGxlZnRQb3MgKyAtNCArICdweCc7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge09iamVjdH0gYXJncyAtIERlZmluZXMgdGhlIGFyZ3NcbiAqIEBwYXJhbSB7UG9wdXB9IGFyZ3MucG9wdXAgLSBEZWZpbmVzIHRoZSBhcmdzIGZvciBwb3B1cFxuICogQHBhcmFtIHtEaWFsb2d9IGRpYWxvZ09iaiAtIERlZmluZXMgdGhlIGRpYWxvZyBvYmpcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0WkluZGV4Q2FsY3VhbHRpb24oYXJncywgZGlhbG9nT2JqKSB7XG4gICAgYXJncy5wb3B1cC5lbGVtZW50LnN0eWxlLnpJbmRleCA9IChkaWFsb2dPYmouekluZGV4ICsgMSkudG9TdHJpbmcoKTtcbn1cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG9wZXJhdG9yIC0gRGVmaW5lcyB0aGUgb3BlcmF0b3JcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb2x1bW5VaWQgLSBEZWZpbmVzIHRoZSBjb2x1bW4gdWlkXG4gKiBAcGFyYW0ge0NvbHVtbn0gY29sdW1uIC0gRGVmaW5lcyB0aGUgY29sdW1uXG4gKiBAcGFyYW0ge3N0cmluZ30gY29sdW1uVHlwZSAtIERlZmluZXMgdGhlIGNvbHVtbiB0eXBlXG4gKiBAcGFyYW0ge0RpYWxvZ30gZGxnT2JqIC0gRGVmaW5lcyB0aGUgZGlhbG9nXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJldmlvdXNWYWx1ZSAtIERlZmluZXMgdGhlIHByZXZpb3VzIG9wZXJhdG9yXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZUZpbHRlclVJKG9wZXJhdG9yLCBjb2x1bW5VaWQsIGNvbHVtbiwgY29sdW1uVHlwZSwgZGxnT2JqLCBwcmV2aW91c1ZhbHVlKSB7XG4gICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbi5maWx0ZXJUZW1wbGF0ZSkpIHtcbiAgICAgICAgdmFyIGNvbHVtbklEID0gJyc7XG4gICAgICAgIGlmIChjb2x1bW5UeXBlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY29sdW1uSUQgPSAnc3RydWktJyArIGNvbHVtblVpZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2x1bW5UeXBlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgY29sdW1uSUQgPSAnbnVtYmVydWktJyArIGNvbHVtblVpZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2x1bW5UeXBlID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgIGNvbHVtbklEID0gJ2Jvb2wtdWktJyArIGNvbHVtblVpZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2x1bW5UeXBlID09PSAnZGF0ZScpIHtcbiAgICAgICAgICAgIGNvbHVtbklEID0gJ2RhdGV1aS0nICsgY29sdW1uVWlkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpc1ByZXZpb3VzVmFsdWUgPSBwcmV2aW91c1ZhbHVlID09PSAnaW4nIHx8IHByZXZpb3VzVmFsdWUgPT09ICdub3Rpbic7XG4gICAgICAgIHZhciBpc011bHRpU2VsZWN0ID0gb3BlcmF0b3IgPT09ICdpbicgfHwgb3BlcmF0b3IgPT09ICdub3Rpbic7XG4gICAgICAgIHZhciBtdWx0aXNlbGVjdFBhcmVudCA9IHBhcmVudHNVbnRpbChkbGdPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI211bHRpc2VsZWN0XCIgKyBjb2x1bW5JRCksICdlLWNvbnRyb2wtd3JhcHBlcicpO1xuICAgICAgICB2YXIgc2luZ2xlSW5wdXRQYXJlbnQgPSBwYXJlbnRzVW50aWwoZGxnT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNcIiArIGNvbHVtbklEKSwgJ2UtcG9wdXAtZmxtZW51Jyk7XG4gICAgICAgIGlmIChtdWx0aXNlbGVjdFBhcmVudCkge1xuICAgICAgICAgICAgbXVsdGlzZWxlY3RQYXJlbnQuc3R5bGUuZGlzcGxheSA9IGlzTXVsdGlTZWxlY3QgPyAnaW5saW5lLWZsZXgnIDogJ25vbmUnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzaW5nbGVJbnB1dFBhcmVudCkge1xuICAgICAgICAgICAgc2luZ2xlSW5wdXRQYXJlbnQuc3R5bGUuZGlzcGxheSA9IGlzTXVsdGlTZWxlY3QgPyAnbm9uZScgOiAnaW5saW5lLWZsZXgnO1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW0gLSBEZWZpbmVzIHRoZSBlbGVtZW50XG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvb2dsZUNoZWNrYm94KGVsZW0pIHtcbiAgICB2YXIgc3BhbiA9IGVsZW0ucXVlcnlTZWxlY3RvcignLmUtZnJhbWUnKTtcbiAgICB2YXIgaW5wdXQgPSBzcGFuLnByZXZpb3VzU2libGluZztcbiAgICBpZiAoc3Bhbi5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY2hlY2snKSkge1xuICAgICAgICBpbnB1dC5jaGVja2VkID0gZmFsc2U7XG4gICAgICAgIGNsYXNzTGlzdChzcGFuLCBbJ2UtdW5jaGVjayddLCBbJ2UtY2hlY2snXSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbnB1dC5jaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgY2xhc3NMaXN0KHNwYW4sIFsnZS1jaGVjayddLCBbJ2UtdW5jaGVjayddKTtcbiAgICB9XG59XG4vKipcbiAqIEBwYXJhbSB7SFRNTElucHV0RWxlbWVudH0gZWxlbSAtIERlZmluZXMgdGhlIGVsZW1lbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gY2hlY2tlZCAtIERlZmluZXMgaXMgY2hlY2tlZFxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRDaGVja2VkKGVsZW0sIGNoZWNrZWQpIHtcbiAgICBlbGVtLmNoZWNrZWQgPSBjaGVja2VkO1xufVxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWlkIC0gRGVmaW5lcyB0aGUgc3RyaW5nXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW0gLSBEZWZpbmVzIHRoZSBFbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIC0gRGVmaW5lcyB0aGUgY2xhc3NuYW1lXG4gKiBAcmV0dXJucyB7RWxlbWVudH0gUmV0dXJucyB0aGUgYm94IHdyYXBcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNib3hXaXRoV3JhcCh1aWQsIGVsZW0sIGNsYXNzTmFtZSkge1xuICAgIHZhciBkaXYgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogY2xhc3NOYW1lIH0pO1xuICAgIGRpdi5hcHBlbmRDaGlsZChlbGVtKTtcbiAgICBkaXYuc2V0QXR0cmlidXRlKCd1aWQnLCB1aWQpO1xuICAgIHJldHVybiBkaXY7XG59XG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbSAtIERlZmluZXMgdGhlIGVsZW1lbnRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gY2hlY2tlZCAtIERlZmluZXMgaXMgY2hlY2tlZFxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVBZGRDYm94Q2xhc3NlcyhlbGVtLCBjaGVja2VkKSB7XG4gICAgcmVtb3ZlQ2xhc3MoW2VsZW1dLCBbJ2UtY2hlY2snLCAnZS1zdG9wJywgJ2UtdW5jaGVjayddKTtcbiAgICBpZiAoY2hlY2tlZCkge1xuICAgICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoJ2UtY2hlY2snKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGVsZW0uY2xhc3NMaXN0LmFkZCgnZS11bmNoZWNrJyk7XG4gICAgfVxufVxuLyoqXG4gKiBSZWZyZXNoIHRoZSBSb3cgbW9kZWwncyBmb3JlaWduIGRhdGEuXG4gKlxuICogQHBhcmFtIHtJUm93PENvbHVtbj59IHJvdyAtIEdyaWQgUm93IG1vZGVsIG9iamVjdC5cbiAqIEBwYXJhbSB7Q29sdW1uW119IGNvbHVtbnMgLSBGb3JlaWduIGNvbHVtbnMgYXJyYXkuXG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIFVwZGF0ZWQgUm93IGRhdGEuXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZnJlc2hGb3JlaWduRGF0YShyb3csIGNvbHVtbnMsIGRhdGEpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8ICghaXNOdWxsT3JVbmRlZmluZWQoY29sdW1ucykgPyBjb2x1bW5zLmxlbmd0aCA6IDApOyBpKyspIHtcbiAgICAgICAgc2V0VmFsdWUoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQsIGdldEZvcmVpZ25EYXRhKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBkYXRhKSwgcm93LmZvcmVpZ25LZXlEYXRhKTtcbiAgICB9XG4gICAgdmFyIGNlbGxzID0gcm93LmNlbGxzO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2VsbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0ZvcmVpZ25LZXkpIHtcbiAgICAgICAgICAgIHNldFZhbHVlKCdmb3JlaWduS2V5RGF0YScsIGdldFZhbHVlKGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW4uZmllbGQsIHJvdy5mb3JlaWduS2V5RGF0YSksIGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEdldCB0aGUgZm9yZWlnbiBkYXRhIGZvciB0aGUgY29ycmVzcG9uZGluZyBjZWxsIHZhbHVlLlxuICpcbiAqIEBwYXJhbSB7Q29sdW1ufSBjb2x1bW4gLSBGb3JlaWduIEtleSBjb2x1bW5cbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gUm93IGRhdGEuXG4gKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlcn0gbFZhbHVlIC0gY2VsbCB2YWx1ZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBmb3JlaWduS2V5RGF0YSAtIGZvcmVpZ24gZGF0YSBzb3VyY2UuXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBvYmplY3RcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZvcmVpZ25EYXRhKGNvbHVtbiwgZGF0YSwgbFZhbHVlLCBmb3JlaWduS2V5RGF0YSkge1xuICAgIHZhciBmRmllbGQgPSBjb2x1bW4uZm9yZWlnbktleUZpZWxkO1xuICAgIHZhciBrZXkgPSAoIWlzTnVsbE9yVW5kZWZpbmVkKGxWYWx1ZSkgPyBsVmFsdWUgOiB2YWx1ZUFjY2Vzc29yKGNvbHVtbi5maWVsZCwgZGF0YSwgY29sdW1uKSk7XG4gICAga2V5ID0gaXNOdWxsT3JVbmRlZmluZWQoa2V5KSA/ICcnIDoga2V5O1xuICAgIHZhciBxdWVyeSA9IG5ldyBRdWVyeSgpO1xuICAgIHZhciBmZGF0YSA9IGZvcmVpZ25LZXlEYXRhIHx8ICgoY29sdW1uLmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBEYXRhTWFuYWdlcikgJiYgY29sdW1uLmRhdGFTb3VyY2UuZGF0YVNvdXJjZS5qc29uLmxlbmd0aCA/XG4gICAgICAgIGNvbHVtbi5kYXRhU291cmNlLmRhdGFTb3VyY2UuanNvbiA6IGNvbHVtbi5jb2x1bW5EYXRhKTtcbiAgICBpZiAoa2V5LmdldERheSkge1xuICAgICAgICBxdWVyeS53aGVyZShnZXREYXRlUHJlZGljYXRlKHsgZmllbGQ6IGZGaWVsZCwgb3BlcmF0b3I6ICdlcXVhbCcsIHZhbHVlOiBrZXksIG1hdGNoQ2FzZTogZmFsc2UgfSkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcXVlcnkud2hlcmUoZkZpZWxkLCAnPT0nLCBrZXksIGZhbHNlKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBEYXRhTWFuYWdlcihmZGF0YSkuZXhlY3V0ZUxvY2FsKHF1ZXJ5KTtcbn1cbi8qKlxuICogVG8gdXNlIHRvIGdldCB0aGUgY29sdW1uJ3Mgb2JqZWN0IGJ5IHRoZSBmb3JlaWduIGtleSB2YWx1ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gZm9yZWlnbktleVZhbHVlIC0gRGVmaW5lcyBGb3JlaWduS2V5VmFsdWUuXG4gKiBAcGFyYW0ge0NvbHVtbltdfSBjb2x1bW5zIC0gQXJyYXkgb2YgY29sdW1uIG9iamVjdC5cbiAqIEByZXR1cm5zIHtDb2x1bW59IFJldHVybnMgdGhlIGVsZW1lbnRcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbHVtbkJ5Rm9yZWlnbktleVZhbHVlKGZvcmVpZ25LZXlWYWx1ZSwgY29sdW1ucykge1xuICAgIHZhciBjb2x1bW47XG4gICAgcmV0dXJuIGNvbHVtbnMuc29tZShmdW5jdGlvbiAoY29sKSB7XG4gICAgICAgIGNvbHVtbiA9IGNvbDtcbiAgICAgICAgcmV0dXJuIGNvbC5mb3JlaWduS2V5VmFsdWUgPT09IGZvcmVpZ25LZXlWYWx1ZTtcbiAgICB9KSAmJiBjb2x1bW47XG59XG4vKipcbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSAtIERlZmluZXMgdGhlIGRhdGUgb3IgbW9udGggdmFsdWVcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgc3RyaW5nXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYWRaZXJvKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlIDwgMTApIHtcbiAgICAgICAgcmV0dXJuICcwJyArIHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gU3RyaW5nKHZhbHVlKTtcbn1cbi8qKlxuICogQHBhcmFtIHtQcmVkaWNhdGVNb2RlbH0gZmlsdGVyT2JqZWN0IC0gRGVmaW5lcyB0aGUgZmlsdGVyT2JqZWN0XG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIERlZmluZXMgdGhlIHR5cGVcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNFeGVjdXRlTG9jYWwgLSBEZWZpbmVzIHdoZXRoZXIgdGhlIGRhdGEgYWN0aW9ucyBwZXJmb3JtZWQgaW4gY2xpZW50IGFuZCB1c2VkIGZvciBkYXRlb25seSB0eXBlIGZpZWxkXG4gKiBAcmV0dXJucyB7UHJlZGljYXRlfSBSZXR1cm5zIHRoZSBQcmVkaWNhdGVcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGVQcmVkaWNhdGUoZmlsdGVyT2JqZWN0LCB0eXBlLCBpc0V4ZWN1dGVMb2NhbCkge1xuICAgIHZhciBkYXRlUHJlZGljYXRlO1xuICAgIHZhciBwcmV2RGF0ZTtcbiAgICB2YXIgbmV4dERhdGU7XG4gICAgdmFyIHByZXZPYmogPSBiYXNlRXh0ZW5kKHt9LCBnZXRBY3R1YWxQcm9wZXJ0aWVzKGZpbHRlck9iamVjdCkpO1xuICAgIHZhciBuZXh0T2JqID0gYmFzZUV4dGVuZCh7fSwgZ2V0QWN0dWFsUHJvcGVydGllcyhmaWx0ZXJPYmplY3QpKTtcbiAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoZmlsdGVyT2JqZWN0LnZhbHVlKSB8fCBmaWx0ZXJPYmplY3QudmFsdWUgPT09ICcnKSB7XG4gICAgICAgIGRhdGVQcmVkaWNhdGUgPSBuZXcgUHJlZGljYXRlKHByZXZPYmouZmllbGQsIHByZXZPYmoub3BlcmF0b3IsIHByZXZPYmoudmFsdWUsIGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIGRhdGVQcmVkaWNhdGU7XG4gICAgfVxuICAgIHZhciB2YWx1ZSA9IG5ldyBEYXRlKGZpbHRlck9iamVjdC52YWx1ZSk7XG4gICAgaWYgKHR5cGUgPT09ICdkYXRlb25seScgJiYgIWlzRXhlY3V0ZUxvY2FsKSB7XG4gICAgICAgIGlmICh0eXBlb2YgKHByZXZPYmoudmFsdWUpID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgcHJldk9iai52YWx1ZSA9IG5ldyBEYXRlKHByZXZPYmoudmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkYXRlT25seVN0cmluZyA9IHByZXZPYmoudmFsdWUuZ2V0RnVsbFllYXIoKSArICctJyArIHBhZFplcm8ocHJldk9iai52YWx1ZS5nZXRNb250aCgpICsgMSkgKyAnLScgKyBwYWRaZXJvKHByZXZPYmoudmFsdWUuZ2V0RGF0ZSgpKTtcbiAgICAgICAgdmFyIHByZWRpY2F0ZXMgPSBuZXcgUHJlZGljYXRlKHByZXZPYmouZmllbGQsIHByZXZPYmoub3BlcmF0b3IsIGRhdGVPbmx5U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgIGRhdGVQcmVkaWNhdGUgPSBwcmVkaWNhdGVzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZmlsdGVyT2JqZWN0Lm9wZXJhdG9yID0gZmlsdGVyT2JqZWN0Lm9wZXJhdG9yLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmIChmaWx0ZXJPYmplY3Qub3BlcmF0b3IgPT09ICdlcXVhbCcgfHwgZmlsdGVyT2JqZWN0Lm9wZXJhdG9yID09PSAnbm90ZXF1YWwnKSB7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2RhdGV0aW1lJykge1xuICAgICAgICAgICAgICAgIHByZXZEYXRlID0gbmV3IERhdGUodmFsdWUuc2V0U2Vjb25kcyh2YWx1ZS5nZXRTZWNvbmRzKCkgLSAxKSk7XG4gICAgICAgICAgICAgICAgbmV4dERhdGUgPSBuZXcgRGF0ZSh2YWx1ZS5zZXRTZWNvbmRzKHZhbHVlLmdldFNlY29uZHMoKSArIDIpKTtcbiAgICAgICAgICAgICAgICBmaWx0ZXJPYmplY3QudmFsdWUgPSBuZXcgRGF0ZSh2YWx1ZS5zZXRTZWNvbmRzKG5leHREYXRlLmdldFNlY29uZHMoKSAtIDEpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHByZXZEYXRlID0gbmV3IERhdGUodmFsdWUuc2V0SG91cnMoMCkgLSAxKTtcbiAgICAgICAgICAgICAgICBuZXh0RGF0ZSA9IG5ldyBEYXRlKHZhbHVlLnNldEhvdXJzKDI0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcmV2T2JqLnZhbHVlID0gcHJldkRhdGU7XG4gICAgICAgICAgICBuZXh0T2JqLnZhbHVlID0gbmV4dERhdGU7XG4gICAgICAgICAgICBpZiAoZmlsdGVyT2JqZWN0Lm9wZXJhdG9yID09PSAnZXF1YWwnKSB7XG4gICAgICAgICAgICAgICAgcHJldk9iai5vcGVyYXRvciA9ICdncmVhdGVydGhhbic7XG4gICAgICAgICAgICAgICAgbmV4dE9iai5vcGVyYXRvciA9ICdsZXNzdGhhbic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChmaWx0ZXJPYmplY3Qub3BlcmF0b3IgPT09ICdub3RlcXVhbCcpIHtcbiAgICAgICAgICAgICAgICBwcmV2T2JqLm9wZXJhdG9yID0gJ2xlc3N0aGFub3JlcXVhbCc7XG4gICAgICAgICAgICAgICAgbmV4dE9iai5vcGVyYXRvciA9ICdncmVhdGVydGhhbm9yZXF1YWwnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByZWRpY2F0ZVN0ID0gbmV3IFByZWRpY2F0ZShwcmV2T2JqLmZpZWxkLCBwcmV2T2JqLm9wZXJhdG9yLCBwcmV2T2JqLnZhbHVlLCBmYWxzZSk7XG4gICAgICAgICAgICB2YXIgcHJlZGljYXRlRW5kID0gbmV3IFByZWRpY2F0ZShuZXh0T2JqLmZpZWxkLCBuZXh0T2JqLm9wZXJhdG9yLCBuZXh0T2JqLnZhbHVlLCBmYWxzZSk7XG4gICAgICAgICAgICBkYXRlUHJlZGljYXRlID0gZmlsdGVyT2JqZWN0Lm9wZXJhdG9yID09PSAnZXF1YWwnID8gcHJlZGljYXRlU3QuYW5kKHByZWRpY2F0ZUVuZCkgOiBwcmVkaWNhdGVTdC5vcihwcmVkaWNhdGVFbmQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdkYXRlJyAmJiAoZmlsdGVyT2JqZWN0Lm9wZXJhdG9yID09PSAnbGVzc3RoYW5vcmVxdWFsJyB8fCBmaWx0ZXJPYmplY3Qub3BlcmF0b3IgPT09ICdncmVhdGVydGhhbicpKSB7XG4gICAgICAgICAgICAgICAgcHJldk9iai52YWx1ZSA9IG5ldyBEYXRlKHZhbHVlLnNldEhvdXJzKDI0KSAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiAocHJldk9iai52YWx1ZSkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcHJldk9iai52YWx1ZSA9IG5ldyBEYXRlKHByZXZPYmoudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByZWRpY2F0ZXMgPSBuZXcgUHJlZGljYXRlKHByZXZPYmouZmllbGQsIHByZXZPYmoub3BlcmF0b3IsIHByZXZPYmoudmFsdWUsIGZhbHNlKTtcbiAgICAgICAgICAgIGRhdGVQcmVkaWNhdGUgPSBwcmVkaWNhdGVzO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChmaWx0ZXJPYmplY3Quc2V0UHJvcGVydGllcykge1xuICAgICAgICBmaWx0ZXJPYmplY3Quc2V0UHJvcGVydGllcyh7IGVqcHJlZGljYXRlOiBkYXRlUHJlZGljYXRlIH0sIHRydWUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZmlsdGVyT2JqZWN0LmVqcHJlZGljYXRlID0gZGF0ZVByZWRpY2F0ZTtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGVQcmVkaWNhdGU7XG59XG4vKipcbiAqIEBwYXJhbSB7SUdyaWR9IGdyaWQgLSBEZWZpbmVzIHRoZSBJR3JpZFxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiBncm91cCBhZGFwdGl2ZSBpcyB0cnVlXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0dyb3VwQWRhcHRpdmUoZ3JpZCkge1xuICAgIHJldHVybiBncmlkLmVuYWJsZVZpcnR1YWxpemF0aW9uICYmIGdyaWQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCA+IDAgJiYgZ3JpZC5pc1ZpcnR1YWxBZGFwdGl2ZSAmJlxuICAgICAgICAhZ3JpZC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nO1xufVxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSBEZWZpbmVzIHRoZSBGaWVsZFxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCAtIERlZmluZXMgdGhlIG9iamVjXG4gKiBAcmV0dXJucyB7YW55fSBSZXR1cm5zIHRoZSBvYmplY3RcbiAqIEBoaWRkZW5cbiAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmV4cG9ydCBmdW5jdGlvbiBnZXRPYmplY3QoZmllbGQsIG9iamVjdCkge1xuICAgIGlmIChmaWVsZCA9PT0gdm9pZCAwKSB7IGZpZWxkID0gJyc7IH1cbiAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gb2JqZWN0O1xuICAgICAgICB2YXIgc3BsaXRzID0gZmllbGQuc3BsaXQoJy4nKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGxpdHMubGVuZ3RoICYmICFpc051bGxPclVuZGVmaW5lZCh2YWx1ZSk7IGkrKykge1xuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZVtzcGxpdHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXTtcbiAgICAgICAgICAgIGlmIChpc1VuZGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Q2FzZSA9IHNwbGl0c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2hhckF0KDApLnRvVXBwZXJDYXNlKClcbiAgICAgICAgICAgICAgICAgICAgKyBzcGxpdHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gb2JqZWN0W1wiXCIgKyBuZXdDYXNlXSB8fCBvYmplY3RbKFwiXCIgKyBuZXdDYXNlKS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIChcIlwiICsgbmV3Q2FzZSkuc2xpY2UoMSldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nIHwgT2JqZWN0fSBmb3JtYXQgLSBkZWZpbmVzIHRoZSBmb3JtYXRcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb2xUeXBlIC0gRGVmaW5lcyB0aGUgY29sdHlwZVxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgY3VzdG9tIERhdGEgZm9ybWF0XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXN0b21EYXRlRm9ybWF0KGZvcm1hdCwgY29sVHlwZSkge1xuICAgIHZhciBpbnRsID0gbmV3IEludGVybmF0aW9uYWxpemF0aW9uKCk7XG4gICAgdmFyIGZvcm1hdHZhbHVlO1xuICAgIHZhciBmb3JtYXR0ZXIgPSAnZm9ybWF0JztcbiAgICB2YXIgdHlwZSA9ICd0eXBlJztcbiAgICBpZiAoY29sVHlwZSA9PT0gJ2RhdGUnKSB7XG4gICAgICAgIGZvcm1hdHZhbHVlID0gdHlwZW9mIChmb3JtYXQpID09PSAnb2JqZWN0JyA/XG4gICAgICAgICAgICBpbnRsLmdldERhdGVQYXR0ZXJuKHsgdHlwZTogZm9ybWF0W1wiXCIgKyB0eXBlXSA/IGZvcm1hdFtcIlwiICsgdHlwZV0gOiAnZGF0ZScsIGZvcm1hdDogZm9ybWF0W1wiXCIgKyBmb3JtYXR0ZXJdIH0sIGZhbHNlKSA6XG4gICAgICAgICAgICBpbnRsLmdldERhdGVQYXR0ZXJuKHsgdHlwZTogJ2RhdGVUaW1lJywgc2tlbGV0b246IGZvcm1hdCB9LCBmYWxzZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmb3JtYXR2YWx1ZSA9IHR5cGVvZiAoZm9ybWF0KSA9PT0gJ29iamVjdCcgP1xuICAgICAgICAgICAgaW50bC5nZXREYXRlUGF0dGVybih7IHR5cGU6IGZvcm1hdFtcIlwiICsgdHlwZV0gPyBmb3JtYXRbXCJcIiArIHR5cGVdIDogJ2RhdGVUaW1lJywgZm9ybWF0OiBmb3JtYXRbXCJcIiArIGZvcm1hdHRlcl0gfSwgZmFsc2UpIDpcbiAgICAgICAgICAgIGludGwuZ2V0RGF0ZVBhdHRlcm4oeyB0eXBlOiAnZGF0ZVRpbWUnLCBza2VsZXRvbjogZm9ybWF0IH0sIGZhbHNlKTtcbiAgICB9XG4gICAgcmV0dXJuIGZvcm1hdHZhbHVlO1xufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgSUdyaWRcbiAqIEBwYXJhbSB7SGllcmFyY2h5R3JpZFByaW50TW9kZX0gaGllcmFyY2h5UHJpbnRNb2RlIC0gRGVmaW5lcyB0aGUgaGllcmFyY2h5UHJpbnRNb2RlXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBvYmplY3RcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEV4cGFuZGVkU3RhdGUoZ09iaiwgaGllcmFyY2h5UHJpbnRNb2RlKSB7XG4gICAgdmFyIHJvd3MgPSBnT2JqLmdldFJvd3NPYmplY3QoKTtcbiAgICB2YXIgb2JqID0ge307XG4gICAgZm9yICh2YXIgX2kgPSAwLCByb3dzXzEgPSByb3dzOyBfaSA8IHJvd3NfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHJvdyA9IHJvd3NfMVtfaV07XG4gICAgICAgIGlmIChyb3cuaXNFeHBhbmQgJiYgIXJvdy5pc0RldGFpbFJvdykge1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gZ09iai5hbGxvd1BhZ2luZyAmJiBnT2JqLnByaW50TW9kZSA9PT0gJ0FsbFBhZ2VzJyA/IHJvdy5pbmRleCArXG4gICAgICAgICAgICAgICAgKGdPYmoucGFnZVNldHRpbmdzLmN1cnJlbnRQYWdlICogZ09iai5wYWdlU2V0dGluZ3MucGFnZVNpemUpIC0gZ09iai5wYWdlU2V0dGluZ3MucGFnZVNpemUgOiByb3cuaW5kZXg7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGluZGV4KSkge1xuICAgICAgICAgICAgICAgIG9ialtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldID0ge307XG4gICAgICAgICAgICAgICAgb2JqW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0uaXNFeHBhbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChnT2JqLmNoaWxkR3JpZCkge1xuICAgICAgICAgICAgICAgICAgICBvYmpbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS5ncmlkTW9kZWwgPSBnZXRQcmludEdyaWRNb2RlbChyb3cuY2hpbGRHcmlkLCBoaWVyYXJjaHlQcmludE1vZGUpO1xuICAgICAgICAgICAgICAgICAgICBvYmpbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS5ncmlkTW9kZWwucXVlcnkgPSBnT2JqLmNoaWxkR3JpZC5xdWVyeTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9iajtcbn1cbi8qKlxuICogQHBhcmFtIHtJR3JpZH0gZ09iaiAtIERlZmluZXMgdGhlIGdyaWQgb2JqY3RcbiAqIEBwYXJhbSB7SGllcmFyY2h5R3JpZFByaW50TW9kZX0gaGllcmFyY2h5UHJpbnRNb2RlIC0gRGVmaW5lcyB0aGUgaGllcmFyY2h5UHJpbnRNb2RlXG4gKiBAcmV0dXJucyB7SUdyaWR9IFJldHVybnMgdGhlIElHcmlkXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcmludEdyaWRNb2RlbChnT2JqLCBoaWVyYXJjaHlQcmludE1vZGUpIHtcbiAgICBpZiAoaGllcmFyY2h5UHJpbnRNb2RlID09PSB2b2lkIDApIHsgaGllcmFyY2h5UHJpbnRNb2RlID0gJ0V4cGFuZGVkJzsgfVxuICAgIHZhciBwcmludEdyaWRNb2RlbCA9IHt9O1xuICAgIGlmICghZ09iaikge1xuICAgICAgICByZXR1cm4gcHJpbnRHcmlkTW9kZWw7XG4gICAgfVxuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBQcmludC5wcmludEdyaWRQcm9wOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIga2V5ID0gX2FbX2ldO1xuICAgICAgICBpZiAoa2V5ID09PSAnY29sdW1ucycpIHtcbiAgICAgICAgICAgIHByaW50R3JpZE1vZGVsW1wiXCIgKyBrZXldID0gZ2V0QWN0dWFsUHJvcEZyb21Db2xsKGdPYmpbXCJcIiArIGtleV0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gJ2FsbG93UGFnaW5nJykge1xuICAgICAgICAgICAgcHJpbnRHcmlkTW9kZWxbXCJcIiArIGtleV0gPSBnT2JqLnByaW50TW9kZSA9PT0gJ0N1cnJlbnRQYWdlJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHByaW50R3JpZE1vZGVsW1wiXCIgKyBrZXldID0gZ2V0QWN0dWFsUHJvcGVydGllcyhnT2JqW1wiXCIgKyBrZXldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcmludEdyaWRNb2RlbFsnZW5hYmxlSG92ZXInXSA9IGZhbHNlO1xuICAgIGlmICgoZ09iai5jaGlsZEdyaWQgfHwgZ09iai5kZXRhaWxUZW1wbGF0ZSkgJiYgaGllcmFyY2h5UHJpbnRNb2RlICE9PSAnTm9uZScpIHtcbiAgICAgICAgcHJpbnRHcmlkTW9kZWwuZXhwYW5kZWRSb3dzID0gZ2V0RXhwYW5kZWRTdGF0ZShnT2JqLCBoaWVyYXJjaHlQcmludE1vZGUpO1xuICAgIH1cbiAgICByZXR1cm4gcHJpbnRHcmlkTW9kZWw7XG59XG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb3BpZWQgLSBEZWZpbmVzIHRoZSBjb3BpZWQgb2JqZWN0XG4gKiBAcGFyYW0ge09iamVjdH0gZmlyc3QgLSBEZWZpbmVzIHRoZSBmaXJzdCBvYmplY3RcbiAqIEBwYXJhbSB7T2JqZWN0fSBzZWNvbmQgLSBEZWZpbmVzIHRoZSBzZWNvbmQgb2JqZWN0XG4gKiBAcGFyYW0ge2Jvb2xlYW59IGRlZXAgLSBEZWZpbmVzIHRoZSBkZWVwXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBleHRlbmRlZCBvYmplY3RcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuZE9ialdpdGhGbihjb3BpZWQsIGZpcnN0LCBzZWNvbmQsIGRlZXApIHtcbiAgICB2YXIgcmVzID0gY29waWVkIHx8IHt9O1xuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIGlmIChkZWVwKSB7XG4gICAgICAgIGxlbiA9IGxlbiAtIDE7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1yZXN0LXBhcmFtc1xuICAgICAgICBpZiAoIWFyZ3VtZW50c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItcmVzdC1wYXJhbXNcbiAgICAgICAgdmFyIG9iajEgPSBhcmd1bWVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmoxKSkubGVuZ3RoID9cbiAgICAgICAgICAgIE9iamVjdC5rZXlzKG9iajEpLmNvbmNhdChnZXRQcm90b3R5cGVzT2ZPYmoob2JqMSkpIDogT2JqZWN0LmtleXMob2JqMSk7XG4gICAgICAgIGZvciAodmFyIGlfMSA9IDA7IGlfMSA8IGtleXMubGVuZ3RoOyBpXzErKykge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IHJlc1trZXlzW3BhcnNlSW50KGlfMS50b1N0cmluZygpLCAxMCldXTtcbiAgICAgICAgICAgIHZhciBjcHkgPSBvYmoxW2tleXNbcGFyc2VJbnQoaV8xLnRvU3RyaW5nKCksIDEwKV1dO1xuICAgICAgICAgICAgdmFyIGNsbiA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmIChkZWVwICYmIChpc09iamVjdChjcHkpIHx8IEFycmF5LmlzQXJyYXkoY3B5KSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNPYmplY3QoY3B5KSkge1xuICAgICAgICAgICAgICAgICAgICBjbG4gPSBzb3VyY2UgPyBzb3VyY2UgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgcmVzW2tleXNbcGFyc2VJbnQoaV8xLnRvU3RyaW5nKCksIDEwKV1dID0gYmFzZUV4dGVuZCh7fSwgY2xuLCBjcHksIGRlZXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2xuID0gc291cmNlID8gc291cmNlIDogW107XG4gICAgICAgICAgICAgICAgICAgIHJlc1trZXlzW3BhcnNlSW50KGlfMS50b1N0cmluZygpLCAxMCldXSA9IGJhc2VFeHRlbmQoW10sIGNsbiwgY3B5LCBkZWVwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXNba2V5c1twYXJzZUludChpXzEudG9TdHJpbmcoKSwgMTApXV0gPSBjcHk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cbi8qKlxuICogQHBhcmFtIHtPYmplY3R9IG9iaiAtIERlZmluZXMgdGhlIG9ialxuICogQHJldHVybnMge3N0cmluZ1tdfSBSZXR1cm5zIHRoZSBzdHJpbmdcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFByb3RvdHlwZXNPZk9iaihvYmopIHtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIHdoaWxlIChPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSAmJiBPYmplY3Qua2V5cyhPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSkubGVuZ3RoKSB7XG4gICAgICAgIGtleXMgPSBrZXlzLmNvbmNhdChPYmplY3Qua2V5cyhPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSkpO1xuICAgICAgICBvYmogPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKTtcbiAgICB9XG4gICAgcmV0dXJuIGtleXM7XG59XG4vKipcbiAqIEBwYXJhbSB7Q29sdW1uW119IGNvbHVtbiAtIERlZmluZXMgdGhlIENvbHVtblxuICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgY29sdW1uIERlcHRoXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtZWFzdXJlQ29sdW1uRGVwdGgoY29sdW1uKSB7XG4gICAgdmFyIG1heCA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAoIWlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbikgPyBjb2x1bW4ubGVuZ3RoIDogMCk7IGkrKykge1xuICAgICAgICB2YXIgZGVwdGggPSBjaGVja0RlcHRoKGNvbHVtbltwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIDApO1xuICAgICAgICBpZiAobWF4IDwgZGVwdGgpIHtcbiAgICAgICAgICAgIG1heCA9IGRlcHRoO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXggKyAxO1xufVxuLyoqXG4gKiBAcGFyYW0ge0NvbHVtbn0gY29sIC0gRGVmaW5lcyB0aGUgQ29sdW1uXG4gKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBEZWZpbmVzIHRoZSBpbmRleFxuICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgZGVwdGhcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrRGVwdGgoY29sLCBpbmRleCkge1xuICAgIHZhciBtYXggPSBpbmRleDtcbiAgICB2YXIgaW5kaWNlcyA9IFtdO1xuICAgIGlmIChjb2wuY29sdW1ucykge1xuICAgICAgICBpbmRleCsrO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbC5jb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpbmRpY2VzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IGNoZWNrRGVwdGgoY29sLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBpbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpbmRpY2VzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBpZiAobWF4IDwgaW5kaWNlc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0pIHtcbiAgICAgICAgICAgICAgICBtYXggPSBpbmRpY2VzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpbmRleCA9IG1heDtcbiAgICB9XG4gICAgcmV0dXJuIGluZGV4O1xufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgSUdyaWRcbiAqIEBwYXJhbSB7UHJlZGljYXRlTW9kZWxbXX0gZmlsdGVyZWRDb2xzIC0gRGVmaW5lcyB0aGUgUHJlZGljYXRlTW9kZWxcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVmcmVzaEZpbHRlcmVkQ29sc1VpZChnT2JqLCBmaWx0ZXJlZENvbHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbHRlcmVkQ29scy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmaWx0ZXJlZENvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZCA9IGZpbHRlcmVkQ29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNGb3JlaWduS2V5ID9cbiAgICAgICAgICAgIGdldENvbHVtbkJ5Rm9yZWlnbktleVZhbHVlKGZpbHRlcmVkQ29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQsIGdPYmouZ2V0Rm9yZWlnbktleUNvbHVtbnMoKSkudWlkXG4gICAgICAgICAgICA6IGdPYmouZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gPyBnZXRDb2x1bW5Nb2RlbEJ5RmllbGROYW1lKGdPYmosIGZpbHRlcmVkQ29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQpLnVpZFxuICAgICAgICAgICAgICAgIDogZ09iai5nZXRDb2x1bW5CeUZpZWxkKGZpbHRlcmVkQ29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQpLnVpZDtcbiAgICB9XG59XG4vKiogQGhpZGRlbiAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1uYW1lc3BhY2VcbmV4cG9ydCB2YXIgR2xvYmFsO1xuKGZ1bmN0aW9uIChHbG9iYWwpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0XG4gICAgR2xvYmFsLnRpbWVyID0gbnVsbDtcbn0pKEdsb2JhbCB8fCAoR2xvYmFsID0ge30pKTtcbi8qKlxuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC0gRGVmaW5lcyB0aGUgZWxlbWVudFxuICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgdHJhbnNmb3JtIHZhbHVlc1xuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VHJhbnNmb3JtVmFsdWVzKGVsZW1lbnQpIHtcbiAgICB2YXIgc3R5bGUgPSBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQsIG51bGwpO1xuICAgIHZhciB0cmFuc2Zvcm1WID0gc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgndHJhbnNmb3JtJyk7XG4gICAgdmFyIHJlcGxhY2VkVHYgPSB0cmFuc2Zvcm1WLnJlcGxhY2UoLywvZywgJycpO1xuICAgIHZhciB0cmFuc2xhdGVYID0gcGFyc2VGbG9hdCgocmVwbGFjZWRUdikuc3BsaXQoJyAnKVs0XSk7XG4gICAgdmFyIHRyYW5zbGF0ZVkgPSBwYXJzZUZsb2F0KChyZXBsYWNlZFR2KS5zcGxpdCgnICcpWzVdKTtcbiAgICByZXR1cm4geyB3aWR0aDogdHJhbnNsYXRlWCwgaGVpZ2h0OiB0cmFuc2xhdGVZIH07XG59XG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gcm9vdEVsZW1lbnQgLSBEZWZpbmVzIHRoZSByb290IEVsZW1lbnRcbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIERlZmluZXMgdGhlIGVsZW1lbnRcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlCaWdnZXJUaGVtZShyb290RWxlbWVudCwgZWxlbWVudCkge1xuICAgIGlmIChyb290RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtYmlnZ2VyJykpIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLWJpZ2dlcicpO1xuICAgIH1cbn1cbi8qKlxuICogQHBhcmFtIHtJR3JpZH0gZ09iaiAtIERlZmluZXMgZ3JpZCBvYmplY3RcbiAqIEByZXR1cm5zIHtudW1iZXJ9ICAtIFJldHVybnMgc2Nyb2xsIHdpZHRoXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTY3JvbGxXaWR0aChnT2JqKSB7XG4gICAgdmFyIHNjcm9sbEVsZW0gPSBnT2JqLmdldENvbnRlbnQoKS5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICByZXR1cm4gc2Nyb2xsRWxlbS5zY3JvbGxXaWR0aCA+IHNjcm9sbEVsZW0ub2Zmc2V0V2lkdGggPyBnZXRTY3JvbGxCYXJXaWR0aCgpIDogMDtcbn1cbi8qKlxuICogQHBhcmFtIHtJR3JpZH0gZ09iaiAtIERlZmluZXMgZ3JpZCBvYmplY3RcbiAqIEBwYXJhbSB7bnVtYmVyfSBpZHggLSBEZWZpbmVzIHRoZSBpbmRleFxuICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyBjb2xTcGFuIGluZGV4XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldENvbHNwYW5Hcm91cENhcHRpb24oZ09iaiwgaWR4KSB7XG4gICAgdmFyIGNvbHNwYW4gPSAwO1xuICAgIHZhciBjb2xzID0gZ09iai5nZXRDb2x1bW5zKCk7XG4gICAgdmFyIHdpZHRoID0gaWR4ICogMzA7XG4gICAgaWYgKGdPYmouaXNSb3dEcmFnYWJsZSgpKSB7XG4gICAgICAgIGNvbHNwYW4rKztcbiAgICAgICAgd2lkdGggKz0gMzA7XG4gICAgfVxuICAgIGNvbHNwYW4gKz0gKGdPYmouZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAtIGlkeCk7XG4gICAgd2lkdGggKz0gKDMwICogKGdPYmouZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAtIGlkeCkpO1xuICAgIHZhciBncmlkV2lkdGggPSAoZ09iai53aWR0aCA9PT0gJ2F1dG8nID8gZ09iai5lbGVtZW50Lm9mZnNldFdpZHRoIDogZ09iai53aWR0aC50b1N0cmluZygpLmluZGV4T2YoJyUnKSAhPT0gLTEgP1xuICAgICAgICBnT2JqLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggOiBwYXJzZUludChnT2JqLndpZHRoLnRvU3RyaW5nKCksIDEwKSkgLSBnZXRTY3JvbGxXaWR0aChnT2JqKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUpIHtcbiAgICAgICAgICAgIHdpZHRoICs9IHBhcnNlSW50KGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLndpZHRoLnRvU3RyaW5nKCksIDEwKTtcbiAgICAgICAgICAgIGNvbHNwYW4rKztcbiAgICAgICAgfVxuICAgICAgICBpZiAod2lkdGggPiBncmlkV2lkdGgpIHtcbiAgICAgICAgICAgIGNvbHNwYW4tLTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb2xzcGFuO1xufVxuLyoqXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0ciAtIERlZmluZXMgdGhlIHRyIEVsZW1lbnRcbiAqIEBwYXJhbSB7SUdyaWR9IGdPYmogLSBEZWZpbmVzIGdyaWQgb2JqZWN0XG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwQ2FwdGlvblJvd0xlZnRSaWdodFBvcyh0ciwgZ09iaikge1xuICAgIHZhciB3aWR0aCA9IDA7XG4gICAgdmFyIGlkeCA9IDA7XG4gICAgdmFyIGZyb3plbkNvdW50ID0gZ09iai5nZXRWaXNpYmxlRnJvemVuTGVmdENvdW50KCk7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCB0ci5jaGlsZE5vZGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgIHZhciB0ZCA9IHRyLmNoaWxkTm9kZXNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldO1xuICAgICAgICBpZiAoZnJvemVuQ291bnQgPT09IGlkeCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRkLmNsYXNzTGlzdC5jb250YWlucygnZS1ncm91cGNhcHRpb24nKSB8fCB0ZC5jbGFzc0xpc3QuY29udGFpbnMoJ2Utc3VtbWFyeWNlbGwnKSkge1xuICAgICAgICAgICAgaWR4ICs9IHBhcnNlSW50KHRkLmdldEF0dHJpYnV0ZSgnY29sc3BhbicpLCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgdGQuY2xhc3NMaXN0LmFkZCgnZS1sZWZ0ZnJlZXplJyk7XG4gICAgICAgIGlmICh0ZC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZ3JvdXBjYXB0aW9uJykgJiYgcGFyc2VJbnQodGQuZ2V0QXR0cmlidXRlKCdjb2xzcGFuJyksIDEwKSA9PT0gMSkge1xuICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZCgnZS1mcmVlemVsZWZ0Ym9yZGVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgYXBwbHlTdGlja3lMZWZ0UmlnaHRQb3NpdGlvbih0ZCwgd2lkdGgsIGdPYmouZW5hYmxlUnRsLCAnTGVmdCcpO1xuICAgICAgICBpZiAodGQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWluZGVudGNlbGwnKSB8fCB0ZC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtcmVjb3JkcGx1c2V4cGFuZCcpIHx8XG4gICAgICAgICAgICB0ZC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtcmVjb3JkcGx1c2NvbGxhcHNlJykpIHtcbiAgICAgICAgICAgIHdpZHRoICs9IDMwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0ZC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZ3JvdXBjYXB0aW9uJykpIHtcbiAgICAgICAgICAgIHZhciBjb2xzcGFuID0gcGFyc2VJbnQodGQuZ2V0QXR0cmlidXRlKCdjb2xzcGFuJyksIDEwKTtcbiAgICAgICAgICAgIGlmIChnT2JqLmlzUm93RHJhZ2FibGUoKSkge1xuICAgICAgICAgICAgICAgIGNvbHNwYW4tLTtcbiAgICAgICAgICAgICAgICB3aWR0aCArPSAzMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbHNwYW4gPSBjb2xzcGFuIC0gKGdPYmouZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAtIGopO1xuICAgICAgICAgICAgd2lkdGggPSB3aWR0aCArICgzMCAqIChnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggLSBqKSk7XG4gICAgICAgICAgICB2YXIgY29scyA9IGdPYmouZ2V0Q29sdW1ucygpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKChwYXJzZUludCh0ZC5nZXRBdHRyaWJ1dGUoJ2NvbHNwYW4nKSwgMTApID4gMSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKHBhcnNlSW50KGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLndpZHRoLnRvU3RyaW5nKCksIDEwKVxuICAgICAgICAgICAgICAgICAgICAgICAgKyB3aWR0aCkgPiAocGFyc2VJbnQoZ09iai53aWR0aC50b1N0cmluZygpLCAxMCkgLSBnZXRTY3JvbGxXaWR0aChnT2JqKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0NvbHNwYW4gPSByZXNldENvbHNwYW5Hcm91cENhcHRpb24oZ09iaiwgaik7XG4gICAgICAgICAgICAgICAgICAgIHRkLnNldEF0dHJpYnV0ZSgnY29sc3BhbicsIG5ld0NvbHNwYW4udG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCArPSBwYXJzZUludChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS53aWR0aC50b1N0cmluZygpLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbHNwYW4tLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNvbHNwYW4gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0ZC5jbGFzc0xpc3QuY29udGFpbnMoJ2Utc3VtbWFyeWNlbGwnKSkge1xuICAgICAgICAgICAgdmFyIHVpZF8xID0gdGQuZ2V0QXR0cmlidXRlKCdlLW1hcHBpbmd1aWQnKTtcbiAgICAgICAgICAgIHZhciBjb2x1bW4gPSBnT2JqLmdldENvbHVtbkJ5VWlkKHVpZF8xKTtcbiAgICAgICAgICAgIHdpZHRoICs9IHBhcnNlSW50KGNvbHVtbi53aWR0aC50b1N0cmluZygpLCAxMCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gcm93IC0gRGVmaW5lcyByb3cgZWxlbWVudFxuICogQHBhcmFtIHtJR3JpZH0gZ3JpZE9iaiAtIERlZmluZXMgZ3JpZCBvYmplY3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGlzUm93RW50ZXJlZEluR3JpZFxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZW5zdXJlTGFzdFJvdyhyb3csIGdyaWRPYmopIHtcbiAgICB2YXIgY29udGVudCA9IGdyaWRPYmouZ2V0Q29udGVudCgpLmZpcnN0RWxlbWVudENoaWxkO1xuICAgIHJldHVybiByb3cgJiYgKHJvdy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSBjb250ZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCArXG4gICAgICAgIGdyaWRPYmouZ2V0Um93SGVpZ2h0KCkpID4gY29udGVudC5vZmZzZXRIZWlnaHQ7XG59XG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gcm93IC0gRGVmaW5lcyByb3cgZWxlbWVudFxuICogQHBhcmFtIHtudW1iZXJ9IHJvd1RvcCAtIERlZmluZXMgcm93IHRvcCBudW1iZXJcbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGZpcnN0IHJvdyBpcyB0cnVlXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbnN1cmVGaXJzdFJvdyhyb3csIHJvd1RvcCkge1xuICAgIHJldHVybiByb3cgJiYgcm93LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCA8IHJvd1RvcDtcbn1cbi8qKlxuICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gRGVmaW5lcyBpbmRleFxuICogQHBhcmFtIHtJR3JpZH0gZ09iaiAtIERlZmluZXMgZ3JpZCBvYmplY3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGlzUm93RW50ZXJlZEluR3JpZFxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNSb3dFbnRlcmVkSW5HcmlkKGluZGV4LCBnT2JqKSB7XG4gICAgdmFyIHJvd0hlaWdodCA9IGdPYmouZ2V0Um93SGVpZ2h0KCk7XG4gICAgdmFyIHN0YXJ0SW5kZXggPSBnT2JqLmdldENvbnRlbnQoKS5maXJzdEVsZW1lbnRDaGlsZC5zY3JvbGxUb3AgLyByb3dIZWlnaHQ7XG4gICAgdmFyIGVuZEluZGV4ID0gc3RhcnRJbmRleCArIChnT2JqLmdldENvbnRlbnQoKS5maXJzdEVsZW1lbnRDaGlsZC5vZmZzZXRIZWlnaHQgLyByb3dIZWlnaHQpO1xuICAgIHJldHVybiBpbmRleCA8IGVuZEluZGV4ICYmIGluZGV4ID4gc3RhcnRJbmRleDtcbn1cbi8qKlxuICogQHBhcmFtIHtJR3JpZH0gZ09iaiAtIERlZmluZXMgdGhlIGdyaWQgb2JqZWN0XG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIERlZmluZXMgdGhlIHF1ZXJ5XG4gKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBlZGl0ZWQgZGF0YSBpbmRleFxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWRpdGVkRGF0YUluZGV4KGdPYmosIGRhdGEpIHtcbiAgICB2YXIga2V5RmllbGQgPSBnT2JqLmdldFByaW1hcnlLZXlGaWVsZE5hbWVzKClbMF07XG4gICAgdmFyIGRhdGFJbmRleDtcbiAgICBnT2JqLmdldEN1cnJlbnRWaWV3UmVjb3JkcygpLmZpbHRlcihmdW5jdGlvbiAoZSwgaW5kZXgpIHtcbiAgICAgICAgaWYgKGtleUZpZWxkLmluY2x1ZGVzKCcuJykpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBnZXRPYmplY3Qoa2V5RmllbGQsIGUpO1xuICAgICAgICAgICAgdmFyIG9yaWdpbmFsVmFsdWUgPSBnZXRPYmplY3Qoa2V5RmllbGQsIGRhdGEpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSA9PT0gb3JpZ2luYWxWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGRhdGFJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGVbXCJcIiArIGtleUZpZWxkXSA9PT0gZGF0YVtcIlwiICsga2V5RmllbGRdKSB7XG4gICAgICAgICAgICAgICAgZGF0YUluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZGF0YUluZGV4O1xufVxuLyoqXG4gKiBAcGFyYW0ge09iamVjdH0gYXJncyAtIERlZmluZXMgdGhlIGFyZ3VtZW50XG4gKiBAcGFyYW0ge1F1ZXJ5fSBxdWVyeSAtIERlZmluZXMgdGhlIHF1ZXJ5XG4gKiBAcmV0dXJucyB7RmlsdGVyU3RhdGVPYmp9IFJldHVybnMgdGhlIGZpbHRlciBzdGF0ZSBvYmplY3RcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV2ZW50UHJvbWlzZShhcmdzLCBxdWVyeSkge1xuICAgIHZhciBzdGF0ZSA9IGdldFN0YXRlRXZlbnRBcmd1bWVudChxdWVyeSk7XG4gICAgdmFyIGRlZiA9IG5ldyBEZWZlcnJlZCgpO1xuICAgIHN0YXRlLmRhdGFTb3VyY2UgPSBkZWYucmVzb2x2ZTtcbiAgICBzdGF0ZS5hY3Rpb24gPSBhcmdzO1xuICAgIHJldHVybiB7IHN0YXRlOiBzdGF0ZSwgZGVmZmVyZWQ6IGRlZiB9O1xufVxuLyoqXG4gKiBAcGFyYW0ge1F1ZXJ5fSBxdWVyeSAtIERlZmluZXMgdGhlIHF1ZXJ5XG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBzdGF0ZSBldmVudCBhcmd1bWVudFxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RhdGVFdmVudEFyZ3VtZW50KHF1ZXJ5KSB7XG4gICAgdmFyIGFkYXB0ciA9IG5ldyBVcmxBZGFwdG9yKCk7XG4gICAgdmFyIGRtID0gbmV3IERhdGFNYW5hZ2VyKHsgdXJsOiAnJywgYWRhcHRvcjogbmV3IFVybEFkYXB0b3IgfSk7XG4gICAgdmFyIHN0YXRlID0gYWRhcHRyLnByb2Nlc3NRdWVyeShkbSwgcXVlcnkpO1xuICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShzdGF0ZS5kYXRhKTtcbiAgICByZXR1cm4gZGF0YTtcbn1cbi8qKlxuICogQHBhcmFtIHtJR3JpZH0gZ09iaiAtIERlZmluZXMgdGhlIElncmlkXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0aGUgaXNwZXJjZW50YWdlV2lkdGhcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzcGVyY2VudGFnZVdpZHRoKGdPYmopIHtcbiAgICB2YXIgY29sdW1ucyA9IGdPYmouZ2V0VmlzaWJsZUNvbHVtbnMoKTtcbiAgICB2YXIgcGVyY2VudGFnZUNvbCA9IDA7XG4gICAgdmFyIHVuZGVmaW5lZFdpZHRoQ29sID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGlzVW5kZWZpbmVkKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLndpZHRoKSkge1xuICAgICAgICAgICAgdW5kZWZpbmVkV2lkdGhDb2wrKztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS53aWR0aC50b1N0cmluZygpLmluZGV4T2YoJyUnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHBlcmNlbnRhZ2VDb2wrKztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gKGdPYmoud2lkdGggPT09ICdhdXRvJyB8fCB0eXBlb2YgKGdPYmoud2lkdGgpID09PSAnc3RyaW5nJyAmJiBnT2JqLndpZHRoLmluZGV4T2YoJyUnKSAhPT0gLTEpICYmXG4gICAgICAgICFnT2JqLmdyb3VwU2V0dGluZ3Muc2hvd0dyb3VwZWRDb2x1bW4gJiYgZ09iai5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoXG4gICAgICAgICYmIHBlcmNlbnRhZ2VDb2wgJiYgIXVuZGVmaW5lZFdpZHRoQ29sO1xufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgSUdyaWRcbiAqIEBwYXJhbSB7Um93PENvbHVtbj5bXX0gcm93cyAtIERlZmluZXMgdGhlIHJvd1xuICogQHBhcmFtIHtIVE1MVGFibGVSb3dFbGVtZW50W119IHJvd0VsbXMgLSBSb3cgZWxlbWVudHNcbiAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIFJvdyBpbmRleFxuICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0Um93SW5kZXggLSBTdGFydCBSb3cgSW5kZXhcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRSb3dJbmRleChnT2JqLCByb3dzLCByb3dFbG1zLCBpbmRleCwgc3RhcnRSb3dJbmRleCkge1xuICAgIHZhciBzdGFydEluZGV4ID0gaW5kZXggPyBpbmRleCA6IDA7XG4gICAgZm9yICh2YXIgaSA9IHN0YXJ0Um93SW5kZXggPyBzdGFydFJvd0luZGV4IDogMDsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldICYmIHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzRGF0YVJvdykge1xuICAgICAgICAgICAgcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZXggPSBzdGFydEluZGV4O1xuICAgICAgICAgICAgcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNBbHRSb3cgPSBnT2JqLmVuYWJsZUFsdFJvdyA/IHN0YXJ0SW5kZXggJSAyICE9PSAwIDogZmFsc2U7XG4gICAgICAgICAgICByb3dFbG1zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5zZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4LCAoc3RhcnRJbmRleCArIDEpLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgaWYgKHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzQWx0Um93KSB7XG4gICAgICAgICAgICAgICAgcm93RWxtc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZCgnZS1hbHRyb3cnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJvd0VsbXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5yZW1vdmUoJ2UtYWx0cm93Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJvd0VsbXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgcm93RWxtc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbHNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnNldEF0dHJpYnV0ZSgnaW5kZXgnLCBzdGFydEluZGV4LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RhcnRJbmRleCsrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghcm93cy5sZW5ndGgpIHtcbiAgICAgICAgZ09iai5yZW5kZXJNb2R1bGUuZW1wdHlSb3codHJ1ZSk7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgSUdyaWRcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRDYWNoZWRSb3dJbmRleChnT2JqKSB7XG4gICAgdmFyIHJvd09iamVjdHMgPSBnT2JqLmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nICYmIGdPYmouaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZSA/XG4gICAgICAgIGdPYmouZ2V0Um93c09iamVjdCgpIDogZ09iai52Um93cztcbiAgICB2YXIgcm93RWxlbWVudHMgPSBnT2JqLmdldFJvd3MoKTtcbiAgICBmb3IgKHZhciBpID0gMCwgc3RhcnRJbmRleCA9IDAsIGsgPSAwOyBpIDwgcm93T2JqZWN0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcm93T2JqZWN0ID0gcm93T2JqZWN0c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgIGlmIChyb3dPYmplY3QuaXNEYXRhUm93KSB7XG4gICAgICAgICAgICByb3dPYmplY3QuaW5kZXggPSBzdGFydEluZGV4O1xuICAgICAgICAgICAgcm93T2JqZWN0LmlzQWx0Um93ID0gZ09iai5lbmFibGVBbHRSb3cgPyBzdGFydEluZGV4ICUgMiAhPT0gMCA6IGZhbHNlO1xuICAgICAgICAgICAgdmFyIHJvd0VsZW1lbnQgPSBnT2JqLmdldFJvd0VsZW1lbnRCeVVJRChyb3dPYmplY3QudWlkKTtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQocm93RWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICByb3dFbGVtZW50c1twYXJzZUludChrLnRvU3RyaW5nKCksIDEwKV0gPSByb3dFbGVtZW50O1xuICAgICAgICAgICAgICAgIHJvd0VsZW1lbnQuc2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCwgKHN0YXJ0SW5kZXggKyAxKS50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBpZiAocm93T2JqZWN0LmlzQWx0Um93KSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd0VsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1hbHRyb3cnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZS1hbHRyb3cnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByb3dFbGVtZW50LmNlbGxzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd0VsZW1lbnQuY2VsbHNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnNldEF0dHJpYnV0ZSgnaW5kZXgnLCBzdGFydEluZGV4LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBrKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdGFydEluZGV4Kys7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGdPYmouZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgJiYgZ09iai5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlKSB7XG4gICAgICAgIGdPYmouaW5maW5pdGVTY3JvbGxNb2R1bGUucmVzZXRJbmZpbml0ZUNhY2hlKHJvd09iamVjdHMpO1xuICAgIH1cbn1cbi8qKlxuICogQHBhcmFtIHtJR3JpZH0gZ09iaiAtIERlZmluZXMgdGhlIElHcmlkXG4gKiBAcGFyYW0ge1Jvd0Ryb3BFdmVudEFyZ3N9IGFyZ3MgLSBEZWZpbmVzIHRoZSByb3cgZHJvcCBldmVudCBhcmd1bWVudFxuICogQHBhcmFtIHtIVE1MVGFibGVSb3dFbGVtZW50W119IHRyIC0gUm93IGVsZW1lbnRzXG4gKiBAcGFyYW0ge1JvdzxDb2x1bW4+fSBkcm9wUk9iaiAtIGRyb3BwZWQgcm93IG9iamVjdFxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBncm91cFJlb3JkZXJSb3dPYmplY3QoZ09iaiwgYXJncywgdHIsIGRyb3BST2JqKSB7XG4gICAgdmFyIHJvd09iamVjdHMgPSBnT2JqLmVuYWJsZVZpcnR1YWxpemF0aW9uID8gZ09iai52Um93cyA6IGdPYmouZ2V0Um93c09iamVjdCgpO1xuICAgIHZhciBvcmRlckNoYW5nZVJvd09iamVjdHMgPSBbXTtcbiAgICB2YXIgZHJvcFJvd09iamVjdCA9IGRyb3BST2JqID8gZHJvcFJPYmogOlxuICAgICAgICBnT2JqLmdldFJvd09iamVjdEZyb21VSUQoYXJncy50YXJnZXQuY2xvc2VzdCgndHInKS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdWlkJykpO1xuICAgIHZhciByb3dPYmplY3REcm9wSW5kZXg7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLnJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIG9yZGVyQ2hhbmdlUm93T2JqZWN0ID0gZ09iai5nZXRSb3dPYmplY3RGcm9tVUlEKGFyZ3Mucm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZ2V0QXR0cmlidXRlKCdkYXRhLXVpZCcpKTtcbiAgICAgICAgaWYgKGRyb3BSb3dPYmplY3QgPT09IG9yZGVyQ2hhbmdlUm93T2JqZWN0KSB7XG4gICAgICAgICAgICByb3dPYmplY3REcm9wSW5kZXggPSByb3dPYmplY3RzLmluZGV4T2YoZHJvcFJvd09iamVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgb3JkZXJDaGFuZ2VSb3dPYmplY3RzLnB1c2gocm93T2JqZWN0cy5zcGxpY2Uocm93T2JqZWN0cy5pbmRleE9mKG9yZGVyQ2hhbmdlUm93T2JqZWN0KSwgMSlbMF0pO1xuICAgIH1cbiAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQocm93T2JqZWN0RHJvcEluZGV4KSkge1xuICAgICAgICByb3dPYmplY3REcm9wSW5kZXggPSByb3dPYmplY3RzLmluZGV4T2YoZHJvcFJvd09iamVjdCk7XG4gICAgICAgIGlmIChhcmdzLmZyb21JbmRleCA+IGFyZ3MuZHJvcEluZGV4KSB7XG4gICAgICAgICAgICByb3dPYmplY3RzLnNwbGljZS5hcHBseShyb3dPYmplY3RzLCBbcm93T2JqZWN0RHJvcEluZGV4LCAwXS5jb25jYXQob3JkZXJDaGFuZ2VSb3dPYmplY3RzKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByb3dPYmplY3RzLnNwbGljZS5hcHBseShyb3dPYmplY3RzLCBbcm93T2JqZWN0RHJvcEluZGV4ICsgMSwgMF0uY29uY2F0KG9yZGVyQ2hhbmdlUm93T2JqZWN0cykpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByb3dPYmplY3RzLnNwbGljZS5hcHBseShyb3dPYmplY3RzLCBbcm93T2JqZWN0RHJvcEluZGV4LCAwXS5jb25jYXQob3JkZXJDaGFuZ2VSb3dPYmplY3RzKSk7XG4gICAgfVxuICAgIGlmICghZ09iai5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiAhZ09iai5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlKSB7XG4gICAgICAgIHZhciByZWNvcmQgPSB7fTtcbiAgICAgICAgdmFyIGN1cnJlbnRWaWV3RGF0YSA9IGdPYmouZ2V0Q3VycmVudFZpZXdSZWNvcmRzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0ci5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gcGFyc2VJbnQodHJbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmdldEF0dHJpYnV0ZShsaXRlcmFscy5hcmlhUm93SW5kZXgpLCAxMCkgLSAxO1xuICAgICAgICAgICAgcmVjb3JkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IGN1cnJlbnRWaWV3RGF0YVtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb3dzID0gZ09iai5nZXRSb3dzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0ci5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0gPSB0cltwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICBjdXJyZW50Vmlld0RhdGFbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID0gcmVjb3JkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZ09iai5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyAmJiBnT2JqLmluZmluaXRlU2Nyb2xsU2V0dGluZ3MuZW5hYmxlQ2FjaGUpIHtcbiAgICAgICAgZ09iai5pbmZpbml0ZVNjcm9sbE1vZHVsZS5yZXNldEluZmluaXRlQ2FjaGUocm93T2JqZWN0cyk7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgZ3JpZCBvYmplY3RcbiAqIEBwYXJhbSB7T2JqZWN0fSBjaGFuZ2VzIC0gRGVmaW5lcyB0aGUgY2hhbmdlc1xuICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBEZWZpbmVzIHRoZSB0eXBlXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5RmllbGQgLSBEZWZpbmVzIHRoZSBrZXlmaWVsZFxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlQ2hhbmdlcyhnT2JqLCBjaGFuZ2VzLCB0eXBlLCBrZXlGaWVsZCkge1xuICAgIHZhciBuZXdBcnJheSA9IGdPYmouZGF0YVRvQmVVcGRhdGVkW1wiXCIgKyB0eXBlXS5jb25jYXQoY2hhbmdlc1tcIlwiICsgdHlwZV0pLnJlZHVjZShmdW5jdGlvbiAociwgbykge1xuICAgICAgICByW29bXCJcIiArIGtleUZpZWxkXV0gPSByW29bXCJcIiArIGtleUZpZWxkXV0gPT09IHVuZGVmaW5lZCA/IG8gOiBPYmplY3QuYXNzaWduKHJbb1tcIlwiICsga2V5RmllbGRdXSwgbyk7XG4gICAgICAgIHJldHVybiByO1xuICAgIH0sIHt9KTtcbiAgICBnT2JqLmRhdGFUb0JlVXBkYXRlZFtcIlwiICsgdHlwZV0gPSBPYmplY3Qua2V5cyhuZXdBcnJheSkubWFwKGZ1bmN0aW9uIChrKSB7IHJldHVybiBuZXdBcnJheVtcIlwiICsga107IH0pO1xufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgZ3JpZCBvYmplY3RcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Um93RWxlbWVudHMoZ09iaikge1xuICAgIGlmIChnT2JqLmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nICYmIChnT2JqLmNoaWxkR3JpZCB8fCBnT2JqLmRldGFpbFRlbXBsYXRlKSkge1xuICAgICAgICAoZ09iaikuY29udGVudE1vZHVsZS5yb3dFbGVtZW50cyA9IFtdLnNsaWNlLmNhbGwoZ09iai5nZXRDb250ZW50VGFibGUoKS5yb3dzKVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAocm93KSB7IHJldHVybiAocm93LmNsYXNzTGlzdC5jb250YWlucygnZS1yb3cnKSB8fCByb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWRldGFpbHJvdycpKVxuICAgICAgICAgICAgJiYgIXJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2UtYWRkZWRyb3cnKTsgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgKGdPYmopLmNvbnRlbnRNb2R1bGUucm93RWxlbWVudHMgPVxuICAgICAgICBbXS5zbGljZS5jYWxsKGdPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZS1yb3c6bm90KC5lLWFkZGVkcm93KTpub3QoLmUtY2xvbmVwcm9wZXJ0aWVzIC5lLXJvdyknKSk7XG59XG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gcm93IC0gRGVmaW5lcyB0aGUgcm93XG4gKiBAcGFyYW0ge251bWJlcn0gc3RhcnQgLSBEZWZpbmVzIHRoZSBzdGFydCBpbmRleFxuICogQHBhcmFtIHtudW1iZXJ9IGVuZCAtIERlZmluZXMgdGhlIGVuZCBpbmRleFxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzbGljZUVsZW1lbnRzKHJvdywgc3RhcnQsIGVuZCkge1xuICAgIHZhciBjZWxscyA9IHJvdy5jaGlsZHJlbjtcbiAgICB2YXIgbGVuID0gY2VsbHMubGVuZ3RoO1xuICAgIHZhciBrID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrLCBrKyspIHtcbiAgICAgICAgaWYgKGkgPj0gc3RhcnQgJiYgaSA8IGVuZCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgcm93LnJlbW92ZUNoaWxkKHJvdy5jaGlsZHJlbltwYXJzZUludChrLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICBrLS07XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgZ3JpZFxuICogQHBhcmFtIHtEaWFsb2d9IGRsZ09iaiAtIERlZmluZXMgdGhlIGRpYWxvZ1xuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldERpYWxvZ0FwcGVuZChnT2JqLCBkbGdPYmopIHtcbiAgICB2YXIgZWxlbWVudCA9IGdPYmouY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLWdyaWQtcG9wdXAnLCBpZDogZ09iai5lbGVtZW50LmlkICsgJ19lLXBvcHVwJyB9KTtcbiAgICB2YXIgcG9zID0gY2FsY3VsYXRlUG9zaXRpb24oZ09iai5lbGVtZW50LCAnbGVmdCcsICdUb3AnKTtcbiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZ09iai5lbGVtZW50LmlkICsgJ19lLXBvcHVwJykpIHtcbiAgICAgICAgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGdPYmouZWxlbWVudC5pZCArICdfZS1wb3B1cCcpO1xuICAgIH1cbiAgICBlbGVtZW50LnN0eWxlLnRvcCA9IHBvcy50b3AgKyAncHgnO1xuICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9IHBvcy5sZWZ0ICsgJ3B4JztcbiAgICBlbGVtZW50LnN0eWxlLnpJbmRleCA9IChkbGdPYmouekluZGV4KS50b1N0cmluZygpO1xuICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSBkbGdPYmouZWxlbWVudC5vZmZzZXRXaWR0aCArICdweCc7XG4gICAgZWxlbWVudC5hcHBlbmRDaGlsZChkbGdPYmouZWxlbWVudCk7XG4gICAgdmFyIHNiUGFuZWwgPSBwYXJlbnRzVW50aWwoZ09iai5lbGVtZW50LCAnc2ItZGVtby1zZWN0aW9uJykgfHwgcGFyZW50c1VudGlsKGdPYmouZWxlbWVudCwgJ2UtZ3JpZC1kaWFsb2ctZml4ZWQnKTtcbiAgICBpZiAoc2JQYW5lbCkge1xuICAgICAgICB2YXIgc2JQb3MgPSBjYWxjdWxhdGVSZWxhdGl2ZUJhc2VkUG9zaXRpb24oZ09iai5lbGVtZW50LCBzYlBhbmVsKTtcbiAgICAgICAgZWxlbWVudC5zdHlsZS50b3AgPSBzYlBvcy50b3AgKyAncHgnO1xuICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSBzYlBvcy5sZWZ0ICsgJ3B4JztcbiAgICAgICAgc2JQYW5lbC5pbnNlcnRCZWZvcmUoZWxlbWVudCwgc2JQYW5lbC5maXJzdENoaWxkKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QmVmb3JlKGVsZW1lbnQsIGRvY3VtZW50LmJvZHkuZmlyc3RDaGlsZCk7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0NvbHVtbn0gY29sdW1uIC0gRGVmaW5lcyB0aGUgY29sdW1uXG4gKiBAcGFyYW0ge3N0cmluZ30gdWlkIC0gRGVmaW5lcyB0aGUgdWlkXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBpcyBjaGlsZCBjb2x1bW5cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQ2hpbGRDb2x1bW4oY29sdW1uLCB1aWQpIHtcbiAgICB2YXIgdWlkcyA9IFtdO1xuICAgIHVpZHMucHVzaChjb2x1bW4udWlkKTtcbiAgICBwdXNodWlkKGNvbHVtbiwgdWlkcyk7XG4gICAgaWYgKHVpZHMuaW5kZXhPZih1aWQpID4gLTEpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0NvbHVtbn0gY29sdW1uIC0gRGVmaW5lcyB0aGUgY29sdW1uXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSB1aWRzIC0gRGVmaW5lcyB0aGUgdWlkXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHB1c2h1aWQoY29sdW1uLCB1aWRzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2x1bW4uY29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoY29sdW1uLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZCkge1xuICAgICAgICAgICAgdWlkcy5wdXNoKGNvbHVtbi5jb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS51aWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2x1bW4uY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucyAmJlxuICAgICAgICAgICAgY29sdW1uLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBwdXNodWlkKGNvbHVtbi5jb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgdWlkcyk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEBwYXJhbSB7Q29sdW1ufSBjb2x1bW4gLSBEZWZpbmVzIHRoZSBjb2x1bW5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGRpcmVjdGlvblxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvemVuRGlyZWN0aW9uKGNvbHVtbikge1xuICAgIGlmIChjb2x1bW4uY29sdW1uc1swXS5mcmVlemUgfHwgY29sdW1uLmNvbHVtbnNbMF0uaXNGcm96ZW4pIHtcbiAgICAgICAgaWYgKGNvbHVtbi5jb2x1bW5zWzBdLmZyZWV6ZSA9PT0gJ0xlZnQnIHx8IGNvbHVtbi5jb2x1bW5zWzBdLmlzRnJvemVuKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0xlZnQnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbHVtbi5jb2x1bW5zWzBdLmZyZWV6ZSA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgcmV0dXJuICdSaWdodCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29sdW1uLmNvbHVtbnNbMF0uZnJlZXplID09PSAnRml4ZWQnKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0ZpeGVkJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnTm9uZSc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChjb2x1bW4uY29sdW1uc1swXS5jb2x1bW5zICYmIGNvbHVtbi5jb2x1bW5zWzBdLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gZnJvemVuRGlyZWN0aW9uKGNvbHVtbi5jb2x1bW5zWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAnTm9uZSc7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEBwYXJhbSB7RWxlbWVudH0gcm93IC0gRGVmaW5lcyB0aGUgcm93XG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEZpeGVkQ29sdW1uQm9yZGVyKHJvdykge1xuICAgIGlmIChyb3cucXVlcnlTZWxlY3RvcignLmUtZml4ZWRmcmVlemUnKSkge1xuICAgICAgICB2YXIgY2VsbHMgPSBbXS5zbGljZS5jYWxsKHJvdy5xdWVyeVNlbGVjdG9yQWxsKCcuZS1maWx0ZXJiYXJjZWxsOm5vdCguZS1oaWRlKSwuZS1zdW1tYXJ5Y2VsbDpub3QoLmUtaGlkZSksLmUtaGVhZGVyY2VsbDpub3QoLmUtaGlkZSksLmUtcm93Y2VsbDpub3QoLmUtaGlkZSknKSk7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY2VsbHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIGlmIChjZWxsc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWZpeGVkZnJlZXplJykgJiYgKCEoY2VsbHNbaiAtIDFdKSB8fFxuICAgICAgICAgICAgICAgIChjZWxsc1tqIC0gMV0gJiYgIWNlbGxzW2ogLSAxXS5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZml4ZWRmcmVlemUnKSkpKSB7XG4gICAgICAgICAgICAgICAgY2VsbHNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5hZGQoJ2UtZnJlZXplbGVmdGJvcmRlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNlbGxzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZml4ZWRmcmVlemUnKSAmJiAoIShjZWxsc1tqICsgMV0pIHx8XG4gICAgICAgICAgICAgICAgKGNlbGxzW2ogKyAxXSAmJiAhY2VsbHNbaiArIDFdLmNsYXNzTGlzdC5jb250YWlucygnZS1maXhlZGZyZWV6ZScpKSkpIHtcbiAgICAgICAgICAgICAgICBjZWxsc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZCgnZS1mcmVlemVyaWdodGJvcmRlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBub2RlIC0gRGVmaW5lcyB0aGUgcm93XG4gKiBAcGFyYW0ge251bWJlcn0gd2lkdGggLSBEZWZpbmVzIHRoZSB3aWR0aFxuICogQHBhcmFtIHtib29sZWFufSBpc1J0bCAtIEJvb2xlYW4gcHJvcGVydHlcbiAqIEBwYXJhbSB7c3RyaW5nfSBwb3NpdGlvbiAtIERlZmluZXMgdGhlIHBvc2l0aW9uXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5U3RpY2t5TGVmdFJpZ2h0UG9zaXRpb24obm9kZSwgd2lkdGgsIGlzUnRsLCBwb3NpdGlvbikge1xuICAgIGlmIChwb3NpdGlvbiA9PT0gJ0xlZnQnKSB7XG4gICAgICAgIGlmIChpc1J0bCkge1xuICAgICAgICAgICAgbm9kZS5zdHlsZS5yaWdodCA9IHdpZHRoICsgJ3B4JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5vZGUuc3R5bGUubGVmdCA9IHdpZHRoICsgJ3B4JztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocG9zaXRpb24gPT09ICdSaWdodCcpIHtcbiAgICAgICAgaWYgKGlzUnRsKSB7XG4gICAgICAgICAgICBub2RlLnN0eWxlLmxlZnQgPSB3aWR0aCArICdweCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBub2RlLnN0eWxlLnJpZ2h0ID0gd2lkdGggKyAncHgnO1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgZ3JpZFxuICogQHBhcmFtIHtDb2x1bW59IGNvbHVtbiAtIERlZmluZXMgdGhlIGNvbHVtblxuICogQHBhcmFtIHtFbGVtZW50fSBub2RlIC0gRGVmaW5lcyB0aGUgRWxlbWVudFxuICogQHBhcmFtIHtudW1iZXJ9IGNvbFNwYW4gLSBEZWZpbmVzIHRoZSBjb2xTcGFuIHZhbHVlXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0Q29sYW5kUm93U3BhblN0aWNreVBvc2l0aW9uKGdPYmosIGNvbHVtbiwgbm9kZSwgY29sU3Bhbikge1xuICAgIHZhciBjb2x1bW5zID0gZ09iai5nZXRDb2x1bW5zKCk7XG4gICAgdmFyIGluZGV4ID0gY29sdW1uLmluZGV4O1xuICAgIGlmIChjb2x1bW4uZnJlZXplID09PSAnTGVmdCcgJiYgY29sdW1uLmJvcmRlciAhPT0gJ0xlZnQnKSB7XG4gICAgICAgIHZhciBpZHggPSBpbmRleCArIChjb2xTcGFuIC0gMSk7XG4gICAgICAgIHdoaWxlIChjb2x1bW5zW3BhcnNlSW50KGlkeC50b1N0cmluZygpLCAxMCldLnZpc2libGUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBpZHgrKztcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29sdW1uc1twYXJzZUludChpZHgudG9TdHJpbmcoKSwgMTApXS5ib3JkZXIgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWZyZWV6ZWxlZnRib3JkZXInKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChjb2x1bW4uZnJlZXplID09PSAnUmlnaHQnIHx8IGNvbHVtbi5mcmVlemUgPT09ICdGaXhlZCcpIHtcbiAgICAgICAgdmFyIHdpZHRoID0gMDtcbiAgICAgICAgZm9yICh2YXIgaiA9IGluZGV4ICsgMTsgaiA8IGluZGV4ICsgY29sU3BhbjsgaisrKSB7XG4gICAgICAgICAgICBpZiAoaiA9PT0gY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgd2lkdGggKz0gcGFyc2VJbnQoY29sdW1uc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0ud2lkdGgudG9TdHJpbmcoKSwgMTApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29sU3BhbisrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChnT2JqLmVuYWJsZVJ0bCkge1xuICAgICAgICAgICAgbm9kZS5zdHlsZS5sZWZ0ID0gcGFyc2VJbnQobm9kZS5zdHlsZS5sZWZ0LCAxMCkgLSB3aWR0aCArICdweCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBub2RlLnN0eWxlLnJpZ2h0ID0gcGFyc2VJbnQobm9kZS5zdHlsZS5yaWdodCwgMTApIC0gd2lkdGggKyAncHgnO1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgZ3JpZFxuICogQHBhcmFtIHtudW1iZXJ9IHJvd0luZGV4IC0gRGVmaW5lcyB0aGUgcm93IGluZGV4XG4gKiBAcGFyYW0ge251bWJlcn0gY29sSW5kZXggLSBEZWZpbmVzIHRoZSBjb2x1bSBpbmRleFxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDZWxsRnJvbVJvdyhnT2JqLCByb3dJbmRleCwgY29sSW5kZXgpIHtcbiAgICB2YXIgcm93ID0gKGdPYmouZ2V0Um93QnlJbmRleChyb3dJbmRleCkpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm93LmNlbGxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChwYXJzZUludChyb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmdldEF0dHJpYnV0ZSgnYXJpYS1jb2xpbmRleCcpLnRvU3RyaW5nKCksIDEwKSAtIDEgPT09IGNvbEluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gcm93LmNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbi8qKlxuICogQHBhcmFtIHtJR3JpZH0gZ09iaiAtIERlZmluZXMgdGhlIGdyaWRcbiAqIEBwYXJhbSB7Q29sdW1ufSBjb2x1bW4gLSBEZWZpbmVzIHRoZSBjb2x1bW5cbiAqIEBwYXJhbSB7RWxlbWVudH0gbm9kZSAtIERlZmluZXMgdGhlIEVsZW1lbnRcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkU3RpY2t5Q29sdW1uUG9zaXRpb24oZ09iaiwgY29sdW1uLCBub2RlKSB7XG4gICAgaWYgKGNvbHVtbi5mcmVlemUgPT09ICdMZWZ0JyB8fCBjb2x1bW4uaXNGcm96ZW4pIHtcbiAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWxlZnRmcmVlemUnKTtcbiAgICAgICAgaWYgKGNvbHVtbi5ib3JkZXIgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWZyZWV6ZWxlZnRib3JkZXInKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29sdW1uLmluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICBhcHBseVN0aWNreUxlZnRSaWdodFBvc2l0aW9uKG5vZGUsIChnT2JqLmdldEluZGVudENvdW50KCkgKiAzMCksIGdPYmouZW5hYmxlUnRsLCAnTGVmdCcpO1xuICAgICAgICAgICAgaWYgKGdPYmouZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgICAgICBjb2x1bW4udmFsdWVYID0gKGdPYmouZ2V0SW5kZW50Q291bnQoKSAqIDMwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBjb2xzID0gZ09iai5nZXRDb2x1bW5zKCk7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBnT2JqLmdldEluZGVudENvdW50KCkgKiAzMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChjb2x1bW4udWlkID09PSBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS51aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICs9IHBhcnNlRmxvYXQoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ud2lkdGgudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXBwbHlTdGlja3lMZWZ0UmlnaHRQb3NpdGlvbihub2RlLCB3aWR0aCwgZ09iai5lbmFibGVSdGwsICdMZWZ0Jyk7XG4gICAgICAgICAgICBpZiAoZ09iai5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbikge1xuICAgICAgICAgICAgICAgIGNvbHVtbi52YWx1ZVggPSB3aWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChjb2x1bW4uZnJlZXplID09PSAnUmlnaHQnKSB7XG4gICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnZS1yaWdodGZyZWV6ZScpO1xuICAgICAgICB2YXIgY29scyA9IGdPYmouZ2V0Q29sdW1ucygpO1xuICAgICAgICBpZiAoY29sdW1uLmJvcmRlciA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWZyZWV6ZXJpZ2h0Ym9yZGVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbi5pbmRleCA9PT0gY29sc1tjb2xzLmxlbmd0aCAtIDFdLmluZGV4KSB7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBnT2JqLmdldEZyb3plbk1vZGUoKSA9PT0gJ1JpZ2h0JyAmJiBnT2JqLmlzUm93RHJhZ2FibGUoKSA/IDMwIDogMDtcbiAgICAgICAgICAgIGFwcGx5U3RpY2t5TGVmdFJpZ2h0UG9zaXRpb24obm9kZSwgd2lkdGgsIGdPYmouZW5hYmxlUnRsLCAnUmlnaHQnKTtcbiAgICAgICAgICAgIGlmIChnT2JqLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uLnZhbHVlWCA9IHdpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gZ09iai5nZXRGcm96ZW5Nb2RlKCkgPT09ICdSaWdodCcgJiYgZ09iai5pc1Jvd0RyYWdhYmxlKCkgPyAzMCA6IDA7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gY29scy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgIGlmIChjb2x1bW4udWlkID09PSBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS51aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICs9IHBhcnNlRmxvYXQoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ud2lkdGgudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXBwbHlTdGlja3lMZWZ0UmlnaHRQb3NpdGlvbihub2RlLCB3aWR0aCwgZ09iai5lbmFibGVSdGwsICdSaWdodCcpO1xuICAgICAgICAgICAgaWYgKGdPYmouZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgICAgICBjb2x1bW4udmFsdWVYID0gd2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoY29sdW1uLmZyZWV6ZSA9PT0gJ0ZpeGVkJykge1xuICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ2UtZml4ZWRmcmVlemUnKTtcbiAgICAgICAgdmFyIGNvbHMgPSBnT2JqLmdldENvbHVtbnMoKTtcbiAgICAgICAgdmFyIHdpZHRoID0gMDtcbiAgICAgICAgaWYgKGdPYmouZ2V0VmlzaWJsZUZyb3plbkxlZnRDb3VudCgpKSB7XG4gICAgICAgICAgICB3aWR0aCA9IGdPYmouZ2V0SW5kZW50Q291bnQoKSAqIDMwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGdPYmouZ2V0RnJvemVuTW9kZSgpID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICB3aWR0aCA9IGdPYmouZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAqIDMwO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGNvbHVtbi51aWQgPT09IGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mcmVlemUgPT09ICdMZWZ0JyB8fCBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0Zyb3plbikgfHxcbiAgICAgICAgICAgICAgICBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mcmVlemUgPT09ICdGaXhlZCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCArPSBwYXJzZUZsb2F0KGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLndpZHRoLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhcHBseVN0aWNreUxlZnRSaWdodFBvc2l0aW9uKG5vZGUsICh3aWR0aCAtIDEpLCBnT2JqLmVuYWJsZVJ0bCwgJ0xlZnQnKTtcbiAgICAgICAgd2lkdGggPSBnT2JqLmdldEZyb3plbk1vZGUoKSA9PT0gJ1JpZ2h0JyAmJiBnT2JqLmlzUm93RHJhZ2FibGUoKSA/IDMwIDogMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IGNvbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW4udWlkID09PSBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS51aWQpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mcmVlemUgPT09ICdSaWdodCcgfHwgY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnRml4ZWQnKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggKz0gcGFyc2VGbG9hdChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS53aWR0aC50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXBwbHlTdGlja3lMZWZ0UmlnaHRQb3NpdGlvbihub2RlLCAod2lkdGggLSAxKSwgZ09iai5lbmFibGVSdGwsICdSaWdodCcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLXVuZnJlZXplJyk7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gRGVmaW5lcyB0aGUgZ3JpZCBPYmplY3RcbiAqIEBwYXJhbSB7Q29sdW1ufSBjb2wgLSBEZWZpbmVzIHRoZSBjb2x1bW5cbiAqIEBwYXJhbSB7bnVtYmVyfSByb3dJbmRleCAtIERlZmluZXMgdGhlIHJvd2luZGV4XG4gKiBAcmV0dXJucyB7RWxlbWVudH0gUmV0dXJucyB0aGUgZWxlbWVudFxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2VsbHNCeVRhYmxlTmFtZShnT2JqLCBjb2wsIHJvd0luZGV4KSB7XG4gICAgcmV0dXJuIFtdLnNsaWNlLmNhbGwoZ09iai5nZXREYXRhUm93cygpW3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShsaXRlcmFscy5yb3dDZWxsKSk7XG59XG4vKipcbiAqIEBwYXJhbSB7SUdyaWR9IGdPYmogLSBEZWZpbmVzIHRoZSBjb2x1bW5cbiAqIEBwYXJhbSB7Q29sdW1ufSBjb2wgLSBEZWZpbmVzIHRoZSBpbmRleFxuICogQHBhcmFtIHtudW1iZXJ9IHJvd0luZGV4IC0gRGVmaW5lcyB0aGUgcnVsZXNcbiAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIERlZmluZXMgdGhlIG1vdmFibGUgY29sdW1uIHJ1bGVzXG4gKiBAcmV0dXJucyB7RWxlbWVudH0gUmV0dXJucyB0aGUgRWxlbWVudFxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2VsbEJ5Q29sQW5kUm93SW5kZXgoZ09iaiwgY29sLCByb3dJbmRleCwgaW5kZXgpIHtcbiAgICByZXR1cm4gZ2V0Q2VsbHNCeVRhYmxlTmFtZShnT2JqLCBjb2wsIHJvd0luZGV4KVtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldO1xufVxuLyoqXG4gKiBAcGFyYW0ge0NvbHVtbn0gY29sIC0gRGVmaW5lcyB0aGUgY29sdW1uXG4gKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBEZWZpbmVzIHRoZSBpbmRleFxuICogQHBhcmFtIHtPYmplY3R9IHJ1bGVzIC0gRGVmaW5lcyB0aGUgcnVsZXNcbiAqIEBwYXJhbSB7T2JqZWN0fSBtUnVsZXMgLSBEZWZpbmVzIHRoZSBtb3ZhYmxlIGNvbHVtbiBydWxlc1xuICogQHBhcmFtIHtPYmplY3R9IGZyUnVsZXMgLSBEZWZpbmVzIHRoZSBGcm96ZW4gcnVsZXNcbiAqIEBwYXJhbSB7bnVtYmVyfSBsZW4gLSBEZWZpbmVzIHRoZSBsZW5ndGhcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNDdXN0b20gLSBEZWZpbmVzIGN1c3RvbSBmb3JtIHZhbGlkYXRpb25cbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0VmFsaWRhdGlvblJ1ZWxzKGNvbCwgaW5kZXgsIHJ1bGVzLCBtUnVsZXMsIGZyUnVsZXMsIGxlbiwgaXNDdXN0b20pIHtcbiAgICBpZiAoaXNDdXN0b20pIHtcbiAgICAgICAgcnVsZXNbZ2V0Q29tcGxleEZpZWxkSUQoY29sLmZpZWxkKV0gPSBjb2wudmFsaWRhdGlvblJ1bGVzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGNvbC5nZXRGcmVlemVUYWJsZU5hbWUoKSA9PT0gbGl0ZXJhbHMuZnJvemVuTGVmdFxuICAgICAgICAgICAgfHwgKCFpbmRleCAmJiBjb2wuZ2V0RnJlZXplVGFibGVOYW1lKCkgPT09IGxpdGVyYWxzLmZyb3plblJpZ2h0KSB8fCBsZW4gPT09IDEpIHtcbiAgICAgICAgICAgIHJ1bGVzW2dldENvbXBsZXhGaWVsZElEKGNvbC5maWVsZCldID0gY29sLnZhbGlkYXRpb25SdWxlcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2wuZ2V0RnJlZXplVGFibGVOYW1lKCkgPT09ICdtb3ZhYmxlJyB8fCAhY29sLmdldEZyZWV6ZVRhYmxlTmFtZSgpKSB7XG4gICAgICAgICAgICBtUnVsZXNbZ2V0Q29tcGxleEZpZWxkSUQoY29sLmZpZWxkKV0gPSBjb2wudmFsaWRhdGlvblJ1bGVzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbC5nZXRGcmVlemVUYWJsZU5hbWUoKSA9PT0gbGl0ZXJhbHMuZnJvemVuUmlnaHQpIHtcbiAgICAgICAgICAgIGZyUnVsZXNbZ2V0Q29tcGxleEZpZWxkSUQoY29sLmZpZWxkKV0gPSBjb2wudmFsaWRhdGlvblJ1bGVzO1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gbnVtYmVyRm9ybWF0IC0gRm9ybWF0XG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIFZhbHVlIHR5cGVcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNFeGNlbCAtIEJvb2xlYW4gcHJvcGVydHlcbiAqIEBwYXJhbSB7c3RyaW5nfSBjdXJyZW5jeUNvZGUgLSBTcGVjaWZpZXMgdGhlIGN1cnJlbmN5IGNvZGUgdG8gYmUgdXNlZCBmb3IgZm9ybWF0dGluZy5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgZm9ybWF0ZWQgdmFsdWVcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE51bWJlckZvcm1hdChudW1iZXJGb3JtYXQsIHR5cGUsIGlzRXhjZWwsIGN1cnJlbmN5Q29kZSkge1xuICAgIHZhciBmb3JtYXQ7XG4gICAgdmFyIGludGwgPSBuZXcgSW50ZXJuYXRpb25hbGl6YXRpb24oKTtcbiAgICBpZiAodHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvcm1hdCA9IGludGwuZ2V0TnVtYmVyUGF0dGVybih7IGZvcm1hdDogbnVtYmVyRm9ybWF0LCBjdXJyZW5jeTogY3VycmVuY3lDb2RlLCB1c2VHcm91cGluZzogdHJ1ZSB9LCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGZvcm1hdCA9IG51bWJlckZvcm1hdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlID09PSAnZGF0ZScgfHwgdHlwZSA9PT0gJ3RpbWUnIHx8IHR5cGUgPT09ICdkYXRldGltZScpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvcm1hdCA9IGludGwuZ2V0RGF0ZVBhdHRlcm4oeyBza2VsZXRvbjogbnVtYmVyRm9ybWF0LCB0eXBlOiB0eXBlIH0sIGlzRXhjZWwpO1xuICAgICAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGZvcm1hdCkpIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgICAgICAgICB0aHJvdyAnZXJyb3InO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmb3JtYXQgPSBpbnRsLmdldERhdGVQYXR0ZXJuKHsgZm9ybWF0OiBudW1iZXJGb3JtYXQsIHR5cGU6IHR5cGUgfSwgaXNFeGNlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBmb3JtYXQgPSBudW1iZXJGb3JtYXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZvcm1hdCA9IG51bWJlckZvcm1hdDtcbiAgICB9XG4gICAgaWYgKHR5cGUgIT09ICdudW1iZXInKSB7XG4gICAgICAgIHZhciBwYXR0ZXJuUmVnZXggPSAvR3xIfGN8J3wgYXx5eXx5fEVFRUV8RS9nO1xuICAgICAgICB2YXIgbXRjaF8xID0geyAnRyc6ICcnLCAnSCc6ICdoJywgJ2MnOiAnZCcsICdcXCcnOiAnXCInLCAnIGEnOiAnIEFNL1BNJywgJ3l5JzogJ3l5JywgJ3knOiAneXl5eScsICdFRUVFJzogJ2RkZGQnLCAnRSc6ICdkZGQnIH07XG4gICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKHBhdHRlcm5SZWdleCwgZnVuY3Rpb24gKHBhdHRlcm4pIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICByZXR1cm4gbXRjaF8xW1wiXCIgKyBwYXR0ZXJuXTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBmb3JtYXQ7XG59XG4vKipcbiAqIEBwYXJhbSB7SUdyaWR9IGdPYmogLSBHcmlkIGluc3RhbmNlXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEJpZ2dlckRpYWxvZyhnT2JqKSB7XG4gICAgaWYgKGdPYmouZW5hYmxlQWRhcHRpdmVVSSkge1xuICAgICAgICB2YXIgZGlhbG9ncyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2UtcmVzcG9uc2l2ZS1kaWFsb2cnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkaWFsb2dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBkaWFsb2dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuYWRkKCdlLWJpZ2dlcicpO1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBzcGVjaWZpZXMgdGhlIHRyclxuICogQHBhcmFtIHtPYmplY3R9IG1hcE9iamVjdCAtIHNwZWNpZmllcyB0aGUgaWR4XG4gKiBAcmV0dXJucyB7T2JqZWN0IHwgc3RyaW5nfSByZXR1cm5zIG9iamVjdCBvciBzdHJpbmdcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBlcmZvcm1Db21wbGV4RGF0YU9wZXJhdGlvbih2YWx1ZSwgbWFwT2JqZWN0KSB7XG4gICAgdmFyIHJldHVybk9iajtcbiAgICB2YXIgbGVuZ3RoID0gdmFsdWUuc3BsaXQoJy4nKS5sZW5ndGg7XG4gICAgdmFyIHNwbGl0cyA9IHZhbHVlLnNwbGl0KCcuJyk7XG4gICAgdmFyIGR1cGxpY2F0ZU1hcCA9IG1hcE9iamVjdDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHJldHVybk9iaiA9IGR1cGxpY2F0ZU1hcFtzcGxpdHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXTtcbiAgICAgICAgZHVwbGljYXRlTWFwID0gcmV0dXJuT2JqO1xuICAgIH1cbiAgICByZXR1cm4gcmV0dXJuT2JqO1xufVxuLyoqXG4gKiBAcGFyYW0ge09iamVjdH0gdHIgLSBzcGVjaWZpZXMgdGhlIHRyclxuICogQHBhcmFtIHtudW1iZXJ9IGlkeCAtIHNwZWNpZmllcyB0aGUgaWR4XG4gKiBAcGFyYW0ge3N0cmluZ30gZGlzcGxheVZhbCAtIHNwZWNpZmllcyB0aGUgZGlzcGxheXZhbFxuICogQHBhcmFtIHtSb3c8Q29sdW1uPn0gcm93cyAtIHNwZWNpZmllcyB0aGUgcm93c1xuICogQHBhcmFtIHtJR3JpZH0gcGFyZW50IC0gR3JpZCBpbnN0YW5jZVxuICogQHBhcmFtIHtib29sZWFufSBpc0NvbnRlbnQgLSBjaGVjayBmb3IgY29udGVudCByZW5kZXJlclxuICogQHJldHVybnMge3ZvaWR9XG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXREaXNwbGF5VmFsdWUodHIsIGlkeCwgZGlzcGxheVZhbCwgcm93cywgcGFyZW50LCBpc0NvbnRlbnQpIHtcbiAgICB2YXIgdHJzID0gT2JqZWN0LmtleXModHIpO1xuICAgIHZhciBhY3R1YWxJbmRleCA9IGlkeDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgdGQgPSB0clt0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXS5xdWVyeVNlbGVjdG9yQWxsKCd0ZC5lLXJvd2NlbGwnKVtwYXJzZUludChpZHgudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgaWYgKHBhcmVudCAmJiAhcGFyZW50LmlzRnJvemVuR3JpZCgpICYmICFwYXJlbnQuaXNSb3dEcmFnYWJsZSgpKSB7XG4gICAgICAgICAgICB0ZCA9ICghaXNOdWxsT3JVbmRlZmluZWQodGQpICYmIChwYXJzZUludCh0ZC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29saW5kZXgnKSwgMTApIC0gMSA9PT0gaWR4IHx8XG4gICAgICAgICAgICAgICAgKHBhcmVudHNVbnRpbCh0ZCwgJ2UtYWRkZWRyb3cnKSAmJiB0ZC5wYXJlbnRFbGVtZW50LmNoaWxkTm9kZXNbcGFyc2VJbnQoaWR4LnRvU3RyaW5nKCksIDEwKV0gPT09IHRkKSkpXG4gICAgICAgICAgICAgICAgPyB0ZCA6IHRyW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5xdWVyeVNlbGVjdG9yKFwidGRbYXJpYS1jb2xpbmRleD1cXFwiXCIgKyAoaWR4ICsgMSkgKyBcIlxcXCJdXCIpO1xuICAgICAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHRkKSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWR4ID0gKHBhcmVudC5nZXRDb250ZW50VGFibGUoKS5xdWVyeVNlbGVjdG9yKCcuZS1kZXRhaWxyb3djb2xsYXBzZSwgLmUtZGV0YWlscm93ZXhwYW5kJykpID9cbiAgICAgICAgICAgICAgICAgICAgKHRkLmNlbGxJbmRleCAtIDEpIDogdGQuY2VsbEluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0clt0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXS5xdWVyeVNlbGVjdG9yQWxsKCd0ZC5lLXJvd2NlbGwnKS5sZW5ndGggJiYgdGQpIHtcbiAgICAgICAgICAgIHNldFN0eWxlQXR0cmlidXRlKHRyW3Ryc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkLmUtcm93Y2VsbCcpW3BhcnNlSW50KGlkeC50b1N0cmluZygpLCAxMCldLCB7ICdkaXNwbGF5JzogZGlzcGxheVZhbCB9KTtcbiAgICAgICAgICAgIGlmICh0clt0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXS5xdWVyeVNlbGVjdG9yQWxsKCd0ZC5lLXJvd2NlbGwnKVtwYXJzZUludChpZHgudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaGlkZScpKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoW3RyW3Ryc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkLmUtcm93Y2VsbCcpW3BhcnNlSW50KGlkeC50b1N0cmluZygpLCAxMCldXSwgWydlLWhpZGUnXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGlzQ29udGVudCAmJiBwYXJlbnQuaXNSb3dEcmFnYWJsZSgpKSB8fCAocGFyZW50ICYmIHBhcmVudC5pc0RldGFpbCgpKSkge1xuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGlkeCArIDE7XG4gICAgICAgICAgICAgICAgcm93c1t0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXS5jZWxsc1twYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldLnZpc2libGUgPSBkaXNwbGF5VmFsID09PSAnJyA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQocm93c1t0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93c1t0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXS5jZWxsc1twYXJzZUludChpZHgudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlID0gZGlzcGxheVZhbCA9PT0gJycgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyb3dzW3Ryc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dLmNlbGxzW3BhcnNlSW50KGlkeC50b1N0cmluZygpLCAxMCldLnZpc2libGUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0clt0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXS5xdWVyeVNlbGVjdG9yQWxsKCd0ZC5lLXJvd2NlbGwnKVtwYXJzZUludChpZHgudG9TdHJpbmcoKSwgMTApXS5jbGFzc0xpc3QuYWRkKCdlLWhpZGUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCA9IGFjdHVhbEluZGV4O1xuICAgICAgICB9XG4gICAgfVxufVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4vKiogQGhpZGRlbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFJlbW92ZUV2ZW50TGlzdGVuZXIocGFyZW50LCBldnQsIGlzT24sIG1vZHVsZSkge1xuICAgIGZvciAodmFyIF9pID0gMCwgZXZ0XzEgPSBldnQ7IF9pIDwgZXZ0XzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBpbnN0ID0gZXZ0XzFbX2ldO1xuICAgICAgICBpZiAoaXNPbikge1xuICAgICAgICAgICAgcGFyZW50Lm9uKGluc3QuZXZlbnQsIGluc3QuaGFuZGxlciwgbW9kdWxlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHBhcmVudC5vZmYoaW5zdC5ldmVudCwgaW5zdC5oYW5kbGVyKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuLyoqIEBoaWRkZW4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFZGl0RWxlbWVudChwYXJlbnQsIGNvbHVtbiwgY2xhc3NOYW1lcywgYXR0cikge1xuICAgIHZhciBjb21wbGV4RmllbGROYW1lID0gZ2V0Q29tcGxleEZpZWxkSUQoY29sdW1uLmZpZWxkKTtcbiAgICBhdHRyID0gT2JqZWN0LmFzc2lnbihhdHRyLCB7XG4gICAgICAgIGlkOiBwYXJlbnQuZWxlbWVudC5pZCArIGNvbXBsZXhGaWVsZE5hbWUsXG4gICAgICAgIG5hbWU6IGNvbXBsZXhGaWVsZE5hbWUsICdlLW1hcHBpbmd1aWQnOiBjb2x1bW4udWlkXG4gICAgfSk7XG4gICAgcmV0dXJuIHBhcmVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBjbGFzc05hbWVzLCBhdHRyczogYXR0clxuICAgIH0pO1xufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkfSBnT2JqIC0gR3JpZCBpbnN0YW5jZVxuICogQHBhcmFtIHtzdHJpbmd9IHVpZCAtIERlZmluZXMgY29sdW1uJ3MgdWlkXG4gKiBAcmV0dXJucyB7Q29sdW1ufSByZXR1cm5zIGNvbHVtbiBtb2RlbFxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29sdW1uTW9kZWxCeVVpZChnT2JqLCB1aWQpIHtcbiAgICB2YXIgY29sdW1uO1xuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSAoZ09iai5jb2x1bW5Nb2RlbCk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBjb2wgPSBfYVtfaV07XG4gICAgICAgIGlmIChjb2wudWlkID09PSB1aWQpIHtcbiAgICAgICAgICAgIGNvbHVtbiA9IGNvbDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb2x1bW47XG59XG4vKipcbiAqIEBwYXJhbSB7SUdyaWR9IGdPYmogLSBHcmlkIGluc3RhbmNlXG4gKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSBEZWZpbmVzIGNvbHVtbidzIHVpZFxuICogQHJldHVybnMge0NvbHVtbn0gcmV0dXJucyBjb2x1bW4gbW9kZWxcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbHVtbk1vZGVsQnlGaWVsZE5hbWUoZ09iaiwgZmllbGQpIHtcbiAgICB2YXIgY29sdW1uO1xuICAgIGlmICghZ09iai5jb2x1bW5Nb2RlbCkge1xuICAgICAgICBnT2JqLmdldENvbHVtbnMoKTtcbiAgICB9XG4gICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IChnT2JqLmNvbHVtbk1vZGVsKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGNvbCA9IF9hW19pXTtcbiAgICAgICAgaWYgKGNvbC5maWVsZCA9PT0gZmllbGQpIHtcbiAgICAgICAgICAgIGNvbHVtbiA9IGNvbDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb2x1bW47XG59XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCAtIERlZmluZXMgY29tcG9uZW50IGlkXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBldnRzIC0gRGVmaW5lcyBldmVudHNcbiAqIEBwYXJhbSB7b2JqZWN0fSBoYW5kbGVycyAtIERlZmluZXMgZXZlbnQgaGFuZGxlcnNcbiAqIEBwYXJhbSB7YW55fSBpbnN0YW5jZSAtIERlZmluZXMgY2xhc3MgaW5zdGFuY2VcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckV2ZW50SGFuZGxlcnMoaWQsIGV2dHMsIGhhbmRsZXJzLCBpbnN0YW5jZSkge1xuICAgIGluc3RhbmNlLmV2ZW50SGFuZGxlcnNbXCJcIiArIGlkXSA9IHt9O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXZ0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpbnN0YW5jZS5ldmVudEhhbmRsZXJzW1wiXCIgKyBpZF1bZXZ0c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dID0gaGFuZGxlcnNbZXZ0c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dO1xuICAgIH1cbn1cbi8qKlxuICogQHBhcmFtIHthbnl9IGNvbXBvbmVudCAtIERlZmluZXMgY29tcG9uZW50IGluc3RhbmNlXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBldnRzIC0gRGVmaW5lcyBldmVudHNcbiAqIEBwYXJhbSB7YW55fSBpbnN0YW5jZSAtIERlZmluZXMgY2xhc3MgaW5zdGFuY2VcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVFdmVudEhhbmRsZXJzKGNvbXBvbmVudCwgZXZ0cywgaW5zdGFuY2UpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2dHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGNvbXBvbmVudC5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY29tcG9uZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZ0c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGluc3RhbmNlLmV2ZW50SGFuZGxlcnNbY29tcG9uZW50LmVsZW1lbnQuaWRdW2V2dHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSk7XG4gICAgfVxufVxuLyoqXG4gKiBAcGFyYW0ge0lHcmlkIHwgSVhMRmlsdGVyfSBwYXJlbnQgLSBEZWZpbmVzIHBhcmVudCBpbnN0YW5jZVxuICogQHBhcmFtIHtzdHJpbmdbXX0gdGVtcGxhdGVzIC0gRGVmaW5lcyB0aGUgdGVtcGxhdGVzIG5hbWUgd2hpY2ggYXJlIG5lZWRzIHRvIGNsZWFyXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyUmVhY3RWdWVUZW1wbGF0ZXMocGFyZW50LCB0ZW1wbGF0ZXMpIHtcbiAgICBwYXJlbnQuZGVzdHJveVRlbXBsYXRlKHRlbXBsYXRlcyk7XG4gICAgaWYgKHBhcmVudC5pc1JlYWN0KSB7XG4gICAgICAgIHBhcmVudC5yZW5kZXJUZW1wbGF0ZXMoKTtcbiAgICB9XG59XG4vKipcbiAqXG4gKiBAcGFyYW0geyBIVE1MRWxlbWVudFtdIH0gcmVtb3ZlRWxlbSAtIERlZmluZXMgY2hlY2tib3ggd3JhcHBlciBlbGVtZW50XG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluZmluaXRlUmVtb3ZlRWxlbWVudHMocmVtb3ZlRWxlbSkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3ZlRWxlbS5sZW5ndGg7IGkrKykge1xuICAgICAgICByZW1vdmUocmVtb3ZlRWxlbVtpXSk7XG4gICAgfVxufVxuLyoqXG4gKlxuICogQHBhcmFtIHsgSFRNTEVsZW1lbnRbXSB9IGFwcGVuZEVsZW0gLSBEZWZpbmVzIGNoZWNrYm94IHdyYXBwZXIgZWxlbWVudFxuICogQHBhcmFtIHsgSFRNTEVsZW1lbnQgfSB1bEVsZW1lbnQgLSBEZWZpbmVzIHVsIGVsZW1lbnRcbiAqIEByZXR1cm5zIHt2b2lkfVxuICogQGhpZGRlblxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5maW5pdGVBcHBlbmRFbGVtZW50cyhhcHBlbmRFbGVtLCB1bEVsZW1lbnQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFwcGVuZEVsZW0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdWxFbGVtZW50Lmluc2VydEJlZm9yZShhcHBlbmRFbGVtW2ldLCB1bEVsZW1lbnQuY2hpbGRyZW5baV0pO1xuICAgIH1cbn1cbi8qKlxuICpcbiAqIEBwYXJhbSB7IEhUTUxFbGVtZW50IH0gZWxlbWVudCAtIERlZmluZXMgY2hlY2tib3ggd3JhcHBlciBlbGVtZW50XG4gKiBAcGFyYW0geyBib29sZWFuIH0gaXNDaG9vc2VyIC0gRGVmaW5lcyBjaGVja2JveCBmaWx0ZXIgY29sdW1uIGNob29zZXJcbiAqIEByZXR1cm5zIHsgbnVtYmVyIH0gbGlzdCBoZWlnaHQgdmFsdWVcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RIZWlnaHQoZWxlbWVudCwgaXNDaG9vc2VyKSB7XG4gICAgdmFyIGxpc3REaXYgPSBpc0Nob29zZXIgPyBjcmVhdGVFbGVtZW50KCdsaScsIHsgY2xhc3NOYW1lOiAnZS1jY2xpc3QnIH0pXG4gICAgICAgIDogY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLWZ0cmNoaycgfSk7XG4gICAgbGlzdERpdi5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgaWYgKGlzQ2hvb3Nlcikge1xuICAgICAgICBsaXN0RGl2LnN0eWxlLmxpc3RTdHlsZSA9ICdub25lJztcbiAgICB9XG4gICAgbGlzdERpdi5pbm5lckhUTUwgPSBpc0Nob29zZXIgPyAnPGRpdiBjbGFzcz1cImUtY2NoZWNrXCI+PGRpdiBjbGFzcz1cImUtY2hlY2tib3gtd3JhcHBlclwiPjxzcGFuIGNsYXNzPVwiZS1mcmFtZSBlLWljb25zIGUtY2hlY2tcIj48L3NwYW4+PHNwYW4gY2xhc3M9XCJlLWxhYmVsXCI+QTwvc3Bhbj48L2Rpdj48L2Rpdj4nIDpcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJlLWNoZWNrYm94LXdyYXBwZXJcIj48c3BhbiBjbGFzcz1cImUtZnJhbWUgZS1pY29ucyBlLWNoZWNrXCI+PC9zcGFuPjxzcGFuIGNsYXNzPVwiZS1sYWJlbCBlLWNoZWNrYm94ZmlsdGVydGV4dFwiPkE8L2Rpdj48L3NwYW4+JztcbiAgICBlbGVtZW50LmFwcGVuZENoaWxkKGxpc3REaXYpO1xuICAgIHZhciByZWN0ID0gbGlzdERpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBlbGVtZW50LnJlbW92ZUNoaWxkKGxpc3REaXYpO1xuICAgIHZhciBsaXN0SGVpZ2h0ID0gTWF0aC5yb3VuZChyZWN0LmhlaWdodCk7XG4gICAgcmV0dXJuIGxpc3RIZWlnaHQ7XG59XG4vKipcbiAqXG4gKiBAcGFyYW0geyBFbGVtZW50IH0gcm93IC0gRGVmaW5lcyByb3cgZWxlbWVudFxuICogQHJldHVybnMgeyBudW1iZXIgfSByb3cgaW5kZXhcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJvd0luZGV4RnJvbUVsZW1lbnQocm93KSB7XG4gICAgcmV0dXJuIHBhcnNlSW50KHJvdy5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSwgMTApIC0gMTtcbn1cbi8qKlxuICpcbiAqIEBwYXJhbSB7IElHcmlkIH0gZ3JpZCAtIERlZmluZXMgZ3JpZCBpbnN0YW5jZVxuICogQHJldHVybnMgeyBJR3JpZCB9IHJldHVybnMgcGFyZW50IGdyaWQgaW5zdGFuY2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBhcmVudElucyhncmlkKSB7XG4gICAgcmV0dXJuIGdyaWQucGFyZW50RGV0YWlscyAmJiBncmlkLnBhcmVudERldGFpbHMucGFyZW50SW5zdE9iaiA/XG4gICAgICAgIGdldFBhcmVudElucyhncmlkLnBhcmVudERldGFpbHMucGFyZW50SW5zdE9iaikgOiBncmlkO1xufVxuLyoqXG4gKlxuICogQHBhcmFtIHsgc3RyaW5nW10gfSBmaWVsZHMgLSBEZWZpbmVzIGdyb3VwZWQgZmllbGRzXG4gKiBAcGFyYW0geyB2YWx1ZXMgfSB2YWx1ZXMgLSBEZWZpbmVzIGNhcHRpb24ga2V5c1xuICogQHBhcmFtIHsgYW55IH0gaW5zdGFuY2UgLSBEZWZpbmVzIGR5bmFtaWMgY2xhc3MgaW5zdGFuY2VcbiAqIEByZXR1cm5zIHsgUHJlZGljYXRlIH0gcmV0dXJucyBmaWx0ZXIgcHJlZGljYXRlXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlRXhwYW5kUHJlZGljYXRlcyhmaWVsZHMsIHZhbHVlcywgaW5zdGFuY2UpIHtcbiAgICB2YXIgZmlsdGVyQ29scyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjb2x1bW4gPSBpbnN0YW5jZS5wYXJlbnQuZ2V0Q29sdW1uQnlGaWVsZChmaWVsZHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgdmFyIHZhbHVlID0gdmFsdWVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9PT0gJ251bGwnID8gbnVsbCA6IHZhbHVlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgIHZhciBwcmVkID0ge1xuICAgICAgICAgICAgZmllbGQ6IGZpZWxkc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHByZWRpY2F0ZTogJ29yJywgdWlkOiBjb2x1bW4udWlkLCBvcGVyYXRvcjogJ2VxdWFsJywgdHlwZTogY29sdW1uLnR5cGUsXG4gICAgICAgICAgICBtYXRjaENhc2U6IGluc3RhbmNlLmFsbG93Q2FzZVNlbnNpdGl2ZSwgaWdub3JlQWNjZW50OiBpbnN0YW5jZS5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaWdub3JlQWNjZW50XG4gICAgICAgIH07XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gJycgfHwgaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICAgICAgICBmaWx0ZXJDb2xzID0gZmlsdGVyQ29scy5jb25jYXQoQ2hlY2tCb3hGaWx0ZXJCYXNlLmdlbmVyYXRlTnVsbFZhbHVlUHJlZGljYXRlcyhwcmVkKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmaWx0ZXJDb2xzLnB1c2goZXh0ZW5kKHt9LCB7IHZhbHVlOiB2YWx1ZSB9LCBwcmVkKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIENoZWNrQm94RmlsdGVyQmFzZS5nZXRQcmVkaWNhdGUoZmlsdGVyQ29scyk7XG59XG4vKipcbiAqXG4gKiBAcGFyYW0geyBQcmVkaWNhdGUgfSBwcmVkIC0gRGVmaW5lcyBmaWx0ZXIgcHJlZGljYXRlXG4gKiBAcmV0dXJucyB7IFByZWRpY2F0ZVtdIH0gUmV0dXJucyBmb3JtZWQgcHJlZGljYXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcmVkaWNhdGVzKHByZWQpIHtcbiAgICB2YXIgcHJlZGljYXRlTGlzdCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBPYmplY3Qua2V5cyhwcmVkKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHByb3AgPSBfYVtfaV07XG4gICAgICAgIHByZWRpY2F0ZUxpc3QucHVzaChwcmVkW1wiXCIgKyBwcm9wXSk7XG4gICAgfVxuICAgIHJldHVybiBwcmVkaWNhdGVMaXN0O1xufVxuLyoqXG4gKlxuICogQHBhcmFtIHsgbnVtYmVyIH0gaW5kZXggLSBEZWZpbmVzIGdyb3VwIGNhcHRpb24gaW5kZW50XG4gKiBAcGFyYW0geyBSb3c8Q29sdW1uPltdIH0gcm93c09iamVjdCAtIERlZmluZXMgcm93cyBvYmplY3RcbiAqIEByZXR1cm5zIHsgeyBmaWVsZHM6IHN0cmluZ1tdLCBrZXlzOiBzdHJpbmdbXSB9IH0gUmV0dXJucyBncm91cGVkIGtleXMgYW5kIHZhbHVlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0R3JvdXBLZXlzQW5kRmllbGRzKGluZGV4LCByb3dzT2JqZWN0KSB7XG4gICAgdmFyIGZpZWxkcyA9IFtdO1xuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIgaSA9IGluZGV4OyBpID49IDA7IGktLSkge1xuICAgICAgICBpZiAocm93c09iamVjdFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNDYXB0aW9uUm93XG4gICAgICAgICAgICAmJiBmaWVsZHMuaW5kZXhPZihyb3dzT2JqZWN0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5kYXRhLmZpZWxkKSA9PT0gLTFcbiAgICAgICAgICAgICYmIChyb3dzT2JqZWN0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRlbnQgPCByb3dzT2JqZWN0W3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0uaW5kZW50IHx8IGkgPT09IGluZGV4KSkge1xuICAgICAgICAgICAgZmllbGRzLnB1c2gocm93c09iamVjdFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZGF0YS5maWVsZCk7XG4gICAgICAgICAgICBrZXlzLnB1c2gocm93c09iamVjdFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZGF0YS5rZXkpO1xuICAgICAgICAgICAgaWYgKHJvd3NPYmplY3RbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmluZGVudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7IGZpZWxkczogZmllbGRzLCBrZXlzOiBrZXlzIH07XG59XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbi8qKlxuICpcbiAqIEBwYXJhbSB7IG51bWJlcltdW10gfSBjaGVja0FjdGl2ZU1hdHJpeCAtIERlZmluZXMgbWF0cml4IHRvIGNoZWNrXG4gKiBAcGFyYW0geyBudW1iZXJbXSB9IGNoZWNrQ2VsbEluZGV4IC0gRGVmaW5lcyBpbmRleCB0byBjaGVja1xuICogQHBhcmFtIHsgYm9vbGVhbiB9IG5leHQgLSBEZWZpbmVzIHNlbGVjdCBuZXh0IG9yIHByZXZpb3VzIGluZGV4XG4gKiBAcmV0dXJucyB7IG51bWJlcltdIH0gLSBSZXR1cm5zIG5leHQgYWN0aXZlIGN1cnJlbnQgaW5kZXhcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRDZWxsSW5kZXgoY2hlY2tBY3RpdmVNYXRyaXgsIGNoZWNrQ2VsbEluZGV4LCBuZXh0KSB7XG4gICAgdmFyIGFjdGl2ZU1hdHJpeCA9IGNoZWNrQWN0aXZlTWF0cml4O1xuICAgIHZhciBjZWxsSW5kZXggPSBjaGVja0NlbGxJbmRleDtcbiAgICB2YXIgY3VycmVudENlbGxJbmRleFBhc3MgPSBmYWxzZTtcbiAgICBpZiAobmV4dCkge1xuICAgICAgICBmb3IgKHZhciBpID0gY2VsbEluZGV4WzBdOyBpIDwgYWN0aXZlTWF0cml4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcm93Q2VsbCA9IGFjdGl2ZU1hdHJpeFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJvd0NlbGwubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENlbGxJbmRleFBhc3MgJiYgYWN0aXZlTWF0cml4W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0gPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY2VsbEluZGV4ID0gW2ksIGpdO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2VsbEluZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRDZWxsSW5kZXhQYXNzICYmIGNlbGxJbmRleC50b1N0cmluZygpID09PSBbaSwgal0udG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2VsbEluZGV4UGFzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmb3IgKHZhciBpID0gY2VsbEluZGV4WzBdOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIHJvd0NlbGwgPSBhY3RpdmVNYXRyaXhbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IHJvd0NlbGwubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENlbGxJbmRleFBhc3MgJiYgYWN0aXZlTWF0cml4W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0gPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY2VsbEluZGV4ID0gW2ksIGpdO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2VsbEluZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRDZWxsSW5kZXhQYXNzICYmIGNlbGxJbmRleC50b1N0cmluZygpID09PSBbaSwgal0udG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2VsbEluZGV4UGFzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjZWxsSW5kZXg7XG59XG4vKipcbiAqXG4gKiBAcGFyYW0geyBzdHJpbmcgfSBzdHJpbmcgLSBEZWZpbmVzIHN0cmluZyBuZWVkIHRvIGNhcGl0YWxpemVkIGZpcnN0IGxldHRlclxuICogQHJldHVybnMgeyBzdHJpbmcgfSAtIFJldHVybnMgY2FwaXRhbGl6ZWQgZmlyc3QgbGV0dGVyIHN0cmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKHN0cmluZykge1xuICAgIHJldHVybiBzdHJpbmcuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHJpbmcuc2xpY2UoMSk7XG59XG4vKipcbiAqXG4gKiBAcGFyYW0geyBJR3JpZCB9IGdyaWQgLSBEZWZpbmVzIHBhcmVudCBpbnN0YW5jZVxuICogQHJldHVybnMgeyBib29sZWFuIH0gLSBSZXR1cm5zIGlzIHZpcnR1YWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrSXNWaXJ0dWFsKGdyaWQpIHtcbiAgICByZXR1cm4gIShpc0dyb3VwQWRhcHRpdmUoZ3JpZCkgfHwgZ3JpZC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nXG4gICAgICAgIHx8ICghZ3JpZC5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiBncmlkLmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSk7XG59XG4vKipcbiAqXG4gKiBAcGFyYW0geyBudW1iZXJbXSB9IGJsb2NrZXMgLSBEZWZpbmVzIGJsb2NrIGluZGV4ZXNcbiAqIEByZXR1cm5zIHsgbnVtYmVyW10gfSAtIFJldHVybnMgaXMgdmlzaWJsZSBwYWdlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRWaXNpYmxlUGFnZShibG9ja2VzKSB7XG4gICAgdmFyIHZpc2libGVQYWdlID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBibG9ja2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBwYWdlID0gTWF0aC5jZWlsKGJsb2NrZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldIC8gMik7XG4gICAgICAgIGlmICh2aXNpYmxlUGFnZS5pbmRleE9mKHBhZ2UpID09PSAtMSkge1xuICAgICAgICAgICAgdmlzaWJsZVBhZ2UucHVzaChwYWdlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmlzaWJsZVBhZ2U7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/common/checkbox-filter-base.js":
/*!*************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/common/checkbox-filter-base.js ***!
  \*************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CheckBoxFilterBase: () => (/* binding */ CheckBoxFilterBase)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/query.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/manager.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/util.js\");\n/* harmony import */ var _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @syncfusion/ej2-buttons */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-buttons@29.1.34/node_modules/@syncfusion/ej2-buttons/src/common/common.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _services_value_formatter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../services/value-formatter */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/value-formatter.js\");\n/* harmony import */ var _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @syncfusion/ej2-popups */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-popups@29.1.37/node_modules/@syncfusion/ej2-popups/src/dialog/dialog.js\");\n/* harmony import */ var _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @syncfusion/ej2-inputs */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-inputs@29.1.39/node_modules/@syncfusion/ej2-inputs/src/input/input.js\");\n/* harmony import */ var _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @syncfusion/ej2-popups */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-popups@29.1.37/node_modules/@syncfusion/ej2-popups/src/spinner/spinner.js\");\n/* tslint:disable-next-line:max-line-length */\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * @hidden\n * `CheckBoxFilterBase` module is used to handle filtering action.\n */\nvar CheckBoxFilterBase = /** @class */ (function () {\n    /**\n     * Constructor for checkbox filtering module\n     *\n     * @param {IXLFilter} parent - specifies the IXLFilter\n     * @hidden\n     */\n    function CheckBoxFilterBase(parent) {\n        this.searchInputArgs = null;\n        this.isExecuteLocal = false;\n        this.queryFilteredColumn = [];\n        this.existingPredicate = {};\n        this.foreignKeyQuery = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query();\n        /** @hidden */\n        this.filterState = true;\n        this.values = {};\n        this.renderEmpty = false;\n        this.isCheckboxFilterTemplate = false;\n        this.infiniteRenderMod = false;\n        // for infinite scroll ui\n        this.infiniteInitialLoad = false;\n        this.infiniteSearchValChange = false;\n        this.infinitePermenantLocalData = [];\n        this.infiniteQueryExecutionPending = false;\n        this.infiniteSkipCnt = 0;\n        this.infiniteScrollAppendDiff = 0;\n        this.prevInfiniteScrollDirection = '';\n        this.infiniteLoadedElem = [];\n        this.infiniteDataCount = 0;\n        this.infiniteLocalSelectAll = true;\n        this.localInfiniteSelectAllClicked = false;\n        this.localInfiniteSelectionInteracted = false;\n        this.infiniteManualSelectMaintainPred = [];\n        this.parent = parent;\n        this.id = this.parent.element.id;\n        this.valueFormatter = new _services_value_formatter__WEBPACK_IMPORTED_MODULE_2__.ValueFormatter(this.parent.locale);\n        this.cBoxTrue = (0,_syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_3__.createCheckBox)(this.parent.createElement, false, { checked: true, label: ' ' });\n        this.cBoxFalse = (0,_syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_3__.createCheckBox)(this.parent.createElement, false, { checked: false, label: ' ' });\n        this.cBoxTrue.insertBefore(this.parent.createElement('input', {\n            className: 'e-chk-hidden', attrs: { type: 'checkbox' }\n        }), this.cBoxTrue.firstChild);\n        this.cBoxFalse.insertBefore(this.parent.createElement('input', {\n            className: 'e-chk-hidden', attrs: { 'type': 'checkbox' }\n        }), this.cBoxFalse.firstChild);\n        this.cBoxFalse.querySelector('.e-frame').classList.add('e-uncheck');\n        if (this.parent.enableRtl) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.cBoxTrue, this.cBoxFalse], ['e-rtl']);\n        }\n        if (this.parent.cssClass) {\n            if (this.parent.cssClass.indexOf(' ') !== -1) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.cBoxTrue, this.cBoxFalse], this.parent.cssClass.split(' '));\n            }\n            else {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.cBoxTrue, this.cBoxFalse], [this.parent.cssClass]);\n            }\n        }\n    }\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    CheckBoxFilterBase.prototype.destroy = function () {\n        this.closeDialog();\n    };\n    CheckBoxFilterBase.prototype.wireEvents = function () {\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.dlg, 'click', this.clickHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.dlg, 'keyup', this.keyupHandler, this);\n        this.searchHandler = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.debounce)(this.searchBoxKeyUp, 200);\n        var elem = this.dialogObj.element.querySelector('.e-searchinput');\n        if (elem) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(elem, 'keyup', this.searchHandler, this);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(elem, 'input', this.searchHandler, this);\n        }\n    };\n    CheckBoxFilterBase.prototype.unWireEvents = function () {\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.dlg, 'click', this.clickHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.dlg, 'keyup', this.keyupHandler);\n        var elem = this.dialogObj.element.querySelector('.e-searchinput');\n        if (elem) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(elem, 'keyup', this.searchHandler);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(elem, 'input', this.searchHandler);\n        }\n    };\n    CheckBoxFilterBase.prototype.foreignKeyFilter = function (args, fColl, mPredicate) {\n        var _this = this;\n        var fPredicate = {};\n        var filterCollection = [];\n        var query = this.foreignKeyQuery.clone();\n        this.options.column.dataSource.\n            executeQuery(query.where(mPredicate)).then(function (e) {\n            _this.options.column.columnData = e.result;\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.generateQuery, { predicate: fPredicate, column: _this.options.column });\n            args.ejpredicate = fPredicate.predicate.predicates;\n            var fpred = fPredicate.predicate.predicates;\n            for (var i = 0; i < fpred.length; i++) {\n                filterCollection.push({\n                    field: fpred[parseInt(i.toString(), 10)].field,\n                    predicate: 'or',\n                    matchCase: fpred[parseInt(i.toString(), 10)].ignoreCase,\n                    ignoreAccent: fpred[parseInt(i.toString(), 10)].ignoreAccent,\n                    operator: fpred[parseInt(i.toString(), 10)].operator,\n                    value: fpred[parseInt(i.toString(), 10)].value,\n                    type: _this.options.type\n                });\n            }\n            args.filterCollection = filterCollection.length ? filterCollection :\n                fColl.filter(function (col) { return col.field = _this.options.field; });\n            _this.options.handler(args);\n        });\n    };\n    CheckBoxFilterBase.prototype.searchBoxClick = function (e) {\n        var target = e.target;\n        if (target.classList.contains('e-searchclear')) {\n            this.sInput.value = target.classList.contains('e-chkcancel-icon') ? '' : this.sInput.value;\n            if (this.isCheckboxFilterTemplate) {\n                this.parent.notify('refreshCheckbox', { event: e });\n            }\n            else {\n                this.refreshCheckboxes();\n            }\n            this.updateSearchIcon();\n            this.sInput.focus();\n        }\n    };\n    CheckBoxFilterBase.prototype.searchBoxKeyUp = function (e) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.sInput)) {\n            return;\n        }\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e) || (e.key !== 'ArrowUp' && e.key !== 'ArrowDown' && e.key !== 'Tab' && !(e.key === 'Tab' && e.shiftKey))) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.loadingIndicator) && this.parent.loadingIndicator.indicatorType === 'Shimmer') {\n                this.parent.showMaskRow(undefined, this.dialogObj.element);\n            }\n            if (this.isCheckboxFilterTemplate) {\n                this.parent.notify('refreshCheckbox', { event: e });\n            }\n            else {\n                this.refreshCheckboxes();\n            }\n            this.updateSearchIcon();\n        }\n    };\n    CheckBoxFilterBase.prototype.updateSearchIcon = function () {\n        if (this.sInput.value.length) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.sIcon, ['e-chkcancel-icon'], ['e-search-icon']);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(document.body.querySelector('.e-chkcancel-icon'))) {\n                document.body.querySelector('.e-chkcancel-icon').setAttribute('title', this.localeObj.getConstant('Clear'));\n            }\n        }\n        else {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.sIcon, ['e-search-icon'], ['e-chkcancel-icon']);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(document.body.querySelector('.e-searchclear.e-search-icon'))) {\n                document.body.querySelector('.e-searchclear.e-search-icon').setAttribute('title', this.localeObj.getConstant('Search'));\n            }\n        }\n    };\n    /**\n     * Gets the localized label by locale keyword.\n     *\n     * @param {string} key - Defines localization key\n     * @returns {string} - returns localization label\n     */\n    CheckBoxFilterBase.prototype.getLocalizedLabel = function (key) {\n        return this.localeObj.getConstant(key);\n    };\n    CheckBoxFilterBase.prototype.updateDataSource = function () {\n        var dataSource = this.options.dataSource;\n        var str = 'object';\n        if (!(dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager)) {\n            for (var i = 0; i < dataSource.length; i++) {\n                // eslint-disable-next-line valid-typeof\n                if (typeof dataSource !== str) {\n                    var obj = {};\n                    obj[this.options.field] = dataSource[parseInt(i.toString(), 10)];\n                    dataSource[parseInt(i.toString(), 10)] = obj;\n                }\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.updateModel = function (options) {\n        this.options = options;\n        this.existingPredicate = options.actualPredicate || {};\n        this.options.dataSource = options.dataSource;\n        this.options.dataManager = options.dataManager ? options.dataManager : options.dataSource;\n        this.updateDataSource();\n        this.options.type = options.type;\n        this.options.format = options.format || '';\n        this.options.ignoreAccent = options.ignoreAccent || false;\n        this.options.filteredColumns = options.filteredColumns || this.parent.filterSettings.columns;\n        this.options.query = options.query || new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query();\n        this.options.allowCaseSensitive = options.allowCaseSensitive || false;\n        this.options.uid = options.column.uid;\n        this.options.disableHtmlEncode = options.column.disableHtmlEncode || false;\n        this.values = {};\n        this.localeObj = options.localeObj;\n        this.isFiltered = options.filteredColumns.length;\n        this.infiniteRenderMod = this.parent.filterSettings && this.parent.filterSettings.enableInfiniteScrolling ? true : false;\n        this.infiniteUnloadParentExistPred = this.infiniteRenderMod && this.existingPredicate[this.options.column.field] ? this.existingPredicate[this.options.column.field].slice() : [];\n    };\n    CheckBoxFilterBase.prototype.getAndSetChkElem = function (options) {\n        this.dlg = this.parent.createElement('div', {\n            id: this.id + this.options.type + '_excelDlg',\n            attrs: { uid: this.options.column.uid },\n            className: 'e-checkboxfilter e-filter-popup'\n        });\n        this.sBox = this.parent.createElement('div', { className: 'e-searchcontainer' });\n        if (!options.hideSearchbox) {\n            this.sInput = this.parent.createElement('input', {\n                id: this.id + '_SearchBox',\n                className: 'e-searchinput'\n            });\n            this.sIcon = this.parent.createElement('span', {\n                className: 'e-searchclear e-search-icon e-icons e-input-group-icon', attrs: {\n                    type: 'text', title: this.getLocalizedLabel('Search')\n                }\n            });\n            this.searchBox = this.parent.createElement('span', { className: 'e-searchbox e-fields' });\n            this.searchBox.appendChild(this.sInput);\n            this.sBox.appendChild(this.searchBox);\n            this.searchInputArgs = {\n                element: this.sInput, floatLabelType: 'Never', properties: {\n                    placeholder: this.getLocalizedLabel('Search'),\n                    cssClass: this.parent.cssClass\n                }\n            };\n            _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_6__.Input.createInput(this.searchInputArgs, this.parent.createElement);\n            this.searchBox.querySelector('.e-input-group').appendChild(this.sIcon);\n        }\n        this.spinner = this.parent.createElement('div', { className: 'e-spinner' }); //for spinner\n        this.cBox = this.parent.createElement('div', {\n            id: this.id + this.options.type + '_CheckBoxList',\n            className: 'e-checkboxlist e-fields'\n        });\n        this.spinner.appendChild(this.cBox);\n        this.sBox.appendChild(this.spinner);\n        return this.sBox;\n    };\n    CheckBoxFilterBase.prototype.showDialog = function (options) {\n        var args = {\n            requestType: _base_constant__WEBPACK_IMPORTED_MODULE_4__.filterBeforeOpen,\n            columnName: this.options.field, columnType: this.options.type, cancel: false\n        };\n        var filterModel = 'filterModel';\n        args[\"\" + filterModel] = this;\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.cBoxFltrBegin, args);\n        if (args.cancel) {\n            options.cancel = args.cancel;\n            return;\n        }\n        this.dialogObj = new _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_7__.Dialog({\n            visible: false, content: this.sBox,\n            close: this.closeDialog.bind(this),\n            enableRtl: this.parent.enableRtl,\n            width: (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(options.target, 'e-bigger')))\n                || this.parent.element.classList.contains('e-device') ? 260 : 255,\n            target: this.parent.element, animationSettings: { effect: 'None' },\n            buttons: [{\n                    click: this.btnClick.bind(this),\n                    buttonModel: {\n                        content: this.getLocalizedLabel(this.isExcel ? 'OKButton' : 'FilterButton'),\n                        cssClass: this.parent.cssClass ? 'e-primary' + ' ' + this.parent.cssClass : 'e-primary',\n                        isPrimary: true\n                    }\n                },\n                {\n                    click: this.btnClick.bind(this),\n                    buttonModel: { cssClass: this.parent.cssClass ? 'e-flat' + ' ' + this.parent.cssClass : 'e-flat',\n                        content: this.getLocalizedLabel(this.isExcel ? 'CancelButton' : 'ClearButton') }\n                }],\n            created: this.dialogCreated.bind(this),\n            open: this.dialogOpen.bind(this),\n            cssClass: this.parent.cssClass ? this.parent.cssClass : ''\n        });\n        var isStringTemplate = 'isStringTemplate';\n        this.dialogObj[\"\" + isStringTemplate] = true;\n        this.renderResponsiveFilter(options);\n        var dialogLabel = this.parent.filterSettings && this.parent.filterSettings.type === 'CheckBox' ?\n            this.getLocalizedLabel('CheckBoxFilterDialogARIA') : this.getLocalizedLabel('ExcelFilterDialogARIA');\n        this.dlg.setAttribute('aria-label', dialogLabel);\n        if (options.isResponsiveFilter) {\n            var responsiveCnt = document.querySelector('.e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv');\n            responsiveCnt.appendChild(this.dlg);\n        }\n        else {\n            this.parent.element.appendChild(this.dlg);\n        }\n        this.dialogObj.appendTo(this.dlg);\n        this.dialogObj.element.style.maxHeight = options.isResponsiveFilter ? 'none' : this.options.height + 'px';\n        this.dialogObj.show();\n        if (this.parent && this.parent.filterSettings && (this.parent.filterSettings.type === 'CheckBox'\n            || (this.options.column && this.options.column.filter && this.options.column.filter.type === 'CheckBox')) &&\n            this.parent.getContent().firstElementChild.offsetHeight < this.dialogObj.element.offsetHeight &&\n            !(0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(this.parent.element, 'e-gantt-dialog')) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.resetDialogAppend)(this.parent, this.dialogObj);\n        }\n        var content = this.dialogObj.element.querySelector('.e-dlg-content');\n        content.appendChild(this.sBox);\n        this.wireEvents();\n        if (!this.parent.enableAdaptiveUI) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.loadingIndicator) && this.parent.loadingIndicator.indicatorType === 'Shimmer'\n                && !this.infiniteRenderMod) {\n                this.parent.showMaskRow(undefined, this.dialogObj.element);\n            }\n            if (this.infiniteRenderMod && this.parent.filterSettings && this.parent.filterSettings.loadingIndicator === 'Shimmer') {\n                this.showMask();\n            }\n        }\n        else {\n            if (this.infiniteRenderMod && this.parent.filterSettings && this.parent.filterSettings.loadingIndicator === 'Shimmer') {\n                this.getAllData();\n                return;\n            }\n            if (this.infiniteRenderMod) {\n                this.cBox.style.marginTop = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getListHeight)(this.cBox) + 'px';\n            }\n        }\n        if (!(this.infiniteRenderMod && this.parent.filterSettings && this.parent.filterSettings.loadingIndicator === 'Shimmer')) {\n            (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_9__.createSpinner)({ target: this.spinner, cssClass: this.parent.cssClass ? this.parent.cssClass : null }, this.parent.createElement);\n            (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_9__.showSpinner)(this.spinner);\n        }\n        this.getAllData();\n    };\n    CheckBoxFilterBase.prototype.renderResponsiveFilter = function (options) {\n        if (options.isResponsiveFilter) {\n            this.dialogObj.buttons = [{}];\n            this.dialogObj.position = { X: '', Y: '' };\n            this.dialogObj.target = document.querySelector('.e-resfilter > .e-dlg-content > .e-mainfilterdiv');\n            this.dialogObj.width = '100%';\n        }\n    };\n    CheckBoxFilterBase.prototype.dialogCreated = function (e) {\n        if (this.options.isResponsiveFilter) {\n            this.dialogObj.element.style.left = '0px';\n        }\n        else {\n            if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getFilterMenuPostion)(this.options.target, this.dialogObj);\n            }\n            else {\n                this.dialogObj.position = { X: 'center', Y: 'center' };\n            }\n        }\n        if (this.options.column.showColumnMenu) {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.filterDialogCreated, e);\n        }\n    };\n    CheckBoxFilterBase.prototype.openDialog = function (options) {\n        this.updateModel(options);\n        this.getAndSetChkElem(options);\n        this.showDialog(options);\n    };\n    CheckBoxFilterBase.prototype.closeDialog = function () {\n        if (this.infiniteRenderMod && this.infinitePermenantLocalData.length && !this.options.isRemote) {\n            this.options.dataSource.dataSource.json = this.infinitePermenantLocalData;\n        }\n        if (this.dialogObj && !this.dialogObj.isDestroyed) {\n            this.isBlanks = false;\n            var filterTemplateCol = this.options.columns.filter(function (col) { return col.getFilterItemTemplate(); });\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var registeredTemplate = this.parent.registeredTemplate;\n            if (filterTemplateCol.length && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(registeredTemplate) && registeredTemplate.filterItemTemplate) {\n                this.parent.destroyTemplate(['filterItemTemplate']);\n            }\n            if ((this.parent.isReact || this.parent.isVue) && this.parent.destroyTemplate !== undefined) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.clearReactVueTemplates)(this.parent, ['filterItemTemplate']);\n            }\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.filterMenuClose, { field: this.options.field });\n            this.unWireEvents();\n            if (this.searchInputArgs && this.searchInputArgs.element && this.searchInputArgs.element.parentElement) {\n                _syncfusion_ej2_inputs__WEBPACK_IMPORTED_MODULE_6__.Input.destroy(this.searchInputArgs);\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.searchInputArgs.element);\n            }\n            this.searchInputArgs = null;\n            this.sInput = null;\n            if (this.parent.isReact && this.options.column.filter && typeof (this.options.column.filter.itemTemplate) !== 'string'\n                && (this.options.column.filter.type === 'CheckBox' || this.options.column.filter.type === 'Excel')) {\n                this.dialogObj.element.querySelector('.e-dlg-content').innerHTML = '';\n            }\n            this.dialogObj.destroy();\n            if (this.dialogObj['dlgClosedBy'] === 'escape') {\n                this.parent.isColumnMenuFilterClosing = true;\n            }\n            if (this.dlg && this.dlg.parentElement) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.dlg);\n                var gridPopup = document.getElementById(this.parent.element.id + '_e-popup');\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gridPopup)) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(gridPopup);\n                    gridPopup = null;\n                }\n            }\n            this.dlg = null;\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.filterDialogClose, {});\n        }\n    };\n    /**\n     * @param {Column} col - Defines column details\n     * @returns {void}\n     * @hidden\n     */\n    CheckBoxFilterBase.prototype.clearFilter = function (col) {\n        // eslint-disable-next-line max-len\n        var args = { instance: this, handler: this.clearFilter, cancel: false };\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.fltrPrevent, args);\n        if (args.cancel) {\n            return;\n        }\n        this.options.handler({ action: 'clear-filter', field: col ? col.field : this.options.field });\n    };\n    CheckBoxFilterBase.prototype.btnClick = function (e) {\n        if (this.filterState) {\n            if ((e.target.tagName.toLowerCase() === 'input' && e.target.classList.contains('e-searchinput')) ||\n                e.keyCode === 13) {\n                if (!this.isCheckboxFilterTemplate) {\n                    this.fltrBtnHandler();\n                }\n            }\n            else {\n                var text = e.target.firstChild.textContent.toLowerCase();\n                if (this.getLocalizedLabel(this.isExcel ? 'OKButton' : 'FilterButton').toLowerCase() === text) {\n                    if (!this.isCheckboxFilterTemplate) {\n                        this.fltrBtnHandler();\n                    }\n                }\n                else if (this.getLocalizedLabel('ClearButton').toLowerCase() === text) {\n                    this.clearFilter();\n                }\n            }\n            this.closeDialog();\n        }\n        else if (e.target && e.target.firstChild &&\n            e.target.firstChild.textContent.toLowerCase() === this.getLocalizedLabel('CancelButton').toLowerCase()) {\n            this.closeDialog();\n        }\n        else if (!(e.target.tagName.toLowerCase() === 'input')) {\n            this.clearFilter();\n            this.closeDialog();\n        }\n        if (this.options.column.showColumnMenu) {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.afterFilterColumnMenuClose, {});\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.focusModule)) {\n            this.parent.focusModule.filterfocus();\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    CheckBoxFilterBase.prototype.fltrBtnHandler = function () {\n        var _this = this;\n        if (this.infiniteRenderMod) {\n            this.cBox.innerHTML = '';\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.appendChildren)(this.cBox, this.infiniteLoadedElem.slice());\n        }\n        var checked = [].slice.call(this.cBox.querySelectorAll('.e-check:not(.e-selectall):not(.e-add-current)'));\n        var check = checked;\n        var optr = 'equal';\n        var ddlValue = this.dialogObj.element.querySelector('.e-dropdownlist');\n        if (ddlValue) {\n            this.options.operator = optr = ddlValue.ej2_instances[0].value;\n        }\n        this.isMenuNotEqual = this.options.operator === 'notequal';\n        var searchInput;\n        if (!this.options.hideSearchbox) {\n            searchInput = this.searchBox.querySelector('.e-searchinput');\n        }\n        var caseSen = this.options.allowCaseSensitive;\n        var defaults = {\n            field: this.options.field, predicate: this.isMenuNotEqual ? 'and' : 'or', uid: this.options.uid,\n            operator: optr, type: this.options.type, matchCase: caseSen, ignoreAccent: this.options.ignoreAccent\n        };\n        var isNotEqual = this.itemsCnt !== checked.length && this.itemsCnt - checked.length < checked.length;\n        if (isNotEqual && searchInput && searchInput.value === '') {\n            optr = this.isMenuNotEqual ? 'equal' : 'notequal';\n            checked = [].slice.call(this.cBox.querySelectorAll('.e-uncheck:not(.e-selectall)'));\n            defaults.predicate = this.isMenuNotEqual ? 'or' : 'and';\n            defaults.operator = optr;\n        }\n        var val;\n        var length;\n        var coll = [];\n        if ((checked.length !== this.itemsCnt || (searchInput && searchInput.value && searchInput.value !== ''))\n            || this.infiniteRenderMod) {\n            if (!this.infiniteRenderMod) {\n                coll = this.complexQueryPredicate(checked, defaults, isNotEqual);\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(coll)) {\n                    return;\n                }\n                coll = this.filterPreventColumns ? this.filterPreventColumns : coll;\n            }\n            else if (this.infiniteRenderMod &&\n                (!this.infiniteSearchPred || (this.infiniteSearchPred && !this.infiniteSearchPred.isComplex))) {\n                this.infiniteFltrBtnHandler(coll);\n            }\n            else {\n                if (this.infiniteSearchPred.isComplex) {\n                    coll = this.complexQueryPredicate(checked, defaults, isNotEqual);\n                }\n            }\n            if ((this.options.type === 'date' || this.options.type === 'dateonly' || this.options.type === 'datetime') && check.length) {\n                length = check.length - 1;\n                val = this.values[(0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(check[parseInt(length.toString(), 10)], 'e-ftrchk').getAttribute('uid')];\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(val) && isNotEqual) {\n                    coll.push({\n                        field: defaults.field, matchCase: defaults.matchCase, operator: 'equal',\n                        predicate: 'or', value: null\n                    });\n                }\n            }\n            var addCurrSelection = this.infiniteRenderMod ? this.sBox.querySelector('.e-add-current') :\n                this.cBox.querySelector('.e-add-current');\n            if (addCurrSelection && addCurrSelection.classList.contains('e-check')) {\n                var existingPredicate_1 = this.existingPredicate[this.options.field];\n                if (existingPredicate_1) {\n                    var _loop_1 = function (j) {\n                        if (!coll.some(function (data) {\n                            return data\n                                .value === existingPredicate_1[parseInt(j.toString(), 10)].value;\n                        })) {\n                            coll.push(existingPredicate_1[parseInt(j.toString(), 10)]);\n                        }\n                    };\n                    for (var j = 0; j < existingPredicate_1.length; j++) {\n                        _loop_1(j);\n                    }\n                }\n                else {\n                    return;\n                }\n            }\n            if (!this.infiniteRenderMod) {\n                this.initiateFilter(coll);\n            }\n            else if (coll.length) {\n                this.initiateFilter(coll);\n            }\n            else if (this.sBox.querySelector('.e-selectall').classList.contains('e-check') && !coll.length) {\n                var isClearFilter = this.options.filteredColumns.some(function (value) {\n                    return _this.options.field === value.field;\n                });\n                if (isClearFilter) {\n                    this.clearFilter();\n                }\n            }\n        }\n        else {\n            var isClearFilter = this.options.filteredColumns.some(function (value) {\n                return _this.options.field === value.field;\n            });\n            if (isClearFilter) {\n                this.clearFilter();\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.complexQueryPredicate = function (checkBoxChecked, defaults, isNotEqual) {\n        var value;\n        var fObj;\n        var coll = [];\n        for (var i = 0; i < checkBoxChecked.length; i++) {\n            value = this.values[(0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(checkBoxChecked[parseInt(i.toString(), 10)], 'e-ftrchk').getAttribute('uid')];\n            fObj = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, { value: value }, defaults);\n            if (value && !value.toString().length) {\n                fObj.operator = isNotEqual ? 'notequal' : 'equal';\n            }\n            if (value === '' || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value)) {\n                coll = coll.concat(CheckBoxFilterBase.generateNullValuePredicates(defaults));\n            }\n            else {\n                coll.push(fObj);\n            }\n        }\n        var filterColumns = this.filterPreventColumns && this.filterPreventColumns.length ?\n            this.filterPreventColumns[0] : fObj;\n        if (filterColumns && !this.notifyFilterPrevEvent(filterColumns)) {\n            this.filterPreventColumns = coll;\n            return null;\n        }\n        else {\n            return coll;\n        }\n    };\n    CheckBoxFilterBase.prototype.infiniteFltrBtnHandler = function (coll) {\n        var value;\n        if (this.infiniteManualSelectMaintainPred.length) {\n            for (var i = 0; i < this.infiniteManualSelectMaintainPred.length; i++) {\n                var pred = this.infiniteManualSelectMaintainPred[i];\n                value = pred.value + '';\n                if (value === '' || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value)) {\n                    var dummyDefaults = { predicate: pred.predicate, field: pred.field, type: pred.type, uid: pred.uid, operator: pred.operator,\n                        matchCase: pred.matchCase, ignoreAccent: pred.ignoreAccent };\n                    coll.push.apply(coll, CheckBoxFilterBase.generateNullValuePredicates(dummyDefaults));\n                }\n                else {\n                    coll.push(this.infiniteManualSelectMaintainPred[i]);\n                }\n                this.notifyFilterPrevEvent(this.infiniteManualSelectMaintainPred[i]);\n            }\n        }\n        if (!this.localInfiniteSelectAllClicked && this.sInput.value === '' && !(!this.options.parentCurrentViewDataCount && coll.length)) {\n            for (var i = 0; i < this.infiniteUnloadParentExistPred.length; i++) {\n                coll.unshift(this.infiniteUnloadParentExistPred[i]);\n                this.notifyFilterPrevEvent(this.existingPredicate[this.options.field][i]);\n            }\n        }\n        if (this.sInput.value !== '' && (!this.localInfiniteSelectAllClicked || this.infiniteLocalSelectAll)) {\n            this.infiniteSearchPred['predicate'] = 'or';\n            coll.unshift(this.infiniteSearchPred);\n            this.notifyFilterPrevEvent(this.infiniteSearchPred);\n        }\n    };\n    CheckBoxFilterBase.prototype.notifyFilterPrevEvent = function (predicate) {\n        var args = {\n            instance: this, handler: this.fltrBtnHandler, arg1: predicate.field, arg2: predicate.predicate, arg3: predicate.operator,\n            arg4: predicate.matchCase, arg5: predicate.ignoreAccent, arg6: predicate.value, cancel: false\n        };\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.fltrPrevent, args);\n        if (args.cancel) {\n            return false;\n        }\n        return true;\n    };\n    // eslint-disable-next-line\n    /** @hidden */\n    CheckBoxFilterBase.generateNullValuePredicates = function (defaults) {\n        var coll = [];\n        if (defaults.type === 'string') {\n            coll.push({\n                field: defaults.field, ignoreAccent: defaults.ignoreAccent, matchCase: defaults.matchCase,\n                operator: defaults.operator, predicate: defaults.predicate, value: ''\n            });\n        }\n        coll.push({\n            field: defaults.field,\n            matchCase: defaults.matchCase, operator: defaults.operator, predicate: defaults.predicate, value: null\n        });\n        coll.push({\n            field: defaults.field, matchCase: defaults.matchCase, operator: defaults.operator,\n            predicate: defaults.predicate, value: undefined\n        });\n        return coll;\n    };\n    // eslint-disable-next-line\n    /** @hidden */\n    CheckBoxFilterBase.prototype.initiateFilter = function (fColl) {\n        var firstVal = fColl[0];\n        var predicate;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(firstVal)) {\n            predicate = firstVal.ejpredicate ? firstVal.ejpredicate :\n                new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Predicate(firstVal.field, firstVal.operator, firstVal.value, !firstVal.matchCase, firstVal.ignoreAccent);\n            for (var j = 1; j < fColl.length; j++) {\n                predicate = fColl[parseInt(j.toString(), 10)].ejpredicate !== undefined ?\n                    predicate[fColl[parseInt(j.toString(), 10)].predicate](fColl[parseInt(j.toString(), 10)].ejpredicate) :\n                    predicate[fColl[parseInt(j.toString(), 10)].predicate](fColl[parseInt(j.toString(), 10)].field, fColl[parseInt(j.toString(), 10)].operator, fColl[parseInt(j.toString(), 10)].value, !fColl[parseInt(j.toString(), 10)].matchCase, fColl[parseInt(j.toString(), 10)].ignoreAccent);\n            }\n            var args = {\n                action: 'filtering', filterCollection: fColl, field: this.options.field,\n                ejpredicate: _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Predicate.or(predicate)\n            };\n            this.options.handler(args);\n        }\n    };\n    CheckBoxFilterBase.prototype.isForeignColumn = function (col) {\n        return col.isForeignColumn ? col.isForeignColumn() : false;\n    };\n    CheckBoxFilterBase.prototype.refreshCheckboxes = function () {\n        var _this = this;\n        var val = this.sInput.value;\n        var column = this.options.column;\n        var query = this.isForeignColumn(column) ? this.foreignKeyQuery.clone() : this.options.query.clone();\n        var foreignQuery = this.options.query.clone();\n        var pred = query.queries.filter(function (e) { return e && e.fn === 'onWhere'; })[0];\n        query.queries = [];\n        foreignQuery.queries = [];\n        var parsed = (this.options.type !== 'string' && parseFloat(val)) ? parseFloat(val) : val;\n        var operator = this.options.isRemote ?\n            (this.options.type === 'string' ? 'contains' : 'equal') : (this.options.type ? 'contains' : 'equal');\n        var matchCase = true;\n        var ignoreAccent = this.options.ignoreAccent;\n        var field = this.isForeignColumn(column) ? column.foreignKeyValue : column.field;\n        parsed = (parsed === '' || parsed === undefined) ? undefined : parsed;\n        var coll = [];\n        var defaults = {\n            field: field, predicate: 'or', uid: this.options.uid,\n            operator: 'equal', type: this.options.type, matchCase: matchCase, ignoreAccent: ignoreAccent\n        };\n        var predicte;\n        var moduleName = this.options.dataManager.adaptor.getModuleName;\n        if (this.options.type === 'boolean') {\n            if (parsed !== undefined &&\n                this.getLocalizedLabel('FilterTrue').toLowerCase().indexOf(parsed.toLowerCase()) !== -1) {\n                parsed = 'true';\n            }\n            else if (parsed !== undefined &&\n                this.getLocalizedLabel('FilterFalse').toLowerCase().indexOf(parsed.toLowerCase()) !== -1) {\n                parsed = 'false';\n            }\n            if (parsed !== undefined &&\n                this.getLocalizedLabel('FilterTrue').toLowerCase().indexOf(parsed.toLowerCase()) !== -1 && moduleName) {\n                // eslint-disable-next-line no-constant-condition\n                parsed = (moduleName() === 'ODataAdaptor' || 'ODataV4Adaptor') ? true : 0;\n            }\n            else if (parsed !== undefined &&\n                this.getLocalizedLabel('FilterFalse').toLowerCase().indexOf(parsed.toLowerCase()) !== -1 && moduleName) {\n                // eslint-disable-next-line no-constant-condition\n                parsed = (moduleName() === 'ODataAdaptor' || 'ODataV4Adaptor') ? false : 0;\n            }\n            operator = 'equal';\n        }\n        if ((this.options.type === 'date' || this.options.type === 'datetime' || this.options.type === 'dateonly') && this.options.format) {\n            var intl = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Internationalization();\n            var format = typeof (this.options.format) === 'string' ? this.options.format :\n                this.options.format.format;\n            if (format) {\n                parsed = intl.parseDate(val, { format: format }) || new Date(val);\n            }\n            else {\n                parsed = new Date(val);\n            }\n            if (this.options.type === 'dateonly') {\n                parsed = parsed.getFullYear() + '-' + (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.padZero)(parsed.getMonth() + 1) + '-' + (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.padZero)(parsed.getDate());\n            }\n        }\n        this.infiniteSearchValChange = true;\n        this.infiniteLoadedElem = [];\n        this.infiniteLocalSelectAll = true;\n        this.localInfiniteSelectAllClicked = false;\n        this.localInfiniteSelectionInteracted = false;\n        this.infiniteSkipCnt = 0;\n        this.infiniteDataCount = 0;\n        this.infiniteManualSelectMaintainPred = [];\n        if (this.sInput.value === '') {\n            this.infiniteUnloadParentExistPred = this.infiniteRenderMod && this.existingPredicate[this.options.column.field] ? this.existingPredicate[this.options.column.field].slice() : [];\n        }\n        else {\n            this.infiniteUnloadParentExistPred = [];\n        }\n        this.addDistinct(query);\n        var args = {\n            requestType: _base_constant__WEBPACK_IMPORTED_MODULE_4__.filterSearchBegin,\n            filterModel: this, columnName: field, column: column,\n            operator: operator, matchCase: matchCase, ignoreAccent: ignoreAccent, filterChoiceCount: null,\n            query: query, value: parsed\n        };\n        if (this.infiniteRenderMod && this.parent.filterSettings.itemsCount) {\n            args.filterChoiceCount = this.parent.filterSettings.itemsCount;\n        }\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_4__.actionBegin, args, function (filterargs) {\n            // eslint-disable-next-line no-self-assign\n            filterargs.operator = filterargs.operator;\n            predicte = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Predicate(field, filterargs.operator, args.value, filterargs.matchCase, filterargs.ignoreAccent);\n            if (_this.options.type === 'date' || _this.options.type === 'datetime' || _this.options.type === 'dateonly') {\n                operator = 'equal';\n                var filterObj = {\n                    field: field, operator: operator, value: parsed, matchCase: matchCase,\n                    ignoreAccent: ignoreAccent\n                };\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(parsed)) {\n                    predicte = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getDatePredicate)(filterObj, _this.options.type);\n                }\n            }\n            if (val && typeof val === 'string' && _this.isBlanks &&\n                _this.getLocalizedLabel('Blanks').toLowerCase().indexOf(val.toLowerCase()) >= 0) {\n                coll = coll.concat(CheckBoxFilterBase.generateNullValuePredicates(defaults));\n                var emptyValPredicte = CheckBoxFilterBase.generatePredicate(coll);\n                emptyValPredicte.predicates.push(predicte);\n                predicte = emptyValPredicte;\n                query.where(emptyValPredicte);\n            }\n            else if (val.length) {\n                predicte = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(pred) ? predicte.and(pred.e) : predicte;\n                query.where(predicte);\n            }\n            else if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(pred)) {\n                predicte = pred.e;\n                query.where(pred.e);\n            }\n            _this.infiniteSearchPred = predicte;\n            filterargs.filterChoiceCount = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(filterargs.filterChoiceCount) ? filterargs.filterChoiceCount : 1000;\n            if (_this.infiniteRenderMod && _this.parent.filterSettings.itemsCount !== filterargs.filterChoiceCount) {\n                _this.parent.filterSettings.itemsCount = args.filterChoiceCount;\n            }\n            var fPredicate = {};\n            (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_9__.showSpinner)(_this.spinner);\n            _this.renderEmpty = false;\n            if (_this.isForeignColumn(column) && val.length) {\n                var colData = ('result' in column.dataSource) ? new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(column.dataSource.result) :\n                    column.dataSource;\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                colData.executeQuery(query).then(function (e) {\n                    var columnData = _this.options.column.columnData;\n                    _this.options.column.columnData = e.result;\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.generateQuery, { predicate: fPredicate, column: column });\n                    if (fPredicate.predicate.predicates.length) {\n                        foreignQuery.where(fPredicate.predicate);\n                    }\n                    else {\n                        _this.renderEmpty = true;\n                    }\n                    _this.options.column.columnData = columnData;\n                    if (_this.infiniteRenderMod) {\n                        _this.infiniteInitialLoad = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.fullData) ? true : false;\n                        _this.makeInfiniteScrollRequest(foreignQuery);\n                        foreignQuery.requiresCount();\n                    }\n                    else {\n                        foreignQuery.take(filterargs.filterChoiceCount);\n                    }\n                    _this.search(filterargs, foreignQuery);\n                });\n            }\n            else {\n                if (_this.infiniteRenderMod && _this.parent.filterSettings.itemsCount) {\n                    _this.infiniteInitialLoad = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.fullData) ? true : false;\n                    _this.makeInfiniteScrollRequest(query);\n                    query.requiresCount();\n                }\n                else {\n                    query.take(filterargs.filterChoiceCount);\n                }\n                _this.search(filterargs, query);\n            }\n        });\n    };\n    CheckBoxFilterBase.prototype.search = function (args, query) {\n        if (this.parent.dataSource && 'result' in this.parent.dataSource) {\n            this.filterEvent(args, query);\n        }\n        else {\n            this.processSearch(query);\n        }\n    };\n    CheckBoxFilterBase.prototype.getPredicateFromCols = function (columns, isExecuteLocal) {\n        var predicates = CheckBoxFilterBase.getPredicate(columns, isExecuteLocal);\n        var predicateList = [];\n        var fPredicate = {};\n        var isGrid = this.parent.getForeignKeyColumns !== undefined;\n        var foreignColumn = isGrid ? this.parent.getForeignKeyColumns() : [];\n        for (var _i = 0, _a = Object.keys(predicates); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            var col = void 0;\n            if (isGrid && !this.parent.getColumnByField(prop)) {\n                col = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getColumnByForeignKeyValue)(prop, foreignColumn);\n            }\n            if (col) {\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.generateQuery, { predicate: fPredicate, column: col });\n                if (fPredicate.predicate.predicates.length) {\n                    predicateList.push(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Predicate.or(fPredicate.predicate.predicates));\n                }\n            }\n            else {\n                predicateList.push(predicates[\"\" + prop]);\n            }\n        }\n        return predicateList.length && _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Predicate.and(predicateList);\n    };\n    CheckBoxFilterBase.prototype.getQuery = function () {\n        return this.parent.getQuery ? this.parent.getQuery().clone() : new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query();\n    };\n    CheckBoxFilterBase.prototype.getAllData = function () {\n        var _this = this;\n        this.customQuery = false;\n        var query = this.getQuery();\n        var moduleName = this.options.dataManager.adaptor.getModuleName;\n        if (!(!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.getDataModule) && moduleName && moduleName() === 'ODataV4Adaptor')) {\n            query.requiresCount(); //consider take query\n        }\n        this.addDistinct(query);\n        var args = {\n            requestType: _base_constant__WEBPACK_IMPORTED_MODULE_4__.filterChoiceRequest, query: query, filterChoiceCount: null\n        };\n        var filterModel = 'filterModel';\n        args[\"\" + filterModel] = this;\n        if (this.infiniteRenderMod && this.parent.filterSettings.itemsCount) {\n            args.filterChoiceCount = this.parent.filterSettings.itemsCount;\n        }\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_4__.actionBegin, args, function (args) {\n            args.filterChoiceCount = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.filterChoiceCount) ? args.filterChoiceCount : 1000;\n            if (_this.infiniteRenderMod && _this.parent.filterSettings.itemsCount !== args.filterChoiceCount) {\n                _this.parent.filterSettings.itemsCount = args.filterChoiceCount;\n            }\n            if (!_this.infiniteRenderMod) {\n                query.take(args.filterChoiceCount);\n            }\n            if (!args.query.distincts.length || _this.infiniteRenderMod) {\n                _this.customQuery = true;\n                _this.queryGenerate(query);\n            }\n            if (_this.infiniteRenderMod) {\n                _this.infiniteInitialLoad = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.fullData) ? true : false;\n                _this.makeInfiniteScrollRequest(query);\n            }\n            if (_this.parent.dataSource && 'result' in _this.parent.dataSource) {\n                _this.filterEvent(args, query);\n            }\n            else {\n                _this.processDataOperation(query, true);\n            }\n        });\n    };\n    CheckBoxFilterBase.prototype.addDistinct = function (query) {\n        var _this = this;\n        var filteredColumn = _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_10__.DataUtil.distinct(this.options.filteredColumns, 'field');\n        if (filteredColumn.indexOf(this.options.column.field) <= -1) {\n            filteredColumn = filteredColumn.concat(this.options.column.field);\n        }\n        var moduleName = this.options.dataManager.adaptor.getModuleName;\n        if (moduleName && moduleName() === 'ODataV4Adaptor' && this.parent &&\n            this.parent.query instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query) {\n            var gridQuery = this.parent.query;\n            for (var i = 0; i < gridQuery.queries.length; i++) {\n                var queryOptions = gridQuery.queries[parseInt(i.toString(), 10)];\n                if (queryOptions.fn === 'onWhere') {\n                    this.getPredicateFields(queryOptions.e);\n                    this.queryFilteredColumn.map(function (field) {\n                        if (filteredColumn.indexOf(field) === -1) {\n                            filteredColumn.push(field);\n                        }\n                    });\n                    this.queryFilteredColumn = [];\n                }\n            }\n        }\n        if (!this.infiniteRenderMod) {\n            query.distinct(filteredColumn);\n        }\n        if (this.infiniteRenderMod && !this.options.isRemote && this.sInput.value === '') {\n            this.options.dataSource = this.options.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager ?\n                this.options.dataSource : new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(this.options.dataSource);\n            this.infinitePermenantLocalData = this.options.dataSource.dataSource.json.slice();\n            var query1 = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query();\n            this.queryGenerate(query1);\n            var result = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(this.options.dataSource.dataSource).executeLocal(query1);\n            this.options.dataSource = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_10__.DataUtil.distinct(result, this.options.column.field, true));\n            if (this.isForeignColumn(this.options.column)) {\n                this.options.column.dataSource = this.options.column.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager ?\n                    this.options.column.dataSource : new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(this.options.column.dataSource);\n                this.options.dataSource.dataSource.json = this.options.dataSource.dataSource.json.map(function (item, i) {\n                    return Object.assign({}, item, _this.options.column.dataSource.dataSource.json[i]);\n                });\n            }\n        }\n        else if (this.infiniteRenderMod && this.options.isRemote) {\n            query.select(this.options.column.field);\n            query.sortBy(this.options.column.field, 'ascending');\n            var moduleName_1 = this.options.dataManager.adaptor.getModuleName;\n            if (moduleName_1 && moduleName_1() && (moduleName_1() === 'ODataV4Adaptor' || moduleName_1() === 'WebApiAdaptor'\n                || moduleName_1() === 'CustomDataAdaptor' || moduleName_1() === 'GraphQLAdaptor' || moduleName_1() === 'ODataAdaptor')) {\n                query.distinct(filteredColumn);\n            }\n        }\n        return query;\n    };\n    CheckBoxFilterBase.prototype.getPredicateFields = function (query) {\n        var _this = this;\n        if (query.isComplex && query.predicates) {\n            query.predicates.forEach(function (predicate) {\n                if (Array.isArray(predicate)) {\n                    predicate.forEach(function (p) { return _this.getPredicateFields(p); });\n                }\n                else {\n                    _this.getPredicateFields(predicate);\n                }\n            });\n        }\n        else {\n            if (query.field && !query.isComplex) {\n                if (this.queryFilteredColumn.indexOf(query.field) <= -1) {\n                    this.queryFilteredColumn = this.queryFilteredColumn.concat(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_10__.DataUtil.distinct([query.field], 'field'));\n                }\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.filterEvent = function (args, query) {\n        var _this = this;\n        var defObj = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.eventPromise)(args, query);\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_4__.dataStateChange, defObj.state);\n        this.addInfiniteScrollEvent(query);\n        var def = defObj.deffered;\n        def.promise.then(function (e) {\n            _this.infiniteDataCount = _this.infiniteRenderMod && !_this.infiniteDataCount ? e['count'] : _this.infiniteDataCount;\n            var dataResult = _this.infiniteRenderMod ? e['result'] : e;\n            _this.dataSuccess(dataResult);\n        });\n    };\n    CheckBoxFilterBase.prototype.addInfiniteScrollEvent = function (query) {\n        if (this.infiniteRenderMod) {\n            this.infiniteQuery = query.clone();\n            if (this.infiniteInitialLoad) {\n                this.cBox.classList.add('e-checkbox-infinitescroll');\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.cBox, 'scroll', this.infiniteScrollHandler, this);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.cBox, 'mouseup', this.infiniteScrollMouseKeyUpHandler, this);\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.cBox, 'mousedown', this.infiniteScrollMouseKeyDownHandler, this);\n            }\n            else if (this.infiniteSearchValChange) {\n                this.cBox.innerHTML = '';\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.infiniteScrollMouseKeyDownHandler = function () {\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.cBox, 'scroll', this.infiniteScrollHandler);\n    };\n    CheckBoxFilterBase.prototype.infiniteScrollMouseKeyUpHandler = function (e) {\n        var _this = this;\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.cBox, 'scroll', this.infiniteScrollHandler, this);\n        var target = this.cBox;\n        if (target.children.length > 1 && (target.scrollTop >= target.scrollHeight - target.offsetHeight || target.scrollTop <= 0)) {\n            this.infiniteScrollHandler();\n        }\n        _base_util__WEBPACK_IMPORTED_MODULE_8__.Global.timer = setTimeout(function () { _this.clickHandler(e); _base_util__WEBPACK_IMPORTED_MODULE_8__.Global.timer = null; }, 0);\n    };\n    CheckBoxFilterBase.prototype.getShimmerTemplate = function () {\n        return '<span class=\"e-mask e-skeleton e-skeleton-text e-shimmer-wave\"></span>';\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    CheckBoxFilterBase.prototype.showMask = function () {\n        var maskRowCount = 5;\n        var maskItemHeight;\n        var maskList = this.parent.createElement('div', { id: this.id + this.options.type + '_CheckBoxMaskList',\n            className: 'e-checkboxlist e-fields e-infinite-list e-masklist' });\n        maskList.style.zIndex = '10';\n        var wrapperElem = this.cBox;\n        this.removeMask();\n        if (wrapperElem) {\n            var computedStyle = getComputedStyle(wrapperElem);\n            var liHeight = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getListHeight)(wrapperElem);\n            var height = wrapperElem.children.length ? parseInt(computedStyle.height, 10) :\n                Math.floor(parseInt(computedStyle.height.split('px')[0], 10)) - 5;\n            if (this.parent.enableAdaptiveUI && this.infiniteRenderMod) {\n                maskList.style.height = (height - liHeight) + 'px';\n                this.dlg.querySelector('.e-dlg-content').style.overflow = 'hidden';\n            }\n            var backgroundColor = this.isExcel && !wrapperElem.children.length && !this.dlg.classList.contains('e-excelfilter') ?\n                '' : getComputedStyle(this.dlg.querySelector('.e-dlg-content')).backgroundColor;\n            maskList.style.cssText = 'width: ' + computedStyle.width + '; min-height: ' + computedStyle.minHeight + '; height: ' +\n                height + 'px; margin: ' + computedStyle.margin + '; border-style: ' + computedStyle.borderStyle + '; border-width: '\n                + computedStyle.borderWidth + '; border-color: ' + computedStyle.borderColor + '; position: absolute; background-color: ' +\n                backgroundColor + ';';\n            maskRowCount = Math.floor(height / liHeight);\n            maskRowCount = wrapperElem.children.length > maskRowCount ? wrapperElem.children.length : maskRowCount;\n            maskItemHeight = liHeight + 'px';\n        }\n        var maskTemplate = '<div class=\"e-ftrchk e-mask-ftrchk\">'\n            + '<div class=\"e-checkbox-wrapper\"><input class=\"e-chk-hidden\">'\n            + this.getShimmerTemplate() + this.getShimmerTemplate() + '</div></div>';\n        maskList.innerHTML = '';\n        if (!wrapperElem.children.length) {\n            this.spinner.insertAdjacentHTML('beforebegin', maskTemplate);\n            this.spinner.parentElement.querySelector('.e-ftrchk.e-mask-ftrchk').style.cssText =\n                'width: 100%; height: ' + maskItemHeight + ';';\n            this.spinner.parentElement.querySelector('.e-checkbox-wrapper').style.width = '100%';\n            var maskSpan = [].slice.call(this.spinner.parentElement\n                .querySelectorAll('.e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)'));\n            maskSpan[0].classList.add('e-mask-checkbox-filter-intent');\n            maskSpan[1].classList.add('e-mask-checkbox-filter-span-intent');\n        }\n        this.spinner.insertBefore(maskList, this.cBox);\n        for (var i = 0; maskRowCount && i < maskRowCount; i++) {\n            maskList.innerHTML += maskTemplate;\n            maskList.lastElementChild.style.cssText =\n                'width: 100%; height: ' + maskItemHeight + ';';\n            maskList.lastElementChild.querySelector('.e-checkbox-wrapper').style.width = '100%';\n            var maskSpan = [].slice.call(maskList\n                .querySelectorAll('.e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)'));\n            maskSpan[0].classList.add('e-mask-checkbox-filter-intent');\n            maskSpan[1].classList.add('e-mask-checkbox-filter-span-intent');\n        }\n        if (this.cBox) {\n            maskList.scrollTop = this.cBox.scrollTop;\n        }\n    };\n    CheckBoxFilterBase.prototype.removeMask = function () {\n        var maskLists = this.dialogObj.element.querySelectorAll('.e-mask-ftrchk');\n        if (maskLists.length) {\n            for (var i = 0; i < maskLists.length; i++) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(maskLists[i]);\n            }\n        }\n        var maskParent = this.dialogObj.element.querySelector('.e-checkboxlist.e-masklist');\n        if (maskParent) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.dialogObj.element.querySelector('.e-checkboxlist.e-masklist'));\n        }\n    };\n    CheckBoxFilterBase.prototype.infiniteScrollHandler = function () {\n        var target = this.cBox;\n        if (target.scrollTop >= target.scrollHeight - target.offsetHeight && !this.infiniteQueryExecutionPending\n            && this.infiniteLoadedElem.length <= (this.infiniteSkipCnt + this.parent.filterSettings.itemsCount)\n            && this.cBox.children.length === this.parent.filterSettings.itemsCount * 3\n            && (!this.infiniteDataCount || this.infiniteDataCount > (this.infiniteSkipCnt + this.parent.filterSettings.itemsCount))) {\n            this.makeInfiniteScrollRequest();\n            this.prevInfiniteScrollDirection = 'down';\n        }\n        else if (target.scrollTop >= target.scrollHeight - target.offsetHeight && !this.infiniteQueryExecutionPending\n            && this.infiniteLoadedElem.length > (this.infiniteSkipCnt + this.parent.filterSettings.itemsCount)\n            && this.cBox.children.length === this.parent.filterSettings.itemsCount * 3) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.infiniteRemoveElements)(([].slice.call(this.cBox.children)).splice(0, this.parent.filterSettings.itemsCount));\n            this.infiniteSkipCnt += this.prevInfiniteScrollDirection === 'down' ? this.parent.filterSettings.itemsCount :\n                (this.parent.filterSettings.itemsCount * 3);\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.appendChildren)(this.cBox, this.infiniteLoadedElem.slice(this.infiniteSkipCnt, this.parent.filterSettings.itemsCount +\n                this.infiniteSkipCnt));\n            this.prevInfiniteScrollDirection = 'down';\n        }\n        else if (target.scrollTop === 0 && !this.infiniteInitialLoad && !this.infiniteSearchValChange && this.infiniteSkipCnt\n            && this.infiniteLoadedElem.length && this.infiniteLoadedElem.length > this.parent.filterSettings.itemsCount * 3\n            && this.cBox.children.length === this.parent.filterSettings.itemsCount * 3) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.infiniteRemoveElements)(([].slice.call(this.cBox.children)).splice((this.parent.filterSettings\n                .itemsCount * 2), this.parent.filterSettings.itemsCount));\n            this.infiniteSkipCnt -= this.prevInfiniteScrollDirection === 'up' ? this.parent.filterSettings.itemsCount :\n                (this.parent.filterSettings.itemsCount * 3);\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.infiniteAppendElements)([].slice.call(this.infiniteLoadedElem.slice(this.infiniteSkipCnt, this.infiniteSkipCnt +\n                this.parent.filterSettings.itemsCount)), this.cBox);\n            this.cBox.scrollTop = this.infiniteScrollAppendDiff;\n            this.prevInfiniteScrollDirection = 'up';\n        }\n        else if (target.scrollTop === 0 && !this.infiniteInitialLoad && !this.infiniteSearchValChange && this.infiniteSkipCnt\n            && this.infiniteLoadedElem.length && this.cBox.children.length < this.parent.filterSettings.itemsCount * 3) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.infiniteRemoveElements)(([].slice.call(this.cBox.children)).splice((this.parent.filterSettings\n                .itemsCount * 2), this.infiniteDataCount % this.parent.filterSettings.itemsCount));\n            this.infiniteSkipCnt = (Math.floor(this.infiniteDataCount / this.parent.filterSettings.itemsCount) - 3) *\n                this.parent.filterSettings.itemsCount;\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.infiniteAppendElements)([].slice.call(this.infiniteLoadedElem.slice(this.infiniteSkipCnt, this.infiniteSkipCnt +\n                this.parent.filterSettings.itemsCount)), this.cBox);\n            this.cBox.scrollTop = this.infiniteScrollAppendDiff;\n            this.prevInfiniteScrollDirection = 'up';\n        }\n    };\n    CheckBoxFilterBase.prototype.makeInfiniteScrollRequest = function (query) {\n        var _this = this;\n        if (!this.infiniteInitialLoad && this.parent.filterSettings && this.parent.filterSettings.loadingIndicator === 'Shimmer') {\n            setTimeout(function () {\n                if (_this.infiniteQueryExecutionPending) {\n                    _this.showMask();\n                }\n            }, 500);\n        }\n        else if (!this.infiniteInitialLoad) {\n            (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_9__.createSpinner)({ target: this.spinner, cssClass: this.parent.cssClass ? this.parent.cssClass : null }, this.parent\n                .createElement);\n            (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_9__.showSpinner)(this.spinner);\n        }\n        var fName = 'fn';\n        if (this.infiniteQuery && this.infiniteQuery.queries && this.infiniteQuery.queries.length) {\n            for (var i = 0; i < this.infiniteQuery.queries.length; i++) {\n                if (this.infiniteQuery.queries[i][\"\" + fName] === 'onTake'\n                    || this.infiniteQuery.queries[i][\"\" + fName] === 'onSkip') {\n                    this.infiniteQuery.queries.splice(i, 1);\n                    i--;\n                }\n            }\n        }\n        var existQuery = query ? true : false;\n        query = query ? query : this.infiniteQuery;\n        if (this.infiniteInitialLoad || this.infiniteSearchValChange) {\n            this.infiniteSkipCnt = 0;\n        }\n        else {\n            this.infiniteSkipCnt += this.parent.filterSettings.itemsCount;\n        }\n        query.skip(this.infiniteSkipCnt);\n        if (this.infiniteInitialLoad || this.infiniteSearchValChange) {\n            query.take(this.parent.filterSettings.itemsCount * 3);\n            this.infiniteSkipCnt += this.parent.filterSettings.itemsCount * 2;\n        }\n        else {\n            query.take(this.parent.filterSettings.itemsCount);\n        }\n        if (!existQuery) {\n            if (this.parent.dataSource && 'result' in this.parent.dataSource) {\n                var args = {\n                    requestType: _base_constant__WEBPACK_IMPORTED_MODULE_4__.filterChoiceRequest, query: query, filterChoiceCount: null, filterModel: this\n                };\n                if (this.infiniteRenderMod && this.parent.filterSettings.itemsCount) {\n                    args.filterChoiceCount = this.parent.filterSettings.itemsCount;\n                }\n                this.filterEvent(args, query);\n            }\n            else {\n                this.processDataOperation(query);\n                this.infiniteQueryExecutionPending = true;\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.processDataOperation = function (query, isInitial) {\n        var _this = this;\n        this.options.dataSource = this.options.dataSource instanceof _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager ?\n            this.options.dataSource : new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(this.options.dataSource);\n        var allPromise = [];\n        var runArray = [];\n        if (this.isForeignColumn(this.options.column) && isInitial) {\n            var colData = ('result' in this.options.column.dataSource) ?\n                new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(this.options.column.dataSource.result) :\n                this.options.column.dataSource;\n            this.foreignKeyQuery.params = query.params;\n            allPromise.push(colData.executeQuery(this.foreignKeyQuery));\n            runArray.push(function (data) { return _this.foreignKeyData = data; });\n        }\n        this.addInfiniteScrollEvent(query);\n        if (this.infiniteRenderMod && this.infiniteInitialLoad && !this.options.isRemote) {\n            var field = this.isForeignColumn(this.options.column) ? this.options.foreignKeyValue :\n                this.options.column.field;\n            this.options.dataSource.executeQuery(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query().sortBy(field, _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_10__.DataUtil.fnAscending)).then(function (e) {\n                _this.options.dataSource.dataSource.json = e.result;\n                _this.executeQueryOperations(query, allPromise, runArray);\n            });\n        }\n        else {\n            this.executeQueryOperations(query, allPromise, runArray);\n        }\n    };\n    CheckBoxFilterBase.prototype.executeQueryOperations = function (query, allPromise, runArray) {\n        var _this = this;\n        allPromise.push(this.options.dataSource.executeQuery(query));\n        runArray.push(this.dataSuccess.bind(this));\n        var i = 0;\n        Promise.all(allPromise).then(function (e) {\n            _this.infiniteQueryExecutionPending = _this.infiniteRenderMod ? false : _this.infiniteQueryExecutionPending;\n            for (var j = 0; j < e.length; j++) {\n                _this.infiniteDataCount = _this.infiniteRenderMod && !_this.infiniteDataCount ? e[j].count : _this.infiniteDataCount;\n                runArray[i++](e[parseInt(j.toString(), 10)].result);\n            }\n        }).catch(function () {\n            if (_this.infiniteRenderMod && _this.parent.filterSettings && _this.parent.filterSettings.loadingIndicator === 'Shimmer') {\n                _this.parent.showMaskRow(undefined, _this.dialogObj.element);\n            }\n        });\n    };\n    CheckBoxFilterBase.prototype.dataSuccess = function (e) {\n        if (!this.infiniteInitialLoad && this.infiniteDataCount && ((this.infiniteSkipCnt >= this.infiniteDataCount\n            && !this.infiniteSearchValChange) || (e.length === 0))) {\n            return;\n        }\n        this.fullData = e;\n        var args1 = { dataSource: this.fullData, executeQuery: true, field: this.options.field };\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.beforeCheckboxRenderer, args1);\n        if (args1.executeQuery) {\n            var query = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query();\n            if (!this.customQuery) {\n                this.isExecuteLocal = true;\n                this.queryGenerate(query);\n                this.isExecuteLocal = false;\n            }\n            // query.select(this.options.field);\n            var result = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(args1.dataSource).executeLocal(query);\n            var col = this.options.column;\n            this.filteredData = CheckBoxFilterBase.getDistinct(result, this.options.field, col, this.foreignKeyData, this).records || [];\n        }\n        var data = args1.executeQuery ? this.filteredData : args1.dataSource;\n        this.processDataSource(null, true, data, args1);\n        if ((this.infiniteRenderMod && this.infiniteInitialLoad) || !this.infiniteRenderMod) {\n            if (this.sInput) {\n                this.sInput.focus();\n            }\n            else if (this.dlg.querySelector('.e-chk-hidden') && this.dlg.querySelector('.e-ftrchk')) {\n                this.dlg.querySelector('.e-chk-hidden').focus();\n                this.dlg.querySelector('.e-ftrchk').classList.add('e-chkfocus');\n            }\n        }\n        if (this.infiniteInitialLoad || this.infiniteSearchValChange) {\n            this.infiniteInitialLoad = false;\n            this.infiniteSearchValChange = false;\n        }\n        var args = {\n            requestType: _base_constant__WEBPACK_IMPORTED_MODULE_4__.filterAfterOpen,\n            columnName: this.options.field, columnType: this.options.type\n        };\n        var filterModel = 'filterModel';\n        args[\"\" + filterModel] = this;\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.cBoxFltrComplete, args);\n        if (this.isCheckboxFilterTemplate) {\n            (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_9__.hideSpinner)(this.spinner);\n        }\n    };\n    CheckBoxFilterBase.prototype.queryGenerate = function (query) {\n        if (this.parent.searchSettings && this.parent.searchSettings.key.length) {\n            var moduleName = this.options.dataManager.adaptor.getModuleName;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.getDataModule) && moduleName && moduleName() === 'ODataV4Adaptor') {\n                this.parent.getDataModule().searchQuery(query);\n            }\n            else {\n                var searchSettings = this.parent.searchSettings;\n                var fields = searchSettings.fields.length ? searchSettings.fields\n                    : this.options.columns.map(function (f) { return f.field; });\n                query.search(searchSettings.key, fields, searchSettings.operator, searchSettings.ignoreCase, searchSettings.ignoreAccent);\n            }\n        }\n        if ((this.options.filteredColumns.length)) {\n            var cols = [];\n            for (var i = 0; i < this.options.filteredColumns.length; i++) {\n                var filterColumn = this.options.filteredColumns[parseInt(i.toString(), 10)];\n                if (this.options.uid) {\n                    filterColumn.uid = filterColumn.uid || this.parent.getColumnByField(filterColumn.field).uid;\n                    if (filterColumn.uid !== this.options.uid) {\n                        cols.push(this.options.filteredColumns[parseInt(i.toString(), 10)]);\n                    }\n                }\n                else {\n                    if (filterColumn.field !== this.options.field) {\n                        cols.push(this.options.filteredColumns[parseInt(i.toString(), 10)]);\n                    }\n                }\n            }\n            var predicate = this.getPredicateFromCols(cols, this.isExecuteLocal);\n            if (predicate) {\n                query.where(predicate);\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.processDataSource = function (query, isInitial, dataSource, args) {\n        (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_9__.showSpinner)(this.spinner);\n        // query = query ? query : this.options.query.clone();\n        // query.requiresCount();\n        // let result: Object = new DataManager(dataSource as JSON[]).executeLocal(query);\n        // let res: { result: Object[] } = result as { result: Object[] };\n        this.isExecuteLocal = true;\n        this.updateResult();\n        this.isExecuteLocal = false;\n        var args1 = { dataSource: this.fullData, isCheckboxFilterTemplate: false, column: this.options.column,\n            element: this.cBox, type: this.options.type, format: this.options.type, btnObj: this.options.isResponsiveFilter ? null :\n                this.dialogObj.btnObj[0], searchBox: this.searchBox };\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.beforeCheckboxfilterRenderer, args1);\n        this.isCheckboxFilterTemplate = args1.isCheckboxFilterTemplate;\n        if (!this.isCheckboxFilterTemplate) {\n            this.createFilterItems(dataSource, isInitial, args);\n        }\n        else if (this.infiniteRenderMod && this.parent.filterSettings && this.parent.filterSettings.loadingIndicator === 'Shimmer') {\n            this.removeMask();\n        }\n    };\n    CheckBoxFilterBase.prototype.processSearch = function (query) {\n        this.processDataOperation(query);\n    };\n    CheckBoxFilterBase.prototype.updateResult = function () {\n        this.result = {};\n        var predicate = this.infiniteRenderMod && this.existingPredicate[this.options.field] ?\n            this.getPredicateFromCols(this.existingPredicate[this.options.field], this.isExecuteLocal) :\n            this.getPredicateFromCols(this.options.filteredColumns, this.isExecuteLocal);\n        var query = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query();\n        if (predicate) {\n            query.where(predicate);\n        }\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.beforeCheckboxRendererQuery, { query: query });\n        var result = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(this.fullData).executeLocal(query);\n        for (var _i = 0, result_1 = result; _i < result_1.length; _i++) {\n            var res = result_1[_i];\n            this.result[(0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getObject)(this.options.field, res)] = true;\n        }\n    };\n    CheckBoxFilterBase.prototype.clickHandler = function (e) {\n        var _a;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_base_util__WEBPACK_IMPORTED_MODULE_8__.Global.timer)) {\n            clearTimeout(_base_util__WEBPACK_IMPORTED_MODULE_8__.Global.timer);\n        }\n        var target = e.target;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.loadingIndicator) && this.parent.loadingIndicator.indicatorType === 'Shimmer'\n            && (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(target, 'e-mask-ftrchk')) {\n            return;\n        }\n        var elem = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(target, 'e-checkbox-wrapper');\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(target, 'e-searchbox')) {\n            this.searchBoxClick(e);\n        }\n        if (elem && !this.isCheckboxFilterTemplate) {\n            var selectAll = elem.querySelector('.e-selectall');\n            if (selectAll) {\n                this.updateAllCBoxes(!selectAll.classList.contains('e-check'));\n            }\n            else {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.toogleCheckbox)(elem.parentElement);\n                if (this.infiniteRenderMod && !elem.parentElement.querySelector('.e-add-current')) {\n                    this.localInfiniteSelectionInteracted = true;\n                    var caseSen = this.options.allowCaseSensitive;\n                    var span = elem.parentElement.querySelector('.e-frame');\n                    var input = span.previousSibling;\n                    var optr = input.checked ? 'equal' : 'notequal';\n                    var pred = input.checked ? 'or' : 'and';\n                    var defaults = { field: this.options.field, predicate: pred, uid: this.options.uid,\n                        operator: optr, type: this.options.type, matchCase: caseSen, ignoreAccent: this.options.ignoreAccent\n                    };\n                    var value = this.values[(0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(input, 'e-ftrchk').getAttribute('uid')];\n                    this.updateInfiniteManualSelectPred(defaults, value);\n                    if (this.infiniteRenderMod && !this.options.isRemote && this.options.parentTotalDataCount\n                        && this.infiniteUnloadParentExistPred.length) {\n                        var predicate = this.getPredicateFromCols((_a = this.options.filteredColumns).concat.apply(_a, this.infiniteManualSelectMaintainPred), true);\n                        var query = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query();\n                        if (predicate) {\n                            query.where(predicate);\n                        }\n                        var result = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(this.infinitePermenantLocalData).executeLocal(query);\n                        if (this.options.parentTotalDataCount !== result.length) {\n                            this.options.parentTotalDataCount = result.length;\n                        }\n                        if (!this.options.parentTotalDataCount && this.infiniteUnloadParentExistPred.length) {\n                            this.infiniteUnloadParentExistPred = [];\n                        }\n                    }\n                    if (this.infiniteUnloadParentExistPred.length && (this.options.parentTotalDataCount === this.infiniteDataCount\n                        || !this.options.parentTotalDataCount)) {\n                        this.infiniteUnloadParentExistPred = [];\n                    }\n                }\n            }\n            this.updateIndeterminatenBtn();\n            elem.querySelector('.e-chk-hidden').focus();\n        }\n        this.setFocus((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(elem, 'e-ftrchk'));\n    };\n    CheckBoxFilterBase.prototype.updateInfiniteManualSelectPred = function (defaults, value) {\n        for (var i = 0; i < this.infiniteManualSelectMaintainPred.length; i++) {\n            var predmdl = this.infiniteManualSelectMaintainPred[i];\n            if (predmdl.value + '' === value + '' && (predmdl.operator === 'equal' || predmdl.operator === 'notequal')) {\n                this.infiniteManualSelectMaintainPred.splice(i, 1);\n                break;\n            }\n        }\n        if ((defaults.predicate === 'or' && (!this.localInfiniteSelectAllClicked || !this.infiniteLocalSelectAll))\n            || (defaults.predicate === 'and' && (!this.localInfiniteSelectAllClicked || this.infiniteLocalSelectAll))) {\n            this.infiniteManualSelectMaintainPred.push((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, { value: value }, defaults));\n            if (defaults.predicate === 'or') {\n                this.options.parentTotalDataCount++;\n            }\n            else {\n                this.options.parentTotalDataCount--;\n            }\n        }\n    };\n    /**\n     * Method to set the next target element on keyboard navigation using arrow keys.\n     *\n     * @param {KeyboardEventArgs} e - Defines the Keyboard event argument\n     * @param {HTMLElement[]} focusableElements - Defines the Focusable elements\n     * @returns {void}\n     */\n    CheckBoxFilterBase.prototype.focusNextOrPrev = function (e, focusableElements) {\n        var nextIndex = (e.key === 'ArrowUp') ? focusableElements.indexOf(document.activeElement) - 1\n            : focusableElements.indexOf(document.activeElement) + 1;\n        var nextElement = focusableElements[((nextIndex + focusableElements.length) % focusableElements.length)];\n        // Set focus on the next / previous element\n        if (nextElement) {\n            nextElement.focus();\n            var target = nextElement.classList.contains('e-chk-hidden') ? (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(nextElement, 'e-ftrchk') : nextElement;\n            this.setFocus(target);\n        }\n    };\n    CheckBoxFilterBase.prototype.keyupHandler = function (e) {\n        if (e.key === 'Tab' || ((e.key === 'ArrowUp' || e.key === 'ArrowDown') && !e.altKey)) {\n            this.setFocus((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.parentsUntil)(e.target, 'e-ftrchk'));\n        }\n        if ((e.key === 'ArrowUp' || e.key === 'ArrowDown') && !e.altKey && this.parent.filterSettings\n            && this.parent.filterSettings.type === 'CheckBox') {\n            e.preventDefault();\n            var focusableElements = Array.from(this.dlg.querySelectorAll('input, button, [tabindex]:not([tabindex=\"-1\"])'));\n            this.focusNextOrPrev(e, focusableElements);\n        }\n    };\n    CheckBoxFilterBase.prototype.setFocus = function (elem) {\n        var prevElem = this.dlg.querySelector('.e-chkfocus');\n        if (prevElem) {\n            prevElem.classList.remove('e-chkfocus');\n        }\n        if (elem && elem !== prevElem) {\n            elem.classList.add('e-chkfocus');\n        }\n    };\n    CheckBoxFilterBase.prototype.updateAllCBoxes = function (checked) {\n        if (this.infiniteRenderMod) {\n            this.localInfiniteSelectAllClicked = true;\n            this.infiniteLocalSelectAll = checked;\n            this.infiniteUnloadParentExistPred = [];\n            this.infiniteManualSelectMaintainPred = [];\n        }\n        var cBoxes = this.infiniteRenderMod ?\n            this.infiniteLoadedElem.map(function (arr) {\n                return arr.querySelector('.e-frame');\n            }) : [].slice.call(this.cBox.querySelectorAll('.e-frame:not(.e-add-current)'));\n        for (var _i = 0, cBoxes_1 = cBoxes; _i < cBoxes_1.length; _i++) {\n            var cBox = cBoxes_1[_i];\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.removeAddCboxClasses)(cBox, checked);\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.setChecked)(cBox.previousSibling, checked);\n        }\n    };\n    CheckBoxFilterBase.prototype.dialogOpen = function () {\n        if (this.parent.element.classList.contains('e-device')) {\n            this.dialogObj.element.querySelector('.e-input-group').classList.remove('e-input-focus');\n            if (!this.options.isResponsiveFilter) {\n                this.dialogObj.element.querySelector('.e-btn').focus();\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.createCheckbox = function (value, checked, data) {\n        var elem = checked ? this.cBoxTrue.cloneNode(true) :\n            this.cBoxFalse.cloneNode(true);\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.setChecked)(elem.querySelector('input'), checked);\n        var label = elem.querySelector('.e-label');\n        var dummyData = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.extendObjWithFn)({}, data, { column: this.options.column, parent: this.parent });\n        var innerText = this.options.disableHtmlEncode ? 'textContent' : 'innerHTML';\n        label[\"\" + innerText] = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value) && value.toString().length ?\n            this.parent.enableHtmlSanitizer ? _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.SanitizeHtmlHelper.sanitize(value) : value : this.getLocalizedLabel('Blanks');\n        var checkboxUid = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getUid)('cbox');\n        label.setAttribute('id', checkboxUid + 'cboxLabel');\n        elem.querySelector('input').setAttribute('aria-labelledby', label.id);\n        if (label.innerHTML === this.getLocalizedLabel('Blanks')) {\n            this.isBlanks = true;\n        }\n        if (typeof value === 'boolean') {\n            label.innerHTML = value === true ? this.getLocalizedLabel('FilterTrue') : this.getLocalizedLabel('FilterFalse');\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([label], ['e-checkboxfiltertext']);\n        if (this.options.template && data[this.options.column.field] !== this.getLocalizedLabel('SelectAll')\n            && data[this.options.column.field] !== this.getLocalizedLabel('AddCurrentSelection')) {\n            label.innerHTML = '';\n            var isReactCompiler = this.parent.isReact && this.options.column.filter\n                && typeof (this.options.column.filter.itemTemplate) !== 'string' &&\n                !(this.options.column.filter.itemTemplate.prototype && this.options.column.filter.itemTemplate.prototype.CSPTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var isReactChild = this.parent.parentDetails && this.parent.parentDetails.parentInstObj &&\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                this.parent.parentDetails.parentInstObj.isReact;\n            if (isReactCompiler || isReactChild) {\n                this.options.template(dummyData, this.parent, 'filterItemTemplate', null, null, null, label);\n                this.parent.renderTemplates();\n            }\n            else {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.appendChildren)(label, this.options.template(dummyData, this.parent, 'filterItemTemplate', null, null, null, null, this.parent.root));\n            }\n        }\n        return elem;\n    };\n    CheckBoxFilterBase.prototype.updateIndeterminatenBtn = function () {\n        var cnt = this.infiniteRenderMod ? this.infiniteLoadedElem.length : this.cBox.children.length - 1;\n        var className = [];\n        var disabled = false;\n        var elem = this.infiniteRenderMod ? this.sBox.querySelector('.e-selectall') : this.cBox.querySelector('.e-selectall');\n        var selected = this.infiniteRenderMod ? this.infiniteLoadedElem.filter(function (arr) { return arr.querySelector('.e-check'); }).length :\n            this.cBox.querySelectorAll('.e-check:not(.e-selectall):not(.e-add-current)').length;\n        if (this.cBox.querySelector('.e-add-current')) {\n            cnt -= 1;\n        }\n        var btn;\n        if (!this.options.isResponsiveFilter) {\n            btn = this.dialogObj.btnObj[0];\n            btn.disabled = false;\n        }\n        var input = elem.previousSibling;\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.setChecked)(input, false);\n        input.indeterminate = false;\n        if (this.infiniteRenderMod && this.sInput.value === '' && !this.options.parentCurrentViewDataCount && !this.localInfiniteSelectionInteracted\n            && (!this.localInfiniteSelectAllClicked || (!this.infiniteLocalSelectAll && !selected)) && (cnt !== selected || cnt === selected)) {\n            selected = 0;\n        }\n        else if (this.infiniteRenderMod && this.infiniteLoadedElem.length < this.infiniteDataCount\n            && this.infiniteUnloadParentExistPred.length && (!selected || cnt === selected) && this.infiniteLocalSelectAll) {\n            if (!selected) {\n                selected += this.infiniteUnloadParentExistPred.length;\n            }\n            else {\n                cnt += this.infiniteUnloadParentExistPred.length;\n            }\n        }\n        if (cnt === selected) {\n            if (this.infiniteRenderMod) {\n                this.infiniteLocalSelectAll = true;\n                this.localInfiniteSelectAllClicked = true;\n                this.infiniteManualSelectMaintainPred = [];\n            }\n            className = ['e-check'];\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.setChecked)(input, true);\n        }\n        else if (selected) {\n            className = ['e-stop'];\n            input.indeterminate = true;\n        }\n        else {\n            if (this.infiniteRenderMod) {\n                this.infiniteLocalSelectAll = false;\n                this.localInfiniteSelectAllClicked = true;\n                this.infiniteManualSelectMaintainPred = [];\n            }\n            className = ['e-uncheck'];\n            disabled = true;\n            if (btn) {\n                btn.disabled = true;\n            }\n        }\n        if (btn) {\n            this.filterState = !btn.disabled;\n            btn.dataBind();\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([elem], ['e-check', 'e-stop', 'e-uncheck']);\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([elem], className);\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.refreshCustomFilterOkBtn, { disabled: disabled });\n    };\n    CheckBoxFilterBase.prototype.createFilterItems = function (data, isInitial, args1) {\n        var _a, _b, _c;\n        var cBoxes = this.parent.createElement('div');\n        var btn;\n        var disabled = false;\n        if (!this.options.isResponsiveFilter) {\n            btn = this.dialogObj.btnObj[0];\n        }\n        var nullCounter = -1;\n        var key = 'ejValue';\n        if (!args1.executeQuery) {\n            key = args1.field;\n        }\n        for (var i = 0; i < data.length; i++) {\n            var val = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(key, data[parseInt(i.toString(), 10)]);\n            if (val === '' || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(val)) {\n                nullCounter = nullCounter + 1;\n            }\n        }\n        if (!this.infiniteRenderMod) {\n            this.itemsCnt = nullCounter !== -1 ? data.length - nullCounter : data.length;\n        }\n        if (this.infiniteRenderMod && this.parent.filterSettings && this.parent.filterSettings.loadingIndicator === 'Shimmer') {\n            this.removeMask();\n        }\n        if (data.length && !this.renderEmpty) {\n            var selectAllValue = this.getLocalizedLabel('SelectAll');\n            var innerDiv = this.cBox.querySelector('.e-checkfltrnmdiv');\n            if (innerDiv) {\n                innerDiv.classList.remove('e-checkfltrnmdiv');\n            }\n            var checkBox = this.createCheckbox(selectAllValue, false, (_a = {}, _a[this.options.field] = selectAllValue, _a));\n            if (this.parent.cssClass) {\n                if (this.parent.cssClass.indexOf(' ') !== -1) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([checkBox], this.parent.cssClass.split(' '));\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([checkBox], [this.parent.cssClass]);\n                }\n            }\n            if (this.infiniteInitialLoad || !this.infiniteRenderMod) {\n                var selectAll = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.createCboxWithWrap)((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getUid)('cbox'), checkBox, 'e-ftrchk');\n                selectAll.querySelector('.e-frame').classList.add('e-selectall');\n                if (this.infiniteRenderMod) {\n                    selectAll.classList.add('e-infinitescroll');\n                    if (this.parent.enableAdaptiveUI) {\n                        this.spinner.style.height = (this.spinner.offsetHeight - (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getListHeight)(this.cBox)) + 'px';\n                    }\n                    this.sBox.insertBefore(selectAll, this.spinner);\n                }\n                else {\n                    cBoxes.appendChild(selectAll);\n                }\n            }\n            else if (this.sBox.querySelector('.e-ftrchk .e-selectall')) {\n                this.sBox.querySelector('.e-ftrchk .e-selectall').previousSibling.disabled = false;\n                this.sBox.querySelector('.e-ftrchk .e-selectall').parentElement.classList.remove('e-checkbox-disabled');\n            }\n            var predicate = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Predicate('field', 'equal', this.options.field);\n            if (this.options.foreignKeyValue) {\n                predicate = predicate.or('field', 'equal', this.options.foreignKeyValue);\n            }\n            var isColFiltered = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(this.options.filteredColumns).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query().where(predicate)).length;\n            if (this.sInput && this.sInput.value) {\n                var predicateCheckBox = this.createCheckbox(this.getLocalizedLabel('AddCurrentSelection'), false, (_b = {},\n                    _b[this.options.field] = this.getLocalizedLabel('AddCurrentSelection'),\n                    _b));\n                if (this.parent.cssClass) {\n                    if (this.parent.cssClass.indexOf(' ') !== -1) {\n                        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([predicateCheckBox], this.parent.cssClass.split(' '));\n                    }\n                    else {\n                        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([predicateCheckBox], [this.parent.cssClass]);\n                    }\n                }\n                if ((this.infiniteRenderMod && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.sBox.children[2])\n                    && this.sBox.children[2].innerText !== this.getLocalizedLabel('AddCurrentSelection'))) || !this.infiniteRenderMod) {\n                    var predicateElement = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.createCboxWithWrap)((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getUid)('cbox'), predicateCheckBox, 'e-ftrchk');\n                    predicateElement.querySelector('.e-frame').classList.add('e-add-current');\n                    if (this.infiniteRenderMod) {\n                        predicateElement.classList.add('e-infinitescroll');\n                        this.sBox.insertBefore(predicateElement, this.spinner);\n                        var checkBoxListElem = this.spinner.querySelector('.e-checkboxlist');\n                        var reduceHeight = Math.ceil(predicateElement.getBoundingClientRect().height);\n                        checkBoxListElem.style.height = (parseInt(getComputedStyle(checkBoxListElem).height.split('px')[0], 10) - reduceHeight)\n                            + 'px';\n                        checkBoxListElem.style.minHeight = checkBoxListElem.style.height;\n                    }\n                    else {\n                        cBoxes.appendChild(predicateElement);\n                    }\n                }\n                else if (this.sBox.querySelector('.e-ftrchk .e-add-current')) {\n                    this.sBox.querySelector('.e-ftrchk .e-add-current').previousSibling.disabled = false;\n                    this.sBox.querySelector('.e-ftrchk .e-add-current').parentElement.classList.remove('e-checkbox-disabled');\n                }\n            }\n            else if (this.infiniteRenderMod && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.sBox.children[2])\n                && this.sBox.children[2].innerText === this.getLocalizedLabel('AddCurrentSelection')) {\n                var checkBoxListElem = this.spinner.querySelector('.e-checkboxlist');\n                var increaseHeight = Math.ceil(this.sBox.children[2].getBoundingClientRect().height);\n                checkBoxListElem.style.height = (parseInt(getComputedStyle(checkBoxListElem).height.split('px')[0], 10) + increaseHeight)\n                    + 'px';\n                checkBoxListElem.style.minHeight = checkBoxListElem.style.height;\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.sBox.children[2]);\n            }\n            var isRndere = void 0;\n            for (var i = 0; i < data.length; i++) {\n                var uid = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getUid)('cbox');\n                this.values[\"\" + uid] = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(key, data[parseInt(i.toString(), 10)]);\n                var value = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(this.options.field, data[parseInt(i.toString(), 10)]);\n                if (this.options.formatFn) {\n                    value = this.valueFormatter.toView(value, this.options.formatFn);\n                }\n                var args_1 = { value: value, column: this.options.column, data: data[parseInt(i.toString(), 10)] };\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.filterCboxValue, args_1);\n                value = args_1.value;\n                if ((value === '' || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value))) {\n                    if (isRndere) {\n                        continue;\n                    }\n                    isRndere = true;\n                }\n                if (this.infiniteRenderMod) {\n                    this.updateInfiniteUnLoadedCheckboxExistPred(value, this.infiniteUnloadParentExistPred);\n                }\n                var checkbox = this.localInfiniteSelectAllClicked ?\n                    this.createCheckbox(value, this.infiniteLocalSelectAll, (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)('dataObj', data[i])) :\n                    this.createCheckbox(value, this.getCheckedState(isColFiltered, this.values[\"\" + uid]), (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)('dataObj', data[i]));\n                cBoxes.appendChild((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.createCboxWithWrap)(uid, checkbox, 'e-ftrchk'));\n                if (this.infiniteRenderMod) {\n                    cBoxes.lastChild.style.height = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getListHeight)(this.cBox) + 'px';\n                }\n            }\n            var scrollTop = this.cBox.scrollTop;\n            if (!this.infiniteRenderMod || this.infiniteSearchValChange) {\n                this.cBox.innerHTML = '';\n            }\n            else if (this.infiniteRenderMod && this.cBox.children.length) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.infiniteRemoveElements)(([].slice.call(this.cBox.children)).splice(0, this.parent.filterSettings.itemsCount));\n            }\n            if (this.infiniteRenderMod) {\n                (_c = this.infiniteLoadedElem).push.apply(_c, [].slice.call(cBoxes.children));\n                this.itemsCnt = nullCounter !== -1 ? this.infiniteLoadedElem.length - nullCounter : this.infiniteLoadedElem.length;\n            }\n            if (this.infiniteUnloadParentExistPred.length && (this.infiniteLoadedElem.length >= this.infiniteDataCount\n                || !this.options.parentCurrentViewDataCount || (this.options.parentTotalDataCount === this.infiniteDataCount\n                && this.options.parentCurrentViewDataCount))) {\n                this.infiniteUnloadParentExistPred = [];\n            }\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.appendChildren)(this.cBox, [].slice.call(cBoxes.children));\n            if (this.infiniteRenderMod && !this.infiniteScrollAppendDiff) {\n                this.infiniteScrollAppendDiff = Math.round(scrollTop - this.cBox.scrollTop);\n            }\n            this.updateIndeterminatenBtn();\n            if (!this.infiniteRenderMod) {\n                if (btn) {\n                    btn.disabled = false;\n                }\n                disabled = false;\n            }\n            else {\n                if (btn && btn.disabled) {\n                    disabled = true;\n                }\n                else {\n                    disabled = false;\n                }\n            }\n        }\n        else {\n            cBoxes.appendChild(this.parent.createElement('span', { innerHTML: this.getLocalizedLabel('NoResult') }));\n            this.cBox.innerHTML = '';\n            if (this.infiniteRenderMod) {\n                var selectAll = this.sBox.querySelector('.e-ftrchk .e-selectall');\n                if (selectAll) {\n                    var selectAllParent = selectAll.parentElement.parentElement;\n                    if (selectAll.classList.contains('e-check')) {\n                        (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.toogleCheckbox)(selectAllParent);\n                    }\n                    else if (selectAll.classList.contains('e-stop')) {\n                        (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.toogleCheckbox)(selectAllParent);\n                        selectAll.classList.remove('e-stop');\n                        (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.toogleCheckbox)(selectAllParent);\n                    }\n                    selectAll.previousSibling.disabled = true;\n                    selectAll.parentElement.classList.add('e-checkbox-disabled');\n                }\n                var addCurrSelection = this.sBox.querySelector('.e-ftrchk .e-add-current');\n                if (addCurrSelection) {\n                    var addCurrSelectionParent = addCurrSelection.parentElement.parentElement;\n                    if (addCurrSelection.classList.contains('e-check')) {\n                        (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.toogleCheckbox)(addCurrSelectionParent);\n                    }\n                    addCurrSelection.previousSibling.disabled = true;\n                    addCurrSelection.parentElement.classList.add('e-checkbox-disabled');\n                }\n            }\n            this.cBox.appendChild(this.parent.createElement('div', { className: 'e-checkfltrnmdiv' }));\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.appendChildren)(this.cBox.children[0], [].slice.call(cBoxes.children));\n            if (btn) {\n                btn.disabled = true;\n            }\n            disabled = true;\n            this.filterState = !disabled;\n        }\n        if (btn && data.length) {\n            this.filterState = !btn.disabled;\n            btn.dataBind();\n        }\n        var args = { requestType: _base_constant__WEBPACK_IMPORTED_MODULE_4__.filterChoiceRequest, dataSource: this.renderEmpty ? [] : data };\n        var filterModel = 'filterModel';\n        args[\"\" + filterModel] = this;\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.cBoxFltrComplete, args);\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_4__.refreshCustomFilterOkBtn, { disabled: disabled });\n        if (this.infiniteRenderMod && this.infiniteInitialLoad) {\n            this.cBox.style.marginTop = '0px';\n        }\n        (0,_syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_9__.hideSpinner)(this.spinner);\n    };\n    CheckBoxFilterBase.prototype.updateInfiniteUnLoadedCheckboxExistPred = function (value, updatePredArr) {\n        for (var j = 0; j < updatePredArr.length; j++) {\n            var pred = updatePredArr[j];\n            var predValue = pred.value instanceof Date ?\n                this.valueFormatter.toView(pred.value, this.options.formatFn) : pred.value;\n            var column = this.options.column;\n            if (column.isForeignColumn()) {\n                var foreignDataObj = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getForeignData)(column, {}, predValue, this.foreignKeyData)[0];\n                value = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(column.foreignKeyField, foreignDataObj);\n            }\n            if (value === predValue && (pred.operator === 'equal' || pred.operator === 'notequal')) {\n                this.infiniteManualSelectMaintainPred.push(updatePredArr[j]);\n                updatePredArr.splice(j, 1);\n                j--;\n            }\n        }\n    };\n    CheckBoxFilterBase.prototype.getCheckedState = function (isColFiltered, value) {\n        if (!this.isFiltered || !isColFiltered) {\n            return true;\n        }\n        else {\n            var checkState = this.sInput && this.sInput.value ? true : this.result[\"\" + value];\n            if (this.infiniteRenderMod) {\n                return checkState;\n            }\n            else {\n                return this.options.operator === 'notequal' ? !checkState : checkState;\n            }\n        }\n    };\n    CheckBoxFilterBase.getDistinct = function (json, field, column, foreignKeyData, checkboxFilter) {\n        var len = json.length;\n        var result = [];\n        var value;\n        var ejValue = 'ejValue';\n        var lookup = {};\n        var isForeignKey = column && column.isForeignColumn ? column.isForeignColumn() : false;\n        while (len--) {\n            value = json[parseInt(len.toString(), 10)];\n            if (column && column.type === 'dateonly' && typeof value[\"\" + field] === 'string' && value[\"\" + field]) {\n                var arr = value[\"\" + field].split(/[^0-9.]/);\n                value[\"\" + field] = new Date(parseInt(arr[0], 10), parseInt(arr[1], 10) - 1, parseInt(arr[2], 10));\n            }\n            value = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getObject)(field, value); //local remote diff, check with mdu\n            var currentFilterValue = (typeof value === 'string') && !((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(checkboxFilter)) &&\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                !((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(checkboxFilter.parent)) && !((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(checkboxFilter.parent.filterSettings)) &&\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                !((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(checkboxFilter.parent.filterSettings.enableCaseSensitivity)) ? value.toLowerCase() : value;\n            if (!(currentFilterValue in lookup)) {\n                var obj = {};\n                obj[\"\" + ejValue] = value;\n                lookup[\"\" + currentFilterValue] = true;\n                if (isForeignKey) {\n                    var foreignDataObj = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getForeignData)(column, {}, value, foreignKeyData)[0];\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setValue)(_base_constant__WEBPACK_IMPORTED_MODULE_4__.foreignKeyData, foreignDataObj, json[parseInt(len.toString(), 10)]);\n                    value = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(column.foreignKeyValue, foreignDataObj);\n                }\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setValue)(field, (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value) ? null : value, obj);\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setValue)('dataObj', json[parseInt(len.toString(), 10)], obj);\n                result.push(obj);\n            }\n        }\n        return _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_10__.DataUtil.group(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_10__.DataUtil.sort(result, field, _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_10__.DataUtil.fnAscending), 'ejValue');\n    };\n    CheckBoxFilterBase.getPredicate = function (columns, isExecuteLocal) {\n        var cols = _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_10__.DataUtil.distinct(columns, 'field', true) || [];\n        var collection = [];\n        var pred = {};\n        for (var i = 0; i < cols.length; i++) {\n            collection = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(columns).executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Query().where('field', 'equal', cols[parseInt(i.toString(), 10)].field));\n            if (collection.length !== 0) {\n                pred[cols[parseInt(i.toString(), 10)].field] = CheckBoxFilterBase.generatePredicate(collection, isExecuteLocal);\n            }\n        }\n        return pred;\n    };\n    CheckBoxFilterBase.generatePredicate = function (cols, isExecuteLocal) {\n        var len = cols ? cols.length : 0;\n        var predicate;\n        var operate = 'or';\n        var first = CheckBoxFilterBase.updateDateFilter(cols[0]);\n        first.ignoreAccent = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(first.ignoreAccent) ? first.ignoreAccent : false;\n        if (first.type === 'date' || first.type === 'datetime' || first.type === 'dateonly') {\n            predicate = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getDatePredicate)(first, first.type, isExecuteLocal);\n        }\n        else {\n            predicate = first.ejpredicate ? first.ejpredicate :\n                new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Predicate(first.field, first.operator, first.value, !CheckBoxFilterBase.getCaseValue(first), first.ignoreAccent);\n        }\n        for (var p = 1; p < len; p++) {\n            cols[parseInt(p.toString(), 10)] = CheckBoxFilterBase.updateDateFilter(cols[parseInt(p.toString(), 10)]);\n            if (len > 2 && p > 1 && ((cols[p].predicate === 'or' && cols[p - 1].predicate === 'or')\n                || (cols[p].predicate === 'and' && cols[p - 1].predicate === 'and'))) {\n                if (cols[p].type === 'date' || cols[p].type === 'datetime' || cols[p].type === 'dateonly') {\n                    predicate.predicates.push((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getDatePredicate)(cols[parseInt(p.toString(), 10)], cols[p].type, isExecuteLocal));\n                }\n                else {\n                    predicate.predicates.push(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_1__.Predicate(cols[p].field, cols[parseInt(p.toString(), 10)].operator, cols[parseInt(p.toString(), 10)].value, !CheckBoxFilterBase.getCaseValue(cols[parseInt(p.toString(), 10)]), cols[parseInt(p.toString(), 10)].ignoreAccent));\n                }\n            }\n            else {\n                if (cols[p].type === 'date' || cols[p].type === 'datetime' || cols[p].type === 'dateonly') {\n                    if (cols[parseInt(p.toString(), 10)].predicate === 'and' && cols[parseInt(p.toString(), 10)].operator === 'equal') {\n                        predicate = predicate[\"\" + operate]((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getDatePredicate)(cols[parseInt(p.toString(), 10)], cols[parseInt(p.toString(), 10)].type, isExecuteLocal), cols[parseInt(p.toString(), 10)].type, cols[parseInt(p.toString(), 10)].ignoreAccent);\n                    }\n                    else {\n                        predicate = predicate[(cols[parseInt(p.toString(), 10)].predicate)]((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getDatePredicate)(cols[parseInt(p.toString(), 10)], cols[parseInt(p.toString(), 10)].type, isExecuteLocal), cols[parseInt(p.toString(), 10)].type, cols[parseInt(p.toString(), 10)].ignoreAccent);\n                    }\n                }\n                else {\n                    predicate = cols[parseInt(p.toString(), 10)].ejpredicate ?\n                        predicate[cols[parseInt(p.toString(), 10)]\n                            .predicate](cols[parseInt(p.toString(), 10)].ejpredicate) :\n                        predicate[(cols[parseInt(p.toString(), 10)].predicate)](cols[parseInt(p.toString(), 10)].field, cols[parseInt(p.toString(), 10)].operator, cols[parseInt(p.toString(), 10)].value, !CheckBoxFilterBase.getCaseValue(cols[parseInt(p.toString(), 10)]), cols[parseInt(p.toString(), 10)].ignoreAccent);\n                }\n            }\n        }\n        return predicate || null;\n    };\n    CheckBoxFilterBase.getCaseValue = function (filter) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(filter.matchCase)) {\n            if (filter.type === 'string' || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(filter.type) && typeof (filter.value) === 'string') {\n                return false;\n            }\n            else {\n                return true;\n            }\n        }\n        else {\n            return filter.matchCase;\n        }\n    };\n    CheckBoxFilterBase.updateDateFilter = function (filter) {\n        if ((filter.type === 'date' || filter.type === 'datetime' || filter.type === 'dateonly' || filter.value instanceof Date)) {\n            filter.type = filter.type || 'date';\n        }\n        return filter;\n    };\n    return CheckBoxFilterBase;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9jb21tb24vY2hlY2tib3gtZmlsdGVyLWJhc2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDOEk7QUFDdUM7QUFDbkY7QUFDbkI7QUFDdEI7QUFDZDtBQUNrQjtBQUNJO0FBQ2pCO0FBQ0Q7QUFDa0M7QUFDd0g7QUFDek07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsV0FBVztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyx1REFBSztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxxRUFBYztBQUNoRCx3QkFBd0IsdUVBQWMscUNBQXFDLDJCQUEyQjtBQUN0Ryx5QkFBeUIsdUVBQWMscUNBQXFDLDRCQUE0QjtBQUN4RztBQUNBLGdEQUFnRDtBQUNoRCxTQUFTO0FBQ1Q7QUFDQSxnREFBZ0Q7QUFDaEQsU0FBUztBQUNUO0FBQ0E7QUFDQSxZQUFZLDhEQUFRO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw4REFBUTtBQUN4QjtBQUNBO0FBQ0EsZ0JBQWdCLDhEQUFRO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsOERBQVk7QUFDcEIsUUFBUSw4REFBWTtBQUNwQiw2QkFBNkIsOERBQVE7QUFDckM7QUFDQTtBQUNBLFlBQVksOERBQVk7QUFDeEIsWUFBWSw4REFBWTtBQUN4QjtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhEQUFZO0FB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QUFDOUQ7QUFDQTtBQUNBLGtEQUFrRCwyREFBUztBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELDREQUFnQjtBQUM1RTtBQUNBO0FBQ0EsNEZBQTRGLDREQUFnQjtBQUM1RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksdUVBQWlCO0FBQzdCLDRDQUE0Qyx1RUFBaUI7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDNkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9jb21tb24vY2hlY2tib3gtZmlsdGVyLWJhc2UuanM/MGFjOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoICovXG5pbXBvcnQgeyBFdmVudEhhbmRsZXIsIGlzTnVsbE9yVW5kZWZpbmVkLCBleHRlbmQsIGNsYXNzTGlzdCwgYWRkQ2xhc3MsIHJlbW92ZUNsYXNzLCBCcm93c2VyLCBnZXRWYWx1ZSwgc2V0VmFsdWUgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBwYXJlbnRzVW50aWwsIGdldFVpZCwgYXBwZW5kQ2hpbGRyZW4sIGdldERhdGVQcmVkaWNhdGUsIGdldE9iamVjdCwgZXh0ZW5kT2JqV2l0aEZuLCBldmVudFByb21pc2UsIHNldENoZWNrZWQsIGNsZWFyUmVhY3RWdWVUZW1wbGF0ZXMsIHBhZFplcm8sIEdsb2JhbCB9IGZyb20gJy4uL2Jhc2UvdXRpbCc7XG5pbXBvcnQgeyByZW1vdmUsIGRlYm91bmNlLCBJbnRlcm5hdGlvbmFsaXphdGlvbiwgU2FuaXRpemVIdG1sSGVscGVyIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgRGF0YVV0aWwsIFF1ZXJ5LCBEYXRhTWFuYWdlciwgUHJlZGljYXRlIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWRhdGEnO1xuaW1wb3J0IHsgY3JlYXRlQ2hlY2tCb3ggfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYnV0dG9ucyc7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnLi4vYmFzZS9jb25zdGFudCc7XG5pbXBvcnQgeyBWYWx1ZUZvcm1hdHRlciB9IGZyb20gJy4uL3NlcnZpY2VzL3ZhbHVlLWZvcm1hdHRlcic7XG5pbXBvcnQgeyBnZXRGb3JlaWduRGF0YSwgcmVzZXREaWFsb2dBcHBlbmQgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0IHsgRGlhbG9nIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLXBvcHVwcyc7XG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1pbnB1dHMnO1xuaW1wb3J0IHsgY3JlYXRlU3Bpbm5lciwgaGlkZVNwaW5uZXIsIHNob3dTcGlubmVyIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLXBvcHVwcyc7XG5pbXBvcnQgeyBnZXRGaWx0ZXJNZW51UG9zdGlvbiwgdG9vZ2xlQ2hlY2tib3gsIGNyZWF0ZUNib3hXaXRoV3JhcCwgcmVtb3ZlQWRkQ2JveENsYXNzZXMsIGdldENvbHVtbkJ5Rm9yZWlnbktleVZhbHVlLCBnZXRMaXN0SGVpZ2h0LCBpbmZpbml0ZVJlbW92ZUVsZW1lbnRzLCBpbmZpbml0ZUFwcGVuZEVsZW1lbnRzIH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbi8qKlxuICogQGhpZGRlblxuICogYENoZWNrQm94RmlsdGVyQmFzZWAgbW9kdWxlIGlzIHVzZWQgdG8gaGFuZGxlIGZpbHRlcmluZyBhY3Rpb24uXG4gKi9cbnZhciBDaGVja0JveEZpbHRlckJhc2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IgZm9yIGNoZWNrYm94IGZpbHRlcmluZyBtb2R1bGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7SVhMRmlsdGVyfSBwYXJlbnQgLSBzcGVjaWZpZXMgdGhlIElYTEZpbHRlclxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBDaGVja0JveEZpbHRlckJhc2UocGFyZW50KSB7XG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXRBcmdzID0gbnVsbDtcbiAgICAgICAgdGhpcy5pc0V4ZWN1dGVMb2NhbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnF1ZXJ5RmlsdGVyZWRDb2x1bW4gPSBbXTtcbiAgICAgICAgdGhpcy5leGlzdGluZ1ByZWRpY2F0ZSA9IHt9O1xuICAgICAgICB0aGlzLmZvcmVpZ25LZXlRdWVyeSA9IG5ldyBRdWVyeSgpO1xuICAgICAgICAvKiogQGhpZGRlbiAqL1xuICAgICAgICB0aGlzLmZpbHRlclN0YXRlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy52YWx1ZXMgPSB7fTtcbiAgICAgICAgdGhpcy5yZW5kZXJFbXB0eSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzQ2hlY2tib3hGaWx0ZXJUZW1wbGF0ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmluZmluaXRlUmVuZGVyTW9kID0gZmFsc2U7XG4gICAgICAgIC8vIGZvciBpbmZpbml0ZSBzY3JvbGwgdWlcbiAgICAgICAgdGhpcy5pbmZpbml0ZUluaXRpYWxMb2FkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5maW5pdGVTZWFyY2hWYWxDaGFuZ2UgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pbmZpbml0ZVBlcm1lbmFudExvY2FsRGF0YSA9IFtdO1xuICAgICAgICB0aGlzLmluZmluaXRlUXVlcnlFeGVjdXRpb25QZW5kaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5maW5pdGVTa2lwQ250ID0gMDtcbiAgICAgICAgdGhpcy5pbmZpbml0ZVNjcm9sbEFwcGVuZERpZmYgPSAwO1xuICAgICAgICB0aGlzLnByZXZJbmZpbml0ZVNjcm9sbERpcmVjdGlvbiA9ICcnO1xuICAgICAgICB0aGlzLmluZmluaXRlTG9hZGVkRWxlbSA9IFtdO1xuICAgICAgICB0aGlzLmluZmluaXRlRGF0YUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5pbmZpbml0ZUxvY2FsU2VsZWN0QWxsID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sb2NhbEluZmluaXRlU2VsZWN0QWxsQ2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvY2FsSW5maW5pdGVTZWxlY3Rpb25JbnRlcmFjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5maW5pdGVNYW51YWxTZWxlY3RNYWludGFpblByZWQgPSBbXTtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHRoaXMuaWQgPSB0aGlzLnBhcmVudC5lbGVtZW50LmlkO1xuICAgICAgICB0aGlzLnZhbHVlRm9ybWF0dGVyID0gbmV3IFZhbHVlRm9ybWF0dGVyKHRoaXMucGFyZW50LmxvY2FsZSk7XG4gICAgICAgIHRoaXMuY0JveFRydWUgPSBjcmVhdGVDaGVja0JveCh0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50LCBmYWxzZSwgeyBjaGVja2VkOiB0cnVlLCBsYWJlbDogJyAnIH0pO1xuICAgICAgICB0aGlzLmNCb3hGYWxzZSA9IGNyZWF0ZUNoZWNrQm94KHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQsIGZhbHNlLCB7IGNoZWNrZWQ6IGZhbHNlLCBsYWJlbDogJyAnIH0pO1xuICAgICAgICB0aGlzLmNCb3hUcnVlLmluc2VydEJlZm9yZSh0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcsIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UtY2hrLWhpZGRlbicsIGF0dHJzOiB7IHR5cGU6ICdjaGVja2JveCcgfVxuICAgICAgICB9KSwgdGhpcy5jQm94VHJ1ZS5maXJzdENoaWxkKTtcbiAgICAgICAgdGhpcy5jQm94RmFsc2UuaW5zZXJ0QmVmb3JlKHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jywge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiAnZS1jaGstaGlkZGVuJywgYXR0cnM6IHsgJ3R5cGUnOiAnY2hlY2tib3gnIH1cbiAgICAgICAgfSksIHRoaXMuY0JveEZhbHNlLmZpcnN0Q2hpbGQpO1xuICAgICAgICB0aGlzLmNCb3hGYWxzZS5xdWVyeVNlbGVjdG9yKCcuZS1mcmFtZScpLmNsYXNzTGlzdC5hZGQoJ2UtdW5jaGVjaycpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlUnRsKSB7XG4gICAgICAgICAgICBhZGRDbGFzcyhbdGhpcy5jQm94VHJ1ZSwgdGhpcy5jQm94RmFsc2VdLCBbJ2UtcnRsJ10pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5jc3NDbGFzcykge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNzc0NsYXNzLmluZGV4T2YoJyAnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhZGRDbGFzcyhbdGhpcy5jQm94VHJ1ZSwgdGhpcy5jQm94RmFsc2VdLCB0aGlzLnBhcmVudC5jc3NDbGFzcy5zcGxpdCgnICcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFkZENsYXNzKFt0aGlzLmNCb3hUcnVlLCB0aGlzLmNCb3hGYWxzZV0sIFt0aGlzLnBhcmVudC5jc3NDbGFzc10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUud2lyZUV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmRsZywgJ2NsaWNrJywgdGhpcy5jbGlja0hhbmRsZXIsIHRoaXMpO1xuICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMuZGxnLCAna2V5dXAnLCB0aGlzLmtleXVwSGFuZGxlciwgdGhpcyk7XG4gICAgICAgIHRoaXMuc2VhcmNoSGFuZGxlciA9IGRlYm91bmNlKHRoaXMuc2VhcmNoQm94S2V5VXAsIDIwMCk7XG4gICAgICAgIHZhciBlbGVtID0gdGhpcy5kaWFsb2dPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1zZWFyY2hpbnB1dCcpO1xuICAgICAgICBpZiAoZWxlbSkge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZChlbGVtLCAna2V5dXAnLCB0aGlzLnNlYXJjaEhhbmRsZXIsIHRoaXMpO1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZChlbGVtLCAnaW5wdXQnLCB0aGlzLnNlYXJjaEhhbmRsZXIsIHRoaXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLnVuV2lyZUV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmRsZywgJ2NsaWNrJywgdGhpcy5jbGlja0hhbmRsZXIpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZGxnLCAna2V5dXAnLCB0aGlzLmtleXVwSGFuZGxlcik7XG4gICAgICAgIHZhciBlbGVtID0gdGhpcy5kaWFsb2dPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1zZWFyY2hpbnB1dCcpO1xuICAgICAgICBpZiAoZWxlbSkge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZShlbGVtLCAna2V5dXAnLCB0aGlzLnNlYXJjaEhhbmRsZXIpO1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZShlbGVtLCAnaW5wdXQnLCB0aGlzLnNlYXJjaEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmZvcmVpZ25LZXlGaWx0ZXIgPSBmdW5jdGlvbiAoYXJncywgZkNvbGwsIG1QcmVkaWNhdGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGZQcmVkaWNhdGUgPSB7fTtcbiAgICAgICAgdmFyIGZpbHRlckNvbGxlY3Rpb24gPSBbXTtcbiAgICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy5mb3JlaWduS2V5UXVlcnkuY2xvbmUoKTtcbiAgICAgICAgdGhpcy5vcHRpb25zLmNvbHVtbi5kYXRhU291cmNlLlxuICAgICAgICAgICAgZXhlY3V0ZVF1ZXJ5KHF1ZXJ5LndoZXJlKG1QcmVkaWNhdGUpKS50aGVuKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBfdGhpcy5vcHRpb25zLmNvbHVtbi5jb2x1bW5EYXRhID0gZS5yZXN1bHQ7XG4gICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5nZW5lcmF0ZVF1ZXJ5LCB7IHByZWRpY2F0ZTogZlByZWRpY2F0ZSwgY29sdW1uOiBfdGhpcy5vcHRpb25zLmNvbHVtbiB9KTtcbiAgICAgICAgICAgIGFyZ3MuZWpwcmVkaWNhdGUgPSBmUHJlZGljYXRlLnByZWRpY2F0ZS5wcmVkaWNhdGVzO1xuICAgICAgICAgICAgdmFyIGZwcmVkID0gZlByZWRpY2F0ZS5wcmVkaWNhdGUucHJlZGljYXRlcztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnByZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJDb2xsZWN0aW9uLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBmaWVsZDogZnByZWRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkLFxuICAgICAgICAgICAgICAgICAgICBwcmVkaWNhdGU6ICdvcicsXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoQ2FzZTogZnByZWRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlnbm9yZUNhc2UsXG4gICAgICAgICAgICAgICAgICAgIGlnbm9yZUFjY2VudDogZnByZWRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlnbm9yZUFjY2VudCxcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IGZwcmVkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5vcGVyYXRvcixcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZwcmVkW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogX3RoaXMub3B0aW9ucy50eXBlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhcmdzLmZpbHRlckNvbGxlY3Rpb24gPSBmaWx0ZXJDb2xsZWN0aW9uLmxlbmd0aCA/IGZpbHRlckNvbGxlY3Rpb24gOlxuICAgICAgICAgICAgICAgIGZDb2xsLmZpbHRlcihmdW5jdGlvbiAoY29sKSB7IHJldHVybiBjb2wuZmllbGQgPSBfdGhpcy5vcHRpb25zLmZpZWxkOyB9KTtcbiAgICAgICAgICAgIF90aGlzLm9wdGlvbnMuaGFuZGxlcihhcmdzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLnNlYXJjaEJveENsaWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1zZWFyY2hjbGVhcicpKSB7XG4gICAgICAgICAgICB0aGlzLnNJbnB1dC52YWx1ZSA9IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY2hrY2FuY2VsLWljb24nKSA/ICcnIDogdGhpcy5zSW5wdXQudmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0NoZWNrYm94RmlsdGVyVGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoJ3JlZnJlc2hDaGVja2JveCcsIHsgZXZlbnQ6IGUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hDaGVja2JveGVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlYXJjaEljb24oKTtcbiAgICAgICAgICAgIHRoaXMuc0lucHV0LmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuc2VhcmNoQm94S2V5VXAgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQodGhpcy5zSW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGUpIHx8IChlLmtleSAhPT0gJ0Fycm93VXAnICYmIGUua2V5ICE9PSAnQXJyb3dEb3duJyAmJiBlLmtleSAhPT0gJ1RhYicgJiYgIShlLmtleSA9PT0gJ1RhYicgJiYgZS5zaGlmdEtleSkpKSB7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LmxvYWRpbmdJbmRpY2F0b3IpICYmIHRoaXMucGFyZW50LmxvYWRpbmdJbmRpY2F0b3IuaW5kaWNhdG9yVHlwZSA9PT0gJ1NoaW1tZXInKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2hvd01hc2tSb3codW5kZWZpbmVkLCB0aGlzLmRpYWxvZ09iai5lbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmlzQ2hlY2tib3hGaWx0ZXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeSgncmVmcmVzaENoZWNrYm94JywgeyBldmVudDogZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaENoZWNrYm94ZXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VhcmNoSWNvbigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLnVwZGF0ZVNlYXJjaEljb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnNJbnB1dC52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLnNJY29uLCBbJ2UtY2hrY2FuY2VsLWljb24nXSwgWydlLXNlYXJjaC1pY29uJ10pO1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJy5lLWNoa2NhbmNlbC1pY29uJykpKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcuZS1jaGtjYW5jZWwtaWNvbicpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0aGlzLmxvY2FsZU9iai5nZXRDb25zdGFudCgnQ2xlYXInKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjbGFzc0xpc3QodGhpcy5zSWNvbiwgWydlLXNlYXJjaC1pY29uJ10sIFsnZS1jaGtjYW5jZWwtaWNvbiddKTtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcuZS1zZWFyY2hjbGVhci5lLXNlYXJjaC1pY29uJykpKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcuZS1zZWFyY2hjbGVhci5lLXNlYXJjaC1pY29uJykuc2V0QXR0cmlidXRlKCd0aXRsZScsIHRoaXMubG9jYWxlT2JqLmdldENvbnN0YW50KCdTZWFyY2gnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGxvY2FsaXplZCBsYWJlbCBieSBsb2NhbGUga2V5d29yZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSBEZWZpbmVzIGxvY2FsaXphdGlvbiBrZXlcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSAtIHJldHVybnMgbG9jYWxpemF0aW9uIGxhYmVsXG4gICAgICovXG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5nZXRMb2NhbGl6ZWRMYWJlbCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlT2JqLmdldENvbnN0YW50KGtleSk7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLnVwZGF0ZURhdGFTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkYXRhU291cmNlID0gdGhpcy5vcHRpb25zLmRhdGFTb3VyY2U7XG4gICAgICAgIHZhciBzdHIgPSAnb2JqZWN0JztcbiAgICAgICAgaWYgKCEoZGF0YVNvdXJjZSBpbnN0YW5jZW9mIERhdGFNYW5hZ2VyKSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhU291cmNlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHZhbGlkLXR5cGVvZlxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YVNvdXJjZSAhPT0gc3RyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgb2JqW3RoaXMub3B0aW9ucy5maWVsZF0gPSBkYXRhU291cmNlW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0gPSBvYmo7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLnVwZGF0ZU1vZGVsID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5leGlzdGluZ1ByZWRpY2F0ZSA9IG9wdGlvbnMuYWN0dWFsUHJlZGljYXRlIHx8IHt9O1xuICAgICAgICB0aGlzLm9wdGlvbnMuZGF0YVNvdXJjZSA9IG9wdGlvbnMuZGF0YVNvdXJjZTtcbiAgICAgICAgdGhpcy5vcHRpb25zLmRhdGFNYW5hZ2VyID0gb3B0aW9ucy5kYXRhTWFuYWdlciA/IG9wdGlvbnMuZGF0YU1hbmFnZXIgOiBvcHRpb25zLmRhdGFTb3VyY2U7XG4gICAgICAgIHRoaXMudXBkYXRlRGF0YVNvdXJjZSgpO1xuICAgICAgICB0aGlzLm9wdGlvbnMudHlwZSA9IG9wdGlvbnMudHlwZTtcbiAgICAgICAgdGhpcy5vcHRpb25zLmZvcm1hdCA9IG9wdGlvbnMuZm9ybWF0IHx8ICcnO1xuICAgICAgICB0aGlzLm9wdGlvbnMuaWdub3JlQWNjZW50ID0gb3B0aW9ucy5pZ25vcmVBY2NlbnQgfHwgZmFsc2U7XG4gICAgICAgIHRoaXMub3B0aW9ucy5maWx0ZXJlZENvbHVtbnMgPSBvcHRpb25zLmZpbHRlcmVkQ29sdW1ucyB8fCB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5jb2x1bW5zO1xuICAgICAgICB0aGlzLm9wdGlvbnMucXVlcnkgPSBvcHRpb25zLnF1ZXJ5IHx8IG5ldyBRdWVyeSgpO1xuICAgICAgICB0aGlzLm9wdGlvbnMuYWxsb3dDYXNlU2Vuc2l0aXZlID0gb3B0aW9ucy5hbGxvd0Nhc2VTZW5zaXRpdmUgfHwgZmFsc2U7XG4gICAgICAgIHRoaXMub3B0aW9ucy51aWQgPSBvcHRpb25zLmNvbHVtbi51aWQ7XG4gICAgICAgIHRoaXMub3B0aW9ucy5kaXNhYmxlSHRtbEVuY29kZSA9IG9wdGlvbnMuY29sdW1uLmRpc2FibGVIdG1sRW5jb2RlIHx8IGZhbHNlO1xuICAgICAgICB0aGlzLnZhbHVlcyA9IHt9O1xuICAgICAgICB0aGlzLmxvY2FsZU9iaiA9IG9wdGlvbnMubG9jYWxlT2JqO1xuICAgICAgICB0aGlzLmlzRmlsdGVyZWQgPSBvcHRpb25zLmZpbHRlcmVkQ29sdW1ucy5sZW5ndGg7XG4gICAgICAgIHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgPSB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncyAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgdGhpcy5pbmZpbml0ZVVubG9hZFBhcmVudEV4aXN0UHJlZCA9IHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgdGhpcy5leGlzdGluZ1ByZWRpY2F0ZVt0aGlzLm9wdGlvbnMuY29sdW1uLmZpZWxkXSA/IHRoaXMuZXhpc3RpbmdQcmVkaWNhdGVbdGhpcy5vcHRpb25zLmNvbHVtbi5maWVsZF0uc2xpY2UoKSA6IFtdO1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5nZXRBbmRTZXRDaGtFbGVtID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5kbGcgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICBpZDogdGhpcy5pZCArIHRoaXMub3B0aW9ucy50eXBlICsgJ19leGNlbERsZycsXG4gICAgICAgICAgICBhdHRyczogeyB1aWQ6IHRoaXMub3B0aW9ucy5jb2x1bW4udWlkIH0sXG4gICAgICAgICAgICBjbGFzc05hbWU6ICdlLWNoZWNrYm94ZmlsdGVyIGUtZmlsdGVyLXBvcHVwJ1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zQm94ID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLXNlYXJjaGNvbnRhaW5lcicgfSk7XG4gICAgICAgIGlmICghb3B0aW9ucy5oaWRlU2VhcmNoYm94KSB7XG4gICAgICAgICAgICB0aGlzLnNJbnB1dCA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jywge1xuICAgICAgICAgICAgICAgIGlkOiB0aGlzLmlkICsgJ19TZWFyY2hCb3gnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2Utc2VhcmNoaW5wdXQnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuc0ljb24gPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2Utc2VhcmNoY2xlYXIgZS1zZWFyY2gtaWNvbiBlLWljb25zIGUtaW5wdXQtZ3JvdXAtaWNvbicsIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywgdGl0bGU6IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwoJ1NlYXJjaCcpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaEJveCA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2Utc2VhcmNoYm94IGUtZmllbGRzJyB9KTtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoQm94LmFwcGVuZENoaWxkKHRoaXMuc0lucHV0KTtcbiAgICAgICAgICAgIHRoaXMuc0JveC5hcHBlbmRDaGlsZCh0aGlzLnNlYXJjaEJveCk7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaElucHV0QXJncyA9IHtcbiAgICAgICAgICAgICAgICBlbGVtZW50OiB0aGlzLnNJbnB1dCwgZmxvYXRMYWJlbFR5cGU6ICdOZXZlcicsIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwoJ1NlYXJjaCcpLFxuICAgICAgICAgICAgICAgICAgICBjc3NDbGFzczogdGhpcy5wYXJlbnQuY3NzQ2xhc3NcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgSW5wdXQuY3JlYXRlSW5wdXQodGhpcy5zZWFyY2hJbnB1dEFyZ3MsIHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQpO1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hCb3gucXVlcnlTZWxlY3RvcignLmUtaW5wdXQtZ3JvdXAnKS5hcHBlbmRDaGlsZCh0aGlzLnNJY29uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNwaW5uZXIgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2Utc3Bpbm5lcicgfSk7IC8vZm9yIHNwaW5uZXJcbiAgICAgICAgdGhpcy5jQm94ID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgaWQ6IHRoaXMuaWQgKyB0aGlzLm9wdGlvbnMudHlwZSArICdfQ2hlY2tCb3hMaXN0JyxcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UtY2hlY2tib3hsaXN0IGUtZmllbGRzJ1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zcGlubmVyLmFwcGVuZENoaWxkKHRoaXMuY0JveCk7XG4gICAgICAgIHRoaXMuc0JveC5hcHBlbmRDaGlsZCh0aGlzLnNwaW5uZXIpO1xuICAgICAgICByZXR1cm4gdGhpcy5zQm94O1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5zaG93RGlhbG9nID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICByZXF1ZXN0VHlwZTogZXZlbnRzLmZpbHRlckJlZm9yZU9wZW4sXG4gICAgICAgICAgICBjb2x1bW5OYW1lOiB0aGlzLm9wdGlvbnMuZmllbGQsIGNvbHVtblR5cGU6IHRoaXMub3B0aW9ucy50eXBlLCBjYW5jZWw6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIHZhciBmaWx0ZXJNb2RlbCA9ICdmaWx0ZXJNb2RlbCc7XG4gICAgICAgIGFyZ3NbXCJcIiArIGZpbHRlck1vZGVsXSA9IHRoaXM7XG4gICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMuY0JveEZsdHJCZWdpbiwgYXJncyk7XG4gICAgICAgIGlmIChhcmdzLmNhbmNlbCkge1xuICAgICAgICAgICAgb3B0aW9ucy5jYW5jZWwgPSBhcmdzLmNhbmNlbDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpYWxvZ09iaiA9IG5ldyBEaWFsb2coe1xuICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsIGNvbnRlbnQ6IHRoaXMuc0JveCxcbiAgICAgICAgICAgIGNsb3NlOiB0aGlzLmNsb3NlRGlhbG9nLmJpbmQodGhpcyksXG4gICAgICAgICAgICBlbmFibGVSdGw6IHRoaXMucGFyZW50LmVuYWJsZVJ0bCxcbiAgICAgICAgICAgIHdpZHRoOiAoIWlzTnVsbE9yVW5kZWZpbmVkKHBhcmVudHNVbnRpbChvcHRpb25zLnRhcmdldCwgJ2UtYmlnZ2VyJykpKVxuICAgICAgICAgICAgICAgIHx8IHRoaXMucGFyZW50LmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWRldmljZScpID8gMjYwIDogMjU1LFxuICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLnBhcmVudC5lbGVtZW50LCBhbmltYXRpb25TZXR0aW5nczogeyBlZmZlY3Q6ICdOb25lJyB9LFxuICAgICAgICAgICAgYnV0dG9uczogW3tcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IHRoaXMuYnRuQ2xpY2suYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uTW9kZWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwodGhpcy5pc0V4Y2VsID8gJ09LQnV0dG9uJyA6ICdGaWx0ZXJCdXR0b24nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzc0NsYXNzOiB0aGlzLnBhcmVudC5jc3NDbGFzcyA/ICdlLXByaW1hcnknICsgJyAnICsgdGhpcy5wYXJlbnQuY3NzQ2xhc3MgOiAnZS1wcmltYXJ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzUHJpbWFyeTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiB0aGlzLmJ0bkNsaWNrLmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbk1vZGVsOiB7IGNzc0NsYXNzOiB0aGlzLnBhcmVudC5jc3NDbGFzcyA/ICdlLWZsYXQnICsgJyAnICsgdGhpcy5wYXJlbnQuY3NzQ2xhc3MgOiAnZS1mbGF0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwodGhpcy5pc0V4Y2VsID8gJ0NhbmNlbEJ1dHRvbicgOiAnQ2xlYXJCdXR0b24nKSB9XG4gICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBjcmVhdGVkOiB0aGlzLmRpYWxvZ0NyZWF0ZWQuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIG9wZW46IHRoaXMuZGlhbG9nT3Blbi5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgY3NzQ2xhc3M6IHRoaXMucGFyZW50LmNzc0NsYXNzID8gdGhpcy5wYXJlbnQuY3NzQ2xhc3MgOiAnJ1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGlzU3RyaW5nVGVtcGxhdGUgPSAnaXNTdHJpbmdUZW1wbGF0ZSc7XG4gICAgICAgIHRoaXMuZGlhbG9nT2JqW1wiXCIgKyBpc1N0cmluZ1RlbXBsYXRlXSA9IHRydWU7XG4gICAgICAgIHRoaXMucmVuZGVyUmVzcG9uc2l2ZUZpbHRlcihvcHRpb25zKTtcbiAgICAgICAgdmFyIGRpYWxvZ0xhYmVsID0gdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MudHlwZSA9PT0gJ0NoZWNrQm94JyA/XG4gICAgICAgICAgICB0aGlzLmdldExvY2FsaXplZExhYmVsKCdDaGVja0JveEZpbHRlckRpYWxvZ0FSSUEnKSA6IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwoJ0V4Y2VsRmlsdGVyRGlhbG9nQVJJQScpO1xuICAgICAgICB0aGlzLmRsZy5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBkaWFsb2dMYWJlbCk7XG4gICAgICAgIGlmIChvcHRpb25zLmlzUmVzcG9uc2l2ZUZpbHRlcikge1xuICAgICAgICAgICAgdmFyIHJlc3BvbnNpdmVDbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZS1yZXNwb25zaXZlLWRpYWxvZyA+IC5lLWRsZy1jb250ZW50ID4gLmUtbWFpbmZpbHRlcmRpdicpO1xuICAgICAgICAgICAgcmVzcG9uc2l2ZUNudC5hcHBlbmRDaGlsZCh0aGlzLmRsZyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuZGxnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpYWxvZ09iai5hcHBlbmRUbyh0aGlzLmRsZyk7XG4gICAgICAgIHRoaXMuZGlhbG9nT2JqLmVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gb3B0aW9ucy5pc1Jlc3BvbnNpdmVGaWx0ZXIgPyAnbm9uZScgOiB0aGlzLm9wdGlvbnMuaGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgdGhpcy5kaWFsb2dPYmouc2hvdygpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MgJiYgKHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLnR5cGUgPT09ICdDaGVja0JveCdcbiAgICAgICAgICAgIHx8ICh0aGlzLm9wdGlvbnMuY29sdW1uICYmIHRoaXMub3B0aW9ucy5jb2x1bW4uZmlsdGVyICYmIHRoaXMub3B0aW9ucy5jb2x1bW4uZmlsdGVyLnR5cGUgPT09ICdDaGVja0JveCcpKSAmJlxuICAgICAgICAgICAgdGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLmZpcnN0RWxlbWVudENoaWxkLm9mZnNldEhlaWdodCA8IHRoaXMuZGlhbG9nT2JqLmVsZW1lbnQub2Zmc2V0SGVpZ2h0ICYmXG4gICAgICAgICAgICAhcGFyZW50c1VudGlsKHRoaXMucGFyZW50LmVsZW1lbnQsICdlLWdhbnR0LWRpYWxvZycpKSB7XG4gICAgICAgICAgICByZXNldERpYWxvZ0FwcGVuZCh0aGlzLnBhcmVudCwgdGhpcy5kaWFsb2dPYmopO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5kaWFsb2dPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1kbGctY29udGVudCcpO1xuICAgICAgICBjb250ZW50LmFwcGVuZENoaWxkKHRoaXMuc0JveCk7XG4gICAgICAgIHRoaXMud2lyZUV2ZW50cygpO1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50LmVuYWJsZUFkYXB0aXZlVUkpIHtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQubG9hZGluZ0luZGljYXRvcikgJiYgdGhpcy5wYXJlbnQubG9hZGluZ0luZGljYXRvci5pbmRpY2F0b3JUeXBlID09PSAnU2hpbW1lcidcbiAgICAgICAgICAgICAgICAmJiAhdGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnNob3dNYXNrUm93KHVuZGVmaW5lZCwgdGhpcy5kaWFsb2dPYmouZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncyAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5sb2FkaW5nSW5kaWNhdG9yID09PSAnU2hpbW1lcicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dNYXNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncyAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5sb2FkaW5nSW5kaWNhdG9yID09PSAnU2hpbW1lcicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdldEFsbERhdGEoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY0JveC5zdHlsZS5tYXJnaW5Ub3AgPSBnZXRMaXN0SGVpZ2h0KHRoaXMuY0JveCkgKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MubG9hZGluZ0luZGljYXRvciA9PT0gJ1NoaW1tZXInKSkge1xuICAgICAgICAgICAgY3JlYXRlU3Bpbm5lcih7IHRhcmdldDogdGhpcy5zcGlubmVyLCBjc3NDbGFzczogdGhpcy5wYXJlbnQuY3NzQ2xhc3MgPyB0aGlzLnBhcmVudC5jc3NDbGFzcyA6IG51bGwgfSwgdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCk7XG4gICAgICAgICAgICBzaG93U3Bpbm5lcih0aGlzLnNwaW5uZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ2V0QWxsRGF0YSgpO1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5yZW5kZXJSZXNwb25zaXZlRmlsdGVyID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuaXNSZXNwb25zaXZlRmlsdGVyKSB7XG4gICAgICAgICAgICB0aGlzLmRpYWxvZ09iai5idXR0b25zID0gW3t9XTtcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nT2JqLnBvc2l0aW9uID0geyBYOiAnJywgWTogJycgfTtcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nT2JqLnRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXJlc2ZpbHRlciA+IC5lLWRsZy1jb250ZW50ID4gLmUtbWFpbmZpbHRlcmRpdicpO1xuICAgICAgICAgICAgdGhpcy5kaWFsb2dPYmoud2lkdGggPSAnMTAwJSc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuZGlhbG9nQ3JlYXRlZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaXNSZXNwb25zaXZlRmlsdGVyKSB7XG4gICAgICAgICAgICB0aGlzLmRpYWxvZ09iai5lbGVtZW50LnN0eWxlLmxlZnQgPSAnMHB4JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICghQnJvd3Nlci5pc0RldmljZSkge1xuICAgICAgICAgICAgICAgIGdldEZpbHRlck1lbnVQb3N0aW9uKHRoaXMub3B0aW9ucy50YXJnZXQsIHRoaXMuZGlhbG9nT2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nT2JqLnBvc2l0aW9uID0geyBYOiAnY2VudGVyJywgWTogJ2NlbnRlcicgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNvbHVtbi5zaG93Q29sdW1uTWVudSkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5maWx0ZXJEaWFsb2dDcmVhdGVkLCBlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5vcGVuRGlhbG9nID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy51cGRhdGVNb2RlbChvcHRpb25zKTtcbiAgICAgICAgdGhpcy5nZXRBbmRTZXRDaGtFbGVtKG9wdGlvbnMpO1xuICAgICAgICB0aGlzLnNob3dEaWFsb2cob3B0aW9ucyk7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmNsb3NlRGlhbG9nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCAmJiB0aGlzLmluZmluaXRlUGVybWVuYW50TG9jYWxEYXRhLmxlbmd0aCAmJiAhdGhpcy5vcHRpb25zLmlzUmVtb3RlKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuZGF0YVNvdXJjZS5kYXRhU291cmNlLmpzb24gPSB0aGlzLmluZmluaXRlUGVybWVuYW50TG9jYWxEYXRhO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRpYWxvZ09iaiAmJiAhdGhpcy5kaWFsb2dPYmouaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuaXNCbGFua3MgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBmaWx0ZXJUZW1wbGF0ZUNvbCA9IHRoaXMub3B0aW9ucy5jb2x1bW5zLmZpbHRlcihmdW5jdGlvbiAoY29sKSB7IHJldHVybiBjb2wuZ2V0RmlsdGVySXRlbVRlbXBsYXRlKCk7IH0pO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIHZhciByZWdpc3RlcmVkVGVtcGxhdGUgPSB0aGlzLnBhcmVudC5yZWdpc3RlcmVkVGVtcGxhdGU7XG4gICAgICAgICAgICBpZiAoZmlsdGVyVGVtcGxhdGVDb2wubGVuZ3RoICYmICFpc051bGxPclVuZGVmaW5lZChyZWdpc3RlcmVkVGVtcGxhdGUpICYmIHJlZ2lzdGVyZWRUZW1wbGF0ZS5maWx0ZXJJdGVtVGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5kZXN0cm95VGVtcGxhdGUoWydmaWx0ZXJJdGVtVGVtcGxhdGUnXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKHRoaXMucGFyZW50LmlzUmVhY3QgfHwgdGhpcy5wYXJlbnQuaXNWdWUpICYmIHRoaXMucGFyZW50LmRlc3Ryb3lUZW1wbGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJSZWFjdFZ1ZVRlbXBsYXRlcyh0aGlzLnBhcmVudCwgWydmaWx0ZXJJdGVtVGVtcGxhdGUnXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmZpbHRlck1lbnVDbG9zZSwgeyBmaWVsZDogdGhpcy5vcHRpb25zLmZpZWxkIH0pO1xuICAgICAgICAgICAgdGhpcy51bldpcmVFdmVudHMoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaElucHV0QXJncyAmJiB0aGlzLnNlYXJjaElucHV0QXJncy5lbGVtZW50ICYmIHRoaXMuc2VhcmNoSW5wdXRBcmdzLmVsZW1lbnQucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIElucHV0LmRlc3Ryb3kodGhpcy5zZWFyY2hJbnB1dEFyZ3MpO1xuICAgICAgICAgICAgICAgIHJlbW92ZSh0aGlzLnNlYXJjaElucHV0QXJncy5lbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VhcmNoSW5wdXRBcmdzID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuc0lucHV0ID0gbnVsbDtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pc1JlYWN0ICYmIHRoaXMub3B0aW9ucy5jb2x1bW4uZmlsdGVyICYmIHR5cGVvZiAodGhpcy5vcHRpb25zLmNvbHVtbi5maWx0ZXIuaXRlbVRlbXBsYXRlKSAhPT0gJ3N0cmluZydcbiAgICAgICAgICAgICAgICAmJiAodGhpcy5vcHRpb25zLmNvbHVtbi5maWx0ZXIudHlwZSA9PT0gJ0NoZWNrQm94JyB8fCB0aGlzLm9wdGlvbnMuY29sdW1uLmZpbHRlci50eXBlID09PSAnRXhjZWwnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZGxnLWNvbnRlbnQnKS5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZGlhbG9nT2JqLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRpYWxvZ09ialsnZGxnQ2xvc2VkQnknXSA9PT0gJ2VzY2FwZScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5pc0NvbHVtbk1lbnVGaWx0ZXJDbG9zaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmRsZyAmJiB0aGlzLmRsZy5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlKHRoaXMuZGxnKTtcbiAgICAgICAgICAgICAgICB2YXIgZ3JpZFBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5wYXJlbnQuZWxlbWVudC5pZCArICdfZS1wb3B1cCcpO1xuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZ3JpZFBvcHVwKSkge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmUoZ3JpZFBvcHVwKTtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZFBvcHVwID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRsZyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmZpbHRlckRpYWxvZ0Nsb3NlLCB7fSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Q29sdW1ufSBjb2wgLSBEZWZpbmVzIGNvbHVtbiBkZXRhaWxzXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuY2xlYXJGaWx0ZXIgPSBmdW5jdGlvbiAoY29sKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGVuXG4gICAgICAgIHZhciBhcmdzID0geyBpbnN0YW5jZTogdGhpcywgaGFuZGxlcjogdGhpcy5jbGVhckZpbHRlciwgY2FuY2VsOiBmYWxzZSB9O1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmZsdHJQcmV2ZW50LCBhcmdzKTtcbiAgICAgICAgaWYgKGFyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vcHRpb25zLmhhbmRsZXIoeyBhY3Rpb246ICdjbGVhci1maWx0ZXInLCBmaWVsZDogY29sID8gY29sLmZpZWxkIDogdGhpcy5vcHRpb25zLmZpZWxkIH0pO1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5idG5DbGljayA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0aGlzLmZpbHRlclN0YXRlKSB7XG4gICAgICAgICAgICBpZiAoKGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0JyAmJiBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2Utc2VhcmNoaW5wdXQnKSkgfHxcbiAgICAgICAgICAgICAgICBlLmtleUNvZGUgPT09IDEzKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzQ2hlY2tib3hGaWx0ZXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZsdHJCdG5IYW5kbGVyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHRleHQgPSBlLnRhcmdldC5maXJzdENoaWxkLnRleHRDb250ZW50LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwodGhpcy5pc0V4Y2VsID8gJ09LQnV0dG9uJyA6ICdGaWx0ZXJCdXR0b24nKS50b0xvd2VyQ2FzZSgpID09PSB0ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0NoZWNrYm94RmlsdGVyVGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmx0ckJ0bkhhbmRsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmdldExvY2FsaXplZExhYmVsKCdDbGVhckJ1dHRvbicpLnRvTG93ZXJDYXNlKCkgPT09IHRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhckZpbHRlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChlLnRhcmdldCAmJiBlLnRhcmdldC5maXJzdENoaWxkICYmXG4gICAgICAgICAgICBlLnRhcmdldC5maXJzdENoaWxkLnRleHRDb250ZW50LnRvTG93ZXJDYXNlKCkgPT09IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwoJ0NhbmNlbEJ1dHRvbicpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghKGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0JykpIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJGaWx0ZXIoKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNvbHVtbi5zaG93Q29sdW1uTWVudSkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5hZnRlckZpbHRlckNvbHVtbk1lbnVDbG9zZSwge30pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuZm9jdXNNb2R1bGUpKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5mb2N1c01vZHVsZS5maWx0ZXJmb2N1cygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5mbHRyQnRuSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgIHRoaXMuY0JveC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIGFwcGVuZENoaWxkcmVuKHRoaXMuY0JveCwgdGhpcy5pbmZpbml0ZUxvYWRlZEVsZW0uc2xpY2UoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoZWNrZWQgPSBbXS5zbGljZS5jYWxsKHRoaXMuY0JveC5xdWVyeVNlbGVjdG9yQWxsKCcuZS1jaGVjazpub3QoLmUtc2VsZWN0YWxsKTpub3QoLmUtYWRkLWN1cnJlbnQpJykpO1xuICAgICAgICB2YXIgY2hlY2sgPSBjaGVja2VkO1xuICAgICAgICB2YXIgb3B0ciA9ICdlcXVhbCc7XG4gICAgICAgIHZhciBkZGxWYWx1ZSA9IHRoaXMuZGlhbG9nT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZHJvcGRvd25saXN0Jyk7XG4gICAgICAgIGlmIChkZGxWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9wZXJhdG9yID0gb3B0ciA9IGRkbFZhbHVlLmVqMl9pbnN0YW5jZXNbMF0udmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc01lbnVOb3RFcXVhbCA9IHRoaXMub3B0aW9ucy5vcGVyYXRvciA9PT0gJ25vdGVxdWFsJztcbiAgICAgICAgdmFyIHNlYXJjaElucHV0O1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5oaWRlU2VhcmNoYm94KSB7XG4gICAgICAgICAgICBzZWFyY2hJbnB1dCA9IHRoaXMuc2VhcmNoQm94LnF1ZXJ5U2VsZWN0b3IoJy5lLXNlYXJjaGlucHV0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNhc2VTZW4gPSB0aGlzLm9wdGlvbnMuYWxsb3dDYXNlU2Vuc2l0aXZlO1xuICAgICAgICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgICAgICAgICBmaWVsZDogdGhpcy5vcHRpb25zLmZpZWxkLCBwcmVkaWNhdGU6IHRoaXMuaXNNZW51Tm90RXF1YWwgPyAnYW5kJyA6ICdvcicsIHVpZDogdGhpcy5vcHRpb25zLnVpZCxcbiAgICAgICAgICAgIG9wZXJhdG9yOiBvcHRyLCB0eXBlOiB0aGlzLm9wdGlvbnMudHlwZSwgbWF0Y2hDYXNlOiBjYXNlU2VuLCBpZ25vcmVBY2NlbnQ6IHRoaXMub3B0aW9ucy5pZ25vcmVBY2NlbnRcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGlzTm90RXF1YWwgPSB0aGlzLml0ZW1zQ250ICE9PSBjaGVja2VkLmxlbmd0aCAmJiB0aGlzLml0ZW1zQ250IC0gY2hlY2tlZC5sZW5ndGggPCBjaGVja2VkLmxlbmd0aDtcbiAgICAgICAgaWYgKGlzTm90RXF1YWwgJiYgc2VhcmNoSW5wdXQgJiYgc2VhcmNoSW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgICAgICAgICBvcHRyID0gdGhpcy5pc01lbnVOb3RFcXVhbCA/ICdlcXVhbCcgOiAnbm90ZXF1YWwnO1xuICAgICAgICAgICAgY2hlY2tlZCA9IFtdLnNsaWNlLmNhbGwodGhpcy5jQm94LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXVuY2hlY2s6bm90KC5lLXNlbGVjdGFsbCknKSk7XG4gICAgICAgICAgICBkZWZhdWx0cy5wcmVkaWNhdGUgPSB0aGlzLmlzTWVudU5vdEVxdWFsID8gJ29yJyA6ICdhbmQnO1xuICAgICAgICAgICAgZGVmYXVsdHMub3BlcmF0b3IgPSBvcHRyO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWw7XG4gICAgICAgIHZhciBsZW5ndGg7XG4gICAgICAgIHZhciBjb2xsID0gW107XG4gICAgICAgIGlmICgoY2hlY2tlZC5sZW5ndGggIT09IHRoaXMuaXRlbXNDbnQgfHwgKHNlYXJjaElucHV0ICYmIHNlYXJjaElucHV0LnZhbHVlICYmIHNlYXJjaElucHV0LnZhbHVlICE9PSAnJykpXG4gICAgICAgICAgICB8fCB0aGlzLmluZmluaXRlUmVuZGVyTW9kKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgICAgICBjb2xsID0gdGhpcy5jb21wbGV4UXVlcnlQcmVkaWNhdGUoY2hlY2tlZCwgZGVmYXVsdHMsIGlzTm90RXF1YWwpO1xuICAgICAgICAgICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChjb2xsKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbGwgPSB0aGlzLmZpbHRlclByZXZlbnRDb2x1bW5zID8gdGhpcy5maWx0ZXJQcmV2ZW50Q29sdW1ucyA6IGNvbGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmluZmluaXRlUmVuZGVyTW9kICYmXG4gICAgICAgICAgICAgICAgKCF0aGlzLmluZmluaXRlU2VhcmNoUHJlZCB8fCAodGhpcy5pbmZpbml0ZVNlYXJjaFByZWQgJiYgIXRoaXMuaW5maW5pdGVTZWFyY2hQcmVkLmlzQ29tcGxleCkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmZpbml0ZUZsdHJCdG5IYW5kbGVyKGNvbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVTZWFyY2hQcmVkLmlzQ29tcGxleCkge1xuICAgICAgICAgICAgICAgICAgICBjb2xsID0gdGhpcy5jb21wbGV4UXVlcnlQcmVkaWNhdGUoY2hlY2tlZCwgZGVmYXVsdHMsIGlzTm90RXF1YWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgodGhpcy5vcHRpb25zLnR5cGUgPT09ICdkYXRlJyB8fCB0aGlzLm9wdGlvbnMudHlwZSA9PT0gJ2RhdGVvbmx5JyB8fCB0aGlzLm9wdGlvbnMudHlwZSA9PT0gJ2RhdGV0aW1lJykgJiYgY2hlY2subGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gY2hlY2subGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICB2YWwgPSB0aGlzLnZhbHVlc1twYXJlbnRzVW50aWwoY2hlY2tbcGFyc2VJbnQobGVuZ3RoLnRvU3RyaW5nKCksIDEwKV0sICdlLWZ0cmNoaycpLmdldEF0dHJpYnV0ZSgndWlkJyldO1xuICAgICAgICAgICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZCh2YWwpICYmIGlzTm90RXF1YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sbC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiBkZWZhdWx0cy5maWVsZCwgbWF0Y2hDYXNlOiBkZWZhdWx0cy5tYXRjaENhc2UsIG9wZXJhdG9yOiAnZXF1YWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlZGljYXRlOiAnb3InLCB2YWx1ZTogbnVsbFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYWRkQ3VyclNlbGVjdGlvbiA9IHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgPyB0aGlzLnNCb3gucXVlcnlTZWxlY3RvcignLmUtYWRkLWN1cnJlbnQnKSA6XG4gICAgICAgICAgICAgICAgdGhpcy5jQm94LnF1ZXJ5U2VsZWN0b3IoJy5lLWFkZC1jdXJyZW50Jyk7XG4gICAgICAgICAgICBpZiAoYWRkQ3VyclNlbGVjdGlvbiAmJiBhZGRDdXJyU2VsZWN0aW9uLmNsYXNzTGlzdC5jb250YWlucygnZS1jaGVjaycpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nUHJlZGljYXRlXzEgPSB0aGlzLmV4aXN0aW5nUHJlZGljYXRlW3RoaXMub3B0aW9ucy5maWVsZF07XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nUHJlZGljYXRlXzEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb2xsLnNvbWUoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudmFsdWUgPT09IGV4aXN0aW5nUHJlZGljYXRlXzFbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xsLnB1c2goZXhpc3RpbmdQcmVkaWNhdGVfMVtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGV4aXN0aW5nUHJlZGljYXRlXzEubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb29wXzEoaik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYXRlRmlsdGVyKGNvbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29sbC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYXRlRmlsdGVyKGNvbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5zQm94LnF1ZXJ5U2VsZWN0b3IoJy5lLXNlbGVjdGFsbCcpLmNsYXNzTGlzdC5jb250YWlucygnZS1jaGVjaycpICYmICFjb2xsLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciBpc0NsZWFyRmlsdGVyID0gdGhpcy5vcHRpb25zLmZpbHRlcmVkQ29sdW1ucy5zb21lKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMub3B0aW9ucy5maWVsZCA9PT0gdmFsdWUuZmllbGQ7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzQ2xlYXJGaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhckZpbHRlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpc0NsZWFyRmlsdGVyID0gdGhpcy5vcHRpb25zLmZpbHRlcmVkQ29sdW1ucy5zb21lKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5vcHRpb25zLmZpZWxkID09PSB2YWx1ZS5maWVsZDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGlzQ2xlYXJGaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyRmlsdGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuY29tcGxleFF1ZXJ5UHJlZGljYXRlID0gZnVuY3Rpb24gKGNoZWNrQm94Q2hlY2tlZCwgZGVmYXVsdHMsIGlzTm90RXF1YWwpIHtcbiAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICB2YXIgZk9iajtcbiAgICAgICAgdmFyIGNvbGwgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGVja0JveENoZWNrZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhbHVlID0gdGhpcy52YWx1ZXNbcGFyZW50c1VudGlsKGNoZWNrQm94Q2hlY2tlZFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sICdlLWZ0cmNoaycpLmdldEF0dHJpYnV0ZSgndWlkJyldO1xuICAgICAgICAgICAgZk9iaiA9IGV4dGVuZCh7fSwgeyB2YWx1ZTogdmFsdWUgfSwgZGVmYXVsdHMpO1xuICAgICAgICAgICAgaWYgKHZhbHVlICYmICF2YWx1ZS50b1N0cmluZygpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGZPYmoub3BlcmF0b3IgPSBpc05vdEVxdWFsID8gJ25vdGVxdWFsJyA6ICdlcXVhbCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09ICcnIHx8IGlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGNvbGwgPSBjb2xsLmNvbmNhdChDaGVja0JveEZpbHRlckJhc2UuZ2VuZXJhdGVOdWxsVmFsdWVQcmVkaWNhdGVzKGRlZmF1bHRzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb2xsLnB1c2goZk9iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbHRlckNvbHVtbnMgPSB0aGlzLmZpbHRlclByZXZlbnRDb2x1bW5zICYmIHRoaXMuZmlsdGVyUHJldmVudENvbHVtbnMubGVuZ3RoID9cbiAgICAgICAgICAgIHRoaXMuZmlsdGVyUHJldmVudENvbHVtbnNbMF0gOiBmT2JqO1xuICAgICAgICBpZiAoZmlsdGVyQ29sdW1ucyAmJiAhdGhpcy5ub3RpZnlGaWx0ZXJQcmV2RXZlbnQoZmlsdGVyQ29sdW1ucykpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyUHJldmVudENvbHVtbnMgPSBjb2xsO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gY29sbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5pbmZpbml0ZUZsdHJCdG5IYW5kbGVyID0gZnVuY3Rpb24gKGNvbGwpIHtcbiAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICBpZiAodGhpcy5pbmZpbml0ZU1hbnVhbFNlbGVjdE1haW50YWluUHJlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5pbmZpbml0ZU1hbnVhbFNlbGVjdE1haW50YWluUHJlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBwcmVkID0gdGhpcy5pbmZpbml0ZU1hbnVhbFNlbGVjdE1haW50YWluUHJlZFtpXTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHByZWQudmFsdWUgKyAnJztcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09ICcnIHx8IGlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZHVtbXlEZWZhdWx0cyA9IHsgcHJlZGljYXRlOiBwcmVkLnByZWRpY2F0ZSwgZmllbGQ6IHByZWQuZmllbGQsIHR5cGU6IHByZWQudHlwZSwgdWlkOiBwcmVkLnVpZCwgb3BlcmF0b3I6IHByZWQub3BlcmF0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaENhc2U6IHByZWQubWF0Y2hDYXNlLCBpZ25vcmVBY2NlbnQ6IHByZWQuaWdub3JlQWNjZW50IH07XG4gICAgICAgICAgICAgICAgICAgIGNvbGwucHVzaC5hcHBseShjb2xsLCBDaGVja0JveEZpbHRlckJhc2UuZ2VuZXJhdGVOdWxsVmFsdWVQcmVkaWNhdGVzKGR1bW15RGVmYXVsdHMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbGwucHVzaCh0aGlzLmluZmluaXRlTWFudWFsU2VsZWN0TWFpbnRhaW5QcmVkW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlGaWx0ZXJQcmV2RXZlbnQodGhpcy5pbmZpbml0ZU1hbnVhbFNlbGVjdE1haW50YWluUHJlZFtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmxvY2FsSW5maW5pdGVTZWxlY3RBbGxDbGlja2VkICYmIHRoaXMuc0lucHV0LnZhbHVlID09PSAnJyAmJiAhKCF0aGlzLm9wdGlvbnMucGFyZW50Q3VycmVudFZpZXdEYXRhQ291bnQgJiYgY29sbC5sZW5ndGgpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaW5maW5pdGVVbmxvYWRQYXJlbnRFeGlzdFByZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb2xsLnVuc2hpZnQodGhpcy5pbmZpbml0ZVVubG9hZFBhcmVudEV4aXN0UHJlZFtpXSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlGaWx0ZXJQcmV2RXZlbnQodGhpcy5leGlzdGluZ1ByZWRpY2F0ZVt0aGlzLm9wdGlvbnMuZmllbGRdW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zSW5wdXQudmFsdWUgIT09ICcnICYmICghdGhpcy5sb2NhbEluZmluaXRlU2VsZWN0QWxsQ2xpY2tlZCB8fCB0aGlzLmluZmluaXRlTG9jYWxTZWxlY3RBbGwpKSB7XG4gICAgICAgICAgICB0aGlzLmluZmluaXRlU2VhcmNoUHJlZFsncHJlZGljYXRlJ10gPSAnb3InO1xuICAgICAgICAgICAgY29sbC51bnNoaWZ0KHRoaXMuaW5maW5pdGVTZWFyY2hQcmVkKTtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5RmlsdGVyUHJldkV2ZW50KHRoaXMuaW5maW5pdGVTZWFyY2hQcmVkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5ub3RpZnlGaWx0ZXJQcmV2RXZlbnQgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgaW5zdGFuY2U6IHRoaXMsIGhhbmRsZXI6IHRoaXMuZmx0ckJ0bkhhbmRsZXIsIGFyZzE6IHByZWRpY2F0ZS5maWVsZCwgYXJnMjogcHJlZGljYXRlLnByZWRpY2F0ZSwgYXJnMzogcHJlZGljYXRlLm9wZXJhdG9yLFxuICAgICAgICAgICAgYXJnNDogcHJlZGljYXRlLm1hdGNoQ2FzZSwgYXJnNTogcHJlZGljYXRlLmlnbm9yZUFjY2VudCwgYXJnNjogcHJlZGljYXRlLnZhbHVlLCBjYW5jZWw6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMuZmx0clByZXZlbnQsIGFyZ3MpO1xuICAgICAgICBpZiAoYXJncy5jYW5jZWwpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLmdlbmVyYXRlTnVsbFZhbHVlUHJlZGljYXRlcyA9IGZ1bmN0aW9uIChkZWZhdWx0cykge1xuICAgICAgICB2YXIgY29sbCA9IFtdO1xuICAgICAgICBpZiAoZGVmYXVsdHMudHlwZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbGwucHVzaCh7XG4gICAgICAgICAgICAgICAgZmllbGQ6IGRlZmF1bHRzLmZpZWxkLCBpZ25vcmVBY2NlbnQ6IGRlZmF1bHRzLmlnbm9yZUFjY2VudCwgbWF0Y2hDYXNlOiBkZWZhdWx0cy5tYXRjaENhc2UsXG4gICAgICAgICAgICAgICAgb3BlcmF0b3I6IGRlZmF1bHRzLm9wZXJhdG9yLCBwcmVkaWNhdGU6IGRlZmF1bHRzLnByZWRpY2F0ZSwgdmFsdWU6ICcnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb2xsLnB1c2goe1xuICAgICAgICAgICAgZmllbGQ6IGRlZmF1bHRzLmZpZWxkLFxuICAgICAgICAgICAgbWF0Y2hDYXNlOiBkZWZhdWx0cy5tYXRjaENhc2UsIG9wZXJhdG9yOiBkZWZhdWx0cy5vcGVyYXRvciwgcHJlZGljYXRlOiBkZWZhdWx0cy5wcmVkaWNhdGUsIHZhbHVlOiBudWxsXG4gICAgICAgIH0pO1xuICAgICAgICBjb2xsLnB1c2goe1xuICAgICAgICAgICAgZmllbGQ6IGRlZmF1bHRzLmZpZWxkLCBtYXRjaENhc2U6IGRlZmF1bHRzLm1hdGNoQ2FzZSwgb3BlcmF0b3I6IGRlZmF1bHRzLm9wZXJhdG9yLFxuICAgICAgICAgICAgcHJlZGljYXRlOiBkZWZhdWx0cy5wcmVkaWNhdGUsIHZhbHVlOiB1bmRlZmluZWRcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjb2xsO1xuICAgIH07XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgLyoqIEBoaWRkZW4gKi9cbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmluaXRpYXRlRmlsdGVyID0gZnVuY3Rpb24gKGZDb2xsKSB7XG4gICAgICAgIHZhciBmaXJzdFZhbCA9IGZDb2xsWzBdO1xuICAgICAgICB2YXIgcHJlZGljYXRlO1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGZpcnN0VmFsKSkge1xuICAgICAgICAgICAgcHJlZGljYXRlID0gZmlyc3RWYWwuZWpwcmVkaWNhdGUgPyBmaXJzdFZhbC5lanByZWRpY2F0ZSA6XG4gICAgICAgICAgICAgICAgbmV3IFByZWRpY2F0ZShmaXJzdFZhbC5maWVsZCwgZmlyc3RWYWwub3BlcmF0b3IsIGZpcnN0VmFsLnZhbHVlLCAhZmlyc3RWYWwubWF0Y2hDYXNlLCBmaXJzdFZhbC5pZ25vcmVBY2NlbnQpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBmQ29sbC5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHByZWRpY2F0ZSA9IGZDb2xsW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5lanByZWRpY2F0ZSAhPT0gdW5kZWZpbmVkID9cbiAgICAgICAgICAgICAgICAgICAgcHJlZGljYXRlW2ZDb2xsW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5wcmVkaWNhdGVdKGZDb2xsW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5lanByZWRpY2F0ZSkgOlxuICAgICAgICAgICAgICAgICAgICBwcmVkaWNhdGVbZkNvbGxbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnByZWRpY2F0ZV0oZkNvbGxbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmZpZWxkLCBmQ29sbFtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0ub3BlcmF0b3IsIGZDb2xsW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS52YWx1ZSwgIWZDb2xsW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5tYXRjaENhc2UsIGZDb2xsW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5pZ25vcmVBY2NlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnZmlsdGVyaW5nJywgZmlsdGVyQ29sbGVjdGlvbjogZkNvbGwsIGZpZWxkOiB0aGlzLm9wdGlvbnMuZmllbGQsXG4gICAgICAgICAgICAgICAgZWpwcmVkaWNhdGU6IFByZWRpY2F0ZS5vcihwcmVkaWNhdGUpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmhhbmRsZXIoYXJncyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuaXNGb3JlaWduQ29sdW1uID0gZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICByZXR1cm4gY29sLmlzRm9yZWlnbkNvbHVtbiA/IGNvbC5pc0ZvcmVpZ25Db2x1bW4oKSA6IGZhbHNlO1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5yZWZyZXNoQ2hlY2tib3hlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHZhbCA9IHRoaXMuc0lucHV0LnZhbHVlO1xuICAgICAgICB2YXIgY29sdW1uID0gdGhpcy5vcHRpb25zLmNvbHVtbjtcbiAgICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy5pc0ZvcmVpZ25Db2x1bW4oY29sdW1uKSA/IHRoaXMuZm9yZWlnbktleVF1ZXJ5LmNsb25lKCkgOiB0aGlzLm9wdGlvbnMucXVlcnkuY2xvbmUoKTtcbiAgICAgICAgdmFyIGZvcmVpZ25RdWVyeSA9IHRoaXMub3B0aW9ucy5xdWVyeS5jbG9uZSgpO1xuICAgICAgICB2YXIgcHJlZCA9IHF1ZXJ5LnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChlKSB7IHJldHVybiBlICYmIGUuZm4gPT09ICdvbldoZXJlJzsgfSlbMF07XG4gICAgICAgIHF1ZXJ5LnF1ZXJpZXMgPSBbXTtcbiAgICAgICAgZm9yZWlnblF1ZXJ5LnF1ZXJpZXMgPSBbXTtcbiAgICAgICAgdmFyIHBhcnNlZCA9ICh0aGlzLm9wdGlvbnMudHlwZSAhPT0gJ3N0cmluZycgJiYgcGFyc2VGbG9hdCh2YWwpKSA/IHBhcnNlRmxvYXQodmFsKSA6IHZhbDtcbiAgICAgICAgdmFyIG9wZXJhdG9yID0gdGhpcy5vcHRpb25zLmlzUmVtb3RlID9cbiAgICAgICAgICAgICh0aGlzLm9wdGlvbnMudHlwZSA9PT0gJ3N0cmluZycgPyAnY29udGFpbnMnIDogJ2VxdWFsJykgOiAodGhpcy5vcHRpb25zLnR5cGUgPyAnY29udGFpbnMnIDogJ2VxdWFsJyk7XG4gICAgICAgIHZhciBtYXRjaENhc2UgPSB0cnVlO1xuICAgICAgICB2YXIgaWdub3JlQWNjZW50ID0gdGhpcy5vcHRpb25zLmlnbm9yZUFjY2VudDtcbiAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5pc0ZvcmVpZ25Db2x1bW4oY29sdW1uKSA/IGNvbHVtbi5mb3JlaWduS2V5VmFsdWUgOiBjb2x1bW4uZmllbGQ7XG4gICAgICAgIHBhcnNlZCA9IChwYXJzZWQgPT09ICcnIHx8IHBhcnNlZCA9PT0gdW5kZWZpbmVkKSA/IHVuZGVmaW5lZCA6IHBhcnNlZDtcbiAgICAgICAgdmFyIGNvbGwgPSBbXTtcbiAgICAgICAgdmFyIGRlZmF1bHRzID0ge1xuICAgICAgICAgICAgZmllbGQ6IGZpZWxkLCBwcmVkaWNhdGU6ICdvcicsIHVpZDogdGhpcy5vcHRpb25zLnVpZCxcbiAgICAgICAgICAgIG9wZXJhdG9yOiAnZXF1YWwnLCB0eXBlOiB0aGlzLm9wdGlvbnMudHlwZSwgbWF0Y2hDYXNlOiBtYXRjaENhc2UsIGlnbm9yZUFjY2VudDogaWdub3JlQWNjZW50XG4gICAgICAgIH07XG4gICAgICAgIHZhciBwcmVkaWN0ZTtcbiAgICAgICAgdmFyIG1vZHVsZU5hbWUgPSB0aGlzLm9wdGlvbnMuZGF0YU1hbmFnZXIuYWRhcHRvci5nZXRNb2R1bGVOYW1lO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnR5cGUgPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgaWYgKHBhcnNlZCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRMb2NhbGl6ZWRMYWJlbCgnRmlsdGVyVHJ1ZScpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihwYXJzZWQudG9Mb3dlckNhc2UoKSkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkID0gJ3RydWUnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyc2VkICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmdldExvY2FsaXplZExhYmVsKCdGaWx0ZXJGYWxzZScpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihwYXJzZWQudG9Mb3dlckNhc2UoKSkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkID0gJ2ZhbHNlJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXJzZWQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwoJ0ZpbHRlclRydWUnKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YocGFyc2VkLnRvTG93ZXJDYXNlKCkpICE9PSAtMSAmJiBtb2R1bGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgICAgICAgICAgICAgIHBhcnNlZCA9IChtb2R1bGVOYW1lKCkgPT09ICdPRGF0YUFkYXB0b3InIHx8ICdPRGF0YVY0QWRhcHRvcicpID8gdHJ1ZSA6ICd0cnVlJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHBhcnNlZCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRMb2NhbGl6ZWRMYWJlbCgnRmlsdGVyRmFsc2UnKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YocGFyc2VkLnRvTG93ZXJDYXNlKCkpICE9PSAtMSAmJiBtb2R1bGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgICAgICAgICAgICAgIHBhcnNlZCA9IChtb2R1bGVOYW1lKCkgPT09ICdPRGF0YUFkYXB0b3InIHx8ICdPRGF0YVY0QWRhcHRvcicpID8gZmFsc2UgOiAnZmFsc2UnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3BlcmF0b3IgPSAnZXF1YWwnO1xuICAgICAgICB9XG4gICAgICAgIGlmICgodGhpcy5vcHRpb25zLnR5cGUgPT09ICdkYXRlJyB8fCB0aGlzLm9wdGlvbnMudHlwZSA9PT0gJ2RhdGV0aW1lJyB8fCB0aGlzLm9wdGlvbnMudHlwZSA9PT0gJ2RhdGVvbmx5JykgJiYgdGhpcy5vcHRpb25zLmZvcm1hdCkge1xuICAgICAgICAgICAgdmFyIGludGwgPSBuZXcgSW50ZXJuYXRpb25hbGl6YXRpb24oKTtcbiAgICAgICAgICAgIHZhciBmb3JtYXQgPSB0eXBlb2YgKHRoaXMub3B0aW9ucy5mb3JtYXQpID09PSAnc3RyaW5nJyA/IHRoaXMub3B0aW9ucy5mb3JtYXQgOlxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5mb3JtYXQuZm9ybWF0O1xuICAgICAgICAgICAgaWYgKGZvcm1hdCkge1xuICAgICAgICAgICAgICAgIHBhcnNlZCA9IGludGwucGFyc2VEYXRlKHZhbCwgeyBmb3JtYXQ6IGZvcm1hdCB9KSB8fCBuZXcgRGF0ZSh2YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkID0gbmV3IERhdGUodmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMudHlwZSA9PT0gJ2RhdGVvbmx5Jykge1xuICAgICAgICAgICAgICAgIHBhcnNlZCA9IHBhcnNlZC5nZXRGdWxsWWVhcigpICsgJy0nICsgcGFkWmVybyhwYXJzZWQuZ2V0TW9udGgoKSArIDEpICsgJy0nICsgcGFkWmVybyhwYXJzZWQuZ2V0RGF0ZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluZmluaXRlU2VhcmNoVmFsQ2hhbmdlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5pbmZpbml0ZUxvYWRlZEVsZW0gPSBbXTtcbiAgICAgICAgdGhpcy5pbmZpbml0ZUxvY2FsU2VsZWN0QWxsID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sb2NhbEluZmluaXRlU2VsZWN0QWxsQ2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvY2FsSW5maW5pdGVTZWxlY3Rpb25JbnRlcmFjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5maW5pdGVTa2lwQ250ID0gMDtcbiAgICAgICAgdGhpcy5pbmZpbml0ZURhdGFDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuaW5maW5pdGVNYW51YWxTZWxlY3RNYWludGFpblByZWQgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuc0lucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVVubG9hZFBhcmVudEV4aXN0UHJlZCA9IHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgdGhpcy5leGlzdGluZ1ByZWRpY2F0ZVt0aGlzLm9wdGlvbnMuY29sdW1uLmZpZWxkXSA/IHRoaXMuZXhpc3RpbmdQcmVkaWNhdGVbdGhpcy5vcHRpb25zLmNvbHVtbi5maWVsZF0uc2xpY2UoKSA6IFtdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVVubG9hZFBhcmVudEV4aXN0UHJlZCA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWRkRGlzdGluY3QocXVlcnkpO1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIHJlcXVlc3RUeXBlOiBldmVudHMuZmlsdGVyU2VhcmNoQmVnaW4sXG4gICAgICAgICAgICBmaWx0ZXJNb2RlbDogdGhpcywgY29sdW1uTmFtZTogZmllbGQsIGNvbHVtbjogY29sdW1uLFxuICAgICAgICAgICAgb3BlcmF0b3I6IG9wZXJhdG9yLCBtYXRjaENhc2U6IG1hdGNoQ2FzZSwgaWdub3JlQWNjZW50OiBpZ25vcmVBY2NlbnQsIGZpbHRlckNob2ljZUNvdW50OiBudWxsLFxuICAgICAgICAgICAgcXVlcnk6IHF1ZXJ5LCB2YWx1ZTogcGFyc2VkXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmluZmluaXRlUmVuZGVyTW9kICYmIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQpIHtcbiAgICAgICAgICAgIGFyZ3MuZmlsdGVyQ2hvaWNlQ291bnQgPSB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmFjdGlvbkJlZ2luLCBhcmdzLCBmdW5jdGlvbiAoZmlsdGVyYXJncykge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNlbGYtYXNzaWduXG4gICAgICAgICAgICBmaWx0ZXJhcmdzLm9wZXJhdG9yID0gZmlsdGVyYXJncy5vcGVyYXRvcjtcbiAgICAgICAgICAgIHByZWRpY3RlID0gbmV3IFByZWRpY2F0ZShmaWVsZCwgZmlsdGVyYXJncy5vcGVyYXRvciwgYXJncy52YWx1ZSwgZmlsdGVyYXJncy5tYXRjaENhc2UsIGZpbHRlcmFyZ3MuaWdub3JlQWNjZW50KTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5vcHRpb25zLnR5cGUgPT09ICdkYXRlJyB8fCBfdGhpcy5vcHRpb25zLnR5cGUgPT09ICdkYXRldGltZScgfHwgX3RoaXMub3B0aW9ucy50eXBlID09PSAnZGF0ZW9ubHknKSB7XG4gICAgICAgICAgICAgICAgb3BlcmF0b3IgPSAnZXF1YWwnO1xuICAgICAgICAgICAgICAgIHZhciBmaWx0ZXJPYmogPSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiBmaWVsZCwgb3BlcmF0b3I6IG9wZXJhdG9yLCB2YWx1ZTogcGFyc2VkLCBtYXRjaENhc2U6IG1hdGNoQ2FzZSxcbiAgICAgICAgICAgICAgICAgICAgaWdub3JlQWNjZW50OiBpZ25vcmVBY2NlbnRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQocGFyc2VkKSkge1xuICAgICAgICAgICAgICAgICAgICBwcmVkaWN0ZSA9IGdldERhdGVQcmVkaWNhdGUoZmlsdGVyT2JqLCBfdGhpcy5vcHRpb25zLnR5cGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWwgJiYgdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycgJiYgX3RoaXMuaXNCbGFua3MgJiZcbiAgICAgICAgICAgICAgICBfdGhpcy5nZXRMb2NhbGl6ZWRMYWJlbCgnQmxhbmtzJykudG9Mb3dlckNhc2UoKS5pbmRleE9mKHZhbC50b0xvd2VyQ2FzZSgpKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgY29sbCA9IGNvbGwuY29uY2F0KENoZWNrQm94RmlsdGVyQmFzZS5nZW5lcmF0ZU51bGxWYWx1ZVByZWRpY2F0ZXMoZGVmYXVsdHMpKTtcbiAgICAgICAgICAgICAgICB2YXIgZW1wdHlWYWxQcmVkaWN0ZSA9IENoZWNrQm94RmlsdGVyQmFzZS5nZW5lcmF0ZVByZWRpY2F0ZShjb2xsKTtcbiAgICAgICAgICAgICAgICBlbXB0eVZhbFByZWRpY3RlLnByZWRpY2F0ZXMucHVzaChwcmVkaWN0ZSk7XG4gICAgICAgICAgICAgICAgcHJlZGljdGUgPSBlbXB0eVZhbFByZWRpY3RlO1xuICAgICAgICAgICAgICAgIHF1ZXJ5LndoZXJlKGVtcHR5VmFsUHJlZGljdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHByZWRpY3RlID0gIWlzTnVsbE9yVW5kZWZpbmVkKHByZWQpID8gcHJlZGljdGUuYW5kKHByZWQuZSkgOiBwcmVkaWN0ZTtcbiAgICAgICAgICAgICAgICBxdWVyeS53aGVyZShwcmVkaWN0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghaXNOdWxsT3JVbmRlZmluZWQocHJlZCkpIHtcbiAgICAgICAgICAgICAgICBwcmVkaWN0ZSA9IHByZWQuZTtcbiAgICAgICAgICAgICAgICBxdWVyeS53aGVyZShwcmVkLmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMuaW5maW5pdGVTZWFyY2hQcmVkID0gcHJlZGljdGU7XG4gICAgICAgICAgICBmaWx0ZXJhcmdzLmZpbHRlckNob2ljZUNvdW50ID0gIWlzTnVsbE9yVW5kZWZpbmVkKGZpbHRlcmFyZ3MuZmlsdGVyQ2hvaWNlQ291bnQpID8gZmlsdGVyYXJncy5maWx0ZXJDaG9pY2VDb3VudCA6IDEwMDA7XG4gICAgICAgICAgICBpZiAoX3RoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgX3RoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQgIT09IGZpbHRlcmFyZ3MuZmlsdGVyQ2hvaWNlQ291bnQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudCA9IGFyZ3MuZmlsdGVyQ2hvaWNlQ291bnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZlByZWRpY2F0ZSA9IHt9O1xuICAgICAgICAgICAgc2hvd1NwaW5uZXIoX3RoaXMuc3Bpbm5lcik7XG4gICAgICAgICAgICBfdGhpcy5yZW5kZXJFbXB0eSA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKF90aGlzLmlzRm9yZWlnbkNvbHVtbihjb2x1bW4pICYmIHZhbC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29sRGF0YSA9ICgncmVzdWx0JyBpbiBjb2x1bW4uZGF0YVNvdXJjZSkgPyBuZXcgRGF0YU1hbmFnZXIoY29sdW1uLmRhdGFTb3VyY2UucmVzdWx0KSA6XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbi5kYXRhU291cmNlO1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgY29sRGF0YS5leGVjdXRlUXVlcnkocXVlcnkpLnRoZW4oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbHVtbkRhdGEgPSBfdGhpcy5vcHRpb25zLmNvbHVtbi5jb2x1bW5EYXRhO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5vcHRpb25zLmNvbHVtbi5jb2x1bW5EYXRhID0gZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmdlbmVyYXRlUXVlcnksIHsgcHJlZGljYXRlOiBmUHJlZGljYXRlLCBjb2x1bW46IGNvbHVtbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZQcmVkaWNhdGUucHJlZGljYXRlLnByZWRpY2F0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JlaWduUXVlcnkud2hlcmUoZlByZWRpY2F0ZS5wcmVkaWNhdGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVuZGVyRW1wdHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm9wdGlvbnMuY29sdW1uLmNvbHVtbkRhdGEgPSBjb2x1bW5EYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmluZmluaXRlSW5pdGlhbExvYWQgPSBpc051bGxPclVuZGVmaW5lZChfdGhpcy5mdWxsRGF0YSkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5tYWtlSW5maW5pdGVTY3JvbGxSZXF1ZXN0KGZvcmVpZ25RdWVyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JlaWduUXVlcnkucmVxdWlyZXNDb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yZWlnblF1ZXJ5LnRha2UoZmlsdGVyYXJncy5maWx0ZXJDaG9pY2VDb3VudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2VhcmNoKGZpbHRlcmFyZ3MsIGZvcmVpZ25RdWVyeSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgX3RoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5maW5pdGVJbml0aWFsTG9hZCA9IGlzTnVsbE9yVW5kZWZpbmVkKF90aGlzLmZ1bGxEYXRhKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubWFrZUluZmluaXRlU2Nyb2xsUmVxdWVzdChxdWVyeSk7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5LnJlcXVpcmVzQ291bnQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5LnRha2UoZmlsdGVyYXJncy5maWx0ZXJDaG9pY2VDb3VudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnNlYXJjaChmaWx0ZXJhcmdzLCBxdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbiAoYXJncywgcXVlcnkpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmRhdGFTb3VyY2UgJiYgJ3Jlc3VsdCcgaW4gdGhpcy5wYXJlbnQuZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJFdmVudChhcmdzLCBxdWVyeSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NTZWFyY2gocXVlcnkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmdldFByZWRpY2F0ZUZyb21Db2xzID0gZnVuY3Rpb24gKGNvbHVtbnMsIGlzRXhlY3V0ZUxvY2FsKSB7XG4gICAgICAgIHZhciBwcmVkaWNhdGVzID0gQ2hlY2tCb3hGaWx0ZXJCYXNlLmdldFByZWRpY2F0ZShjb2x1bW5zLCBpc0V4ZWN1dGVMb2NhbCk7XG4gICAgICAgIHZhciBwcmVkaWNhdGVMaXN0ID0gW107XG4gICAgICAgIHZhciBmUHJlZGljYXRlID0ge307XG4gICAgICAgIHZhciBpc0dyaWQgPSB0aGlzLnBhcmVudC5nZXRGb3JlaWduS2V5Q29sdW1ucyAhPT0gdW5kZWZpbmVkO1xuICAgICAgICB2YXIgZm9yZWlnbkNvbHVtbiA9IGlzR3JpZCA/IHRoaXMucGFyZW50LmdldEZvcmVpZ25LZXlDb2x1bW5zKCkgOiBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IE9iamVjdC5rZXlzKHByZWRpY2F0ZXMpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHByb3AgPSBfYVtfaV07XG4gICAgICAgICAgICB2YXIgY29sID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKGlzR3JpZCAmJiAhdGhpcy5wYXJlbnQuZ2V0Q29sdW1uQnlGaWVsZChwcm9wKSkge1xuICAgICAgICAgICAgICAgIGNvbCA9IGdldENvbHVtbkJ5Rm9yZWlnbktleVZhbHVlKHByb3AsIGZvcmVpZ25Db2x1bW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMuZ2VuZXJhdGVRdWVyeSwgeyBwcmVkaWNhdGU6IGZQcmVkaWNhdGUsIGNvbHVtbjogY29sIH0pO1xuICAgICAgICAgICAgICAgIGlmIChmUHJlZGljYXRlLnByZWRpY2F0ZS5wcmVkaWNhdGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBwcmVkaWNhdGVMaXN0LnB1c2goUHJlZGljYXRlLm9yKGZQcmVkaWNhdGUucHJlZGljYXRlLnByZWRpY2F0ZXMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcmVkaWNhdGVMaXN0LnB1c2gocHJlZGljYXRlc1tcIlwiICsgcHJvcF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmVkaWNhdGVMaXN0Lmxlbmd0aCAmJiBQcmVkaWNhdGUuYW5kKHByZWRpY2F0ZUxpc3QpO1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5nZXRRdWVyeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50LmdldFF1ZXJ5ID8gdGhpcy5wYXJlbnQuZ2V0UXVlcnkoKS5jbG9uZSgpIDogbmV3IFF1ZXJ5KCk7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmdldEFsbERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuY3VzdG9tUXVlcnkgPSBmYWxzZTtcbiAgICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy5nZXRRdWVyeSgpO1xuICAgICAgICB2YXIgbW9kdWxlTmFtZSA9IHRoaXMub3B0aW9ucy5kYXRhTWFuYWdlci5hZGFwdG9yLmdldE1vZHVsZU5hbWU7XG4gICAgICAgIGlmICghKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKSAmJiBtb2R1bGVOYW1lICYmIG1vZHVsZU5hbWUoKSA9PT0gJ09EYXRhVjRBZGFwdG9yJykpIHtcbiAgICAgICAgICAgIHF1ZXJ5LnJlcXVpcmVzQ291bnQoKTsgLy9jb25zaWRlciB0YWtlIHF1ZXJ5XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hZGREaXN0aW5jdChxdWVyeSk7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgcmVxdWVzdFR5cGU6IGV2ZW50cy5maWx0ZXJDaG9pY2VSZXF1ZXN0LCBxdWVyeTogcXVlcnksIGZpbHRlckNob2ljZUNvdW50OiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIHZhciBmaWx0ZXJNb2RlbCA9ICdmaWx0ZXJNb2RlbCc7XG4gICAgICAgIGFyZ3NbXCJcIiArIGZpbHRlck1vZGVsXSA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmluZmluaXRlUmVuZGVyTW9kICYmIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQpIHtcbiAgICAgICAgICAgIGFyZ3MuZmlsdGVyQ2hvaWNlQ291bnQgPSB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmFjdGlvbkJlZ2luLCBhcmdzLCBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgYXJncy5maWx0ZXJDaG9pY2VDb3VudCA9ICFpc051bGxPclVuZGVmaW5lZChhcmdzLmZpbHRlckNob2ljZUNvdW50KSA/IGFyZ3MuZmlsdGVyQ2hvaWNlQ291bnQgOiAxMDAwO1xuICAgICAgICAgICAgaWYgKF90aGlzLmluZmluaXRlUmVuZGVyTW9kICYmIF90aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50ICE9PSBhcmdzLmZpbHRlckNob2ljZUNvdW50KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQgPSBhcmdzLmZpbHRlckNob2ljZUNvdW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFfdGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgIHF1ZXJ5LnRha2UoYXJncy5maWx0ZXJDaG9pY2VDb3VudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWFyZ3MucXVlcnkuZGlzdGluY3RzLmxlbmd0aCB8fCBfdGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmN1c3RvbVF1ZXJ5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5xdWVyeUdlbmVyYXRlKHF1ZXJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfdGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmluZmluaXRlSW5pdGlhbExvYWQgPSBpc051bGxPclVuZGVmaW5lZChfdGhpcy5mdWxsRGF0YSkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgX3RoaXMubWFrZUluZmluaXRlU2Nyb2xsUmVxdWVzdChxdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmRhdGFTb3VyY2UgJiYgJ3Jlc3VsdCcgaW4gX3RoaXMucGFyZW50LmRhdGFTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5maWx0ZXJFdmVudChhcmdzLCBxdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wcm9jZXNzRGF0YU9wZXJhdGlvbihxdWVyeSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5hZGREaXN0aW5jdCA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZmlsdGVyZWRDb2x1bW4gPSBEYXRhVXRpbC5kaXN0aW5jdCh0aGlzLm9wdGlvbnMuZmlsdGVyZWRDb2x1bW5zLCAnZmllbGQnKTtcbiAgICAgICAgaWYgKGZpbHRlcmVkQ29sdW1uLmluZGV4T2YodGhpcy5vcHRpb25zLmNvbHVtbi5maWVsZCkgPD0gLTEpIHtcbiAgICAgICAgICAgIGZpbHRlcmVkQ29sdW1uID0gZmlsdGVyZWRDb2x1bW4uY29uY2F0KHRoaXMub3B0aW9ucy5jb2x1bW4uZmllbGQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtb2R1bGVOYW1lID0gdGhpcy5vcHRpb25zLmRhdGFNYW5hZ2VyLmFkYXB0b3IuZ2V0TW9kdWxlTmFtZTtcbiAgICAgICAgaWYgKG1vZHVsZU5hbWUgJiYgbW9kdWxlTmFtZSgpID09PSAnT0RhdGFWNEFkYXB0b3InICYmIHRoaXMucGFyZW50ICYmXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5xdWVyeSBpbnN0YW5jZW9mIFF1ZXJ5KSB7XG4gICAgICAgICAgICB2YXIgZ3JpZFF1ZXJ5ID0gdGhpcy5wYXJlbnQucXVlcnk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGdyaWRRdWVyeS5xdWVyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5T3B0aW9ucyA9IGdyaWRRdWVyeS5xdWVyaWVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICBpZiAocXVlcnlPcHRpb25zLmZuID09PSAnb25XaGVyZScpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRQcmVkaWNhdGVGaWVsZHMocXVlcnlPcHRpb25zLmUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5RmlsdGVyZWRDb2x1bW4ubWFwKGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRlcmVkQ29sdW1uLmluZGV4T2YoZmllbGQpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkQ29sdW1uLnB1c2goZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeUZpbHRlcmVkQ29sdW1uID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgcXVlcnkuZGlzdGluY3QoZmlsdGVyZWRDb2x1bW4pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmluZmluaXRlUmVuZGVyTW9kICYmICF0aGlzLm9wdGlvbnMuaXNSZW1vdGUgJiYgdGhpcy5zSW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuZGF0YVNvdXJjZSA9IHRoaXMub3B0aW9ucy5kYXRhU291cmNlIGluc3RhbmNlb2YgRGF0YU1hbmFnZXIgP1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5kYXRhU291cmNlIDogbmV3IERhdGFNYW5hZ2VyKHRoaXMub3B0aW9ucy5kYXRhU291cmNlKTtcbiAgICAgICAgICAgIHRoaXMuaW5maW5pdGVQZXJtZW5hbnRMb2NhbERhdGEgPSB0aGlzLm9wdGlvbnMuZGF0YVNvdXJjZS5kYXRhU291cmNlLmpzb24uc2xpY2UoKTtcbiAgICAgICAgICAgIHZhciBxdWVyeTEgPSBuZXcgUXVlcnkoKTtcbiAgICAgICAgICAgIHRoaXMucXVlcnlHZW5lcmF0ZShxdWVyeTEpO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRhTWFuYWdlcih0aGlzLm9wdGlvbnMuZGF0YVNvdXJjZS5kYXRhU291cmNlKS5leGVjdXRlTG9jYWwocXVlcnkxKTtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5kYXRhU291cmNlID0gbmV3IERhdGFNYW5hZ2VyKERhdGFVdGlsLmRpc3RpbmN0KHJlc3VsdCwgdGhpcy5vcHRpb25zLmNvbHVtbi5maWVsZCwgdHJ1ZSkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNGb3JlaWduQ29sdW1uKHRoaXMub3B0aW9ucy5jb2x1bW4pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmNvbHVtbi5kYXRhU291cmNlID0gdGhpcy5vcHRpb25zLmNvbHVtbi5kYXRhU291cmNlIGluc3RhbmNlb2YgRGF0YU1hbmFnZXIgP1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuY29sdW1uLmRhdGFTb3VyY2UgOiBuZXcgRGF0YU1hbmFnZXIodGhpcy5vcHRpb25zLmNvbHVtbi5kYXRhU291cmNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuZGF0YVNvdXJjZS5kYXRhU291cmNlLmpzb24gPSB0aGlzLm9wdGlvbnMuZGF0YVNvdXJjZS5kYXRhU291cmNlLmpzb24ubWFwKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBpdGVtLCBfdGhpcy5vcHRpb25zLmNvbHVtbi5kYXRhU291cmNlLmRhdGFTb3VyY2UuanNvbltpXSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCAmJiB0aGlzLm9wdGlvbnMuaXNSZW1vdGUpIHtcbiAgICAgICAgICAgIHF1ZXJ5LnNlbGVjdCh0aGlzLm9wdGlvbnMuY29sdW1uLmZpZWxkKTtcbiAgICAgICAgICAgIHF1ZXJ5LnNvcnRCeSh0aGlzLm9wdGlvbnMuY29sdW1uLmZpZWxkLCAnYXNjZW5kaW5nJyk7XG4gICAgICAgICAgICB2YXIgbW9kdWxlTmFtZV8xID0gdGhpcy5vcHRpb25zLmRhdGFNYW5hZ2VyLmFkYXB0b3IuZ2V0TW9kdWxlTmFtZTtcbiAgICAgICAgICAgIGlmIChtb2R1bGVOYW1lXzEgJiYgbW9kdWxlTmFtZV8xKCkgJiYgKG1vZHVsZU5hbWVfMSgpID09PSAnT0RhdGFWNEFkYXB0b3InIHx8IG1vZHVsZU5hbWVfMSgpID09PSAnV2ViQXBpQWRhcHRvcidcbiAgICAgICAgICAgICAgICB8fCBtb2R1bGVOYW1lXzEoKSA9PT0gJ0N1c3RvbURhdGFBZGFwdG9yJyB8fCBtb2R1bGVOYW1lXzEoKSA9PT0gJ0dyYXBoUUxBZGFwdG9yJyB8fCBtb2R1bGVOYW1lXzEoKSA9PT0gJ09EYXRhQWRhcHRvcicpKSB7XG4gICAgICAgICAgICAgICAgcXVlcnkuZGlzdGluY3QoZmlsdGVyZWRDb2x1bW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBxdWVyeTtcbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuZ2V0UHJlZGljYXRlRmllbGRzID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChxdWVyeS5pc0NvbXBsZXggJiYgcXVlcnkucHJlZGljYXRlcykge1xuICAgICAgICAgICAgcXVlcnkucHJlZGljYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHByZWRpY2F0ZS5mb3JFYWNoKGZ1bmN0aW9uIChwKSB7IHJldHVybiBfdGhpcy5nZXRQcmVkaWNhdGVGaWVsZHMocCk7IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZ2V0UHJlZGljYXRlRmllbGRzKHByZWRpY2F0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAocXVlcnkuZmllbGQgJiYgIXF1ZXJ5LmlzQ29tcGxleCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnF1ZXJ5RmlsdGVyZWRDb2x1bW4uaW5kZXhPZihxdWVyeS5maWVsZCkgPD0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeUZpbHRlcmVkQ29sdW1uID0gdGhpcy5xdWVyeUZpbHRlcmVkQ29sdW1uLmNvbmNhdChEYXRhVXRpbC5kaXN0aW5jdChbcXVlcnkuZmllbGRdLCAnZmllbGQnKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmZpbHRlckV2ZW50ID0gZnVuY3Rpb24gKGFyZ3MsIHF1ZXJ5KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBkZWZPYmogPSBldmVudFByb21pc2UoYXJncywgcXVlcnkpO1xuICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5kYXRhU3RhdGVDaGFuZ2UsIGRlZk9iai5zdGF0ZSk7XG4gICAgICAgIHRoaXMuYWRkSW5maW5pdGVTY3JvbGxFdmVudChxdWVyeSk7XG4gICAgICAgIHZhciBkZWYgPSBkZWZPYmouZGVmZmVyZWQ7XG4gICAgICAgIGRlZi5wcm9taXNlLnRoZW4oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIF90aGlzLmluZmluaXRlRGF0YUNvdW50ID0gX3RoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgIV90aGlzLmluZmluaXRlRGF0YUNvdW50ID8gZVsnY291bnQnXSA6IF90aGlzLmluZmluaXRlRGF0YUNvdW50O1xuICAgICAgICAgICAgdmFyIGRhdGFSZXN1bHQgPSBfdGhpcy5pbmZpbml0ZVJlbmRlck1vZCA/IGVbJ3Jlc3VsdCddIDogZTtcbiAgICAgICAgICAgIF90aGlzLmRhdGFTdWNjZXNzKGRhdGFSZXN1bHQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuYWRkSW5maW5pdGVTY3JvbGxFdmVudCA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVF1ZXJ5ID0gcXVlcnkuY2xvbmUoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmluZmluaXRlSW5pdGlhbExvYWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNCb3guY2xhc3NMaXN0LmFkZCgnZS1jaGVja2JveC1pbmZpbml0ZXNjcm9sbCcpO1xuICAgICAgICAgICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5jQm94LCAnc2Nyb2xsJywgdGhpcy5pbmZpbml0ZVNjcm9sbEhhbmRsZXIsIHRoaXMpO1xuICAgICAgICAgICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5jQm94LCAnbW91c2V1cCcsIHRoaXMuaW5maW5pdGVTY3JvbGxNb3VzZUtleVVwSGFuZGxlciwgdGhpcyk7XG4gICAgICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmNCb3gsICdtb3VzZWRvd24nLCB0aGlzLmluZmluaXRlU2Nyb2xsTW91c2VLZXlEb3duSGFuZGxlciwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmluZmluaXRlU2VhcmNoVmFsQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jQm94LmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmluZmluaXRlU2Nyb2xsTW91c2VLZXlEb3duSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmNCb3gsICdzY3JvbGwnLCB0aGlzLmluZmluaXRlU2Nyb2xsSGFuZGxlcik7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmluZmluaXRlU2Nyb2xsTW91c2VLZXlVcEhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMuY0JveCwgJ3Njcm9sbCcsIHRoaXMuaW5maW5pdGVTY3JvbGxIYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMuY0JveDtcbiAgICAgICAgaWYgKHRhcmdldC5jaGlsZHJlbi5sZW5ndGggPiAxICYmICh0YXJnZXQuc2Nyb2xsVG9wID49IHRhcmdldC5zY3JvbGxIZWlnaHQgLSB0YXJnZXQub2Zmc2V0SGVpZ2h0IHx8IHRhcmdldC5zY3JvbGxUb3AgPD0gMCkpIHtcbiAgICAgICAgICAgIHRoaXMuaW5maW5pdGVTY3JvbGxIYW5kbGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgR2xvYmFsLnRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IF90aGlzLmNsaWNrSGFuZGxlcihlKTsgR2xvYmFsLnRpbWVyID0gbnVsbDsgfSwgMCk7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmdldFNoaW1tZXJUZW1wbGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICc8c3BhbiBjbGFzcz1cImUtbWFzayBlLXNrZWxldG9uIGUtc2tlbGV0b24tdGV4dCBlLXNoaW1tZXItd2F2ZVwiPjwvc3Bhbj4nO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuc2hvd01hc2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBtYXNrUm93Q291bnQgPSA1O1xuICAgICAgICB2YXIgbWFza0l0ZW1IZWlnaHQ7XG4gICAgICAgIHZhciBtYXNrTGlzdCA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgaWQ6IHRoaXMuaWQgKyB0aGlzLm9wdGlvbnMudHlwZSArICdfQ2hlY2tCb3hNYXNrTGlzdCcsXG4gICAgICAgICAgICBjbGFzc05hbWU6ICdlLWNoZWNrYm94bGlzdCBlLWZpZWxkcyBlLWluZmluaXRlLWxpc3QgZS1tYXNrbGlzdCcgfSk7XG4gICAgICAgIG1hc2tMaXN0LnN0eWxlLnpJbmRleCA9ICcxMCc7XG4gICAgICAgIHZhciB3cmFwcGVyRWxlbSA9IHRoaXMuY0JveDtcbiAgICAgICAgdGhpcy5yZW1vdmVNYXNrKCk7XG4gICAgICAgIGlmICh3cmFwcGVyRWxlbSkge1xuICAgICAgICAgICAgdmFyIGNvbXB1dGVkU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHdyYXBwZXJFbGVtKTtcbiAgICAgICAgICAgIHZhciBsaUhlaWdodCA9IGdldExpc3RIZWlnaHQod3JhcHBlckVsZW0pO1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHdyYXBwZXJFbGVtLmNoaWxkcmVuLmxlbmd0aCA/IHBhcnNlSW50KGNvbXB1dGVkU3R5bGUuaGVpZ2h0LCAxMCkgOlxuICAgICAgICAgICAgICAgIE1hdGguZmxvb3IocGFyc2VJbnQoY29tcHV0ZWRTdHlsZS5oZWlnaHQuc3BsaXQoJ3B4JylbMF0sIDEwKSkgLSA1O1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZUFkYXB0aXZlVUkgJiYgdGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgIG1hc2tMaXN0LnN0eWxlLmhlaWdodCA9IChoZWlnaHQgLSBsaUhlaWdodCkgKyAncHgnO1xuICAgICAgICAgICAgICAgIHRoaXMuZGxnLnF1ZXJ5U2VsZWN0b3IoJy5lLWRsZy1jb250ZW50Jykuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBiYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLmlzRXhjZWwgJiYgIXdyYXBwZXJFbGVtLmNoaWxkcmVuLmxlbmd0aCAmJiAhdGhpcy5kbGcuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWV4Y2VsZmlsdGVyJykgP1xuICAgICAgICAgICAgICAgICcnIDogZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmRsZy5xdWVyeVNlbGVjdG9yKCcuZS1kbGctY29udGVudCcpKS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgICAgICBtYXNrTGlzdC5zdHlsZS5jc3NUZXh0ID0gJ3dpZHRoOiAnICsgY29tcHV0ZWRTdHlsZS53aWR0aCArICc7IG1pbi1oZWlnaHQ6ICcgKyBjb21wdXRlZFN0eWxlLm1pbkhlaWdodCArICc7IGhlaWdodDogJyArXG4gICAgICAgICAgICAgICAgaGVpZ2h0ICsgJ3B4OyBtYXJnaW46ICcgKyBjb21wdXRlZFN0eWxlLm1hcmdpbiArICc7IGJvcmRlci1zdHlsZTogJyArIGNvbXB1dGVkU3R5bGUuYm9yZGVyU3R5bGUgKyAnOyBib3JkZXItd2lkdGg6ICdcbiAgICAgICAgICAgICAgICArIGNvbXB1dGVkU3R5bGUuYm9yZGVyV2lkdGggKyAnOyBib3JkZXItY29sb3I6ICcgKyBjb21wdXRlZFN0eWxlLmJvcmRlckNvbG9yICsgJzsgcG9zaXRpb246IGFic29sdXRlOyBiYWNrZ3JvdW5kLWNvbG9yOiAnICtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3IgKyAnOyc7XG4gICAgICAgICAgICBtYXNrUm93Q291bnQgPSBNYXRoLmZsb29yKGhlaWdodCAvIGxpSGVpZ2h0KTtcbiAgICAgICAgICAgIG1hc2tSb3dDb3VudCA9IHdyYXBwZXJFbGVtLmNoaWxkcmVuLmxlbmd0aCA+IG1hc2tSb3dDb3VudCA/IHdyYXBwZXJFbGVtLmNoaWxkcmVuLmxlbmd0aCA6IG1hc2tSb3dDb3VudDtcbiAgICAgICAgICAgIG1hc2tJdGVtSGVpZ2h0ID0gbGlIZWlnaHQgKyAncHgnO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtYXNrVGVtcGxhdGUgPSAnPGRpdiBjbGFzcz1cImUtZnRyY2hrIGUtbWFzay1mdHJjaGtcIj4nXG4gICAgICAgICAgICArICc8ZGl2IGNsYXNzPVwiZS1jaGVja2JveC13cmFwcGVyXCI+PGlucHV0IGNsYXNzPVwiZS1jaGstaGlkZGVuXCI+J1xuICAgICAgICAgICAgKyB0aGlzLmdldFNoaW1tZXJUZW1wbGF0ZSgpICsgdGhpcy5nZXRTaGltbWVyVGVtcGxhdGUoKSArICc8L2Rpdj48L2Rpdj4nO1xuICAgICAgICBtYXNrTGlzdC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgaWYgKCF3cmFwcGVyRWxlbS5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuc3Bpbm5lci5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWJlZ2luJywgbWFza1RlbXBsYXRlKTtcbiAgICAgICAgICAgIHRoaXMuc3Bpbm5lci5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWZ0cmNoay5lLW1hc2stZnRyY2hrJykuc3R5bGUuY3NzVGV4dCA9XG4gICAgICAgICAgICAgICAgJ3dpZHRoOiAxMDAlOyBoZWlnaHQ6ICcgKyBtYXNrSXRlbUhlaWdodCArICc7JztcbiAgICAgICAgICAgIHRoaXMuc3Bpbm5lci5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWNoZWNrYm94LXdyYXBwZXInKS5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICAgICAgICAgIHZhciBtYXNrU3BhbiA9IFtdLnNsaWNlLmNhbGwodGhpcy5zcGlubmVyLnBhcmVudEVsZW1lbnRcbiAgICAgICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbCgnLmUtbWFzazpub3QoLmUtbWFzay1jaGVja2JveC1maWx0ZXItaW50ZW50KTpub3QoLmUtbWFzay1jaGVja2JveC1maWx0ZXItc3Bhbi1pbnRlbnQpJykpO1xuICAgICAgICAgICAgbWFza1NwYW5bMF0uY2xhc3NMaXN0LmFkZCgnZS1tYXNrLWNoZWNrYm94LWZpbHRlci1pbnRlbnQnKTtcbiAgICAgICAgICAgIG1hc2tTcGFuWzFdLmNsYXNzTGlzdC5hZGQoJ2UtbWFzay1jaGVja2JveC1maWx0ZXItc3Bhbi1pbnRlbnQnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNwaW5uZXIuaW5zZXJ0QmVmb3JlKG1hc2tMaXN0LCB0aGlzLmNCb3gpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgbWFza1Jvd0NvdW50ICYmIGkgPCBtYXNrUm93Q291bnQ7IGkrKykge1xuICAgICAgICAgICAgbWFza0xpc3QuaW5uZXJIVE1MICs9IG1hc2tUZW1wbGF0ZTtcbiAgICAgICAgICAgIG1hc2tMaXN0Lmxhc3RFbGVtZW50Q2hpbGQuc3R5bGUuY3NzVGV4dCA9XG4gICAgICAgICAgICAgICAgJ3dpZHRoOiAxMDAlOyBoZWlnaHQ6ICcgKyBtYXNrSXRlbUhlaWdodCArICc7JztcbiAgICAgICAgICAgIG1hc2tMaXN0Lmxhc3RFbGVtZW50Q2hpbGQucXVlcnlTZWxlY3RvcignLmUtY2hlY2tib3gtd3JhcHBlcicpLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICAgICAgdmFyIG1hc2tTcGFuID0gW10uc2xpY2UuY2FsbChtYXNrTGlzdFxuICAgICAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKCcuZS1tYXNrOm5vdCguZS1tYXNrLWNoZWNrYm94LWZpbHRlci1pbnRlbnQpOm5vdCguZS1tYXNrLWNoZWNrYm94LWZpbHRlci1zcGFuLWludGVudCknKSk7XG4gICAgICAgICAgICBtYXNrU3BhblswXS5jbGFzc0xpc3QuYWRkKCdlLW1hc2stY2hlY2tib3gtZmlsdGVyLWludGVudCcpO1xuICAgICAgICAgICAgbWFza1NwYW5bMV0uY2xhc3NMaXN0LmFkZCgnZS1tYXNrLWNoZWNrYm94LWZpbHRlci1zcGFuLWludGVudCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNCb3gpIHtcbiAgICAgICAgICAgIG1hc2tMaXN0LnNjcm9sbFRvcCA9IHRoaXMuY0JveC5zY3JvbGxUb3A7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUucmVtb3ZlTWFzayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1hc2tMaXN0cyA9IHRoaXMuZGlhbG9nT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtbWFzay1mdHJjaGsnKTtcbiAgICAgICAgaWYgKG1hc2tMaXN0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFza0xpc3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlKG1hc2tMaXN0c1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1hc2tQYXJlbnQgPSB0aGlzLmRpYWxvZ09iai5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWNoZWNrYm94bGlzdC5lLW1hc2tsaXN0Jyk7XG4gICAgICAgIGlmIChtYXNrUGFyZW50KSB7XG4gICAgICAgICAgICByZW1vdmUodGhpcy5kaWFsb2dPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1jaGVja2JveGxpc3QuZS1tYXNrbGlzdCcpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5pbmZpbml0ZVNjcm9sbEhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLmNCb3g7XG4gICAgICAgIGlmICh0YXJnZXQuc2Nyb2xsVG9wID49IHRhcmdldC5zY3JvbGxIZWlnaHQgLSB0YXJnZXQub2Zmc2V0SGVpZ2h0ICYmICF0aGlzLmluZmluaXRlUXVlcnlFeGVjdXRpb25QZW5kaW5nXG4gICAgICAgICAgICAmJiB0aGlzLmluZmluaXRlTG9hZGVkRWxlbS5sZW5ndGggPD0gKHRoaXMuaW5maW5pdGVTa2lwQ250ICsgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudClcbiAgICAgICAgICAgICYmIHRoaXMuY0JveC5jaGlsZHJlbi5sZW5ndGggPT09IHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQgKiAzXG4gICAgICAgICAgICAmJiAoIXRoaXMuaW5maW5pdGVEYXRhQ291bnQgfHwgdGhpcy5pbmZpbml0ZURhdGFDb3VudCA+ICh0aGlzLmluZmluaXRlU2tpcENudCArIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQpKSkge1xuICAgICAgICAgICAgdGhpcy5tYWtlSW5maW5pdGVTY3JvbGxSZXF1ZXN0KCk7XG4gICAgICAgICAgICB0aGlzLnByZXZJbmZpbml0ZVNjcm9sbERpcmVjdGlvbiA9ICdkb3duJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0YXJnZXQuc2Nyb2xsVG9wID49IHRhcmdldC5zY3JvbGxIZWlnaHQgLSB0YXJnZXQub2Zmc2V0SGVpZ2h0ICYmICF0aGlzLmluZmluaXRlUXVlcnlFeGVjdXRpb25QZW5kaW5nXG4gICAgICAgICAgICAmJiB0aGlzLmluZmluaXRlTG9hZGVkRWxlbS5sZW5ndGggPiAodGhpcy5pbmZpbml0ZVNraXBDbnQgKyB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50KVxuICAgICAgICAgICAgJiYgdGhpcy5jQm94LmNoaWxkcmVuLmxlbmd0aCA9PT0gdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudCAqIDMpIHtcbiAgICAgICAgICAgIGluZmluaXRlUmVtb3ZlRWxlbWVudHMoKFtdLnNsaWNlLmNhbGwodGhpcy5jQm94LmNoaWxkcmVuKSkuc3BsaWNlKDAsIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQpKTtcbiAgICAgICAgICAgIHRoaXMuaW5maW5pdGVTa2lwQ250ICs9IHRoaXMucHJldkluZmluaXRlU2Nyb2xsRGlyZWN0aW9uID09PSAnZG93bicgPyB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50IDpcbiAgICAgICAgICAgICAgICAodGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudCAqIDMpO1xuICAgICAgICAgICAgYXBwZW5kQ2hpbGRyZW4odGhpcy5jQm94LCB0aGlzLmluZmluaXRlTG9hZGVkRWxlbS5zbGljZSh0aGlzLmluZmluaXRlU2tpcENudCwgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudCArXG4gICAgICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVNraXBDbnQpKTtcbiAgICAgICAgICAgIHRoaXMucHJldkluZmluaXRlU2Nyb2xsRGlyZWN0aW9uID0gJ2Rvd24nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRhcmdldC5zY3JvbGxUb3AgPT09IDAgJiYgIXRoaXMuaW5maW5pdGVJbml0aWFsTG9hZCAmJiAhdGhpcy5pbmZpbml0ZVNlYXJjaFZhbENoYW5nZSAmJiB0aGlzLmluZmluaXRlU2tpcENudFxuICAgICAgICAgICAgJiYgdGhpcy5pbmZpbml0ZUxvYWRlZEVsZW0ubGVuZ3RoICYmIHRoaXMuaW5maW5pdGVMb2FkZWRFbGVtLmxlbmd0aCA+IHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQgKiAzXG4gICAgICAgICAgICAmJiB0aGlzLmNCb3guY2hpbGRyZW4ubGVuZ3RoID09PSB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50ICogMykge1xuICAgICAgICAgICAgaW5maW5pdGVSZW1vdmVFbGVtZW50cygoW10uc2xpY2UuY2FsbCh0aGlzLmNCb3guY2hpbGRyZW4pKS5zcGxpY2UoKHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzXG4gICAgICAgICAgICAgICAgLml0ZW1zQ291bnQgKiAyKSwgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudCkpO1xuICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVNraXBDbnQgLT0gdGhpcy5wcmV2SW5maW5pdGVTY3JvbGxEaXJlY3Rpb24gPT09ICd1cCcgPyB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50IDpcbiAgICAgICAgICAgICAgICAodGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudCAqIDMpO1xuICAgICAgICAgICAgaW5maW5pdGVBcHBlbmRFbGVtZW50cyhbXS5zbGljZS5jYWxsKHRoaXMuaW5maW5pdGVMb2FkZWRFbGVtLnNsaWNlKHRoaXMuaW5maW5pdGVTa2lwQ250LCB0aGlzLmluZmluaXRlU2tpcENudCArXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudCkpLCB0aGlzLmNCb3gpO1xuICAgICAgICAgICAgdGhpcy5jQm94LnNjcm9sbFRvcCA9IHRoaXMuaW5maW5pdGVTY3JvbGxBcHBlbmREaWZmO1xuICAgICAgICAgICAgdGhpcy5wcmV2SW5maW5pdGVTY3JvbGxEaXJlY3Rpb24gPSAndXAnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRhcmdldC5zY3JvbGxUb3AgPT09IDAgJiYgIXRoaXMuaW5maW5pdGVJbml0aWFsTG9hZCAmJiAhdGhpcy5pbmZpbml0ZVNlYXJjaFZhbENoYW5nZSAmJiB0aGlzLmluZmluaXRlU2tpcENudFxuICAgICAgICAgICAgJiYgdGhpcy5pbmZpbml0ZUxvYWRlZEVsZW0ubGVuZ3RoICYmIHRoaXMuY0JveC5jaGlsZHJlbi5sZW5ndGggPCB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50ICogMykge1xuICAgICAgICAgICAgaW5maW5pdGVSZW1vdmVFbGVtZW50cygoW10uc2xpY2UuY2FsbCh0aGlzLmNCb3guY2hpbGRyZW4pKS5zcGxpY2UoKHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzXG4gICAgICAgICAgICAgICAgLml0ZW1zQ291bnQgKiAyKSwgdGhpcy5pbmZpbml0ZURhdGFDb3VudCAlIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQpKTtcbiAgICAgICAgICAgIHRoaXMuaW5maW5pdGVTa2lwQ250ID0gKE1hdGguZmxvb3IodGhpcy5pbmZpbml0ZURhdGFDb3VudCAvIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQpIC0gMykgKlxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQ7XG4gICAgICAgICAgICBpbmZpbml0ZUFwcGVuZEVsZW1lbnRzKFtdLnNsaWNlLmNhbGwodGhpcy5pbmZpbml0ZUxvYWRlZEVsZW0uc2xpY2UodGhpcy5pbmZpbml0ZVNraXBDbnQsIHRoaXMuaW5maW5pdGVTa2lwQ250ICtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50KSksIHRoaXMuY0JveCk7XG4gICAgICAgICAgICB0aGlzLmNCb3guc2Nyb2xsVG9wID0gdGhpcy5pbmZpbml0ZVNjcm9sbEFwcGVuZERpZmY7XG4gICAgICAgICAgICB0aGlzLnByZXZJbmZpbml0ZVNjcm9sbERpcmVjdGlvbiA9ICd1cCc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUubWFrZUluZmluaXRlU2Nyb2xsUmVxdWVzdCA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuaW5maW5pdGVJbml0aWFsTG9hZCAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncyAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5sb2FkaW5nSW5kaWNhdG9yID09PSAnU2hpbW1lcicpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pbmZpbml0ZVF1ZXJ5RXhlY3V0aW9uUGVuZGluZykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaG93TWFzaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXRoaXMuaW5maW5pdGVJbml0aWFsTG9hZCkge1xuICAgICAgICAgICAgY3JlYXRlU3Bpbm5lcih7IHRhcmdldDogdGhpcy5zcGlubmVyLCBjc3NDbGFzczogdGhpcy5wYXJlbnQuY3NzQ2xhc3MgPyB0aGlzLnBhcmVudC5jc3NDbGFzcyA6IG51bGwgfSwgdGhpcy5wYXJlbnRcbiAgICAgICAgICAgICAgICAuY3JlYXRlRWxlbWVudCk7XG4gICAgICAgICAgICBzaG93U3Bpbm5lcih0aGlzLnNwaW5uZXIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmTmFtZSA9ICdmbic7XG4gICAgICAgIGlmICh0aGlzLmluZmluaXRlUXVlcnkgJiYgdGhpcy5pbmZpbml0ZVF1ZXJ5LnF1ZXJpZXMgJiYgdGhpcy5pbmZpbml0ZVF1ZXJ5LnF1ZXJpZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaW5maW5pdGVRdWVyeS5xdWVyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVRdWVyeS5xdWVyaWVzW2ldW1wiXCIgKyBmTmFtZV0gPT09ICdvblRha2UnXG4gICAgICAgICAgICAgICAgICAgIHx8IHRoaXMuaW5maW5pdGVRdWVyeS5xdWVyaWVzW2ldW1wiXCIgKyBmTmFtZV0gPT09ICdvblNraXAnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5maW5pdGVRdWVyeS5xdWVyaWVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgaS0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZXhpc3RRdWVyeSA9IHF1ZXJ5ID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5ID8gcXVlcnkgOiB0aGlzLmluZmluaXRlUXVlcnk7XG4gICAgICAgIGlmICh0aGlzLmluZmluaXRlSW5pdGlhbExvYWQgfHwgdGhpcy5pbmZpbml0ZVNlYXJjaFZhbENoYW5nZSkge1xuICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVNraXBDbnQgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVNraXBDbnQgKz0gdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudDtcbiAgICAgICAgfVxuICAgICAgICBxdWVyeS5za2lwKHRoaXMuaW5maW5pdGVTa2lwQ250KTtcbiAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVJbml0aWFsTG9hZCB8fCB0aGlzLmluZmluaXRlU2VhcmNoVmFsQ2hhbmdlKSB7XG4gICAgICAgICAgICBxdWVyeS50YWtlKHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQgKiAzKTtcbiAgICAgICAgICAgIHRoaXMuaW5maW5pdGVTa2lwQ250ICs9IHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQgKiAyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcXVlcnkudGFrZSh0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5pdGVtc0NvdW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWV4aXN0UXVlcnkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5kYXRhU291cmNlICYmICdyZXN1bHQnIGluIHRoaXMucGFyZW50LmRhdGFTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFR5cGU6IGV2ZW50cy5maWx0ZXJDaG9pY2VSZXF1ZXN0LCBxdWVyeTogcXVlcnksIGZpbHRlckNob2ljZUNvdW50OiBudWxsLCBmaWx0ZXJNb2RlbDogdGhpc1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICBhcmdzLmZpbHRlckNob2ljZUNvdW50ID0gdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuaXRlbXNDb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJFdmVudChhcmdzLCBxdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NEYXRhT3BlcmF0aW9uKHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmluZmluaXRlUXVlcnlFeGVjdXRpb25QZW5kaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5wcm9jZXNzRGF0YU9wZXJhdGlvbiA9IGZ1bmN0aW9uIChxdWVyeSwgaXNJbml0aWFsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMub3B0aW9ucy5kYXRhU291cmNlID0gdGhpcy5vcHRpb25zLmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBEYXRhTWFuYWdlciA/XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuZGF0YVNvdXJjZSA6IG5ldyBEYXRhTWFuYWdlcih0aGlzLm9wdGlvbnMuZGF0YVNvdXJjZSk7XG4gICAgICAgIHZhciBhbGxQcm9taXNlID0gW107XG4gICAgICAgIHZhciBydW5BcnJheSA9IFtdO1xuICAgICAgICBpZiAodGhpcy5pc0ZvcmVpZ25Db2x1bW4odGhpcy5vcHRpb25zLmNvbHVtbikgJiYgaXNJbml0aWFsKSB7XG4gICAgICAgICAgICB2YXIgY29sRGF0YSA9ICgncmVzdWx0JyBpbiB0aGlzLm9wdGlvbnMuY29sdW1uLmRhdGFTb3VyY2UpID9cbiAgICAgICAgICAgICAgICBuZXcgRGF0YU1hbmFnZXIodGhpcy5vcHRpb25zLmNvbHVtbi5kYXRhU291cmNlLnJlc3VsdCkgOlxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5jb2x1bW4uZGF0YVNvdXJjZTtcbiAgICAgICAgICAgIHRoaXMuZm9yZWlnbktleVF1ZXJ5LnBhcmFtcyA9IHF1ZXJ5LnBhcmFtcztcbiAgICAgICAgICAgIGFsbFByb21pc2UucHVzaChjb2xEYXRhLmV4ZWN1dGVRdWVyeSh0aGlzLmZvcmVpZ25LZXlRdWVyeSkpO1xuICAgICAgICAgICAgcnVuQXJyYXkucHVzaChmdW5jdGlvbiAoZGF0YSkgeyByZXR1cm4gX3RoaXMuZm9yZWlnbktleURhdGEgPSBkYXRhOyB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFkZEluZmluaXRlU2Nyb2xsRXZlbnQocXVlcnkpO1xuICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCAmJiB0aGlzLmluZmluaXRlSW5pdGlhbExvYWQgJiYgIXRoaXMub3B0aW9ucy5pc1JlbW90ZSkge1xuICAgICAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5pc0ZvcmVpZ25Db2x1bW4odGhpcy5vcHRpb25zLmNvbHVtbikgPyB0aGlzLm9wdGlvbnMuZm9yZWlnbktleVZhbHVlIDpcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuY29sdW1uLmZpZWxkO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmRhdGFTb3VyY2UuZXhlY3V0ZVF1ZXJ5KG5ldyBRdWVyeSgpLnNvcnRCeShmaWVsZCwgRGF0YVV0aWwuZm5Bc2NlbmRpbmcpKS50aGVuKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMub3B0aW9ucy5kYXRhU291cmNlLmRhdGFTb3VyY2UuanNvbiA9IGUucmVzdWx0O1xuICAgICAgICAgICAgICAgIF90aGlzLmV4ZWN1dGVRdWVyeU9wZXJhdGlvbnMocXVlcnksIGFsbFByb21pc2UsIHJ1bkFycmF5KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5leGVjdXRlUXVlcnlPcGVyYXRpb25zKHF1ZXJ5LCBhbGxQcm9taXNlLCBydW5BcnJheSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuZXhlY3V0ZVF1ZXJ5T3BlcmF0aW9ucyA9IGZ1bmN0aW9uIChxdWVyeSwgYWxsUHJvbWlzZSwgcnVuQXJyYXkpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgYWxsUHJvbWlzZS5wdXNoKHRoaXMub3B0aW9ucy5kYXRhU291cmNlLmV4ZWN1dGVRdWVyeShxdWVyeSkpO1xuICAgICAgICBydW5BcnJheS5wdXNoKHRoaXMuZGF0YVN1Y2Nlc3MuYmluZCh0aGlzKSk7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgUHJvbWlzZS5hbGwoYWxsUHJvbWlzZSkudGhlbihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgX3RoaXMuaW5maW5pdGVRdWVyeUV4ZWN1dGlvblBlbmRpbmcgPSBfdGhpcy5pbmZpbml0ZVJlbmRlck1vZCA/IGZhbHNlIDogX3RoaXMuaW5maW5pdGVRdWVyeUV4ZWN1dGlvblBlbmRpbmc7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGUubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbmZpbml0ZURhdGFDb3VudCA9IF90aGlzLmluZmluaXRlUmVuZGVyTW9kICYmICFfdGhpcy5pbmZpbml0ZURhdGFDb3VudCA/IGVbal0uY291bnQgOiBfdGhpcy5pbmZpbml0ZURhdGFDb3VudDtcbiAgICAgICAgICAgICAgICBydW5BcnJheVtpKytdKGVbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChfdGhpcy5pbmZpbml0ZVJlbmRlck1vZCAmJiBfdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MgJiYgX3RoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLmxvYWRpbmdJbmRpY2F0b3IgPT09ICdTaGltbWVyJykge1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5zaG93TWFza1Jvdyh1bmRlZmluZWQsIF90aGlzLmRpYWxvZ09iai5lbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmRhdGFTdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmluZmluaXRlSW5pdGlhbExvYWQgJiYgdGhpcy5pbmZpbml0ZURhdGFDb3VudCAmJiAoKHRoaXMuaW5maW5pdGVTa2lwQ250ID49IHRoaXMuaW5maW5pdGVEYXRhQ291bnRcbiAgICAgICAgICAgICYmICF0aGlzLmluZmluaXRlU2VhcmNoVmFsQ2hhbmdlKSB8fCAoZS5sZW5ndGggPT09IDApKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZnVsbERhdGEgPSBlO1xuICAgICAgICB2YXIgYXJnczEgPSB7IGRhdGFTb3VyY2U6IHRoaXMuZnVsbERhdGEsIGV4ZWN1dGVRdWVyeTogdHJ1ZSwgZmllbGQ6IHRoaXMub3B0aW9ucy5maWVsZCB9O1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmJlZm9yZUNoZWNrYm94UmVuZGVyZXIsIGFyZ3MxKTtcbiAgICAgICAgaWYgKGFyZ3MxLmV4ZWN1dGVRdWVyeSkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gbmV3IFF1ZXJ5KCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY3VzdG9tUXVlcnkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzRXhlY3V0ZUxvY2FsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5R2VuZXJhdGUocXVlcnkpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNFeGVjdXRlTG9jYWwgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHF1ZXJ5LnNlbGVjdCh0aGlzLm9wdGlvbnMuZmllbGQpO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRhTWFuYWdlcihhcmdzMS5kYXRhU291cmNlKS5leGVjdXRlTG9jYWwocXVlcnkpO1xuICAgICAgICAgICAgdmFyIGNvbCA9IHRoaXMub3B0aW9ucy5jb2x1bW47XG4gICAgICAgICAgICB0aGlzLmZpbHRlcmVkRGF0YSA9IENoZWNrQm94RmlsdGVyQmFzZS5nZXREaXN0aW5jdChyZXN1bHQsIHRoaXMub3B0aW9ucy5maWVsZCwgY29sLCB0aGlzLmZvcmVpZ25LZXlEYXRhLCB0aGlzKS5yZWNvcmRzIHx8IFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkYXRhID0gYXJnczEuZXhlY3V0ZVF1ZXJ5ID8gdGhpcy5maWx0ZXJlZERhdGEgOiBhcmdzMS5kYXRhU291cmNlO1xuICAgICAgICB0aGlzLnByb2Nlc3NEYXRhU291cmNlKG51bGwsIHRydWUsIGRhdGEsIGFyZ3MxKTtcbiAgICAgICAgaWYgKCh0aGlzLmluZmluaXRlUmVuZGVyTW9kICYmIHRoaXMuaW5maW5pdGVJbml0aWFsTG9hZCkgfHwgIXRoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNJbnB1dCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc0lucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmRsZy5xdWVyeVNlbGVjdG9yKCcuZS1jaGstaGlkZGVuJykgJiYgdGhpcy5kbGcucXVlcnlTZWxlY3RvcignLmUtZnRyY2hrJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRsZy5xdWVyeVNlbGVjdG9yKCcuZS1jaGstaGlkZGVuJykuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRsZy5xdWVyeVNlbGVjdG9yKCcuZS1mdHJjaGsnKS5jbGFzc0xpc3QuYWRkKCdlLWNoa2ZvY3VzJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVJbml0aWFsTG9hZCB8fCB0aGlzLmluZmluaXRlU2VhcmNoVmFsQ2hhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLmluZmluaXRlSW5pdGlhbExvYWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaW5maW5pdGVTZWFyY2hWYWxDaGFuZ2UgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIHJlcXVlc3RUeXBlOiBldmVudHMuZmlsdGVyQWZ0ZXJPcGVuLFxuICAgICAgICAgICAgY29sdW1uTmFtZTogdGhpcy5vcHRpb25zLmZpZWxkLCBjb2x1bW5UeXBlOiB0aGlzLm9wdGlvbnMudHlwZVxuICAgICAgICB9O1xuICAgICAgICB2YXIgZmlsdGVyTW9kZWwgPSAnZmlsdGVyTW9kZWwnO1xuICAgICAgICBhcmdzW1wiXCIgKyBmaWx0ZXJNb2RlbF0gPSB0aGlzO1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmNCb3hGbHRyQ29tcGxldGUsIGFyZ3MpO1xuICAgICAgICBpZiAodGhpcy5pc0NoZWNrYm94RmlsdGVyVGVtcGxhdGUpIHtcbiAgICAgICAgICAgIGhpZGVTcGlubmVyKHRoaXMuc3Bpbm5lcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUucXVlcnlHZW5lcmF0ZSA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuc2VhcmNoU2V0dGluZ3MgJiYgdGhpcy5wYXJlbnQuc2VhcmNoU2V0dGluZ3Mua2V5Lmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIG1vZHVsZU5hbWUgPSB0aGlzLm9wdGlvbnMuZGF0YU1hbmFnZXIuYWRhcHRvci5nZXRNb2R1bGVOYW1lO1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKSAmJiBtb2R1bGVOYW1lICYmIG1vZHVsZU5hbWUoKSA9PT0gJ09EYXRhVjRBZGFwdG9yJykge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5zZWFyY2hRdWVyeShxdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VhcmNoU2V0dGluZ3MgPSB0aGlzLnBhcmVudC5zZWFyY2hTZXR0aW5ncztcbiAgICAgICAgICAgICAgICB2YXIgZmllbGRzID0gc2VhcmNoU2V0dGluZ3MuZmllbGRzLmxlbmd0aCA/IHNlYXJjaFNldHRpbmdzLmZpZWxkc1xuICAgICAgICAgICAgICAgICAgICA6IHRoaXMub3B0aW9ucy5jb2x1bW5zLm1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gZi5maWVsZDsgfSk7XG4gICAgICAgICAgICAgICAgcXVlcnkuc2VhcmNoKHNlYXJjaFNldHRpbmdzLmtleSwgZmllbGRzLCBzZWFyY2hTZXR0aW5ncy5vcGVyYXRvciwgc2VhcmNoU2V0dGluZ3MuaWdub3JlQ2FzZSwgc2VhcmNoU2V0dGluZ3MuaWdub3JlQWNjZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoKHRoaXMub3B0aW9ucy5maWx0ZXJlZENvbHVtbnMubGVuZ3RoKSkge1xuICAgICAgICAgICAgdmFyIGNvbHMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vcHRpb25zLmZpbHRlcmVkQ29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmaWx0ZXJDb2x1bW4gPSB0aGlzLm9wdGlvbnMuZmlsdGVyZWRDb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnVpZCkge1xuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJDb2x1bW4udWlkID0gZmlsdGVyQ29sdW1uLnVpZCB8fCB0aGlzLnBhcmVudC5nZXRDb2x1bW5CeUZpZWxkKGZpbHRlckNvbHVtbi5maWVsZCkudWlkO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsdGVyQ29sdW1uLnVpZCAhPT0gdGhpcy5vcHRpb25zLnVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29scy5wdXNoKHRoaXMub3B0aW9ucy5maWx0ZXJlZENvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRlckNvbHVtbi5maWVsZCAhPT0gdGhpcy5vcHRpb25zLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xzLnB1c2godGhpcy5vcHRpb25zLmZpbHRlcmVkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByZWRpY2F0ZSA9IHRoaXMuZ2V0UHJlZGljYXRlRnJvbUNvbHMoY29scywgdGhpcy5pc0V4ZWN1dGVMb2NhbCk7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKSB7XG4gICAgICAgICAgICAgICAgcXVlcnkud2hlcmUocHJlZGljYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5wcm9jZXNzRGF0YVNvdXJjZSA9IGZ1bmN0aW9uIChxdWVyeSwgaXNJbml0aWFsLCBkYXRhU291cmNlLCBhcmdzKSB7XG4gICAgICAgIHNob3dTcGlubmVyKHRoaXMuc3Bpbm5lcik7XG4gICAgICAgIC8vIHF1ZXJ5ID0gcXVlcnkgPyBxdWVyeSA6IHRoaXMub3B0aW9ucy5xdWVyeS5jbG9uZSgpO1xuICAgICAgICAvLyBxdWVyeS5yZXF1aXJlc0NvdW50KCk7XG4gICAgICAgIC8vIGxldCByZXN1bHQ6IE9iamVjdCA9IG5ldyBEYXRhTWFuYWdlcihkYXRhU291cmNlIGFzIEpTT05bXSkuZXhlY3V0ZUxvY2FsKHF1ZXJ5KTtcbiAgICAgICAgLy8gbGV0IHJlczogeyByZXN1bHQ6IE9iamVjdFtdIH0gPSByZXN1bHQgYXMgeyByZXN1bHQ6IE9iamVjdFtdIH07XG4gICAgICAgIHRoaXMuaXNFeGVjdXRlTG9jYWwgPSB0cnVlO1xuICAgICAgICB0aGlzLnVwZGF0ZVJlc3VsdCgpO1xuICAgICAgICB0aGlzLmlzRXhlY3V0ZUxvY2FsID0gZmFsc2U7XG4gICAgICAgIHZhciBhcmdzMSA9IHsgZGF0YVNvdXJjZTogdGhpcy5mdWxsRGF0YSwgaXNDaGVja2JveEZpbHRlclRlbXBsYXRlOiBmYWxzZSwgY29sdW1uOiB0aGlzLm9wdGlvbnMuY29sdW1uLFxuICAgICAgICAgICAgZWxlbWVudDogdGhpcy5jQm94LCB0eXBlOiB0aGlzLm9wdGlvbnMudHlwZSwgZm9ybWF0OiB0aGlzLm9wdGlvbnMudHlwZSwgYnRuT2JqOiB0aGlzLm9wdGlvbnMuaXNSZXNwb25zaXZlRmlsdGVyID8gbnVsbCA6XG4gICAgICAgICAgICAgICAgdGhpcy5kaWFsb2dPYmouYnRuT2JqWzBdLCBzZWFyY2hCb3g6IHRoaXMuc2VhcmNoQm94IH07XG4gICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMuYmVmb3JlQ2hlY2tib3hmaWx0ZXJSZW5kZXJlciwgYXJnczEpO1xuICAgICAgICB0aGlzLmlzQ2hlY2tib3hGaWx0ZXJUZW1wbGF0ZSA9IGFyZ3MxLmlzQ2hlY2tib3hGaWx0ZXJUZW1wbGF0ZTtcbiAgICAgICAgaWYgKCF0aGlzLmlzQ2hlY2tib3hGaWx0ZXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVGaWx0ZXJJdGVtcyhkYXRhU291cmNlLCBpc0luaXRpYWwsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MubG9hZGluZ0luZGljYXRvciA9PT0gJ1NoaW1tZXInKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZU1hc2soKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5wcm9jZXNzU2VhcmNoID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgIHRoaXMucHJvY2Vzc0RhdGFPcGVyYXRpb24ocXVlcnkpO1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS51cGRhdGVSZXN1bHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmVzdWx0ID0ge307XG4gICAgICAgIHZhciBwcmVkaWNhdGUgPSB0aGlzLmluZmluaXRlUmVuZGVyTW9kICYmIHRoaXMuZXhpc3RpbmdQcmVkaWNhdGVbdGhpcy5vcHRpb25zLmZpZWxkXSA/XG4gICAgICAgICAgICB0aGlzLmdldFByZWRpY2F0ZUZyb21Db2xzKHRoaXMuZXhpc3RpbmdQcmVkaWNhdGVbdGhpcy5vcHRpb25zLmZpZWxkXSwgdGhpcy5pc0V4ZWN1dGVMb2NhbCkgOlxuICAgICAgICAgICAgdGhpcy5nZXRQcmVkaWNhdGVGcm9tQ29scyh0aGlzLm9wdGlvbnMuZmlsdGVyZWRDb2x1bW5zLCB0aGlzLmlzRXhlY3V0ZUxvY2FsKTtcbiAgICAgICAgdmFyIHF1ZXJ5ID0gbmV3IFF1ZXJ5KCk7XG4gICAgICAgIGlmIChwcmVkaWNhdGUpIHtcbiAgICAgICAgICAgIHF1ZXJ5LndoZXJlKHByZWRpY2F0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5iZWZvcmVDaGVja2JveFJlbmRlcmVyUXVlcnksIHsgcXVlcnk6IHF1ZXJ5IH0pO1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IERhdGFNYW5hZ2VyKHRoaXMuZnVsbERhdGEpLmV4ZWN1dGVMb2NhbChxdWVyeSk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcmVzdWx0XzEgPSByZXN1bHQ7IF9pIDwgcmVzdWx0XzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgcmVzID0gcmVzdWx0XzFbX2ldO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRbZ2V0T2JqZWN0KHRoaXMub3B0aW9ucy5maWVsZCwgcmVzKV0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChHbG9iYWwudGltZXIpKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoR2xvYmFsLnRpbWVyKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQubG9hZGluZ0luZGljYXRvcikgJiYgdGhpcy5wYXJlbnQubG9hZGluZ0luZGljYXRvci5pbmRpY2F0b3JUeXBlID09PSAnU2hpbW1lcidcbiAgICAgICAgICAgICYmIHBhcmVudHNVbnRpbCh0YXJnZXQsICdlLW1hc2stZnRyY2hrJykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZWxlbSA9IHBhcmVudHNVbnRpbCh0YXJnZXQsICdlLWNoZWNrYm94LXdyYXBwZXInKTtcbiAgICAgICAgaWYgKHBhcmVudHNVbnRpbCh0YXJnZXQsICdlLXNlYXJjaGJveCcpKSB7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaEJveENsaWNrKGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbGVtICYmICF0aGlzLmlzQ2hlY2tib3hGaWx0ZXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgdmFyIHNlbGVjdEFsbCA9IGVsZW0ucXVlcnlTZWxlY3RvcignLmUtc2VsZWN0YWxsJyk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0QWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVBbGxDQm94ZXMoIXNlbGVjdEFsbC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY2hlY2snKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0b29nbGVDaGVja2JveChlbGVtLnBhcmVudEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluZmluaXRlUmVuZGVyTW9kICYmICFlbGVtLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtYWRkLWN1cnJlbnQnKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvY2FsSW5maW5pdGVTZWxlY3Rpb25JbnRlcmFjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhc2VTZW4gPSB0aGlzLm9wdGlvbnMuYWxsb3dDYXNlU2Vuc2l0aXZlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3BhbiA9IGVsZW0ucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1mcmFtZScpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBzcGFuLnByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdHIgPSBpbnB1dC5jaGVja2VkID8gJ2VxdWFsJyA6ICdub3RlcXVhbCc7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmVkID0gaW5wdXQuY2hlY2tlZCA/ICdvcicgOiAnYW5kJztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRzID0geyBmaWVsZDogdGhpcy5vcHRpb25zLmZpZWxkLCBwcmVkaWNhdGU6IHByZWQsIHVpZDogdGhpcy5vcHRpb25zLnVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiBvcHRyLCB0eXBlOiB0aGlzLm9wdGlvbnMudHlwZSwgbWF0Y2hDYXNlOiBjYXNlU2VuLCBpZ25vcmVBY2NlbnQ6IHRoaXMub3B0aW9ucy5pZ25vcmVBY2NlbnRcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy52YWx1ZXNbcGFyZW50c1VudGlsKGlucHV0LCAnZS1mdHJjaGsnKS5nZXRBdHRyaWJ1dGUoJ3VpZCcpXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVJbmZpbml0ZU1hbnVhbFNlbGVjdFByZWQoZGVmYXVsdHMsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgIXRoaXMub3B0aW9ucy5pc1JlbW90ZSAmJiB0aGlzLm9wdGlvbnMucGFyZW50VG90YWxEYXRhQ291bnRcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHRoaXMuaW5maW5pdGVVbmxvYWRQYXJlbnRFeGlzdFByZWQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlZGljYXRlID0gdGhpcy5nZXRQcmVkaWNhdGVGcm9tQ29scygoX2EgPSB0aGlzLm9wdGlvbnMuZmlsdGVyZWRDb2x1bW5zKS5jb25jYXQuYXBwbHkoX2EsIHRoaXMuaW5maW5pdGVNYW51YWxTZWxlY3RNYWludGFpblByZWQpLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IG5ldyBRdWVyeSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZWRpY2F0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5LndoZXJlKHByZWRpY2F0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IERhdGFNYW5hZ2VyKHRoaXMuaW5maW5pdGVQZXJtZW5hbnRMb2NhbERhdGEpLmV4ZWN1dGVMb2NhbChxdWVyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBhcmVudFRvdGFsRGF0YUNvdW50ICE9PSByZXN1bHQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnBhcmVudFRvdGFsRGF0YUNvdW50ID0gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLnBhcmVudFRvdGFsRGF0YUNvdW50ICYmIHRoaXMuaW5maW5pdGVVbmxvYWRQYXJlbnRFeGlzdFByZWQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVVubG9hZFBhcmVudEV4aXN0UHJlZCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluZmluaXRlVW5sb2FkUGFyZW50RXhpc3RQcmVkLmxlbmd0aCAmJiAodGhpcy5vcHRpb25zLnBhcmVudFRvdGFsRGF0YUNvdW50ID09PSB0aGlzLmluZmluaXRlRGF0YUNvdW50XG4gICAgICAgICAgICAgICAgICAgICAgICB8fCAhdGhpcy5vcHRpb25zLnBhcmVudFRvdGFsRGF0YUNvdW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVVubG9hZFBhcmVudEV4aXN0UHJlZCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVJbmRldGVybWluYXRlbkJ0bigpO1xuICAgICAgICAgICAgZWxlbS5xdWVyeVNlbGVjdG9yKCcuZS1jaGstaGlkZGVuJykuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEZvY3VzKHBhcmVudHNVbnRpbChlbGVtLCAnZS1mdHJjaGsnKSk7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLnVwZGF0ZUluZmluaXRlTWFudWFsU2VsZWN0UHJlZCA9IGZ1bmN0aW9uIChkZWZhdWx0cywgdmFsdWUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmluZmluaXRlTWFudWFsU2VsZWN0TWFpbnRhaW5QcmVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcHJlZG1kbCA9IHRoaXMuaW5maW5pdGVNYW51YWxTZWxlY3RNYWludGFpblByZWRbaV07XG4gICAgICAgICAgICBpZiAocHJlZG1kbC52YWx1ZSArICcnID09PSB2YWx1ZSArICcnICYmIChwcmVkbWRsLm9wZXJhdG9yID09PSAnZXF1YWwnIHx8IHByZWRtZGwub3BlcmF0b3IgPT09ICdub3RlcXVhbCcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmZpbml0ZU1hbnVhbFNlbGVjdE1haW50YWluUHJlZC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChkZWZhdWx0cy5wcmVkaWNhdGUgPT09ICdvcicgJiYgKCF0aGlzLmxvY2FsSW5maW5pdGVTZWxlY3RBbGxDbGlja2VkIHx8ICF0aGlzLmluZmluaXRlTG9jYWxTZWxlY3RBbGwpKVxuICAgICAgICAgICAgfHwgKGRlZmF1bHRzLnByZWRpY2F0ZSA9PT0gJ2FuZCcgJiYgKCF0aGlzLmxvY2FsSW5maW5pdGVTZWxlY3RBbGxDbGlja2VkIHx8IHRoaXMuaW5maW5pdGVMb2NhbFNlbGVjdEFsbCkpKSB7XG4gICAgICAgICAgICB0aGlzLmluZmluaXRlTWFudWFsU2VsZWN0TWFpbnRhaW5QcmVkLnB1c2goZXh0ZW5kKHt9LCB7IHZhbHVlOiB2YWx1ZSB9LCBkZWZhdWx0cykpO1xuICAgICAgICAgICAgaWYgKGRlZmF1bHRzLnByZWRpY2F0ZSA9PT0gJ29yJykge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5wYXJlbnRUb3RhbERhdGFDb3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnBhcmVudFRvdGFsRGF0YUNvdW50LS07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0byBzZXQgdGhlIG5leHQgdGFyZ2V0IGVsZW1lbnQgb24ga2V5Ym9hcmQgbmF2aWdhdGlvbiB1c2luZyBhcnJvdyBrZXlzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtLZXlib2FyZEV2ZW50QXJnc30gZSAtIERlZmluZXMgdGhlIEtleWJvYXJkIGV2ZW50IGFyZ3VtZW50XG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudFtdfSBmb2N1c2FibGVFbGVtZW50cyAtIERlZmluZXMgdGhlIEZvY3VzYWJsZSBlbGVtZW50c1xuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuZm9jdXNOZXh0T3JQcmV2ID0gZnVuY3Rpb24gKGUsIGZvY3VzYWJsZUVsZW1lbnRzKSB7XG4gICAgICAgIHZhciBuZXh0SW5kZXggPSAoZS5rZXkgPT09ICdBcnJvd1VwJykgPyBmb2N1c2FibGVFbGVtZW50cy5pbmRleE9mKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpIC0gMVxuICAgICAgICAgICAgOiBmb2N1c2FibGVFbGVtZW50cy5pbmRleE9mKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpICsgMTtcbiAgICAgICAgdmFyIG5leHRFbGVtZW50ID0gZm9jdXNhYmxlRWxlbWVudHNbKChuZXh0SW5kZXggKyBmb2N1c2FibGVFbGVtZW50cy5sZW5ndGgpICUgZm9jdXNhYmxlRWxlbWVudHMubGVuZ3RoKV07XG4gICAgICAgIC8vIFNldCBmb2N1cyBvbiB0aGUgbmV4dCAvIHByZXZpb3VzIGVsZW1lbnRcbiAgICAgICAgaWYgKG5leHRFbGVtZW50KSB7XG4gICAgICAgICAgICBuZXh0RWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IG5leHRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1jaGstaGlkZGVuJykgPyBwYXJlbnRzVW50aWwobmV4dEVsZW1lbnQsICdlLWZ0cmNoaycpIDogbmV4dEVsZW1lbnQ7XG4gICAgICAgICAgICB0aGlzLnNldEZvY3VzKHRhcmdldCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUua2V5dXBIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUua2V5ID09PSAnVGFiJyB8fCAoKGUua2V5ID09PSAnQXJyb3dVcCcgfHwgZS5rZXkgPT09ICdBcnJvd0Rvd24nKSAmJiAhZS5hbHRLZXkpKSB7XG4gICAgICAgICAgICB0aGlzLnNldEZvY3VzKHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZnRyY2hrJykpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgoZS5rZXkgPT09ICdBcnJvd1VwJyB8fCBlLmtleSA9PT0gJ0Fycm93RG93bicpICYmICFlLmFsdEtleSAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5nc1xuICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MudHlwZSA9PT0gJ0NoZWNrQm94Jykge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdmFyIGZvY3VzYWJsZUVsZW1lbnRzID0gQXJyYXkuZnJvbSh0aGlzLmRsZy5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCwgYnV0dG9uLCBbdGFiaW5kZXhdOm5vdChbdGFiaW5kZXg9XCItMVwiXSknKSk7XG4gICAgICAgICAgICB0aGlzLmZvY3VzTmV4dE9yUHJldihlLCBmb2N1c2FibGVFbGVtZW50cyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuc2V0Rm9jdXMgPSBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICB2YXIgcHJldkVsZW0gPSB0aGlzLmRsZy5xdWVyeVNlbGVjdG9yKCcuZS1jaGtmb2N1cycpO1xuICAgICAgICBpZiAocHJldkVsZW0pIHtcbiAgICAgICAgICAgIHByZXZFbGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2UtY2hrZm9jdXMnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZWxlbSAmJiBlbGVtICE9PSBwcmV2RWxlbSkge1xuICAgICAgICAgICAgZWxlbS5jbGFzc0xpc3QuYWRkKCdlLWNoa2ZvY3VzJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUudXBkYXRlQWxsQ0JveGVzID0gZnVuY3Rpb24gKGNoZWNrZWQpIHtcbiAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgIHRoaXMubG9jYWxJbmZpbml0ZVNlbGVjdEFsbENsaWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5pbmZpbml0ZUxvY2FsU2VsZWN0QWxsID0gY2hlY2tlZDtcbiAgICAgICAgICAgIHRoaXMuaW5maW5pdGVVbmxvYWRQYXJlbnRFeGlzdFByZWQgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuaW5maW5pdGVNYW51YWxTZWxlY3RNYWludGFpblByZWQgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY0JveGVzID0gdGhpcy5pbmZpbml0ZVJlbmRlck1vZCA/XG4gICAgICAgICAgICB0aGlzLmluZmluaXRlTG9hZGVkRWxlbS5tYXAoZnVuY3Rpb24gKGFycikge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcnIucXVlcnlTZWxlY3RvcignLmUtZnJhbWUnKTtcbiAgICAgICAgICAgIH0pIDogW10uc2xpY2UuY2FsbCh0aGlzLmNCb3gucXVlcnlTZWxlY3RvckFsbCgnLmUtZnJhbWU6bm90KC5lLWFkZC1jdXJyZW50KScpKTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBjQm94ZXNfMSA9IGNCb3hlczsgX2kgPCBjQm94ZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBjQm94ID0gY0JveGVzXzFbX2ldO1xuICAgICAgICAgICAgcmVtb3ZlQWRkQ2JveENsYXNzZXMoY0JveCwgY2hlY2tlZCk7XG4gICAgICAgICAgICBzZXRDaGVja2VkKGNCb3gucHJldmlvdXNTaWJsaW5nLCBjaGVja2VkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLnByb3RvdHlwZS5kaWFsb2dPcGVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZGV2aWNlJykpIHtcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtaW5wdXQtZ3JvdXAnKS5jbGFzc0xpc3QucmVtb3ZlKCdlLWlucHV0LWZvY3VzJyk7XG4gICAgICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5pc1Jlc3BvbnNpdmVGaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpYWxvZ09iai5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWJ0bicpLmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5wcm90b3R5cGUuY3JlYXRlQ2hlY2tib3ggPSBmdW5jdGlvbiAodmFsdWUsIGNoZWNrZWQsIGRhdGEpIHtcbiAgICAgICAgdmFyIGVsZW0gPSBjaGVja2VkID8gdGhpcy5jQm94VHJ1ZS5jbG9uZU5vZGUodHJ1ZSkgOlxuICAgICAgICAgICAgdGhpcy5jQm94RmFsc2UuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICBzZXRDaGVja2VkKGVsZW0ucXVlcnlTZWxlY3RvcignaW5wdXQnKSwgY2hlY2tlZCk7XG4gICAgICAgIHZhciBsYWJlbCA9IGVsZW0ucXVlcnlTZWxlY3RvcignLmUtbGFiZWwnKTtcbiAgICAgICAgdmFyIGR1bW15RGF0YSA9IGV4dGVuZE9ialdpdGhGbih7fSwgZGF0YSwgeyBjb2x1bW46IHRoaXMub3B0aW9ucy5jb2x1bW4sIHBhcmVudDogdGhpcy5wYXJlbnQgfSk7XG4gICAgICAgIHZhciBpbm5lclRleHQgPSB0aGlzLm9wdGlvbnMuZGlzYWJsZUh0bWxFbmNvZGUgPyAndGV4dENvbnRlbnQnIDogJ2lubmVySFRNTCc7XG4gICAgICAgIGxhYmVsW1wiXCIgKyBpbm5lclRleHRdID0gIWlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSAmJiB2YWx1ZS50b1N0cmluZygpLmxlbmd0aCA/XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5lbmFibGVIdG1sU2FuaXRpemVyID8gU2FuaXRpemVIdG1sSGVscGVyLnNhbml0aXplKHZhbHVlKSA6IHZhbHVlIDogdGhpcy5nZXRMb2NhbGl6ZWRMYWJlbCgnQmxhbmtzJyk7XG4gICAgICAgIHZhciBjaGVja2JveFVpZCA9IGdldFVpZCgnY2JveCcpO1xuICAgICAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2lkJywgY2hlY2tib3hVaWQgKyAnY2JveExhYmVsJyk7XG4gICAgICAgIGVsZW0ucXVlcnlTZWxlY3RvcignaW5wdXQnKS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsIGxhYmVsLmlkKTtcbiAgICAgICAgaWYgKGxhYmVsLmlubmVySFRNTCA9PT0gdGhpcy5nZXRMb2NhbGl6ZWRMYWJlbCgnQmxhbmtzJykpIHtcbiAgICAgICAgICAgIHRoaXMuaXNCbGFua3MgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgbGFiZWwuaW5uZXJIVE1MID0gdmFsdWUgPT09IHRydWUgPyB0aGlzLmdldExvY2FsaXplZExhYmVsKCdGaWx0ZXJUcnVlJykgOiB0aGlzLmdldExvY2FsaXplZExhYmVsKCdGaWx0ZXJGYWxzZScpO1xuICAgICAgICB9XG4gICAgICAgIGFkZENsYXNzKFtsYWJlbF0sIFsnZS1jaGVja2JveGZpbHRlcnRleHQnXSk7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMudGVtcGxhdGUgJiYgZGF0YVt0aGlzLm9wdGlvbnMuY29sdW1uLmZpZWxkXSAhPT0gdGhpcy5nZXRMb2NhbGl6ZWRMYWJlbCgnU2VsZWN0QWxsJylcbiAgICAgICAgICAgICYmIGRhdGFbdGhpcy5vcHRpb25zLmNvbHVtbi5maWVsZF0gIT09IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwoJ0FkZEN1cnJlbnRTZWxlY3Rpb24nKSkge1xuICAgICAgICAgICAgbGFiZWwuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICB2YXIgaXNSZWFjdENvbXBpbGVyID0gdGhpcy5wYXJlbnQuaXNSZWFjdCAmJiB0aGlzLm9wdGlvbnMuY29sdW1uLmZpbHRlclxuICAgICAgICAgICAgICAgICYmIHR5cGVvZiAodGhpcy5vcHRpb25zLmNvbHVtbi5maWx0ZXIuaXRlbVRlbXBsYXRlKSAhPT0gJ3N0cmluZycgJiZcbiAgICAgICAgICAgICAgICAhKHRoaXMub3B0aW9ucy5jb2x1bW4uZmlsdGVyLml0ZW1UZW1wbGF0ZS5wcm90b3R5cGUgJiYgdGhpcy5vcHRpb25zLmNvbHVtbi5maWx0ZXIuaXRlbVRlbXBsYXRlLnByb3RvdHlwZS5DU1BUZW1wbGF0ZSk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgdmFyIGlzUmVhY3RDaGlsZCA9IHRoaXMucGFyZW50LnBhcmVudERldGFpbHMgJiYgdGhpcy5wYXJlbnQucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqICYmXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmouaXNSZWFjdDtcbiAgICAgICAgICAgIGlmIChpc1JlYWN0Q29tcGlsZXIgfHwgaXNSZWFjdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnRlbXBsYXRlKGR1bW15RGF0YSwgdGhpcy5wYXJlbnQsICdmaWx0ZXJJdGVtVGVtcGxhdGUnLCBudWxsLCBudWxsLCBudWxsLCBsYWJlbCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQucmVuZGVyVGVtcGxhdGVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhcHBlbmRDaGlsZHJlbihsYWJlbCwgdGhpcy5vcHRpb25zLnRlbXBsYXRlKGR1bW15RGF0YSwgdGhpcy5wYXJlbnQsICdmaWx0ZXJJdGVtVGVtcGxhdGUnLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCB0aGlzLnBhcmVudC5yb290KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsZW07XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLnVwZGF0ZUluZGV0ZXJtaW5hdGVuQnRuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY250ID0gdGhpcy5pbmZpbml0ZVJlbmRlck1vZCA/IHRoaXMuaW5maW5pdGVMb2FkZWRFbGVtLmxlbmd0aCA6IHRoaXMuY0JveC5jaGlsZHJlbi5sZW5ndGggLSAxO1xuICAgICAgICB2YXIgY2xhc3NOYW1lID0gW107XG4gICAgICAgIHZhciBkaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB2YXIgZWxlbSA9IHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgPyB0aGlzLnNCb3gucXVlcnlTZWxlY3RvcignLmUtc2VsZWN0YWxsJykgOiB0aGlzLmNCb3gucXVlcnlTZWxlY3RvcignLmUtc2VsZWN0YWxsJyk7XG4gICAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgPyB0aGlzLmluZmluaXRlTG9hZGVkRWxlbS5maWx0ZXIoZnVuY3Rpb24gKGFycikgeyByZXR1cm4gYXJyLnF1ZXJ5U2VsZWN0b3IoJy5lLWNoZWNrJyk7IH0pLmxlbmd0aCA6XG4gICAgICAgICAgICB0aGlzLmNCb3gucXVlcnlTZWxlY3RvckFsbCgnLmUtY2hlY2s6bm90KC5lLXNlbGVjdGFsbCk6bm90KC5lLWFkZC1jdXJyZW50KScpLmxlbmd0aDtcbiAgICAgICAgaWYgKHRoaXMuY0JveC5xdWVyeVNlbGVjdG9yKCcuZS1hZGQtY3VycmVudCcpKSB7XG4gICAgICAgICAgICBjbnQgLT0gMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYnRuO1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5pc1Jlc3BvbnNpdmVGaWx0ZXIpIHtcbiAgICAgICAgICAgIGJ0biA9IHRoaXMuZGlhbG9nT2JqLmJ0bk9ialswXTtcbiAgICAgICAgICAgIGJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnB1dCA9IGVsZW0ucHJldmlvdXNTaWJsaW5nO1xuICAgICAgICBzZXRDaGVja2VkKGlucHV0LCBmYWxzZSk7XG4gICAgICAgIGlucHV0LmluZGV0ZXJtaW5hdGUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgdGhpcy5zSW5wdXQudmFsdWUgPT09ICcnICYmICF0aGlzLm9wdGlvbnMucGFyZW50Q3VycmVudFZpZXdEYXRhQ291bnQgJiYgIXRoaXMubG9jYWxJbmZpbml0ZVNlbGVjdGlvbkludGVyYWN0ZWRcbiAgICAgICAgICAgICYmICghdGhpcy5sb2NhbEluZmluaXRlU2VsZWN0QWxsQ2xpY2tlZCB8fCAoIXRoaXMuaW5maW5pdGVMb2NhbFNlbGVjdEFsbCAmJiAhc2VsZWN0ZWQpKSAmJiAoY250ICE9PSBzZWxlY3RlZCB8fCBjbnQgPT09IHNlbGVjdGVkKSkge1xuICAgICAgICAgICAgc2VsZWN0ZWQgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgdGhpcy5pbmZpbml0ZUxvYWRlZEVsZW0ubGVuZ3RoIDwgdGhpcy5pbmZpbml0ZURhdGFDb3VudFxuICAgICAgICAgICAgJiYgdGhpcy5pbmZpbml0ZVVubG9hZFBhcmVudEV4aXN0UHJlZC5sZW5ndGggJiYgKCFzZWxlY3RlZCB8fCBjbnQgPT09IHNlbGVjdGVkKSAmJiB0aGlzLmluZmluaXRlTG9jYWxTZWxlY3RBbGwpIHtcbiAgICAgICAgICAgIGlmICghc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCArPSB0aGlzLmluZmluaXRlVW5sb2FkUGFyZW50RXhpc3RQcmVkLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNudCArPSB0aGlzLmluZmluaXRlVW5sb2FkUGFyZW50RXhpc3RQcmVkLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY250ID09PSBzZWxlY3RlZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluZmluaXRlTG9jYWxTZWxlY3RBbGwgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYWxJbmZpbml0ZVNlbGVjdEFsbENsaWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5maW5pdGVNYW51YWxTZWxlY3RNYWludGFpblByZWQgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNsYXNzTmFtZSA9IFsnZS1jaGVjayddO1xuICAgICAgICAgICAgc2V0Q2hlY2tlZChpbnB1dCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZSA9IFsnZS1zdG9wJ107XG4gICAgICAgICAgICBpbnB1dC5pbmRldGVybWluYXRlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmluZmluaXRlUmVuZGVyTW9kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmZpbml0ZUxvY2FsU2VsZWN0QWxsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2NhbEluZmluaXRlU2VsZWN0QWxsQ2xpY2tlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmZpbml0ZU1hbnVhbFNlbGVjdE1haW50YWluUHJlZCA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xhc3NOYW1lID0gWydlLXVuY2hlY2snXTtcbiAgICAgICAgICAgIGRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChidG4pIHtcbiAgICAgICAgICAgICAgICBidG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChidG4pIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyU3RhdGUgPSAhYnRuLmRpc2FibGVkO1xuICAgICAgICAgICAgYnRuLmRhdGFCaW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVtb3ZlQ2xhc3MoW2VsZW1dLCBbJ2UtY2hlY2snLCAnZS1zdG9wJywgJ2UtdW5jaGVjayddKTtcbiAgICAgICAgYWRkQ2xhc3MoW2VsZW1dLCBjbGFzc05hbWUpO1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnJlZnJlc2hDdXN0b21GaWx0ZXJPa0J0biwgeyBkaXNhYmxlZDogZGlzYWJsZWQgfSk7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmNyZWF0ZUZpbHRlckl0ZW1zID0gZnVuY3Rpb24gKGRhdGEsIGlzSW5pdGlhbCwgYXJnczEpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIHZhciBjQm94ZXMgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdmFyIGJ0bjtcbiAgICAgICAgdmFyIGRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmlzUmVzcG9uc2l2ZUZpbHRlcikge1xuICAgICAgICAgICAgYnRuID0gdGhpcy5kaWFsb2dPYmouYnRuT2JqWzBdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBudWxsQ291bnRlciA9IC0xO1xuICAgICAgICB2YXIga2V5ID0gJ2VqVmFsdWUnO1xuICAgICAgICBpZiAoIWFyZ3MxLmV4ZWN1dGVRdWVyeSkge1xuICAgICAgICAgICAga2V5ID0gYXJnczEuZmllbGQ7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gZ2V0VmFsdWUoa2V5LCBkYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICBpZiAodmFsID09PSAnJyB8fCBpc051bGxPclVuZGVmaW5lZCh2YWwpKSB7XG4gICAgICAgICAgICAgICAgbnVsbENvdW50ZXIgPSBudWxsQ291bnRlciArIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmluZmluaXRlUmVuZGVyTW9kKSB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zQ250ID0gbnVsbENvdW50ZXIgIT09IC0xID8gZGF0YS5sZW5ndGggLSBudWxsQ291bnRlciA6IGRhdGEubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmluZmluaXRlUmVuZGVyTW9kICYmIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzICYmIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLmxvYWRpbmdJbmRpY2F0b3IgPT09ICdTaGltbWVyJykge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVNYXNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoICYmICF0aGlzLnJlbmRlckVtcHR5KSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0QWxsVmFsdWUgPSB0aGlzLmdldExvY2FsaXplZExhYmVsKCdTZWxlY3RBbGwnKTtcbiAgICAgICAgICAgIHZhciBpbm5lckRpdiA9IHRoaXMuY0JveC5xdWVyeVNlbGVjdG9yKCcuZS1jaGVja2ZsdHJubWRpdicpO1xuICAgICAgICAgICAgaWYgKGlubmVyRGl2KSB7XG4gICAgICAgICAgICAgICAgaW5uZXJEaXYuY2xhc3NMaXN0LnJlbW92ZSgnZS1jaGVja2ZsdHJubWRpdicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNoZWNrQm94ID0gdGhpcy5jcmVhdGVDaGVja2JveChzZWxlY3RBbGxWYWx1ZSwgZmFsc2UsIChfYSA9IHt9LCBfYVt0aGlzLm9wdGlvbnMuZmllbGRdID0gc2VsZWN0QWxsVmFsdWUsIF9hKSk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuY3NzQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuY3NzQ2xhc3MuaW5kZXhPZignICcpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhbY2hlY2tCb3hdLCB0aGlzLnBhcmVudC5jc3NDbGFzcy5zcGxpdCgnICcpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZENsYXNzKFtjaGVja0JveF0sIFt0aGlzLnBhcmVudC5jc3NDbGFzc10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmluZmluaXRlSW5pdGlhbExvYWQgfHwgIXRoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0QWxsID0gY3JlYXRlQ2JveFdpdGhXcmFwKGdldFVpZCgnY2JveCcpLCBjaGVja0JveCwgJ2UtZnRyY2hrJyk7XG4gICAgICAgICAgICAgICAgc2VsZWN0QWxsLnF1ZXJ5U2VsZWN0b3IoJy5lLWZyYW1lJykuY2xhc3NMaXN0LmFkZCgnZS1zZWxlY3RhbGwnKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RBbGwuY2xhc3NMaXN0LmFkZCgnZS1pbmZpbml0ZXNjcm9sbCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlQWRhcHRpdmVVSSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGlubmVyLnN0eWxlLmhlaWdodCA9ICh0aGlzLnNwaW5uZXIub2Zmc2V0SGVpZ2h0IC0gZ2V0TGlzdEhlaWdodCh0aGlzLmNCb3gpKSArICdweCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zQm94Lmluc2VydEJlZm9yZShzZWxlY3RBbGwsIHRoaXMuc3Bpbm5lcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjQm94ZXMuYXBwZW5kQ2hpbGQoc2VsZWN0QWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnNCb3gucXVlcnlTZWxlY3RvcignLmUtZnRyY2hrIC5lLXNlbGVjdGFsbCcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zQm94LnF1ZXJ5U2VsZWN0b3IoJy5lLWZ0cmNoayAuZS1zZWxlY3RhbGwnKS5wcmV2aW91c1NpYmxpbmcuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnNCb3gucXVlcnlTZWxlY3RvcignLmUtZnRyY2hrIC5lLXNlbGVjdGFsbCcpLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZS1jaGVja2JveC1kaXNhYmxlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByZWRpY2F0ZSA9IG5ldyBQcmVkaWNhdGUoJ2ZpZWxkJywgJ2VxdWFsJywgdGhpcy5vcHRpb25zLmZpZWxkKTtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZm9yZWlnbktleVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcHJlZGljYXRlID0gcHJlZGljYXRlLm9yKCdmaWVsZCcsICdlcXVhbCcsIHRoaXMub3B0aW9ucy5mb3JlaWduS2V5VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlzQ29sRmlsdGVyZWQgPSBuZXcgRGF0YU1hbmFnZXIodGhpcy5vcHRpb25zLmZpbHRlcmVkQ29sdW1ucykuZXhlY3V0ZUxvY2FsKG5ldyBRdWVyeSgpLndoZXJlKHByZWRpY2F0ZSkpLmxlbmd0aDtcbiAgICAgICAgICAgIGlmICh0aGlzLnNJbnB1dCAmJiB0aGlzLnNJbnB1dC52YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwcmVkaWNhdGVDaGVja0JveCA9IHRoaXMuY3JlYXRlQ2hlY2tib3godGhpcy5nZXRMb2NhbGl6ZWRMYWJlbCgnQWRkQ3VycmVudFNlbGVjdGlvbicpLCBmYWxzZSwgKF9iID0ge30sXG4gICAgICAgICAgICAgICAgICAgIF9iW3RoaXMub3B0aW9ucy5maWVsZF0gPSB0aGlzLmdldExvY2FsaXplZExhYmVsKCdBZGRDdXJyZW50U2VsZWN0aW9uJyksXG4gICAgICAgICAgICAgICAgICAgIF9iKSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNzc0NsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5jc3NDbGFzcy5pbmRleE9mKCcgJykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhbcHJlZGljYXRlQ2hlY2tCb3hdLCB0aGlzLnBhcmVudC5jc3NDbGFzcy5zcGxpdCgnICcpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZENsYXNzKFtwcmVkaWNhdGVDaGVja0JveF0sIFt0aGlzLnBhcmVudC5jc3NDbGFzc10pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgodGhpcy5pbmZpbml0ZVJlbmRlck1vZCAmJiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc0JveC5jaGlsZHJlblsyXSlcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5zQm94LmNoaWxkcmVuWzJdLmlubmVyVGV4dCAhPT0gdGhpcy5nZXRMb2NhbGl6ZWRMYWJlbCgnQWRkQ3VycmVudFNlbGVjdGlvbicpKSkgfHwgIXRoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZWRpY2F0ZUVsZW1lbnQgPSBjcmVhdGVDYm94V2l0aFdyYXAoZ2V0VWlkKCdjYm94JyksIHByZWRpY2F0ZUNoZWNrQm94LCAnZS1mdHJjaGsnKTtcbiAgICAgICAgICAgICAgICAgICAgcHJlZGljYXRlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1mcmFtZScpLmNsYXNzTGlzdC5hZGQoJ2UtYWRkLWN1cnJlbnQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWRpY2F0ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1pbmZpbml0ZXNjcm9sbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zQm94Lmluc2VydEJlZm9yZShwcmVkaWNhdGVFbGVtZW50LCB0aGlzLnNwaW5uZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrQm94TGlzdEVsZW0gPSB0aGlzLnNwaW5uZXIucXVlcnlTZWxlY3RvcignLmUtY2hlY2tib3hsaXN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVkdWNlSGVpZ2h0ID0gTWF0aC5jZWlsKHByZWRpY2F0ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrQm94TGlzdEVsZW0uc3R5bGUuaGVpZ2h0ID0gKHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUoY2hlY2tCb3hMaXN0RWxlbSkuaGVpZ2h0LnNwbGl0KCdweCcpWzBdLCAxMCkgLSByZWR1Y2VIZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tCb3hMaXN0RWxlbS5zdHlsZS5taW5IZWlnaHQgPSBjaGVja0JveExpc3RFbGVtLnN0eWxlLmhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNCb3hlcy5hcHBlbmRDaGlsZChwcmVkaWNhdGVFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnNCb3gucXVlcnlTZWxlY3RvcignLmUtZnRyY2hrIC5lLWFkZC1jdXJyZW50JykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zQm94LnF1ZXJ5U2VsZWN0b3IoJy5lLWZ0cmNoayAuZS1hZGQtY3VycmVudCcpLnByZXZpb3VzU2libGluZy5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNCb3gucXVlcnlTZWxlY3RvcignLmUtZnRyY2hrIC5lLWFkZC1jdXJyZW50JykucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdlLWNoZWNrYm94LWRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCAmJiAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5zQm94LmNoaWxkcmVuWzJdKVxuICAgICAgICAgICAgICAgICYmIHRoaXMuc0JveC5jaGlsZHJlblsyXS5pbm5lclRleHQgPT09IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwoJ0FkZEN1cnJlbnRTZWxlY3Rpb24nKSkge1xuICAgICAgICAgICAgICAgIHZhciBjaGVja0JveExpc3RFbGVtID0gdGhpcy5zcGlubmVyLnF1ZXJ5U2VsZWN0b3IoJy5lLWNoZWNrYm94bGlzdCcpO1xuICAgICAgICAgICAgICAgIHZhciBpbmNyZWFzZUhlaWdodCA9IE1hdGguY2VpbCh0aGlzLnNCb3guY2hpbGRyZW5bMl0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBjaGVja0JveExpc3RFbGVtLnN0eWxlLmhlaWdodCA9IChwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKGNoZWNrQm94TGlzdEVsZW0pLmhlaWdodC5zcGxpdCgncHgnKVswXSwgMTApICsgaW5jcmVhc2VIZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgICsgJ3B4JztcbiAgICAgICAgICAgICAgICBjaGVja0JveExpc3RFbGVtLnN0eWxlLm1pbkhlaWdodCA9IGNoZWNrQm94TGlzdEVsZW0uc3R5bGUuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIHJlbW92ZSh0aGlzLnNCb3guY2hpbGRyZW5bMl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlzUm5kZXJlID0gdm9pZCAwO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVpZCA9IGdldFVpZCgnY2JveCcpO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVzW1wiXCIgKyB1aWRdID0gZ2V0VmFsdWUoa2V5LCBkYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZ2V0VmFsdWUodGhpcy5vcHRpb25zLmZpZWxkLCBkYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5mb3JtYXRGbikge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMudmFsdWVGb3JtYXR0ZXIudG9WaWV3KHZhbHVlLCB0aGlzLm9wdGlvbnMuZm9ybWF0Rm4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgYXJnc18xID0geyB2YWx1ZTogdmFsdWUsIGNvbHVtbjogdGhpcy5vcHRpb25zLmNvbHVtbiwgZGF0YTogZGF0YVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0gfTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmZpbHRlckNib3hWYWx1ZSwgYXJnc18xKTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGFyZ3NfMS52YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAoKHZhbHVlID09PSAnJyB8fCBpc051bGxPclVuZGVmaW5lZCh2YWx1ZSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1JuZGVyZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaXNSbmRlcmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUluZmluaXRlVW5Mb2FkZWRDaGVja2JveEV4aXN0UHJlZCh2YWx1ZSwgdGhpcy5pbmZpbml0ZVVubG9hZFBhcmVudEV4aXN0UHJlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjaGVja2JveCA9IHRoaXMubG9jYWxJbmZpbml0ZVNlbGVjdEFsbENsaWNrZWQgP1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUNoZWNrYm94KHZhbHVlLCB0aGlzLmluZmluaXRlTG9jYWxTZWxlY3RBbGwsIGdldFZhbHVlKCdkYXRhT2JqJywgZGF0YVtpXSkpIDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVDaGVja2JveCh2YWx1ZSwgdGhpcy5nZXRDaGVja2VkU3RhdGUoaXNDb2xGaWx0ZXJlZCwgdGhpcy52YWx1ZXNbXCJcIiArIHVpZF0pLCBnZXRWYWx1ZSgnZGF0YU9iaicsIGRhdGFbaV0pKTtcbiAgICAgICAgICAgICAgICBjQm94ZXMuYXBwZW5kQ2hpbGQoY3JlYXRlQ2JveFdpdGhXcmFwKHVpZCwgY2hlY2tib3gsICdlLWZ0cmNoaycpKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgICAgICBjQm94ZXMubGFzdENoaWxkLnN0eWxlLmhlaWdodCA9IGdldExpc3RIZWlnaHQodGhpcy5jQm94KSArICdweCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCA9IHRoaXMuY0JveC5zY3JvbGxUb3A7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaW5maW5pdGVSZW5kZXJNb2QgfHwgdGhpcy5pbmZpbml0ZVNlYXJjaFZhbENoYW5nZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY0JveC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgdGhpcy5jQm94LmNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGluZmluaXRlUmVtb3ZlRWxlbWVudHMoKFtdLnNsaWNlLmNhbGwodGhpcy5jQm94LmNoaWxkcmVuKSkuc3BsaWNlKDAsIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLml0ZW1zQ291bnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmluZmluaXRlUmVuZGVyTW9kKSB7XG4gICAgICAgICAgICAgICAgKF9jID0gdGhpcy5pbmZpbml0ZUxvYWRlZEVsZW0pLnB1c2guYXBwbHkoX2MsIFtdLnNsaWNlLmNhbGwoY0JveGVzLmNoaWxkcmVuKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtc0NudCA9IG51bGxDb3VudGVyICE9PSAtMSA/IHRoaXMuaW5maW5pdGVMb2FkZWRFbGVtLmxlbmd0aCAtIG51bGxDb3VudGVyIDogdGhpcy5pbmZpbml0ZUxvYWRlZEVsZW0ubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVVbmxvYWRQYXJlbnRFeGlzdFByZWQubGVuZ3RoICYmICh0aGlzLmluZmluaXRlTG9hZGVkRWxlbS5sZW5ndGggPj0gdGhpcy5pbmZpbml0ZURhdGFDb3VudFxuICAgICAgICAgICAgICAgIHx8ICF0aGlzLm9wdGlvbnMucGFyZW50Q3VycmVudFZpZXdEYXRhQ291bnQgfHwgKHRoaXMub3B0aW9ucy5wYXJlbnRUb3RhbERhdGFDb3VudCA9PT0gdGhpcy5pbmZpbml0ZURhdGFDb3VudFxuICAgICAgICAgICAgICAgICYmIHRoaXMub3B0aW9ucy5wYXJlbnRDdXJyZW50Vmlld0RhdGFDb3VudCkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVVubG9hZFBhcmVudEV4aXN0UHJlZCA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXBwZW5kQ2hpbGRyZW4odGhpcy5jQm94LCBbXS5zbGljZS5jYWxsKGNCb3hlcy5jaGlsZHJlbikpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaW5maW5pdGVSZW5kZXJNb2QgJiYgIXRoaXMuaW5maW5pdGVTY3JvbGxBcHBlbmREaWZmKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVNjcm9sbEFwcGVuZERpZmYgPSBNYXRoLnJvdW5kKHNjcm9sbFRvcCAtIHRoaXMuY0JveC5zY3JvbGxUb3ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVJbmRldGVybWluYXRlbkJ0bigpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmluZmluaXRlUmVuZGVyTW9kKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJ0bikge1xuICAgICAgICAgICAgICAgICAgICBidG4uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChidG4gJiYgYnRuLmRpc2FibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY0JveGVzLmFwcGVuZENoaWxkKHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGlubmVySFRNTDogdGhpcy5nZXRMb2NhbGl6ZWRMYWJlbCgnTm9SZXN1bHQnKSB9KSk7XG4gICAgICAgICAgICB0aGlzLmNCb3guaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RBbGwgPSB0aGlzLnNCb3gucXVlcnlTZWxlY3RvcignLmUtZnRyY2hrIC5lLXNlbGVjdGFsbCcpO1xuICAgICAgICAgICAgICAgIGlmIChzZWxlY3RBbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdEFsbFBhcmVudCA9IHNlbGVjdEFsbC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RBbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNoZWNrJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2dsZUNoZWNrYm94KHNlbGVjdEFsbFBhcmVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc2VsZWN0QWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1zdG9wJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2dsZUNoZWNrYm94KHNlbGVjdEFsbFBhcmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RBbGwuY2xhc3NMaXN0LnJlbW92ZSgnZS1zdG9wJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b29nbGVDaGVja2JveChzZWxlY3RBbGxQYXJlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdEFsbC5wcmV2aW91c1NpYmxpbmcuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RBbGwucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLWNoZWNrYm94LWRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBhZGRDdXJyU2VsZWN0aW9uID0gdGhpcy5zQm94LnF1ZXJ5U2VsZWN0b3IoJy5lLWZ0cmNoayAuZS1hZGQtY3VycmVudCcpO1xuICAgICAgICAgICAgICAgIGlmIChhZGRDdXJyU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhZGRDdXJyU2VsZWN0aW9uUGFyZW50ID0gYWRkQ3VyclNlbGVjdGlvbi5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhZGRDdXJyU2VsZWN0aW9uLmNsYXNzTGlzdC5jb250YWlucygnZS1jaGVjaycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b29nbGVDaGVja2JveChhZGRDdXJyU2VsZWN0aW9uUGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhZGRDdXJyU2VsZWN0aW9uLnByZXZpb3VzU2libGluZy5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGFkZEN1cnJTZWxlY3Rpb24ucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLWNoZWNrYm94LWRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jQm94LmFwcGVuZENoaWxkKHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnZS1jaGVja2ZsdHJubWRpdicgfSkpO1xuICAgICAgICAgICAgYXBwZW5kQ2hpbGRyZW4odGhpcy5jQm94LmNoaWxkcmVuWzBdLCBbXS5zbGljZS5jYWxsKGNCb3hlcy5jaGlsZHJlbikpO1xuICAgICAgICAgICAgaWYgKGJ0bikge1xuICAgICAgICAgICAgICAgIGJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmZpbHRlclN0YXRlID0gIWRpc2FibGVkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChidG4gJiYgZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyU3RhdGUgPSAhYnRuLmRpc2FibGVkO1xuICAgICAgICAgICAgYnRuLmRhdGFCaW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFyZ3MgPSB7IHJlcXVlc3RUeXBlOiBldmVudHMuZmlsdGVyQ2hvaWNlUmVxdWVzdCwgZGF0YVNvdXJjZTogdGhpcy5yZW5kZXJFbXB0eSA/IFtdIDogZGF0YSB9O1xuICAgICAgICB2YXIgZmlsdGVyTW9kZWwgPSAnZmlsdGVyTW9kZWwnO1xuICAgICAgICBhcmdzW1wiXCIgKyBmaWx0ZXJNb2RlbF0gPSB0aGlzO1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmNCb3hGbHRyQ29tcGxldGUsIGFyZ3MpO1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnJlZnJlc2hDdXN0b21GaWx0ZXJPa0J0biwgeyBkaXNhYmxlZDogZGlzYWJsZWQgfSk7XG4gICAgICAgIGlmICh0aGlzLmluZmluaXRlUmVuZGVyTW9kICYmIHRoaXMuaW5maW5pdGVJbml0aWFsTG9hZCkge1xuICAgICAgICAgICAgdGhpcy5jQm94LnN0eWxlLm1hcmdpblRvcCA9ICcwcHgnO1xuICAgICAgICB9XG4gICAgICAgIGhpZGVTcGlubmVyKHRoaXMuc3Bpbm5lcik7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLnVwZGF0ZUluZmluaXRlVW5Mb2FkZWRDaGVja2JveEV4aXN0UHJlZCA9IGZ1bmN0aW9uICh2YWx1ZSwgdXBkYXRlUHJlZEFycikge1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHVwZGF0ZVByZWRBcnIubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHZhciBwcmVkID0gdXBkYXRlUHJlZEFycltqXTtcbiAgICAgICAgICAgIHZhciBwcmVkVmFsdWUgPSBwcmVkLnZhbHVlIGluc3RhbmNlb2YgRGF0ZSA/XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZUZvcm1hdHRlci50b1ZpZXcocHJlZC52YWx1ZSwgdGhpcy5vcHRpb25zLmZvcm1hdEZuKSA6IHByZWQudmFsdWU7XG4gICAgICAgICAgICB2YXIgY29sdW1uID0gdGhpcy5vcHRpb25zLmNvbHVtbjtcbiAgICAgICAgICAgIGlmIChjb2x1bW4uaXNGb3JlaWduQ29sdW1uKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZm9yZWlnbkRhdGFPYmogPSBnZXRGb3JlaWduRGF0YShjb2x1bW4sIHt9LCBwcmVkVmFsdWUsIHRoaXMuZm9yZWlnbktleURhdGEpWzBdO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZ2V0VmFsdWUoY29sdW1uLmZvcmVpZ25LZXlGaWVsZCwgZm9yZWlnbkRhdGFPYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBwcmVkVmFsdWUgJiYgKHByZWQub3BlcmF0b3IgPT09ICdlcXVhbCcgfHwgcHJlZC5vcGVyYXRvciA9PT0gJ25vdGVxdWFsJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluZmluaXRlTWFudWFsU2VsZWN0TWFpbnRhaW5QcmVkLnB1c2godXBkYXRlUHJlZEFycltqXSk7XG4gICAgICAgICAgICAgICAgdXBkYXRlUHJlZEFyci5zcGxpY2UoaiwgMSk7XG4gICAgICAgICAgICAgICAgai0tO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UucHJvdG90eXBlLmdldENoZWNrZWRTdGF0ZSA9IGZ1bmN0aW9uIChpc0NvbEZpbHRlcmVkLCB2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNGaWx0ZXJlZCB8fCAhaXNDb2xGaWx0ZXJlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY2hlY2tTdGF0ZSA9IHRoaXMuc0lucHV0ICYmIHRoaXMuc0lucHV0LnZhbHVlID8gdHJ1ZSA6IHRoaXMucmVzdWx0W1wiXCIgKyB2YWx1ZV07XG4gICAgICAgICAgICBpZiAodGhpcy5pbmZpbml0ZVJlbmRlck1vZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjaGVja1N0YXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5vcGVyYXRvciA9PT0gJ25vdGVxdWFsJyA/ICFjaGVja1N0YXRlIDogY2hlY2tTdGF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLmdldERpc3RpbmN0ID0gZnVuY3Rpb24gKGpzb24sIGZpZWxkLCBjb2x1bW4sIGZvcmVpZ25LZXlEYXRhLCBjaGVja2JveEZpbHRlcikge1xuICAgICAgICB2YXIgbGVuID0ganNvbi5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICB2YXIgZWpWYWx1ZSA9ICdlalZhbHVlJztcbiAgICAgICAgdmFyIGxvb2t1cCA9IHt9O1xuICAgICAgICB2YXIgaXNGb3JlaWduS2V5ID0gY29sdW1uICYmIGNvbHVtbi5pc0ZvcmVpZ25Db2x1bW4gPyBjb2x1bW4uaXNGb3JlaWduQ29sdW1uKCkgOiBmYWxzZTtcbiAgICAgICAgd2hpbGUgKGxlbi0tKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IGpzb25bcGFyc2VJbnQobGVuLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICBpZiAoY29sdW1uICYmIGNvbHVtbi50eXBlID09PSAnZGF0ZW9ubHknICYmIHR5cGVvZiB2YWx1ZVtcIlwiICsgZmllbGRdID09PSAnc3RyaW5nJyAmJiB2YWx1ZVtcIlwiICsgZmllbGRdKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IHZhbHVlW1wiXCIgKyBmaWVsZF0uc3BsaXQoL1teMC05Ll0vKTtcbiAgICAgICAgICAgICAgICB2YWx1ZVtcIlwiICsgZmllbGRdID0gbmV3IERhdGUocGFyc2VJbnQoYXJyWzBdLCAxMCksIHBhcnNlSW50KGFyclsxXSwgMTApIC0gMSwgcGFyc2VJbnQoYXJyWzJdLCAxMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWUgPSBnZXRPYmplY3QoZmllbGQsIHZhbHVlKTsgLy9sb2NhbCByZW1vdGUgZGlmZiwgY2hlY2sgd2l0aCBtZHVcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyVmFsdWUgPSAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgJiYgIShpc051bGxPclVuZGVmaW5lZChjaGVja2JveEZpbHRlcikpICYmXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICAhKGlzTnVsbE9yVW5kZWZpbmVkKGNoZWNrYm94RmlsdGVyLnBhcmVudCkpICYmICEoaXNOdWxsT3JVbmRlZmluZWQoY2hlY2tib3hGaWx0ZXIucGFyZW50LmZpbHRlclNldHRpbmdzKSkgJiZcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgICAgICEoaXNOdWxsT3JVbmRlZmluZWQoY2hlY2tib3hGaWx0ZXIucGFyZW50LmZpbHRlclNldHRpbmdzLmVuYWJsZUNhc2VTZW5zaXRpdml0eSkpID8gdmFsdWUudG9Mb3dlckNhc2UoKSA6IHZhbHVlO1xuICAgICAgICAgICAgaWYgKCEoY3VycmVudEZpbHRlclZhbHVlIGluIGxvb2t1cCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgICAgICAgICAgb2JqW1wiXCIgKyBlalZhbHVlXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGxvb2t1cFtcIlwiICsgY3VycmVudEZpbHRlclZhbHVlXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGlzRm9yZWlnbktleSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm9yZWlnbkRhdGFPYmogPSBnZXRGb3JlaWduRGF0YShjb2x1bW4sIHt9LCB2YWx1ZSwgZm9yZWlnbktleURhdGEpWzBdO1xuICAgICAgICAgICAgICAgICAgICBzZXRWYWx1ZShldmVudHMuZm9yZWlnbktleURhdGEsIGZvcmVpZ25EYXRhT2JqLCBqc29uW3BhcnNlSW50KGxlbi50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBnZXRWYWx1ZShjb2x1bW4uZm9yZWlnbktleVZhbHVlLCBmb3JlaWduRGF0YU9iaik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNldFZhbHVlKGZpZWxkLCBpc051bGxPclVuZGVmaW5lZCh2YWx1ZSkgPyBudWxsIDogdmFsdWUsIG9iaik7XG4gICAgICAgICAgICAgICAgc2V0VmFsdWUoJ2RhdGFPYmonLCBqc29uW3BhcnNlSW50KGxlbi50b1N0cmluZygpLCAxMCldLCBvYmopO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKG9iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERhdGFVdGlsLmdyb3VwKERhdGFVdGlsLnNvcnQocmVzdWx0LCBmaWVsZCwgRGF0YVV0aWwuZm5Bc2NlbmRpbmcpLCAnZWpWYWx1ZScpO1xuICAgIH07XG4gICAgQ2hlY2tCb3hGaWx0ZXJCYXNlLmdldFByZWRpY2F0ZSA9IGZ1bmN0aW9uIChjb2x1bW5zLCBpc0V4ZWN1dGVMb2NhbCkge1xuICAgICAgICB2YXIgY29scyA9IERhdGFVdGlsLmRpc3RpbmN0KGNvbHVtbnMsICdmaWVsZCcsIHRydWUpIHx8IFtdO1xuICAgICAgICB2YXIgY29sbGVjdGlvbiA9IFtdO1xuICAgICAgICB2YXIgcHJlZCA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24gPSBuZXcgRGF0YU1hbmFnZXIoY29sdW1ucykuZXhlY3V0ZUxvY2FsKG5ldyBRdWVyeSgpLndoZXJlKCdmaWVsZCcsICdlcXVhbCcsIGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkKSk7XG4gICAgICAgICAgICBpZiAoY29sbGVjdGlvbi5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICBwcmVkW2NvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkXSA9IENoZWNrQm94RmlsdGVyQmFzZS5nZW5lcmF0ZVByZWRpY2F0ZShjb2xsZWN0aW9uLCBpc0V4ZWN1dGVMb2NhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByZWQ7XG4gICAgfTtcbiAgICBDaGVja0JveEZpbHRlckJhc2UuZ2VuZXJhdGVQcmVkaWNhdGUgPSBmdW5jdGlvbiAoY29scywgaXNFeGVjdXRlTG9jYWwpIHtcbiAgICAgICAgdmFyIGxlbiA9IGNvbHMgPyBjb2xzLmxlbmd0aCA6IDA7XG4gICAgICAgIHZhciBwcmVkaWNhdGU7XG4gICAgICAgIHZhciBvcGVyYXRlID0gJ29yJztcbiAgICAgICAgdmFyIGZpcnN0ID0gQ2hlY2tCb3hGaWx0ZXJCYXNlLnVwZGF0ZURhdGVGaWx0ZXIoY29sc1swXSk7XG4gICAgICAgIGZpcnN0Lmlnbm9yZUFjY2VudCA9ICFpc051bGxPclVuZGVmaW5lZChmaXJzdC5pZ25vcmVBY2NlbnQpID8gZmlyc3QuaWdub3JlQWNjZW50IDogZmFsc2U7XG4gICAgICAgIGlmIChmaXJzdC50eXBlID09PSAnZGF0ZScgfHwgZmlyc3QudHlwZSA9PT0gJ2RhdGV0aW1lJyB8fCBmaXJzdC50eXBlID09PSAnZGF0ZW9ubHknKSB7XG4gICAgICAgICAgICBwcmVkaWNhdGUgPSBnZXREYXRlUHJlZGljYXRlKGZpcnN0LCBmaXJzdC50eXBlLCBpc0V4ZWN1dGVMb2NhbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwcmVkaWNhdGUgPSBmaXJzdC5lanByZWRpY2F0ZSA/IGZpcnN0LmVqcHJlZGljYXRlIDpcbiAgICAgICAgICAgICAgICBuZXcgUHJlZGljYXRlKGZpcnN0LmZpZWxkLCBmaXJzdC5vcGVyYXRvciwgZmlyc3QudmFsdWUsICFDaGVja0JveEZpbHRlckJhc2UuZ2V0Q2FzZVZhbHVlKGZpcnN0KSwgZmlyc3QuaWdub3JlQWNjZW50KTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBwID0gMTsgcCA8IGxlbjsgcCsrKSB7XG4gICAgICAgICAgICBjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXSA9IENoZWNrQm94RmlsdGVyQmFzZS51cGRhdGVEYXRlRmlsdGVyKGNvbHNbcGFyc2VJbnQocC50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgIGlmIChsZW4gPiAyICYmIHAgPiAxICYmICgoY29sc1twXS5wcmVkaWNhdGUgPT09ICdvcicgJiYgY29sc1twIC0gMV0ucHJlZGljYXRlID09PSAnb3InKVxuICAgICAgICAgICAgICAgIHx8IChjb2xzW3BdLnByZWRpY2F0ZSA9PT0gJ2FuZCcgJiYgY29sc1twIC0gMV0ucHJlZGljYXRlID09PSAnYW5kJykpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHNbcF0udHlwZSA9PT0gJ2RhdGUnIHx8IGNvbHNbcF0udHlwZSA9PT0gJ2RhdGV0aW1lJyB8fCBjb2xzW3BdLnR5cGUgPT09ICdkYXRlb25seScpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlZGljYXRlLnByZWRpY2F0ZXMucHVzaChnZXREYXRlUHJlZGljYXRlKGNvbHNbcGFyc2VJbnQocC50b1N0cmluZygpLCAxMCldLCBjb2xzW3BdLnR5cGUsIGlzRXhlY3V0ZUxvY2FsKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcmVkaWNhdGUucHJlZGljYXRlcy5wdXNoKG5ldyBQcmVkaWNhdGUoY29sc1twXS5maWVsZCwgY29sc1twYXJzZUludChwLnRvU3RyaW5nKCksIDEwKV0ub3BlcmF0b3IsIGNvbHNbcGFyc2VJbnQocC50b1N0cmluZygpLCAxMCldLnZhbHVlLCAhQ2hlY2tCb3hGaWx0ZXJCYXNlLmdldENhc2VWYWx1ZShjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXSksIGNvbHNbcGFyc2VJbnQocC50b1N0cmluZygpLCAxMCldLmlnbm9yZUFjY2VudCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjb2xzW3BdLnR5cGUgPT09ICdkYXRlJyB8fCBjb2xzW3BdLnR5cGUgPT09ICdkYXRldGltZScgfHwgY29sc1twXS50eXBlID09PSAnZGF0ZW9ubHknKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXS5wcmVkaWNhdGUgPT09ICdhbmQnICYmIGNvbHNbcGFyc2VJbnQocC50b1N0cmluZygpLCAxMCldLm9wZXJhdG9yID09PSAnZXF1YWwnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVkaWNhdGUgPSBwcmVkaWNhdGVbXCJcIiArIG9wZXJhdGVdKGdldERhdGVQcmVkaWNhdGUoY29sc1twYXJzZUludChwLnRvU3RyaW5nKCksIDEwKV0sIGNvbHNbcGFyc2VJbnQocC50b1N0cmluZygpLCAxMCldLnR5cGUsIGlzRXhlY3V0ZUxvY2FsKSwgY29sc1twYXJzZUludChwLnRvU3RyaW5nKCksIDEwKV0udHlwZSwgY29sc1twYXJzZUludChwLnRvU3RyaW5nKCksIDEwKV0uaWdub3JlQWNjZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWRpY2F0ZSA9IHByZWRpY2F0ZVsoY29sc1twYXJzZUludChwLnRvU3RyaW5nKCksIDEwKV0ucHJlZGljYXRlKV0oZ2V0RGF0ZVByZWRpY2F0ZShjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXSwgY29sc1twYXJzZUludChwLnRvU3RyaW5nKCksIDEwKV0udHlwZSwgaXNFeGVjdXRlTG9jYWwpLCBjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXS50eXBlLCBjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXS5pZ25vcmVBY2NlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcmVkaWNhdGUgPSBjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXS5lanByZWRpY2F0ZSA/XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVkaWNhdGVbY29sc1twYXJzZUludChwLnRvU3RyaW5nKCksIDEwKV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucHJlZGljYXRlXShjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXS5lanByZWRpY2F0ZSkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlZGljYXRlWyhjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXS5wcmVkaWNhdGUpXShjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXS5maWVsZCwgY29sc1twYXJzZUludChwLnRvU3RyaW5nKCksIDEwKV0ub3BlcmF0b3IsIGNvbHNbcGFyc2VJbnQocC50b1N0cmluZygpLCAxMCldLnZhbHVlLCAhQ2hlY2tCb3hGaWx0ZXJCYXNlLmdldENhc2VWYWx1ZShjb2xzW3BhcnNlSW50KHAudG9TdHJpbmcoKSwgMTApXSksIGNvbHNbcGFyc2VJbnQocC50b1N0cmluZygpLCAxMCldLmlnbm9yZUFjY2VudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmVkaWNhdGUgfHwgbnVsbDtcbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS5nZXRDYXNlVmFsdWUgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChmaWx0ZXIubWF0Y2hDYXNlKSkge1xuICAgICAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSAnc3RyaW5nJyB8fCBpc051bGxPclVuZGVmaW5lZChmaWx0ZXIudHlwZSkgJiYgdHlwZW9mIChmaWx0ZXIudmFsdWUpID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlci5tYXRjaENhc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENoZWNrQm94RmlsdGVyQmFzZS51cGRhdGVEYXRlRmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xuICAgICAgICBpZiAoKGZpbHRlci50eXBlID09PSAnZGF0ZScgfHwgZmlsdGVyLnR5cGUgPT09ICdkYXRldGltZScgfHwgZmlsdGVyLnR5cGUgPT09ICdkYXRlb25seScgfHwgZmlsdGVyLnZhbHVlIGluc3RhbmNlb2YgRGF0ZSkpIHtcbiAgICAgICAgICAgIGZpbHRlci50eXBlID0gZmlsdGVyLnR5cGUgfHwgJ2RhdGUnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWx0ZXI7XG4gICAgfTtcbiAgICByZXR1cm4gQ2hlY2tCb3hGaWx0ZXJCYXNlO1xufSgpKTtcbmV4cG9ydCB7IENoZWNrQm94RmlsdGVyQmFzZSB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/common/checkbox-filter-base.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/aggregate.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/aggregate.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AggregateColumn: () => (/* binding */ AggregateColumn),\n/* harmony export */   AggregateRow: () => (/* binding */ AggregateRow)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\n\n\n\n/**\n * Configures the Grid's aggregate column.\n */\nvar AggregateColumn = /** @class */ (function (_super) {\n    __extends(AggregateColumn, _super);\n    function AggregateColumn() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.templateFn = {};\n        return _this;\n    }\n    /**\n     * @param {Function} value - specifies the value\n     * @returns {void}\n     * @hidden\n     */\n    AggregateColumn.prototype.setFormatter = function (value) {\n        this.formatFn = value;\n    };\n    /**\n     * @returns {Function} returns the Function\n     * @hidden\n     */\n    AggregateColumn.prototype.getFormatter = function () {\n        return this.formatFn;\n    };\n    /**\n     * @param {Object} helper - specifies the helper\n     * @returns {void}\n     * @hidden\n     */\n    AggregateColumn.prototype.setTemplate = function (helper) {\n        if (helper === void 0) { helper = {}; }\n        if (this.footerTemplate !== undefined) {\n            this.templateFn[(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getEnumValue)(_base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType, _base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType.Summary)] = { fn: (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(this.footerTemplate, helper),\n                property: 'footerTemplate' };\n        }\n        if (this.groupFooterTemplate !== undefined) {\n            this.templateFn[(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getEnumValue)(_base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType, _base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType.GroupSummary)] = { fn: (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(this.groupFooterTemplate, helper),\n                property: 'groupFooterTemplate' };\n        }\n        if (this.groupCaptionTemplate !== undefined) {\n            this.templateFn[(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getEnumValue)(_base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType, _base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType.CaptionSummary)] = { fn: (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(this.groupCaptionTemplate, helper),\n                property: 'groupCaptionTemplate' };\n        }\n    };\n    /**\n     * @param {CellType} type - specifies the cell type\n     * @returns {Object} returns the object\n     * @hidden\n     */\n    AggregateColumn.prototype.getTemplate = function (type) {\n        return this.templateFn[(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getEnumValue)(_base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType, type)];\n    };\n    /**\n     * @param {Object} prop - returns the Object\n     * @returns {void}\n     * @hidden\n     */\n    AggregateColumn.prototype.setPropertiesSilent = function (prop) {\n        this.setProperties(prop, true);\n    };\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], AggregateColumn.prototype, \"type\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], AggregateColumn.prototype, \"field\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], AggregateColumn.prototype, \"columnName\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], AggregateColumn.prototype, \"format\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], AggregateColumn.prototype, \"footerTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], AggregateColumn.prototype, \"groupFooterTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], AggregateColumn.prototype, \"groupCaptionTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], AggregateColumn.prototype, \"customAggregate\", void 0);\n    return AggregateColumn;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n/**\n * Configures the aggregate rows.\n */\nvar AggregateRow = /** @class */ (function (_super) {\n    __extends(AggregateRow, _super);\n    function AggregateRow() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Collection)([], AggregateColumn)\n    ], AggregateRow.prototype, \"columns\", void 0);\n    return AggregateRow;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9tb2RlbHMvYWdncmVnYXRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsa0JBQWtCLFNBQUksSUFBSSxTQUFJO0FBQzlCO0FBQ0E7QUFDQSw2Q0FBNkMsUUFBUTtBQUNyRDtBQUNBO0FBQytDO0FBQ0s7QUFDWjtBQUNtQztBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxVQUFVO0FBQ3pCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsVUFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBLDRCQUE0QixrRUFBWSxDQUFDLGdEQUFRLEVBQUUsZ0RBQVEsZUFBZSxJQUFJLDZEQUFPO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixrRUFBWSxDQUFDLGdEQUFRLEVBQUUsZ0RBQVEsb0JBQW9CLElBQUksNkRBQU87QUFDMUY7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGtFQUFZLENBQUMsZ0RBQVEsRUFBRSxnREFBUSxzQkFBc0IsSUFBSSw2REFBTztBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsVUFBVTtBQUN6QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isa0VBQVksQ0FBQyxnREFBUTtBQUNwRDtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxDQUFDLENBQUMsK0RBQWE7QUFDWTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGdFQUFVO0FBQ2xCO0FBQ0E7QUFDQSxDQUFDLENBQUMsK0RBQWE7QUFDUyIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL21vZGVscy9hZ2dyZWdhdGUuanM/ZTgwZiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbmltcG9ydCB7IGNvbXBpbGUgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBnZXRFbnVtVmFsdWUgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBDZWxsVHlwZSB9IGZyb20gJy4uL2Jhc2UvZW51bSc7XG5pbXBvcnQgeyBQcm9wZXJ0eSwgQ29sbGVjdGlvbiwgQ2hpbGRQcm9wZXJ0eSB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbi8qKlxuICogQ29uZmlndXJlcyB0aGUgR3JpZCdzIGFnZ3JlZ2F0ZSBjb2x1bW4uXG4gKi9cbnZhciBBZ2dyZWdhdGVDb2x1bW4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFnZ3JlZ2F0ZUNvbHVtbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBZ2dyZWdhdGVDb2x1bW4oKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy50ZW1wbGF0ZUZuID0ge307XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gdmFsdWUgLSBzcGVjaWZpZXMgdGhlIHZhbHVlXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEFnZ3JlZ2F0ZUNvbHVtbi5wcm90b3R5cGUuc2V0Rm9ybWF0dGVyID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuZm9ybWF0Rm4gPSB2YWx1ZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gcmV0dXJucyB0aGUgRnVuY3Rpb25cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQWdncmVnYXRlQ29sdW1uLnByb3RvdHlwZS5nZXRGb3JtYXR0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1hdEZuO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGhlbHBlciAtIHNwZWNpZmllcyB0aGUgaGVscGVyXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEFnZ3JlZ2F0ZUNvbHVtbi5wcm90b3R5cGUuc2V0VGVtcGxhdGUgPSBmdW5jdGlvbiAoaGVscGVyKSB7XG4gICAgICAgIGlmIChoZWxwZXIgPT09IHZvaWQgMCkgeyBoZWxwZXIgPSB7fTsgfVxuICAgICAgICBpZiAodGhpcy5mb290ZXJUZW1wbGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlRm5bZ2V0RW51bVZhbHVlKENlbGxUeXBlLCBDZWxsVHlwZS5TdW1tYXJ5KV0gPSB7IGZuOiBjb21waWxlKHRoaXMuZm9vdGVyVGVtcGxhdGUsIGhlbHBlciksXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6ICdmb290ZXJUZW1wbGF0ZScgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ncm91cEZvb3RlclRlbXBsYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVGbltnZXRFbnVtVmFsdWUoQ2VsbFR5cGUsIENlbGxUeXBlLkdyb3VwU3VtbWFyeSldID0geyBmbjogY29tcGlsZSh0aGlzLmdyb3VwRm9vdGVyVGVtcGxhdGUsIGhlbHBlciksXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6ICdncm91cEZvb3RlclRlbXBsYXRlJyB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmdyb3VwQ2FwdGlvblRlbXBsYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVGbltnZXRFbnVtVmFsdWUoQ2VsbFR5cGUsIENlbGxUeXBlLkNhcHRpb25TdW1tYXJ5KV0gPSB7IGZuOiBjb21waWxlKHRoaXMuZ3JvdXBDYXB0aW9uVGVtcGxhdGUsIGhlbHBlciksXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6ICdncm91cENhcHRpb25UZW1wbGF0ZScgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtDZWxsVHlwZX0gdHlwZSAtIHNwZWNpZmllcyB0aGUgY2VsbCB0eXBlXG4gICAgICogQHJldHVybnMge09iamVjdH0gcmV0dXJucyB0aGUgb2JqZWN0XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEFnZ3JlZ2F0ZUNvbHVtbi5wcm90b3R5cGUuZ2V0VGVtcGxhdGUgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICByZXR1cm4gdGhpcy50ZW1wbGF0ZUZuW2dldEVudW1WYWx1ZShDZWxsVHlwZSwgdHlwZSldO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHByb3AgLSByZXR1cm5zIHRoZSBPYmplY3RcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQWdncmVnYXRlQ29sdW1uLnByb3RvdHlwZS5zZXRQcm9wZXJ0aWVzU2lsZW50ID0gZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHByb3AsIHRydWUpO1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBBZ2dyZWdhdGVDb2x1bW4ucHJvdG90eXBlLCBcInR5cGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIEFnZ3JlZ2F0ZUNvbHVtbi5wcm90b3R5cGUsIFwiZmllbGRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIEFnZ3JlZ2F0ZUNvbHVtbi5wcm90b3R5cGUsIFwiY29sdW1uTmFtZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgQWdncmVnYXRlQ29sdW1uLnByb3RvdHlwZSwgXCJmb3JtYXRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIEFnZ3JlZ2F0ZUNvbHVtbi5wcm90b3R5cGUsIFwiZm9vdGVyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIEFnZ3JlZ2F0ZUNvbHVtbi5wcm90b3R5cGUsIFwiZ3JvdXBGb290ZXJUZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgQWdncmVnYXRlQ29sdW1uLnByb3RvdHlwZSwgXCJncm91cENhcHRpb25UZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgQWdncmVnYXRlQ29sdW1uLnByb3RvdHlwZSwgXCJjdXN0b21BZ2dyZWdhdGVcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gQWdncmVnYXRlQ29sdW1uO1xufShDaGlsZFByb3BlcnR5KSk7XG5leHBvcnQgeyBBZ2dyZWdhdGVDb2x1bW4gfTtcbi8qKlxuICogQ29uZmlndXJlcyB0aGUgYWdncmVnYXRlIHJvd3MuXG4gKi9cbnZhciBBZ2dyZWdhdGVSb3cgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFnZ3JlZ2F0ZVJvdywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBZ2dyZWdhdGVSb3coKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIENvbGxlY3Rpb24oW10sIEFnZ3JlZ2F0ZUNvbHVtbilcbiAgICBdLCBBZ2dyZWdhdGVSb3cucHJvdG90eXBlLCBcImNvbHVtbnNcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gQWdncmVnYXRlUm93O1xufShDaGlsZFByb3BlcnR5KSk7XG5leHBvcnQgeyBBZ2dyZWdhdGVSb3cgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/aggregate.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/cell.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/cell.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Cell: () => (/* binding */ Cell)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n\n/**\n * Cell\n *\n * @hidden\n */\nvar Cell = /** @class */ (function () {\n    function Cell(options) {\n        this.isSpanned = false;\n        this.isRowSpanned = false;\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.merge)(this, options);\n    }\n    Cell.prototype.clone = function () {\n        var cell = new Cell({});\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.merge)(cell, this);\n        return cell;\n    };\n    return Cell;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9tb2RlbHMvY2VsbC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUE2QztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QixRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNlIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvbW9kZWxzL2NlbGwuanM/NGFjNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBtZXJnZSB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbi8qKlxuICogQ2VsbFxuICpcbiAqIEBoaWRkZW5cbiAqL1xudmFyIENlbGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2VsbChvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuaXNTcGFubmVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNSb3dTcGFubmVkID0gZmFsc2U7XG4gICAgICAgIG1lcmdlKHRoaXMsIG9wdGlvbnMpO1xuICAgIH1cbiAgICBDZWxsLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNlbGwgPSBuZXcgQ2VsbCh7fSk7XG4gICAgICAgIG1lcmdlKGNlbGwsIHRoaXMpO1xuICAgICAgICByZXR1cm4gY2VsbDtcbiAgICB9O1xuICAgIHJldHVybiBDZWxsO1xufSgpKTtcbmV4cG9ydCB7IENlbGwgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/cell.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column-chooser-settings.js":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column-chooser-settings.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ColumnChooserSettings: () => (/* binding */ ColumnChooserSettings)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\n/**\n * Configures the column chooser behavior of the Grid.\n */\nvar ColumnChooserSettings = /** @class */ (function (_super) {\n    __extends(ColumnChooserSettings, _super);\n    function ColumnChooserSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('startsWith')\n    ], ColumnChooserSettings.prototype, \"operator\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], ColumnChooserSettings.prototype, \"ignoreAccent\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(null)\n    ], ColumnChooserSettings.prototype, \"headerTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(null)\n    ], ColumnChooserSettings.prototype, \"template\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(null)\n    ], ColumnChooserSettings.prototype, \"footerTemplate\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], ColumnChooserSettings.prototype, \"enableSearching\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(null)\n    ], ColumnChooserSettings.prototype, \"renderCustomColumnChooser\", void 0);\n    return ColumnChooserSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9tb2RlbHMvY29sdW1uLWNob29zZXItc2V0dGluZ3MuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsa0JBQWtCLFNBQUksSUFBSSxTQUFJO0FBQzlCO0FBQ0E7QUFDQSw2Q0FBNkMsUUFBUTtBQUNyRDtBQUNBO0FBQytEO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLFFBQVEsOERBQVE7QUFDaEI7QUFDQTtBQUNBLENBQUMsQ0FBQywrREFBYTtBQUNrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL21vZGVscy9jb2x1bW4tY2hvb3Nlci1zZXR0aW5ncy5qcz9kMmI0Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XG59O1xuaW1wb3J0IHsgUHJvcGVydHksIENoaWxkUHJvcGVydHkgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG4vKipcbiAqIENvbmZpZ3VyZXMgdGhlIGNvbHVtbiBjaG9vc2VyIGJlaGF2aW9yIG9mIHRoZSBHcmlkLlxuICovXG52YXIgQ29sdW1uQ2hvb3NlclNldHRpbmdzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDb2x1bW5DaG9vc2VyU2V0dGluZ3MsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ29sdW1uQ2hvb3NlclNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnc3RhcnRzV2l0aCcpXG4gICAgXSwgQ29sdW1uQ2hvb3NlclNldHRpbmdzLnByb3RvdHlwZSwgXCJvcGVyYXRvclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBDb2x1bW5DaG9vc2VyU2V0dGluZ3MucHJvdG90eXBlLCBcImlnbm9yZUFjY2VudFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShudWxsKVxuICAgIF0sIENvbHVtbkNob29zZXJTZXR0aW5ncy5wcm90b3R5cGUsIFwiaGVhZGVyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkobnVsbClcbiAgICBdLCBDb2x1bW5DaG9vc2VyU2V0dGluZ3MucHJvdG90eXBlLCBcInRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KG51bGwpXG4gICAgXSwgQ29sdW1uQ2hvb3NlclNldHRpbmdzLnByb3RvdHlwZSwgXCJmb290ZXJUZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSh0cnVlKVxuICAgIF0sIENvbHVtbkNob29zZXJTZXR0aW5ncy5wcm90b3R5cGUsIFwiZW5hYmxlU2VhcmNoaW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KG51bGwpXG4gICAgXSwgQ29sdW1uQ2hvb3NlclNldHRpbmdzLnByb3RvdHlwZSwgXCJyZW5kZXJDdXN0b21Db2x1bW5DaG9vc2VyXCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIENvbHVtbkNob29zZXJTZXR0aW5ncztcbn0oQ2hpbGRQcm9wZXJ0eSkpO1xuZXhwb3J0IHsgQ29sdW1uQ2hvb3NlclNldHRpbmdzIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column-chooser-settings.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Column: () => (/* binding */ Column),\n/* harmony export */   CommandColumnModel: () => (/* binding */ CommandColumnModel),\n/* harmony export */   GridColumn: () => (/* binding */ GridColumn),\n/* harmony export */   StackedColumn: () => (/* binding */ StackedColumn)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/query.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/util.js\");\n/* harmony import */ var _services_value_formatter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../services/value-formatter */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/value-formatter.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\n\n\n\n/**\n * Represents Grid `Column` model class.\n */\nvar Column = /** @class */ (function () {\n    function Column(options, parent) {\n        var _this = this;\n        /**\n         * If `disableHtmlEncode` is set to true, it encodes the HTML of the header and content cells.\n         *\n         * @default true\n         */\n        this.disableHtmlEncode = true;\n        /**\n         * If `allowSorting` set to false, then it disables sorting option of a particular column.\n         * By default all columns are sortable.\n         *\n         * @default true\n         */\n        this.allowSorting = true;\n        /**\n         * If `allowResizing` is set to false, it disables resize option of a particular column.\n         * By default all the columns can be resized.\n         *\n         * @default true\n         */\n        this.allowResizing = true;\n        /**\n         * If `allowFiltering` set to false, then it disables filtering option and filter bar element of a particular column.\n         * By default all columns are filterable.\n         *\n         * @default true\n         */\n        this.allowFiltering = true;\n        /**\n         * If `allowGrouping` set to false, then it disables grouping of a particular column.\n         * By default all columns are groupable.\n         *\n         * @default true\n         */\n        this.allowGrouping = true;\n        /**\n         * If `allowReordering` set to false, then it disables reorder of a particular column.\n         * By default all columns can be reorder.\n         *\n         * @default true\n         */\n        this.allowReordering = true;\n        /**\n         * If `showColumnMenu` set to false, then it disable the column menu of a particular column.\n         * By default column menu will show for all columns\n         *\n         * @default true\n         */\n        this.showColumnMenu = true;\n        /**\n         * If `enableGroupByFormat` set to true, then it groups the particular column by formatted values.\n         *\n         * @default true\n         */\n        this.enableGroupByFormat = false;\n        /**\n         * If `allowEditing` set to false, then it disables editing of a particular column.\n         * By default all columns are editable.\n         *\n         * @default true\n         */\n        this.allowEditing = true;\n        /**\n         *  It is used to customize the default filter options for a specific columns.\n         * * type -  Specifies the filter type as menu or checkbox.\n         * * ui - to render custom component for specific column it has following functions.\n         * * ui.create – It is used for creating custom components.\n         * * ui.read -  It is used for read the value from the component.\n         * * ui.write - It is used to apply component model as dynamically.\n         * {% codeBlock src=\"grid/filter-menu-api/index.ts\" %}{% endcodeBlock %}\n         *\n         * > Check the [`Filter UI`](../../grid/filtering/filter-menu/#custom-component-in-filter-menu) for its customization.\n         *\n         *  @default {}\n         */\n        this.filter = {};\n        /**\n         * If `showInColumnChooser` set to false, then hide the particular column in column chooser.\n         *  By default all columns are displayed in column Chooser.\n         *\n         * @default true\n         */\n        this.showInColumnChooser = true;\n        /**\n         * Defines the `IEditCell` object to customize default edit cell.\n         *\n         * @default {}\n         */\n        this.edit = {};\n        /**\n         * If `allowSearching` set to false, then it disables Searching of a particular column.\n         * By default all columns allow Searching.\n         *\n         * @default true\n         */\n        this.allowSearching = true;\n        /**\n         * If `autoFit` set to true, then the particular column content width will be\n         * adjusted based on its content in the initial rendering itself.\n         * Setting this property as true is equivalent to calling `autoFitColumns` method in the `dataBound` event.\n         *\n         * @default false\n         */\n        this.autoFit = false;\n        this.sortDirection = 'Descending';\n        /**\n         * @returns {Function} returns the edit template\n         * @hidden */\n        this.getEditTemplate = function () { return _this.editTemplateFn; };\n        /**\n         * @returns {Function} returns the filter template\n         * @hidden */\n        this.getFilterTemplate = function () { return _this.filterTemplateFn; };\n        /**\n         * Determines the behavior of the `aria-label` attribute for cells in template columns.\n         * If enableAriaLabel is set to false, the aria-label attribute is not applied to template column cells, which affects screen reader accessibility.\n         *\n         * @default {}\n         */\n        this.templateOptions = { enableAriaLabel: true };\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.merge)(this, options);\n        this.parent = parent;\n        if (this.type === 'none') {\n            this.type = null;\n        }\n        else if (this.type) {\n            this.type = typeof (this.type) === 'string' ? this.type.toLowerCase() : undefined;\n        }\n        if (this.editType) {\n            this.editType = this.editType.toLowerCase();\n        }\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.uid)) {\n            this.uid = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.getUid)('grid-column');\n        }\n        var valueFormatter = new _services_value_formatter__WEBPACK_IMPORTED_MODULE_2__.ValueFormatter();\n        if (options.format && (options.format.skeleton || (options.format.format &&\n            typeof options.format.format === 'string'))) {\n            this.setFormatter(valueFormatter.getFormatFunction((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, options.format)));\n            this.setParser(valueFormatter.getParserFunction(options.format));\n        }\n        this.toJSON = function () {\n            var col = {};\n            var skip = ['filter', 'dataSource', 'headerText', 'template', 'headerTemplate', 'edit',\n                'editTemplate', 'filterTemplate', 'commandsTemplate', 'parent'];\n            var keys = Object.keys(_this);\n            for (var i = 0; i < keys.length; i++) {\n                if (keys[parseInt(i.toString(), 10)] === 'columns') {\n                    col[keys[parseInt(i.toString(), 10)]] = [];\n                    for (var j = 0; j < _this[keys[parseInt(i.toString(), 10)]].length; j++) {\n                        col[keys[parseInt(i.toString(), 10)]].push(_this[keys[parseInt(i.toString(), 10)]][parseInt(j.toString(), 10)].toJSON());\n                    }\n                }\n                else if (skip.indexOf(keys[parseInt(i.toString(), 10)]) < 0) {\n                    col[keys[parseInt(i.toString(), 10)]] = _this[keys[parseInt(i.toString(), 10)]];\n                }\n            }\n            return col;\n        };\n        if (!this.field) {\n            this.allowFiltering = false;\n            this.allowGrouping = false;\n            this.allowSorting = false;\n            if (this.columns) {\n                this.allowResizing = this.columns.some(function (col) {\n                    return col.allowResizing;\n                });\n            }\n        }\n        if (this.commands && !this.textAlign) {\n            this.textAlign = 'Right';\n        }\n        if (this.template || this.commandsTemplate) {\n            this.templateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(this.template || this.commandsTemplate);\n        }\n        if (this.headerTemplate) {\n            this.headerTemplateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(this.headerTemplate);\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.filter) && this.filter.itemTemplate) {\n            this.fltrTemplateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(this.filter.itemTemplate);\n        }\n        if (this.editTemplate) {\n            this.editTemplateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(this.editTemplate);\n        }\n        if (this.filterTemplate) {\n            this.filterTemplateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(this.filterTemplate);\n        }\n        if (this.isForeignColumn() &&\n            ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.editType) || this.editType === 'dropdownedit' || this.editType === 'defaultedit')) {\n            this.editType = 'dropdownedit';\n            if (this.edit.params && this.edit.params.dataSource) {\n                this.edit.params.ddEditedData = true;\n            }\n            this.edit.params = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({\n                dataSource: this.dataSource,\n                query: new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_3__.Query(), fields: { value: this.foreignKeyField || this.field, text: this.foreignKeyValue }\n            }, this.edit.params);\n        }\n        if (this.sortComparer) {\n            var a_1 = this.sortComparer;\n            this.sortComparer = function (x, y, xObj, yObj) {\n                if (typeof a_1 === 'string') {\n                    a_1 = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.getObject)(a_1, window);\n                }\n                if (_this.sortDirection === 'Descending') {\n                    var z = x;\n                    x = y;\n                    y = z;\n                    var obj = xObj;\n                    xObj = yObj;\n                    yObj = obj;\n                }\n                return a_1(x, y, xObj, yObj);\n            };\n        }\n        if (!this.sortComparer && this.isForeignColumn()) {\n            this.sortComparer = function (x, y) {\n                x = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.getObject)(_this.foreignKeyValue, (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.getForeignData)(_this, {}, x)[0]);\n                y = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.getObject)(_this.foreignKeyValue, (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.getForeignData)(_this, {}, y)[0]);\n                return _this.sortDirection === 'Descending' ? _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_4__.DataUtil.fnDescending(x, y) : _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_4__.DataUtil.fnAscending(x, y);\n            };\n        }\n    }\n    /**\n     * @returns {string} returns the sort direction\n     * @hidden */\n    Column.prototype.getSortDirection = function () {\n        return this.sortDirection;\n    };\n    /**\n     * @param {string} direction - specifies the direction\n     * @returns {void}\n     * @hidden\n     */\n    Column.prototype.setSortDirection = function (direction) {\n        this.sortDirection = direction;\n    };\n    /**\n     * @returns {freezeTable} returns the FreezeTable\n     * @hidden */\n    Column.prototype.getFreezeTableName = function () {\n        return this.freezeTable;\n    };\n    /**\n     * @param {Column} column - specifies the column\n     * @returns {void}\n     * @hidden\n     */\n    Column.prototype.setProperties = function (column) {\n        //Angular two way binding\n        var keys = Object.keys(column);\n        var _loop_1 = function (i) {\n            if (keys[parseInt(i.toString(), 10)] === 'columns') {\n                var cols_1 = column[keys[parseInt(i.toString(), 10)]];\n                var _loop_2 = function (j) {\n                    this_1.columns.find(function (col) {\n                        return col.field === cols_1[parseInt(j.toString(), 10)]\n                            .field;\n                    }).setProperties(cols_1[parseInt(j.toString(), 10)]);\n                };\n                for (var j = 0; j < cols_1.length; j++) {\n                    _loop_2(j);\n                }\n            }\n            else {\n                this_1[keys[parseInt(i.toString(), 10)]] = column[keys[parseInt(i.toString(), 10)]];\n            }\n            //Refresh the react columnTemplates on state change\n            if (this_1.parent && this_1.parent.isReact) {\n                if (keys[parseInt(i.toString(), 10)] === 'template') {\n                    this_1.templateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(column[keys[parseInt(i.toString(), 10)]]);\n                    this_1.parent.refreshReactColumnTemplateByUid(this_1.uid, true);\n                }\n                else if (keys[parseInt(i.toString(), 10)] === 'headerTemplate') {\n                    this_1.headerTemplateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(column[keys[parseInt(i.toString(), 10)]]);\n                    this_1.parent.refreshReactHeaderTemplateByUid(this_1.uid);\n                }\n                else if (keys[parseInt(i.toString(), 10)] === 'editTemplate') {\n                    this_1.editTemplateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(column[keys[parseInt(i.toString(), 10)]]);\n                }\n                else if (keys[parseInt(i.toString(), 10)] === 'filterTemplate') {\n                    this_1.filterTemplateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(column[keys[parseInt(i.toString(), 10)]]);\n                }\n                else if (keys[parseInt(i.toString(), 10)] === 'commandsTemplate') {\n                    this_1.templateFn = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.templateCompiler)(column[keys[parseInt(i.toString(), 10)]]);\n                }\n            }\n        };\n        var this_1 = this;\n        for (var i = 0; i < keys.length; i++) {\n            _loop_1(i);\n        }\n    };\n    /**\n     * @returns {boolean} returns true for foreign column\n     * @hidden\n     * It defines the column is foreign key column or not.\n     */\n    Column.prototype.isForeignColumn = function () {\n        return !!(this.dataSource && this.foreignKeyValue);\n    };\n    /**\n     * @returns {Function} returns the function\n     * @hidden\n     */\n    Column.prototype.getFormatter = function () {\n        return this.formatFn;\n    };\n    /**\n     * @param {Function} value - specifies the value\n     * @returns {void}\n     * @hidden\n     */\n    Column.prototype.setFormatter = function (value) {\n        this.formatFn = value;\n    };\n    /**\n     * @returns {Function} returns the function\n     * @hidden */\n    Column.prototype.getParser = function () {\n        return this.parserFn;\n    };\n    /**\n     * @param {Function} value - specifies the value\n     * @returns {void}\n     * @hidden\n     */\n    Column.prototype.setParser = function (value) {\n        this.parserFn = value;\n    };\n    /**\n     * @returns {Function} returns the function\n     * @hidden */\n    Column.prototype.getColumnTemplate = function () {\n        return this.templateFn;\n    };\n    /**\n     * @returns {Function} returns the function\n     * @hidden */\n    Column.prototype.getHeaderTemplate = function () {\n        return this.headerTemplateFn;\n    };\n    /**\n     * @returns {Function} returns the function\n     * @hidden */\n    Column.prototype.getFilterItemTemplate = function () {\n        return this.fltrTemplateFn;\n    };\n    /**\n     * @returns {string} returns the string\n     * @hidden */\n    Column.prototype.getDomSetter = function () {\n        return this.disableHtmlEncode ? 'textContent' : 'innerHTML';\n    };\n    return Column;\n}());\n\n/**\n * Define options for custom command buttons.\n */\nvar CommandColumnModel = /** @class */ (function () {\n    function CommandColumnModel() {\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], CommandColumnModel.prototype, \"title\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], CommandColumnModel.prototype, \"type\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], CommandColumnModel.prototype, \"buttonOption\", void 0);\n    return CommandColumnModel;\n}());\n\n/**\n * Defines Grid column\n */\nvar GridColumn = /** @class */ (function (_super) {\n    __extends(GridColumn, _super);\n    function GridColumn() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(null)\n    ], GridColumn.prototype, \"columns\", void 0);\n    return GridColumn;\n}(Column));\n\n/**\n * Defines stacked grid column\n */\nvar StackedColumn = /** @class */ (function (_super) {\n    __extends(StackedColumn, _super);\n    function StackedColumn() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return StackedColumn;\n}(GridColumn));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9tb2RlbHMvY29sdW1uLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3QjtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLENBQUM7QUFDRCxrQkFBa0IsU0FBSSxJQUFJLFNBQUk7QUFDOUI7QUFDQTtBQUNBLDZDQUE2QyxRQUFRO0FBQ3JEO0FBQ0E7QUFDa0Y7QUFDM0I7QUFDTTtBQUNzQjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxtREFBbUQ7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsVUFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFVBQVU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ2lCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsQ0FBQztBQUM2QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxDQUFDO0FBQ3FCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDd0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9tb2RlbHMvY29sdW1uLmpzP2ExMjkiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG5pbXBvcnQgeyBtZXJnZSwgaXNOdWxsT3JVbmRlZmluZWQsIGV4dGVuZCwgUHJvcGVydHkgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBRdWVyeSwgRGF0YVV0aWwgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItZGF0YSc7XG5pbXBvcnQgeyBWYWx1ZUZvcm1hdHRlciB9IGZyb20gJy4uL3NlcnZpY2VzL3ZhbHVlLWZvcm1hdHRlcic7XG5pbXBvcnQgeyBnZXRVaWQsIHRlbXBsYXRlQ29tcGlsZXIsIGdldEZvcmVpZ25EYXRhLCBnZXRPYmplY3QgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuLyoqXG4gKiBSZXByZXNlbnRzIEdyaWQgYENvbHVtbmAgbW9kZWwgY2xhc3MuXG4gKi9cbnZhciBDb2x1bW4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29sdW1uKG9wdGlvbnMsIHBhcmVudCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgYGRpc2FibGVIdG1sRW5jb2RlYCBpcyBzZXQgdG8gdHJ1ZSwgaXQgZW5jb2RlcyB0aGUgSFRNTCBvZiB0aGUgaGVhZGVyIGFuZCBjb250ZW50IGNlbGxzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRpc2FibGVIdG1sRW5jb2RlID0gdHJ1ZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIGBhbGxvd1NvcnRpbmdgIHNldCB0byBmYWxzZSwgdGhlbiBpdCBkaXNhYmxlcyBzb3J0aW5nIG9wdGlvbiBvZiBhIHBhcnRpY3VsYXIgY29sdW1uLlxuICAgICAgICAgKiBCeSBkZWZhdWx0IGFsbCBjb2x1bW5zIGFyZSBzb3J0YWJsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hbGxvd1NvcnRpbmcgPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgYGFsbG93UmVzaXppbmdgIGlzIHNldCB0byBmYWxzZSwgaXQgZGlzYWJsZXMgcmVzaXplIG9wdGlvbiBvZiBhIHBhcnRpY3VsYXIgY29sdW1uLlxuICAgICAgICAgKiBCeSBkZWZhdWx0IGFsbCB0aGUgY29sdW1ucyBjYW4gYmUgcmVzaXplZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hbGxvd1Jlc2l6aW5nID0gdHJ1ZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIGBhbGxvd0ZpbHRlcmluZ2Agc2V0IHRvIGZhbHNlLCB0aGVuIGl0IGRpc2FibGVzIGZpbHRlcmluZyBvcHRpb24gYW5kIGZpbHRlciBiYXIgZWxlbWVudCBvZiBhIHBhcnRpY3VsYXIgY29sdW1uLlxuICAgICAgICAgKiBCeSBkZWZhdWx0IGFsbCBjb2x1bW5zIGFyZSBmaWx0ZXJhYmxlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFsbG93RmlsdGVyaW5nID0gdHJ1ZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIGBhbGxvd0dyb3VwaW5nYCBzZXQgdG8gZmFsc2UsIHRoZW4gaXQgZGlzYWJsZXMgZ3JvdXBpbmcgb2YgYSBwYXJ0aWN1bGFyIGNvbHVtbi5cbiAgICAgICAgICogQnkgZGVmYXVsdCBhbGwgY29sdW1ucyBhcmUgZ3JvdXBhYmxlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFsbG93R3JvdXBpbmcgPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgYGFsbG93UmVvcmRlcmluZ2Agc2V0IHRvIGZhbHNlLCB0aGVuIGl0IGRpc2FibGVzIHJlb3JkZXIgb2YgYSBwYXJ0aWN1bGFyIGNvbHVtbi5cbiAgICAgICAgICogQnkgZGVmYXVsdCBhbGwgY29sdW1ucyBjYW4gYmUgcmVvcmRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hbGxvd1Jlb3JkZXJpbmcgPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgYHNob3dDb2x1bW5NZW51YCBzZXQgdG8gZmFsc2UsIHRoZW4gaXQgZGlzYWJsZSB0aGUgY29sdW1uIG1lbnUgb2YgYSBwYXJ0aWN1bGFyIGNvbHVtbi5cbiAgICAgICAgICogQnkgZGVmYXVsdCBjb2x1bW4gbWVudSB3aWxsIHNob3cgZm9yIGFsbCBjb2x1bW5zXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZWZhdWx0IHRydWVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2hvd0NvbHVtbk1lbnUgPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgYGVuYWJsZUdyb3VwQnlGb3JtYXRgIHNldCB0byB0cnVlLCB0aGVuIGl0IGdyb3VwcyB0aGUgcGFydGljdWxhciBjb2x1bW4gYnkgZm9ybWF0dGVkIHZhbHVlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5lbmFibGVHcm91cEJ5Rm9ybWF0ID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBgYWxsb3dFZGl0aW5nYCBzZXQgdG8gZmFsc2UsIHRoZW4gaXQgZGlzYWJsZXMgZWRpdGluZyBvZiBhIHBhcnRpY3VsYXIgY29sdW1uLlxuICAgICAgICAgKiBCeSBkZWZhdWx0IGFsbCBjb2x1bW5zIGFyZSBlZGl0YWJsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlZmF1bHQgdHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hbGxvd0VkaXRpbmcgPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogIEl0IGlzIHVzZWQgdG8gY3VzdG9taXplIHRoZSBkZWZhdWx0IGZpbHRlciBvcHRpb25zIGZvciBhIHNwZWNpZmljIGNvbHVtbnMuXG4gICAgICAgICAqICogdHlwZSAtICBTcGVjaWZpZXMgdGhlIGZpbHRlciB0eXBlIGFzIG1lbnUgb3IgY2hlY2tib3guXG4gICAgICAgICAqICogdWkgLSB0byByZW5kZXIgY3VzdG9tIGNvbXBvbmVudCBmb3Igc3BlY2lmaWMgY29sdW1uIGl0IGhhcyBmb2xsb3dpbmcgZnVuY3Rpb25zLlxuICAgICAgICAgKiAqIHVpLmNyZWF0ZSDigJMgSXQgaXMgdXNlZCBmb3IgY3JlYXRpbmcgY3VzdG9tIGNvbXBvbmVudHMuXG4gICAgICAgICAqICogdWkucmVhZCAtICBJdCBpcyB1c2VkIGZvciByZWFkIHRoZSB2YWx1ZSBmcm9tIHRoZSBjb21wb25lbnQuXG4gICAgICAgICAqICogdWkud3JpdGUgLSBJdCBpcyB1c2VkIHRvIGFwcGx5IGNvbXBvbmVudCBtb2RlbCBhcyBkeW5hbWljYWxseS5cbiAgICAgICAgICogeyUgY29kZUJsb2NrIHNyYz1cImdyaWQvZmlsdGVyLW1lbnUtYXBpL2luZGV4LnRzXCIgJX17JSBlbmRjb2RlQmxvY2sgJX1cbiAgICAgICAgICpcbiAgICAgICAgICogPiBDaGVjayB0aGUgW2BGaWx0ZXIgVUlgXSguLi8uLi9ncmlkL2ZpbHRlcmluZy9maWx0ZXItbWVudS8jY3VzdG9tLWNvbXBvbmVudC1pbi1maWx0ZXItbWVudSkgZm9yIGl0cyBjdXN0b21pemF0aW9uLlxuICAgICAgICAgKlxuICAgICAgICAgKiAgQGRlZmF1bHQge31cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZmlsdGVyID0ge307XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBgc2hvd0luQ29sdW1uQ2hvb3NlcmAgc2V0IHRvIGZhbHNlLCB0aGVuIGhpZGUgdGhlIHBhcnRpY3VsYXIgY29sdW1uIGluIGNvbHVtbiBjaG9vc2VyLlxuICAgICAgICAgKiAgQnkgZGVmYXVsdCBhbGwgY29sdW1ucyBhcmUgZGlzcGxheWVkIGluIGNvbHVtbiBDaG9vc2VyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNob3dJbkNvbHVtbkNob29zZXIgPSB0cnVlO1xuICAgICAgICAvKipcbiAgICAgICAgICogRGVmaW5lcyB0aGUgYElFZGl0Q2VsbGAgb2JqZWN0IHRvIGN1c3RvbWl6ZSBkZWZhdWx0IGVkaXQgY2VsbC5cbiAgICAgICAgICpcbiAgICAgICAgICogQGRlZmF1bHQge31cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZWRpdCA9IHt9O1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgYGFsbG93U2VhcmNoaW5nYCBzZXQgdG8gZmFsc2UsIHRoZW4gaXQgZGlzYWJsZXMgU2VhcmNoaW5nIG9mIGEgcGFydGljdWxhciBjb2x1bW4uXG4gICAgICAgICAqIEJ5IGRlZmF1bHQgYWxsIGNvbHVtbnMgYWxsb3cgU2VhcmNoaW5nLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZGVmYXVsdCB0cnVlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmFsbG93U2VhcmNoaW5nID0gdHJ1ZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIGBhdXRvRml0YCBzZXQgdG8gdHJ1ZSwgdGhlbiB0aGUgcGFydGljdWxhciBjb2x1bW4gY29udGVudCB3aWR0aCB3aWxsIGJlXG4gICAgICAgICAqIGFkanVzdGVkIGJhc2VkIG9uIGl0cyBjb250ZW50IGluIHRoZSBpbml0aWFsIHJlbmRlcmluZyBpdHNlbGYuXG4gICAgICAgICAqIFNldHRpbmcgdGhpcyBwcm9wZXJ0eSBhcyB0cnVlIGlzIGVxdWl2YWxlbnQgdG8gY2FsbGluZyBgYXV0b0ZpdENvbHVtbnNgIG1ldGhvZCBpbiB0aGUgYGRhdGFCb3VuZGAgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZWZhdWx0IGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmF1dG9GaXQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zb3J0RGlyZWN0aW9uID0gJ0Rlc2NlbmRpbmcnO1xuICAgICAgICAvKipcbiAgICAgICAgICogQHJldHVybnMge0Z1bmN0aW9ufSByZXR1cm5zIHRoZSBlZGl0IHRlbXBsYXRlXG4gICAgICAgICAqIEBoaWRkZW4gKi9cbiAgICAgICAgdGhpcy5nZXRFZGl0VGVtcGxhdGUgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5lZGl0VGVtcGxhdGVGbjsgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gcmV0dXJucyB0aGUgZmlsdGVyIHRlbXBsYXRlXG4gICAgICAgICAqIEBoaWRkZW4gKi9cbiAgICAgICAgdGhpcy5nZXRGaWx0ZXJUZW1wbGF0ZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmZpbHRlclRlbXBsYXRlRm47IH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZXRlcm1pbmVzIHRoZSBiZWhhdmlvciBvZiB0aGUgYGFyaWEtbGFiZWxgIGF0dHJpYnV0ZSBmb3IgY2VsbHMgaW4gdGVtcGxhdGUgY29sdW1ucy5cbiAgICAgICAgICogSWYgZW5hYmxlQXJpYUxhYmVsIGlzIHNldCB0byBmYWxzZSwgdGhlIGFyaWEtbGFiZWwgYXR0cmlidXRlIGlzIG5vdCBhcHBsaWVkIHRvIHRlbXBsYXRlIGNvbHVtbiBjZWxscywgd2hpY2ggYWZmZWN0cyBzY3JlZW4gcmVhZGVyIGFjY2Vzc2liaWxpdHkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBkZWZhdWx0IHt9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnRlbXBsYXRlT3B0aW9ucyA9IHsgZW5hYmxlQXJpYUxhYmVsOiB0cnVlIH07XG4gICAgICAgIG1lcmdlKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ25vbmUnKSB7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMudHlwZSkge1xuICAgICAgICAgICAgdGhpcy50eXBlID0gdHlwZW9mICh0aGlzLnR5cGUpID09PSAnc3RyaW5nJyA/IHRoaXMudHlwZS50b0xvd2VyQ2FzZSgpIDogdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVkaXRUeXBlKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRUeXBlID0gdGhpcy5lZGl0VHlwZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZCh0aGlzLnVpZCkpIHtcbiAgICAgICAgICAgIHRoaXMudWlkID0gZ2V0VWlkKCdncmlkLWNvbHVtbicpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWx1ZUZvcm1hdHRlciA9IG5ldyBWYWx1ZUZvcm1hdHRlcigpO1xuICAgICAgICBpZiAob3B0aW9ucy5mb3JtYXQgJiYgKG9wdGlvbnMuZm9ybWF0LnNrZWxldG9uIHx8IChvcHRpb25zLmZvcm1hdC5mb3JtYXQgJiZcbiAgICAgICAgICAgIHR5cGVvZiBvcHRpb25zLmZvcm1hdC5mb3JtYXQgPT09ICdzdHJpbmcnKSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Rm9ybWF0dGVyKHZhbHVlRm9ybWF0dGVyLmdldEZvcm1hdEZ1bmN0aW9uKGV4dGVuZCh7fSwgb3B0aW9ucy5mb3JtYXQpKSk7XG4gICAgICAgICAgICB0aGlzLnNldFBhcnNlcih2YWx1ZUZvcm1hdHRlci5nZXRQYXJzZXJGdW5jdGlvbihvcHRpb25zLmZvcm1hdCkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudG9KU09OID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNvbCA9IHt9O1xuICAgICAgICAgICAgdmFyIHNraXAgPSBbJ2ZpbHRlcicsICdkYXRhU291cmNlJywgJ2hlYWRlclRleHQnLCAndGVtcGxhdGUnLCAnaGVhZGVyVGVtcGxhdGUnLCAnZWRpdCcsXG4gICAgICAgICAgICAgICAgJ2VkaXRUZW1wbGF0ZScsICdmaWx0ZXJUZW1wbGF0ZScsICdjb21tYW5kc1RlbXBsYXRlJywgJ3BhcmVudCddO1xuICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhfdGhpcyk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0gPT09ICdjb2x1bW5zJykge1xuICAgICAgICAgICAgICAgICAgICBjb2xba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgX3RoaXNba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dLnB1c2goX3RoaXNba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS50b0pTT04oKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc2tpcC5pbmRleE9mKGtleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29sW2tleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSA9IF90aGlzW2tleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29sO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoIXRoaXMuZmllbGQpIHtcbiAgICAgICAgICAgIHRoaXMuYWxsb3dGaWx0ZXJpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuYWxsb3dHcm91cGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5hbGxvd1NvcnRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFsbG93UmVzaXppbmcgPSB0aGlzLmNvbHVtbnMuc29tZShmdW5jdGlvbiAoY29sKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2wuYWxsb3dSZXNpemluZztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jb21tYW5kcyAmJiAhdGhpcy50ZXh0QWxpZ24pIHtcbiAgICAgICAgICAgIHRoaXMudGV4dEFsaWduID0gJ1JpZ2h0JztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50ZW1wbGF0ZSB8fCB0aGlzLmNvbW1hbmRzVGVtcGxhdGUpIHtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIodGhpcy50ZW1wbGF0ZSB8fCB0aGlzLmNvbW1hbmRzVGVtcGxhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmhlYWRlclRlbXBsYXRlKSB7XG4gICAgICAgICAgICB0aGlzLmhlYWRlclRlbXBsYXRlRm4gPSB0ZW1wbGF0ZUNvbXBpbGVyKHRoaXMuaGVhZGVyVGVtcGxhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5maWx0ZXIpICYmIHRoaXMuZmlsdGVyLml0ZW1UZW1wbGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5mbHRyVGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIodGhpcy5maWx0ZXIuaXRlbVRlbXBsYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lZGl0VGVtcGxhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdFRlbXBsYXRlRm4gPSB0ZW1wbGF0ZUNvbXBpbGVyKHRoaXMuZWRpdFRlbXBsYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWx0ZXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJUZW1wbGF0ZUZuID0gdGVtcGxhdGVDb21waWxlcih0aGlzLmZpbHRlclRlbXBsYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pc0ZvcmVpZ25Db2x1bW4oKSAmJlxuICAgICAgICAgICAgKGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZWRpdFR5cGUpIHx8IHRoaXMuZWRpdFR5cGUgPT09ICdkcm9wZG93bmVkaXQnIHx8IHRoaXMuZWRpdFR5cGUgPT09ICdkZWZhdWx0ZWRpdCcpKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRUeXBlID0gJ2Ryb3Bkb3duZWRpdCc7XG4gICAgICAgICAgICBpZiAodGhpcy5lZGl0LnBhcmFtcyAmJiB0aGlzLmVkaXQucGFyYW1zLmRhdGFTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXQucGFyYW1zLmRkRWRpdGVkRGF0YSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmVkaXQucGFyYW1zID0gZXh0ZW5kKHtcbiAgICAgICAgICAgICAgICBkYXRhU291cmNlOiB0aGlzLmRhdGFTb3VyY2UsXG4gICAgICAgICAgICAgICAgcXVlcnk6IG5ldyBRdWVyeSgpLCBmaWVsZHM6IHsgdmFsdWU6IHRoaXMuZm9yZWlnbktleUZpZWxkIHx8IHRoaXMuZmllbGQsIHRleHQ6IHRoaXMuZm9yZWlnbktleVZhbHVlIH1cbiAgICAgICAgICAgIH0sIHRoaXMuZWRpdC5wYXJhbXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNvcnRDb21wYXJlcikge1xuICAgICAgICAgICAgdmFyIGFfMSA9IHRoaXMuc29ydENvbXBhcmVyO1xuICAgICAgICAgICAgdGhpcy5zb3J0Q29tcGFyZXIgPSBmdW5jdGlvbiAoeCwgeSwgeE9iaiwgeU9iaikge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYV8xID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBhXzEgPSBnZXRPYmplY3QoYV8xLCB3aW5kb3cpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc29ydERpcmVjdGlvbiA9PT0gJ0Rlc2NlbmRpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB6ID0geDtcbiAgICAgICAgICAgICAgICAgICAgeCA9IHk7XG4gICAgICAgICAgICAgICAgICAgIHkgPSB6O1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0geE9iajtcbiAgICAgICAgICAgICAgICAgICAgeE9iaiA9IHlPYmo7XG4gICAgICAgICAgICAgICAgICAgIHlPYmogPSBvYmo7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhXzEoeCwgeSwgeE9iaiwgeU9iaik7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5zb3J0Q29tcGFyZXIgJiYgdGhpcy5pc0ZvcmVpZ25Db2x1bW4oKSkge1xuICAgICAgICAgICAgdGhpcy5zb3J0Q29tcGFyZXIgPSBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICAgICAgICAgIHggPSBnZXRPYmplY3QoX3RoaXMuZm9yZWlnbktleVZhbHVlLCBnZXRGb3JlaWduRGF0YShfdGhpcywge30sIHgpWzBdKTtcbiAgICAgICAgICAgICAgICB5ID0gZ2V0T2JqZWN0KF90aGlzLmZvcmVpZ25LZXlWYWx1ZSwgZ2V0Rm9yZWlnbkRhdGEoX3RoaXMsIHt9LCB5KVswXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNvcnREaXJlY3Rpb24gPT09ICdEZXNjZW5kaW5nJyA/IERhdGFVdGlsLmZuRGVzY2VuZGluZyh4LCB5KSA6IERhdGFVdGlsLmZuQXNjZW5kaW5nKHgsIHkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSByZXR1cm5zIHRoZSBzb3J0IGRpcmVjdGlvblxuICAgICAqIEBoaWRkZW4gKi9cbiAgICBDb2x1bW4ucHJvdG90eXBlLmdldFNvcnREaXJlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnREaXJlY3Rpb247XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGlyZWN0aW9uIC0gc3BlY2lmaWVzIHRoZSBkaXJlY3Rpb25cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQ29sdW1uLnByb3RvdHlwZS5zZXRTb3J0RGlyZWN0aW9uID0gZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICB0aGlzLnNvcnREaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7ZnJlZXplVGFibGV9IHJldHVybnMgdGhlIEZyZWV6ZVRhYmxlXG4gICAgICogQGhpZGRlbiAqL1xuICAgIENvbHVtbi5wcm90b3R5cGUuZ2V0RnJlZXplVGFibGVOYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mcmVlemVUYWJsZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Q29sdW1ufSBjb2x1bW4gLSBzcGVjaWZpZXMgdGhlIGNvbHVtblxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBDb2x1bW4ucHJvdG90eXBlLnNldFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoY29sdW1uKSB7XG4gICAgICAgIC8vQW5ndWxhciB0d28gd2F5IGJpbmRpbmdcbiAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhjb2x1bW4pO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICBpZiAoa2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0gPT09ICdjb2x1bW5zJykge1xuICAgICAgICAgICAgICAgIHZhciBjb2xzXzEgPSBjb2x1bW5ba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dO1xuICAgICAgICAgICAgICAgIHZhciBfbG9vcF8yID0gZnVuY3Rpb24gKGopIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc18xLmNvbHVtbnMuZmluZChmdW5jdGlvbiAoY29sKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sLmZpZWxkID09PSBjb2xzXzFbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpZWxkO1xuICAgICAgICAgICAgICAgICAgICB9KS5zZXRQcm9wZXJ0aWVzKGNvbHNfMVtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjb2xzXzEubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvb3BfMihqKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzXzFba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dID0gY29sdW1uW2tleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vUmVmcmVzaCB0aGUgcmVhY3QgY29sdW1uVGVtcGxhdGVzIG9uIHN0YXRlIGNoYW5nZVxuICAgICAgICAgICAgaWYgKHRoaXNfMS5wYXJlbnQgJiYgdGhpc18xLnBhcmVudC5pc1JlYWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGtleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID09PSAndGVtcGxhdGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNfMS50ZW1wbGF0ZUZuID0gdGVtcGxhdGVDb21waWxlcihjb2x1bW5ba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc18xLnBhcmVudC5yZWZyZXNoUmVhY3RDb2x1bW5UZW1wbGF0ZUJ5VWlkKHRoaXNfMS51aWQsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChrZXlzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9PT0gJ2hlYWRlclRlbXBsYXRlJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzXzEuaGVhZGVyVGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIoY29sdW1uW2tleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNfMS5wYXJlbnQucmVmcmVzaFJlYWN0SGVhZGVyVGVtcGxhdGVCeVVpZCh0aGlzXzEudWlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoa2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0gPT09ICdlZGl0VGVtcGxhdGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNfMS5lZGl0VGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIoY29sdW1uW2tleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGtleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID09PSAnZmlsdGVyVGVtcGxhdGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNfMS5maWx0ZXJUZW1wbGF0ZUZuID0gdGVtcGxhdGVDb21waWxlcihjb2x1bW5ba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoa2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0gPT09ICdjb21tYW5kc1RlbXBsYXRlJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzXzEudGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIoY29sdW1uW2tleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgdGhpc18xID0gdGhpcztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBfbG9vcF8xKGkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gcmV0dXJucyB0cnVlIGZvciBmb3JlaWduIGNvbHVtblxuICAgICAqIEBoaWRkZW5cbiAgICAgKiBJdCBkZWZpbmVzIHRoZSBjb2x1bW4gaXMgZm9yZWlnbiBrZXkgY29sdW1uIG9yIG5vdC5cbiAgICAgKi9cbiAgICBDb2x1bW4ucHJvdG90eXBlLmlzRm9yZWlnbkNvbHVtbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEhKHRoaXMuZGF0YVNvdXJjZSAmJiB0aGlzLmZvcmVpZ25LZXlWYWx1ZSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IHJldHVybnMgdGhlIGZ1bmN0aW9uXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIENvbHVtbi5wcm90b3R5cGUuZ2V0Rm9ybWF0dGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRGbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHZhbHVlIC0gc3BlY2lmaWVzIHRoZSB2YWx1ZVxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBDb2x1bW4ucHJvdG90eXBlLnNldEZvcm1hdHRlciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmZvcm1hdEZuID0gdmFsdWU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IHJldHVybnMgdGhlIGZ1bmN0aW9uXG4gICAgICogQGhpZGRlbiAqL1xuICAgIENvbHVtbi5wcm90b3R5cGUuZ2V0UGFyc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZXJGbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHZhbHVlIC0gc3BlY2lmaWVzIHRoZSB2YWx1ZVxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBDb2x1bW4ucHJvdG90eXBlLnNldFBhcnNlciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnBhcnNlckZuID0gdmFsdWU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IHJldHVybnMgdGhlIGZ1bmN0aW9uXG4gICAgICogQGhpZGRlbiAqL1xuICAgIENvbHVtbi5wcm90b3R5cGUuZ2V0Q29sdW1uVGVtcGxhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRlbXBsYXRlRm47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IHJldHVybnMgdGhlIGZ1bmN0aW9uXG4gICAgICogQGhpZGRlbiAqL1xuICAgIENvbHVtbi5wcm90b3R5cGUuZ2V0SGVhZGVyVGVtcGxhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhlYWRlclRlbXBsYXRlRm47XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IHJldHVybnMgdGhlIGZ1bmN0aW9uXG4gICAgICogQGhpZGRlbiAqL1xuICAgIENvbHVtbi5wcm90b3R5cGUuZ2V0RmlsdGVySXRlbVRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mbHRyVGVtcGxhdGVGbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgdGhlIHN0cmluZ1xuICAgICAqIEBoaWRkZW4gKi9cbiAgICBDb2x1bW4ucHJvdG90eXBlLmdldERvbVNldHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZUh0bWxFbmNvZGUgPyAndGV4dENvbnRlbnQnIDogJ2lubmVySFRNTCc7XG4gICAgfTtcbiAgICByZXR1cm4gQ29sdW1uO1xufSgpKTtcbmV4cG9ydCB7IENvbHVtbiB9O1xuLyoqXG4gKiBEZWZpbmUgb3B0aW9ucyBmb3IgY3VzdG9tIGNvbW1hbmQgYnV0dG9ucy5cbiAqL1xudmFyIENvbW1hbmRDb2x1bW5Nb2RlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb21tYW5kQ29sdW1uTW9kZWwoKSB7XG4gICAgfVxuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgQ29tbWFuZENvbHVtbk1vZGVsLnByb3RvdHlwZSwgXCJ0aXRsZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgQ29tbWFuZENvbHVtbk1vZGVsLnByb3RvdHlwZSwgXCJ0eXBlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBDb21tYW5kQ29sdW1uTW9kZWwucHJvdG90eXBlLCBcImJ1dHRvbk9wdGlvblwiLCB2b2lkIDApO1xuICAgIHJldHVybiBDb21tYW5kQ29sdW1uTW9kZWw7XG59KCkpO1xuZXhwb3J0IHsgQ29tbWFuZENvbHVtbk1vZGVsIH07XG4vKipcbiAqIERlZmluZXMgR3JpZCBjb2x1bW5cbiAqL1xudmFyIEdyaWRDb2x1bW4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEdyaWRDb2x1bW4sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gR3JpZENvbHVtbigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkobnVsbClcbiAgICBdLCBHcmlkQ29sdW1uLnByb3RvdHlwZSwgXCJjb2x1bW5zXCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIEdyaWRDb2x1bW47XG59KENvbHVtbikpO1xuZXhwb3J0IHsgR3JpZENvbHVtbiB9O1xuLyoqXG4gKiBEZWZpbmVzIHN0YWNrZWQgZ3JpZCBjb2x1bW5cbiAqL1xudmFyIFN0YWNrZWRDb2x1bW4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN0YWNrZWRDb2x1bW4sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3RhY2tlZENvbHVtbigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gU3RhY2tlZENvbHVtbjtcbn0oR3JpZENvbHVtbikpO1xuZXhwb3J0IHsgU3RhY2tlZENvbHVtbiB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/page-settings.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/page-settings.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PageSettings: () => (/* binding */ PageSettings)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\n/**\n * Configures the paging behavior of the Grid.\n */\nvar PageSettings = /** @class */ (function (_super) {\n    __extends(PageSettings, _super);\n    function PageSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(12)\n    ], PageSettings.prototype, \"pageSize\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(8)\n    ], PageSettings.prototype, \"pageCount\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(1)\n    ], PageSettings.prototype, \"currentPage\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], PageSettings.prototype, \"totalRecordsCount\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], PageSettings.prototype, \"enableQueryString\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], PageSettings.prototype, \"pageSizes\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(null)\n    ], PageSettings.prototype, \"template\", void 0);\n    return PageSettings;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.ChildProperty));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9tb2RlbHMvcGFnZS1zZXR0aW5ncy5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3QjtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLENBQUM7QUFDRCxrQkFBa0IsU0FBSSxJQUFJLFNBQUk7QUFDOUI7QUFDQTtBQUNBLDZDQUE2QyxRQUFRO0FBQ3JEO0FBQ0E7QUFDK0Q7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsQ0FBQyxDQUFDLCtEQUFhO0FBQ1MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9tb2RlbHMvcGFnZS1zZXR0aW5ncy5qcz8zOGQ3Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XG59O1xuaW1wb3J0IHsgUHJvcGVydHksIENoaWxkUHJvcGVydHkgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG4vKipcbiAqIENvbmZpZ3VyZXMgdGhlIHBhZ2luZyBiZWhhdmlvciBvZiB0aGUgR3JpZC5cbiAqL1xudmFyIFBhZ2VTZXR0aW5ncyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUGFnZVNldHRpbmdzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFBhZ2VTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoMTIpXG4gICAgXSwgUGFnZVNldHRpbmdzLnByb3RvdHlwZSwgXCJwYWdlU2l6ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSg4KVxuICAgIF0sIFBhZ2VTZXR0aW5ncy5wcm90b3R5cGUsIFwicGFnZUNvdW50XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KDEpXG4gICAgXSwgUGFnZVNldHRpbmdzLnByb3RvdHlwZSwgXCJjdXJyZW50UGFnZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgUGFnZVNldHRpbmdzLnByb3RvdHlwZSwgXCJ0b3RhbFJlY29yZHNDb3VudFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBQYWdlU2V0dGluZ3MucHJvdG90eXBlLCBcImVuYWJsZVF1ZXJ5U3RyaW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIFBhZ2VTZXR0aW5ncy5wcm90b3R5cGUsIFwicGFnZVNpemVzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KG51bGwpXG4gICAgXSwgUGFnZVNldHRpbmdzLnByb3RvdHlwZSwgXCJ0ZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIHJldHVybiBQYWdlU2V0dGluZ3M7XG59KENoaWxkUHJvcGVydHkpKTtcbmV4cG9ydCB7IFBhZ2VTZXR0aW5ncyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/page-settings.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/row.js":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/row.js ***!
  \********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Row: () => (/* binding */ Row)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n\n/**\n * Row\n *\n * @hidden\n */\nvar Row = /** @class */ (function () {\n    function Row(options, parent) {\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.merge)(this, options);\n        this.parent = parent;\n    }\n    Row.prototype.clone = function () {\n        var row = new Row({});\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.merge)(row, this);\n        row.cells = this.cells.map(function (cell) { return cell.clone(); });\n        return row;\n    };\n    /**\n     * Replaces the row data and grid refresh the particular row element only.\n     *\n     * @param  {Object} data - To update new data for the particular row.\n     * @returns {void}\n     */\n    Row.prototype.setRowValue = function (data) {\n        if (!this.parent) {\n            return;\n        }\n        var key = this.data[this.parent.getPrimaryKeyFieldNames()[0]];\n        this.parent.setRowData(key, data);\n    };\n    /**\n     * Replaces the given field value and refresh the particular cell element only.\n     *\n     * @param {string} field - Specifies the field name which you want to update.\n     * @param {string | number | boolean | Date} value - To update new value for the particular cell.\n     * @returns {void}\n     */\n    Row.prototype.setCellValue = function (field, value) {\n        if (!this.parent) {\n            return;\n        }\n        var isValDiff = !(this.data[\"\" + field].toString() === value.toString());\n        if (isValDiff) {\n            var pKeyField = this.parent.getPrimaryKeyFieldNames()[0];\n            var key = this.data[\"\" + pKeyField];\n            this.parent.setCellValue(key, field, value);\n            this.makechanges(pKeyField, this.data);\n        }\n        else {\n            return;\n        }\n    };\n    Row.prototype.makechanges = function (key, data) {\n        if (!this.parent) {\n            return;\n        }\n        var gObj = this.parent;\n        var dataManager = gObj.getDataModule().dataManager;\n        dataManager.update(key, data);\n    };\n    return Row;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9tb2RlbHMvcm93LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QixRQUFRLDJEQUFLO0FBQ2IscURBQXFELHNCQUFzQjtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVE7QUFDeEIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxrQ0FBa0M7QUFDakQsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNjIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvbW9kZWxzL3Jvdy5qcz8zMTYyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1lcmdlIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuLyoqXG4gKiBSb3dcbiAqXG4gKiBAaGlkZGVuXG4gKi9cbnZhciBSb3cgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUm93KG9wdGlvbnMsIHBhcmVudCkge1xuICAgICAgICBtZXJnZSh0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgfVxuICAgIFJvdy5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByb3cgPSBuZXcgUm93KHt9KTtcbiAgICAgICAgbWVyZ2Uocm93LCB0aGlzKTtcbiAgICAgICAgcm93LmNlbGxzID0gdGhpcy5jZWxscy5tYXAoZnVuY3Rpb24gKGNlbGwpIHsgcmV0dXJuIGNlbGwuY2xvbmUoKTsgfSk7XG4gICAgICAgIHJldHVybiByb3c7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXBsYWNlcyB0aGUgcm93IGRhdGEgYW5kIGdyaWQgcmVmcmVzaCB0aGUgcGFydGljdWxhciByb3cgZWxlbWVudCBvbmx5LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBkYXRhIC0gVG8gdXBkYXRlIG5ldyBkYXRhIGZvciB0aGUgcGFydGljdWxhciByb3cuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgUm93LnByb3RvdHlwZS5zZXRSb3dWYWx1ZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIga2V5ID0gdGhpcy5kYXRhW3RoaXMucGFyZW50LmdldFByaW1hcnlLZXlGaWVsZE5hbWVzKClbMF1dO1xuICAgICAgICB0aGlzLnBhcmVudC5zZXRSb3dEYXRhKGtleSwgZGF0YSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXBsYWNlcyB0aGUgZ2l2ZW4gZmllbGQgdmFsdWUgYW5kIHJlZnJlc2ggdGhlIHBhcnRpY3VsYXIgY2VsbCBlbGVtZW50IG9ubHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSBTcGVjaWZpZXMgdGhlIGZpZWxkIG5hbWUgd2hpY2ggeW91IHdhbnQgdG8gdXBkYXRlLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiB8IERhdGV9IHZhbHVlIC0gVG8gdXBkYXRlIG5ldyB2YWx1ZSBmb3IgdGhlIHBhcnRpY3VsYXIgY2VsbC5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBSb3cucHJvdG90eXBlLnNldENlbGxWYWx1ZSA9IGZ1bmN0aW9uIChmaWVsZCwgdmFsdWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpc1ZhbERpZmYgPSAhKHRoaXMuZGF0YVtcIlwiICsgZmllbGRdLnRvU3RyaW5nKCkgPT09IHZhbHVlLnRvU3RyaW5nKCkpO1xuICAgICAgICBpZiAoaXNWYWxEaWZmKSB7XG4gICAgICAgICAgICB2YXIgcEtleUZpZWxkID0gdGhpcy5wYXJlbnQuZ2V0UHJpbWFyeUtleUZpZWxkTmFtZXMoKVswXTtcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzLmRhdGFbXCJcIiArIHBLZXlGaWVsZF07XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5zZXRDZWxsVmFsdWUoa2V5LCBmaWVsZCwgdmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5tYWtlY2hhbmdlcyhwS2V5RmllbGQsIHRoaXMuZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJvdy5wcm90b3R5cGUubWFrZWNoYW5nZXMgPSBmdW5jdGlvbiAoa2V5LCBkYXRhKSB7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgZGF0YU1hbmFnZXIgPSBnT2JqLmdldERhdGFNb2R1bGUoKS5kYXRhTWFuYWdlcjtcbiAgICAgICAgZGF0YU1hbmFnZXIudXBkYXRlKGtleSwgZGF0YSk7XG4gICAgfTtcbiAgICByZXR1cm4gUm93O1xufSgpKTtcbmV4cG9ydCB7IFJvdyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/row.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/caption-cell-renderer.js":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/caption-cell-renderer.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GroupCaptionCellRenderer: () => (/* binding */ GroupCaptionCellRenderer),\n/* harmony export */   GroupCaptionEmptyCellRenderer: () => (/* binding */ GroupCaptionEmptyCellRenderer)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _cell_renderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n/**\n * GroupCaptionCellRenderer class which responsible for building group caption cell.\n *\n * @hidden\n */\nvar GroupCaptionCellRenderer = /** @class */ (function (_super) {\n    __extends(GroupCaptionCellRenderer, _super);\n    function GroupCaptionCellRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.cellUid = 0;\n        _this.element = _this.parent\n            .createElement('TD', { className: 'e-groupcaption',\n            attrs: { id: _this.parent.element.id + 'captioncell', tabindex: '-1' } });\n        return _this;\n    }\n    /**\n     * Function to render the cell content based on Column object.\n     *\n     * @param  {Cell} cell - specifies the cell\n     * @param  {Object} data - specifies the GroupedData\n     * @returns {Element} returns the element\n     */\n    GroupCaptionCellRenderer.prototype.render = function (cell, data) {\n        this.element.id = this.parent.element.id + 'captioncell' + this.cellUid++;\n        var node = this.element.cloneNode();\n        var gObj = this.parent;\n        var column = cell.column;\n        var domSetter = column.getDomSetter ? column.getDomSetter() : 'innerHTML';\n        var result;\n        var fKeyValue;\n        var gTemplateValue;\n        data.headerText = cell.column.headerText;\n        if (cell.isForeignKey) {\n            fKeyValue = this.format(cell.column, cell.column.valueAccessor('foreignKey', data, cell.column));\n        }\n        var value = cell.isForeignKey ? fKeyValue : cell.column.enableGroupByFormat ? data.key :\n            this.format(cell.column, cell.column.valueAccessor('key', data, cell.column));\n        for (var j = 0; j < gObj.aggregates.length; j++) {\n            var _loop_1 = function (i) {\n                if (gObj.getVisibleColumns()[0].field === gObj.aggregates[parseInt(j.toString(), 10)].columns[parseInt(i.toString(), 10)]\n                    .field && gObj.aggregates[parseInt(j.toString(), 10)].columns[parseInt(i.toString(), 10)].groupCaptionTemplate) {\n                    var gCaptionTemp = gObj.aggregates[parseInt(j.toString(), 10)]\n                        .columns[parseInt(i.toString(), 10)].groupCaptionTemplate;\n                    if (typeof gCaptionTemp === 'string' && gCaptionTemp.includes('$')) {\n                        gTemplateValue = gObj.aggregates[parseInt(j.toString(), 10)].columns[parseInt(i.toString(), 10)]\n                            .groupCaptionTemplate.split('$')[0] + data[gObj.getVisibleColumns()[0].field][gObj\n                            .aggregates[parseInt(j.toString(), 10)].columns[parseInt(i.toString(), 10)].type] +\n                            gObj.aggregates[parseInt(j.toString(), 10)].columns[parseInt(i.toString(), 10)]\n                                .groupCaptionTemplate.split('}')[1];\n                    }\n                    else {\n                        var column_1 = (gObj.aggregates[parseInt(j.toString(), 10)]\n                            .columns[parseInt(i.toString(), 10)]);\n                        var tempObj = column_1.getTemplate(_base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType.CaptionSummary);\n                        var tempID = '';\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(tempObj)) {\n                            var tempValue_1 = tempObj.fn(data[column_1.columnName], this_1.parent, tempObj.property, tempID);\n                            var isReactPrintGrid = this_1.parent.printGridParent\n                                && this_1.parent.printGridParent.isReact;\n                            if ((this_1.parent.isReact || isReactPrintGrid) && typeof column_1.groupCaptionTemplate !== 'string') {\n                                this_1.parent.renderTemplates(function () {\n                                    if (tempValue_1 && tempValue_1.length) {\n                                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.groupSettings.captionTemplate)) {\n                                            node.appendChild(tempValue_1[0]);\n                                        }\n                                        else {\n                                            node.innerText += ' ' + tempValue_1[0].textContent;\n                                        }\n                                    }\n                                });\n                            }\n                            else {\n                                if (tempValue_1 && tempValue_1.length) {\n                                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.groupSettings.captionTemplate)) {\n                                        gTemplateValue = tempValue_1;\n                                    }\n                                    else {\n                                        gTemplateValue = tempValue_1[0].textContent;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    return \"break\";\n                }\n            };\n            var this_1 = this;\n            for (var i = 0; i < gObj.aggregates[parseInt(j.toString(), 10)].columns.length; i++) {\n                var state_1 = _loop_1(i);\n                if (state_1 === \"break\")\n                    break;\n            }\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.groupSettings.captionTemplate)) {\n            var isReactCompiler = this.parent.isReact && typeof (gObj.groupSettings.captionTemplate) !== 'string' &&\n                !(gObj.groupSettings.captionTemplate.prototype &&\n                    gObj.groupSettings.captionTemplate.prototype.CSPTemplate);\n            var isReactChild = this.parent.parentDetails && this.parent.parentDetails.parentInstObj &&\n                this.parent.parentDetails.parentInstObj.isReact;\n            var isReactPrintGrid = this.parent.printGridParent && this.parent.printGridParent.isReact;\n            if (isReactCompiler || isReactChild || isReactPrintGrid) {\n                var tempID = gObj.element.id + 'captionTemplate';\n                var groupKey = 'groupKey';\n                var key = 'key';\n                data[\"\" + groupKey] = data[\"\" + key];\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.templateCompiler)(gObj.groupSettings.captionTemplate)(data, this.parent, 'captionTemplate', tempID, null, null, node);\n                this.parent.renderTemplates();\n            }\n            else if (this.parent.isVue\n                || (gObj.parentDetails && gObj.parentDetails.parentInstObj && gObj.parentDetails.parentInstObj.isVue)) {\n                result = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.templateCompiler)(gObj.groupSettings.captionTemplate)(data, this.parent, 'captionTemplate', null, null, null, null, gObj.root);\n            }\n            else {\n                result = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.templateCompiler)(gObj.groupSettings.captionTemplate)(data);\n            }\n            if (!isReactCompiler && !isReactChild && !isReactPrintGrid) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.appendChildren)(node, result);\n                if (gTemplateValue && gTemplateValue.length && gTemplateValue[0].textContent) {\n                    node.appendChild(gTemplateValue[0]);\n                }\n            }\n        }\n        else {\n            if (gObj.groupSettings.enableLazyLoading) {\n                node[\"\" + domSetter] = this.parent.sanitize(cell.column.headerText) + ': ' + this.parent.sanitize(value) +\n                    (gTemplateValue ? '   ' + gTemplateValue : '');\n            }\n            else {\n                node[\"\" + domSetter] = this.parent.sanitize(cell.column.headerText) + ': ' + this.parent.sanitize(value) +\n                    ' - ' + data.count + ' ' + (data.count < 2 ? this.localizer.getConstant('Item') : this.localizer.getConstant('Items'))\n                    + (gTemplateValue ? '   ' + gTemplateValue : '');\n            }\n        }\n        node.setAttribute('colspan', cell.colSpan.toString());\n        node.setAttribute('aria-label', node.innerHTML + this.localizer.getConstant('GroupCaption'));\n        node.setAttribute('title', node.textContent);\n        return node;\n    };\n    return GroupCaptionCellRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_3__.CellRenderer));\n\n/**\n * GroupCaptionEmptyCellRenderer class which responsible for building group caption empty cell.\n *\n * @hidden\n */\nvar GroupCaptionEmptyCellRenderer = /** @class */ (function (_super) {\n    __extends(GroupCaptionEmptyCellRenderer, _super);\n    function GroupCaptionEmptyCellRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.element = _this.parent.createElement('TD', { className: 'e-groupcaption' });\n        return _this;\n    }\n    /**\n     * Function to render the cell content based on Column object.\n     *\n     * @param {Cell} cell - specifies the cell\n     * @param {Object} data - specifies the Object\n     * @param {string} data.field - Defines the field\n     * @param {string} data.key - Defines the key\n     * @param {number} data.count - Defines the count\n     * @returns {Element} returns the element\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    GroupCaptionEmptyCellRenderer.prototype.render = function (cell, data) {\n        var node = this.element.cloneNode();\n        node.innerHTML = '&nbsp;';\n        node.setAttribute('colspan', cell.colSpan.toString());\n        return node;\n    };\n    return GroupCaptionEmptyCellRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_3__.CellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9jYXB0aW9uLWNlbGwtcmVuZGVyZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUN3RDtBQUNWO0FBQ2lCO0FBQ3hCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMscUJBQXFCLCtEQUErRDtBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLE1BQU07QUFDdEIsZ0JBQWdCLFFBQVE7QUFDeEIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNEJBQTRCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELGdEQUFRO0FBQ25FO0FBQ0EsNkJBQTZCLHVFQUFpQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsdUVBQWlCO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsdUVBQWlCO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGdFQUFnRTtBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1RUFBaUI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw0REFBZ0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNERBQWdCO0FBQ3pDO0FBQ0E7QUFDQSx5QkFBeUIsNERBQWdCO0FBQ3pDO0FBQ0E7QUFDQSxnQkFBZ0IsMERBQWM7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsd0RBQVk7QUFDc0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELDZCQUE2QjtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxNQUFNO0FBQ3JCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyx3REFBWTtBQUMyQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL3JlbmRlcmVyL2NhcHRpb24tY2VsbC1yZW5kZXJlci5qcz9lNGU2Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBDZWxsUmVuZGVyZXIgfSBmcm9tICcuL2NlbGwtcmVuZGVyZXInO1xuaW1wb3J0IHsgYXBwZW5kQ2hpbGRyZW4sIHRlbXBsYXRlQ29tcGlsZXIgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0IHsgQ2VsbFR5cGUgfSBmcm9tICcuLi9iYXNlL2VudW0nO1xuLyoqXG4gKiBHcm91cENhcHRpb25DZWxsUmVuZGVyZXIgY2xhc3Mgd2hpY2ggcmVzcG9uc2libGUgZm9yIGJ1aWxkaW5nIGdyb3VwIGNhcHRpb24gY2VsbC5cbiAqXG4gKiBAaGlkZGVuXG4gKi9cbnZhciBHcm91cENhcHRpb25DZWxsUmVuZGVyZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEdyb3VwQ2FwdGlvbkNlbGxSZW5kZXJlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBHcm91cENhcHRpb25DZWxsUmVuZGVyZXIoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5jZWxsVWlkID0gMDtcbiAgICAgICAgX3RoaXMuZWxlbWVudCA9IF90aGlzLnBhcmVudFxuICAgICAgICAgICAgLmNyZWF0ZUVsZW1lbnQoJ1REJywgeyBjbGFzc05hbWU6ICdlLWdyb3VwY2FwdGlvbicsXG4gICAgICAgICAgICBhdHRyczogeyBpZDogX3RoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnY2FwdGlvbmNlbGwnLCB0YWJpbmRleDogJy0xJyB9IH0pO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIHJlbmRlciB0aGUgY2VsbCBjb250ZW50IGJhc2VkIG9uIENvbHVtbiBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtDZWxsfSBjZWxsIC0gc3BlY2lmaWVzIHRoZSBjZWxsXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBkYXRhIC0gc3BlY2lmaWVzIHRoZSBHcm91cGVkRGF0YVxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgR3JvdXBDYXB0aW9uQ2VsbFJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoY2VsbCwgZGF0YSkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuaWQgPSB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgJ2NhcHRpb25jZWxsJyArIHRoaXMuY2VsbFVpZCsrO1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIGNvbHVtbiA9IGNlbGwuY29sdW1uO1xuICAgICAgICB2YXIgZG9tU2V0dGVyID0gY29sdW1uLmdldERvbVNldHRlciA/IGNvbHVtbi5nZXREb21TZXR0ZXIoKSA6ICdpbm5lckhUTUwnO1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICB2YXIgZktleVZhbHVlO1xuICAgICAgICB2YXIgZ1RlbXBsYXRlVmFsdWU7XG4gICAgICAgIGRhdGEuaGVhZGVyVGV4dCA9IGNlbGwuY29sdW1uLmhlYWRlclRleHQ7XG4gICAgICAgIGlmIChjZWxsLmlzRm9yZWlnbktleSkge1xuICAgICAgICAgICAgZktleVZhbHVlID0gdGhpcy5mb3JtYXQoY2VsbC5jb2x1bW4sIGNlbGwuY29sdW1uLnZhbHVlQWNjZXNzb3IoJ2ZvcmVpZ25LZXknLCBkYXRhLCBjZWxsLmNvbHVtbikpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWx1ZSA9IGNlbGwuaXNGb3JlaWduS2V5ID8gZktleVZhbHVlIDogY2VsbC5jb2x1bW4uZW5hYmxlR3JvdXBCeUZvcm1hdCA/IGRhdGEua2V5IDpcbiAgICAgICAgICAgIHRoaXMuZm9ybWF0KGNlbGwuY29sdW1uLCBjZWxsLmNvbHVtbi52YWx1ZUFjY2Vzc29yKCdrZXknLCBkYXRhLCBjZWxsLmNvbHVtbikpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGdPYmouYWdncmVnYXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgICAgIGlmIChnT2JqLmdldFZpc2libGVDb2x1bW5zKClbMF0uZmllbGQgPT09IGdPYmouYWdncmVnYXRlc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1cbiAgICAgICAgICAgICAgICAgICAgLmZpZWxkICYmIGdPYmouYWdncmVnYXRlc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZ3JvdXBDYXB0aW9uVGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdDYXB0aW9uVGVtcCA9IGdPYmouYWdncmVnYXRlc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV1cbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5ncm91cENhcHRpb25UZW1wbGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBnQ2FwdGlvblRlbXAgPT09ICdzdHJpbmcnICYmIGdDYXB0aW9uVGVtcC5pbmNsdWRlcygnJCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnVGVtcGxhdGVWYWx1ZSA9IGdPYmouYWdncmVnYXRlc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ3JvdXBDYXB0aW9uVGVtcGxhdGUuc3BsaXQoJyQnKVswXSArIGRhdGFbZ09iai5nZXRWaXNpYmxlQ29sdW1ucygpWzBdLmZpZWxkXVtnT2JqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFnZ3JlZ2F0ZXNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnR5cGVdICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnT2JqLmFnZ3JlZ2F0ZXNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ncm91cENhcHRpb25UZW1wbGF0ZS5zcGxpdCgnfScpWzFdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbHVtbl8xID0gKGdPYmouYWdncmVnYXRlc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBPYmogPSBjb2x1bW5fMS5nZXRUZW1wbGF0ZShDZWxsVHlwZS5DYXB0aW9uU3VtbWFyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcElEID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRlbXBPYmopKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBWYWx1ZV8xID0gdGVtcE9iai5mbihkYXRhW2NvbHVtbl8xLmNvbHVtbk5hbWVdLCB0aGlzXzEucGFyZW50LCB0ZW1wT2JqLnByb3BlcnR5LCB0ZW1wSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1JlYWN0UHJpbnRHcmlkID0gdGhpc18xLnBhcmVudC5wcmludEdyaWRQYXJlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgdGhpc18xLnBhcmVudC5wcmludEdyaWRQYXJlbnQuaXNSZWFjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHRoaXNfMS5wYXJlbnQuaXNSZWFjdCB8fCBpc1JlYWN0UHJpbnRHcmlkKSAmJiB0eXBlb2YgY29sdW1uXzEuZ3JvdXBDYXB0aW9uVGVtcGxhdGUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNfMS5wYXJlbnQucmVuZGVyVGVtcGxhdGVzKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wVmFsdWVfMSAmJiB0ZW1wVmFsdWVfMS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGdPYmouZ3JvdXBTZXR0aW5ncy5jYXB0aW9uVGVtcGxhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQodGVtcFZhbHVlXzFbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5pbm5lclRleHQgKz0gJyAnICsgdGVtcFZhbHVlXzFbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wVmFsdWVfMSAmJiB0ZW1wVmFsdWVfMS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZ09iai5ncm91cFNldHRpbmdzLmNhcHRpb25UZW1wbGF0ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnVGVtcGxhdGVWYWx1ZSA9IHRlbXBWYWx1ZV8xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1RlbXBsYXRlVmFsdWUgPSB0ZW1wVmFsdWVfMVswXS50ZXh0Q29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJicmVha1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgdGhpc18xID0gdGhpcztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ09iai5hZ2dyZWdhdGVzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlXzEgPSBfbG9vcF8xKGkpO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZV8xID09PSBcImJyZWFrXCIpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZ09iai5ncm91cFNldHRpbmdzLmNhcHRpb25UZW1wbGF0ZSkpIHtcbiAgICAgICAgICAgIHZhciBpc1JlYWN0Q29tcGlsZXIgPSB0aGlzLnBhcmVudC5pc1JlYWN0ICYmIHR5cGVvZiAoZ09iai5ncm91cFNldHRpbmdzLmNhcHRpb25UZW1wbGF0ZSkgIT09ICdzdHJpbmcnICYmXG4gICAgICAgICAgICAgICAgIShnT2JqLmdyb3VwU2V0dGluZ3MuY2FwdGlvblRlbXBsYXRlLnByb3RvdHlwZSAmJlxuICAgICAgICAgICAgICAgICAgICBnT2JqLmdyb3VwU2V0dGluZ3MuY2FwdGlvblRlbXBsYXRlLnByb3RvdHlwZS5DU1BUZW1wbGF0ZSk7XG4gICAgICAgICAgICB2YXIgaXNSZWFjdENoaWxkID0gdGhpcy5wYXJlbnQucGFyZW50RGV0YWlscyAmJiB0aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmogJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmouaXNSZWFjdDtcbiAgICAgICAgICAgIHZhciBpc1JlYWN0UHJpbnRHcmlkID0gdGhpcy5wYXJlbnQucHJpbnRHcmlkUGFyZW50ICYmIHRoaXMucGFyZW50LnByaW50R3JpZFBhcmVudC5pc1JlYWN0O1xuICAgICAgICAgICAgaWYgKGlzUmVhY3RDb21waWxlciB8fCBpc1JlYWN0Q2hpbGQgfHwgaXNSZWFjdFByaW50R3JpZCkge1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wSUQgPSBnT2JqLmVsZW1lbnQuaWQgKyAnY2FwdGlvblRlbXBsYXRlJztcbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXBLZXkgPSAnZ3JvdXBLZXknO1xuICAgICAgICAgICAgICAgIHZhciBrZXkgPSAna2V5JztcbiAgICAgICAgICAgICAgICBkYXRhW1wiXCIgKyBncm91cEtleV0gPSBkYXRhW1wiXCIgKyBrZXldO1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlQ29tcGlsZXIoZ09iai5ncm91cFNldHRpbmdzLmNhcHRpb25UZW1wbGF0ZSkoZGF0YSwgdGhpcy5wYXJlbnQsICdjYXB0aW9uVGVtcGxhdGUnLCB0ZW1wSUQsIG51bGwsIG51bGwsIG5vZGUpO1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnJlbmRlclRlbXBsYXRlcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wYXJlbnQuaXNWdWVcbiAgICAgICAgICAgICAgICB8fCAoZ09iai5wYXJlbnREZXRhaWxzICYmIGdPYmoucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqICYmIGdPYmoucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqLmlzVnVlKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRlbXBsYXRlQ29tcGlsZXIoZ09iai5ncm91cFNldHRpbmdzLmNhcHRpb25UZW1wbGF0ZSkoZGF0YSwgdGhpcy5wYXJlbnQsICdjYXB0aW9uVGVtcGxhdGUnLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBnT2JqLnJvb3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGVtcGxhdGVDb21waWxlcihnT2JqLmdyb3VwU2V0dGluZ3MuY2FwdGlvblRlbXBsYXRlKShkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNSZWFjdENvbXBpbGVyICYmICFpc1JlYWN0Q2hpbGQgJiYgIWlzUmVhY3RQcmludEdyaWQpIHtcbiAgICAgICAgICAgICAgICBhcHBlbmRDaGlsZHJlbihub2RlLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIGlmIChnVGVtcGxhdGVWYWx1ZSAmJiBnVGVtcGxhdGVWYWx1ZS5sZW5ndGggJiYgZ1RlbXBsYXRlVmFsdWVbMF0udGV4dENvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChnVGVtcGxhdGVWYWx1ZVswXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGdPYmouZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZykge1xuICAgICAgICAgICAgICAgIG5vZGVbXCJcIiArIGRvbVNldHRlcl0gPSB0aGlzLnBhcmVudC5zYW5pdGl6ZShjZWxsLmNvbHVtbi5oZWFkZXJUZXh0KSArICc6ICcgKyB0aGlzLnBhcmVudC5zYW5pdGl6ZSh2YWx1ZSkgK1xuICAgICAgICAgICAgICAgICAgICAoZ1RlbXBsYXRlVmFsdWUgPyAnICAgJyArIGdUZW1wbGF0ZVZhbHVlIDogJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbm9kZVtcIlwiICsgZG9tU2V0dGVyXSA9IHRoaXMucGFyZW50LnNhbml0aXplKGNlbGwuY29sdW1uLmhlYWRlclRleHQpICsgJzogJyArIHRoaXMucGFyZW50LnNhbml0aXplKHZhbHVlKSArXG4gICAgICAgICAgICAgICAgICAgICcgLSAnICsgZGF0YS5jb3VudCArICcgJyArIChkYXRhLmNvdW50IDwgMiA/IHRoaXMubG9jYWxpemVyLmdldENvbnN0YW50KCdJdGVtJykgOiB0aGlzLmxvY2FsaXplci5nZXRDb25zdGFudCgnSXRlbXMnKSlcbiAgICAgICAgICAgICAgICAgICAgKyAoZ1RlbXBsYXRlVmFsdWUgPyAnICAgJyArIGdUZW1wbGF0ZVZhbHVlIDogJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdjb2xzcGFuJywgY2VsbC5jb2xTcGFuLnRvU3RyaW5nKCkpO1xuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIG5vZGUuaW5uZXJIVE1MICsgdGhpcy5sb2NhbGl6ZXIuZ2V0Q29uc3RhbnQoJ0dyb3VwQ2FwdGlvbicpKTtcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgbm9kZS50ZXh0Q29udGVudCk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgcmV0dXJuIEdyb3VwQ2FwdGlvbkNlbGxSZW5kZXJlcjtcbn0oQ2VsbFJlbmRlcmVyKSk7XG5leHBvcnQgeyBHcm91cENhcHRpb25DZWxsUmVuZGVyZXIgfTtcbi8qKlxuICogR3JvdXBDYXB0aW9uRW1wdHlDZWxsUmVuZGVyZXIgY2xhc3Mgd2hpY2ggcmVzcG9uc2libGUgZm9yIGJ1aWxkaW5nIGdyb3VwIGNhcHRpb24gZW1wdHkgY2VsbC5cbiAqXG4gKiBAaGlkZGVuXG4gKi9cbnZhciBHcm91cENhcHRpb25FbXB0eUNlbGxSZW5kZXJlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoR3JvdXBDYXB0aW9uRW1wdHlDZWxsUmVuZGVyZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gR3JvdXBDYXB0aW9uRW1wdHlDZWxsUmVuZGVyZXIoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5lbGVtZW50ID0gX3RoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ1REJywgeyBjbGFzc05hbWU6ICdlLWdyb3VwY2FwdGlvbicgfSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdG8gcmVuZGVyIHRoZSBjZWxsIGNvbnRlbnQgYmFzZWQgb24gQ29sdW1uIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Q2VsbH0gY2VsbCAtIHNwZWNpZmllcyB0aGUgY2VsbFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gc3BlY2lmaWVzIHRoZSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGF0YS5maWVsZCAtIERlZmluZXMgdGhlIGZpZWxkXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRhdGEua2V5IC0gRGVmaW5lcyB0aGUga2V5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGEuY291bnQgLSBEZWZpbmVzIHRoZSBjb3VudFxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIEdyb3VwQ2FwdGlvbkVtcHR5Q2VsbFJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoY2VsbCwgZGF0YSkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICAgICAgbm9kZS5pbm5lckhUTUwgPSAnJm5ic3A7JztcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ2NvbHNwYW4nLCBjZWxsLmNvbFNwYW4udG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgcmV0dXJuIEdyb3VwQ2FwdGlvbkVtcHR5Q2VsbFJlbmRlcmVyO1xufShDZWxsUmVuZGVyZXIpKTtcbmV4cG9ydCB7IEdyb3VwQ2FwdGlvbkVtcHR5Q2VsbFJlbmRlcmVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/caption-cell-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-merge-renderer.js":
/*!**************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-merge-renderer.js ***!
  \**************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CellMergeRender: () => (/* binding */ CellMergeRender)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n\n\n\n/**\n * `CellMergeRender` module.\n *\n * @hidden\n */\nvar CellMergeRender = /** @class */ (function () {\n    function CellMergeRender(serviceLocator, parent) {\n        this.serviceLocator = serviceLocator;\n        this.parent = parent;\n    }\n    CellMergeRender.prototype.render = function (cellArgs, row, i, td) {\n        var cellRendererFact = this.serviceLocator.getService('cellRendererFactory');\n        var cellRenderer = cellRendererFact.getCellRenderer(row.cells[parseInt(i.toString(), 10)].cellType\n            || _base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType.Data);\n        var colSpan = row.cells[parseInt(i.toString(), 10)].cellSpan ? row.cells[parseInt(i.toString(), 10)].cellSpan :\n            cellArgs.colSpan ? (cellArgs.colSpan + i) <= row.cells.length ? cellArgs.colSpan : row.cells.length - i : 1;\n        var rowSpan = cellArgs.rowSpan;\n        var visible = 0;\n        var spannedCell;\n        if (row.index > 0) {\n            var rowsObject = this.parent.getRowsObject();\n            var cells = this.parent.groupSettings.columns.length > 0 &&\n                !rowsObject[row.index - 1].isDataRow ? rowsObject[row.index].cells : rowsObject[row.index - 1].cells;\n            var targetCell_1 = row.cells[parseInt(i.toString(), 10)];\n            var uid_1 = 'uid';\n            spannedCell = cells.filter(function (cell) { return cell.column.uid === targetCell_1.column[\"\" + uid_1]; })[0];\n        }\n        var colSpanLen = spannedCell && spannedCell.colSpanRange > 1 && spannedCell.rowSpanRange > 1 ?\n            spannedCell.colSpanRange : colSpan;\n        for (var j = i + 1; j < i + colSpanLen && j < row.cells.length; j++) {\n            if (row.cells[parseInt(j.toString(), 10)].visible === false) {\n                visible++;\n            }\n            else {\n                row.cells[parseInt(j.toString(), 10)].isSpanned = true;\n            }\n        }\n        if (visible > 0) {\n            for (var j = i + colSpan; j < i + colSpan + visible && j < row.cells.length; j++) {\n                row.cells[parseInt(j.toString(), 10)].isSpanned = true;\n            }\n            if (i + colSpan + visible >= row.cells.length) {\n                colSpan -= (i + colSpan + visible) - row.cells.length;\n            }\n        }\n        if (row.cells[parseInt(i.toString(), 10)].cellSpan) {\n            row.data[cellArgs.column.field] = row.cells[parseInt(i.toString(), 10)].spanText;\n            td = cellRenderer.render(row.cells[parseInt(i.toString(), 10)], row.data, { 'index': !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row.index) ? row.index.toString() : '' });\n        }\n        if (colSpan > 1) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(td, { 'colSpan': colSpan.toString(), 'aria-colSpan': colSpan.toString() });\n        }\n        if (rowSpan > 1) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(td, { 'rowspan': rowSpan.toString(), 'aria-rowspan': rowSpan.toString() });\n            row.cells[parseInt(i.toString(), 10)].isRowSpanned = true;\n            row.cells[parseInt(i.toString(), 10)].rowSpanRange = Number(rowSpan);\n            if (colSpan > 1) {\n                row.cells[parseInt(i.toString(), 10)].colSpanRange = Number(colSpan);\n            }\n        }\n        if (row.index > 0 && (spannedCell.rowSpanRange > 1)) {\n            row.cells[parseInt(i.toString(), 10)].isSpanned = true;\n            row.cells[parseInt(i.toString(), 10)].rowSpanRange = Number(spannedCell.rowSpanRange - 1);\n            row.cells[parseInt(i.toString(), 10)].colSpanRange = spannedCell.rowSpanRange > 0 ? spannedCell.colSpanRange : 1;\n        }\n        if (this.parent.enableColumnVirtualization && !row.cells[parseInt(i.toString(), 10)].cellSpan &&\n            !this.containsKey(cellArgs.column.field, cellArgs.data[cellArgs.column.field])) {\n            this.backupMergeCells(cellArgs.column.field, cellArgs.data[cellArgs.column.field], cellArgs.colSpan);\n        }\n        return td;\n    };\n    CellMergeRender.prototype.backupMergeCells = function (fName, data, span) {\n        this.setMergeCells(this.generteKey(fName, data), span);\n    };\n    CellMergeRender.prototype.generteKey = function (fname, data) {\n        return fname + '__' + data.toString();\n    };\n    CellMergeRender.prototype.splitKey = function (key) {\n        return key.split('__');\n    };\n    CellMergeRender.prototype.containsKey = function (fname, data) {\n        // eslint-disable-next-line no-prototype-builtins\n        return this.getMergeCells().hasOwnProperty(this.generteKey(fname, data));\n    };\n    CellMergeRender.prototype.getMergeCells = function () {\n        return this.parent.mergeCells;\n    };\n    CellMergeRender.prototype.setMergeCells = function (key, span) {\n        this.parent.mergeCells[\"\" + key] = span;\n    };\n    CellMergeRender.prototype.updateVirtualCells = function (rows) {\n        var mCells = this.getMergeCells();\n        for (var _i = 0, _a = Object.keys(mCells); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var value = mCells[\"\" + key];\n            var merge = this.splitKey(key);\n            var columnIndex = this.getIndexFromAllColumns(merge[0]);\n            var vColumnIndices = this.parent.getColumnIndexesInView();\n            var span = value - (vColumnIndices[0] - columnIndex);\n            if (columnIndex < vColumnIndices[0] && span > 1) {\n                for (var _b = 0, rows_1 = rows; _b < rows_1.length; _b++) {\n                    var row = rows_1[_b];\n                    if (row.data[merge[0]].toString() === merge[1].toString()) {\n                        row.cells[0].cellSpan = span;\n                        row.cells[0].spanText = merge[1];\n                        break;\n                    }\n                }\n            }\n        }\n        return rows;\n    };\n    CellMergeRender.prototype.getIndexFromAllColumns = function (field) {\n        var index = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.iterateArrayOrObject)(this.parent.getVisibleColumns(), function (item, index) {\n            if (item.field === field) {\n                return index;\n            }\n            return undefined;\n        })[0];\n        return index;\n    };\n    return CellMergeRender;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9jZWxsLW1lcmdlLXJlbmRlcmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBcUU7QUFDakI7QUFDWjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZ0RBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCw2REFBNkQ7QUFDdEg7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDRDQUE0QztBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLG1EQUFtRDtBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0ZBQXdGLFVBQVUsdUVBQWlCLHlDQUF5QztBQUM1SjtBQUNBO0FBQ0EsWUFBWSxnRUFBVSxPQUFPLG1FQUFtRTtBQUNoRztBQUNBO0FBQ0EsWUFBWSxnRUFBVSxPQUFPLG1FQUFtRTtBQUNoRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGdCQUFnQjtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxvQkFBb0I7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGdFQUFvQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQzBCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvcmVuZGVyZXIvY2VsbC1tZXJnZS1yZW5kZXJlci5qcz85MWYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzTnVsbE9yVW5kZWZpbmVkLCBhdHRyaWJ1dGVzIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgaXRlcmF0ZUFycmF5T3JPYmplY3QgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0IHsgQ2VsbFR5cGUgfSBmcm9tICcuLi9iYXNlL2VudW0nO1xuLyoqXG4gKiBgQ2VsbE1lcmdlUmVuZGVyYCBtb2R1bGUuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgQ2VsbE1lcmdlUmVuZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENlbGxNZXJnZVJlbmRlcihzZXJ2aWNlTG9jYXRvciwgcGFyZW50KSB7XG4gICAgICAgIHRoaXMuc2VydmljZUxvY2F0b3IgPSBzZXJ2aWNlTG9jYXRvcjtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgfVxuICAgIENlbGxNZXJnZVJlbmRlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKGNlbGxBcmdzLCByb3csIGksIHRkKSB7XG4gICAgICAgIHZhciBjZWxsUmVuZGVyZXJGYWN0ID0gdGhpcy5zZXJ2aWNlTG9jYXRvci5nZXRTZXJ2aWNlKCdjZWxsUmVuZGVyZXJGYWN0b3J5Jyk7XG4gICAgICAgIHZhciBjZWxsUmVuZGVyZXIgPSBjZWxsUmVuZGVyZXJGYWN0LmdldENlbGxSZW5kZXJlcihyb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxUeXBlXG4gICAgICAgICAgICB8fCBDZWxsVHlwZS5EYXRhKTtcbiAgICAgICAgdmFyIGNvbFNwYW4gPSByb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxTcGFuID8gcm93LmNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxsU3BhbiA6XG4gICAgICAgICAgICBjZWxsQXJncy5jb2xTcGFuID8gKGNlbGxBcmdzLmNvbFNwYW4gKyBpKSA8PSByb3cuY2VsbHMubGVuZ3RoID8gY2VsbEFyZ3MuY29sU3BhbiA6IHJvdy5jZWxscy5sZW5ndGggLSBpIDogMTtcbiAgICAgICAgdmFyIHJvd1NwYW4gPSBjZWxsQXJncy5yb3dTcGFuO1xuICAgICAgICB2YXIgdmlzaWJsZSA9IDA7XG4gICAgICAgIHZhciBzcGFubmVkQ2VsbDtcbiAgICAgICAgaWYgKHJvdy5pbmRleCA+IDApIHtcbiAgICAgICAgICAgIHZhciByb3dzT2JqZWN0ID0gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpO1xuICAgICAgICAgICAgdmFyIGNlbGxzID0gdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICAgICAgICAhcm93c09iamVjdFtyb3cuaW5kZXggLSAxXS5pc0RhdGFSb3cgPyByb3dzT2JqZWN0W3Jvdy5pbmRleF0uY2VsbHMgOiByb3dzT2JqZWN0W3Jvdy5pbmRleCAtIDFdLmNlbGxzO1xuICAgICAgICAgICAgdmFyIHRhcmdldENlbGxfMSA9IHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICB2YXIgdWlkXzEgPSAndWlkJztcbiAgICAgICAgICAgIHNwYW5uZWRDZWxsID0gY2VsbHMuZmlsdGVyKGZ1bmN0aW9uIChjZWxsKSB7IHJldHVybiBjZWxsLmNvbHVtbi51aWQgPT09IHRhcmdldENlbGxfMS5jb2x1bW5bXCJcIiArIHVpZF8xXTsgfSlbMF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbFNwYW5MZW4gPSBzcGFubmVkQ2VsbCAmJiBzcGFubmVkQ2VsbC5jb2xTcGFuUmFuZ2UgPiAxICYmIHNwYW5uZWRDZWxsLnJvd1NwYW5SYW5nZSA+IDEgP1xuICAgICAgICAgICAgc3Bhbm5lZENlbGwuY29sU3BhblJhbmdlIDogY29sU3BhbjtcbiAgICAgICAgZm9yICh2YXIgaiA9IGkgKyAxOyBqIDwgaSArIGNvbFNwYW5MZW4gJiYgaiA8IHJvdy5jZWxscy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgaWYgKHJvdy5jZWxsc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB2aXNpYmxlKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByb3cuY2VsbHNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmlzU3Bhbm5lZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpc2libGUgPiAwKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gaSArIGNvbFNwYW47IGogPCBpICsgY29sU3BhbiArIHZpc2libGUgJiYgaiA8IHJvdy5jZWxscy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHJvdy5jZWxsc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uaXNTcGFubmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpICsgY29sU3BhbiArIHZpc2libGUgPj0gcm93LmNlbGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbFNwYW4gLT0gKGkgKyBjb2xTcGFuICsgdmlzaWJsZSkgLSByb3cuY2VsbHMubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChyb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxTcGFuKSB7XG4gICAgICAgICAgICByb3cuZGF0YVtjZWxsQXJncy5jb2x1bW4uZmllbGRdID0gcm93LmNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5zcGFuVGV4dDtcbiAgICAgICAgICAgIHRkID0gY2VsbFJlbmRlcmVyLnJlbmRlcihyb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCByb3cuZGF0YSwgeyAnaW5kZXgnOiAhaXNOdWxsT3JVbmRlZmluZWQocm93LmluZGV4KSA/IHJvdy5pbmRleC50b1N0cmluZygpIDogJycgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbFNwYW4gPiAxKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzKHRkLCB7ICdjb2xTcGFuJzogY29sU3Bhbi50b1N0cmluZygpLCAnYXJpYS1jb2xTcGFuJzogY29sU3Bhbi50b1N0cmluZygpIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyb3dTcGFuID4gMSkge1xuICAgICAgICAgICAgYXR0cmlidXRlcyh0ZCwgeyAncm93c3Bhbic6IHJvd1NwYW4udG9TdHJpbmcoKSwgJ2FyaWEtcm93c3Bhbic6IHJvd1NwYW4udG9TdHJpbmcoKSB9KTtcbiAgICAgICAgICAgIHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNSb3dTcGFubmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ucm93U3BhblJhbmdlID0gTnVtYmVyKHJvd1NwYW4pO1xuICAgICAgICAgICAgaWYgKGNvbFNwYW4gPiAxKSB7XG4gICAgICAgICAgICAgICAgcm93LmNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2xTcGFuUmFuZ2UgPSBOdW1iZXIoY29sU3Bhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdy5pbmRleCA+IDAgJiYgKHNwYW5uZWRDZWxsLnJvd1NwYW5SYW5nZSA+IDEpKSB7XG4gICAgICAgICAgICByb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzU3Bhbm5lZCA9IHRydWU7XG4gICAgICAgICAgICByb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnJvd1NwYW5SYW5nZSA9IE51bWJlcihzcGFubmVkQ2VsbC5yb3dTcGFuUmFuZ2UgLSAxKTtcbiAgICAgICAgICAgIHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sU3BhblJhbmdlID0gc3Bhbm5lZENlbGwucm93U3BhblJhbmdlID4gMCA/IHNwYW5uZWRDZWxsLmNvbFNwYW5SYW5nZSA6IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uICYmICFyb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxTcGFuICYmXG4gICAgICAgICAgICAhdGhpcy5jb250YWluc0tleShjZWxsQXJncy5jb2x1bW4uZmllbGQsIGNlbGxBcmdzLmRhdGFbY2VsbEFyZ3MuY29sdW1uLmZpZWxkXSkpIHtcbiAgICAgICAgICAgIHRoaXMuYmFja3VwTWVyZ2VDZWxscyhjZWxsQXJncy5jb2x1bW4uZmllbGQsIGNlbGxBcmdzLmRhdGFbY2VsbEFyZ3MuY29sdW1uLmZpZWxkXSwgY2VsbEFyZ3MuY29sU3Bhbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRkO1xuICAgIH07XG4gICAgQ2VsbE1lcmdlUmVuZGVyLnByb3RvdHlwZS5iYWNrdXBNZXJnZUNlbGxzID0gZnVuY3Rpb24gKGZOYW1lLCBkYXRhLCBzcGFuKSB7XG4gICAgICAgIHRoaXMuc2V0TWVyZ2VDZWxscyh0aGlzLmdlbmVydGVLZXkoZk5hbWUsIGRhdGEpLCBzcGFuKTtcbiAgICB9O1xuICAgIENlbGxNZXJnZVJlbmRlci5wcm90b3R5cGUuZ2VuZXJ0ZUtleSA9IGZ1bmN0aW9uIChmbmFtZSwgZGF0YSkge1xuICAgICAgICByZXR1cm4gZm5hbWUgKyAnX18nICsgZGF0YS50b1N0cmluZygpO1xuICAgIH07XG4gICAgQ2VsbE1lcmdlUmVuZGVyLnByb3RvdHlwZS5zcGxpdEtleSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcmV0dXJuIGtleS5zcGxpdCgnX18nKTtcbiAgICB9O1xuICAgIENlbGxNZXJnZVJlbmRlci5wcm90b3R5cGUuY29udGFpbnNLZXkgPSBmdW5jdGlvbiAoZm5hbWUsIGRhdGEpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXByb3RvdHlwZS1idWlsdGluc1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXJnZUNlbGxzKCkuaGFzT3duUHJvcGVydHkodGhpcy5nZW5lcnRlS2V5KGZuYW1lLCBkYXRhKSk7XG4gICAgfTtcbiAgICBDZWxsTWVyZ2VSZW5kZXIucHJvdG90eXBlLmdldE1lcmdlQ2VsbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5tZXJnZUNlbGxzO1xuICAgIH07XG4gICAgQ2VsbE1lcmdlUmVuZGVyLnByb3RvdHlwZS5zZXRNZXJnZUNlbGxzID0gZnVuY3Rpb24gKGtleSwgc3Bhbikge1xuICAgICAgICB0aGlzLnBhcmVudC5tZXJnZUNlbGxzW1wiXCIgKyBrZXldID0gc3BhbjtcbiAgICB9O1xuICAgIENlbGxNZXJnZVJlbmRlci5wcm90b3R5cGUudXBkYXRlVmlydHVhbENlbGxzID0gZnVuY3Rpb24gKHJvd3MpIHtcbiAgICAgICAgdmFyIG1DZWxscyA9IHRoaXMuZ2V0TWVyZ2VDZWxscygpO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gT2JqZWN0LmtleXMobUNlbGxzKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBfYVtfaV07XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBtQ2VsbHNbXCJcIiArIGtleV07XG4gICAgICAgICAgICB2YXIgbWVyZ2UgPSB0aGlzLnNwbGl0S2V5KGtleSk7XG4gICAgICAgICAgICB2YXIgY29sdW1uSW5kZXggPSB0aGlzLmdldEluZGV4RnJvbUFsbENvbHVtbnMobWVyZ2VbMF0pO1xuICAgICAgICAgICAgdmFyIHZDb2x1bW5JbmRpY2VzID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1uSW5kZXhlc0luVmlldygpO1xuICAgICAgICAgICAgdmFyIHNwYW4gPSB2YWx1ZSAtICh2Q29sdW1uSW5kaWNlc1swXSAtIGNvbHVtbkluZGV4KTtcbiAgICAgICAgICAgIGlmIChjb2x1bW5JbmRleCA8IHZDb2x1bW5JbmRpY2VzWzBdICYmIHNwYW4gPiAxKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2IgPSAwLCByb3dzXzEgPSByb3dzOyBfYiA8IHJvd3NfMS5sZW5ndGg7IF9iKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvdyA9IHJvd3NfMVtfYl07XG4gICAgICAgICAgICAgICAgICAgIGlmIChyb3cuZGF0YVttZXJnZVswXV0udG9TdHJpbmcoKSA9PT0gbWVyZ2VbMV0udG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93LmNlbGxzWzBdLmNlbGxTcGFuID0gc3BhbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5jZWxsc1swXS5zcGFuVGV4dCA9IG1lcmdlWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJvd3M7XG4gICAgfTtcbiAgICBDZWxsTWVyZ2VSZW5kZXIucHJvdG90eXBlLmdldEluZGV4RnJvbUFsbENvbHVtbnMgPSBmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gaXRlcmF0ZUFycmF5T3JPYmplY3QodGhpcy5wYXJlbnQuZ2V0VmlzaWJsZUNvbHVtbnMoKSwgZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5maWVsZCA9PT0gZmllbGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9KVswXTtcbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH07XG4gICAgcmV0dXJuIENlbGxNZXJnZVJlbmRlcjtcbn0oKSk7XG5leHBvcnQgeyBDZWxsTWVyZ2VSZW5kZXIgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-merge-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js ***!
  \********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CellRenderer: () => (/* binding */ CellRenderer)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-buttons */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-buttons@29.1.34/node_modules/@syncfusion/ej2-buttons/src/common/common.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n\n/**\n * CellRenderer class which responsible for building cell content.\n *\n * @hidden\n */\nvar CellRenderer = /** @class */ (function () {\n    function CellRenderer(parent, locator) {\n        this.localizer = locator.getService('localization');\n        this.formatter = locator.getService('valueFormatter');\n        this.parent = parent;\n        this.element = this.parent.createElement('TD', { className: _base_string_literals__WEBPACK_IMPORTED_MODULE_1__.rowCell, attrs: { role: 'gridcell', tabindex: '-1' } });\n        this.rowChkBox = this.parent.createElement('input', { className: 'e-checkselect', attrs: { 'type': 'checkbox', 'aria-label': this.localizer.getConstant('SelectRow') } });\n    }\n    /**\n     * Function to return the wrapper for the TD content\n     *\n     * @returns {string | Element} returns the string\n     */\n    CellRenderer.prototype.getGui = function () {\n        return '';\n    };\n    /**\n     * Function to format the cell value.\n     *\n     * @param  {Column} column - specifies the column\n     * @param  {Object} value - specifies the value\n     * @param  {Object} data - specifies the data\n     * @returns {string} returns the format\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    CellRenderer.prototype.format = function (column, value, data) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.format)) {\n            if (column.type === 'number' && isNaN(parseInt(value, 10))) {\n                value = null;\n            }\n            if (column.type === 'dateonly' && typeof value === 'string' && value) {\n                var arr = value.split(/[^0-9.]/);\n                value = new Date(parseInt(arr[0], 10), parseInt(arr[1], 10) - 1, parseInt(arr[2], 10));\n            }\n            value = this.formatter.toView(value, column.getFormatter());\n        }\n        return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value) ? '' : value.toString();\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    CellRenderer.prototype.evaluate = function (node, cell, data, attributes, fData, isEdit) {\n        var _a;\n        var result;\n        if (cell.column.template) {\n            var isReactCompiler = this.parent.isReact && typeof (cell.column.template) !== 'string' && !(cell.column.template.prototype && cell.column.template.prototype.CSPTemplate);\n            var isReactChild = this.parent.parentDetails && this.parent.parentDetails.parentInstObj &&\n                this.parent.parentDetails.parentInstObj.isReact;\n            var isReactPrintGrid = this.parent.printGridParent && this.parent.printGridParent.isReact;\n            var literals_1 = ['index'];\n            var dummyData = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.extendObjWithFn)({}, data, (_a = {}, _a[_base_constant__WEBPACK_IMPORTED_MODULE_3__.foreignKeyData] = fData, _a.column = cell.column, _a));\n            var templateID = this.parent.element.id + cell.column.uid;\n            var str = 'isStringTemplate';\n            if (isReactCompiler || isReactChild || isReactPrintGrid) {\n                var copied = { 'index': attributes[literals_1[0]] };\n                cell.column.getColumnTemplate()((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(copied, dummyData), this.parent, 'columnTemplate', templateID, this.parent[\"\" + str], null, node);\n            }\n            else {\n                result = cell.column.getColumnTemplate()((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({ 'index': attributes[literals_1[0]] }, dummyData), this.parent, 'template', templateID, this.parent[\"\" + str], undefined, undefined, this.parent['root']);\n            }\n            if (!isReactCompiler && !isReactChild && !isReactPrintGrid) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.appendChildren)(node, result);\n            }\n            this.parent.notify('template-result', { template: result });\n            result = null;\n            if (cell.column.templateOptions.enableAriaLabel) {\n                node.setAttribute('aria-label', node.innerText + this.localizer.getConstant('TemplateCell') +\n                    this.localizer.getConstant('ColumnHeader') + cell.column.headerText);\n            }\n            return false;\n        }\n        return true;\n    };\n    /**\n     * Function to invoke the custom formatter available in the column object.\n     *\n     * @param  {Column} column - specifies the column\n     * @param  {Object} value - specifies the value\n     * @param  {Object} data - specifies the data\n     * @returns {Object} returns the object\n     */\n    CellRenderer.prototype.invokeFormatter = function (column, value, data) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.formatter)) {\n            if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.doesImplementInterface)(column.formatter, 'getValue')) {\n                var formatter = column.formatter;\n                value = new formatter().getValue(column, data);\n            }\n            else if (typeof column.formatter === 'function') {\n                value = column.formatter(column, data);\n            }\n            else {\n                value = column.formatter.getValue(column, data);\n            }\n        }\n        return value;\n    };\n    /**\n     * Function to render the cell content based on Column object.\n     *\n     * @param {Cell<Column>} cell - specifies the cell\n     * @param {Object} data - specifies the data\n     * @param {Object} attributes - specifies the attributes\n     * @param {boolean} isExpand - specifies the boolean for expand\n     * @param {boolean} isEdit - specifies the boolean for edit\n     * @returns {Element} returns the element\n     */\n    CellRenderer.prototype.render = function (cell, data, attributes, isExpand, isEdit) {\n        return this.refreshCell(cell, data, attributes, isEdit);\n    };\n    /**\n     * Function to refresh the cell content based on Column object.\n     *\n     * @param {Element} td - specifies the element\n     * @param {Cell<Column>} cell - specifies the cell\n     * @param {Object} data - specifies the data\n     * @param {Object} attributes - specifies the attribute\n     * @returns {void}\n     */\n    CellRenderer.prototype.refreshTD = function (td, cell, data, attributes) {\n        var isEdit = this.parent.editSettings.mode === 'Batch' && td.classList.contains('e-editedbatchcell');\n        if (this.parent.isReact) {\n            var cellIndex = td.cellIndex;\n            var parentRow = td.parentElement;\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(td);\n            var newTD = this.refreshCell(cell, data, attributes, isEdit);\n            this.cloneAttributes(newTD, td);\n            if (parentRow.cells.length !== cellIndex - 1) {\n                parentRow.insertBefore(newTD, parentRow.cells[parseInt(cellIndex.toString(), 10)]);\n            }\n            else {\n                parentRow.appendChild(newTD);\n            }\n        }\n        else {\n            var node = this.refreshCell(cell, data, attributes, isEdit);\n            td.innerHTML = '';\n            var arialabelText = node.getAttribute('aria-label');\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            arialabelText ? td.setAttribute('aria-label', arialabelText) : null;\n            var elements = [].slice.call(node.childNodes);\n            for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n                var elem = elements_1[_i];\n                td.appendChild(elem);\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    CellRenderer.prototype.cloneAttributes = function (target, source) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var attrs = source.attributes;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var i = attrs.length;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var attr;\n        while (i--) {\n            attr = attrs[parseInt(i.toString(), 10)];\n            target.setAttribute(attr.name, attr.value);\n        }\n    };\n    CellRenderer.prototype.refreshCell = function (cell, data, attributes, isEdit) {\n        var _a;\n        var node = this.element.cloneNode();\n        var column = cell.column;\n        var fData;\n        if (cell.isForeignKey) {\n            fData = cell.foreignKeyData[0] || (_a = {}, _a[column.foreignKeyValue] = column.format ? null : '', _a);\n        }\n        //Prepare innerHtml\n        var innerHtml = this.getGui();\n        var value = cell.isForeignKey ? this.getValue(column.foreignKeyValue, fData, column) :\n            this.getValue(column.field, data, column);\n        if ((column.type === 'date' || column.type === 'datetime') && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value)) {\n            value = new Date(value);\n        }\n        if (column.type === 'dateonly' && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value) && typeof value === 'string') {\n            var arr = value.split(/[^0-9.]/);\n            value = new Date(parseInt(arr[0], 10), parseInt(arr[1], 10) - 1, parseInt(arr[2], 10));\n        }\n        value = this.format(column, value, data);\n        innerHtml = value.toString();\n        if (column.type === 'boolean' && !column.displayAsCheckBox) {\n            var localeStr = (value !== 'true' && value !== 'false') ? null : value === 'true' ? 'True' : 'False';\n            innerHtml = localeStr ? this.localizer.getConstant(localeStr) : innerHtml;\n        }\n        var fromFormatter = this.invokeFormatter(column, value, data);\n        innerHtml = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.formatter) ? (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(fromFormatter) ? '' : fromFormatter.toString() : innerHtml;\n        if (this.evaluate(node, cell, data, attributes, fData, isEdit) && column.type !== 'checkbox') {\n            this.appendHtml(node, this.parent.sanitize(innerHtml), column.getDomSetter ? column.getDomSetter() : 'innerHTML');\n        }\n        else if (column.type === 'checkbox') {\n            node.classList.add(_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.gridChkBox);\n            if (this.parent.selectionSettings.persistSelection) {\n                value = value === 'true';\n            }\n            else {\n                value = false;\n            }\n            var checkWrap = (0,_syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_4__.createCheckBox)(this.parent.createElement, false, { checked: value, label: ' ' });\n            if (this.parent.cssClass) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([checkWrap], [this.parent.cssClass]);\n            }\n            this.rowChkBox.id = 'checkbox-' + cell.rowID;\n            checkWrap.insertBefore(this.rowChkBox.cloneNode(), checkWrap.firstChild);\n            node.appendChild(checkWrap);\n        }\n        if (this.parent.checkAllRows === 'Check' && this.parent.enableVirtualization) {\n            cell.isSelected = true;\n        }\n        this.setAttributes(node, cell, attributes);\n        if (column.type === 'boolean' && column.displayAsCheckBox) {\n            var checked = isNaN(parseInt(value.toString(), 10)) ? value === 'true' : parseInt(value.toString(), 10) > 0;\n            var checkWrap = (0,_syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_4__.createCheckBox)(this.parent.createElement, false, { checked: checked, label: ' ' });\n            node.innerHTML = '';\n            node.classList.add('e-gridchkbox-cell');\n            checkWrap.classList.add('e-checkbox-disabled');\n            if (this.parent.cssClass) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([checkWrap], [this.parent.cssClass]);\n            }\n            node.appendChild(checkWrap);\n        }\n        if (node.classList.contains('e-summarycell') && !data.key) {\n            var uid = node.getAttribute('e-mappinguid');\n            column = this.parent.getColumnByUid(uid);\n            node.setAttribute('aria-label', innerHtml + this.localizer.getConstant('ColumnHeader') + cell.column.headerText);\n        }\n        if (this.parent.isFrozenGrid() && (!data || (data && !data.key))) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addStickyColumnPosition)(this.parent, column, node);\n        }\n        return node;\n    };\n    /**\n     * Function to specifies how the result content to be placed in the cell.\n     *\n     * @param {Element} node - specifies the node\n     * @param {string|Element} innerHtml - specifies the innerHTML\n     * @param {string} property - specifies the element\n     * @returns {Element} returns the element\n     */\n    CellRenderer.prototype.appendHtml = function (node, innerHtml, property) {\n        if (property === void 0) { property = 'innerHTML'; }\n        node[\"\" + property] = innerHtml;\n        return node;\n    };\n    /**\n     * @param {HTMLElement} node - specifies the node\n     * @param {cell<Column>} cell - specifies the cell\n     * @param {Object} attributes - specifies the attributes\n     * @returns {void}\n     * @hidden\n     */\n    CellRenderer.prototype.setAttributes = function (node, cell, attributes) {\n        var column = cell.column;\n        this.buildAttributeFromCell(node, cell, column.type === 'checkbox');\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.setStyleAndAttributes)(node, attributes);\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.setStyleAndAttributes)(node, cell.attributes);\n        if (column.customAttributes) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.setStyleAndAttributes)(node, column.customAttributes);\n        }\n        if (this.parent.rowRenderingMode === 'Vertical') {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.setStyleAndAttributes)(node, { 'data-cell': column.headerText });\n        }\n        if (column.textAlign) {\n            var alignmentClassMap = { right: 'e-rightalign', left: 'e-leftalign', center: 'e-centeralign', justify: 'e-justifyalign' };\n            if (alignmentClassMap[column.textAlign.toLowerCase()]) {\n                node.classList.add(alignmentClassMap[column.textAlign.toLowerCase()]);\n            }\n        }\n        if (column.clipMode === 'Clip' || (!column.clipMode && this.parent.clipMode === 'Clip')) {\n            node.classList.add('e-gridclip');\n        }\n        else if (column.clipMode === 'EllipsisWithTooltip' || (!column.clipMode && this.parent.clipMode === 'EllipsisWithTooltip')\n            && !(this.parent.allowTextWrap && (this.parent.textWrapSettings.wrapMode === 'Content'\n                || this.parent.textWrapSettings.wrapMode === 'Both'))) {\n            if (column.type !== 'checkbox') {\n                node.classList.add('e-ellipsistooltip');\n            }\n        }\n    };\n    CellRenderer.prototype.buildAttributeFromCell = function (node, cell, isCheckBoxType) {\n        var attr = {};\n        var classes = [];\n        if (cell.colSpan) {\n            attr.colSpan = cell.colSpan;\n        }\n        if (cell.rowSpan) {\n            attr.rowSpan = cell.rowSpan;\n        }\n        if (cell.isTemplate) {\n            classes.push('e-templatecell');\n        }\n        if (cell.isSelected) {\n            classes.push.apply(classes, ['e-selectionbackground', 'e-active']);\n            if (isCheckBoxType) {\n                node.querySelector('.e-frame').classList.add('e-check');\n            }\n        }\n        if (cell.isColumnSelected) {\n            classes.push.apply(classes, ['e-columnselection']);\n        }\n        if (cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_5__.CellType.Header) {\n            attr[_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex] = cell.colIndex + 1;\n        }\n        else if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell.index)) {\n            attr[_base_string_literals__WEBPACK_IMPORTED_MODULE_1__.ariaColIndex] = cell.index + 1;\n        }\n        if (!cell.visible) {\n            classes.push('e-hide');\n        }\n        attr.class = classes;\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.setStyleAndAttributes)(node, attr);\n    };\n    CellRenderer.prototype.getValue = function (field, data, column) {\n        return column.valueAccessor(field, data, column);\n    };\n    return CellRenderer;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9jZWxsLXJlbmRlcmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBd0Q7QUFDUztBQUNzRTtBQUM5RTtBQUNQO0FBQ1Y7QUFDWTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxXQUFXLDBEQUFnQixXQUFXLG9DQUFvQztBQUNuSSw4REFBOEQscUNBQXFDLDZFQUE2RTtBQUNoTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixrQkFBa0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUTtBQUN4QixnQkFBZ0IsUUFBUTtBQUN4QixnQkFBZ0IsUUFBUTtBQUN4QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxhQUFhLHVFQUFpQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLHVFQUFpQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDJEQUFlLEdBQUcsZ0JBQWdCLEtBQUssMERBQWM7QUFDakY7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CLGdEQUFnRCw0REFBTTtBQUN0RDtBQUNBO0FBQ0EseURBQXlELDREQUFNLEdBQUcsb0NBQW9DO0FBQ3RHO0FBQ0E7QUFDQSxnQkFBZ0IsMERBQWM7QUFDOUI7QUFDQSxvREFBb0Qsa0JBQWtCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixRQUFRO0FBQ3hCLGdCQUFnQixRQUFRO0FBQ3hCLGdCQUFnQixRQUFRO0FBQ3hCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQSxhQUFhLHVFQUFpQjtBQUM5QixnQkFBZ0Isa0VBQXNCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsY0FBYztBQUM3QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsU0FBUztBQUN4QixlQUFlLFNBQVM7QUFDeEIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEIsZUFBZSxjQUFjO0FBQzdCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksNERBQU07QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Qsd0JBQXdCO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLHVFQUFpQjtBQUN4RjtBQUNBO0FBQ0EsMkNBQTJDLHVFQUFpQjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix1RUFBaUIscUJBQXFCLHVFQUFpQjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw2REFBbUI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHVFQUFjLHFDQUFxQyw0QkFBNEI7QUFDM0c7QUFDQSxnQkFBZ0IsOERBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix1RUFBYyxxQ0FBcUMsOEJBQThCO0FBQzdHO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDhEQUFRO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksbUVBQXVCO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixlQUFlLGdCQUFnQjtBQUMvQixlQUFlLFFBQVE7QUFDdkIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsYUFBYTtBQUM1QixlQUFlLGNBQWM7QUFDN0IsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBcUI7QUFDN0IsUUFBUSxpRUFBcUI7QUFDN0I7QUFDQSxZQUFZLGlFQUFxQjtBQUNqQztBQUNBO0FBQ0EsWUFBWSxpRUFBcUIsU0FBUyxnQ0FBZ0M7QUFDMUU7QUFDQTtBQUNBLHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsZ0RBQVE7QUFDdEMsaUJBQWlCLCtEQUFxQjtBQUN0QztBQUNBLGtCQUFrQix1RUFBaUI7QUFDbkMsaUJBQWlCLCtEQUFxQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDdUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9jZWxsLXJlbmRlcmVyLmpzP2JiZjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVtb3ZlLCBhZGRDbGFzcyB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IGlzTnVsbE9yVW5kZWZpbmVkLCBleHRlbmQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBkb2VzSW1wbGVtZW50SW50ZXJmYWNlLCBzZXRTdHlsZUFuZEF0dHJpYnV0ZXMsIGFwcGVuZENoaWxkcmVuLCBleHRlbmRPYmpXaXRoRm4sIGFkZFN0aWNreUNvbHVtblBvc2l0aW9uIH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbmltcG9ydCB7IGNyZWF0ZUNoZWNrQm94IH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJ1dHRvbnMnO1xuaW1wb3J0IHsgZm9yZWlnbktleURhdGEgfSBmcm9tICcuLi9iYXNlL2NvbnN0YW50JztcbmltcG9ydCB7IENlbGxUeXBlIH0gZnJvbSAnLi4vYmFzZS9lbnVtJztcbmltcG9ydCAqIGFzIGxpdGVyYWxzIGZyb20gJy4uL2Jhc2Uvc3RyaW5nLWxpdGVyYWxzJztcbi8qKlxuICogQ2VsbFJlbmRlcmVyIGNsYXNzIHdoaWNoIHJlc3BvbnNpYmxlIGZvciBidWlsZGluZyBjZWxsIGNvbnRlbnQuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgQ2VsbFJlbmRlcmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENlbGxSZW5kZXJlcihwYXJlbnQsIGxvY2F0b3IpIHtcbiAgICAgICAgdGhpcy5sb2NhbGl6ZXIgPSBsb2NhdG9yLmdldFNlcnZpY2UoJ2xvY2FsaXphdGlvbicpO1xuICAgICAgICB0aGlzLmZvcm1hdHRlciA9IGxvY2F0b3IuZ2V0U2VydmljZSgndmFsdWVGb3JtYXR0ZXInKTtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ1REJywgeyBjbGFzc05hbWU6IGxpdGVyYWxzLnJvd0NlbGwsIGF0dHJzOiB7IHJvbGU6ICdncmlkY2VsbCcsIHRhYmluZGV4OiAnLTEnIH0gfSk7XG4gICAgICAgIHRoaXMucm93Q2hrQm94ID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7IGNsYXNzTmFtZTogJ2UtY2hlY2tzZWxlY3QnLCBhdHRyczogeyAndHlwZSc6ICdjaGVja2JveCcsICdhcmlhLWxhYmVsJzogdGhpcy5sb2NhbGl6ZXIuZ2V0Q29uc3RhbnQoJ1NlbGVjdFJvdycpIH0gfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIHJldHVybiB0aGUgd3JhcHBlciBmb3IgdGhlIFREIGNvbnRlbnRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmcgfCBFbGVtZW50fSByZXR1cm5zIHRoZSBzdHJpbmdcbiAgICAgKi9cbiAgICBDZWxsUmVuZGVyZXIucHJvdG90eXBlLmdldEd1aSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdG8gZm9ybWF0IHRoZSBjZWxsIHZhbHVlLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7Q29sdW1ufSBjb2x1bW4gLSBzcGVjaWZpZXMgdGhlIGNvbHVtblxuICAgICAqIEBwYXJhbSAge09iamVjdH0gdmFsdWUgLSBzcGVjaWZpZXMgdGhlIHZhbHVlXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBkYXRhIC0gc3BlY2lmaWVzIHRoZSBkYXRhXG4gICAgICogQHJldHVybnMge3N0cmluZ30gcmV0dXJucyB0aGUgZm9ybWF0XG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIENlbGxSZW5kZXJlci5wcm90b3R5cGUuZm9ybWF0ID0gZnVuY3Rpb24gKGNvbHVtbiwgdmFsdWUsIGRhdGEpIHtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjb2x1bW4uZm9ybWF0KSkge1xuICAgICAgICAgICAgaWYgKGNvbHVtbi50eXBlID09PSAnbnVtYmVyJyAmJiBpc05hTihwYXJzZUludCh2YWx1ZSwgMTApKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb2x1bW4udHlwZSA9PT0gJ2RhdGVvbmx5JyAmJiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bXjAtOS5dLyk7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBuZXcgRGF0ZShwYXJzZUludChhcnJbMF0sIDEwKSwgcGFyc2VJbnQoYXJyWzFdLCAxMCkgLSAxLCBwYXJzZUludChhcnJbMl0sIDEwKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YWx1ZSA9IHRoaXMuZm9ybWF0dGVyLnRvVmlldyh2YWx1ZSwgY29sdW1uLmdldEZvcm1hdHRlcigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpID8gJycgOiB2YWx1ZS50b1N0cmluZygpO1xuICAgIH07XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIENlbGxSZW5kZXJlci5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbiAobm9kZSwgY2VsbCwgZGF0YSwgYXR0cmlidXRlcywgZkRhdGEsIGlzRWRpdCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGlmIChjZWxsLmNvbHVtbi50ZW1wbGF0ZSkge1xuICAgICAgICAgICAgdmFyIGlzUmVhY3RDb21waWxlciA9IHRoaXMucGFyZW50LmlzUmVhY3QgJiYgdHlwZW9mIChjZWxsLmNvbHVtbi50ZW1wbGF0ZSkgIT09ICdzdHJpbmcnICYmICEoY2VsbC5jb2x1bW4udGVtcGxhdGUucHJvdG90eXBlICYmIGNlbGwuY29sdW1uLnRlbXBsYXRlLnByb3RvdHlwZS5DU1BUZW1wbGF0ZSk7XG4gICAgICAgICAgICB2YXIgaXNSZWFjdENoaWxkID0gdGhpcy5wYXJlbnQucGFyZW50RGV0YWlscyAmJiB0aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmogJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmouaXNSZWFjdDtcbiAgICAgICAgICAgIHZhciBpc1JlYWN0UHJpbnRHcmlkID0gdGhpcy5wYXJlbnQucHJpbnRHcmlkUGFyZW50ICYmIHRoaXMucGFyZW50LnByaW50R3JpZFBhcmVudC5pc1JlYWN0O1xuICAgICAgICAgICAgdmFyIGxpdGVyYWxzXzEgPSBbJ2luZGV4J107XG4gICAgICAgICAgICB2YXIgZHVtbXlEYXRhID0gZXh0ZW5kT2JqV2l0aEZuKHt9LCBkYXRhLCAoX2EgPSB7fSwgX2FbZm9yZWlnbktleURhdGFdID0gZkRhdGEsIF9hLmNvbHVtbiA9IGNlbGwuY29sdW1uLCBfYSkpO1xuICAgICAgICAgICAgdmFyIHRlbXBsYXRlSUQgPSB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgY2VsbC5jb2x1bW4udWlkO1xuICAgICAgICAgICAgdmFyIHN0ciA9ICdpc1N0cmluZ1RlbXBsYXRlJztcbiAgICAgICAgICAgIGlmIChpc1JlYWN0Q29tcGlsZXIgfHwgaXNSZWFjdENoaWxkIHx8IGlzUmVhY3RQcmludEdyaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29waWVkID0geyAnaW5kZXgnOiBhdHRyaWJ1dGVzW2xpdGVyYWxzXzFbMF1dIH07XG4gICAgICAgICAgICAgICAgY2VsbC5jb2x1bW4uZ2V0Q29sdW1uVGVtcGxhdGUoKShleHRlbmQoY29waWVkLCBkdW1teURhdGEpLCB0aGlzLnBhcmVudCwgJ2NvbHVtblRlbXBsYXRlJywgdGVtcGxhdGVJRCwgdGhpcy5wYXJlbnRbXCJcIiArIHN0cl0sIG51bGwsIG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gY2VsbC5jb2x1bW4uZ2V0Q29sdW1uVGVtcGxhdGUoKShleHRlbmQoeyAnaW5kZXgnOiBhdHRyaWJ1dGVzW2xpdGVyYWxzXzFbMF1dIH0sIGR1bW15RGF0YSksIHRoaXMucGFyZW50LCAndGVtcGxhdGUnLCB0ZW1wbGF0ZUlELCB0aGlzLnBhcmVudFtcIlwiICsgc3RyXSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRoaXMucGFyZW50Wydyb290J10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc1JlYWN0Q29tcGlsZXIgJiYgIWlzUmVhY3RDaGlsZCAmJiAhaXNSZWFjdFByaW50R3JpZCkge1xuICAgICAgICAgICAgICAgIGFwcGVuZENoaWxkcmVuKG5vZGUsIHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoJ3RlbXBsYXRlLXJlc3VsdCcsIHsgdGVtcGxhdGU6IHJlc3VsdCB9KTtcbiAgICAgICAgICAgIHJlc3VsdCA9IG51bGw7XG4gICAgICAgICAgICBpZiAoY2VsbC5jb2x1bW4udGVtcGxhdGVPcHRpb25zLmVuYWJsZUFyaWFMYWJlbCkge1xuICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgbm9kZS5pbm5lclRleHQgKyB0aGlzLmxvY2FsaXplci5nZXRDb25zdGFudCgnVGVtcGxhdGVDZWxsJykgK1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvY2FsaXplci5nZXRDb25zdGFudCgnQ29sdW1uSGVhZGVyJykgKyBjZWxsLmNvbHVtbi5oZWFkZXJUZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIGludm9rZSB0aGUgY3VzdG9tIGZvcm1hdHRlciBhdmFpbGFibGUgaW4gdGhlIGNvbHVtbiBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtDb2x1bW59IGNvbHVtbiAtIHNwZWNpZmllcyB0aGUgY29sdW1uXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSB2YWx1ZSAtIHNwZWNpZmllcyB0aGUgdmFsdWVcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGRhdGEgLSBzcGVjaWZpZXMgdGhlIGRhdGFcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSByZXR1cm5zIHRoZSBvYmplY3RcbiAgICAgKi9cbiAgICBDZWxsUmVuZGVyZXIucHJvdG90eXBlLmludm9rZUZvcm1hdHRlciA9IGZ1bmN0aW9uIChjb2x1bW4sIHZhbHVlLCBkYXRhKSB7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLmZvcm1hdHRlcikpIHtcbiAgICAgICAgICAgIGlmIChkb2VzSW1wbGVtZW50SW50ZXJmYWNlKGNvbHVtbi5mb3JtYXR0ZXIsICdnZXRWYWx1ZScpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvcm1hdHRlciA9IGNvbHVtbi5mb3JtYXR0ZXI7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBuZXcgZm9ybWF0dGVyKCkuZ2V0VmFsdWUoY29sdW1uLCBkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBjb2x1bW4uZm9ybWF0dGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBjb2x1bW4uZm9ybWF0dGVyKGNvbHVtbiwgZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGNvbHVtbi5mb3JtYXR0ZXIuZ2V0VmFsdWUoY29sdW1uLCBkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byByZW5kZXIgdGhlIGNlbGwgY29udGVudCBiYXNlZCBvbiBDb2x1bW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtDZWxsPENvbHVtbj59IGNlbGwgLSBzcGVjaWZpZXMgdGhlIGNlbGxcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIHNwZWNpZmllcyB0aGUgZGF0YVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhdHRyaWJ1dGVzIC0gc3BlY2lmaWVzIHRoZSBhdHRyaWJ1dGVzXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0V4cGFuZCAtIHNwZWNpZmllcyB0aGUgYm9vbGVhbiBmb3IgZXhwYW5kXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0VkaXQgLSBzcGVjaWZpZXMgdGhlIGJvb2xlYW4gZm9yIGVkaXRcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIENlbGxSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKGNlbGwsIGRhdGEsIGF0dHJpYnV0ZXMsIGlzRXhwYW5kLCBpc0VkaXQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVmcmVzaENlbGwoY2VsbCwgZGF0YSwgYXR0cmlidXRlcywgaXNFZGl0KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIHJlZnJlc2ggdGhlIGNlbGwgY29udGVudCBiYXNlZCBvbiBDb2x1bW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSB0ZCAtIHNwZWNpZmllcyB0aGUgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7Q2VsbDxDb2x1bW4+fSBjZWxsIC0gc3BlY2lmaWVzIHRoZSBjZWxsXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgLSBzcGVjaWZpZXMgdGhlIGRhdGFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gYXR0cmlidXRlcyAtIHNwZWNpZmllcyB0aGUgYXR0cmlidXRlXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgQ2VsbFJlbmRlcmVyLnByb3RvdHlwZS5yZWZyZXNoVEQgPSBmdW5jdGlvbiAodGQsIGNlbGwsIGRhdGEsIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgdmFyIGlzRWRpdCA9IHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5tb2RlID09PSAnQmF0Y2gnICYmIHRkLmNsYXNzTGlzdC5jb250YWlucygnZS1lZGl0ZWRiYXRjaGNlbGwnKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzUmVhY3QpIHtcbiAgICAgICAgICAgIHZhciBjZWxsSW5kZXggPSB0ZC5jZWxsSW5kZXg7XG4gICAgICAgICAgICB2YXIgcGFyZW50Um93ID0gdGQucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgIHJlbW92ZSh0ZCk7XG4gICAgICAgICAgICB2YXIgbmV3VEQgPSB0aGlzLnJlZnJlc2hDZWxsKGNlbGwsIGRhdGEsIGF0dHJpYnV0ZXMsIGlzRWRpdCk7XG4gICAgICAgICAgICB0aGlzLmNsb25lQXR0cmlidXRlcyhuZXdURCwgdGQpO1xuICAgICAgICAgICAgaWYgKHBhcmVudFJvdy5jZWxscy5sZW5ndGggIT09IGNlbGxJbmRleCAtIDEpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRSb3cuaW5zZXJ0QmVmb3JlKG5ld1RELCBwYXJlbnRSb3cuY2VsbHNbcGFyc2VJbnQoY2VsbEluZGV4LnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyZW50Um93LmFwcGVuZENoaWxkKG5ld1REKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5yZWZyZXNoQ2VsbChjZWxsLCBkYXRhLCBhdHRyaWJ1dGVzLCBpc0VkaXQpO1xuICAgICAgICAgICAgdGQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICB2YXIgYXJpYWxhYmVsVGV4dCA9IG5vZGUuZ2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJyk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC1leHByZXNzaW9uc1xuICAgICAgICAgICAgYXJpYWxhYmVsVGV4dCA/IHRkLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGFyaWFsYWJlbFRleHQpIDogbnVsbDtcbiAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IFtdLnNsaWNlLmNhbGwobm9kZS5jaGlsZE5vZGVzKTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgZWxlbWVudHNfMSA9IGVsZW1lbnRzOyBfaSA8IGVsZW1lbnRzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW0gPSBlbGVtZW50c18xW19pXTtcbiAgICAgICAgICAgICAgICB0ZC5hcHBlbmRDaGlsZChlbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBDZWxsUmVuZGVyZXIucHJvdG90eXBlLmNsb25lQXR0cmlidXRlcyA9IGZ1bmN0aW9uICh0YXJnZXQsIHNvdXJjZSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICB2YXIgYXR0cnMgPSBzb3VyY2UuYXR0cmlidXRlcztcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgdmFyIGkgPSBhdHRycy5sZW5ndGg7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHZhciBhdHRyO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICBhdHRyID0gYXR0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZShhdHRyLm5hbWUsIGF0dHIudmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDZWxsUmVuZGVyZXIucHJvdG90eXBlLnJlZnJlc2hDZWxsID0gZnVuY3Rpb24gKGNlbGwsIGRhdGEsIGF0dHJpYnV0ZXMsIGlzRWRpdCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5lbGVtZW50LmNsb25lTm9kZSgpO1xuICAgICAgICB2YXIgY29sdW1uID0gY2VsbC5jb2x1bW47XG4gICAgICAgIHZhciBmRGF0YTtcbiAgICAgICAgaWYgKGNlbGwuaXNGb3JlaWduS2V5KSB7XG4gICAgICAgICAgICBmRGF0YSA9IGNlbGwuZm9yZWlnbktleURhdGFbMF0gfHwgKF9hID0ge30sIF9hW2NvbHVtbi5mb3JlaWduS2V5VmFsdWVdID0gY29sdW1uLmZvcm1hdCA/IG51bGwgOiAnJywgX2EpO1xuICAgICAgICB9XG4gICAgICAgIC8vUHJlcGFyZSBpbm5lckh0bWxcbiAgICAgICAgdmFyIGlubmVySHRtbCA9IHRoaXMuZ2V0R3VpKCk7XG4gICAgICAgIHZhciB2YWx1ZSA9IGNlbGwuaXNGb3JlaWduS2V5ID8gdGhpcy5nZXRWYWx1ZShjb2x1bW4uZm9yZWlnbktleVZhbHVlLCBmRGF0YSwgY29sdW1uKSA6XG4gICAgICAgICAgICB0aGlzLmdldFZhbHVlKGNvbHVtbi5maWVsZCwgZGF0YSwgY29sdW1uKTtcbiAgICAgICAgaWYgKChjb2x1bW4udHlwZSA9PT0gJ2RhdGUnIHx8IGNvbHVtbi50eXBlID09PSAnZGF0ZXRpbWUnKSAmJiAhaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IG5ldyBEYXRlKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29sdW1uLnR5cGUgPT09ICdkYXRlb25seScgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSAmJiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB2YXIgYXJyID0gdmFsdWUuc3BsaXQoL1teMC05Ll0vKTtcbiAgICAgICAgICAgIHZhbHVlID0gbmV3IERhdGUocGFyc2VJbnQoYXJyWzBdLCAxMCksIHBhcnNlSW50KGFyclsxXSwgMTApIC0gMSwgcGFyc2VJbnQoYXJyWzJdLCAxMCkpO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlID0gdGhpcy5mb3JtYXQoY29sdW1uLCB2YWx1ZSwgZGF0YSk7XG4gICAgICAgIGlubmVySHRtbCA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChjb2x1bW4udHlwZSA9PT0gJ2Jvb2xlYW4nICYmICFjb2x1bW4uZGlzcGxheUFzQ2hlY2tCb3gpIHtcbiAgICAgICAgICAgIHZhciBsb2NhbGVTdHIgPSAodmFsdWUgIT09ICd0cnVlJyAmJiB2YWx1ZSAhPT0gJ2ZhbHNlJykgPyBudWxsIDogdmFsdWUgPT09ICd0cnVlJyA/ICdUcnVlJyA6ICdGYWxzZSc7XG4gICAgICAgICAgICBpbm5lckh0bWwgPSBsb2NhbGVTdHIgPyB0aGlzLmxvY2FsaXplci5nZXRDb25zdGFudChsb2NhbGVTdHIpIDogaW5uZXJIdG1sO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmcm9tRm9ybWF0dGVyID0gdGhpcy5pbnZva2VGb3JtYXR0ZXIoY29sdW1uLCB2YWx1ZSwgZGF0YSk7XG4gICAgICAgIGlubmVySHRtbCA9ICFpc051bGxPclVuZGVmaW5lZChjb2x1bW4uZm9ybWF0dGVyKSA/IGlzTnVsbE9yVW5kZWZpbmVkKGZyb21Gb3JtYXR0ZXIpID8gJycgOiBmcm9tRm9ybWF0dGVyLnRvU3RyaW5nKCkgOiBpbm5lckh0bWw7XG4gICAgICAgIGlmICh0aGlzLmV2YWx1YXRlKG5vZGUsIGNlbGwsIGRhdGEsIGF0dHJpYnV0ZXMsIGZEYXRhLCBpc0VkaXQpICYmIGNvbHVtbi50eXBlICE9PSAnY2hlY2tib3gnKSB7XG4gICAgICAgICAgICB0aGlzLmFwcGVuZEh0bWwobm9kZSwgdGhpcy5wYXJlbnQuc2FuaXRpemUoaW5uZXJIdG1sKSwgY29sdW1uLmdldERvbVNldHRlciA/IGNvbHVtbi5nZXREb21TZXR0ZXIoKSA6ICdpbm5lckhUTUwnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2x1bW4udHlwZSA9PT0gJ2NoZWNrYm94Jykge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKGxpdGVyYWxzLmdyaWRDaGtCb3gpO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlID09PSAndHJ1ZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNoZWNrV3JhcCA9IGNyZWF0ZUNoZWNrQm94KHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQsIGZhbHNlLCB7IGNoZWNrZWQ6IHZhbHVlLCBsYWJlbDogJyAnIH0pO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNzc0NsYXNzKSB7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoW2NoZWNrV3JhcF0sIFt0aGlzLnBhcmVudC5jc3NDbGFzc10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yb3dDaGtCb3guaWQgPSAnY2hlY2tib3gtJyArIGNlbGwucm93SUQ7XG4gICAgICAgICAgICBjaGVja1dyYXAuaW5zZXJ0QmVmb3JlKHRoaXMucm93Q2hrQm94LmNsb25lTm9kZSgpLCBjaGVja1dyYXAuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKGNoZWNrV3JhcCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9PT0gJ0NoZWNrJyAmJiB0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbikge1xuICAgICAgICAgICAgY2VsbC5pc1NlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZXMobm9kZSwgY2VsbCwgYXR0cmlidXRlcyk7XG4gICAgICAgIGlmIChjb2x1bW4udHlwZSA9PT0gJ2Jvb2xlYW4nICYmIGNvbHVtbi5kaXNwbGF5QXNDaGVja0JveCkge1xuICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSBpc05hTihwYXJzZUludCh2YWx1ZS50b1N0cmluZygpLCAxMCkpID8gdmFsdWUgPT09ICd0cnVlJyA6IHBhcnNlSW50KHZhbHVlLnRvU3RyaW5nKCksIDEwKSA+IDA7XG4gICAgICAgICAgICB2YXIgY2hlY2tXcmFwID0gY3JlYXRlQ2hlY2tCb3godGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCwgZmFsc2UsIHsgY2hlY2tlZDogY2hlY2tlZCwgbGFiZWw6ICcgJyB9KTtcbiAgICAgICAgICAgIG5vZGUuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ2UtZ3JpZGNoa2JveC1jZWxsJyk7XG4gICAgICAgICAgICBjaGVja1dyYXAuY2xhc3NMaXN0LmFkZCgnZS1jaGVja2JveC1kaXNhYmxlZCcpO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNzc0NsYXNzKSB7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoW2NoZWNrV3JhcF0sIFt0aGlzLnBhcmVudC5jc3NDbGFzc10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChjaGVja1dyYXApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlLmNsYXNzTGlzdC5jb250YWlucygnZS1zdW1tYXJ5Y2VsbCcpICYmICFkYXRhLmtleSkge1xuICAgICAgICAgICAgdmFyIHVpZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCdlLW1hcHBpbmd1aWQnKTtcbiAgICAgICAgICAgIGNvbHVtbiA9IHRoaXMucGFyZW50LmdldENvbHVtbkJ5VWlkKHVpZCk7XG4gICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGlubmVySHRtbCArIHRoaXMubG9jYWxpemVyLmdldENvbnN0YW50KCdDb2x1bW5IZWFkZXInKSArIGNlbGwuY29sdW1uLmhlYWRlclRleHQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSAmJiAoIWRhdGEgfHwgKGRhdGEgJiYgIWRhdGEua2V5KSkpIHtcbiAgICAgICAgICAgIGFkZFN0aWNreUNvbHVtblBvc2l0aW9uKHRoaXMucGFyZW50LCBjb2x1bW4sIG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdG8gc3BlY2lmaWVzIGhvdyB0aGUgcmVzdWx0IGNvbnRlbnQgdG8gYmUgcGxhY2VkIGluIHRoZSBjZWxsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBub2RlIC0gc3BlY2lmaWVzIHRoZSBub2RlXG4gICAgICogQHBhcmFtIHtzdHJpbmd8RWxlbWVudH0gaW5uZXJIdG1sIC0gc3BlY2lmaWVzIHRoZSBpbm5lckhUTUxcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHkgLSBzcGVjaWZpZXMgdGhlIGVsZW1lbnRcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIENlbGxSZW5kZXJlci5wcm90b3R5cGUuYXBwZW5kSHRtbCA9IGZ1bmN0aW9uIChub2RlLCBpbm5lckh0bWwsIHByb3BlcnR5KSB7XG4gICAgICAgIGlmIChwcm9wZXJ0eSA9PT0gdm9pZCAwKSB7IHByb3BlcnR5ID0gJ2lubmVySFRNTCc7IH1cbiAgICAgICAgbm9kZVtcIlwiICsgcHJvcGVydHldID0gaW5uZXJIdG1sO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG5vZGUgLSBzcGVjaWZpZXMgdGhlIG5vZGVcbiAgICAgKiBAcGFyYW0ge2NlbGw8Q29sdW1uPn0gY2VsbCAtIHNwZWNpZmllcyB0aGUgY2VsbFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhdHRyaWJ1dGVzIC0gc3BlY2lmaWVzIHRoZSBhdHRyaWJ1dGVzXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIENlbGxSZW5kZXJlci5wcm90b3R5cGUuc2V0QXR0cmlidXRlcyA9IGZ1bmN0aW9uIChub2RlLCBjZWxsLCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHZhciBjb2x1bW4gPSBjZWxsLmNvbHVtbjtcbiAgICAgICAgdGhpcy5idWlsZEF0dHJpYnV0ZUZyb21DZWxsKG5vZGUsIGNlbGwsIGNvbHVtbi50eXBlID09PSAnY2hlY2tib3gnKTtcbiAgICAgICAgc2V0U3R5bGVBbmRBdHRyaWJ1dGVzKG5vZGUsIGF0dHJpYnV0ZXMpO1xuICAgICAgICBzZXRTdHlsZUFuZEF0dHJpYnV0ZXMobm9kZSwgY2VsbC5hdHRyaWJ1dGVzKTtcbiAgICAgICAgaWYgKGNvbHVtbi5jdXN0b21BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBzZXRTdHlsZUFuZEF0dHJpYnV0ZXMobm9kZSwgY29sdW1uLmN1c3RvbUF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5yb3dSZW5kZXJpbmdNb2RlID09PSAnVmVydGljYWwnKSB7XG4gICAgICAgICAgICBzZXRTdHlsZUFuZEF0dHJpYnV0ZXMobm9kZSwgeyAnZGF0YS1jZWxsJzogY29sdW1uLmhlYWRlclRleHQgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbi50ZXh0QWxpZ24pIHtcbiAgICAgICAgICAgIHZhciBhbGlnbm1lbnRDbGFzc01hcCA9IHsgcmlnaHQ6ICdlLXJpZ2h0YWxpZ24nLCBsZWZ0OiAnZS1sZWZ0YWxpZ24nLCBjZW50ZXI6ICdlLWNlbnRlcmFsaWduJywganVzdGlmeTogJ2UtanVzdGlmeWFsaWduJyB9O1xuICAgICAgICAgICAgaWYgKGFsaWdubWVudENsYXNzTWFwW2NvbHVtbi50ZXh0QWxpZ24udG9Mb3dlckNhc2UoKV0pIHtcbiAgICAgICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoYWxpZ25tZW50Q2xhc3NNYXBbY29sdW1uLnRleHRBbGlnbi50b0xvd2VyQ2FzZSgpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbi5jbGlwTW9kZSA9PT0gJ0NsaXAnIHx8ICghY29sdW1uLmNsaXBNb2RlICYmIHRoaXMucGFyZW50LmNsaXBNb2RlID09PSAnQ2xpcCcpKSB7XG4gICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ2UtZ3JpZGNsaXAnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2x1bW4uY2xpcE1vZGUgPT09ICdFbGxpcHNpc1dpdGhUb29sdGlwJyB8fCAoIWNvbHVtbi5jbGlwTW9kZSAmJiB0aGlzLnBhcmVudC5jbGlwTW9kZSA9PT0gJ0VsbGlwc2lzV2l0aFRvb2x0aXAnKVxuICAgICAgICAgICAgJiYgISh0aGlzLnBhcmVudC5hbGxvd1RleHRXcmFwICYmICh0aGlzLnBhcmVudC50ZXh0V3JhcFNldHRpbmdzLndyYXBNb2RlID09PSAnQ29udGVudCdcbiAgICAgICAgICAgICAgICB8fCB0aGlzLnBhcmVudC50ZXh0V3JhcFNldHRpbmdzLndyYXBNb2RlID09PSAnQm90aCcpKSkge1xuICAgICAgICAgICAgaWYgKGNvbHVtbi50eXBlICE9PSAnY2hlY2tib3gnKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWVsbGlwc2lzdG9vbHRpcCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBDZWxsUmVuZGVyZXIucHJvdG90eXBlLmJ1aWxkQXR0cmlidXRlRnJvbUNlbGwgPSBmdW5jdGlvbiAobm9kZSwgY2VsbCwgaXNDaGVja0JveFR5cGUpIHtcbiAgICAgICAgdmFyIGF0dHIgPSB7fTtcbiAgICAgICAgdmFyIGNsYXNzZXMgPSBbXTtcbiAgICAgICAgaWYgKGNlbGwuY29sU3Bhbikge1xuICAgICAgICAgICAgYXR0ci5jb2xTcGFuID0gY2VsbC5jb2xTcGFuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjZWxsLnJvd1NwYW4pIHtcbiAgICAgICAgICAgIGF0dHIucm93U3BhbiA9IGNlbGwucm93U3BhbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VsbC5pc1RlbXBsYXRlKSB7XG4gICAgICAgICAgICBjbGFzc2VzLnB1c2goJ2UtdGVtcGxhdGVjZWxsJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlbGwuaXNTZWxlY3RlZCkge1xuICAgICAgICAgICAgY2xhc3Nlcy5wdXNoLmFwcGx5KGNsYXNzZXMsIFsnZS1zZWxlY3Rpb25iYWNrZ3JvdW5kJywgJ2UtYWN0aXZlJ10pO1xuICAgICAgICAgICAgaWYgKGlzQ2hlY2tCb3hUeXBlKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5xdWVyeVNlbGVjdG9yKCcuZS1mcmFtZScpLmNsYXNzTGlzdC5hZGQoJ2UtY2hlY2snKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VsbC5pc0NvbHVtblNlbGVjdGVkKSB7XG4gICAgICAgICAgICBjbGFzc2VzLnB1c2guYXBwbHkoY2xhc3NlcywgWydlLWNvbHVtbnNlbGVjdGlvbiddKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VsbC5jZWxsVHlwZSA9PT0gQ2VsbFR5cGUuSGVhZGVyKSB7XG4gICAgICAgICAgICBhdHRyW2xpdGVyYWxzLmFyaWFDb2xJbmRleF0gPSBjZWxsLmNvbEluZGV4ICsgMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY2VsbC5pbmRleCkpIHtcbiAgICAgICAgICAgIGF0dHJbbGl0ZXJhbHMuYXJpYUNvbEluZGV4XSA9IGNlbGwuaW5kZXggKyAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY2VsbC52aXNpYmxlKSB7XG4gICAgICAgICAgICBjbGFzc2VzLnB1c2goJ2UtaGlkZScpO1xuICAgICAgICB9XG4gICAgICAgIGF0dHIuY2xhc3MgPSBjbGFzc2VzO1xuICAgICAgICBzZXRTdHlsZUFuZEF0dHJpYnV0ZXMobm9kZSwgYXR0cik7XG4gICAgfTtcbiAgICBDZWxsUmVuZGVyZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKGZpZWxkLCBkYXRhLCBjb2x1bW4pIHtcbiAgICAgICAgcmV0dXJuIGNvbHVtbi52YWx1ZUFjY2Vzc29yKGZpZWxkLCBkYXRhLCBjb2x1bW4pO1xuICAgIH07XG4gICAgcmV0dXJuIENlbGxSZW5kZXJlcjtcbn0oKSk7XG5leHBvcnQgeyBDZWxsUmVuZGVyZXIgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/content-renderer.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/content-renderer.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ContentRender: () => (/* binding */ ContentRender)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _row_renderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./row-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-renderer.js\");\n/* harmony import */ var _cell_merge_renderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./cell-merge-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-merge-renderer.js\");\n/* harmony import */ var _services_row_model_generator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/row-model-generator */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/row-model-generator.js\");\n/* harmony import */ var _services_group_model_generator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../services/group-model-generator */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/group-model-generator.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n\n\n\n\n\n// eslint-disable-next-line valid-jsdoc, jsdoc/require-param, jsdoc/require-returns\n/**\n * Content module is used to render grid content\n *\n * @hidden\n */\nvar ContentRender = /** @class */ (function () {\n    /**\n     * Constructor for content renderer module\n     *\n     * @param {IGrid} parent - specifies the Igrid\n     * @param {ServiceLocator} serviceLocator - specifies the service locator\n     */\n    function ContentRender(parent, serviceLocator) {\n        var _this = this;\n        this.rows = [];\n        this.freezeRows = [];\n        this.movableRows = [];\n        this.freezeRowElements = [];\n        /** @hidden */\n        this.currentInfo = {};\n        /** @hidden */\n        this.prevCurrentView = [];\n        this.isLoaded = true;\n        this.drop = function (e) {\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.columnDrop, { target: e.target, droppedElement: e.droppedElement });\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(e.droppedElement);\n        };\n        /** @hidden */\n        this.infiniteCache = {};\n        /** @hidden */\n        this.visibleRows = [];\n        this.visibleFrozenRows = [];\n        this.rightFreezeRows = [];\n        this.isAddRows = false;\n        this.isInfiniteFreeze = false;\n        this.useGroupCache = false;\n        /** @hidden */\n        this.tempFreezeRows = [];\n        this.rafCallback = function (args) {\n            var arg = args;\n            return function () {\n                _this.ariaService.setBusy(_this.getPanel().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.content), false);\n                if (_this.parent.isDestroyed) {\n                    return;\n                }\n                var rows = _this.rows.slice(0);\n                if (_this.parent.enableInfiniteScrolling) {\n                    if (_this.parent.groupSettings.enableLazyLoading) {\n                        for (var i = 0; i < _this.visibleRows.length; i++) {\n                            _this.setRowsInLazyGroup(_this.visibleRows[parseInt(i.toString(), 10)], i);\n                        }\n                    }\n                    rows = _this.parent.getRowsObject();\n                    var prevPage = arg.prevPage;\n                    if (_this.parent.infiniteScrollSettings.enableCache && prevPage) {\n                        var maxBlock = _this.parent.infiniteScrollSettings.maxBlocks;\n                        rows = [];\n                        var rowIdx = (parseInt(_this.rowElements[0].getAttribute('aria-rowindex'), 10));\n                        var startIdx = Math.ceil(rowIdx / _this.parent.pageSettings.pageSize);\n                        for (var i = 0, count = startIdx; i < maxBlock; i++, count++) {\n                            if (_this.infiniteCache[parseInt(count.toString(), 10)]) {\n                                rows = rows.concat(_this.infiniteCache[parseInt(count.toString(), 10)]);\n                            }\n                        }\n                    }\n                }\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.contentReady, { rows: rows, args: arg });\n                if (_this.parent.editSettings.showAddNewRow && _this.parent.addNewRowFocus) {\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.showAddNewRowFocus, {});\n                    _this.parent.addNewRowFocus = false;\n                }\n                if (_this.parent.autoFit) {\n                    _this.parent.preventAdjustColumns();\n                }\n                if (!_this.parent.isInitialLoad) {\n                    _this.parent.focusModule.setFirstFocusableTabIndex();\n                }\n                if (_this.isLoaded) {\n                    _this.parent.isManualRefresh = false;\n                    if (_this.parent.enableInfiniteScrolling && _this.parent.groupSettings.enableLazyLoading && args.requestType === 'sorting') {\n                        _this.parent.infiniteScrollModule['groupCaptionAction'] = undefined;\n                    }\n                    var isReactChild = _this.parent.parentDetails && _this.parent.parentDetails.parentInstObj &&\n                        _this.parent.parentDetails.parentInstObj.isReact;\n                    if ((_this.parent.isReact || isReactChild) && _this.parent.element.querySelectorAll('.e-templatecell').length) {\n                        // eslint-disable-next-line @typescript-eslint/no-this-alias\n                        var thisRef_1 = _this;\n                        thisRef_1.parent.renderTemplates(function () {\n                            thisRef_1.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.dataBound, {}, function () {\n                                if (thisRef_1.parent.allowTextWrap) {\n                                    thisRef_1.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.freezeRender, { case: 'textwrap' });\n                                }\n                            });\n                        });\n                    }\n                    else {\n                        _this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.dataBound, {}, function () {\n                            if (_this.parent.allowTextWrap) {\n                                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.freezeRender, { case: 'textwrap' });\n                            }\n                        });\n                    }\n                    if (_this.parent.allowTextWrap && _this.parent.height === 'auto') {\n                        if (_this.parent.getContentTable().scrollHeight > _this.parent.getContent().clientHeight) {\n                            _this.parent.scrollModule.setPadding();\n                        }\n                        else {\n                            _this.parent.scrollModule.removePadding();\n                        }\n                    }\n                }\n                if (arg) {\n                    var action = (arg.requestType || '').toLowerCase() + '-complete';\n                    _this.parent.notify(action, arg);\n                    if (args.requestType === 'batchsave') {\n                        args.cancel = false;\n                        _this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.actionComplete, args);\n                    }\n                }\n                if (_this.isLoaded) {\n                    _this.parent.hideSpinner();\n                }\n            };\n        };\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.widthService = serviceLocator.getService('widthService');\n        this.ariaService = this.serviceLocator.getService('ariaService');\n        this.parent.enableDeepCompare = this.parent.getDataModule().isRemote();\n        this.generator = this.getModelGenerator();\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (!this.parent.enableColumnVirtualization && !this.parent.enableVirtualization\n            && !this.parent.groupSettings.enableLazyLoading) {\n            this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.columnVisibilityChanged, this.setVisible, this);\n        }\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.colGroupRefresh, this.colGroupRefresh, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.uiUpdate, this.enableAfterRender, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.refreshInfiniteModeBlocks, this.refreshContentRows, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.beforeCellFocused, this.beforeCellFocused, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.destroy, this.droppableDestroy, this);\n    }\n    ContentRender.prototype.beforeCellFocused = function (e) {\n        if (e.byKey && (e.keyArgs.action === 'upArrow' || e.keyArgs.action === 'downArrow')) {\n            this.pressedKey = e.keyArgs.action;\n        }\n        else {\n            this.pressedKey = undefined;\n        }\n    };\n    /**\n     * The function is used to render grid content div\n     *\n     * @returns {void}\n     */\n    ContentRender.prototype.renderPanel = function () {\n        var gObj = this.parent;\n        var div = this.parent.element.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridContent);\n        if (div) {\n            this.ariaService.setOptions(this.parent.element.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.content), { busy: false });\n            this.setPanel(div);\n            return;\n        }\n        div = this.parent.createElement('div', { className: _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridContent });\n        var innerDiv = this.parent.createElement('div', {\n            className: _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.content\n        });\n        this.ariaService.setOptions(innerDiv, { busy: false });\n        if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n            this.renderHorizontalScrollbar(div);\n            innerDiv.classList.add('e-virtual-content');\n        }\n        div.appendChild(innerDiv);\n        this.setPanel(div);\n        gObj.element.appendChild(div);\n    };\n    ContentRender.prototype.renderHorizontalScrollbar = function (element) {\n        var parent = this.parent.createElement('div', { className: 'e-movablescrollbar' });\n        var child = this.parent.createElement('div', { className: 'e-movablechild' });\n        var scrollbarHeight = (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.getScrollBarWidth)().toString();\n        this.setScrollbarHeight(child, scrollbarHeight);\n        this.setScrollbarHeight(parent, scrollbarHeight);\n        parent.appendChild(child);\n        element.appendChild(parent);\n    };\n    ContentRender.prototype.setScrollbarHeight = function (ele, height) {\n        ele.style.minHeight = height + 'px';\n        ele.style.maxHeight = height + 'px';\n    };\n    /**\n     * The function is used to render grid content table\n     *\n     * @returns {void}\n     */\n    ContentRender.prototype.renderTable = function () {\n        var contentDiv = this.getPanel();\n        var virtualTable = contentDiv.querySelector('.e-virtualtable');\n        var virtualTrack = contentDiv.querySelector('.e-virtualtrack');\n        if (this.parent.enableVirtualization && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(virtualTable) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(virtualTrack)) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(virtualTable);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(virtualTrack);\n        }\n        contentDiv.appendChild(this.createContentTable('_content_table'));\n        this.setTable(contentDiv.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.table));\n        if (this.parent.selectionSettings.type === 'Multiple') {\n            this.ariaService.setOptions(this.parent.element, {\n                multiselectable: true\n            });\n        }\n        this.initializeContentDrop();\n        if (this.parent.frozenRows) {\n            this.parent.getHeaderContent().classList.add('e-frozenhdr');\n        }\n    };\n    /**\n     * The function is used to create content table elements\n     *\n     * @param {string} id - specifies the id\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    ContentRender.prototype.createContentTable = function (id) {\n        var innerDiv = this.getPanel().firstElementChild;\n        if (this.getTable()) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.getTable());\n        }\n        var table = innerDiv.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.table) ? innerDiv.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.table) :\n            this.parent.createElement('table', {\n                className: _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.table, attrs: {\n                    role: 'presentation',\n                    id: this.parent.element.id + id\n                }\n            });\n        table.style.cssText = 'border-collapse: separate; border-spacing: .25px;';\n        this.setColGroup(this.parent.getHeaderTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.colGroup).cloneNode(true));\n        table.appendChild(this.getColGroup());\n        table.appendChild(this.parent.createElement(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody, { attrs: { role: 'rowgroup' } }));\n        innerDiv.appendChild(table);\n        return innerDiv;\n    };\n    /**\n     * Refresh the content of the Grid.\n     *\n     * @param {NotifyArgs} args - specifies the args\n     * @returns {void}\n     */\n    // tslint:disable-next-line:max-func-body-length\n    ContentRender.prototype.refreshContentRows = function (args) {\n        var _this = this;\n        if (args === void 0) { args = {}; }\n        var gObj = this.parent;\n        if (gObj.currentViewData.length === 0) {\n            return;\n        }\n        if (gObj.editSettings && gObj.editModule && gObj.editSettings.mode === 'Batch' && gObj.editModule.formObj\n            && gObj.editSettings.showConfirmDialog === false) {\n            gObj.editModule.destroyForm();\n        }\n        var dataSource = this.currentMovableRows || gObj.currentViewData;\n        var isReact = gObj.isReact && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.rowTemplate);\n        var isReactPrintGrid = this.parent.printGridParent && this.parent.printGridParent.isReact;\n        var frag = isReact || isReactPrintGrid ? gObj.createElement(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody, { attrs: { role: 'rowgroup' } }) : document.createDocumentFragment();\n        if (!this.initialPageRecords) {\n            this.initialPageRecords = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)([], dataSource);\n        }\n        var hdrfrag = isReact ? gObj.createElement(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody, { attrs: { role: 'rowgroup' } }) : document.createDocumentFragment();\n        var refFrag;\n        var refHdrfrag;\n        if ((gObj.isReact || isReactPrintGrid) && gObj.rowTemplate) {\n            refFrag = frag;\n            refHdrfrag = hdrfrag;\n        }\n        var columns = gObj.getColumns();\n        var tr;\n        var hdrTbody;\n        var trElement;\n        var row = new _row_renderer__WEBPACK_IMPORTED_MODULE_4__.RowRenderer(this.serviceLocator, null, this.parent);\n        var isInfiniteScroll = this.parent.enableInfiniteScrolling\n            && args.requestType === 'infiniteScroll';\n        var isColumnVirtualInfiniteProcess = this.isInfiniteColumnvirtualization() && args.requestType !== 'virtualscroll';\n        var infiniteDetail = gObj.enableInfiniteScrolling && (gObj.childGrid || gObj.detailTemplate) ? true : false;\n        var infiniteDetailModified = infiniteDetail && ((args.action === 'add' && args.requestType === 'save')\n            || args.requestType === 'delete');\n        if (infiniteDetailModified) {\n            args.startIndex = 0;\n            gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.detachDetailTemplate, {});\n        }\n        if (!(isInfiniteScroll && (gObj.childGrid || gObj.detailTemplate) && !gObj.infiniteScrollSettings.enableCache)) {\n            if (infiniteDetail) {\n                this.parent.infiniteScrollModule.infiniteDetailDestroy = true;\n            }\n            gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.destroyChildGrid, isInfiniteScroll && (gObj.childGrid || gObj.detailTemplate)\n                && gObj.infiniteScrollSettings.enableCache ? args : {});\n        }\n        this.rowElements = [];\n        this.rows = [];\n        this.tempFreezeRows = [];\n        var tbdy;\n        var tableName;\n        var isGroupFrozenHdr = this.parent.frozenRows && this.parent.groupSettings.columns.length ? true : false;\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_3__.isGroupAdaptive)(gObj)) {\n            if (['sorting', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', 'save', 'delete']\n                .some(function (value) { return args.requestType === value; })) {\n                this.emptyVcRows();\n            }\n        }\n        var modelData;\n        modelData = this.checkCache(modelData, args);\n        if (!this.isAddRows && !this.useGroupCache) {\n            modelData = this.generator.generateRows(dataSource, args);\n        }\n        this.setGroupCache(modelData, args);\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.setInfiniteCache, { isInfiniteScroll: isInfiniteScroll, modelData: modelData, args: args });\n        var isFrozenLeft = false;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var registeredTemplates = this.parent.registeredTemplate;\n        if (!(args.requestType === 'infiniteScroll' && !this.parent.infiniteScrollSettings.enableCache) && registeredTemplates\n            && registeredTemplates.template && !args.isFrozen && !isFrozenLeft) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var templatetoclear = [];\n            for (var i = 0; i < registeredTemplates.template.length; i++) {\n                for (var j = 0; j < registeredTemplates.template[parseInt(i.toString(), 10)].rootNodes.length; j++) {\n                    if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(registeredTemplates.template[parseInt(i.toString(), 10)]\n                        .rootNodes[parseInt(j.toString(), 10)].parentNode)) {\n                        templatetoclear.push(registeredTemplates.template[parseInt(i.toString(), 10)]);\n                    }\n                }\n            }\n            this.parent.destroyTemplate(['template'], templatetoclear);\n        }\n        if ((this.parent.isReact || this.parent.isVue) && !(args.requestType === 'infiniteScroll' && !this.parent.infiniteScrollSettings.enableCache) && !args.isFrozen) {\n            var templates = [\n                this.parent.isVue ? 'template' : 'columnTemplate', 'rowTemplate', 'detailTemplate',\n                'captionTemplate', 'commandsTemplate', 'groupFooterTemplate', 'groupCaptionTemplate'\n            ];\n            if (args.requestType === 'infiniteScroll' && this.parent.infiniteScrollSettings.enableCache) {\n                templates = [\n                    this.parent.isVue ? 'template' : 'columnTemplate', 'commandsTemplate'\n                ];\n            }\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.clearReactVueTemplates)(this.parent, templates);\n        }\n        if (this.parent.enableColumnVirtualization) {\n            var cellMerge = new _cell_merge_renderer__WEBPACK_IMPORTED_MODULE_5__.CellMergeRender(this.serviceLocator, this.parent);\n            cellMerge.updateVirtualCells(modelData);\n        }\n        this.tbody = this.getTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody);\n        var startIndex = 0;\n        var blockLoad = true;\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_3__.isGroupAdaptive)(gObj) && gObj.vcRows.length) {\n            var top_1 = 'top';\n            var scrollTop = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.virtualInfo.offsets) ? args.virtualInfo.offsets.top :\n                (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.scrollTop) ? args.scrollTop[\"\" + top_1] : 0);\n            if (scrollTop !== 0) {\n                var offsets_1 = gObj.vGroupOffsets;\n                var bSize = gObj.pageSettings.pageSize / 2;\n                var values = Object.keys(offsets_1).map(function (key) { return offsets_1[\"\" + key]; });\n                for (var m = 0; m < values.length; m++) {\n                    if (scrollTop < values[parseInt(m.toString(), 10)]) {\n                        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.virtualInfo) && args.virtualInfo.direction === 'up') {\n                            startIndex = m > 0 ? ((m - 1) * bSize) : (m * bSize);\n                            break;\n                        }\n                        else {\n                            startIndex = m * bSize;\n                            if (this.parent.contentModule.isEndBlock(m) || this.parent.contentModule.isEndBlock(m + 1)) {\n                                args.virtualInfo.blockIndexes = [m, m + 1];\n                            }\n                            break;\n                        }\n                    }\n                }\n                if (Math.round(scrollTop + this.contentPanel.firstElementChild.offsetHeight) >=\n                    this.contentPanel.firstElementChild.scrollHeight && !args.rowObject) {\n                    blockLoad = false;\n                }\n            }\n        }\n        var isVFFrozenOnly = gObj.frozenRows && this.parent.enableVirtualization\n            && args.requestType === 'reorder';\n        if ((gObj.frozenRows && args.requestType === 'virtualscroll' && args.virtualInfo.sentinelInfo.axis === 'X') || isVFFrozenOnly) {\n            var bIndex = args.virtualInfo.blockIndexes;\n            var page = args.virtualInfo.page;\n            args.virtualInfo.blockIndexes = [1, 2];\n            if (isVFFrozenOnly) {\n                args.virtualInfo.page = 1;\n            }\n            var data = isVFFrozenOnly ? this.initialPageRecords : dataSource;\n            var mhdrData = this.vgenerator\n                .generateRows(data, args);\n            mhdrData.splice(this.parent.frozenRows);\n            for (var i = 0; i < this.parent.frozenRows; i++) {\n                // mhdrData[parseInt(i.toString(), 10)].cells.splice(0, this.parent.getFrozenColumns());\n                tr = row.render(mhdrData[parseInt(i.toString(), 10)], columns);\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.addFixedColumnBorder)(tr);\n                hdrfrag.appendChild(tr);\n            }\n            args.virtualInfo.blockIndexes = bIndex;\n            args.virtualInfo.page = page;\n            if (isVFFrozenOnly && args.virtualInfo.page === 1) {\n                modelData.splice(0, this.parent.frozenRows);\n            }\n        }\n        this.virtualFrozenHdrRefresh(hdrfrag, modelData, row, args, dataSource, columns);\n        if (this.parent.groupSettings.enableLazyLoading && !this.useGroupCache && this.parent.groupSettings.columns.length) {\n            (this.parent.enableVirtualization ? this.parent.lazyLoadRender :\n                this.parent.contentModule).refRowsObj[this.parent.pageSettings.currentPage] = [];\n        }\n        if ((this.parent.enableInfiniteScrolling && this.parent.groupSettings.enableLazyLoading && args.requestType === 'delete')\n            || infiniteDetailModified) { //  || (this.parent.infiniteScrollSettings && this.parent.infiniteScrollSettings.enableCache))\n            this.visibleRows = [];\n        }\n        var _loop_1 = function (i, len) {\n            this_1.rows.push(modelData[parseInt(i.toString(), 10)]);\n            if (this_1.parent.groupSettings.enableLazyLoading && !this_1.useGroupCache && this_1.parent.groupSettings.columns.length) {\n                (this_1.parent.enableVirtualization ? this_1.parent.lazyLoadRender :\n                    this_1.parent.contentModule).refRowsObj[this_1.parent.pageSettings.currentPage].push(modelData[parseInt(i.toString(), 10)]);\n                this_1.setRowsInLazyGroup(modelData[parseInt(i.toString(), 10)], i);\n                if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(modelData[parseInt(i.toString(), 10)].indent)) {\n                    return \"continue\";\n                }\n            }\n            this_1.setInfiniteVisibleRows(args, modelData[parseInt(i.toString(), 10)]);\n            if ((0,_base_util__WEBPACK_IMPORTED_MODULE_3__.isGroupAdaptive)(gObj) && args.virtualInfo && args.virtualInfo.blockIndexes\n                && (this_1.rowElements.length >= (args.virtualInfo.blockIndexes.length * this_1.parent.contentModule.getBlockSize()))\n                && blockLoad) {\n                this_1.parent.currentViewData['records'] = this_1.rows.map(function (m) { return m.data; });\n                return \"break\";\n            }\n            if (!gObj.rowTemplate) {\n                tr = row.render(modelData[parseInt(i.toString(), 10)], columns);\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.addFixedColumnBorder)(tr);\n                var isVFreorder = this_1.ensureFrozenHeaderRender(args);\n                if (gObj.frozenRows && (i < gObj.frozenRows || isGroupFrozenHdr) && !isInfiniteScroll && args.requestType !== 'virtualscroll' && isVFreorder\n                    && this_1.ensureVirtualFrozenHeaderRender(args)) {\n                    hdrfrag.appendChild(tr);\n                }\n                else {\n                    frag.appendChild(tr);\n                }\n                var rowIdx = parseInt(tr.getAttribute('aria-rowindex'), 10) - 1;\n                if (rowIdx + 1 === gObj.frozenRows) {\n                    isGroupFrozenHdr = false;\n                }\n                if (modelData[parseInt(i.toString(), 10)].isExpand) {\n                    gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.expandChildGrid, tr.cells[gObj.groupSettings.columns.length]);\n                }\n            }\n            else {\n                var rowTemplateID = gObj.element.id + 'rowTemplate';\n                var elements = void 0;\n                if (gObj.isReact || isReactPrintGrid) {\n                    var isHeader = gObj.frozenRows && i < gObj.frozenRows;\n                    var copied = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({ index: i }, dataSource[parseInt(i.toString(), 10)]);\n                    gObj.getRowTemplate()(copied, gObj, 'rowTemplate', rowTemplateID, null, null, isHeader ? hdrfrag : frag);\n                    if (gObj.requireTemplateRef) {\n                        // eslint-disable-next-line @typescript-eslint/no-this-alias\n                        var thisRef_2 = this_1;\n                        thisRef_2.parent.renderTemplates(function () {\n                            if (gObj.frozenRows && i < gObj.frozenRows) {\n                                tr = refHdrfrag.childNodes[parseInt(i.toString(), 10)];\n                            }\n                            else {\n                                trElement = refFrag.childNodes[parseInt(i.toString(), 10)];\n                            }\n                            var arg = { data: modelData[parseInt(i.toString(), 10)].data,\n                                row: trElement ? trElement : tr };\n                            thisRef_2.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.rowDataBound, arg);\n                            if (modelData[parseInt(i.toString(), 10)].isDataRow || (thisRef_2.parent.enableVirtualization &&\n                                thisRef_2.parent.groupSettings.enableLazyLoading)) {\n                                thisRef_2.rowElements.push(arg.row);\n                            }\n                            thisRef_2.ariaService.setOptions(thisRef_2.parent.element, {\n                                colcount: gObj.getColumns().length.toString()\n                            });\n                            if (i === modelData.length - 1) {\n                                refFrag = null;\n                                refHdrfrag = null;\n                            }\n                        });\n                        return \"continue\";\n                    }\n                }\n                else {\n                    elements = gObj.getRowTemplate()((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({ index: i }, dataSource[parseInt(i.toString(), 10)]), gObj, 'rowTemplate', rowTemplateID, undefined, undefined, undefined, this_1.parent['root']);\n                }\n                if (!gObj.isReact && elements[0].tagName === 'TBODY') {\n                    for (var j = 0; j < elements.length; j++) {\n                        var isTR = elements[parseInt(j.toString(), 10)].nodeName.toLowerCase() === 'tr';\n                        if (isTR || (elements[parseInt(j.toString(), 10)].querySelectorAll && elements[parseInt(j.toString(), 10)].querySelectorAll('tr').length)) {\n                            tr = isTR ? elements[parseInt(j.toString(), 10)] : elements[parseInt(j.toString(), 10)].querySelector('tr');\n                        }\n                    }\n                    if (gObj.frozenRows && i < gObj.frozenRows) {\n                        hdrfrag.appendChild(tr);\n                    }\n                    else {\n                        frag.appendChild(tr);\n                    }\n                }\n                else {\n                    if (gObj.frozenRows && i < gObj.frozenRows) {\n                        tr = !gObj.isReact ? (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.appendChildren)(hdrfrag, elements) : hdrfrag.lastElementChild;\n                    }\n                    else {\n                        // frag.appendChild(tr);\n                        if (!gObj.isReact) {\n                            tr = (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.appendChildren)(frag, elements);\n                        }\n                        trElement = gObj.isReact ? frag.lastElementChild : tr.lastElementChild;\n                    }\n                }\n                var arg = { data: modelData[parseInt(i.toString(), 10)].data, row: trElement ? trElement : tr };\n                this_1.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.rowDataBound, arg);\n            }\n            if (modelData[parseInt(i.toString(), 10)].isDataRow || (this_1.parent.enableVirtualization &&\n                this_1.parent.groupSettings.enableLazyLoading)) {\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.rowTemplate) && (gObj.isAngular || gObj.isVue3 || gObj.isVue)) {\n                    this_1.rowElements.push(trElement ? trElement : tr);\n                }\n                else {\n                    this_1.rowElements.push(tr);\n                }\n            }\n            this_1.ariaService.setOptions(this_1.parent.element, { colcount: gObj.getColumns().length.toString() });\n        };\n        var this_1 = this;\n        for (var i = startIndex, len = modelData.length; i < len; i++) {\n            var state_1 = _loop_1(i, len);\n            if (state_1 === \"break\")\n                break;\n        }\n        var isReactChild = gObj.parentDetails && gObj.parentDetails.parentInstObj && gObj.parentDetails.parentInstObj.isReact;\n        if ((gObj.isReact || isReactChild) && !gObj.requireTemplateRef) {\n            gObj.renderTemplates();\n        }\n        if (this.parent.enableInfiniteScrolling && this.parent.groupSettings.enableLazyLoading) {\n            this.parent.contentModule.refRowsObj[this.parent.pageSettings.currentPage] =\n                this.parent.contentModule['groupCache'][this.parent.pageSettings.currentPage];\n        }\n        if (this.parent.groupSettings.enableLazyLoading && !this.useGroupCache && this.parent.groupSettings.columns.length) {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.refreshExpandandCollapse, {\n                rows: (this.parent.enableVirtualization ? this.parent.lazyLoadRender :\n                    this.parent.contentModule).refRowsObj[this.parent.pageSettings.currentPage]\n            });\n        }\n        gObj.removeMaskRow();\n        this.parent.notify('removeGanttShimmer', { requestType: 'hideShimmer' });\n        if ((gObj.frozenRows && args.requestType !== 'virtualscroll' && !isInfiniteScroll && this.ensureVirtualFrozenHeaderRender(args))\n            || (args.requestType === 'virtualscroll' && args.virtualInfo.sentinelInfo && args.virtualInfo.sentinelInfo.axis === 'X')) {\n            hdrTbody = gObj.getHeaderTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody);\n            if (isReact) {\n                var parentTable = hdrTbody.parentElement;\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(hdrTbody);\n                parentTable.appendChild(hdrfrag);\n            }\n            else {\n                hdrTbody.innerHTML = '';\n                hdrTbody.appendChild(hdrfrag);\n            }\n            if (!gObj.isInitialLoad) {\n                gObj.scrollModule.setHeight();\n            }\n        }\n        // if (!gObj.enableVirtualization && hdrTbody && gObj.frozenRows && idx === 0 && cont.offsetHeight === Number(gObj.height)) {\n        //     cont.style.height = (cont.offsetHeight - hdrTbody.offsetHeight) + 'px';\n        // }\n        args.rows = this.rows.slice(0);\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.getUpdateUsingRaf)(function () {\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.beforeFragAppend, args);\n            if (!_this.parent.enableVirtualization && (!_this.parent.enableColumnVirtualization || isColumnVirtualInfiniteProcess)\n                && !isInfiniteScroll) {\n                if (!gObj.isReact) {\n                    _this.tbody.innerHTML = '';\n                }\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.tbody.parentElement)) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(_this.tbody);\n                }\n                else {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(gObj.getContentTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody));\n                }\n                _this.tbody = _this.parent.createElement(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody, { attrs: { role: 'rowgroup' } });\n            }\n            if (gObj.rowTemplate) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.updateBlazorTemplate)(gObj.element.id + 'rowTemplate', 'RowTemplate', gObj);\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.parent.infiniteScrollModule) && ((_this.parent.enableInfiniteScrolling\n                && !_this.isInfiniteColumnvirtualization()) || isColumnVirtualInfiniteProcess)) {\n                _this.isAddRows = false;\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.removeInfiniteRows, { args: args });\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.appendInfiniteContent, {\n                    tbody: tbdy ? tbdy : _this.tbody, frag: frag, args: args, rows: _this.rows,\n                    rowElements: _this.rowElements, visibleRows: _this.visibleRows,\n                    tableName: tableName\n                });\n                if (_this.isInfiniteColumnvirtualization() && _this.parent.isFrozenGrid()) {\n                    var virtualTable = _this.parent.getContent().querySelector('.e-virtualtable');\n                    var transform = (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.getTransformValues)(virtualTable);\n                    _this.parent.contentModule.resetStickyLeftPos(transform.width);\n                    _this.widthService.refreshFrozenScrollbar();\n                }\n            }\n            else {\n                _this.useGroupCache = false;\n                _this.appendContent(_this.tbody, frag, args);\n            }\n            if (_this.parent.editSettings.showAddNewRow && (_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling)) {\n                var newRow = _this.parent.element.querySelector('.e-addrow-removed');\n                if (newRow) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(newRow);\n                }\n            }\n            var startAdd = !_this.parent.element.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.addedRow);\n            if (_this.parent.editSettings.showAddNewRow && _this.parent.editSettings.mode === 'Normal') {\n                if (startAdd) {\n                    if (_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) {\n                        _this.parent.isAddNewRow = true;\n                    }\n                    _this.parent.isEdit = false;\n                    _this.parent.addRecord();\n                }\n                if (startAdd || ((_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) &&\n                    ['sorting', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder']\n                        .some(function (value) { return args.requestType === value; }))) {\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.showAddNewRowFocus, {});\n                }\n            }\n            if (_this.parent.getVisibleFrozenRightCount() && _this.parent.getContent() && (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.getScrollWidth)(_this.parent) > 0) {\n                _this.parent.element.classList.add('e-right-shadow');\n            }\n            frag = null;\n        }, this.rafCallback((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, args)));\n    };\n    ContentRender.prototype.isInfiniteColumnvirtualization = function () {\n        return this.parent.enableColumnVirtualization && this.parent.enableInfiniteScrolling;\n    };\n    ContentRender.prototype.enableCacheOnInfiniteColumnVirtual = function () {\n        return this.isInfiniteColumnvirtualization() && this.parent.infiniteScrollSettings.enableCache;\n    };\n    ContentRender.prototype.emptyVcRows = function () {\n        this.parent.vcRows = [];\n        this.parent.vRows = [];\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    ContentRender.prototype.appendContent = function (tbody, frag, args, tableName) {\n        var isReact = this.parent.isReact && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.rowTemplate);\n        if (isReact) {\n            this.getTable().appendChild(frag);\n        }\n        else {\n            tbody.appendChild(frag);\n            this.getTable().appendChild(tbody);\n        }\n        if (this.parent.rowRenderingMode === 'Vertical' && this.parent.allowTextWrap && (this.parent.textWrapSettings.wrapMode === 'Header'\n            || this.parent.textWrapSettings.wrapMode === 'Both')) {\n            var cells = tbody.querySelectorAll('td');\n            for (var i = 0; i < cells.length; i++) {\n                var headerCellHeight = parseFloat(document.defaultView.getComputedStyle(cells[parseInt(i.toString(), 10)], '::before').getPropertyValue('height'));\n                var cellHeight = cells[parseInt(i.toString(), 10)].offsetHeight;\n                if (headerCellHeight > cellHeight) {\n                    cells[parseInt(i.toString(), 10)].style.height = headerCellHeight + 'px';\n                    cells[parseInt(i.toString(), 10)].style.boxSizing = 'content-box';\n                }\n            }\n        }\n        if (this.parent.getVisibleFrozenLeftCount() && this.parent.enableColumnVirtualization) {\n            this.widthService.refreshFrozenScrollbar();\n        }\n    };\n    ContentRender.prototype.setRowsInLazyGroup = function (row, index) {\n        if (this.parent.groupSettings.enableLazyLoading && !this.useGroupCache && this.parent.groupSettings.columns.length) {\n            (this.parent.enableVirtualization ? this.parent.lazyLoadRender :\n                this.parent.contentModule).maintainRows(row, index);\n        }\n    };\n    ContentRender.prototype.setGroupCache = function (data, args) {\n        if (!this.useGroupCache && this.parent.groupSettings.enableLazyLoading) {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.setGroupCache, { args: args, data: data });\n        }\n    };\n    ContentRender.prototype.ensureFrozenHeaderRender = function (args) {\n        return !((this.parent.enableVirtualization\n            && (args.requestType === 'reorder' || args.requestType === 'refresh')) || (this.parent.infiniteScrollSettings.enableCache\n            && this.parent.frozenRows && this.parent.infiniteScrollModule.requestType === 'delete'\n            && this.parent.pageSettings.currentPage !== 1));\n    };\n    ContentRender.prototype.ensureVirtualFrozenHeaderRender = function (args) {\n        return !(this.parent.enableVirtualization && args.requestType === 'delete');\n    };\n    ContentRender.prototype.checkCache = function (modelData, args) {\n        if (this.parent.infiniteScrollSettings.enableCache && args.requestType === 'infiniteScroll') {\n            this.isAddRows = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.infiniteCache[this.parent.pageSettings.currentPage]);\n            if (this.isAddRows) {\n                var data = this.infiniteCache[this.parent.pageSettings.currentPage];\n                modelData = this.parent.pageSettings.currentPage === 1 ? data.slice(this.parent.frozenRows) : data;\n            }\n            return modelData;\n        }\n        if (this.parent.groupSettings.enableLazyLoading && this.parent.groupSettings.columns.length && (args.requestType === 'paging'\n            || args.requestType === 'columnstate' || args.requestType === 'reorder' || args.requestType === 'virtualscroll')\n            && (this.parent.enableVirtualization ? this.parent.lazyLoadRender :\n                this.parent.contentModule).getGroupCache()[this.parent.pageSettings.currentPage]) {\n            if (!this.parent.enableVirtualization) {\n                this.useGroupCache = true;\n            }\n            return this.parent.enableVirtualization ? this.parent.getRowsObject() :\n                this.parent.contentModule.initialGroupRows(args.requestType === 'reorder');\n        }\n        return null;\n    };\n    ContentRender.prototype.setInfiniteVisibleRows = function (args, data) {\n        if (this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache\n            && !(this.isInfiniteColumnvirtualization() && args.requestType === 'virtualscroll')) {\n            this.visibleRows.push(data);\n        }\n    };\n    ContentRender.prototype.getCurrentBlockInfiniteRecords = function () {\n        var data = [];\n        if (this.parent.infiniteScrollSettings.enableCache) {\n            if (!Object.keys(this.infiniteCache).length) {\n                return [];\n            }\n            var rows = this.parent.getRows();\n            var index = parseInt(rows[this.parent.frozenRows].getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.ariaRowIndex), 10) - 1;\n            var first = Math.ceil((index + 1) / this.parent.pageSettings.pageSize);\n            index = parseInt(rows[rows.length - 1].getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.ariaRowIndex), 10) - 1;\n            var last = Math.ceil((index + (rows.length ? 1 : 0)) / this.parent.pageSettings.pageSize);\n            for (var i = first; i <= last; i++) {\n                data = !data.length ? this.infiniteCache[parseInt(i.toString(), 10)]\n                    : data.concat(this.infiniteCache[parseInt(i.toString(), 10)]);\n            }\n            if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {\n                data = this.infiniteCache[1].slice(0, this.parent.frozenRows).concat(data);\n            }\n        }\n        return data;\n    };\n    ContentRender.prototype.getReorderedRows = function (args) {\n        return this.parent.contentModule.getReorderedFrozenRows(args);\n    };\n    ContentRender.prototype.virtualFrozenHdrRefresh = function (hdrfrag, modelData, row, args, dataSource, columns) {\n        if (this.parent.frozenRows && this.parent.enableVirtualization\n            && (args.requestType === 'reorder' || args.requestType === 'refresh')) {\n            var tr = void 0;\n            var fhdrData = this.getReorderedRows(args);\n            for (var i = 0; i < fhdrData.length; i++) {\n                tr = row.render(fhdrData[parseInt(i.toString(), 10)], columns);\n                hdrfrag.appendChild(tr);\n            }\n            if (args.virtualInfo.page === 1) {\n                modelData.splice(0, this.parent.frozenRows);\n            }\n        }\n    };\n    ContentRender.prototype.getInfiniteRows = function () {\n        var rows = [];\n        if (this.parent.enableInfiniteScrolling) {\n            if (this.parent.infiniteScrollSettings.enableCache) {\n                var keys = Object.keys(this.infiniteCache);\n                for (var i = 0; i < keys.length; i++) {\n                    rows = rows.concat(this.infiniteCache[keys[parseInt(i.toString(), 10)]]);\n                }\n            }\n            else {\n                rows = this.visibleRows;\n            }\n        }\n        return rows;\n    };\n    ContentRender.prototype.getInfiniteMovableRows = function () {\n        var infiniteCacheRows = this.getCurrentBlockInfiniteRecords();\n        var infiniteRows = this.parent.enableInfiniteScrolling ? infiniteCacheRows.length ? infiniteCacheRows\n            : this.visibleRows : [];\n        return infiniteRows;\n    };\n    /**\n     * Get the content div element of grid\n     *\n     * @returns {Element} returns the element\n     */\n    ContentRender.prototype.getPanel = function () {\n        return this.contentPanel;\n    };\n    /**\n     * Set the content div element of grid\n     *\n     * @param  {Element} panel - specifies the panel\n     * @returns {void}\n     */\n    ContentRender.prototype.setPanel = function (panel) {\n        this.contentPanel = panel;\n    };\n    /**\n     * Get the content table element of grid\n     *\n     * @returns {Element} returns the element\n     */\n    ContentRender.prototype.getTable = function () {\n        return this.contentTable;\n    };\n    /**\n     * Set the content table element of grid\n     *\n     * @param  {Element} table - specifies the table\n     * @returns {void}\n     */\n    ContentRender.prototype.setTable = function (table) {\n        this.contentTable = table;\n    };\n    /**\n     * Get the Movable Row collection in the Freeze pane Grid.\n     *\n     * @returns {Row[] | HTMLCollectionOf<HTMLTableRowElement>} returns the row\n     */\n    ContentRender.prototype.getRows = function () {\n        var infiniteRows = this.getInfiniteRows();\n        return infiniteRows.length ? infiniteRows : this.rows;\n    };\n    /**\n     * Get the content table data row elements\n     *\n     * @returns {Element} returns the element\n     */\n    ContentRender.prototype.getRowElements = function () {\n        return this.rowElements;\n    };\n    /**\n     * Get the content table data row elements\n     *\n     * @param {Element[]} elements - specifies the elements\n     * @returns {void}\n     */\n    ContentRender.prototype.setRowElements = function (elements) {\n        this.rowElements = elements;\n    };\n    /**\n     * Get the header colgroup element\n     *\n     * @returns {Element} returns the element\n     */\n    ContentRender.prototype.getColGroup = function () {\n        return this.colgroup;\n    };\n    /**\n     * Set the header colgroup element\n     *\n     * @param {Element} colGroup - specifies the colgroup\n     * @returns {Element} returns the element\n     */\n    ContentRender.prototype.setColGroup = function (colGroup) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(colGroup)) {\n            colGroup.id = 'content-' + colGroup.id;\n        }\n        return this.colgroup = colGroup;\n    };\n    /**\n     * Function to hide content table column based on visible property\n     *\n     * @param {Column[]} columns - specifies the column\n     * @returns {void}\n     */\n    ContentRender.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var rows = this.getRows();\n        var testRow;\n        rows.some(function (r) { if (r.isDataRow) {\n            testRow = r;\n        } return r.isDataRow; });\n        var needFullRefresh = true;\n        if (!gObj.groupSettings.columns.length && testRow) {\n            needFullRefresh = false;\n        }\n        var tr = gObj.getDataRows();\n        var args = {};\n        var infiniteData = this.infiniteRowVisibility();\n        var contentrows = infiniteData ? infiniteData\n            : this.rows.filter(function (row) { return !row.isDetailRow; });\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[parseInt(c.toString(), 10)];\n            var idx = this.parent.getNormalizedColumnIndex(column.uid);\n            var colIdx = this.parent.getColumnIndexByUid(column.uid);\n            var displayVal = column.visible === true ? '' : 'none';\n            if (idx !== -1 && testRow && idx < testRow.cells.length) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setStyleAttribute)(this.getColGroup().childNodes[parseInt(idx.toString(), 10)], { 'display': displayVal });\n            }\n            if (!needFullRefresh) {\n                this.setDisplayNone(tr, colIdx, displayVal, contentrows);\n            }\n            if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n                this.parent.updateMediaColumns(column);\n            }\n            this.parent.invokedFromMedia = false;\n        }\n        if (needFullRefresh) {\n            this.refreshContentRows({ requestType: 'refresh' });\n        }\n        else {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.partialRefresh, { rows: contentrows, args: args });\n            if (this.parent.editSettings.showAddNewRow && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.showAddNewRowFocus, {});\n            }\n        }\n    };\n    /**\n     * @param {Object} tr - specifies the trr\n     * @param {number} idx - specifies the idx\n     * @param {string} displayVal - specifies the displayval\n     * @param {Row<Column>} rows - specifies the rows\n     * @returns {void}\n     * @hidden\n     */\n    ContentRender.prototype.setDisplayNone = function (tr, idx, displayVal, rows) {\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.setDisplayValue)(tr, idx, displayVal, rows, this.parent, this.parent.isRowDragable());\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.infiniteShowHide, { visible: displayVal, index: idx, isFreeze: this.isInfiniteFreeze });\n    };\n    ContentRender.prototype.infiniteRowVisibility = function (isFreeze) {\n        var infiniteData;\n        if (this.parent.enableInfiniteScrolling) {\n            this.isInfiniteFreeze = isFreeze;\n            if (this.parent.infiniteScrollSettings.enableCache) {\n                infiniteData = this.getCurrentBlockInfiniteRecords();\n            }\n            else {\n                infiniteData = isFreeze ? this.visibleFrozenRows : this.visibleRows;\n            }\n        }\n        return infiniteData;\n    };\n    ContentRender.prototype.colGroupRefresh = function () {\n        if (this.getColGroup()) {\n            var colGroup = this.getHeaderColGroup();\n            this.getTable().replaceChild(colGroup, this.getColGroup());\n            this.setColGroup(colGroup);\n        }\n    };\n    ContentRender.prototype.getHeaderColGroup = function () {\n        return this.parent.element.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridHeader)\n            .querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.colGroup + ':not(.e-masked-colgroup)').cloneNode(true);\n    };\n    ContentRender.prototype.initializeContentDrop = function () {\n        var gObj = this.parent;\n        this.droppable = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Droppable(gObj.element, {\n            accept: '.e-dragclone',\n            drop: this.drop\n        });\n    };\n    ContentRender.prototype.droppableDestroy = function () {\n        if (this.droppable && !this.droppable.isDestroyed) {\n            this.droppable.destroy();\n        }\n    };\n    ContentRender.prototype.canSkip = function (column, row, index) {\n        /**\n         * Skip the toggle visiblity operation when one of the following success\n         * 1. Grid has empty records\n         * 2. column visible property is unchanged\n         * 3. cell`s isVisible property is same as column`s visible property.\n         */\n        return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row) || //(1)\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.visible) || //(2)\n            row.cells[parseInt(index.toString(), 10)].visible === column.visible; //(3)\n    };\n    ContentRender.prototype.getModelGenerator = function () {\n        return this.generator = this.parent.allowGrouping ? new _services_group_model_generator__WEBPACK_IMPORTED_MODULE_6__.GroupModelGenerator(this.parent) : new _services_row_model_generator__WEBPACK_IMPORTED_MODULE_7__.RowModelGenerator(this.parent);\n    };\n    ContentRender.prototype.renderEmpty = function (tbody) {\n        this.getTable().appendChild(tbody);\n        if (this.parent.frozenRows) {\n            this.parent.getHeaderContent().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody).innerHTML = '';\n        }\n    };\n    ContentRender.prototype.setSelection = function (uid, set, clearAll) {\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.setFreezeSelection, { uid: uid, set: set, clearAll: clearAll });\n        var row = this.getRows().filter(function (row) { return clearAll || uid === row.uid; });\n        for (var j = 0; j < row.length; j++) {\n            row[parseInt(j.toString(), 10)].isSelected = set;\n            var cells = row[parseInt(j.toString(), 10)].cells;\n            for (var k = 0; k < cells.length; k++) {\n                cells[parseInt(k.toString(), 10)].isSelected = set;\n            }\n        }\n    };\n    ContentRender.prototype.getRowByIndex = function (index) {\n        index = this.getInfiniteRowIndex(index);\n        return !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(index) ? this.parent.getDataRows()[parseInt(index.toString(), 10)] : undefined;\n    };\n    ContentRender.prototype.getInfiniteRowIndex = function (index) {\n        if (this.parent.infiniteScrollSettings.enableCache && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(index)) {\n            var fRows = this.parent.frozenRows;\n            var idx = fRows > index ? 0 : fRows;\n            var firstRowIndex = parseInt(this.parent.getRows()[parseInt(idx.toString(), 10)]\n                .getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.ariaRowIndex), 10) - 1;\n            index = fRows > index ? index : (index - firstRowIndex) + fRows;\n        }\n        return index;\n    };\n    ContentRender.prototype.getVirtualRowIndex = function (index) {\n        return index;\n    };\n    ContentRender.prototype.enableAfterRender = function (e) {\n        if (e.module === 'group' && e.enable) {\n            this.generator = this.getModelGenerator();\n        }\n    };\n    ContentRender.prototype.setRowObjects = function (rows) {\n        this.rows = rows;\n    };\n    /**\n     * @param {NotifyArgs} args - specifies the args\n     * @returns {void}\n     * @hidden\n     */\n    ContentRender.prototype.immutableModeRendering = function (args) {\n        var _this = this;\n        if (args === void 0) { args = {}; }\n        var gObj = this.parent;\n        gObj.hideSpinner();\n        var key = gObj.getPrimaryKeyFieldNames()[0];\n        var oldKeys = {};\n        var newKeys = {};\n        var newRowObjs = [];\n        var oldIndexes = {};\n        var oldRowObjs = gObj.getRowsObject().slice();\n        var batchChangeKeys = this.getBatchEditedRecords(key, oldRowObjs);\n        var newIndexes = {};\n        var hasBatch = Object.keys(batchChangeKeys).length !== 0;\n        if (gObj.getContent().querySelector('.e-emptyrow') || args.requestType === 'reorder'\n            || this.parent.groupSettings.columns.length) {\n            this.refreshContentRows(args);\n        }\n        else {\n            if (gObj.currentViewData.length === 0) {\n                return;\n            }\n            var oldRowElements = {};\n            var tbody = gObj.createElement(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody, { attrs: { role: 'rowgroup' } });\n            var dataSource = gObj.currentViewData;\n            var trs = [].slice.call(this.getTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody).children);\n            if (this.prevCurrentView.length) {\n                var prevLen = this.prevCurrentView.length;\n                var currentLen = dataSource.length;\n                if (prevLen === currentLen) {\n                    for (var i = 0; i < currentLen; i++) {\n                        if (this.parent.editSettings.mode === 'Batch'\n                            && trs[parseInt(i.toString(), 10)].classList.contains('e-insertedrow')) {\n                            trs.splice(i, 1);\n                            --i;\n                            continue;\n                        }\n                        newKeys[dataSource[parseInt(i.toString(), 10)][\"\" + key]] = oldKeys[this.prevCurrentView[parseInt(i.toString(), 10)][\"\" + key]] = i;\n                        newIndexes[parseInt(i.toString(), 10)] = dataSource[parseInt(i.toString(), 10)][\"\" + key];\n                        oldRowElements[oldRowObjs[parseInt(i.toString(), 10)].uid] = trs[parseInt(i.toString(), 10)];\n                        oldIndexes[parseInt(i.toString(), 10)] = this.prevCurrentView[parseInt(i.toString(), 10)][\"\" + key];\n                    }\n                }\n                else {\n                    for (var i = 0; i < currentLen; i++) {\n                        newKeys[dataSource[parseInt(i.toString(), 10)][\"\" + key]] = i;\n                        newIndexes[parseInt(i.toString(), 10)] = dataSource[parseInt(i.toString(), 10)][\"\" + key];\n                    }\n                    for (var i = 0; i < prevLen; i++) {\n                        if (this.parent.editSettings.mode === 'Batch'\n                            && trs[parseInt(i.toString(), 10)].classList.contains('e-insertedrow')) {\n                            trs.splice(i, 1);\n                            --i;\n                            continue;\n                        }\n                        oldRowElements[oldRowObjs[parseInt(i.toString(), 10)].uid] = trs[parseInt(i.toString(), 10)];\n                        oldKeys[this.prevCurrentView[parseInt(i.toString(), 10)][\"\" + key]] = i;\n                        oldIndexes[parseInt(i.toString(), 10)] = this.prevCurrentView[parseInt(i.toString(), 10)][\"\" + key];\n                    }\n                }\n            }\n            for (var i = 0; i < dataSource.length; i++) {\n                var oldIndex = oldKeys[dataSource[parseInt(i.toString(), 10)][\"\" + key]];\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(oldIndex)) {\n                    var isEqual = false;\n                    if (this.parent.enableDeepCompare) {\n                        isEqual = this.objectEqualityChecker(this.prevCurrentView[parseInt(oldIndex.toString(), 10)], dataSource[parseInt(i.toString(), 10)]);\n                    }\n                    var tr = oldRowElements[oldRowObjs[parseInt(oldIndex.toString(), 10)]\n                        .uid];\n                    newRowObjs.push(oldRowObjs[parseInt(oldIndex.toString(), 10)]);\n                    if (this.rowElements[parseInt(oldIndex.toString(), 10)] && this.rowElements[parseInt(oldIndex.toString(), 10)].getAttribute('data-uid') === newRowObjs[parseInt(i.toString(), 10)].uid\n                        && ((hasBatch && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(batchChangeKeys[newIndexes[parseInt(i.toString(), 10)]]))\n                            || (!hasBatch && (isEqual\n                                || this.prevCurrentView[parseInt(oldIndex.toString(), 10)] === dataSource[parseInt(i.toString(), 10)])))) {\n                        if (oldIndex !== i) {\n                            this.refreshImmutableContent(i, tr, newRowObjs[parseInt(i.toString(), 10)]);\n                        }\n                        tbody.appendChild(tr);\n                        continue;\n                    }\n                    if ((hasBatch && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(batchChangeKeys[newIndexes[parseInt(i.toString(), 10)]]))\n                        || (!this.parent.enableDeepCompare\n                            && dataSource[parseInt(i.toString(), 10)] !== this.prevCurrentView[parseInt(oldIndex.toString(), 10)])\n                        || (this.parent.enableDeepCompare && !isEqual)) {\n                        oldRowObjs[parseInt(oldIndex.toString(), 10)].setRowValue(dataSource[parseInt(i.toString(), 10)]);\n                    }\n                    tbody.appendChild(tr);\n                    this.refreshImmutableContent(i, tr, newRowObjs[parseInt(i.toString(), 10)]);\n                }\n                else {\n                    var row = new _row_renderer__WEBPACK_IMPORTED_MODULE_4__.RowRenderer(this.serviceLocator, null, gObj);\n                    var args_1 = { startIndex: i };\n                    var modelData = this.generator.generateRows([dataSource[parseInt(i.toString(), 10)]], args_1);\n                    newRowObjs.push(modelData[0]);\n                    var tr = row.render(modelData[0], gObj.getColumns());\n                    tbody.appendChild(tr);\n                    this.refreshImmutableContent(i, tr, newRowObjs[parseInt(i.toString(), 10)]);\n                }\n            }\n            this.rows = newRowObjs;\n            this.rowElements = [].slice.call(tbody.children);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.getTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.tbody));\n            this.getTable().appendChild(tbody);\n            this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.dataBound, {}, function () {\n                if (_this.parent.allowTextWrap) {\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.freezeRender, { case: 'textwrap' });\n                }\n            });\n            if (args) {\n                var action = (args.requestType || '').toLowerCase() + '-complete';\n                this.parent.notify(action, args);\n            }\n        }\n    };\n    ContentRender.prototype.objectEqualityChecker = function (old, next) {\n        var keys = Object.keys(old);\n        var isEqual = true;\n        for (var i = 0; i < keys.length; i++) {\n            if (old[keys[parseInt(i.toString(), 10)]] !== next[keys[parseInt(i.toString(), 10)]]) {\n                var isDate = old[keys[parseInt(i.toString(), 10)]] instanceof Date\n                    && next[keys[parseInt(i.toString(), 10)]] instanceof Date;\n                if (!isDate || (old[keys[parseInt(i.toString(), 10)]]\n                    .getTime() !== next[keys[parseInt(i.toString(), 10)]].getTime())) {\n                    isEqual = false;\n                    break;\n                }\n            }\n        }\n        return isEqual;\n    };\n    ContentRender.prototype.getBatchEditedRecords = function (primaryKey, rows) {\n        var keys = {};\n        var changes = this.parent.getBatchChanges();\n        var changedRecords = [];\n        var addedRecords = [];\n        if (Object.keys(changes).length) {\n            changedRecords = changes.changedRecords;\n            addedRecords = changes.addedRecords;\n        }\n        var args = { cancel: false };\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.immutableBatchCancel, { rows: rows, args: args });\n        if (addedRecords.length) {\n            if (this.parent.editSettings.newRowPosition === 'Bottom') {\n                rows.splice(rows.length - 1, addedRecords.length);\n            }\n            else {\n                if (!args.cancel) {\n                    rows.splice(0, addedRecords.length);\n                }\n            }\n        }\n        for (var i = 0; i < changedRecords.length; i++) {\n            keys[changedRecords[parseInt(i.toString(), 10)][\"\" + primaryKey]] = i;\n        }\n        return keys;\n    };\n    ContentRender.prototype.refreshImmutableContent = function (index, tr, row) {\n        row.isAltRow = this.parent.enableAltRow ? index % 2 !== 0 : false;\n        if (row.isAltRow) {\n            tr.classList.add('e-altrow');\n        }\n        else {\n            tr.classList.remove('e-altrow');\n        }\n        row.index = index;\n        row.edit = undefined;\n        row.isDirty = false;\n        tr.setAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.ariaRowIndex, (index + 1).toString());\n        this.updateCellIndex(tr, index);\n    };\n    ContentRender.prototype.updateCellIndex = function (rowEle, index) {\n        for (var i = 0; i < rowEle.cells.length; i++) {\n            rowEle.cells[parseInt(i.toString(), 10)].setAttribute('index', index.toString());\n        }\n    };\n    return ContentRender;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9jb250ZW50LXJlbmRlcmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFpRDtBQUNnQjtBQUNzQjtBQUMwRTtBQUN0SDtBQUNFO0FBQ1c7QUFDWTtBQUNJO0FBQ0g7QUFDakI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msc0RBQWlCLElBQUksb0RBQW9EO0FBQ3pHLFlBQVksNERBQU07QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0VBQStFLDBEQUFnQjtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsOEJBQThCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELGNBQWM7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLHdEQUFtQixJQUFJLHVCQUF1QjtBQUNsRjtBQUNBLHdDQUF3Qyw4REFBeUIsSUFBSTtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxxREFBZ0IsSUFBSTtBQUN6RTtBQUNBLDREQUE0RCx3REFBbUIsSUFBSSxrQkFBa0I7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwyQkFBMkI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLCtEQUFxQjtBQUM3QztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUJBQXlCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUN3QiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL3JlbmRlcmVyL2NvbnRlbnQtcmVuZGVyZXIuanM/NmMzZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEcm9wcGFibGUgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBpc051bGxPclVuZGVmaW5lZCwgZXh0ZW5kIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgc2V0U3R5bGVBdHRyaWJ1dGUsIHJlbW92ZSwgdXBkYXRlQmxhem9yVGVtcGxhdGUgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBnZXRVcGRhdGVVc2luZ1JhZiwgYXBwZW5kQ2hpbGRyZW4sIHNldERpc3BsYXlWYWx1ZSwgY2xlYXJSZWFjdFZ1ZVRlbXBsYXRlcywgZ2V0U2Nyb2xsQmFyV2lkdGgsIGdldFNjcm9sbFdpZHRoLCBnZXRUcmFuc2Zvcm1WYWx1ZXMgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0ICogYXMgZXZlbnRzIGZyb20gJy4uL2Jhc2UvY29uc3RhbnQnO1xuaW1wb3J0IHsgUm93UmVuZGVyZXIgfSBmcm9tICcuL3Jvdy1yZW5kZXJlcic7XG5pbXBvcnQgeyBDZWxsTWVyZ2VSZW5kZXIgfSBmcm9tICcuL2NlbGwtbWVyZ2UtcmVuZGVyZXInO1xuaW1wb3J0IHsgUm93TW9kZWxHZW5lcmF0b3IgfSBmcm9tICcuLi9zZXJ2aWNlcy9yb3ctbW9kZWwtZ2VuZXJhdG9yJztcbmltcG9ydCB7IEdyb3VwTW9kZWxHZW5lcmF0b3IgfSBmcm9tICcuLi9zZXJ2aWNlcy9ncm91cC1tb2RlbC1nZW5lcmF0b3InO1xuaW1wb3J0IHsgaXNHcm91cEFkYXB0aXZlLCBhZGRGaXhlZENvbHVtbkJvcmRlciB9IGZyb20gJy4uL2Jhc2UvdXRpbCc7XG5pbXBvcnQgKiBhcyBsaXRlcmFscyBmcm9tICcuLi9iYXNlL3N0cmluZy1saXRlcmFscyc7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgdmFsaWQtanNkb2MsIGpzZG9jL3JlcXVpcmUtcGFyYW0sIGpzZG9jL3JlcXVpcmUtcmV0dXJuc1xuLyoqXG4gKiBDb250ZW50IG1vZHVsZSBpcyB1c2VkIHRvIHJlbmRlciBncmlkIGNvbnRlbnRcbiAqXG4gKiBAaGlkZGVuXG4gKi9cbnZhciBDb250ZW50UmVuZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIGZvciBjb250ZW50IHJlbmRlcmVyIG1vZHVsZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtJR3JpZH0gcGFyZW50IC0gc3BlY2lmaWVzIHRoZSBJZ3JpZFxuICAgICAqIEBwYXJhbSB7U2VydmljZUxvY2F0b3J9IHNlcnZpY2VMb2NhdG9yIC0gc3BlY2lmaWVzIHRoZSBzZXJ2aWNlIGxvY2F0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBDb250ZW50UmVuZGVyKHBhcmVudCwgc2VydmljZUxvY2F0b3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5yb3dzID0gW107XG4gICAgICAgIHRoaXMuZnJlZXplUm93cyA9IFtdO1xuICAgICAgICB0aGlzLm1vdmFibGVSb3dzID0gW107XG4gICAgICAgIHRoaXMuZnJlZXplUm93RWxlbWVudHMgPSBbXTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgdGhpcy5jdXJyZW50SW5mbyA9IHt9O1xuICAgICAgICAvKiogQGhpZGRlbiAqL1xuICAgICAgICB0aGlzLnByZXZDdXJyZW50VmlldyA9IFtdO1xuICAgICAgICB0aGlzLmlzTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5kcm9wID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmNvbHVtbkRyb3AsIHsgdGFyZ2V0OiBlLnRhcmdldCwgZHJvcHBlZEVsZW1lbnQ6IGUuZHJvcHBlZEVsZW1lbnQgfSk7XG4gICAgICAgICAgICByZW1vdmUoZS5kcm9wcGVkRWxlbWVudCk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIHRoaXMuaW5maW5pdGVDYWNoZSA9IHt9O1xuICAgICAgICAvKiogQGhpZGRlbiAqL1xuICAgICAgICB0aGlzLnZpc2libGVSb3dzID0gW107XG4gICAgICAgIHRoaXMudmlzaWJsZUZyb3plblJvd3MgPSBbXTtcbiAgICAgICAgdGhpcy5yaWdodEZyZWV6ZVJvd3MgPSBbXTtcbiAgICAgICAgdGhpcy5pc0FkZFJvd3MgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc0luZmluaXRlRnJlZXplID0gZmFsc2U7XG4gICAgICAgIHRoaXMudXNlR3JvdXBDYWNoZSA9IGZhbHNlO1xuICAgICAgICAvKiogQGhpZGRlbiAqL1xuICAgICAgICB0aGlzLnRlbXBGcmVlemVSb3dzID0gW107XG4gICAgICAgIHRoaXMucmFmQ2FsbGJhY2sgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIGFyZyA9IGFyZ3M7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmFyaWFTZXJ2aWNlLnNldEJ1c3koX3RoaXMuZ2V0UGFuZWwoKS5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmNvbnRlbnQpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByb3dzID0gX3RoaXMucm93cy5zbGljZSgwKTtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfdGhpcy52aXNpYmxlUm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFJvd3NJbkxhenlHcm91cChfdGhpcy52aXNpYmxlUm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJvd3MgPSBfdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJldlBhZ2UgPSBhcmcucHJldlBhZ2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZSAmJiBwcmV2UGFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1heEJsb2NrID0gX3RoaXMucGFyZW50LmluZmluaXRlU2Nyb2xsU2V0dGluZ3MubWF4QmxvY2tzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJvd0lkeCA9IChwYXJzZUludChfdGhpcy5yb3dFbGVtZW50c1swXS5nZXRBdHRyaWJ1dGUoJ2FyaWEtcm93aW5kZXgnKSwgMTApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydElkeCA9IE1hdGguY2VpbChyb3dJZHggLyBfdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLnBhZ2VTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjb3VudCA9IHN0YXJ0SWR4OyBpIDwgbWF4QmxvY2s7IGkrKywgY291bnQrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pbmZpbml0ZUNhY2hlW3BhcnNlSW50KGNvdW50LnRvU3RyaW5nKCksIDEwKV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93cyA9IHJvd3MuY29uY2F0KF90aGlzLmluZmluaXRlQ2FjaGVbcGFyc2VJbnQoY291bnQudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmNvbnRlbnRSZWFkeSwgeyByb3dzOiByb3dzLCBhcmdzOiBhcmcgfSk7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJiBfdGhpcy5wYXJlbnQuYWRkTmV3Um93Rm9jdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50Lm5vdGlmeShldmVudHMuc2hvd0FkZE5ld1Jvd0ZvY3VzLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5hZGROZXdSb3dGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmF1dG9GaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LnByZXZlbnRBZGp1c3RDb2x1bW5zKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghX3RoaXMucGFyZW50LmlzSW5pdGlhbExvYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LmZvY3VzTW9kdWxlLnNldEZpcnN0Rm9jdXNhYmxlVGFiSW5kZXgoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5pc01hbnVhbFJlZnJlc2ggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyAmJiBfdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZyAmJiBhcmdzLnJlcXVlc3RUeXBlID09PSAnc29ydGluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbE1vZHVsZVsnZ3JvdXBDYXB0aW9uQWN0aW9uJ10gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzUmVhY3RDaGlsZCA9IF90aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzICYmIF90aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmogJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmouaXNSZWFjdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChfdGhpcy5wYXJlbnQuaXNSZWFjdCB8fCBpc1JlYWN0Q2hpbGQpICYmIF90aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXRlbXBsYXRlY2VsbCcpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc1JlZl8xID0gX3RoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzUmVmXzEucGFyZW50LnJlbmRlclRlbXBsYXRlcyhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1JlZl8xLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5kYXRhQm91bmQsIHt9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzUmVmXzEucGFyZW50LmFsbG93VGV4dFdyYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNSZWZfMS5wYXJlbnQubm90aWZ5KGV2ZW50cy5mcmVlemVSZW5kZXIsIHsgY2FzZTogJ3RleHR3cmFwJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQudHJpZ2dlcihldmVudHMuZGF0YUJvdW5kLCB7fSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuYWxsb3dUZXh0V3JhcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5mcmVlemVSZW5kZXIsIHsgY2FzZTogJ3RleHR3cmFwJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmFsbG93VGV4dFdyYXAgJiYgX3RoaXMucGFyZW50LmhlaWdodCA9PT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmdldENvbnRlbnRUYWJsZSgpLnNjcm9sbEhlaWdodCA+IF90aGlzLnBhcmVudC5nZXRDb250ZW50KCkuY2xpZW50SGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LnNjcm9sbE1vZHVsZS5zZXRQYWRkaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuc2Nyb2xsTW9kdWxlLnJlbW92ZVBhZGRpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYXJnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSAoYXJnLnJlcXVlc3RUeXBlIHx8ICcnKS50b0xvd2VyQ2FzZSgpICsgJy1jb21wbGV0ZSc7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoYWN0aW9uLCBhcmcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2JhdGNoc2F2ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MuY2FuY2VsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQudHJpZ2dlcihldmVudHMuYWN0aW9uQ29tcGxldGUsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuaGlkZVNwaW5uZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTG9jYXRvciA9IHNlcnZpY2VMb2NhdG9yO1xuICAgICAgICB0aGlzLndpZHRoU2VydmljZSA9IHNlcnZpY2VMb2NhdG9yLmdldFNlcnZpY2UoJ3dpZHRoU2VydmljZScpO1xuICAgICAgICB0aGlzLmFyaWFTZXJ2aWNlID0gdGhpcy5zZXJ2aWNlTG9jYXRvci5nZXRTZXJ2aWNlKCdhcmlhU2VydmljZScpO1xuICAgICAgICB0aGlzLnBhcmVudC5lbmFibGVEZWVwQ29tcGFyZSA9IHRoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpO1xuICAgICAgICB0aGlzLmdlbmVyYXRvciA9IHRoaXMuZ2V0TW9kZWxHZW5lcmF0b3IoKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJiAhdGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb25cbiAgICAgICAgICAgICYmICF0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuY29sdW1uVmlzaWJpbGl0eUNoYW5nZWQsIHRoaXMuc2V0VmlzaWJsZSwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLmNvbEdyb3VwUmVmcmVzaCwgdGhpcy5jb2xHcm91cFJlZnJlc2gsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMudWlVcGRhdGUsIHRoaXMuZW5hYmxlQWZ0ZXJSZW5kZXIsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMucmVmcmVzaEluZmluaXRlTW9kZUJsb2NrcywgdGhpcy5yZWZyZXNoQ29udGVudFJvd3MsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuYmVmb3JlQ2VsbEZvY3VzZWQsIHRoaXMuYmVmb3JlQ2VsbEZvY3VzZWQsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuZGVzdHJveSwgdGhpcy5kcm9wcGFibGVEZXN0cm95LCB0aGlzKTtcbiAgICB9XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuYmVmb3JlQ2VsbEZvY3VzZWQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoZS5ieUtleSAmJiAoZS5rZXlBcmdzLmFjdGlvbiA9PT0gJ3VwQXJyb3cnIHx8IGUua2V5QXJncy5hY3Rpb24gPT09ICdkb3duQXJyb3cnKSkge1xuICAgICAgICAgICAgdGhpcy5wcmVzc2VkS2V5ID0gZS5rZXlBcmdzLmFjdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJlc3NlZEtleSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVuZGVyIGdyaWQgY29udGVudCBkaXZcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLnJlbmRlclBhbmVsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgZGl2ID0gdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmdyaWRDb250ZW50KTtcbiAgICAgICAgaWYgKGRpdikge1xuICAgICAgICAgICAgdGhpcy5hcmlhU2VydmljZS5zZXRPcHRpb25zKHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5jb250ZW50KSwgeyBidXN5OiBmYWxzZSB9KTtcbiAgICAgICAgICAgIHRoaXMuc2V0UGFuZWwoZGl2KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBkaXYgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogbGl0ZXJhbHMuZ3JpZENvbnRlbnQgfSk7XG4gICAgICAgIHZhciBpbm5lckRpdiA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogbGl0ZXJhbHMuY29udGVudFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5hcmlhU2VydmljZS5zZXRPcHRpb25zKGlubmVyRGl2LCB7IGJ1c3k6IGZhbHNlIH0pO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgdGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVySG9yaXpvbnRhbFNjcm9sbGJhcihkaXYpO1xuICAgICAgICAgICAgaW5uZXJEaXYuY2xhc3NMaXN0LmFkZCgnZS12aXJ0dWFsLWNvbnRlbnQnKTtcbiAgICAgICAgfVxuICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoaW5uZXJEaXYpO1xuICAgICAgICB0aGlzLnNldFBhbmVsKGRpdik7XG4gICAgICAgIGdPYmouZWxlbWVudC5hcHBlbmRDaGlsZChkaXYpO1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUucmVuZGVySG9yaXpvbnRhbFNjcm9sbGJhciA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtbW92YWJsZXNjcm9sbGJhcicgfSk7XG4gICAgICAgIHZhciBjaGlsZCA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnZS1tb3ZhYmxlY2hpbGQnIH0pO1xuICAgICAgICB2YXIgc2Nyb2xsYmFySGVpZ2h0ID0gZ2V0U2Nyb2xsQmFyV2lkdGgoKS50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnNldFNjcm9sbGJhckhlaWdodChjaGlsZCwgc2Nyb2xsYmFySGVpZ2h0KTtcbiAgICAgICAgdGhpcy5zZXRTY3JvbGxiYXJIZWlnaHQocGFyZW50LCBzY3JvbGxiYXJIZWlnaHQpO1xuICAgICAgICBwYXJlbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKHBhcmVudCk7XG4gICAgfTtcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5zZXRTY3JvbGxiYXJIZWlnaHQgPSBmdW5jdGlvbiAoZWxlLCBoZWlnaHQpIHtcbiAgICAgICAgZWxlLnN0eWxlLm1pbkhlaWdodCA9IGhlaWdodCArICdweCc7XG4gICAgICAgIGVsZS5zdHlsZS5tYXhIZWlnaHQgPSBoZWlnaHQgKyAncHgnO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVuZGVyIGdyaWQgY29udGVudCB0YWJsZVxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUucmVuZGVyVGFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb250ZW50RGl2ID0gdGhpcy5nZXRQYW5lbCgpO1xuICAgICAgICB2YXIgdmlydHVhbFRhYmxlID0gY29udGVudERpdi5xdWVyeVNlbGVjdG9yKCcuZS12aXJ0dWFsdGFibGUnKTtcbiAgICAgICAgdmFyIHZpcnR1YWxUcmFjayA9IGNvbnRlbnREaXYucXVlcnlTZWxlY3RvcignLmUtdmlydHVhbHRyYWNrJyk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiAhaXNOdWxsT3JVbmRlZmluZWQodmlydHVhbFRhYmxlKSAmJiAhaXNOdWxsT3JVbmRlZmluZWQodmlydHVhbFRyYWNrKSkge1xuICAgICAgICAgICAgcmVtb3ZlKHZpcnR1YWxUYWJsZSk7XG4gICAgICAgICAgICByZW1vdmUodmlydHVhbFRyYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBjb250ZW50RGl2LmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlQ29udGVudFRhYmxlKCdfY29udGVudF90YWJsZScpKTtcbiAgICAgICAgdGhpcy5zZXRUYWJsZShjb250ZW50RGl2LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMudGFibGUpKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LnNlbGVjdGlvblNldHRpbmdzLnR5cGUgPT09ICdNdWx0aXBsZScpIHtcbiAgICAgICAgICAgIHRoaXMuYXJpYVNlcnZpY2Uuc2V0T3B0aW9ucyh0aGlzLnBhcmVudC5lbGVtZW50LCB7XG4gICAgICAgICAgICAgICAgbXVsdGlzZWxlY3RhYmxlOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRpYWxpemVDb250ZW50RHJvcCgpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuZ2V0SGVhZGVyQ29udGVudCgpLmNsYXNzTGlzdC5hZGQoJ2UtZnJvemVuaGRyJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoZSBmdW5jdGlvbiBpcyB1c2VkIHRvIGNyZWF0ZSBjb250ZW50IHRhYmxlIGVsZW1lbnRzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSBzcGVjaWZpZXMgdGhlIGlkXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuY3JlYXRlQ29udGVudFRhYmxlID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHZhciBpbm5lckRpdiA9IHRoaXMuZ2V0UGFuZWwoKS5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgaWYgKHRoaXMuZ2V0VGFibGUoKSkge1xuICAgICAgICAgICAgcmVtb3ZlKHRoaXMuZ2V0VGFibGUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRhYmxlID0gaW5uZXJEaXYucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy50YWJsZSkgPyBpbm5lckRpdi5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLnRhYmxlKSA6XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCd0YWJsZScsIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IGxpdGVyYWxzLnRhYmxlLCBhdHRyczoge1xuICAgICAgICAgICAgICAgICAgICByb2xlOiAncHJlc2VudGF0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyBpZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB0YWJsZS5zdHlsZS5jc3NUZXh0ID0gJ2JvcmRlci1jb2xsYXBzZTogc2VwYXJhdGU7IGJvcmRlci1zcGFjaW5nOiAuMjVweDsnO1xuICAgICAgICB0aGlzLnNldENvbEdyb3VwKHRoaXMucGFyZW50LmdldEhlYWRlclRhYmxlKCkucXVlcnlTZWxlY3RvcihsaXRlcmFscy5jb2xHcm91cCkuY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgICAgdGFibGUuYXBwZW5kQ2hpbGQodGhpcy5nZXRDb2xHcm91cCgpKTtcbiAgICAgICAgdGFibGUuYXBwZW5kQ2hpbGQodGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudChsaXRlcmFscy50Ym9keSwgeyBhdHRyczogeyByb2xlOiAncm93Z3JvdXAnIH0gfSkpO1xuICAgICAgICBpbm5lckRpdi5hcHBlbmRDaGlsZCh0YWJsZSk7XG4gICAgICAgIHJldHVybiBpbm5lckRpdjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlZnJlc2ggdGhlIGNvbnRlbnQgb2YgdGhlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vdGlmeUFyZ3N9IGFyZ3MgLSBzcGVjaWZpZXMgdGhlIGFyZ3NcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWZ1bmMtYm9keS1sZW5ndGhcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5yZWZyZXNoQ29udGVudFJvd3MgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoYXJncyA9PT0gdm9pZCAwKSB7IGFyZ3MgPSB7fTsgfVxuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAoZ09iai5jdXJyZW50Vmlld0RhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdPYmouZWRpdFNldHRpbmdzICYmIGdPYmouZWRpdE1vZHVsZSAmJiBnT2JqLmVkaXRTZXR0aW5ncy5tb2RlID09PSAnQmF0Y2gnICYmIGdPYmouZWRpdE1vZHVsZS5mb3JtT2JqXG4gICAgICAgICAgICAmJiBnT2JqLmVkaXRTZXR0aW5ncy5zaG93Q29uZmlybURpYWxvZyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGdPYmouZWRpdE1vZHVsZS5kZXN0cm95Rm9ybSgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkYXRhU291cmNlID0gdGhpcy5jdXJyZW50TW92YWJsZVJvd3MgfHwgZ09iai5jdXJyZW50Vmlld0RhdGE7XG4gICAgICAgIHZhciBpc1JlYWN0ID0gZ09iai5pc1JlYWN0ICYmICFpc051bGxPclVuZGVmaW5lZChnT2JqLnJvd1RlbXBsYXRlKTtcbiAgICAgICAgdmFyIGlzUmVhY3RQcmludEdyaWQgPSB0aGlzLnBhcmVudC5wcmludEdyaWRQYXJlbnQgJiYgdGhpcy5wYXJlbnQucHJpbnRHcmlkUGFyZW50LmlzUmVhY3Q7XG4gICAgICAgIHZhciBmcmFnID0gaXNSZWFjdCB8fCBpc1JlYWN0UHJpbnRHcmlkID8gZ09iai5jcmVhdGVFbGVtZW50KGxpdGVyYWxzLnRib2R5LCB7IGF0dHJzOiB7IHJvbGU6ICdyb3dncm91cCcgfSB9KSA6IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgaWYgKCF0aGlzLmluaXRpYWxQYWdlUmVjb3Jkcykge1xuICAgICAgICAgICAgdGhpcy5pbml0aWFsUGFnZVJlY29yZHMgPSBleHRlbmQoW10sIGRhdGFTb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBoZHJmcmFnID0gaXNSZWFjdCA/IGdPYmouY3JlYXRlRWxlbWVudChsaXRlcmFscy50Ym9keSwgeyBhdHRyczogeyByb2xlOiAncm93Z3JvdXAnIH0gfSkgOiBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIHZhciByZWZGcmFnO1xuICAgICAgICB2YXIgcmVmSGRyZnJhZztcbiAgICAgICAgaWYgKChnT2JqLmlzUmVhY3QgfHwgaXNSZWFjdFByaW50R3JpZCkgJiYgZ09iai5yb3dUZW1wbGF0ZSkge1xuICAgICAgICAgICAgcmVmRnJhZyA9IGZyYWc7XG4gICAgICAgICAgICByZWZIZHJmcmFnID0gaGRyZnJhZztcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29sdW1ucyA9IGdPYmouZ2V0Q29sdW1ucygpO1xuICAgICAgICB2YXIgdHI7XG4gICAgICAgIHZhciBoZHJUYm9keTtcbiAgICAgICAgdmFyIHRyRWxlbWVudDtcbiAgICAgICAgdmFyIHJvdyA9IG5ldyBSb3dSZW5kZXJlcih0aGlzLnNlcnZpY2VMb2NhdG9yLCBudWxsLCB0aGlzLnBhcmVudCk7XG4gICAgICAgIHZhciBpc0luZmluaXRlU2Nyb2xsID0gdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmdcbiAgICAgICAgICAgICYmIGFyZ3MucmVxdWVzdFR5cGUgPT09ICdpbmZpbml0ZVNjcm9sbCc7XG4gICAgICAgIHZhciBpc0NvbHVtblZpcnR1YWxJbmZpbml0ZVByb2Nlc3MgPSB0aGlzLmlzSW5maW5pdGVDb2x1bW52aXJ0dWFsaXphdGlvbigpICYmIGFyZ3MucmVxdWVzdFR5cGUgIT09ICd2aXJ0dWFsc2Nyb2xsJztcbiAgICAgICAgdmFyIGluZmluaXRlRGV0YWlsID0gZ09iai5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyAmJiAoZ09iai5jaGlsZEdyaWQgfHwgZ09iai5kZXRhaWxUZW1wbGF0ZSkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIHZhciBpbmZpbml0ZURldGFpbE1vZGlmaWVkID0gaW5maW5pdGVEZXRhaWwgJiYgKChhcmdzLmFjdGlvbiA9PT0gJ2FkZCcgJiYgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3NhdmUnKVxuICAgICAgICAgICAgfHwgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2RlbGV0ZScpO1xuICAgICAgICBpZiAoaW5maW5pdGVEZXRhaWxNb2RpZmllZCkge1xuICAgICAgICAgICAgYXJncy5zdGFydEluZGV4ID0gMDtcbiAgICAgICAgICAgIGdPYmoubm90aWZ5KGV2ZW50cy5kZXRhY2hEZXRhaWxUZW1wbGF0ZSwge30pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghKGlzSW5maW5pdGVTY3JvbGwgJiYgKGdPYmouY2hpbGRHcmlkIHx8IGdPYmouZGV0YWlsVGVtcGxhdGUpICYmICFnT2JqLmluZmluaXRlU2Nyb2xsU2V0dGluZ3MuZW5hYmxlQ2FjaGUpKSB7XG4gICAgICAgICAgICBpZiAoaW5maW5pdGVEZXRhaWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbE1vZHVsZS5pbmZpbml0ZURldGFpbERlc3Ryb3kgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ09iai5ub3RpZnkoZXZlbnRzLmRlc3Ryb3lDaGlsZEdyaWQsIGlzSW5maW5pdGVTY3JvbGwgJiYgKGdPYmouY2hpbGRHcmlkIHx8IGdPYmouZGV0YWlsVGVtcGxhdGUpXG4gICAgICAgICAgICAgICAgJiYgZ09iai5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlID8gYXJncyA6IHt9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJvd0VsZW1lbnRzID0gW107XG4gICAgICAgIHRoaXMucm93cyA9IFtdO1xuICAgICAgICB0aGlzLnRlbXBGcmVlemVSb3dzID0gW107XG4gICAgICAgIHZhciB0YmR5O1xuICAgICAgICB2YXIgdGFibGVOYW1lO1xuICAgICAgICB2YXIgaXNHcm91cEZyb3plbkhkciA9IHRoaXMucGFyZW50LmZyb3plblJvd3MgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgaWYgKGlzR3JvdXBBZGFwdGl2ZShnT2JqKSkge1xuICAgICAgICAgICAgaWYgKFsnc29ydGluZycsICdmaWx0ZXJpbmcnLCAnc2VhcmNoaW5nJywgJ2dyb3VwaW5nJywgJ3VuZ3JvdXBpbmcnLCAncmVvcmRlcicsICdzYXZlJywgJ2RlbGV0ZSddXG4gICAgICAgICAgICAgICAgLnNvbWUoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBhcmdzLnJlcXVlc3RUeXBlID09PSB2YWx1ZTsgfSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVtcHR5VmNSb3dzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1vZGVsRGF0YTtcbiAgICAgICAgbW9kZWxEYXRhID0gdGhpcy5jaGVja0NhY2hlKG1vZGVsRGF0YSwgYXJncyk7XG4gICAgICAgIGlmICghdGhpcy5pc0FkZFJvd3MgJiYgIXRoaXMudXNlR3JvdXBDYWNoZSkge1xuICAgICAgICAgICAgbW9kZWxEYXRhID0gdGhpcy5nZW5lcmF0b3IuZ2VuZXJhdGVSb3dzKGRhdGFTb3VyY2UsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0R3JvdXBDYWNoZShtb2RlbERhdGEsIGFyZ3MpO1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnNldEluZmluaXRlQ2FjaGUsIHsgaXNJbmZpbml0ZVNjcm9sbDogaXNJbmZpbml0ZVNjcm9sbCwgbW9kZWxEYXRhOiBtb2RlbERhdGEsIGFyZ3M6IGFyZ3MgfSk7XG4gICAgICAgIHZhciBpc0Zyb3plbkxlZnQgPSBmYWxzZTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgdmFyIHJlZ2lzdGVyZWRUZW1wbGF0ZXMgPSB0aGlzLnBhcmVudC5yZWdpc3RlcmVkVGVtcGxhdGU7XG4gICAgICAgIGlmICghKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdpbmZpbml0ZVNjcm9sbCcgJiYgIXRoaXMucGFyZW50LmluZmluaXRlU2Nyb2xsU2V0dGluZ3MuZW5hYmxlQ2FjaGUpICYmIHJlZ2lzdGVyZWRUZW1wbGF0ZXNcbiAgICAgICAgICAgICYmIHJlZ2lzdGVyZWRUZW1wbGF0ZXMudGVtcGxhdGUgJiYgIWFyZ3MuaXNGcm96ZW4gJiYgIWlzRnJvemVuTGVmdCkge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZXRvY2xlYXIgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVnaXN0ZXJlZFRlbXBsYXRlcy50ZW1wbGF0ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcmVnaXN0ZXJlZFRlbXBsYXRlcy50ZW1wbGF0ZVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ucm9vdE5vZGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChyZWdpc3RlcmVkVGVtcGxhdGVzLnRlbXBsYXRlW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJvb3ROb2Rlc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0ucGFyZW50Tm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRldG9jbGVhci5wdXNoKHJlZ2lzdGVyZWRUZW1wbGF0ZXMudGVtcGxhdGVbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucGFyZW50LmRlc3Ryb3lUZW1wbGF0ZShbJ3RlbXBsYXRlJ10sIHRlbXBsYXRldG9jbGVhcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCh0aGlzLnBhcmVudC5pc1JlYWN0IHx8IHRoaXMucGFyZW50LmlzVnVlKSAmJiAhKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdpbmZpbml0ZVNjcm9sbCcgJiYgIXRoaXMucGFyZW50LmluZmluaXRlU2Nyb2xsU2V0dGluZ3MuZW5hYmxlQ2FjaGUpICYmICFhcmdzLmlzRnJvemVuKSB7XG4gICAgICAgICAgICB2YXIgdGVtcGxhdGVzID0gW1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmlzVnVlID8gJ3RlbXBsYXRlJyA6ICdjb2x1bW5UZW1wbGF0ZScsICdyb3dUZW1wbGF0ZScsICdkZXRhaWxUZW1wbGF0ZScsXG4gICAgICAgICAgICAgICAgJ2NhcHRpb25UZW1wbGF0ZScsICdjb21tYW5kc1RlbXBsYXRlJywgJ2dyb3VwRm9vdGVyVGVtcGxhdGUnLCAnZ3JvdXBDYXB0aW9uVGVtcGxhdGUnXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgaWYgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdpbmZpbml0ZVNjcm9sbCcgJiYgdGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZSkge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuaXNWdWUgPyAndGVtcGxhdGUnIDogJ2NvbHVtblRlbXBsYXRlJywgJ2NvbW1hbmRzVGVtcGxhdGUnXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNsZWFyUmVhY3RWdWVUZW1wbGF0ZXModGhpcy5wYXJlbnQsIHRlbXBsYXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICB2YXIgY2VsbE1lcmdlID0gbmV3IENlbGxNZXJnZVJlbmRlcih0aGlzLnNlcnZpY2VMb2NhdG9yLCB0aGlzLnBhcmVudCk7XG4gICAgICAgICAgICBjZWxsTWVyZ2UudXBkYXRlVmlydHVhbENlbGxzKG1vZGVsRGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50Ym9keSA9IHRoaXMuZ2V0VGFibGUoKS5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLnRib2R5KTtcbiAgICAgICAgdmFyIHN0YXJ0SW5kZXggPSAwO1xuICAgICAgICB2YXIgYmxvY2tMb2FkID0gdHJ1ZTtcbiAgICAgICAgaWYgKGlzR3JvdXBBZGFwdGl2ZShnT2JqKSAmJiBnT2JqLnZjUm93cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciB0b3BfMSA9ICd0b3AnO1xuICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCA9ICFpc051bGxPclVuZGVmaW5lZChhcmdzLnZpcnR1YWxJbmZvLm9mZnNldHMpID8gYXJncy52aXJ0dWFsSW5mby5vZmZzZXRzLnRvcCA6XG4gICAgICAgICAgICAgICAgKCFpc051bGxPclVuZGVmaW5lZChhcmdzLnNjcm9sbFRvcCkgPyBhcmdzLnNjcm9sbFRvcFtcIlwiICsgdG9wXzFdIDogMCk7XG4gICAgICAgICAgICBpZiAoc2Nyb2xsVG9wICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldHNfMSA9IGdPYmoudkdyb3VwT2Zmc2V0cztcbiAgICAgICAgICAgICAgICB2YXIgYlNpemUgPSBnT2JqLnBhZ2VTZXR0aW5ncy5wYWdlU2l6ZSAvIDI7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlcyA9IE9iamVjdC5rZXlzKG9mZnNldHNfMSkubWFwKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIG9mZnNldHNfMVtcIlwiICsga2V5XTsgfSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbSA9IDA7IG0gPCB2YWx1ZXMubGVuZ3RoOyBtKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjcm9sbFRvcCA8IHZhbHVlc1twYXJzZUludChtLnRvU3RyaW5nKCksIDEwKV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoYXJncy52aXJ0dWFsSW5mbykgJiYgYXJncy52aXJ0dWFsSW5mby5kaXJlY3Rpb24gPT09ICd1cCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydEluZGV4ID0gbSA+IDAgPyAoKG0gLSAxKSAqIGJTaXplKSA6IChtICogYlNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRJbmRleCA9IG0gKiBiU2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuY29udGVudE1vZHVsZS5pc0VuZEJsb2NrKG0pIHx8IHRoaXMucGFyZW50LmNvbnRlbnRNb2R1bGUuaXNFbmRCbG9jayhtICsgMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy52aXJ0dWFsSW5mby5ibG9ja0luZGV4ZXMgPSBbbSwgbSArIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5yb3VuZChzY3JvbGxUb3AgKyB0aGlzLmNvbnRlbnRQYW5lbC5maXJzdEVsZW1lbnRDaGlsZC5vZmZzZXRIZWlnaHQpID49XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGVudFBhbmVsLmZpcnN0RWxlbWVudENoaWxkLnNjcm9sbEhlaWdodCAmJiAhYXJncy5yb3dPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tMb2FkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBpc1ZGRnJvemVuT25seSA9IGdPYmouZnJvemVuUm93cyAmJiB0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvblxuICAgICAgICAgICAgJiYgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3Jlb3JkZXInO1xuICAgICAgICBpZiAoKGdPYmouZnJvemVuUm93cyAmJiBhcmdzLnJlcXVlc3RUeXBlID09PSAndmlydHVhbHNjcm9sbCcgJiYgYXJncy52aXJ0dWFsSW5mby5zZW50aW5lbEluZm8uYXhpcyA9PT0gJ1gnKSB8fCBpc1ZGRnJvemVuT25seSkge1xuICAgICAgICAgICAgdmFyIGJJbmRleCA9IGFyZ3MudmlydHVhbEluZm8uYmxvY2tJbmRleGVzO1xuICAgICAgICAgICAgdmFyIHBhZ2UgPSBhcmdzLnZpcnR1YWxJbmZvLnBhZ2U7XG4gICAgICAgICAgICBhcmdzLnZpcnR1YWxJbmZvLmJsb2NrSW5kZXhlcyA9IFsxLCAyXTtcbiAgICAgICAgICAgIGlmIChpc1ZGRnJvemVuT25seSkge1xuICAgICAgICAgICAgICAgIGFyZ3MudmlydHVhbEluZm8ucGFnZSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGlzVkZGcm96ZW5Pbmx5ID8gdGhpcy5pbml0aWFsUGFnZVJlY29yZHMgOiBkYXRhU291cmNlO1xuICAgICAgICAgICAgdmFyIG1oZHJEYXRhID0gdGhpcy52Z2VuZXJhdG9yXG4gICAgICAgICAgICAgICAgLmdlbmVyYXRlUm93cyhkYXRhLCBhcmdzKTtcbiAgICAgICAgICAgIG1oZHJEYXRhLnNwbGljZSh0aGlzLnBhcmVudC5mcm96ZW5Sb3dzKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wYXJlbnQuZnJvemVuUm93czsgaSsrKSB7XG4gICAgICAgICAgICAgICAgLy8gbWhkckRhdGFbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxzLnNwbGljZSgwLCB0aGlzLnBhcmVudC5nZXRGcm96ZW5Db2x1bW5zKCkpO1xuICAgICAgICAgICAgICAgIHRyID0gcm93LnJlbmRlcihtaGRyRGF0YVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGNvbHVtbnMpO1xuICAgICAgICAgICAgICAgIGFkZEZpeGVkQ29sdW1uQm9yZGVyKHRyKTtcbiAgICAgICAgICAgICAgICBoZHJmcmFnLmFwcGVuZENoaWxkKHRyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFyZ3MudmlydHVhbEluZm8uYmxvY2tJbmRleGVzID0gYkluZGV4O1xuICAgICAgICAgICAgYXJncy52aXJ0dWFsSW5mby5wYWdlID0gcGFnZTtcbiAgICAgICAgICAgIGlmIChpc1ZGRnJvemVuT25seSAmJiBhcmdzLnZpcnR1YWxJbmZvLnBhZ2UgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBtb2RlbERhdGEuc3BsaWNlKDAsIHRoaXMucGFyZW50LmZyb3plblJvd3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMudmlydHVhbEZyb3plbkhkclJlZnJlc2goaGRyZnJhZywgbW9kZWxEYXRhLCByb3csIGFyZ3MsIGRhdGFTb3VyY2UsIGNvbHVtbnMpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZyAmJiAhdGhpcy51c2VHcm91cENhY2hlICYmIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiA/IHRoaXMucGFyZW50LmxhenlMb2FkUmVuZGVyIDpcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5jb250ZW50TW9kdWxlKS5yZWZSb3dzT2JqW3RoaXMucGFyZW50LnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZV0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nICYmIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuZW5hYmxlTGF6eUxvYWRpbmcgJiYgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2RlbGV0ZScpXG4gICAgICAgICAgICB8fCBpbmZpbml0ZURldGFpbE1vZGlmaWVkKSB7IC8vICB8fCAodGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncyAmJiB0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlKSlcbiAgICAgICAgICAgIHRoaXMudmlzaWJsZVJvd3MgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpLCBsZW4pIHtcbiAgICAgICAgICAgIHRoaXNfMS5yb3dzLnB1c2gobW9kZWxEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICBpZiAodGhpc18xLnBhcmVudC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nICYmICF0aGlzXzEudXNlR3JvdXBDYWNoZSAmJiB0aGlzXzEucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAodGhpc18xLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiA/IHRoaXNfMS5wYXJlbnQubGF6eUxvYWRSZW5kZXIgOlxuICAgICAgICAgICAgICAgICAgICB0aGlzXzEucGFyZW50LmNvbnRlbnRNb2R1bGUpLnJlZlJvd3NPYmpbdGhpc18xLnBhcmVudC5wYWdlU2V0dGluZ3MuY3VycmVudFBhZ2VdLnB1c2gobW9kZWxEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgdGhpc18xLnNldFJvd3NJbkxhenlHcm91cChtb2RlbERhdGFbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBpKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQobW9kZWxEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpc18xLnNldEluZmluaXRlVmlzaWJsZVJvd3MoYXJncywgbW9kZWxEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICBpZiAoaXNHcm91cEFkYXB0aXZlKGdPYmopICYmIGFyZ3MudmlydHVhbEluZm8gJiYgYXJncy52aXJ0dWFsSW5mby5ibG9ja0luZGV4ZXNcbiAgICAgICAgICAgICAgICAmJiAodGhpc18xLnJvd0VsZW1lbnRzLmxlbmd0aCA+PSAoYXJncy52aXJ0dWFsSW5mby5ibG9ja0luZGV4ZXMubGVuZ3RoICogdGhpc18xLnBhcmVudC5jb250ZW50TW9kdWxlLmdldEJsb2NrU2l6ZSgpKSlcbiAgICAgICAgICAgICAgICAmJiBibG9ja0xvYWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzXzEucGFyZW50LmN1cnJlbnRWaWV3RGF0YVsncmVjb3JkcyddID0gdGhpc18xLnJvd3MubWFwKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLmRhdGE7IH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBcImJyZWFrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdPYmoucm93VGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICB0ciA9IHJvdy5yZW5kZXIobW9kZWxEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgY29sdW1ucyk7XG4gICAgICAgICAgICAgICAgYWRkRml4ZWRDb2x1bW5Cb3JkZXIodHIpO1xuICAgICAgICAgICAgICAgIHZhciBpc1ZGcmVvcmRlciA9IHRoaXNfMS5lbnN1cmVGcm96ZW5IZWFkZXJSZW5kZXIoYXJncyk7XG4gICAgICAgICAgICAgICAgaWYgKGdPYmouZnJvemVuUm93cyAmJiAoaSA8IGdPYmouZnJvemVuUm93cyB8fCBpc0dyb3VwRnJvemVuSGRyKSAmJiAhaXNJbmZpbml0ZVNjcm9sbCAmJiBhcmdzLnJlcXVlc3RUeXBlICE9PSAndmlydHVhbHNjcm9sbCcgJiYgaXNWRnJlb3JkZXJcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpc18xLmVuc3VyZVZpcnR1YWxGcm96ZW5IZWFkZXJSZW5kZXIoYXJncykpIHtcbiAgICAgICAgICAgICAgICAgICAgaGRyZnJhZy5hcHBlbmRDaGlsZCh0cik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKHRyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJvd0lkeCA9IHBhcnNlSW50KHRyLmdldEF0dHJpYnV0ZSgnYXJpYS1yb3dpbmRleCcpLCAxMCkgLSAxO1xuICAgICAgICAgICAgICAgIGlmIChyb3dJZHggKyAxID09PSBnT2JqLmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNHcm91cEZyb3plbkhkciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobW9kZWxEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0V4cGFuZCkge1xuICAgICAgICAgICAgICAgICAgICBnT2JqLm5vdGlmeShldmVudHMuZXhwYW5kQ2hpbGRHcmlkLCB0ci5jZWxsc1tnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGhdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcm93VGVtcGxhdGVJRCA9IGdPYmouZWxlbWVudC5pZCArICdyb3dUZW1wbGF0ZSc7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGlmIChnT2JqLmlzUmVhY3QgfHwgaXNSZWFjdFByaW50R3JpZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNIZWFkZXIgPSBnT2JqLmZyb3plblJvd3MgJiYgaSA8IGdPYmouZnJvemVuUm93cztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvcGllZCA9IGV4dGVuZCh7IGluZGV4OiBpIH0sIGRhdGFTb3VyY2VbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICAgICAgZ09iai5nZXRSb3dUZW1wbGF0ZSgpKGNvcGllZCwgZ09iaiwgJ3Jvd1RlbXBsYXRlJywgcm93VGVtcGxhdGVJRCwgbnVsbCwgbnVsbCwgaXNIZWFkZXIgPyBoZHJmcmFnIDogZnJhZyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnT2JqLnJlcXVpcmVUZW1wbGF0ZVJlZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc1JlZl8yID0gdGhpc18xO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1JlZl8yLnBhcmVudC5yZW5kZXJUZW1wbGF0ZXMoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnT2JqLmZyb3plblJvd3MgJiYgaSA8IGdPYmouZnJvemVuUm93cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ciA9IHJlZkhkcmZyYWcuY2hpbGROb2Rlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ckVsZW1lbnQgPSByZWZGcmFnLmNoaWxkTm9kZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJnID0geyBkYXRhOiBtb2RlbERhdGFbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmRhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogdHJFbGVtZW50ID8gdHJFbGVtZW50IDogdHIgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzUmVmXzIucGFyZW50LnRyaWdnZXIoZXZlbnRzLnJvd0RhdGFCb3VuZCwgYXJnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWxEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0RhdGFSb3cgfHwgKHRoaXNSZWZfMi5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1JlZl8yLnBhcmVudC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzUmVmXzIucm93RWxlbWVudHMucHVzaChhcmcucm93KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1JlZl8yLmFyaWFTZXJ2aWNlLnNldE9wdGlvbnModGhpc1JlZl8yLnBhcmVudC5lbGVtZW50LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbGNvdW50OiBnT2JqLmdldENvbHVtbnMoKS5sZW5ndGgudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID09PSBtb2RlbERhdGEubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZGcmFnID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmSGRyZnJhZyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50cyA9IGdPYmouZ2V0Um93VGVtcGxhdGUoKShleHRlbmQoeyBpbmRleDogaSB9LCBkYXRhU291cmNlW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSksIGdPYmosICdyb3dUZW1wbGF0ZScsIHJvd1RlbXBsYXRlSUQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRoaXNfMS5wYXJlbnRbJ3Jvb3QnXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZ09iai5pc1JlYWN0ICYmIGVsZW1lbnRzWzBdLnRhZ05hbWUgPT09ICdUQk9EWScpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBlbGVtZW50cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzVFIgPSBlbGVtZW50c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3RyJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1RSIHx8IChlbGVtZW50c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0ucXVlcnlTZWxlY3RvckFsbCAmJiBlbGVtZW50c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0ucXVlcnlTZWxlY3RvckFsbCgndHInKS5sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIgPSBpc1RSID8gZWxlbWVudHNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldIDogZWxlbWVudHNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLnF1ZXJ5U2VsZWN0b3IoJ3RyJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdPYmouZnJvemVuUm93cyAmJiBpIDwgZ09iai5mcm96ZW5Sb3dzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZHJmcmFnLmFwcGVuZENoaWxkKHRyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQodHIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ09iai5mcm96ZW5Sb3dzICYmIGkgPCBnT2JqLmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyID0gIWdPYmouaXNSZWFjdCA/IGFwcGVuZENoaWxkcmVuKGhkcmZyYWcsIGVsZW1lbnRzKSA6IGhkcmZyYWcubGFzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZyYWcuYXBwZW5kQ2hpbGQodHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFnT2JqLmlzUmVhY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ciA9IGFwcGVuZENoaWxkcmVuKGZyYWcsIGVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyRWxlbWVudCA9IGdPYmouaXNSZWFjdCA/IGZyYWcubGFzdEVsZW1lbnRDaGlsZCA6IHRyLmxhc3RFbGVtZW50Q2hpbGQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGFyZyA9IHsgZGF0YTogbW9kZWxEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5kYXRhLCByb3c6IHRyRWxlbWVudCA/IHRyRWxlbWVudCA6IHRyIH07XG4gICAgICAgICAgICAgICAgdGhpc18xLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5yb3dEYXRhQm91bmQsIGFyZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobW9kZWxEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0RhdGFSb3cgfHwgKHRoaXNfMS5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gJiZcbiAgICAgICAgICAgICAgICB0aGlzXzEucGFyZW50Lmdyb3VwU2V0dGluZ3MuZW5hYmxlTGF6eUxvYWRpbmcpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChnT2JqLnJvd1RlbXBsYXRlKSAmJiAoZ09iai5pc0FuZ3VsYXIgfHwgZ09iai5pc1Z1ZTMgfHwgZ09iai5pc1Z1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc18xLnJvd0VsZW1lbnRzLnB1c2godHJFbGVtZW50ID8gdHJFbGVtZW50IDogdHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc18xLnJvd0VsZW1lbnRzLnB1c2godHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXNfMS5hcmlhU2VydmljZS5zZXRPcHRpb25zKHRoaXNfMS5wYXJlbnQuZWxlbWVudCwgeyBjb2xjb3VudDogZ09iai5nZXRDb2x1bW5zKCkubGVuZ3RoLnRvU3RyaW5nKCkgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB0aGlzXzEgPSB0aGlzO1xuICAgICAgICBmb3IgKHZhciBpID0gc3RhcnRJbmRleCwgbGVuID0gbW9kZWxEYXRhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEoaSwgbGVuKTtcbiAgICAgICAgICAgIGlmIChzdGF0ZV8xID09PSBcImJyZWFrXCIpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzUmVhY3RDaGlsZCA9IGdPYmoucGFyZW50RGV0YWlscyAmJiBnT2JqLnBhcmVudERldGFpbHMucGFyZW50SW5zdE9iaiAmJiBnT2JqLnBhcmVudERldGFpbHMucGFyZW50SW5zdE9iai5pc1JlYWN0O1xuICAgICAgICBpZiAoKGdPYmouaXNSZWFjdCB8fCBpc1JlYWN0Q2hpbGQpICYmICFnT2JqLnJlcXVpcmVUZW1wbGF0ZVJlZikge1xuICAgICAgICAgICAgZ09iai5yZW5kZXJUZW1wbGF0ZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuY29udGVudE1vZHVsZS5yZWZSb3dzT2JqW3RoaXMucGFyZW50LnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZV0gPVxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNvbnRlbnRNb2R1bGVbJ2dyb3VwQ2FjaGUnXVt0aGlzLnBhcmVudC5wYWdlU2V0dGluZ3MuY3VycmVudFBhZ2VdO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nICYmICF0aGlzLnVzZUdyb3VwQ2FjaGUgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5yZWZyZXNoRXhwYW5kYW5kQ29sbGFwc2UsIHtcbiAgICAgICAgICAgICAgICByb3dzOiAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gPyB0aGlzLnBhcmVudC5sYXp5TG9hZFJlbmRlciA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNvbnRlbnRNb2R1bGUpLnJlZlJvd3NPYmpbdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLmN1cnJlbnRQYWdlXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZ09iai5yZW1vdmVNYXNrUm93KCk7XG4gICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeSgncmVtb3ZlR2FudHRTaGltbWVyJywgeyByZXF1ZXN0VHlwZTogJ2hpZGVTaGltbWVyJyB9KTtcbiAgICAgICAgaWYgKChnT2JqLmZyb3plblJvd3MgJiYgYXJncy5yZXF1ZXN0VHlwZSAhPT0gJ3ZpcnR1YWxzY3JvbGwnICYmICFpc0luZmluaXRlU2Nyb2xsICYmIHRoaXMuZW5zdXJlVmlydHVhbEZyb3plbkhlYWRlclJlbmRlcihhcmdzKSlcbiAgICAgICAgICAgIHx8IChhcmdzLnJlcXVlc3RUeXBlID09PSAndmlydHVhbHNjcm9sbCcgJiYgYXJncy52aXJ0dWFsSW5mby5zZW50aW5lbEluZm8gJiYgYXJncy52aXJ0dWFsSW5mby5zZW50aW5lbEluZm8uYXhpcyA9PT0gJ1gnKSkge1xuICAgICAgICAgICAgaGRyVGJvZHkgPSBnT2JqLmdldEhlYWRlclRhYmxlKCkucXVlcnlTZWxlY3RvcihsaXRlcmFscy50Ym9keSk7XG4gICAgICAgICAgICBpZiAoaXNSZWFjdCkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRUYWJsZSA9IGhkclRib2R5LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgcmVtb3ZlKGhkclRib2R5KTtcbiAgICAgICAgICAgICAgICBwYXJlbnRUYWJsZS5hcHBlbmRDaGlsZChoZHJmcmFnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGhkclRib2R5LmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgICAgIGhkclRib2R5LmFwcGVuZENoaWxkKGhkcmZyYWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFnT2JqLmlzSW5pdGlhbExvYWQpIHtcbiAgICAgICAgICAgICAgICBnT2JqLnNjcm9sbE1vZHVsZS5zZXRIZWlnaHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBpZiAoIWdPYmouZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgaGRyVGJvZHkgJiYgZ09iai5mcm96ZW5Sb3dzICYmIGlkeCA9PT0gMCAmJiBjb250Lm9mZnNldEhlaWdodCA9PT0gTnVtYmVyKGdPYmouaGVpZ2h0KSkge1xuICAgICAgICAvLyAgICAgY29udC5zdHlsZS5oZWlnaHQgPSAoY29udC5vZmZzZXRIZWlnaHQgLSBoZHJUYm9keS5vZmZzZXRIZWlnaHQpICsgJ3B4JztcbiAgICAgICAgLy8gfVxuICAgICAgICBhcmdzLnJvd3MgPSB0aGlzLnJvd3Muc2xpY2UoMCk7XG4gICAgICAgIGdldFVwZGF0ZVVzaW5nUmFmKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmJlZm9yZUZyYWdBcHBlbmQsIGFyZ3MpO1xuICAgICAgICAgICAgaWYgKCFfdGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgKCFfdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gfHwgaXNDb2x1bW5WaXJ0dWFsSW5maW5pdGVQcm9jZXNzKVxuICAgICAgICAgICAgICAgICYmICFpc0luZmluaXRlU2Nyb2xsKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFnT2JqLmlzUmVhY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudGJvZHkuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoX3RoaXMudGJvZHkucGFyZW50RWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlKF90aGlzLnRib2R5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZShnT2JqLmdldENvbnRlbnRUYWJsZSgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMudGJvZHkgPSBfdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudChsaXRlcmFscy50Ym9keSwgeyBhdHRyczogeyByb2xlOiAncm93Z3JvdXAnIH0gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ09iai5yb3dUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgIHVwZGF0ZUJsYXpvclRlbXBsYXRlKGdPYmouZWxlbWVudC5pZCArICdyb3dUZW1wbGF0ZScsICdSb3dUZW1wbGF0ZScsIGdPYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChfdGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxNb2R1bGUpICYmICgoX3RoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nXG4gICAgICAgICAgICAgICAgJiYgIV90aGlzLmlzSW5maW5pdGVDb2x1bW52aXJ0dWFsaXphdGlvbigpKSB8fCBpc0NvbHVtblZpcnR1YWxJbmZpbml0ZVByb2Nlc3MpKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNBZGRSb3dzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgX3RoaXMucGFyZW50Lm5vdGlmeShldmVudHMucmVtb3ZlSW5maW5pdGVSb3dzLCB7IGFyZ3M6IGFyZ3MgfSk7XG4gICAgICAgICAgICAgICAgX3RoaXMucGFyZW50Lm5vdGlmeShldmVudHMuYXBwZW5kSW5maW5pdGVDb250ZW50LCB7XG4gICAgICAgICAgICAgICAgICAgIHRib2R5OiB0YmR5ID8gdGJkeSA6IF90aGlzLnRib2R5LCBmcmFnOiBmcmFnLCBhcmdzOiBhcmdzLCByb3dzOiBfdGhpcy5yb3dzLFxuICAgICAgICAgICAgICAgICAgICByb3dFbGVtZW50czogX3RoaXMucm93RWxlbWVudHMsIHZpc2libGVSb3dzOiBfdGhpcy52aXNpYmxlUm93cyxcbiAgICAgICAgICAgICAgICAgICAgdGFibGVOYW1lOiB0YWJsZU5hbWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNJbmZpbml0ZUNvbHVtbnZpcnR1YWxpemF0aW9uKCkgJiYgX3RoaXMucGFyZW50LmlzRnJvemVuR3JpZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2aXJ0dWFsVGFibGUgPSBfdGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy5lLXZpcnR1YWx0YWJsZScpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNmb3JtID0gZ2V0VHJhbnNmb3JtVmFsdWVzKHZpcnR1YWxUYWJsZSk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5jb250ZW50TW9kdWxlLnJlc2V0U3RpY2t5TGVmdFBvcyh0cmFuc2Zvcm0ud2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy53aWR0aFNlcnZpY2UucmVmcmVzaEZyb3plblNjcm9sbGJhcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIF90aGlzLnVzZUdyb3VwQ2FjaGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5hcHBlbmRDb250ZW50KF90aGlzLnRib2R5LCBmcmFnLCBhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cgJiYgKF90aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCBfdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1JvdyA9IF90aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWFkZHJvdy1yZW1vdmVkJyk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1Jvdykge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmUobmV3Um93KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc3RhcnRBZGQgPSAhX3RoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5hZGRlZFJvdyk7XG4gICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIF90aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ05vcm1hbCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnRBZGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCBfdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5pc0FkZE5ld1JvdyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LmlzRWRpdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuYWRkUmVjb3JkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzdGFydEFkZCB8fCAoKF90aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCBfdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpICYmXG4gICAgICAgICAgICAgICAgICAgIFsnc29ydGluZycsICdmaWx0ZXJpbmcnLCAnc2VhcmNoaW5nJywgJ2dyb3VwaW5nJywgJ3VuZ3JvdXBpbmcnLCAncmVvcmRlciddXG4gICAgICAgICAgICAgICAgICAgICAgICAuc29tZShmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIGFyZ3MucmVxdWVzdFR5cGUgPT09IHZhbHVlOyB9KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50Lm5vdGlmeShldmVudHMuc2hvd0FkZE5ld1Jvd0ZvY3VzLCB7fSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5nZXRWaXNpYmxlRnJvemVuUmlnaHRDb3VudCgpICYmIF90aGlzLnBhcmVudC5nZXRDb250ZW50KCkgJiYgZ2V0U2Nyb2xsV2lkdGgoX3RoaXMucGFyZW50KSA+IDApIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLXJpZ2h0LXNoYWRvdycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnJhZyA9IG51bGw7XG4gICAgICAgIH0sIHRoaXMucmFmQ2FsbGJhY2soZXh0ZW5kKHt9LCBhcmdzKSkpO1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuaXNJbmZpbml0ZUNvbHVtbnZpcnR1YWxpemF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmc7XG4gICAgfTtcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5lbmFibGVDYWNoZU9uSW5maW5pdGVDb2x1bW5WaXJ0dWFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc0luZmluaXRlQ29sdW1udmlydHVhbGl6YXRpb24oKSAmJiB0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlO1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZW1wdHlWY1Jvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucGFyZW50LnZjUm93cyA9IFtdO1xuICAgICAgICB0aGlzLnBhcmVudC52Um93cyA9IFtdO1xuICAgIH07XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLmFwcGVuZENvbnRlbnQgPSBmdW5jdGlvbiAodGJvZHksIGZyYWcsIGFyZ3MsIHRhYmxlTmFtZSkge1xuICAgICAgICB2YXIgaXNSZWFjdCA9IHRoaXMucGFyZW50LmlzUmVhY3QgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50LnJvd1RlbXBsYXRlKTtcbiAgICAgICAgaWYgKGlzUmVhY3QpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0VGFibGUoKS5hcHBlbmRDaGlsZChmcmFnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRib2R5LmFwcGVuZENoaWxkKGZyYWcpO1xuICAgICAgICAgICAgdGhpcy5nZXRUYWJsZSgpLmFwcGVuZENoaWxkKHRib2R5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQucm93UmVuZGVyaW5nTW9kZSA9PT0gJ1ZlcnRpY2FsJyAmJiB0aGlzLnBhcmVudC5hbGxvd1RleHRXcmFwICYmICh0aGlzLnBhcmVudC50ZXh0V3JhcFNldHRpbmdzLndyYXBNb2RlID09PSAnSGVhZGVyJ1xuICAgICAgICAgICAgfHwgdGhpcy5wYXJlbnQudGV4dFdyYXBTZXR0aW5ncy53cmFwTW9kZSA9PT0gJ0JvdGgnKSkge1xuICAgICAgICAgICAgdmFyIGNlbGxzID0gdGJvZHkucXVlcnlTZWxlY3RvckFsbCgndGQnKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2VsbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVyQ2VsbEhlaWdodCA9IHBhcnNlRmxvYXQoZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShjZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sICc6OmJlZm9yZScpLmdldFByb3BlcnR5VmFsdWUoJ2hlaWdodCcpKTtcbiAgICAgICAgICAgICAgICB2YXIgY2VsbEhlaWdodCA9IGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5vZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgaWYgKGhlYWRlckNlbGxIZWlnaHQgPiBjZWxsSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5zdHlsZS5oZWlnaHQgPSBoZWFkZXJDZWxsSGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnN0eWxlLmJveFNpemluZyA9ICdjb250ZW50LWJveCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5nZXRWaXNpYmxlRnJvemVuTGVmdENvdW50KCkgJiYgdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMud2lkdGhTZXJ2aWNlLnJlZnJlc2hGcm96ZW5TY3JvbGxiYXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuc2V0Um93c0luTGF6eUdyb3VwID0gZnVuY3Rpb24gKHJvdywgaW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuZW5hYmxlTGF6eUxvYWRpbmcgJiYgIXRoaXMudXNlR3JvdXBDYWNoZSAmJiB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gPyB0aGlzLnBhcmVudC5sYXp5TG9hZFJlbmRlciA6XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuY29udGVudE1vZHVsZSkubWFpbnRhaW5Sb3dzKHJvdywgaW5kZXgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5zZXRHcm91cENhY2hlID0gZnVuY3Rpb24gKGRhdGEsIGFyZ3MpIHtcbiAgICAgICAgaWYgKCF0aGlzLnVzZUdyb3VwQ2FjaGUgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5zZXRHcm91cENhY2hlLCB7IGFyZ3M6IGFyZ3MsIGRhdGE6IGRhdGEgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLmVuc3VyZUZyb3plbkhlYWRlclJlbmRlciA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHJldHVybiAhKCh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvblxuICAgICAgICAgICAgJiYgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdyZW9yZGVyJyB8fCBhcmdzLnJlcXVlc3RUeXBlID09PSAncmVmcmVzaCcpKSB8fCAodGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZVxuICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuZnJvemVuUm93cyAmJiB0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbE1vZHVsZS5yZXF1ZXN0VHlwZSA9PT0gJ2RlbGV0ZSdcbiAgICAgICAgICAgICYmIHRoaXMucGFyZW50LnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZSAhPT0gMSkpO1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZW5zdXJlVmlydHVhbEZyb3plbkhlYWRlclJlbmRlciA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHJldHVybiAhKHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uICYmIGFyZ3MucmVxdWVzdFR5cGUgPT09ICdkZWxldGUnKTtcbiAgICB9O1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLmNoZWNrQ2FjaGUgPSBmdW5jdGlvbiAobW9kZWxEYXRhLCBhcmdzKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlICYmIGFyZ3MucmVxdWVzdFR5cGUgPT09ICdpbmZpbml0ZVNjcm9sbCcpIHtcbiAgICAgICAgICAgIHRoaXMuaXNBZGRSb3dzID0gIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuaW5maW5pdGVDYWNoZVt0aGlzLnBhcmVudC5wYWdlU2V0dGluZ3MuY3VycmVudFBhZ2VdKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzQWRkUm93cykge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5pbmZpbml0ZUNhY2hlW3RoaXMucGFyZW50LnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZV07XG4gICAgICAgICAgICAgICAgbW9kZWxEYXRhID0gdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLmN1cnJlbnRQYWdlID09PSAxID8gZGF0YS5zbGljZSh0aGlzLnBhcmVudC5mcm96ZW5Sb3dzKSA6IGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbW9kZWxEYXRhO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nICYmIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiYgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdwYWdpbmcnXG4gICAgICAgICAgICB8fCBhcmdzLnJlcXVlc3RUeXBlID09PSAnY29sdW1uc3RhdGUnIHx8IGFyZ3MucmVxdWVzdFR5cGUgPT09ICdyZW9yZGVyJyB8fCBhcmdzLnJlcXVlc3RUeXBlID09PSAndmlydHVhbHNjcm9sbCcpXG4gICAgICAgICAgICAmJiAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gPyB0aGlzLnBhcmVudC5sYXp5TG9hZFJlbmRlciA6XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuY29udGVudE1vZHVsZSkuZ2V0R3JvdXBDYWNoZSgpW3RoaXMucGFyZW50LnBhZ2VTZXR0aW5ncy5jdXJyZW50UGFnZV0pIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZUdyb3VwQ2FjaGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uID8gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpIDpcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5jb250ZW50TW9kdWxlLmluaXRpYWxHcm91cFJvd3MoYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3Jlb3JkZXInKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLnNldEluZmluaXRlVmlzaWJsZVJvd3MgPSBmdW5jdGlvbiAoYXJncywgZGF0YSkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgJiYgIXRoaXMucGFyZW50LmluZmluaXRlU2Nyb2xsU2V0dGluZ3MuZW5hYmxlQ2FjaGVcbiAgICAgICAgICAgICYmICEodGhpcy5pc0luZmluaXRlQ29sdW1udmlydHVhbGl6YXRpb24oKSAmJiBhcmdzLnJlcXVlc3RUeXBlID09PSAndmlydHVhbHNjcm9sbCcpKSB7XG4gICAgICAgICAgICB0aGlzLnZpc2libGVSb3dzLnB1c2goZGF0YSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLmdldEN1cnJlbnRCbG9ja0luZmluaXRlUmVjb3JkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmluZmluaXRlU2Nyb2xsU2V0dGluZ3MuZW5hYmxlQ2FjaGUpIHtcbiAgICAgICAgICAgIGlmICghT2JqZWN0LmtleXModGhpcy5pbmZpbml0ZUNhY2hlKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcm93cyA9IHRoaXMucGFyZW50LmdldFJvd3MoKTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHBhcnNlSW50KHJvd3NbdGhpcy5wYXJlbnQuZnJvemVuUm93c10uZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICB2YXIgZmlyc3QgPSBNYXRoLmNlaWwoKGluZGV4ICsgMSkgLyB0aGlzLnBhcmVudC5wYWdlU2V0dGluZ3MucGFnZVNpemUpO1xuICAgICAgICAgICAgaW5kZXggPSBwYXJzZUludChyb3dzW3Jvd3MubGVuZ3RoIC0gMV0uZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICB2YXIgbGFzdCA9IE1hdGguY2VpbCgoaW5kZXggKyAocm93cy5sZW5ndGggPyAxIDogMCkpIC8gdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLnBhZ2VTaXplKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBmaXJzdDsgaSA8PSBsYXN0OyBpKyspIHtcbiAgICAgICAgICAgICAgICBkYXRhID0gIWRhdGEubGVuZ3RoID8gdGhpcy5pbmZpbml0ZUNhY2hlW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVxuICAgICAgICAgICAgICAgICAgICA6IGRhdGEuY29uY2F0KHRoaXMuaW5maW5pdGVDYWNoZVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MgJiYgdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLmN1cnJlbnRQYWdlID4gMSkge1xuICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmluZmluaXRlQ2FjaGVbMV0uc2xpY2UoMCwgdGhpcy5wYXJlbnQuZnJvemVuUm93cykuY29uY2F0KGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZ2V0UmVvcmRlcmVkUm93cyA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5jb250ZW50TW9kdWxlLmdldFJlb3JkZXJlZEZyb3plblJvd3MoYXJncyk7XG4gICAgfTtcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS52aXJ0dWFsRnJvemVuSGRyUmVmcmVzaCA9IGZ1bmN0aW9uIChoZHJmcmFnLCBtb2RlbERhdGEsIHJvdywgYXJncywgZGF0YVNvdXJjZSwgY29sdW1ucykge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cyAmJiB0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvblxuICAgICAgICAgICAgJiYgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdyZW9yZGVyJyB8fCBhcmdzLnJlcXVlc3RUeXBlID09PSAncmVmcmVzaCcpKSB7XG4gICAgICAgICAgICB2YXIgdHIgPSB2b2lkIDA7XG4gICAgICAgICAgICB2YXIgZmhkckRhdGEgPSB0aGlzLmdldFJlb3JkZXJlZFJvd3MoYXJncyk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZoZHJEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdHIgPSByb3cucmVuZGVyKGZoZHJEYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgY29sdW1ucyk7XG4gICAgICAgICAgICAgICAgaGRyZnJhZy5hcHBlbmRDaGlsZCh0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJncy52aXJ0dWFsSW5mby5wYWdlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgbW9kZWxEYXRhLnNwbGljZSgwLCB0aGlzLnBhcmVudC5mcm96ZW5Sb3dzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZ2V0SW5maW5pdGVSb3dzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcm93cyA9IFtdO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLmluZmluaXRlQ2FjaGUpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICByb3dzID0gcm93cy5jb25jYXQodGhpcy5pbmZpbml0ZUNhY2hlW2tleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcm93cyA9IHRoaXMudmlzaWJsZVJvd3M7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJvd3M7XG4gICAgfTtcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5nZXRJbmZpbml0ZU1vdmFibGVSb3dzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW5maW5pdGVDYWNoZVJvd3MgPSB0aGlzLmdldEN1cnJlbnRCbG9ja0luZmluaXRlUmVjb3JkcygpO1xuICAgICAgICB2YXIgaW5maW5pdGVSb3dzID0gdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgPyBpbmZpbml0ZUNhY2hlUm93cy5sZW5ndGggPyBpbmZpbml0ZUNhY2hlUm93c1xuICAgICAgICAgICAgOiB0aGlzLnZpc2libGVSb3dzIDogW107XG4gICAgICAgIHJldHVybiBpbmZpbml0ZVJvd3M7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGNvbnRlbnQgZGl2IGVsZW1lbnQgb2YgZ3JpZFxuICAgICAqXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5nZXRQYW5lbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudFBhbmVsO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBjb250ZW50IGRpdiBlbGVtZW50IG9mIGdyaWRcbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0VsZW1lbnR9IHBhbmVsIC0gc3BlY2lmaWVzIHRoZSBwYW5lbFxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLnNldFBhbmVsID0gZnVuY3Rpb24gKHBhbmVsKSB7XG4gICAgICAgIHRoaXMuY29udGVudFBhbmVsID0gcGFuZWw7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGNvbnRlbnQgdGFibGUgZWxlbWVudCBvZiBncmlkXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLmdldFRhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50VGFibGU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGNvbnRlbnQgdGFibGUgZWxlbWVudCBvZiBncmlkXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtFbGVtZW50fSB0YWJsZSAtIHNwZWNpZmllcyB0aGUgdGFibGVcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5zZXRUYWJsZSA9IGZ1bmN0aW9uICh0YWJsZSkge1xuICAgICAgICB0aGlzLmNvbnRlbnRUYWJsZSA9IHRhYmxlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBNb3ZhYmxlIFJvdyBjb2xsZWN0aW9uIGluIHRoZSBGcmVlemUgcGFuZSBHcmlkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge1Jvd1tdIHwgSFRNTENvbGxlY3Rpb25PZjxIVE1MVGFibGVSb3dFbGVtZW50Pn0gcmV0dXJucyB0aGUgcm93XG4gICAgICovXG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZ2V0Um93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGluZmluaXRlUm93cyA9IHRoaXMuZ2V0SW5maW5pdGVSb3dzKCk7XG4gICAgICAgIHJldHVybiBpbmZpbml0ZVJvd3MubGVuZ3RoID8gaW5maW5pdGVSb3dzIDogdGhpcy5yb3dzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjb250ZW50IHRhYmxlIGRhdGEgcm93IGVsZW1lbnRzXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLmdldFJvd0VsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb3dFbGVtZW50cztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY29udGVudCB0YWJsZSBkYXRhIHJvdyBlbGVtZW50c1xuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50W119IGVsZW1lbnRzIC0gc3BlY2lmaWVzIHRoZSBlbGVtZW50c1xuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLnNldFJvd0VsZW1lbnRzID0gZnVuY3Rpb24gKGVsZW1lbnRzKSB7XG4gICAgICAgIHRoaXMucm93RWxlbWVudHMgPSBlbGVtZW50cztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCB0aGUgaGVhZGVyIGNvbGdyb3VwIGVsZW1lbnRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZ2V0Q29sR3JvdXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbGdyb3VwO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBoZWFkZXIgY29sZ3JvdXAgZWxlbWVudFxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBjb2xHcm91cCAtIHNwZWNpZmllcyB0aGUgY29sZ3JvdXBcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLnNldENvbEdyb3VwID0gZnVuY3Rpb24gKGNvbEdyb3VwKSB7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY29sR3JvdXApKSB7XG4gICAgICAgICAgICBjb2xHcm91cC5pZCA9ICdjb250ZW50LScgKyBjb2xHcm91cC5pZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5jb2xncm91cCA9IGNvbEdyb3VwO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdG8gaGlkZSBjb250ZW50IHRhYmxlIGNvbHVtbiBiYXNlZCBvbiB2aXNpYmxlIHByb3BlcnR5XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0NvbHVtbltdfSBjb2x1bW5zIC0gc3BlY2lmaWVzIHRoZSBjb2x1bW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5zZXRWaXNpYmxlID0gZnVuY3Rpb24gKGNvbHVtbnMpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHJvd3MgPSB0aGlzLmdldFJvd3MoKTtcbiAgICAgICAgdmFyIHRlc3RSb3c7XG4gICAgICAgIHJvd3Muc29tZShmdW5jdGlvbiAocikgeyBpZiAoci5pc0RhdGFSb3cpIHtcbiAgICAgICAgICAgIHRlc3RSb3cgPSByO1xuICAgICAgICB9IHJldHVybiByLmlzRGF0YVJvdzsgfSk7XG4gICAgICAgIHZhciBuZWVkRnVsbFJlZnJlc2ggPSB0cnVlO1xuICAgICAgICBpZiAoIWdPYmouZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAmJiB0ZXN0Um93KSB7XG4gICAgICAgICAgICBuZWVkRnVsbFJlZnJlc2ggPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdHIgPSBnT2JqLmdldERhdGFSb3dzKCk7XG4gICAgICAgIHZhciBhcmdzID0ge307XG4gICAgICAgIHZhciBpbmZpbml0ZURhdGEgPSB0aGlzLmluZmluaXRlUm93VmlzaWJpbGl0eSgpO1xuICAgICAgICB2YXIgY29udGVudHJvd3MgPSBpbmZpbml0ZURhdGEgPyBpbmZpbml0ZURhdGFcbiAgICAgICAgICAgIDogdGhpcy5yb3dzLmZpbHRlcihmdW5jdGlvbiAocm93KSB7IHJldHVybiAhcm93LmlzRGV0YWlsUm93OyB9KTtcbiAgICAgICAgZm9yICh2YXIgYyA9IDAsIGNsZW4gPSBjb2x1bW5zLmxlbmd0aDsgYyA8IGNsZW47IGMrKykge1xuICAgICAgICAgICAgdmFyIGNvbHVtbiA9IGNvbHVtbnNbcGFyc2VJbnQoYy50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgdmFyIGlkeCA9IHRoaXMucGFyZW50LmdldE5vcm1hbGl6ZWRDb2x1bW5JbmRleChjb2x1bW4udWlkKTtcbiAgICAgICAgICAgIHZhciBjb2xJZHggPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5JbmRleEJ5VWlkKGNvbHVtbi51aWQpO1xuICAgICAgICAgICAgdmFyIGRpc3BsYXlWYWwgPSBjb2x1bW4udmlzaWJsZSA9PT0gdHJ1ZSA/ICcnIDogJ25vbmUnO1xuICAgICAgICAgICAgaWYgKGlkeCAhPT0gLTEgJiYgdGVzdFJvdyAmJiBpZHggPCB0ZXN0Um93LmNlbGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHNldFN0eWxlQXR0cmlidXRlKHRoaXMuZ2V0Q29sR3JvdXAoKS5jaGlsZE5vZGVzW3BhcnNlSW50KGlkeC50b1N0cmluZygpLCAxMCldLCB7ICdkaXNwbGF5JzogZGlzcGxheVZhbCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghbmVlZEZ1bGxSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXREaXNwbGF5Tm9uZSh0ciwgY29sSWR4LCBkaXNwbGF5VmFsLCBjb250ZW50cm93cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50Lmludm9rZWRGcm9tTWVkaWEgJiYgY29sdW1uLmhpZGVBdE1lZGlhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQudXBkYXRlTWVkaWFDb2x1bW5zKGNvbHVtbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5pbnZva2VkRnJvbU1lZGlhID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5lZWRGdWxsUmVmcmVzaCkge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoQ29udGVudFJvd3MoeyByZXF1ZXN0VHlwZTogJ3JlZnJlc2gnIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5wYXJ0aWFsUmVmcmVzaCwgeyByb3dzOiBjb250ZW50cm93cywgYXJnczogYXJncyB9KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJiAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gfHwgdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5zaG93QWRkTmV3Um93Rm9jdXMsIHt9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHRyIC0gc3BlY2lmaWVzIHRoZSB0cnJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaWR4IC0gc3BlY2lmaWVzIHRoZSBpZHhcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGlzcGxheVZhbCAtIHNwZWNpZmllcyB0aGUgZGlzcGxheXZhbFxuICAgICAqIEBwYXJhbSB7Um93PENvbHVtbj59IHJvd3MgLSBzcGVjaWZpZXMgdGhlIHJvd3NcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuc2V0RGlzcGxheU5vbmUgPSBmdW5jdGlvbiAodHIsIGlkeCwgZGlzcGxheVZhbCwgcm93cykge1xuICAgICAgICBzZXREaXNwbGF5VmFsdWUodHIsIGlkeCwgZGlzcGxheVZhbCwgcm93cywgdGhpcy5wYXJlbnQsIHRoaXMucGFyZW50LmlzUm93RHJhZ2FibGUoKSk7XG4gICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMuaW5maW5pdGVTaG93SGlkZSwgeyB2aXNpYmxlOiBkaXNwbGF5VmFsLCBpbmRleDogaWR4LCBpc0ZyZWV6ZTogdGhpcy5pc0luZmluaXRlRnJlZXplIH0pO1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuaW5maW5pdGVSb3dWaXNpYmlsaXR5ID0gZnVuY3Rpb24gKGlzRnJlZXplKSB7XG4gICAgICAgIHZhciBpbmZpbml0ZURhdGE7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZykge1xuICAgICAgICAgICAgdGhpcy5pc0luZmluaXRlRnJlZXplID0gaXNGcmVlemU7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZSkge1xuICAgICAgICAgICAgICAgIGluZmluaXRlRGF0YSA9IHRoaXMuZ2V0Q3VycmVudEJsb2NrSW5maW5pdGVSZWNvcmRzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbmZpbml0ZURhdGEgPSBpc0ZyZWV6ZSA/IHRoaXMudmlzaWJsZUZyb3plblJvd3MgOiB0aGlzLnZpc2libGVSb3dzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbmZpbml0ZURhdGE7XG4gICAgfTtcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5jb2xHcm91cFJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmdldENvbEdyb3VwKCkpIHtcbiAgICAgICAgICAgIHZhciBjb2xHcm91cCA9IHRoaXMuZ2V0SGVhZGVyQ29sR3JvdXAoKTtcbiAgICAgICAgICAgIHRoaXMuZ2V0VGFibGUoKS5yZXBsYWNlQ2hpbGQoY29sR3JvdXAsIHRoaXMuZ2V0Q29sR3JvdXAoKSk7XG4gICAgICAgICAgICB0aGlzLnNldENvbEdyb3VwKGNvbEdyb3VwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZ2V0SGVhZGVyQ29sR3JvdXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuZ3JpZEhlYWRlcilcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLmNvbEdyb3VwICsgJzpub3QoLmUtbWFza2VkLWNvbGdyb3VwKScpLmNsb25lTm9kZSh0cnVlKTtcbiAgICB9O1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLmluaXRpYWxpemVDb250ZW50RHJvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdGhpcy5kcm9wcGFibGUgPSBuZXcgRHJvcHBhYmxlKGdPYmouZWxlbWVudCwge1xuICAgICAgICAgICAgYWNjZXB0OiAnLmUtZHJhZ2Nsb25lJyxcbiAgICAgICAgICAgIGRyb3A6IHRoaXMuZHJvcFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLmRyb3BwYWJsZURlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmRyb3BwYWJsZSAmJiAhdGhpcy5kcm9wcGFibGUuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZHJvcHBhYmxlLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuY2FuU2tpcCA9IGZ1bmN0aW9uIChjb2x1bW4sIHJvdywgaW5kZXgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNraXAgdGhlIHRvZ2dsZSB2aXNpYmxpdHkgb3BlcmF0aW9uIHdoZW4gb25lIG9mIHRoZSBmb2xsb3dpbmcgc3VjY2Vzc1xuICAgICAgICAgKiAxLiBHcmlkIGhhcyBlbXB0eSByZWNvcmRzXG4gICAgICAgICAqIDIuIGNvbHVtbiB2aXNpYmxlIHByb3BlcnR5IGlzIHVuY2hhbmdlZFxuICAgICAgICAgKiAzLiBjZWxsYHMgaXNWaXNpYmxlIHByb3BlcnR5IGlzIHNhbWUgYXMgY29sdW1uYHMgdmlzaWJsZSBwcm9wZXJ0eS5cbiAgICAgICAgICovXG4gICAgICAgIHJldHVybiBpc051bGxPclVuZGVmaW5lZChyb3cpIHx8IC8vKDEpXG4gICAgICAgICAgICBpc051bGxPclVuZGVmaW5lZChjb2x1bW4udmlzaWJsZSkgfHwgLy8oMilcbiAgICAgICAgICAgIHJvdy5jZWxsc1twYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldLnZpc2libGUgPT09IGNvbHVtbi52aXNpYmxlOyAvLygzKVxuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZ2V0TW9kZWxHZW5lcmF0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvciA9IHRoaXMucGFyZW50LmFsbG93R3JvdXBpbmcgPyBuZXcgR3JvdXBNb2RlbEdlbmVyYXRvcih0aGlzLnBhcmVudCkgOiBuZXcgUm93TW9kZWxHZW5lcmF0b3IodGhpcy5wYXJlbnQpO1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUucmVuZGVyRW1wdHkgPSBmdW5jdGlvbiAodGJvZHkpIHtcbiAgICAgICAgdGhpcy5nZXRUYWJsZSgpLmFwcGVuZENoaWxkKHRib2R5KTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmZyb3plblJvd3MpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmdldEhlYWRlckNvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLnRib2R5KS5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuc2V0U2VsZWN0aW9uID0gZnVuY3Rpb24gKHVpZCwgc2V0LCBjbGVhckFsbCkge1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnNldEZyZWV6ZVNlbGVjdGlvbiwgeyB1aWQ6IHVpZCwgc2V0OiBzZXQsIGNsZWFyQWxsOiBjbGVhckFsbCB9KTtcbiAgICAgICAgdmFyIHJvdyA9IHRoaXMuZ2V0Um93cygpLmZpbHRlcihmdW5jdGlvbiAocm93KSB7IHJldHVybiBjbGVhckFsbCB8fCB1aWQgPT09IHJvdy51aWQ7IH0pO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJvdy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgcm93W3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5pc1NlbGVjdGVkID0gc2V0O1xuICAgICAgICAgICAgdmFyIGNlbGxzID0gcm93W3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5jZWxscztcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2VsbHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICBjZWxsc1twYXJzZUludChrLnRvU3RyaW5nKCksIDEwKV0uaXNTZWxlY3RlZCA9IHNldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZ2V0Um93QnlJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpbmRleCA9IHRoaXMuZ2V0SW5maW5pdGVSb3dJbmRleChpbmRleCk7XG4gICAgICAgIHJldHVybiAhaXNOdWxsT3JVbmRlZmluZWQoaW5kZXgpID8gdGhpcy5wYXJlbnQuZ2V0RGF0YVJvd3MoKVtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldIDogdW5kZWZpbmVkO1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZ2V0SW5maW5pdGVSb3dJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZSAmJiAhaXNOdWxsT3JVbmRlZmluZWQoaW5kZXgpKSB7XG4gICAgICAgICAgICB2YXIgZlJvd3MgPSB0aGlzLnBhcmVudC5mcm96ZW5Sb3dzO1xuICAgICAgICAgICAgdmFyIGlkeCA9IGZSb3dzID4gaW5kZXggPyAwIDogZlJvd3M7XG4gICAgICAgICAgICB2YXIgZmlyc3RSb3dJbmRleCA9IHBhcnNlSW50KHRoaXMucGFyZW50LmdldFJvd3MoKVtwYXJzZUludChpZHgudG9TdHJpbmcoKSwgMTApXVxuICAgICAgICAgICAgICAgIC5nZXRBdHRyaWJ1dGUobGl0ZXJhbHMuYXJpYVJvd0luZGV4KSwgMTApIC0gMTtcbiAgICAgICAgICAgIGluZGV4ID0gZlJvd3MgPiBpbmRleCA/IGluZGV4IDogKGluZGV4IC0gZmlyc3RSb3dJbmRleCkgKyBmUm93cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgfTtcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5nZXRWaXJ0dWFsUm93SW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUuZW5hYmxlQWZ0ZXJSZW5kZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoZS5tb2R1bGUgPT09ICdncm91cCcgJiYgZS5lbmFibGUpIHtcbiAgICAgICAgICAgIHRoaXMuZ2VuZXJhdG9yID0gdGhpcy5nZXRNb2RlbEdlbmVyYXRvcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5zZXRSb3dPYmplY3RzID0gZnVuY3Rpb24gKHJvd3MpIHtcbiAgICAgICAgdGhpcy5yb3dzID0gcm93cztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Tm90aWZ5QXJnc30gYXJncyAtIHNwZWNpZmllcyB0aGUgYXJnc1xuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5pbW11dGFibGVNb2RlUmVuZGVyaW5nID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKGFyZ3MgPT09IHZvaWQgMCkgeyBhcmdzID0ge307IH1cbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgZ09iai5oaWRlU3Bpbm5lcigpO1xuICAgICAgICB2YXIga2V5ID0gZ09iai5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpWzBdO1xuICAgICAgICB2YXIgb2xkS2V5cyA9IHt9O1xuICAgICAgICB2YXIgbmV3S2V5cyA9IHt9O1xuICAgICAgICB2YXIgbmV3Um93T2JqcyA9IFtdO1xuICAgICAgICB2YXIgb2xkSW5kZXhlcyA9IHt9O1xuICAgICAgICB2YXIgb2xkUm93T2JqcyA9IGdPYmouZ2V0Um93c09iamVjdCgpLnNsaWNlKCk7XG4gICAgICAgIHZhciBiYXRjaENoYW5nZUtleXMgPSB0aGlzLmdldEJhdGNoRWRpdGVkUmVjb3JkcyhrZXksIG9sZFJvd09ianMpO1xuICAgICAgICB2YXIgbmV3SW5kZXhlcyA9IHt9O1xuICAgICAgICB2YXIgaGFzQmF0Y2ggPSBPYmplY3Qua2V5cyhiYXRjaENoYW5nZUtleXMpLmxlbmd0aCAhPT0gMDtcbiAgICAgICAgaWYgKGdPYmouZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy5lLWVtcHR5cm93JykgfHwgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3Jlb3JkZXInXG4gICAgICAgICAgICB8fCB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hDb250ZW50Um93cyhhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChnT2JqLmN1cnJlbnRWaWV3RGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb2xkUm93RWxlbWVudHMgPSB7fTtcbiAgICAgICAgICAgIHZhciB0Ym9keSA9IGdPYmouY3JlYXRlRWxlbWVudChsaXRlcmFscy50Ym9keSwgeyBhdHRyczogeyByb2xlOiAncm93Z3JvdXAnIH0gfSk7XG4gICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IGdPYmouY3VycmVudFZpZXdEYXRhO1xuICAgICAgICAgICAgdmFyIHRycyA9IFtdLnNsaWNlLmNhbGwodGhpcy5nZXRUYWJsZSgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpLmNoaWxkcmVuKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXZDdXJyZW50Vmlldy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJldkxlbiA9IHRoaXMucHJldkN1cnJlbnRWaWV3Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudExlbiA9IGRhdGFTb3VyY2UubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2TGVuID09PSBjdXJyZW50TGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3VycmVudExlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm1vZGUgPT09ICdCYXRjaCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiB0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5jb250YWlucygnZS1pbnNlcnRlZHJvdycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLWk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdLZXlzW2RhdGFTb3VyY2VbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldW1wiXCIgKyBrZXldXSA9IG9sZEtleXNbdGhpcy5wcmV2Q3VycmVudFZpZXdbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldW1wiXCIgKyBrZXldXSA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IGRhdGFTb3VyY2VbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldW1wiXCIgKyBrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgb2xkUm93RWxlbWVudHNbb2xkUm93T2Jqc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udWlkXSA9IHRyc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRJbmRleGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IHRoaXMucHJldkN1cnJlbnRWaWV3W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVtcIlwiICsga2V5XTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjdXJyZW50TGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0tleXNbZGF0YVNvdXJjZVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIGtleV1dID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0luZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID0gZGF0YVNvdXJjZVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIGtleV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcmV2TGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ0JhdGNoJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIHRyc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWluc2VydGVkcm93JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0taTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZFJvd0VsZW1lbnRzW29sZFJvd09ianNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZF0gPSB0cnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgb2xkS2V5c1t0aGlzLnByZXZDdXJyZW50Vmlld1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIGtleV1dID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZEluZGV4ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID0gdGhpcy5wcmV2Q3VycmVudFZpZXdbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldW1wiXCIgKyBrZXldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhU291cmNlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9sZEluZGV4ID0gb2xkS2V5c1tkYXRhU291cmNlW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVtcIlwiICsga2V5XV07XG4gICAgICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChvbGRJbmRleCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzRXF1YWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZURlZXBDb21wYXJlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc0VxdWFsID0gdGhpcy5vYmplY3RFcXVhbGl0eUNoZWNrZXIodGhpcy5wcmV2Q3VycmVudFZpZXdbcGFyc2VJbnQob2xkSW5kZXgudG9TdHJpbmcoKSwgMTApXSwgZGF0YVNvdXJjZVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ciA9IG9sZFJvd0VsZW1lbnRzW29sZFJvd09ianNbcGFyc2VJbnQob2xkSW5kZXgudG9TdHJpbmcoKSwgMTApXVxuICAgICAgICAgICAgICAgICAgICAgICAgLnVpZF07XG4gICAgICAgICAgICAgICAgICAgIG5ld1Jvd09ianMucHVzaChvbGRSb3dPYmpzW3BhcnNlSW50KG9sZEluZGV4LnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yb3dFbGVtZW50c1twYXJzZUludChvbGRJbmRleC50b1N0cmluZygpLCAxMCldICYmIHRoaXMucm93RWxlbWVudHNbcGFyc2VJbnQob2xkSW5kZXgudG9TdHJpbmcoKSwgMTApXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdWlkJykgPT09IG5ld1Jvd09ianNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgKChoYXNCYXRjaCAmJiBpc051bGxPclVuZGVmaW5lZChiYXRjaENoYW5nZUtleXNbbmV3SW5kZXhlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAoIWhhc0JhdGNoICYmIChpc0VxdWFsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IHRoaXMucHJldkN1cnJlbnRWaWV3W3BhcnNlSW50KG9sZEluZGV4LnRvU3RyaW5nKCksIDEwKV0gPT09IGRhdGFTb3VyY2VbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKSkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2xkSW5kZXggIT09IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hJbW11dGFibGVDb250ZW50KGksIHRyLCBuZXdSb3dPYmpzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZCh0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoKGhhc0JhdGNoICYmICFpc051bGxPclVuZGVmaW5lZChiYXRjaENoYW5nZUtleXNbbmV3SW5kZXhlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8ICghdGhpcy5wYXJlbnQuZW5hYmxlRGVlcENvbXBhcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBkYXRhU291cmNlW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSAhPT0gdGhpcy5wcmV2Q3VycmVudFZpZXdbcGFyc2VJbnQob2xkSW5kZXgudG9TdHJpbmcoKSwgMTApXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8ICh0aGlzLnBhcmVudC5lbmFibGVEZWVwQ29tcGFyZSAmJiAhaXNFcXVhbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9sZFJvd09ianNbcGFyc2VJbnQob2xkSW5kZXgudG9TdHJpbmcoKSwgMTApXS5zZXRSb3dWYWx1ZShkYXRhU291cmNlW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hJbW11dGFibGVDb250ZW50KGksIHRyLCBuZXdSb3dPYmpzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm93ID0gbmV3IFJvd1JlbmRlcmVyKHRoaXMuc2VydmljZUxvY2F0b3IsIG51bGwsIGdPYmopO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXJnc18xID0geyBzdGFydEluZGV4OiBpIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBtb2RlbERhdGEgPSB0aGlzLmdlbmVyYXRvci5nZW5lcmF0ZVJvd3MoW2RhdGFTb3VyY2VbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSwgYXJnc18xKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Um93T2Jqcy5wdXNoKG1vZGVsRGF0YVswXSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ciA9IHJvdy5yZW5kZXIobW9kZWxEYXRhWzBdLCBnT2JqLmdldENvbHVtbnMoKSk7XG4gICAgICAgICAgICAgICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoSW1tdXRhYmxlQ29udGVudChpLCB0ciwgbmV3Um93T2Jqc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucm93cyA9IG5ld1Jvd09ianM7XG4gICAgICAgICAgICB0aGlzLnJvd0VsZW1lbnRzID0gW10uc2xpY2UuY2FsbCh0Ym9keS5jaGlsZHJlbik7XG4gICAgICAgICAgICByZW1vdmUodGhpcy5nZXRUYWJsZSgpLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMudGJvZHkpKTtcbiAgICAgICAgICAgIHRoaXMuZ2V0VGFibGUoKS5hcHBlbmRDaGlsZCh0Ym9keSk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5kYXRhQm91bmQsIHt9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5hbGxvd1RleHRXcmFwKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmZyZWV6ZVJlbmRlciwgeyBjYXNlOiAndGV4dHdyYXAnIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gKGFyZ3MucmVxdWVzdFR5cGUgfHwgJycpLnRvTG93ZXJDYXNlKCkgKyAnLWNvbXBsZXRlJztcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoYWN0aW9uLCBhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUub2JqZWN0RXF1YWxpdHlDaGVja2VyID0gZnVuY3Rpb24gKG9sZCwgbmV4dCkge1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9sZCk7XG4gICAgICAgIHZhciBpc0VxdWFsID0gdHJ1ZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAob2xkW2tleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSAhPT0gbmV4dFtrZXlzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0pIHtcbiAgICAgICAgICAgICAgICB2YXIgaXNEYXRlID0gb2xkW2tleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldXSBpbnN0YW5jZW9mIERhdGVcbiAgICAgICAgICAgICAgICAgICAgJiYgbmV4dFtrZXlzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0gaW5zdGFuY2VvZiBEYXRlO1xuICAgICAgICAgICAgICAgIGlmICghaXNEYXRlIHx8IChvbGRba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dXG4gICAgICAgICAgICAgICAgICAgIC5nZXRUaW1lKCkgIT09IG5leHRba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dLmdldFRpbWUoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNFcXVhbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzRXF1YWw7XG4gICAgfTtcbiAgICBDb250ZW50UmVuZGVyLnByb3RvdHlwZS5nZXRCYXRjaEVkaXRlZFJlY29yZHMgPSBmdW5jdGlvbiAocHJpbWFyeUtleSwgcm93cykge1xuICAgICAgICB2YXIga2V5cyA9IHt9O1xuICAgICAgICB2YXIgY2hhbmdlcyA9IHRoaXMucGFyZW50LmdldEJhdGNoQ2hhbmdlcygpO1xuICAgICAgICB2YXIgY2hhbmdlZFJlY29yZHMgPSBbXTtcbiAgICAgICAgdmFyIGFkZGVkUmVjb3JkcyA9IFtdO1xuICAgICAgICBpZiAoT2JqZWN0LmtleXMoY2hhbmdlcykubGVuZ3RoKSB7XG4gICAgICAgICAgICBjaGFuZ2VkUmVjb3JkcyA9IGNoYW5nZXMuY2hhbmdlZFJlY29yZHM7XG4gICAgICAgICAgICBhZGRlZFJlY29yZHMgPSBjaGFuZ2VzLmFkZGVkUmVjb3JkcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXJncyA9IHsgY2FuY2VsOiBmYWxzZSB9O1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmltbXV0YWJsZUJhdGNoQ2FuY2VsLCB7IHJvd3M6IHJvd3MsIGFyZ3M6IGFyZ3MgfSk7XG4gICAgICAgIGlmIChhZGRlZFJlY29yZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm5ld1Jvd1Bvc2l0aW9uID09PSAnQm90dG9tJykge1xuICAgICAgICAgICAgICAgIHJvd3Muc3BsaWNlKHJvd3MubGVuZ3RoIC0gMSwgYWRkZWRSZWNvcmRzLmxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIWFyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd3Muc3BsaWNlKDAsIGFkZGVkUmVjb3Jkcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYW5nZWRSZWNvcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBrZXlzW2NoYW5nZWRSZWNvcmRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVtcIlwiICsgcHJpbWFyeUtleV1dID0gaTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ga2V5cztcbiAgICB9O1xuICAgIENvbnRlbnRSZW5kZXIucHJvdG90eXBlLnJlZnJlc2hJbW11dGFibGVDb250ZW50ID0gZnVuY3Rpb24gKGluZGV4LCB0ciwgcm93KSB7XG4gICAgICAgIHJvdy5pc0FsdFJvdyA9IHRoaXMucGFyZW50LmVuYWJsZUFsdFJvdyA/IGluZGV4ICUgMiAhPT0gMCA6IGZhbHNlO1xuICAgICAgICBpZiAocm93LmlzQWx0Um93KSB7XG4gICAgICAgICAgICB0ci5jbGFzc0xpc3QuYWRkKCdlLWFsdHJvdycpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHIuY2xhc3NMaXN0LnJlbW92ZSgnZS1hbHRyb3cnKTtcbiAgICAgICAgfVxuICAgICAgICByb3cuaW5kZXggPSBpbmRleDtcbiAgICAgICAgcm93LmVkaXQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJvdy5pc0RpcnR5ID0gZmFsc2U7XG4gICAgICAgIHRyLnNldEF0dHJpYnV0ZShsaXRlcmFscy5hcmlhUm93SW5kZXgsIChpbmRleCArIDEpLnRvU3RyaW5nKCkpO1xuICAgICAgICB0aGlzLnVwZGF0ZUNlbGxJbmRleCh0ciwgaW5kZXgpO1xuICAgIH07XG4gICAgQ29udGVudFJlbmRlci5wcm90b3R5cGUudXBkYXRlQ2VsbEluZGV4ID0gZnVuY3Rpb24gKHJvd0VsZSwgaW5kZXgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByb3dFbGUuY2VsbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJvd0VsZS5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uc2V0QXR0cmlidXRlKCdpbmRleCcsIGluZGV4LnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQ29udGVudFJlbmRlcjtcbn0oKSk7XG5leHBvcnQgeyBDb250ZW50UmVuZGVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/content-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/detail-expand-cell-renderer.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/detail-expand-cell-renderer.js ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DetailExpandCellRenderer: () => (/* binding */ DetailExpandCellRenderer)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _cell_renderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/**\n * ExpandCellRenderer class which responsible for building group expand cell.\n *\n * @hidden\n */\nvar DetailExpandCellRenderer = /** @class */ (function (_super) {\n    __extends(DetailExpandCellRenderer, _super);\n    function DetailExpandCellRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.element = _this.parent.createElement('TD', {\n            className: 'e-detailrowcollapse',\n            attrs: { 'aria-expanded': 'false', tabindex: '-1' }\n        });\n        return _this;\n    }\n    /**\n     * Function to render the detail expand cell\n     *\n     * @param {Cell<Column>} cell - specifies the cell\n     * @param {Object} data - specifies the data\n     * @param {Object} attributes - specifies the attributes\n     * @returns {Element} returns the element\n     */\n    DetailExpandCellRenderer.prototype.render = function (cell, data, attributes) {\n        var node = this.element.cloneNode();\n        if (attributes && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(attributes['class'])) {\n            node.className = '';\n            node.className = attributes['class'];\n            node.appendChild(this.parent.createElement('a', { className: 'e-icons e-dtdiagonaldown e-icon-gdownarrow', attrs: {\n                    href: '#', 'title': this.localizer.getConstant('Expanded')\n                } }));\n        }\n        else {\n            node.appendChild(this.parent.createElement('a', { className: 'e-icons e-dtdiagonalright e-icon-grightarrow', attrs: {\n                    href: '#', 'title': this.localizer.getConstant('Collapsed')\n                } }));\n        }\n        if (cell.isSelected) {\n            node.classList.add('e-selectionbackground', 'e-active');\n        }\n        return node;\n    };\n    return DetailExpandCellRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_1__.CellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9kZXRhaWwtZXhwYW5kLWNlbGwtcmVuZGVyZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUN3RDtBQUNWO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGNBQWM7QUFDN0IsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsdUVBQWlCO0FBQzVDO0FBQ0E7QUFDQSw4REFBOEQ7QUFDOUQ7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBLDhEQUE4RDtBQUM5RDtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyx3REFBWTtBQUNzQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL3JlbmRlcmVyL2RldGFpbC1leHBhbmQtY2VsbC1yZW5kZXJlci5qcz9hODM1Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBDZWxsUmVuZGVyZXIgfSBmcm9tICcuL2NlbGwtcmVuZGVyZXInO1xuLyoqXG4gKiBFeHBhbmRDZWxsUmVuZGVyZXIgY2xhc3Mgd2hpY2ggcmVzcG9uc2libGUgZm9yIGJ1aWxkaW5nIGdyb3VwIGV4cGFuZCBjZWxsLlxuICpcbiAqIEBoaWRkZW5cbiAqL1xudmFyIERldGFpbEV4cGFuZENlbGxSZW5kZXJlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRGV0YWlsRXhwYW5kQ2VsbFJlbmRlcmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIERldGFpbEV4cGFuZENlbGxSZW5kZXJlcigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmVsZW1lbnQgPSBfdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnVEQnLCB7XG4gICAgICAgICAgICBjbGFzc05hbWU6ICdlLWRldGFpbHJvd2NvbGxhcHNlJyxcbiAgICAgICAgICAgIGF0dHJzOiB7ICdhcmlhLWV4cGFuZGVkJzogJ2ZhbHNlJywgdGFiaW5kZXg6ICctMScgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byByZW5kZXIgdGhlIGRldGFpbCBleHBhbmQgY2VsbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtDZWxsPENvbHVtbj59IGNlbGwgLSBzcGVjaWZpZXMgdGhlIGNlbGxcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIHNwZWNpZmllcyB0aGUgZGF0YVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhdHRyaWJ1dGVzIC0gc3BlY2lmaWVzIHRoZSBhdHRyaWJ1dGVzXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICBEZXRhaWxFeHBhbmRDZWxsUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIChjZWxsLCBkYXRhLCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5lbGVtZW50LmNsb25lTm9kZSgpO1xuICAgICAgICBpZiAoYXR0cmlidXRlcyAmJiAhaXNOdWxsT3JVbmRlZmluZWQoYXR0cmlidXRlc1snY2xhc3MnXSkpIHtcbiAgICAgICAgICAgIG5vZGUuY2xhc3NOYW1lID0gJyc7XG4gICAgICAgICAgICBub2RlLmNsYXNzTmFtZSA9IGF0dHJpYnV0ZXNbJ2NsYXNzJ107XG4gICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2EnLCB7IGNsYXNzTmFtZTogJ2UtaWNvbnMgZS1kdGRpYWdvbmFsZG93biBlLWljb24tZ2Rvd25hcnJvdycsIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgICAgIGhyZWY6ICcjJywgJ3RpdGxlJzogdGhpcy5sb2NhbGl6ZXIuZ2V0Q29uc3RhbnQoJ0V4cGFuZGVkJylcbiAgICAgICAgICAgICAgICB9IH0pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQodGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnYScsIHsgY2xhc3NOYW1lOiAnZS1pY29ucyBlLWR0ZGlhZ29uYWxyaWdodCBlLWljb24tZ3JpZ2h0YXJyb3cnLCBhdHRyczoge1xuICAgICAgICAgICAgICAgICAgICBocmVmOiAnIycsICd0aXRsZSc6IHRoaXMubG9jYWxpemVyLmdldENvbnN0YW50KCdDb2xsYXBzZWQnKVxuICAgICAgICAgICAgICAgIH0gfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjZWxsLmlzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnZS1zZWxlY3Rpb25iYWNrZ3JvdW5kJywgJ2UtYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfTtcbiAgICByZXR1cm4gRGV0YWlsRXhwYW5kQ2VsbFJlbmRlcmVyO1xufShDZWxsUmVuZGVyZXIpKTtcbmV4cG9ydCB7IERldGFpbEV4cGFuZENlbGxSZW5kZXJlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/detail-expand-cell-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/detail-header-indent-renderer.js":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/detail-header-indent-renderer.js ***!
  \************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DetailHeaderIndentCellRenderer: () => (/* binding */ DetailHeaderIndentCellRenderer)\n/* harmony export */ });\n/* harmony import */ var _cell_renderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n/**\n * DetailHeaderIndentCellRenderer class which responsible for building detail header indent cell.\n *\n * @hidden\n */\nvar DetailHeaderIndentCellRenderer = /** @class */ (function (_super) {\n    __extends(DetailHeaderIndentCellRenderer, _super);\n    function DetailHeaderIndentCellRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.element = _this.parent.createElement('TH', { className: 'e-detailheadercell' });\n        return _this;\n    }\n    /**\n     * Function to render the detail indent cell\n     *\n     * @param  {Cell} cell - specifies the cell\n     * @param  {Object} data - specifies the data\n     * @returns {Element} returns the element\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    DetailHeaderIndentCellRenderer.prototype.render = function (cell, data) {\n        var node = this.element.cloneNode();\n        node.appendChild(this.parent.createElement('div', { className: 'e-emptycell' }));\n        return node;\n    };\n    return DetailHeaderIndentCellRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_0__.CellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9kZXRhaWwtaGVhZGVyLWluZGVudC1yZW5kZXJlci5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3QjtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLENBQUM7QUFDOEM7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELGlDQUFpQztBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLE1BQU07QUFDdEIsZ0JBQWdCLFFBQVE7QUFDeEIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQsMEJBQTBCO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyx3REFBWTtBQUM0QiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL3JlbmRlcmVyL2RldGFpbC1oZWFkZXItaW5kZW50LXJlbmRlcmVyLmpzPzgxZmMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5pbXBvcnQgeyBDZWxsUmVuZGVyZXIgfSBmcm9tICcuL2NlbGwtcmVuZGVyZXInO1xuLyoqXG4gKiBEZXRhaWxIZWFkZXJJbmRlbnRDZWxsUmVuZGVyZXIgY2xhc3Mgd2hpY2ggcmVzcG9uc2libGUgZm9yIGJ1aWxkaW5nIGRldGFpbCBoZWFkZXIgaW5kZW50IGNlbGwuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgRGV0YWlsSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhEZXRhaWxIZWFkZXJJbmRlbnRDZWxsUmVuZGVyZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRGV0YWlsSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZWxlbWVudCA9IF90aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdUSCcsIHsgY2xhc3NOYW1lOiAnZS1kZXRhaWxoZWFkZXJjZWxsJyB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byByZW5kZXIgdGhlIGRldGFpbCBpbmRlbnQgY2VsbFxuICAgICAqXG4gICAgICogQHBhcmFtICB7Q2VsbH0gY2VsbCAtIHNwZWNpZmllcyB0aGUgY2VsbFxuICAgICAqIEBwYXJhbSAge09iamVjdH0gZGF0YSAtIHNwZWNpZmllcyB0aGUgZGF0YVxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIERldGFpbEhlYWRlckluZGVudENlbGxSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKGNlbGwsIGRhdGEpIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLmVsZW1lbnQuY2xvbmVOb2RlKCk7XG4gICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQodGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLWVtcHR5Y2VsbCcgfSkpO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9O1xuICAgIHJldHVybiBEZXRhaWxIZWFkZXJJbmRlbnRDZWxsUmVuZGVyZXI7XG59KENlbGxSZW5kZXJlcikpO1xuZXhwb3J0IHsgRGV0YWlsSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/detail-header-indent-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/expand-cell-renderer.js":
/*!***************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/expand-cell-renderer.js ***!
  \***************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ExpandCellRenderer: () => (/* binding */ ExpandCellRenderer)\n/* harmony export */ });\n/* harmony import */ var _indent_cell_renderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./indent-cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/indent-cell-renderer.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/**\n * ExpandCellRenderer class which responsible for building group expand cell.\n *\n * @hidden\n */\nvar ExpandCellRenderer = /** @class */ (function (_super) {\n    __extends(ExpandCellRenderer, _super);\n    function ExpandCellRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Function to render the expand cell\n     *\n     * @param {Cell} cell - specifies the cell\n     * @param {Object} data - specifies the data\n     * @param {string} data.field - Defines the field\n     * @param {string} data.key - Defines the key\n     * @param {Object} attr - specifies the attribute\n     * @param {boolean} isExpand - specifies isexpand\n     * @returns {Element} returns the element\n     */\n    ExpandCellRenderer.prototype.render = function (cell, data, attr, isExpand) {\n        var node = this.element.cloneNode();\n        node.setAttribute('ej-mappingname', data.field);\n        node.setAttribute('ej-mappingvalue', data.key);\n        node.setAttribute('aria-expanded', isExpand ? 'true' : 'false');\n        node.setAttribute('tabindex', '-1');\n        if (this.parent.infiniteScrollSettings && this.parent.infiniteScrollSettings.enableCache &&\n            !this.parent.groupSettings.enableLazyLoading) {\n            cell.cellType = _base_enum__WEBPACK_IMPORTED_MODULE_0__.CellType.Indent;\n            node.className = isExpand ? 'e-recordplusexpand e-disablepointer' : 'e-recordpluscollapse e-disablepointer';\n        }\n        else {\n            node.className = isExpand ? 'e-recordplusexpand' : 'e-recordpluscollapse';\n            node.appendChild(this.parent.createElement('a', {\n                className: isExpand ? 'e-icons e-gdiagonaldown e-icon-gdownarrow' : 'e-icons e-gnextforward e-icon-grightarrow',\n                attrs: { href: '#', 'title': isExpand ? this.localizer.getConstant('Expanded') : this.localizer.getConstant('Collapsed') }\n            }));\n        }\n        return node;\n    };\n    return ExpandCellRenderer;\n}(_indent_cell_renderer__WEBPACK_IMPORTED_MODULE_1__.IndentCellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9leHBhbmQtY2VsbC1yZW5kZXJlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQzJEO0FBQ3BCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxNQUFNO0FBQ3JCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFNBQVM7QUFDeEIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGdEQUFRO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMscUVBQWtCO0FBQ1UiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9leHBhbmQtY2VsbC1yZW5kZXJlci5qcz84MWZiIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgSW5kZW50Q2VsbFJlbmRlcmVyIH0gZnJvbSAnLi9pbmRlbnQtY2VsbC1yZW5kZXJlcic7XG5pbXBvcnQgeyBDZWxsVHlwZSB9IGZyb20gJy4uL2Jhc2UvZW51bSc7XG4vKipcbiAqIEV4cGFuZENlbGxSZW5kZXJlciBjbGFzcyB3aGljaCByZXNwb25zaWJsZSBmb3IgYnVpbGRpbmcgZ3JvdXAgZXhwYW5kIGNlbGwuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgRXhwYW5kQ2VsbFJlbmRlcmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhFeHBhbmRDZWxsUmVuZGVyZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRXhwYW5kQ2VsbFJlbmRlcmVyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIHJlbmRlciB0aGUgZXhwYW5kIGNlbGxcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Q2VsbH0gY2VsbCAtIHNwZWNpZmllcyB0aGUgY2VsbFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gc3BlY2lmaWVzIHRoZSBkYXRhXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRhdGEuZmllbGQgLSBEZWZpbmVzIHRoZSBmaWVsZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRhLmtleSAtIERlZmluZXMgdGhlIGtleVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhdHRyIC0gc3BlY2lmaWVzIHRoZSBhdHRyaWJ1dGVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzRXhwYW5kIC0gc3BlY2lmaWVzIGlzZXhwYW5kXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICBFeHBhbmRDZWxsUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIChjZWxsLCBkYXRhLCBhdHRyLCBpc0V4cGFuZCkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ2VqLW1hcHBpbmduYW1lJywgZGF0YS5maWVsZCk7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdlai1tYXBwaW5ndmFsdWUnLCBkYXRhLmtleSk7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgaXNFeHBhbmQgPyAndHJ1ZScgOiAnZmFsc2UnKTtcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbFNldHRpbmdzICYmIHRoaXMucGFyZW50LmluZmluaXRlU2Nyb2xsU2V0dGluZ3MuZW5hYmxlQ2FjaGUgJiZcbiAgICAgICAgICAgICF0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nKSB7XG4gICAgICAgICAgICBjZWxsLmNlbGxUeXBlID0gQ2VsbFR5cGUuSW5kZW50O1xuICAgICAgICAgICAgbm9kZS5jbGFzc05hbWUgPSBpc0V4cGFuZCA/ICdlLXJlY29yZHBsdXNleHBhbmQgZS1kaXNhYmxlcG9pbnRlcicgOiAnZS1yZWNvcmRwbHVzY29sbGFwc2UgZS1kaXNhYmxlcG9pbnRlcic7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBub2RlLmNsYXNzTmFtZSA9IGlzRXhwYW5kID8gJ2UtcmVjb3JkcGx1c2V4cGFuZCcgOiAnZS1yZWNvcmRwbHVzY29sbGFwc2UnO1xuICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZCh0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdhJywge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogaXNFeHBhbmQgPyAnZS1pY29ucyBlLWdkaWFnb25hbGRvd24gZS1pY29uLWdkb3duYXJyb3cnIDogJ2UtaWNvbnMgZS1nbmV4dGZvcndhcmQgZS1pY29uLWdyaWdodGFycm93JyxcbiAgICAgICAgICAgICAgICBhdHRyczogeyBocmVmOiAnIycsICd0aXRsZSc6IGlzRXhwYW5kID8gdGhpcy5sb2NhbGl6ZXIuZ2V0Q29uc3RhbnQoJ0V4cGFuZGVkJykgOiB0aGlzLmxvY2FsaXplci5nZXRDb25zdGFudCgnQ29sbGFwc2VkJykgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgcmV0dXJuIEV4cGFuZENlbGxSZW5kZXJlcjtcbn0oSW5kZW50Q2VsbFJlbmRlcmVyKSk7XG5leHBvcnQgeyBFeHBhbmRDZWxsUmVuZGVyZXIgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/expand-cell-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-cell-renderer.js":
/*!***************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-cell-renderer.js ***!
  \***************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HeaderCellRenderer: () => (/* binding */ HeaderCellRenderer)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _cell_renderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\n/* harmony import */ var _services_aria_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../services/aria-service */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/aria-service.js\");\n/* harmony import */ var _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @syncfusion/ej2-buttons */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-buttons@29.1.34/node_modules/@syncfusion/ej2-buttons/src/common/common.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n\n/**\n * HeaderCellRenderer class which responsible for building header cell content.\n *\n * @hidden\n */\nvar HeaderCellRenderer = /** @class */ (function (_super) {\n    __extends(HeaderCellRenderer, _super);\n    function HeaderCellRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.element = _this.parent\n            .createElement('TH', { className: 'e-headercell', attrs: { tabindex: '-1', role: 'columnheader' } });\n        _this.ariaService = new _services_aria_service__WEBPACK_IMPORTED_MODULE_1__.AriaService();\n        _this.hTxtEle = _this.parent.createElement('span', { className: 'e-headertext' });\n        _this.sortEle = _this.parent.createElement('div', { className: 'e-sortfilterdiv e-icons', attrs: { 'aria-hidden': 'true' } });\n        _this.gui = _this.parent.createElement('div');\n        _this.chkAllBox = _this.parent.createElement('input', { className: 'e-checkselectall', attrs: { 'type': 'checkbox', 'aria-label': _this.localizer.getConstant('SelectAllCheckbox') } });\n        return _this;\n    }\n    /**\n     * Function to return the wrapper for the TH content.\n     *\n     * @returns {string | Element} returns the element\n     */\n    HeaderCellRenderer.prototype.getGui = function () {\n        return this.gui.cloneNode();\n    };\n    /**\n     * Function to render the cell content based on Column object.\n     *\n     * @param {Cell} cell - specifies the column\n     * @param {Object} data - specifies the data\n     * @param {object} attributes - specifies the aattributes\n     * @returns {Element} returns the element\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    HeaderCellRenderer.prototype.render = function (cell, data, attributes) {\n        var node = this.element.cloneNode();\n        var fltrMenuEle = this.parent.createElement('div', { className: 'e-filtermenudiv e-icons e-icon-filter', attrs: { 'aria-hidden': 'true' } });\n        return this.prepareHeader(cell, node, fltrMenuEle);\n    };\n    /**\n     * Function to refresh the cell content based on Column object.\n     *\n     * @param  {Cell} cell - specifies the cell\n     * @param  {Element} node - specifies the noe\n     * @returns {Element} returns the element\n     */\n    HeaderCellRenderer.prototype.refresh = function (cell, node) {\n        this.clean(node);\n        var fltrMenuEle = this.parent.createElement('div', { className: 'e-filtermenudiv e-icons e-icon-filter', attrs: { 'aria-hidden': 'true' } });\n        return this.prepareHeader(cell, node, fltrMenuEle);\n    };\n    HeaderCellRenderer.prototype.clean = function (node) {\n        node.innerHTML = '';\n    };\n    /* tslint:disable-next-line:max-func-body-length */\n    HeaderCellRenderer.prototype.prepareHeader = function (cell, node, fltrMenuEle) {\n        var column = cell.column;\n        var ariaAttr = {};\n        var elementDesc = '';\n        //Prepare innerHtml\n        var innerDIV = this.getGui();\n        var hValueAccer;\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(innerDIV, {\n            'e-mappinguid': column.uid,\n            'class': 'e-headercelldiv'\n        });\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.headerValueAccessor)) {\n            hValueAccer = this.getValue(column.headerText, column);\n        }\n        if (this.parent.rowHeight && this.parent.allowSorting && column.allowSorting && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.field)) {\n            node.classList.add('e-sort-icon');\n        }\n        if (column.type !== 'checkbox') {\n            var value = column.headerText;\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(hValueAccer)) {\n                value = hValueAccer;\n            }\n            var headerText = this.hTxtEle.cloneNode();\n            headerText[column.getDomSetter()] = this.parent.sanitize(value);\n            innerDIV.appendChild(headerText);\n        }\n        else {\n            column.editType = 'booleanedit';\n            var checkAllWrap = (0,_syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_2__.createCheckBox)(this.parent.createElement, false, { checked: false, label: ' ' });\n            this.chkAllBox.id = 'checkbox-' + column.uid;\n            checkAllWrap.insertBefore(this.chkAllBox.cloneNode(), checkAllWrap.firstChild);\n            if (this.parent.cssClass) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([checkAllWrap], [this.parent.cssClass]);\n            }\n            innerDIV.appendChild(checkAllWrap);\n            innerDIV.classList.add('e-headerchkcelldiv');\n        }\n        this.buildAttributeFromCell(node, cell);\n        this.appendHtml(node, innerDIV);\n        node.appendChild(this.sortEle.cloneNode());\n        if ((this.parent.allowFiltering && this.parent.filterSettings.type !== 'FilterBar') &&\n            (column.allowFiltering && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.field)) &&\n            !(this.parent.showColumnMenu && column.showColumnMenu)) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(fltrMenuEle, {\n                'e-mappinguid': 'e-flmenu-' + column.uid\n            });\n            elementDesc = elementDesc.length ? elementDesc + '. ' + this.localizer.getConstant('FilterDescription') : this.localizer.getConstant('FilterDescription');\n            node.classList.add('e-fltr-icon');\n            var matchFlColumns = [];\n            if (this.parent.filterSettings.columns.length && this.parent.filterSettings.columns.length !== matchFlColumns.length) {\n                var foreignColumn = this.parent.getForeignKeyColumns();\n                for (var index = 0; index < this.parent.columns.length; index++) {\n                    for (var count = 0; count < this.parent.filterSettings.columns.length; count++) {\n                        if (this.parent.filterSettings.columns[parseInt(count.toString(), 10)].field === column.field\n                            || (foreignColumn.length\n                                && column.foreignKeyValue === this.parent.filterSettings.columns[parseInt(count.toString(), 10)].field)) {\n                            fltrMenuEle.classList.add('e-filtered');\n                            matchFlColumns.push(column.field);\n                            break;\n                        }\n                    }\n                }\n            }\n            node.appendChild(fltrMenuEle.cloneNode());\n        }\n        if (cell.className) {\n            node.classList.add(cell.className);\n        }\n        if (column.customAttributes) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.setStyleAndAttributes)(node, column.customAttributes);\n        }\n        if (this.parent.allowSorting && column.allowSorting) {\n            ariaAttr.sort = 'none';\n            elementDesc = elementDesc.length ? elementDesc + '. ' + this.localizer.getConstant('SortDescription') : this.localizer.getConstant('SortDescription');\n        }\n        if ((this.parent.allowGrouping && column.allowGrouping) || this.parent.allowReordering && column.allowReordering) {\n            ariaAttr.grabbed = false;\n            elementDesc = elementDesc.length ? elementDesc + '. ' + this.localizer.getConstant('GroupDescription') : this.localizer.getConstant('GroupDescription');\n        }\n        if (this.parent.showColumnMenu && column.type !== 'checkbox' && !column.template) {\n            elementDesc = elementDesc.length ? elementDesc + '. ' + this.localizer.getConstant('ColumnMenuDescription') : this.localizer.getConstant('ColumnMenuDescription');\n        }\n        node = this.extendPrepareHeader(column, node);\n        var result;\n        var gridObj = this.parent;\n        var colIndex = gridObj.getColumnIndexByField(column.field);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.headerTemplate)) {\n            //need to pass the template id for blazor headertemplate\n            var headerTempID = gridObj.element.id + column.uid + 'headerTemplate';\n            var str = 'isStringTemplate';\n            var col = column;\n            var isReactCompiler = this.parent.isReact && typeof (column.headerTemplate) !== 'string' && !(column.headerTemplate.prototype && column.headerTemplate.prototype.CSPTemplate);\n            var isReactChild_1 = this.parent.parentDetails && this.parent.parentDetails.parentInstObj &&\n                this.parent.parentDetails.parentInstObj.isReact;\n            var isReactPrintGrid = this.parent.printGridParent && this.parent.printGridParent.isReact;\n            if (isReactCompiler || isReactChild_1 || isReactPrintGrid) {\n                var copied = { 'index': colIndex };\n                node.firstElementChild.innerHTML = '';\n                column.getHeaderTemplate()((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(copied, col), gridObj, 'headerTemplate', headerTempID, this.parent[\"\" + str], null, node.firstElementChild);\n                this.parent.renderTemplates();\n            }\n            else {\n                result = column.getHeaderTemplate()((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({ 'index': colIndex }, col), gridObj, 'headerTemplate', headerTempID, this.parent[\"\" + str], undefined, undefined, this.parent['root']);\n                node.firstElementChild.innerHTML = '';\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.appendChildren)(node.firstElementChild, result);\n            }\n        }\n        this.ariaService.setOptions(node, ariaAttr);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.headerTextAlign) || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.textAlign)) {\n            var alignment = column.headerTextAlign || column.textAlign;\n            if (alignment.toLowerCase() === 'right' || alignment.toLowerCase() === 'left') {\n                node.classList.add(alignment.toLowerCase() === 'right' ? 'e-rightalign' : 'e-leftalign');\n            }\n            else if (alignment.toLowerCase() === 'center') {\n                node.classList.add('e-centeralign');\n            }\n            else if (alignment.toLowerCase() === 'justify') {\n                node.classList.add('e-justifyalign');\n            }\n        }\n        if (column.clipMode === 'Clip' || (!column.clipMode && this.parent.clipMode === 'Clip')) {\n            node.classList.add('e-gridclip');\n        }\n        else if ((column.clipMode === 'EllipsisWithTooltip' || (!column.clipMode && this.parent.clipMode === 'EllipsisWithTooltip'))\n            && !(gridObj.allowTextWrap && (gridObj.textWrapSettings.wrapMode === 'Header'\n                || gridObj.textWrapSettings.wrapMode === 'Both'))) {\n            if (column.type !== 'checkbox') {\n                node.classList.add('e-ellipsistooltip');\n            }\n        }\n        if (elementDesc) {\n            var titleElem = (this.parent.createElement('span', { id: 'headerTitle-' + column.uid, innerHTML: elementDesc }));\n            titleElem.style.display = 'none';\n            node.appendChild(titleElem);\n            node.setAttribute('aria-describedby', titleElem.id);\n        }\n        node.setAttribute('aria-rowspan', (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell.rowSpan) ? cell.rowSpan : 1).toString());\n        node.setAttribute('aria-colspan', '1');\n        var isReactChild = this.parent.parentDetails && this.parent.parentDetails.parentInstObj &&\n            this.parent.parentDetails.parentInstObj.isReact;\n        if (((this.parent.isReact && this.parent.requireTemplateRef)\n            || (isReactChild && this.parent.parentDetails.parentInstObj.requireTemplateRef))\n            && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.headerTemplate)) {\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            var thisRef_1 = this;\n            thisRef_1.parent.renderTemplates(function () {\n                thisRef_1.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_4__.headerCellInfo, { cell: cell, node: node });\n            });\n        }\n        else {\n            this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_4__.headerCellInfo, { cell: cell, node: node });\n        }\n        if (this.parent.isFrozenGrid()) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.addStickyColumnPosition)(this.parent, column, node);\n        }\n        return node;\n    };\n    HeaderCellRenderer.prototype.getValue = function (field, column) {\n        return column.headerValueAccessor(field, column);\n    };\n    HeaderCellRenderer.prototype.extendPrepareHeader = function (column, node) {\n        if (this.parent.showColumnMenu && column.showColumnMenu && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.field)) {\n            var element = (this.parent.createElement('div', { className: 'e-icons e-columnmenu', attrs: { 'aria-hidden': 'true' } }));\n            var matchFilteredColumns = [];\n            if (this.parent.filterSettings.columns.length && this.parent.filterSettings.columns.length !== matchFilteredColumns.length) {\n                for (var i = 0; i < this.parent.columns.length; i++) {\n                    for (var j = 0; j < this.parent.filterSettings.columns.length; j++) {\n                        if (this.parent.filterSettings.columns[parseInt(j.toString(), 10)].field === column.field) {\n                            element.classList.add('e-filtered');\n                            matchFilteredColumns.push(column.field);\n                            break;\n                        }\n                    }\n                }\n            }\n            node.classList.add('e-fltr-icon');\n            node.appendChild(element);\n        }\n        if (this.parent.allowResizing) {\n            var handler = this.parent.createElement('div');\n            handler.className = column.allowResizing ? 'e-rhandler e-rcursor' : 'e-rsuppress';\n            node.appendChild(handler);\n        }\n        return node;\n    };\n    /**\n     * Function to specifies how the result content to be placed in the cell.\n     *\n     * @param  {Element} node - specifies the node\n     * @param  {string|Element} innerHtml - specifies the innerHtml\n     * @returns {Element} returns the element\n     */\n    HeaderCellRenderer.prototype.appendHtml = function (node, innerHtml) {\n        node.appendChild(innerHtml);\n        return node;\n    };\n    return HeaderCellRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_5__.CellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9oZWFkZXItY2VsbC1yZW5kZXJlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUMwRTtBQUN6QjtBQUM0QztBQUMvQztBQUNRO0FBQ0U7QUFDUDtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxvQ0FBb0Msd0NBQXdDO0FBQy9HLGdDQUFnQywrREFBVztBQUMzQyw2REFBNkQsMkJBQTJCO0FBQ3hGLDREQUE0RCwrQ0FBK0MseUJBQXlCO0FBQ3BJO0FBQ0EsZ0VBQWdFLHdDQUF3QyxzRkFBc0Y7QUFDOUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixrQkFBa0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE1BQU07QUFDckIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCw2REFBNkQseUJBQXlCO0FBQ25KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsTUFBTTtBQUN0QixnQkFBZ0IsU0FBUztBQUN6QixpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsNkRBQTZELHlCQUF5QjtBQUNuSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsZ0VBQVU7QUFDbEI7QUFDQTtBQUNBLFNBQVM7QUFDVCxhQUFhLHVFQUFpQjtBQUM5QjtBQUNBO0FBQ0EseUZBQXlGLHVFQUFpQjtBQUMxRztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix1RUFBaUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix1RUFBYyxxQ0FBcUMsNEJBQTRCO0FBQzlHO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw4REFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHVFQUFpQjtBQUN4RDtBQUNBLFlBQVksZ0VBQVU7QUFDdEI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxvQ0FBb0M7QUFDeEUsd0NBQXdDLG1EQUFtRDtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksaUVBQXFCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1RUFBaUI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0EsMkNBQTJDLDREQUFNO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCw0REFBTSxHQUFHLG1CQUFtQjtBQUNoRjtBQUNBLGdCQUFnQiwwREFBYztBQUM5QjtBQUNBO0FBQ0E7QUFDQSxhQUFhLHVFQUFpQiw2QkFBNkIsdUVBQWlCO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLHlEQUF5RDtBQUMxSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0Qyx1RUFBaUI7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix1RUFBaUI7QUFDakM7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLDBEQUFjLElBQUksd0JBQXdCO0FBQ25GLGFBQWE7QUFDYjtBQUNBO0FBQ0EsZ0NBQWdDLDBEQUFjLElBQUksd0JBQXdCO0FBQzFFO0FBQ0E7QUFDQSxZQUFZLG1FQUF1QjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSx1RUFBaUI7QUFDckYsOERBQThELDRDQUE0Qyx5QkFBeUI7QUFDbkk7QUFDQTtBQUNBLGdDQUFnQyxnQ0FBZ0M7QUFDaEUsb0NBQW9DLCtDQUErQztBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsU0FBUztBQUN6QixnQkFBZ0IsZ0JBQWdCO0FBQ2hDLGlCQUFpQixTQUFTO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyx3REFBWTtBQUNnQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL3JlbmRlcmVyL2hlYWRlci1jZWxsLXJlbmRlcmVyLmpzP2Y3ZTQiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5pbXBvcnQgeyBpc051bGxPclVuZGVmaW5lZCwgZXh0ZW5kLCBhZGRDbGFzcyB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IGF0dHJpYnV0ZXMgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBzZXRTdHlsZUFuZEF0dHJpYnV0ZXMsIGFwcGVuZENoaWxkcmVuLCBhZGRTdGlja3lDb2x1bW5Qb3NpdGlvbiB9IGZyb20gJy4uL2Jhc2UvdXRpbCc7XG5pbXBvcnQgeyBDZWxsUmVuZGVyZXIgfSBmcm9tICcuL2NlbGwtcmVuZGVyZXInO1xuaW1wb3J0IHsgQXJpYVNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9hcmlhLXNlcnZpY2UnO1xuaW1wb3J0IHsgY3JlYXRlQ2hlY2tCb3ggfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYnV0dG9ucyc7XG5pbXBvcnQgeyBoZWFkZXJDZWxsSW5mbyB9IGZyb20gJy4uL2Jhc2UvY29uc3RhbnQnO1xuLyoqXG4gKiBIZWFkZXJDZWxsUmVuZGVyZXIgY2xhc3Mgd2hpY2ggcmVzcG9uc2libGUgZm9yIGJ1aWxkaW5nIGhlYWRlciBjZWxsIGNvbnRlbnQuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgSGVhZGVyQ2VsbFJlbmRlcmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhIZWFkZXJDZWxsUmVuZGVyZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSGVhZGVyQ2VsbFJlbmRlcmVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZWxlbWVudCA9IF90aGlzLnBhcmVudFxuICAgICAgICAgICAgLmNyZWF0ZUVsZW1lbnQoJ1RIJywgeyBjbGFzc05hbWU6ICdlLWhlYWRlcmNlbGwnLCBhdHRyczogeyB0YWJpbmRleDogJy0xJywgcm9sZTogJ2NvbHVtbmhlYWRlcicgfSB9KTtcbiAgICAgICAgX3RoaXMuYXJpYVNlcnZpY2UgPSBuZXcgQXJpYVNlcnZpY2UoKTtcbiAgICAgICAgX3RoaXMuaFR4dEVsZSA9IF90aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICdlLWhlYWRlcnRleHQnIH0pO1xuICAgICAgICBfdGhpcy5zb3J0RWxlID0gX3RoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnZS1zb3J0ZmlsdGVyZGl2IGUtaWNvbnMnLCBhdHRyczogeyAnYXJpYS1oaWRkZW4nOiAndHJ1ZScgfSB9KTtcbiAgICAgICAgX3RoaXMuZ3VpID0gX3RoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBfdGhpcy5jaGtBbGxCb3ggPSBfdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7IGNsYXNzTmFtZTogJ2UtY2hlY2tzZWxlY3RhbGwnLCBhdHRyczogeyAndHlwZSc6ICdjaGVja2JveCcsICdhcmlhLWxhYmVsJzogX3RoaXMubG9jYWxpemVyLmdldENvbnN0YW50KCdTZWxlY3RBbGxDaGVja2JveCcpIH0gfSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdG8gcmV0dXJuIHRoZSB3cmFwcGVyIGZvciB0aGUgVEggY29udGVudC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmcgfCBFbGVtZW50fSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgSGVhZGVyQ2VsbFJlbmRlcmVyLnByb3RvdHlwZS5nZXRHdWkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmd1aS5jbG9uZU5vZGUoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIHJlbmRlciB0aGUgY2VsbCBjb250ZW50IGJhc2VkIG9uIENvbHVtbiBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0NlbGx9IGNlbGwgLSBzcGVjaWZpZXMgdGhlIGNvbHVtblxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gc3BlY2lmaWVzIHRoZSBkYXRhXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGF0dHJpYnV0ZXMgLSBzcGVjaWZpZXMgdGhlIGFhdHRyaWJ1dGVzXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgSGVhZGVyQ2VsbFJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoY2VsbCwgZGF0YSwgYXR0cmlidXRlcykge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICAgICAgdmFyIGZsdHJNZW51RWxlID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLWZpbHRlcm1lbnVkaXYgZS1pY29ucyBlLWljb24tZmlsdGVyJywgYXR0cnM6IHsgJ2FyaWEtaGlkZGVuJzogJ3RydWUnIH0gfSk7XG4gICAgICAgIHJldHVybiB0aGlzLnByZXBhcmVIZWFkZXIoY2VsbCwgbm9kZSwgZmx0ck1lbnVFbGUpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdG8gcmVmcmVzaCB0aGUgY2VsbCBjb250ZW50IGJhc2VkIG9uIENvbHVtbiBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtDZWxsfSBjZWxsIC0gc3BlY2lmaWVzIHRoZSBjZWxsXG4gICAgICogQHBhcmFtICB7RWxlbWVudH0gbm9kZSAtIHNwZWNpZmllcyB0aGUgbm9lXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICBIZWFkZXJDZWxsUmVuZGVyZXIucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoY2VsbCwgbm9kZSkge1xuICAgICAgICB0aGlzLmNsZWFuKG5vZGUpO1xuICAgICAgICB2YXIgZmx0ck1lbnVFbGUgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtZmlsdGVybWVudWRpdiBlLWljb25zIGUtaWNvbi1maWx0ZXInLCBhdHRyczogeyAnYXJpYS1oaWRkZW4nOiAndHJ1ZScgfSB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJlcGFyZUhlYWRlcihjZWxsLCBub2RlLCBmbHRyTWVudUVsZSk7XG4gICAgfTtcbiAgICBIZWFkZXJDZWxsUmVuZGVyZXIucHJvdG90eXBlLmNsZWFuID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgbm9kZS5pbm5lckhUTUwgPSAnJztcbiAgICB9O1xuICAgIC8qIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtZnVuYy1ib2R5LWxlbmd0aCAqL1xuICAgIEhlYWRlckNlbGxSZW5kZXJlci5wcm90b3R5cGUucHJlcGFyZUhlYWRlciA9IGZ1bmN0aW9uIChjZWxsLCBub2RlLCBmbHRyTWVudUVsZSkge1xuICAgICAgICB2YXIgY29sdW1uID0gY2VsbC5jb2x1bW47XG4gICAgICAgIHZhciBhcmlhQXR0ciA9IHt9O1xuICAgICAgICB2YXIgZWxlbWVudERlc2MgPSAnJztcbiAgICAgICAgLy9QcmVwYXJlIGlubmVySHRtbFxuICAgICAgICB2YXIgaW5uZXJESVYgPSB0aGlzLmdldEd1aSgpO1xuICAgICAgICB2YXIgaFZhbHVlQWNjZXI7XG4gICAgICAgIGF0dHJpYnV0ZXMoaW5uZXJESVYsIHtcbiAgICAgICAgICAgICdlLW1hcHBpbmd1aWQnOiBjb2x1bW4udWlkLFxuICAgICAgICAgICAgJ2NsYXNzJzogJ2UtaGVhZGVyY2VsbGRpdidcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLmhlYWRlclZhbHVlQWNjZXNzb3IpKSB7XG4gICAgICAgICAgICBoVmFsdWVBY2NlciA9IHRoaXMuZ2V0VmFsdWUoY29sdW1uLmhlYWRlclRleHQsIGNvbHVtbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LnJvd0hlaWdodCAmJiB0aGlzLnBhcmVudC5hbGxvd1NvcnRpbmcgJiYgY29sdW1uLmFsbG93U29ydGluZyAmJiAhaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLmZpZWxkKSkge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLXNvcnQtaWNvbicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2x1bW4udHlwZSAhPT0gJ2NoZWNrYm94Jykge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gY29sdW1uLmhlYWRlclRleHQ7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGhWYWx1ZUFjY2VyKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gaFZhbHVlQWNjZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGVhZGVyVGV4dCA9IHRoaXMuaFR4dEVsZS5jbG9uZU5vZGUoKTtcbiAgICAgICAgICAgIGhlYWRlclRleHRbY29sdW1uLmdldERvbVNldHRlcigpXSA9IHRoaXMucGFyZW50LnNhbml0aXplKHZhbHVlKTtcbiAgICAgICAgICAgIGlubmVyRElWLmFwcGVuZENoaWxkKGhlYWRlclRleHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29sdW1uLmVkaXRUeXBlID0gJ2Jvb2xlYW5lZGl0JztcbiAgICAgICAgICAgIHZhciBjaGVja0FsbFdyYXAgPSBjcmVhdGVDaGVja0JveCh0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50LCBmYWxzZSwgeyBjaGVja2VkOiBmYWxzZSwgbGFiZWw6ICcgJyB9KTtcbiAgICAgICAgICAgIHRoaXMuY2hrQWxsQm94LmlkID0gJ2NoZWNrYm94LScgKyBjb2x1bW4udWlkO1xuICAgICAgICAgICAgY2hlY2tBbGxXcmFwLmluc2VydEJlZm9yZSh0aGlzLmNoa0FsbEJveC5jbG9uZU5vZGUoKSwgY2hlY2tBbGxXcmFwLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNzc0NsYXNzKSB7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoW2NoZWNrQWxsV3JhcF0sIFt0aGlzLnBhcmVudC5jc3NDbGFzc10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5uZXJESVYuYXBwZW5kQ2hpbGQoY2hlY2tBbGxXcmFwKTtcbiAgICAgICAgICAgIGlubmVyRElWLmNsYXNzTGlzdC5hZGQoJ2UtaGVhZGVyY2hrY2VsbGRpdicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYnVpbGRBdHRyaWJ1dGVGcm9tQ2VsbChub2RlLCBjZWxsKTtcbiAgICAgICAgdGhpcy5hcHBlbmRIdG1sKG5vZGUsIGlubmVyRElWKTtcbiAgICAgICAgbm9kZS5hcHBlbmRDaGlsZCh0aGlzLnNvcnRFbGUuY2xvbmVOb2RlKCkpO1xuICAgICAgICBpZiAoKHRoaXMucGFyZW50LmFsbG93RmlsdGVyaW5nICYmIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLnR5cGUgIT09ICdGaWx0ZXJCYXInKSAmJlxuICAgICAgICAgICAgKGNvbHVtbi5hbGxvd0ZpbHRlcmluZyAmJiAhaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLmZpZWxkKSkgJiZcbiAgICAgICAgICAgICEodGhpcy5wYXJlbnQuc2hvd0NvbHVtbk1lbnUgJiYgY29sdW1uLnNob3dDb2x1bW5NZW51KSkge1xuICAgICAgICAgICAgYXR0cmlidXRlcyhmbHRyTWVudUVsZSwge1xuICAgICAgICAgICAgICAgICdlLW1hcHBpbmd1aWQnOiAnZS1mbG1lbnUtJyArIGNvbHVtbi51aWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZWxlbWVudERlc2MgPSBlbGVtZW50RGVzYy5sZW5ndGggPyBlbGVtZW50RGVzYyArICcuICcgKyB0aGlzLmxvY2FsaXplci5nZXRDb25zdGFudCgnRmlsdGVyRGVzY3JpcHRpb24nKSA6IHRoaXMubG9jYWxpemVyLmdldENvbnN0YW50KCdGaWx0ZXJEZXNjcmlwdGlvbicpO1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWZsdHItaWNvbicpO1xuICAgICAgICAgICAgdmFyIG1hdGNoRmxDb2x1bW5zID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggIT09IG1hdGNoRmxDb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciBmb3JlaWduQ29sdW1uID0gdGhpcy5wYXJlbnQuZ2V0Rm9yZWlnbktleUNvbHVtbnMoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5wYXJlbnQuY29sdW1ucy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgY291bnQgPSAwOyBjb3VudCA8IHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLmNvbHVtbnMubGVuZ3RoOyBjb3VudCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuY29sdW1uc1twYXJzZUludChjb3VudC50b1N0cmluZygpLCAxMCldLmZpZWxkID09PSBjb2x1bW4uZmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAoZm9yZWlnbkNvbHVtbi5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgY29sdW1uLmZvcmVpZ25LZXlWYWx1ZSA9PT0gdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuY29sdW1uc1twYXJzZUludChjb3VudC50b1N0cmluZygpLCAxMCldLmZpZWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsdHJNZW51RWxlLmNsYXNzTGlzdC5hZGQoJ2UtZmlsdGVyZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaEZsQ29sdW1ucy5wdXNoKGNvbHVtbi5maWVsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKGZsdHJNZW51RWxlLmNsb25lTm9kZSgpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VsbC5jbGFzc05hbWUpIHtcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZChjZWxsLmNsYXNzTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbi5jdXN0b21BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBzZXRTdHlsZUFuZEF0dHJpYnV0ZXMobm9kZSwgY29sdW1uLmN1c3RvbUF0dHJpYnV0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd1NvcnRpbmcgJiYgY29sdW1uLmFsbG93U29ydGluZykge1xuICAgICAgICAgICAgYXJpYUF0dHIuc29ydCA9ICdub25lJztcbiAgICAgICAgICAgIGVsZW1lbnREZXNjID0gZWxlbWVudERlc2MubGVuZ3RoID8gZWxlbWVudERlc2MgKyAnLiAnICsgdGhpcy5sb2NhbGl6ZXIuZ2V0Q29uc3RhbnQoJ1NvcnREZXNjcmlwdGlvbicpIDogdGhpcy5sb2NhbGl6ZXIuZ2V0Q29uc3RhbnQoJ1NvcnREZXNjcmlwdGlvbicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgodGhpcy5wYXJlbnQuYWxsb3dHcm91cGluZyAmJiBjb2x1bW4uYWxsb3dHcm91cGluZykgfHwgdGhpcy5wYXJlbnQuYWxsb3dSZW9yZGVyaW5nICYmIGNvbHVtbi5hbGxvd1Jlb3JkZXJpbmcpIHtcbiAgICAgICAgICAgIGFyaWFBdHRyLmdyYWJiZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGVsZW1lbnREZXNjID0gZWxlbWVudERlc2MubGVuZ3RoID8gZWxlbWVudERlc2MgKyAnLiAnICsgdGhpcy5sb2NhbGl6ZXIuZ2V0Q29uc3RhbnQoJ0dyb3VwRGVzY3JpcHRpb24nKSA6IHRoaXMubG9jYWxpemVyLmdldENvbnN0YW50KCdHcm91cERlc2NyaXB0aW9uJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LnNob3dDb2x1bW5NZW51ICYmIGNvbHVtbi50eXBlICE9PSAnY2hlY2tib3gnICYmICFjb2x1bW4udGVtcGxhdGUpIHtcbiAgICAgICAgICAgIGVsZW1lbnREZXNjID0gZWxlbWVudERlc2MubGVuZ3RoID8gZWxlbWVudERlc2MgKyAnLiAnICsgdGhpcy5sb2NhbGl6ZXIuZ2V0Q29uc3RhbnQoJ0NvbHVtbk1lbnVEZXNjcmlwdGlvbicpIDogdGhpcy5sb2NhbGl6ZXIuZ2V0Q29uc3RhbnQoJ0NvbHVtbk1lbnVEZXNjcmlwdGlvbicpO1xuICAgICAgICB9XG4gICAgICAgIG5vZGUgPSB0aGlzLmV4dGVuZFByZXBhcmVIZWFkZXIoY29sdW1uLCBub2RlKTtcbiAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgdmFyIGdyaWRPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIGNvbEluZGV4ID0gZ3JpZE9iai5nZXRDb2x1bW5JbmRleEJ5RmllbGQoY29sdW1uLmZpZWxkKTtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjb2x1bW4uaGVhZGVyVGVtcGxhdGUpKSB7XG4gICAgICAgICAgICAvL25lZWQgdG8gcGFzcyB0aGUgdGVtcGxhdGUgaWQgZm9yIGJsYXpvciBoZWFkZXJ0ZW1wbGF0ZVxuICAgICAgICAgICAgdmFyIGhlYWRlclRlbXBJRCA9IGdyaWRPYmouZWxlbWVudC5pZCArIGNvbHVtbi51aWQgKyAnaGVhZGVyVGVtcGxhdGUnO1xuICAgICAgICAgICAgdmFyIHN0ciA9ICdpc1N0cmluZ1RlbXBsYXRlJztcbiAgICAgICAgICAgIHZhciBjb2wgPSBjb2x1bW47XG4gICAgICAgICAgICB2YXIgaXNSZWFjdENvbXBpbGVyID0gdGhpcy5wYXJlbnQuaXNSZWFjdCAmJiB0eXBlb2YgKGNvbHVtbi5oZWFkZXJUZW1wbGF0ZSkgIT09ICdzdHJpbmcnICYmICEoY29sdW1uLmhlYWRlclRlbXBsYXRlLnByb3RvdHlwZSAmJiBjb2x1bW4uaGVhZGVyVGVtcGxhdGUucHJvdG90eXBlLkNTUFRlbXBsYXRlKTtcbiAgICAgICAgICAgIHZhciBpc1JlYWN0Q2hpbGRfMSA9IHRoaXMucGFyZW50LnBhcmVudERldGFpbHMgJiYgdGhpcy5wYXJlbnQucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqLmlzUmVhY3Q7XG4gICAgICAgICAgICB2YXIgaXNSZWFjdFByaW50R3JpZCA9IHRoaXMucGFyZW50LnByaW50R3JpZFBhcmVudCAmJiB0aGlzLnBhcmVudC5wcmludEdyaWRQYXJlbnQuaXNSZWFjdDtcbiAgICAgICAgICAgIGlmIChpc1JlYWN0Q29tcGlsZXIgfHwgaXNSZWFjdENoaWxkXzEgfHwgaXNSZWFjdFByaW50R3JpZCkge1xuICAgICAgICAgICAgICAgIHZhciBjb3BpZWQgPSB7ICdpbmRleCc6IGNvbEluZGV4IH07XG4gICAgICAgICAgICAgICAgbm9kZS5maXJzdEVsZW1lbnRDaGlsZC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgICAgICBjb2x1bW4uZ2V0SGVhZGVyVGVtcGxhdGUoKShleHRlbmQoY29waWVkLCBjb2wpLCBncmlkT2JqLCAnaGVhZGVyVGVtcGxhdGUnLCBoZWFkZXJUZW1wSUQsIHRoaXMucGFyZW50W1wiXCIgKyBzdHJdLCBudWxsLCBub2RlLmZpcnN0RWxlbWVudENoaWxkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5yZW5kZXJUZW1wbGF0ZXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNvbHVtbi5nZXRIZWFkZXJUZW1wbGF0ZSgpKGV4dGVuZCh7ICdpbmRleCc6IGNvbEluZGV4IH0sIGNvbCksIGdyaWRPYmosICdoZWFkZXJUZW1wbGF0ZScsIGhlYWRlclRlbXBJRCwgdGhpcy5wYXJlbnRbXCJcIiArIHN0cl0sIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0aGlzLnBhcmVudFsncm9vdCddKTtcbiAgICAgICAgICAgICAgICBub2RlLmZpcnN0RWxlbWVudENoaWxkLmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgICAgIGFwcGVuZENoaWxkcmVuKG5vZGUuZmlyc3RFbGVtZW50Q2hpbGQsIHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hcmlhU2VydmljZS5zZXRPcHRpb25zKG5vZGUsIGFyaWFBdHRyKTtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjb2x1bW4uaGVhZGVyVGV4dEFsaWduKSB8fCAhaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLnRleHRBbGlnbikpIHtcbiAgICAgICAgICAgIHZhciBhbGlnbm1lbnQgPSBjb2x1bW4uaGVhZGVyVGV4dEFsaWduIHx8IGNvbHVtbi50ZXh0QWxpZ247XG4gICAgICAgICAgICBpZiAoYWxpZ25tZW50LnRvTG93ZXJDYXNlKCkgPT09ICdyaWdodCcgfHwgYWxpZ25tZW50LnRvTG93ZXJDYXNlKCkgPT09ICdsZWZ0Jykge1xuICAgICAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZChhbGlnbm1lbnQudG9Mb3dlckNhc2UoKSA9PT0gJ3JpZ2h0JyA/ICdlLXJpZ2h0YWxpZ24nIDogJ2UtbGVmdGFsaWduJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhbGlnbm1lbnQudG9Mb3dlckNhc2UoKSA9PT0gJ2NlbnRlcicpIHtcbiAgICAgICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ2UtY2VudGVyYWxpZ24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFsaWdubWVudC50b0xvd2VyQ2FzZSgpID09PSAnanVzdGlmeScpIHtcbiAgICAgICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ2UtanVzdGlmeWFsaWduJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbi5jbGlwTW9kZSA9PT0gJ0NsaXAnIHx8ICghY29sdW1uLmNsaXBNb2RlICYmIHRoaXMucGFyZW50LmNsaXBNb2RlID09PSAnQ2xpcCcpKSB7XG4gICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ2UtZ3JpZGNsaXAnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgoY29sdW1uLmNsaXBNb2RlID09PSAnRWxsaXBzaXNXaXRoVG9vbHRpcCcgfHwgKCFjb2x1bW4uY2xpcE1vZGUgJiYgdGhpcy5wYXJlbnQuY2xpcE1vZGUgPT09ICdFbGxpcHNpc1dpdGhUb29sdGlwJykpXG4gICAgICAgICAgICAmJiAhKGdyaWRPYmouYWxsb3dUZXh0V3JhcCAmJiAoZ3JpZE9iai50ZXh0V3JhcFNldHRpbmdzLndyYXBNb2RlID09PSAnSGVhZGVyJ1xuICAgICAgICAgICAgICAgIHx8IGdyaWRPYmoudGV4dFdyYXBTZXR0aW5ncy53cmFwTW9kZSA9PT0gJ0JvdGgnKSkpIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW4udHlwZSAhPT0gJ2NoZWNrYm94Jykge1xuICAgICAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnZS1lbGxpcHNpc3Rvb2x0aXAnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZWxlbWVudERlc2MpIHtcbiAgICAgICAgICAgIHZhciB0aXRsZUVsZW0gPSAodGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgaWQ6ICdoZWFkZXJUaXRsZS0nICsgY29sdW1uLnVpZCwgaW5uZXJIVE1MOiBlbGVtZW50RGVzYyB9KSk7XG4gICAgICAgICAgICB0aXRsZUVsZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQodGl0bGVFbGVtKTtcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLWRlc2NyaWJlZGJ5JywgdGl0bGVFbGVtLmlkKTtcbiAgICAgICAgfVxuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSgnYXJpYS1yb3dzcGFuJywgKCFpc051bGxPclVuZGVmaW5lZChjZWxsLnJvd1NwYW4pID8gY2VsbC5yb3dTcGFuIDogMSkudG9TdHJpbmcoKSk7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLWNvbHNwYW4nLCAnMScpO1xuICAgICAgICB2YXIgaXNSZWFjdENoaWxkID0gdGhpcy5wYXJlbnQucGFyZW50RGV0YWlscyAmJiB0aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmogJiZcbiAgICAgICAgICAgIHRoaXMucGFyZW50LnBhcmVudERldGFpbHMucGFyZW50SW5zdE9iai5pc1JlYWN0O1xuICAgICAgICBpZiAoKCh0aGlzLnBhcmVudC5pc1JlYWN0ICYmIHRoaXMucGFyZW50LnJlcXVpcmVUZW1wbGF0ZVJlZilcbiAgICAgICAgICAgIHx8IChpc1JlYWN0Q2hpbGQgJiYgdGhpcy5wYXJlbnQucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqLnJlcXVpcmVUZW1wbGF0ZVJlZikpXG4gICAgICAgICAgICAmJiAhaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLmhlYWRlclRlbXBsYXRlKSkge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzXG4gICAgICAgICAgICB2YXIgdGhpc1JlZl8xID0gdGhpcztcbiAgICAgICAgICAgIHRoaXNSZWZfMS5wYXJlbnQucmVuZGVyVGVtcGxhdGVzKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzUmVmXzEucGFyZW50LnRyaWdnZXIoaGVhZGVyQ2VsbEluZm8sIHsgY2VsbDogY2VsbCwgbm9kZTogbm9kZSB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQudHJpZ2dlcihoZWFkZXJDZWxsSW5mbywgeyBjZWxsOiBjZWxsLCBub2RlOiBub2RlIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgYWRkU3RpY2t5Q29sdW1uUG9zaXRpb24odGhpcy5wYXJlbnQsIGNvbHVtbiwgbm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfTtcbiAgICBIZWFkZXJDZWxsUmVuZGVyZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKGZpZWxkLCBjb2x1bW4pIHtcbiAgICAgICAgcmV0dXJuIGNvbHVtbi5oZWFkZXJWYWx1ZUFjY2Vzc29yKGZpZWxkLCBjb2x1bW4pO1xuICAgIH07XG4gICAgSGVhZGVyQ2VsbFJlbmRlcmVyLnByb3RvdHlwZS5leHRlbmRQcmVwYXJlSGVhZGVyID0gZnVuY3Rpb24gKGNvbHVtbiwgbm9kZSkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuc2hvd0NvbHVtbk1lbnUgJiYgY29sdW1uLnNob3dDb2x1bW5NZW51ICYmICFpc051bGxPclVuZGVmaW5lZChjb2x1bW4uZmllbGQpKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9ICh0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtaWNvbnMgZS1jb2x1bW5tZW51JywgYXR0cnM6IHsgJ2FyaWEtaGlkZGVuJzogJ3RydWUnIH0gfSkpO1xuICAgICAgICAgICAgdmFyIG1hdGNoRmlsdGVyZWRDb2x1bW5zID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggIT09IG1hdGNoRmlsdGVyZWRDb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wYXJlbnQuY29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLmNvbHVtbnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5jb2x1bW5zW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5maWVsZCA9PT0gY29sdW1uLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLWZpbHRlcmVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hGaWx0ZXJlZENvbHVtbnMucHVzaChjb2x1bW4uZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWZsdHItaWNvbicpO1xuICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dSZXNpemluZykge1xuICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGhhbmRsZXIuY2xhc3NOYW1lID0gY29sdW1uLmFsbG93UmVzaXppbmcgPyAnZS1yaGFuZGxlciBlLXJjdXJzb3InIDogJ2UtcnN1cHByZXNzJztcbiAgICAgICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQoaGFuZGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byBzcGVjaWZpZXMgaG93IHRoZSByZXN1bHQgY29udGVudCB0byBiZSBwbGFjZWQgaW4gdGhlIGNlbGwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtFbGVtZW50fSBub2RlIC0gc3BlY2lmaWVzIHRoZSBub2RlXG4gICAgICogQHBhcmFtICB7c3RyaW5nfEVsZW1lbnR9IGlubmVySHRtbCAtIHNwZWNpZmllcyB0aGUgaW5uZXJIdG1sXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICBIZWFkZXJDZWxsUmVuZGVyZXIucHJvdG90eXBlLmFwcGVuZEh0bWwgPSBmdW5jdGlvbiAobm9kZSwgaW5uZXJIdG1sKSB7XG4gICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQoaW5uZXJIdG1sKTtcbiAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfTtcbiAgICByZXR1cm4gSGVhZGVyQ2VsbFJlbmRlcmVyO1xufShDZWxsUmVuZGVyZXIpKTtcbmV4cG9ydCB7IEhlYWRlckNlbGxSZW5kZXJlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-cell-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-indent-renderer.js":
/*!*****************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-indent-renderer.js ***!
  \*****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HeaderIndentCellRenderer: () => (/* binding */ HeaderIndentCellRenderer)\n/* harmony export */ });\n/* harmony import */ var _cell_renderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n/**\n * HeaderIndentCellRenderer class which responsible for building header indent cell.\n *\n * @hidden\n */\nvar HeaderIndentCellRenderer = /** @class */ (function (_super) {\n    __extends(HeaderIndentCellRenderer, _super);\n    function HeaderIndentCellRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.element = _this.parent.createElement('TH', { className: 'e-grouptopleftcell' });\n        return _this;\n    }\n    /**\n     * Function to render the indent cell\n     *\n     * @param  {Cell} cell - specifies the cell\n     * @param  {Object} data - specifies the data\n     * @returns {Element} returns the element\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    HeaderIndentCellRenderer.prototype.render = function (cell, data) {\n        var node = this.element.cloneNode();\n        node.appendChild(this.parent.createElement('div', { className: 'e-headercelldiv e-emptycell', innerHTML: '' }));\n        return node;\n    };\n    return HeaderIndentCellRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_0__.CellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9oZWFkZXItaW5kZW50LXJlbmRlcmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUM4QztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsaUNBQWlDO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsTUFBTTtBQUN0QixnQkFBZ0IsUUFBUTtBQUN4QixpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCx5REFBeUQ7QUFDckg7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxDQUFDLHdEQUFZO0FBQ3NCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvcmVuZGVyZXIvaGVhZGVyLWluZGVudC1yZW5kZXJlci5qcz81MTUyIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgQ2VsbFJlbmRlcmVyIH0gZnJvbSAnLi9jZWxsLXJlbmRlcmVyJztcbi8qKlxuICogSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyIGNsYXNzIHdoaWNoIHJlc3BvbnNpYmxlIGZvciBidWlsZGluZyBoZWFkZXIgaW5kZW50IGNlbGwuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhIZWFkZXJJbmRlbnRDZWxsUmVuZGVyZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZWxlbWVudCA9IF90aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdUSCcsIHsgY2xhc3NOYW1lOiAnZS1ncm91cHRvcGxlZnRjZWxsJyB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byByZW5kZXIgdGhlIGluZGVudCBjZWxsXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtDZWxsfSBjZWxsIC0gc3BlY2lmaWVzIHRoZSBjZWxsXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBkYXRhIC0gc3BlY2lmaWVzIHRoZSBkYXRhXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoY2VsbCwgZGF0YSkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICAgICAgbm9kZS5hcHBlbmRDaGlsZCh0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtaGVhZGVyY2VsbGRpdiBlLWVtcHR5Y2VsbCcsIGlubmVySFRNTDogJycgfSkpO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9O1xuICAgIHJldHVybiBIZWFkZXJJbmRlbnRDZWxsUmVuZGVyZXI7XG59KENlbGxSZW5kZXJlcikpO1xuZXhwb3J0IHsgSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-indent-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-renderer.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-renderer.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   HeaderRender: () => (/* binding */ HeaderRender)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _row_renderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./row-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-renderer.js\");\n/* harmony import */ var _models_cell__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../models/cell */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/cell.js\");\n/* harmony import */ var _models_row__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../models/row */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/row.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @syncfusion/ej2-buttons */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-buttons@29.1.34/node_modules/@syncfusion/ej2-buttons/src/button/button.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n// eslint-disable-next-line valid-jsdoc, jsdoc/require-param\n/**\n * Content module is used to render grid content\n *\n * @hidden\n */\nvar HeaderRender = /** @class */ (function () {\n    /**\n     * Constructor for header renderer module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n     */\n    function HeaderRender(parent, serviceLocator) {\n        var _this = this;\n        this.frzIdx = 0;\n        this.notfrzIdx = 0;\n        this.isFirstCol = false;\n        this.isReplaceDragEle = true;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        this.helper = function (e) {\n            var gObj = _this.parent;\n            var target = _this.draggable.currentStateTarget;\n            var parentEle = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.parentsUntil)(target, 'e-headercell');\n            if (!(gObj.allowReordering || gObj.allowGrouping) || (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(parentEle)\n                && parentEle.getElementsByClassName('e-checkselectall').length > 0)) {\n                return false;\n            }\n            var visualElement = _this.parent.createElement('div', { className: 'e-cloneproperties e-dragclone e-headerclone' });\n            var element = target.classList.contains('e-headercell') ? target : parentEle;\n            if (!element || (!gObj.allowReordering && element.classList.contains('e-stackedheadercell'))) {\n                return false;\n            }\n            var height = element.offsetHeight;\n            var headercelldiv = element.querySelector('.e-headercelldiv') || element.querySelector('.e-stackedheadercelldiv');\n            var col;\n            if (headercelldiv) {\n                if (element.querySelector('.e-stackedheadercelldiv')) {\n                    col = gObj.getStackedHeaderColumnByHeaderText(headercelldiv.innerText.trim(), gObj.columns);\n                }\n                else {\n                    col = gObj.getColumnByUid(headercelldiv.getAttribute('e-mappinguid'));\n                }\n                _this.column = col;\n                if (_this.column.lockColumn) {\n                    return false;\n                }\n                visualElement.setAttribute('e-mappinguid', _this.column.uid);\n            }\n            if (col && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(col.headerTemplate)) {\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(col.headerTemplate)) {\n                    var colIndex = gObj.getColumnIndexByField(col.field);\n                    var result = col.getHeaderTemplate()((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({ 'index': colIndex }, col), gObj, 'headerTemplate', null, null, null, null, gObj.root);\n                    var isReactCompiler = gObj.isReact && typeof (col.headerTemplate) !== 'string';\n                    var isReactChild = gObj.parentDetails && gObj.parentDetails.parentInstObj &&\n                        gObj.parentDetails.parentInstObj.isReact;\n                    if (isReactCompiler || isReactChild) {\n                        gObj.renderTemplates();\n                    }\n                    (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.appendChildren)(visualElement, result);\n                }\n                else {\n                    visualElement.innerHTML = col.headerTemplate;\n                }\n                if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(visualElement.firstChild) && visualElement.firstChild.nodeType === 1) {\n                    visualElement.firstChild.style.pointerEvents = 'none';\n                }\n            }\n            else {\n                visualElement.innerHTML = headercelldiv ?\n                    col.headerText : element.firstElementChild.innerHTML;\n            }\n            visualElement.style.width = element.offsetWidth + 'px';\n            visualElement.style.height = element.offsetHeight + 'px';\n            visualElement.style.lineHeight = (height - 6).toString() + 'px';\n            gObj.element.appendChild(visualElement);\n            return visualElement;\n        };\n        this.dragStart = function (e) {\n            var gObj = _this.parent;\n            gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n            gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.columnDragStart, { target: _this.draggable.currentStateTarget, column: _this.column, event: e.event });\n        };\n        this.drag = function (e) {\n            var gObj = _this.parent;\n            var target = e.target;\n            if (target) {\n                var closest = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.e-grid');\n                var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n                if (!closest || closest.getAttribute('id') !== gObj.element.getAttribute('id')) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n                    if (gObj.allowReordering) {\n                        gObj.element.querySelector('.e-reorderuparrow').style.display = 'none';\n                        gObj.element.querySelector('.e-reorderdownarrow').style.display = 'none';\n                    }\n                    if (!gObj.groupSettings.allowReordering) {\n                        return;\n                    }\n                }\n                gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.columnDrag, { target: e.target, column: _this.column, event: e.event });\n            }\n        };\n        this.dragStop = function (e) {\n            var gObj = _this.parent;\n            var cancel;\n            gObj.element.querySelector('.e-gridpopup').style.display = 'none';\n            if ((!(0,_base_util__WEBPACK_IMPORTED_MODULE_1__.parentsUntil)(e.target, 'e-headercell') && !(0,_base_util__WEBPACK_IMPORTED_MODULE_1__.parentsUntil)(e.target, 'e-groupdroparea')) ||\n                (!gObj.allowReordering && (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.parentsUntil)(e.target, 'e-headercell')) ||\n                (!e.helper.getAttribute('e-mappinguid') && (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.parentsUntil)(e.target, 'e-groupdroparea'))) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(e.helper);\n                cancel = true;\n            }\n            gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.columnDragStop, { target: e.target, event: e.event, column: _this.column, cancel: cancel });\n        };\n        this.drop = function (e) {\n            var gObj = _this.parent;\n            var uid = e.droppedElement.getAttribute('e-mappinguid');\n            var closest = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-grid');\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(e.droppedElement);\n            if (closest && closest.getAttribute('id') !== gObj.element.getAttribute('id') ||\n                !(gObj.allowReordering || gObj.allowGrouping)) {\n                return;\n            }\n            gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.headerDrop, { target: e.target, uid: uid, droppedElement: e.droppedElement });\n        };\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.ariaService = this.serviceLocator.getService('ariaService');\n        this.widthService = this.serviceLocator.getService('widthService');\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (!this.parent.enableColumnVirtualization) {\n            this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.columnVisibilityChanged, this.setVisible, this);\n        }\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.columnPositionChanged, this.colPosRefresh, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.initialEnd, this.renderCustomToolbar, this);\n        if (this.parent.rowRenderingMode === 'Vertical') {\n            this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.uiUpdate, this.updateCustomResponsiveToolbar, this);\n        }\n    }\n    /**\n     * The function is used to render grid header div\n     *\n     * @returns {void}\n     */\n    HeaderRender.prototype.renderPanel = function () {\n        var div = this.parent.element.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.gridHeader);\n        var isRendered = (div != null);\n        div = isRendered ? div : this.parent.createElement('div', { className: 'e-gridheader' });\n        var innerDiv = isRendered ? div.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.headerContent) :\n            this.parent.createElement('div', { className: _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.headerContent });\n        this.toggleStackClass(div);\n        div.appendChild(innerDiv);\n        this.setPanel(div);\n        if (!isRendered) {\n            this.parent.element.appendChild(div);\n        }\n    };\n    /**\n     * The function is used to render grid header div\n     *\n     * @returns {void}\n     */\n    HeaderRender.prototype.renderTable = function () {\n        var headerDiv = this.getPanel();\n        headerDiv.appendChild(this.createHeaderTable());\n        this.setTable(headerDiv.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.table));\n        this.initializeHeaderDrag();\n        this.initializeHeaderDrop();\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.headerRefreshed, { rows: this.rows });\n    };\n    /**\n     * Get the header content div element of grid\n     *\n     * @returns {Element} returns the element\n     */\n    HeaderRender.prototype.getPanel = function () {\n        return this.headerPanel;\n    };\n    /**\n     * Set the header content div element of grid\n     *\n     * @param  {Element} panel - specifies the panel element\n     * @returns {void}\n     */\n    HeaderRender.prototype.setPanel = function (panel) {\n        this.headerPanel = panel;\n    };\n    /**\n     * Get the header table element of grid\n     *\n     * @returns {Element} returns the element\n     */\n    HeaderRender.prototype.getTable = function () {\n        return this.headerTable;\n    };\n    /**\n     * Set the header table element of grid\n     *\n     * @param  {Element} table - specifies the table element\n     * @returns {void}\n     */\n    HeaderRender.prototype.setTable = function (table) {\n        this.headerTable = table;\n    };\n    /**\n     * Get the header colgroup element\n     *\n     * @returns {Element} returns the element\n     */\n    HeaderRender.prototype.getColGroup = function () {\n        return this.colgroup;\n    };\n    /**\n     * Set the header colgroup element\n     *\n     * @param {Element} colGroup - specifies the colgroup\n     * @returns {Element} returns the element\n     */\n    HeaderRender.prototype.setColGroup = function (colGroup) {\n        return this.colgroup = colGroup;\n    };\n    /**\n     * Get the header row element collection.\n     *\n     * @returns {Element[]} returns the element\n     */\n    HeaderRender.prototype.getRows = function () {\n        var table = this.getTable();\n        return table.tHead.rows;\n    };\n    /**\n     * The function is used to create header table elements\n     *\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    HeaderRender.prototype.createHeaderTable = function () {\n        var table = this.createTable();\n        var innerDiv = this.getPanel().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.headerContent);\n        innerDiv.appendChild(table);\n        return innerDiv;\n    };\n    /**\n     * The function is used to create header table elements\n     *\n     * @param {Element} tableEle - specifies the table Element\n     * @param {freezeTable} tableName - specifies the table name\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    HeaderRender.prototype.createHeader = function (tableEle, tableName) {\n        if (tableEle === void 0) { tableEle = null; }\n        var gObj = this.parent;\n        if (this.getTable()) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.getTable());\n        }\n        var table = this.parent.createElement('table', { className: _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.table, attrs: { role: 'presentation' } });\n        table.style.cssText = 'border-collapse: separate; border-spacing: .25px;';\n        var findHeaderRow = this.createHeaderContent(tableName);\n        var thead = findHeaderRow.thead;\n        var tbody = this.parent.createElement(_base_string_literals__WEBPACK_IMPORTED_MODULE_3__.tbody, { className: this.parent.frozenRows ||\n                ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.parent.editSettings.showAddNewRow) ? '' :\n                'e-hide', attrs: { role: 'rowgroup' } });\n        this.caption = this.parent.createElement('caption', { innerHTML: this.parent.element.id + '_header_table', className: 'e-hide' });\n        var colGroup = this.parent.createElement(_base_string_literals__WEBPACK_IMPORTED_MODULE_3__.colGroup);\n        var rowBody = this.parent.createElement('tr', { attrs: { role: 'row' }, className: (this.parent.enableVirtualization ||\n                this.parent.enableInfiniteScrolling) && this.parent.editSettings.showAddNewRow ? 'e-hide' : '' });\n        var bodyCell;\n        var rows = this.rows = findHeaderRow.rows;\n        for (var i = 0, len = rows.length; i < len; i++) {\n            for (var j = 0, len_1 = rows[parseInt(i.toString(), 10)].cells.length; j < len_1; j++) {\n                bodyCell = this.parent.createElement('td');\n                rowBody.appendChild(bodyCell);\n            }\n        }\n        if (gObj.allowFiltering || gObj.allowSorting || gObj.allowGrouping) {\n            table.classList.add('e-sortfilter');\n        }\n        this.updateColGroup(colGroup);\n        tbody.appendChild(rowBody);\n        table.appendChild(this.setColGroup(colGroup));\n        table.appendChild(thead);\n        table.appendChild(tbody);\n        table.appendChild(this.caption);\n        return table;\n    };\n    /**\n     * @param {Element} tableEle - specifies the column\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    HeaderRender.prototype.createTable = function (tableEle) {\n        if (tableEle === void 0) { tableEle = null; }\n        return this.createHeader(tableEle);\n    };\n    HeaderRender.prototype.createHeaderContent = function (tableName) {\n        var gObj = this.parent;\n        var columns = gObj.getColumns();\n        var thead = this.parent.createElement('thead', { attrs: { 'role': 'rowgroup' } });\n        var colHeader = this.parent.createElement('tr', { className: 'e-columnheader', attrs: { role: 'row' } });\n        var rowRenderer = new _row_renderer__WEBPACK_IMPORTED_MODULE_4__.RowRenderer(this.serviceLocator, _base_enum__WEBPACK_IMPORTED_MODULE_5__.CellType.Header, gObj);\n        rowRenderer.element = colHeader;\n        var rows = [];\n        var headerRow;\n        this.colDepth = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.measureColumnDepth)(gObj.columns);\n        for (var i = 0, len = this.colDepth; i < len; i++) {\n            rows[parseInt(i.toString(), 10)] = this.generateRow(i);\n            rows[parseInt(i.toString(), 10)].cells = [];\n        }\n        rows = this.ensureColumns(rows);\n        rows = this.getHeaderCells(rows, tableName);\n        if (gObj.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n            for (var i = 0, len = rows.length; i < len; i++) {\n                rows[parseInt(i.toString(), 10)].cells.push(this.generateCell({}, _base_enum__WEBPACK_IMPORTED_MODULE_5__.CellType.RowDragHIcon));\n            }\n        }\n        var headerTemplateColumn = columns.filter(function (a) { return a.headerTemplate; });\n        if (headerTemplateColumn.length && (this.parent.isReact || this.parent.isVue)) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.clearReactVueTemplates)(this.parent, ['headerTemplate']);\n        }\n        for (var i = 0, len = this.colDepth; i < len; i++) {\n            headerRow = rowRenderer.render(rows[parseInt(i.toString(), 10)], columns);\n            if (this.parent.rowHeight && headerRow.querySelector('.e-headercell')) {\n                headerRow.style.height = this.parent.rowHeight + 'px';\n            }\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.addFixedColumnBorder)(headerRow);\n            thead.appendChild(headerRow);\n        }\n        var findHeaderRow = {\n            thead: thead,\n            rows: rows\n        };\n        return findHeaderRow;\n    };\n    HeaderRender.prototype.updateColGroup = function (colGroup) {\n        var cols = this.parent.getColumns();\n        var col;\n        var indexes = this.parent.getColumnIndexesInView();\n        colGroup.id = this.parent.element.id + _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.colGroup;\n        if (this.parent.allowGrouping) {\n            for (var i = 0, len = this.parent.groupSettings.columns.length; i < len; i++) {\n                if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n                    continue;\n                }\n                col = this.parent.createElement('col', { className: 'e-group-intent' });\n                colGroup.appendChild(col);\n            }\n        }\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            col = this.parent.createElement('col', { className: 'e-detail-intent' });\n            colGroup.appendChild(col);\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n            col = this.parent.createElement('col', { className: 'e-drag-intent' });\n            colGroup.appendChild(col);\n        }\n        for (var i = 0, len = cols.length; i < len; i++) {\n            col = this.parent.createElement('col');\n            if (cols[parseInt(i.toString(), 10)].visible === false) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setStyleAttribute)(col, { 'display': 'none' });\n            }\n            colGroup.appendChild(col);\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n            col = this.parent.createElement('col', { className: 'e-drag-intent' });\n            colGroup.appendChild(col);\n        }\n        return colGroup;\n    };\n    HeaderRender.prototype.ensureColumns = function (rows) {\n        //TODO: generate dummy column for group, detail, stacked row here; ensureColumns here\n        var gObj = this.parent;\n        var indexes = this.parent.getColumnIndexesInView();\n        for (var i = 0, len = rows.length; i < len; i++) {\n            if (gObj.allowGrouping) {\n                for (var c = 0, len_2 = gObj.groupSettings.columns.length; c < len_2; c++) {\n                    if (this.parent.enableColumnVirtualization && indexes.indexOf(c) === -1) {\n                        continue;\n                    }\n                    rows[parseInt(i.toString(), 10)].cells.push(this.generateCell({}, _base_enum__WEBPACK_IMPORTED_MODULE_5__.CellType.HeaderIndent));\n                }\n            }\n            if (gObj.detailTemplate || gObj.childGrid) {\n                var args = {};\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.detailIndentCellInfo, args);\n                rows[parseInt(i.toString(), 10)].cells.push(this.generateCell(args, _base_enum__WEBPACK_IMPORTED_MODULE_5__.CellType.DetailHeader));\n            }\n            if (gObj.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n                rows[parseInt(i.toString(), 10)].cells.push(this.generateCell({}, _base_enum__WEBPACK_IMPORTED_MODULE_5__.CellType.RowDragHIcon));\n            }\n        }\n        return rows;\n    };\n    HeaderRender.prototype.getHeaderCells = function (rows, tableName) {\n        var thead = this.parent.getHeaderTable() && this.parent.getHeaderTable().querySelector('thead');\n        var cols = this.parent.enableColumnVirtualization ?\n            this.parent.getColumns(this.parent.enablePersistence) : this.parent.columns;\n        this.frzIdx = 0;\n        this.notfrzIdx = 0;\n        if (this.parent.lockcolPositionCount) {\n            for (var i = 0; i < (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cols) ? cols.length : 0); i++) {\n                this.lockColsRendered = false;\n                rows = this.appendCells(cols[parseInt(i.toString(), 10)], rows, 0, i === 0, false, i === (cols.length - 1), thead, tableName, false);\n            }\n        }\n        for (var i = 0, len = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cols) ? cols.length : 0); i < len; i++) {\n            this.notfrzIdx = 0;\n            this.lockColsRendered = true;\n            rows = this.appendCells(cols[parseInt(i.toString(), 10)], rows, 0, i === 0, false, i === (len - 1), thead, tableName, false);\n        }\n        return rows;\n    };\n    HeaderRender.prototype.appendCells = function (cols, rows, index, isFirstObj, isFirstCol, isLastCol, isMovable, tableName, isStackLastCol) {\n        var lastCol = isLastCol ? isStackLastCol ? 'e-laststackcell' : 'e-lastcell' : '';\n        var isLockColumn = !this.parent.lockcolPositionCount\n            || (cols.lockColumn && !this.lockColsRendered) || (!cols.lockColumn && this.lockColsRendered);\n        if (!cols.columns) {\n            if (isLockColumn) {\n                rows[parseInt(index.toString(), 10)].cells.push(this.generateCell(cols, _base_enum__WEBPACK_IMPORTED_MODULE_5__.CellType.Header, this.colDepth - index, (isFirstObj ? '' : (isFirstCol ? 'e-firstcell' : '')) + lastCol, index, this.parent.getColumnIndexByUid(cols.uid)));\n            }\n            if (this.parent.lockcolPositionCount) {\n                if ((this.frzIdx + this.notfrzIdx < this.parent.frozenColumns) &&\n                    ((cols.lockColumn && !this.lockColsRendered) || (!cols.lockColumn && this.lockColsRendered))) {\n                    this.frzIdx++;\n                }\n                else {\n                    this.notfrzIdx++;\n                }\n            }\n            else {\n                this.frzIdx++;\n            }\n        }\n        else {\n            this.isFirstCol = false;\n            var colSpan = this.getCellCnt(cols, 0);\n            if (colSpan) {\n                var stackedLockColsCount = this.getStackedLockColsCount(cols, 0);\n                var isStackedLockColumn = this.parent.lockcolPositionCount === 0\n                    || (!this.lockColsRendered && stackedLockColsCount !== 0)\n                    || (this.lockColsRendered && (colSpan - stackedLockColsCount) !== 0);\n                if (isStackedLockColumn) {\n                    rows[parseInt(index.toString(), 10)].cells.push(new _models_cell__WEBPACK_IMPORTED_MODULE_6__.Cell({\n                        cellType: _base_enum__WEBPACK_IMPORTED_MODULE_5__.CellType.StackedHeader, column: cols,\n                        colSpan: this.getColSpan(colSpan, stackedLockColsCount),\n                        className: isFirstObj ? '' : (isFirstCol ? 'e-firstcell' : '')\n                    }));\n                }\n            }\n            if (this.parent.lockcolPositionCount && !this.lockColsRendered) {\n                for (var i = 0; i < cols.columns.length; i++) {\n                    rows = this.appendCells(cols.columns[parseInt(i.toString(), 10)], rows, index + 1, isFirstObj, i === 0, i === (cols.columns.length - 1) && isLastCol, isMovable, tableName, false);\n                }\n            }\n            if (this.lockColsRendered) {\n                for (var i = 0, len = cols.columns.length; i < len; i++) {\n                    isFirstObj = isFirstObj && i === 0;\n                    var isFirstCol_1 = this.isFirstCol = cols.columns[parseInt(i.toString(), 10)].visible\n                        && !isFirstObj;\n                    var isLaststackedCol = i === (len - 1) && isLastCol;\n                    rows = this.appendCells(cols.columns[parseInt(i.toString(), 10)], rows, index + 1, isFirstObj, isFirstCol_1 && !isLaststackedCol, isLaststackedCol, isMovable, tableName, true);\n                }\n            }\n        }\n        return rows;\n    };\n    HeaderRender.prototype.getStackedLockColsCount = function (col, lockColsCount) {\n        if (col.columns) {\n            for (var i = 0; i < col.columns.length; i++) {\n                lockColsCount = this.getStackedLockColsCount(col.columns[parseInt(i.toString(), 10)], lockColsCount);\n            }\n        }\n        else if (col.lockColumn) {\n            lockColsCount++;\n        }\n        return lockColsCount;\n    };\n    HeaderRender.prototype.getColSpan = function (colSpan, stackedLockColsCount) {\n        colSpan = !this.lockColsRendered ? stackedLockColsCount : colSpan - stackedLockColsCount;\n        return colSpan;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    HeaderRender.prototype.generateRow = function (index) {\n        return new _models_row__WEBPACK_IMPORTED_MODULE_7__.Row({});\n    };\n    HeaderRender.prototype.generateCell = function (column, cellType, rowSpan, className, rowIndex, colIndex) {\n        var opt = {\n            'visible': column.visible,\n            'isDataCell': false,\n            'isTemplate': !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.headerTemplate),\n            'rowID': '',\n            'column': column,\n            'cellType': cellType,\n            'rowSpan': rowSpan,\n            'className': className,\n            'index': rowIndex,\n            'colIndex': colIndex\n        };\n        if (!opt.rowSpan || opt.rowSpan < 2) {\n            delete opt.rowSpan;\n        }\n        return new _models_cell__WEBPACK_IMPORTED_MODULE_6__.Cell(opt);\n    };\n    /**\n     * Function to hide header table column based on visible property\n     *\n     * @param {Column[]} columns - specifies the column\n     * @returns {void}\n     */\n    HeaderRender.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var displayVal;\n        var idx;\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[parseInt(c.toString(), 10)];\n            idx = gObj.getNormalizedColumnIndex(column.uid);\n            displayVal = column.visible ? '' : 'none';\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setStyleAttribute)(this.getColGroup().children[parseInt(idx.toString(), 10)], { 'display': displayVal });\n            if (gObj.editSettings.showAddNewRow && gObj.element.querySelector('.e-addedrow')) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setStyleAttribute)(gObj.element.querySelector('.e-addedrow').querySelector('colgroup').childNodes[parseInt(idx.toString(), 10)], { 'display': displayVal });\n            }\n        }\n        this.refreshUI();\n        if (this.parent.editSettings.showAddNewRow) {\n            this.parent.isAddNewRow = true;\n        }\n    };\n    HeaderRender.prototype.colPosRefresh = function () {\n        this.refreshUI();\n    };\n    /**\n     * Refresh the header of the Grid.\n     *\n     * @returns {void}\n     */\n    HeaderRender.prototype.refreshUI = function () {\n        var headerDiv = this.getPanel();\n        this.toggleStackClass(headerDiv);\n        var table = this.getTable();\n        var tableName = undefined;\n        if (table) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(table);\n            if (this.parent.editSettings.showAddNewRow && !this.parent.isAddNewRow && table.querySelector('.e-addedrow') &&\n                (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n                (table.querySelector('.e-addedrow')).classList.add('e-addrow-removed');\n                this.parent.isAddNewRow = true;\n            }\n            table.removeChild(table.firstChild);\n            table.removeChild(table.childNodes[0]);\n            var colGroup = this.parent.createElement(_base_string_literals__WEBPACK_IMPORTED_MODULE_3__.colGroup);\n            var findHeaderRow = this.createHeaderContent(tableName);\n            this.rows = findHeaderRow.rows;\n            table.insertBefore(findHeaderRow.thead, table.firstChild);\n            this.updateColGroup(colGroup);\n            table.insertBefore(this.setColGroup(colGroup), table.firstChild);\n            this.appendContent(table);\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.colGroupRefresh, {});\n            this.widthService.setWidthToColumns();\n            this.parent.updateDefaultCursor();\n            this.initializeHeaderDrag();\n            var rows = [].slice.call(headerDiv.querySelectorAll('tr.e-columnheader'));\n            for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n                var row = rows_1[_i];\n                var gCells = [].slice.call(row.getElementsByClassName('e-grouptopleftcell'));\n                if (gCells.length) {\n                    gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n                }\n            }\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.headerRefreshed, { rows: this.rows });\n            if (this.parent.enableColumnVirtualization && (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.parentsUntil)(table, _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.movableHeader)) {\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.headerRefreshed, { rows: this.rows, args: { isFrozen: false, isXaxis: true } });\n            }\n            if (this.parent.allowTextWrap && this.parent.textWrapSettings.wrapMode === 'Header') {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.wrap)(rows, true);\n            }\n        }\n        var firstHeaderCell = this.parent.getHeaderContent().querySelector('.e-headercell:not(.e-hide)');\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(firstHeaderCell)) {\n            firstHeaderCell.tabIndex = 0;\n        }\n    };\n    HeaderRender.prototype.toggleStackClass = function (div) {\n        var column = this.parent.columns;\n        var stackedHdr = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column) ? column.some(function (column) { return !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.columns); })\n            : false);\n        if (stackedHdr) {\n            div.classList.add('e-stackedheader');\n        }\n        else {\n            div.classList.remove('e-stackedheader');\n        }\n    };\n    HeaderRender.prototype.appendContent = function (table) {\n        this.getPanel().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.headerContent).appendChild(table);\n    };\n    HeaderRender.prototype.getCellCnt = function (col, cnt) {\n        if (col.columns) {\n            for (var i = 0, len = col.columns.length; i < len; i++) {\n                cnt = this.getCellCnt(col.columns[parseInt(i.toString(), 10)], cnt);\n            }\n        }\n        else {\n            if (col.visible) {\n                cnt++;\n            }\n        }\n        return cnt;\n    };\n    HeaderRender.prototype.initializeHeaderDrag = function () {\n        var gObj = this.parent;\n        if (!(this.parent.allowReordering || (this.parent.allowGrouping && this.parent.groupSettings.showDropArea))) {\n            return;\n        }\n        this.draggable = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Draggable(gObj.getHeaderContent(), {\n            dragTarget: '.e-headercell',\n            distance: 5,\n            helper: this.helper,\n            dragStart: this.dragStart,\n            drag: this.drag,\n            dragStop: this.dragStop,\n            abort: '.e-rhandler',\n            isReplaceDragEle: this.isReplaceDragEle\n        });\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.destroy, this.droppableDestroy, this);\n    };\n    HeaderRender.prototype.initializeHeaderDrop = function () {\n        var gObj = this.parent;\n        this.droppable = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Droppable(gObj.getHeaderContent(), {\n            accept: '.e-dragclone',\n            drop: this.drop\n        });\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_2__.destroy, this.droppableDestroy, this);\n    };\n    HeaderRender.prototype.droppableDestroy = function () {\n        if (this.droppable && !this.droppable.isDestroyed) {\n            this.droppable.destroy();\n        }\n        if (this.draggable && !this.draggable.isDestroyed) {\n            this.draggable.destroy();\n        }\n    };\n    HeaderRender.prototype.renderCustomToolbar = function () {\n        var _this = this;\n        var gObj = this.parent;\n        if (gObj.rowRenderingMode === 'Vertical' && !gObj.toolbar\n            && (gObj.allowSorting || (gObj.allowFiltering && gObj.filterSettings.type !== 'FilterBar'))) {\n            var div = gObj.createElement('div', { className: 'e-res-toolbar e-toolbar' });\n            var toolbarItems = gObj.createElement('div', { className: 'e-toolbar-items' });\n            var toolbarLeft = gObj.createElement('div', { className: 'e-toolbar-left' });\n            var count = this.parent.allowFiltering && this.parent.allowSorting ? 2 : 1;\n            for (var i = 0; i < count; i++) {\n                var toolbarItem = gObj.createElement('div', { className: 'e-toolbar-item e-gridresponsiveicons e-icons e-tbtn-align' });\n                var cls = count === 1 ? this.parent.allowSorting ? 'sort'\n                    : 'filter' : i === 1 ? 'sort' : 'filter';\n                var button = gObj.createElement('button', { className: 'e-tbar-btn e-control e-btn e-lib e-icon-btn' });\n                var span = gObj.createElement('span', { className: 'e-btn-icon e-res' + cls + '-icon e-icons' });\n                button.appendChild(span);\n                var btnObj = new _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_8__.Button({\n                    cssClass: this.parent.cssClass ? this.parent.cssClass : ''\n                });\n                btnObj.appendTo(button);\n                button.onclick = function (e) {\n                    if (e.target.classList.contains('e-ressort-btn')\n                        || e.target.classList.contains('e-ressort-icon') ||\n                        e.target.querySelector('.e-ressort-icon')) {\n                        _this.parent.showResponsiveCustomSort();\n                    }\n                    else {\n                        _this.parent.showResponsiveCustomFilter();\n                    }\n                };\n                toolbarItem.appendChild(button);\n                toolbarLeft.appendChild(toolbarItem);\n            }\n            toolbarItems.appendChild(toolbarLeft);\n            div.appendChild(toolbarItems);\n            gObj.element.insertBefore(div, this.parent.element.querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_3__.gridHeader));\n        }\n        else {\n            if (gObj.enableAdaptiveUI && !gObj.toolbar) {\n                gObj.getContent().classList.add('e-responsive-header');\n            }\n        }\n    };\n    HeaderRender.prototype.updateCustomResponsiveToolbar = function (args) {\n        var resToolbar = this.parent.element.querySelector('.e-responsive-toolbar');\n        if (args.module === 'toolbar') {\n            if (resToolbar) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(resToolbar);\n            }\n            else {\n                this.renderCustomToolbar();\n            }\n        }\n    };\n    return HeaderRender;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9oZWFkZXItcmVuZGVyZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFpRTtBQUN1QjtBQUN2QztBQUNUO0FBQ0s7QUFDUDtBQUNGO0FBQ087QUFDaUI7QUFDWDtBQUNtRjtBQUNoRjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QixlQUFlLGdCQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHdEQUFZO0FBQ3hDLG1FQUFtRSx1RUFBaUI7QUFDcEY7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FLDBEQUEwRDtBQUM5SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVFQUFpQjtBQUN6QyxxQkFBcUIsdUVBQWlCO0FBQ3RDO0FBQ0EseURBQXlELDREQUFNLEdBQUcsbUJBQW1CO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwREFBYztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix1RUFBaUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMkRBQXNCLElBQUksa0ZBQWtGO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsNkRBQVU7QUFDeEM7QUFDQTtBQUNBLG9CQUFvQiwr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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxzQ0FBc0M7QUFDeEYsMkRBQTJELDhCQUE4QjtBQUN6RiwwREFBMEQsNkJBQTZCO0FBQ3ZGO0FBQ0EsNEJBQTRCLFdBQVc7QUFDdkMsOERBQThELHdFQUF3RTtBQUN0STtBQUNBO0FBQ0EsNERBQTRELDBEQUEwRDtBQUN0SCx3REFBd0QsdURBQXVEO0FBQy9HO0FBQ0EsaUNBQWlDLDJEQUFNO0FBQ3ZDO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUZBQW1GLDZEQUFtQjtBQUN0RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDREQUFNO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUN1QiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL3JlbmRlcmVyL2hlYWRlci1yZW5kZXJlci5qcz9jMjI0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzTnVsbE9yVW5kZWZpbmVkLCBleHRlbmQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBzZXRTdHlsZUF0dHJpYnV0ZSwgY2xvc2VzdCBhcyBnZXRDbG9zZXN0LCByZW1vdmUgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBjbGFzc0xpc3QgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBDZWxsVHlwZSB9IGZyb20gJy4uL2Jhc2UvZW51bSc7XG5pbXBvcnQgeyBSb3dSZW5kZXJlciB9IGZyb20gJy4vcm93LXJlbmRlcmVyJztcbmltcG9ydCB7IENlbGwgfSBmcm9tICcuLi9tb2RlbHMvY2VsbCc7XG5pbXBvcnQgeyBSb3cgfSBmcm9tICcuLi9tb2RlbHMvcm93JztcbmltcG9ydCAqIGFzIGV2ZW50cyBmcm9tICcuLi9iYXNlL2NvbnN0YW50JztcbmltcG9ydCB7IERyYWdnYWJsZSwgRHJvcHBhYmxlIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJ1dHRvbnMnO1xuaW1wb3J0IHsgcGFyZW50c1VudGlsLCB3cmFwLCBtZWFzdXJlQ29sdW1uRGVwdGgsIGFwcGVuZENoaWxkcmVuLCBhZGRGaXhlZENvbHVtbkJvcmRlciwgY2xlYXJSZWFjdFZ1ZVRlbXBsYXRlcyB9IGZyb20gJy4uL2Jhc2UvdXRpbCc7XG5pbXBvcnQgKiBhcyBsaXRlcmFscyBmcm9tICcuLi9iYXNlL3N0cmluZy1saXRlcmFscyc7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgdmFsaWQtanNkb2MsIGpzZG9jL3JlcXVpcmUtcGFyYW1cbi8qKlxuICogQ29udGVudCBtb2R1bGUgaXMgdXNlZCB0byByZW5kZXIgZ3JpZCBjb250ZW50XG4gKlxuICogQGhpZGRlblxuICovXG52YXIgSGVhZGVyUmVuZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIGZvciBoZWFkZXIgcmVuZGVyZXIgbW9kdWxlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0lHcmlkfSBwYXJlbnQgLSBzcGVjaWZpZXMgdGhlIElHcmlkXG4gICAgICogQHBhcmFtIHtTZXJ2aWNlTG9jYXRvcn0gc2VydmljZUxvY2F0b3IgLSBzcGVjaWZpZXMgdGhlIHNlcnZpY2VMb2NhdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gSGVhZGVyUmVuZGVyKHBhcmVudCwgc2VydmljZUxvY2F0b3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5mcnpJZHggPSAwO1xuICAgICAgICB0aGlzLm5vdGZyeklkeCA9IDA7XG4gICAgICAgIHRoaXMuaXNGaXJzdENvbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzUmVwbGFjZURyYWdFbGUgPSB0cnVlO1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgICAgIHRoaXMuaGVscGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBnT2JqID0gX3RoaXMucGFyZW50O1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IF90aGlzLmRyYWdnYWJsZS5jdXJyZW50U3RhdGVUYXJnZXQ7XG4gICAgICAgICAgICB2YXIgcGFyZW50RWxlID0gcGFyZW50c1VudGlsKHRhcmdldCwgJ2UtaGVhZGVyY2VsbCcpO1xuICAgICAgICAgICAgaWYgKCEoZ09iai5hbGxvd1Jlb3JkZXJpbmcgfHwgZ09iai5hbGxvd0dyb3VwaW5nKSB8fCAoIWlzTnVsbE9yVW5kZWZpbmVkKHBhcmVudEVsZSlcbiAgICAgICAgICAgICAgICAmJiBwYXJlbnRFbGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1jaGVja3NlbGVjdGFsbCcpLmxlbmd0aCA+IDApKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZpc3VhbEVsZW1lbnQgPSBfdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLWNsb25lcHJvcGVydGllcyBlLWRyYWdjbG9uZSBlLWhlYWRlcmNsb25lJyB9KTtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1oZWFkZXJjZWxsJykgPyB0YXJnZXQgOiBwYXJlbnRFbGU7XG4gICAgICAgICAgICBpZiAoIWVsZW1lbnQgfHwgKCFnT2JqLmFsbG93UmVvcmRlcmluZyAmJiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1zdGFja2VkaGVhZGVyY2VsbCcpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSBlbGVtZW50Lm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIHZhciBoZWFkZXJjZWxsZGl2ID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1oZWFkZXJjZWxsZGl2JykgfHwgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1zdGFja2VkaGVhZGVyY2VsbGRpdicpO1xuICAgICAgICAgICAgdmFyIGNvbDtcbiAgICAgICAgICAgIGlmIChoZWFkZXJjZWxsZGl2KSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtc3RhY2tlZGhlYWRlcmNlbGxkaXYnKSkge1xuICAgICAgICAgICAgICAgICAgICBjb2wgPSBnT2JqLmdldFN0YWNrZWRIZWFkZXJDb2x1bW5CeUhlYWRlclRleHQoaGVhZGVyY2VsbGRpdi5pbm5lclRleHQudHJpbSgpLCBnT2JqLmNvbHVtbnMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29sID0gZ09iai5nZXRDb2x1bW5CeVVpZChoZWFkZXJjZWxsZGl2LmdldEF0dHJpYnV0ZSgnZS1tYXBwaW5ndWlkJykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5jb2x1bW4gPSBjb2w7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmNvbHVtbi5sb2NrQ29sdW1uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmlzdWFsRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2UtbWFwcGluZ3VpZCcsIF90aGlzLmNvbHVtbi51aWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbCAmJiAhaXNOdWxsT3JVbmRlZmluZWQoY29sLmhlYWRlclRlbXBsYXRlKSkge1xuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY29sLmhlYWRlclRlbXBsYXRlKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sSW5kZXggPSBnT2JqLmdldENvbHVtbkluZGV4QnlGaWVsZChjb2wuZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gY29sLmdldEhlYWRlclRlbXBsYXRlKCkoZXh0ZW5kKHsgJ2luZGV4JzogY29sSW5kZXggfSwgY29sKSwgZ09iaiwgJ2hlYWRlclRlbXBsYXRlJywgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgZ09iai5yb290KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzUmVhY3RDb21waWxlciA9IGdPYmouaXNSZWFjdCAmJiB0eXBlb2YgKGNvbC5oZWFkZXJUZW1wbGF0ZSkgIT09ICdzdHJpbmcnO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNSZWFjdENoaWxkID0gZ09iai5wYXJlbnREZXRhaWxzICYmIGdPYmoucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBnT2JqLnBhcmVudERldGFpbHMucGFyZW50SW5zdE9iai5pc1JlYWN0O1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNSZWFjdENvbXBpbGVyIHx8IGlzUmVhY3RDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ09iai5yZW5kZXJUZW1wbGF0ZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhcHBlbmRDaGlsZHJlbih2aXN1YWxFbGVtZW50LCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmlzdWFsRWxlbWVudC5pbm5lckhUTUwgPSBjb2wuaGVhZGVyVGVtcGxhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodmlzdWFsRWxlbWVudC5maXJzdENoaWxkKSAmJiB2aXN1YWxFbGVtZW50LmZpcnN0Q2hpbGQubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlzdWFsRWxlbWVudC5maXJzdENoaWxkLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmlzdWFsRWxlbWVudC5pbm5lckhUTUwgPSBoZWFkZXJjZWxsZGl2ID9cbiAgICAgICAgICAgICAgICAgICAgY29sLmhlYWRlclRleHQgOiBlbGVtZW50LmZpcnN0RWxlbWVudENoaWxkLmlubmVySFRNTDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZpc3VhbEVsZW1lbnQuc3R5bGUud2lkdGggPSBlbGVtZW50Lm9mZnNldFdpZHRoICsgJ3B4JztcbiAgICAgICAgICAgIHZpc3VhbEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gZWxlbWVudC5vZmZzZXRIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgdmlzdWFsRWxlbWVudC5zdHlsZS5saW5lSGVpZ2h0ID0gKGhlaWdodCAtIDYpLnRvU3RyaW5nKCkgKyAncHgnO1xuICAgICAgICAgICAgZ09iai5lbGVtZW50LmFwcGVuZENoaWxkKHZpc3VhbEVsZW1lbnQpO1xuICAgICAgICAgICAgcmV0dXJuIHZpc3VhbEVsZW1lbnQ7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZHJhZ1N0YXJ0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBnT2JqID0gX3RoaXMucGFyZW50O1xuICAgICAgICAgICAgZ09iai5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWdyaWRwb3B1cCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBnT2JqLm5vdGlmeShldmVudHMuY29sdW1uRHJhZ1N0YXJ0LCB7IHRhcmdldDogX3RoaXMuZHJhZ2dhYmxlLmN1cnJlbnRTdGF0ZVRhcmdldCwgY29sdW1uOiBfdGhpcy5jb2x1bW4sIGV2ZW50OiBlLmV2ZW50IH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmRyYWcgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIGdPYmogPSBfdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNsb3Nlc3QgPSBnZXRDbG9zZXN0KHRhcmdldCwgJy5lLWdyaWQnKTtcbiAgICAgICAgICAgICAgICB2YXIgY2xvbmVFbGVtZW50ID0gX3RoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtY2xvbmVwcm9wZXJ0aWVzJyk7XG4gICAgICAgICAgICAgICAgaWYgKCFjbG9zZXN0IHx8IGNsb3Nlc3QuZ2V0QXR0cmlidXRlKCdpZCcpICE9PSBnT2JqLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdpZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTGlzdChjbG9uZUVsZW1lbnQsIFsnZS1ub3RhbGxvd2VkY3VyJ10sIFsnZS1kZWZhdWx0Y3VyJ10pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ09iai5hbGxvd1Jlb3JkZXJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1yZW9yZGVydXBhcnJvdycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBnT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtcmVvcmRlcmRvd25hcnJvdycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFnT2JqLmdyb3VwU2V0dGluZ3MuYWxsb3dSZW9yZGVyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ09iai5ub3RpZnkoZXZlbnRzLmNvbHVtbkRyYWcsIHsgdGFyZ2V0OiBlLnRhcmdldCwgY29sdW1uOiBfdGhpcy5jb2x1bW4sIGV2ZW50OiBlLmV2ZW50IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmRyYWdTdG9wID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBnT2JqID0gX3RoaXMucGFyZW50O1xuICAgICAgICAgICAgdmFyIGNhbmNlbDtcbiAgICAgICAgICAgIGdPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1ncmlkcG9wdXAnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgaWYgKCghcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1oZWFkZXJjZWxsJykgJiYgIXBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JvdXBkcm9wYXJlYScpKSB8fFxuICAgICAgICAgICAgICAgICghZ09iai5hbGxvd1Jlb3JkZXJpbmcgJiYgcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1oZWFkZXJjZWxsJykpIHx8XG4gICAgICAgICAgICAgICAgKCFlLmhlbHBlci5nZXRBdHRyaWJ1dGUoJ2UtbWFwcGluZ3VpZCcpICYmIHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JvdXBkcm9wYXJlYScpKSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZShlLmhlbHBlcik7XG4gICAgICAgICAgICAgICAgY2FuY2VsID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdPYmoubm90aWZ5KGV2ZW50cy5jb2x1bW5EcmFnU3RvcCwgeyB0YXJnZXQ6IGUudGFyZ2V0LCBldmVudDogZS5ldmVudCwgY29sdW1uOiBfdGhpcy5jb2x1bW4sIGNhbmNlbDogY2FuY2VsIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmRyb3AgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIGdPYmogPSBfdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgdWlkID0gZS5kcm9wcGVkRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2UtbWFwcGluZ3VpZCcpO1xuICAgICAgICAgICAgdmFyIGNsb3Nlc3QgPSBnZXRDbG9zZXN0KGUudGFyZ2V0LCAnLmUtZ3JpZCcpO1xuICAgICAgICAgICAgcmVtb3ZlKGUuZHJvcHBlZEVsZW1lbnQpO1xuICAgICAgICAgICAgaWYgKGNsb3Nlc3QgJiYgY2xvc2VzdC5nZXRBdHRyaWJ1dGUoJ2lkJykgIT09IGdPYmouZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2lkJykgfHxcbiAgICAgICAgICAgICAgICAhKGdPYmouYWxsb3dSZW9yZGVyaW5nIHx8IGdPYmouYWxsb3dHcm91cGluZykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnT2JqLm5vdGlmeShldmVudHMuaGVhZGVyRHJvcCwgeyB0YXJnZXQ6IGUudGFyZ2V0LCB1aWQ6IHVpZCwgZHJvcHBlZEVsZW1lbnQ6IGUuZHJvcHBlZEVsZW1lbnQgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLnNlcnZpY2VMb2NhdG9yID0gc2VydmljZUxvY2F0b3I7XG4gICAgICAgIHRoaXMuYXJpYVNlcnZpY2UgPSB0aGlzLnNlcnZpY2VMb2NhdG9yLmdldFNlcnZpY2UoJ2FyaWFTZXJ2aWNlJyk7XG4gICAgICAgIHRoaXMud2lkdGhTZXJ2aWNlID0gdGhpcy5zZXJ2aWNlTG9jYXRvci5nZXRTZXJ2aWNlKCd3aWR0aFNlcnZpY2UnKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbikge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLmNvbHVtblZpc2liaWxpdHlDaGFuZ2VkLCB0aGlzLnNldFZpc2libGUsIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5jb2x1bW5Qb3NpdGlvbkNoYW5nZWQsIHRoaXMuY29sUG9zUmVmcmVzaCwgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5pbml0aWFsRW5kLCB0aGlzLnJlbmRlckN1c3RvbVRvb2xiYXIsIHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQucm93UmVuZGVyaW5nTW9kZSA9PT0gJ1ZlcnRpY2FsJykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLnVpVXBkYXRlLCB0aGlzLnVwZGF0ZUN1c3RvbVJlc3BvbnNpdmVUb29sYmFyLCB0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZnVuY3Rpb24gaXMgdXNlZCB0byByZW5kZXIgZ3JpZCBoZWFkZXIgZGl2XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBIZWFkZXJSZW5kZXIucHJvdG90eXBlLnJlbmRlclBhbmVsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGl2ID0gdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmdyaWRIZWFkZXIpO1xuICAgICAgICB2YXIgaXNSZW5kZXJlZCA9IChkaXYgIT0gbnVsbCk7XG4gICAgICAgIGRpdiA9IGlzUmVuZGVyZWQgPyBkaXYgOiB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtZ3JpZGhlYWRlcicgfSk7XG4gICAgICAgIHZhciBpbm5lckRpdiA9IGlzUmVuZGVyZWQgPyBkaXYucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5oZWFkZXJDb250ZW50KSA6XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogbGl0ZXJhbHMuaGVhZGVyQ29udGVudCB9KTtcbiAgICAgICAgdGhpcy50b2dnbGVTdGFja0NsYXNzKGRpdik7XG4gICAgICAgIGRpdi5hcHBlbmRDaGlsZChpbm5lckRpdik7XG4gICAgICAgIHRoaXMuc2V0UGFuZWwoZGl2KTtcbiAgICAgICAgaWYgKCFpc1JlbmRlcmVkKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5lbGVtZW50LmFwcGVuZENoaWxkKGRpdik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoZSBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlbmRlciBncmlkIGhlYWRlciBkaXZcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUucmVuZGVyVGFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBoZWFkZXJEaXYgPSB0aGlzLmdldFBhbmVsKCk7XG4gICAgICAgIGhlYWRlckRpdi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUhlYWRlclRhYmxlKCkpO1xuICAgICAgICB0aGlzLnNldFRhYmxlKGhlYWRlckRpdi5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLnRhYmxlKSk7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZUhlYWRlckRyYWcoKTtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplSGVhZGVyRHJvcCgpO1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmhlYWRlclJlZnJlc2hlZCwgeyByb3dzOiB0aGlzLnJvd3MgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGhlYWRlciBjb250ZW50IGRpdiBlbGVtZW50IG9mIGdyaWRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5nZXRQYW5lbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyUGFuZWw7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGhlYWRlciBjb250ZW50IGRpdiBlbGVtZW50IG9mIGdyaWRcbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0VsZW1lbnR9IHBhbmVsIC0gc3BlY2lmaWVzIHRoZSBwYW5lbCBlbGVtZW50XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5zZXRQYW5lbCA9IGZ1bmN0aW9uIChwYW5lbCkge1xuICAgICAgICB0aGlzLmhlYWRlclBhbmVsID0gcGFuZWw7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGhlYWRlciB0YWJsZSBlbGVtZW50IG9mIGdyaWRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5nZXRUYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyVGFibGU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGhlYWRlciB0YWJsZSBlbGVtZW50IG9mIGdyaWRcbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0VsZW1lbnR9IHRhYmxlIC0gc3BlY2lmaWVzIHRoZSB0YWJsZSBlbGVtZW50XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5zZXRUYWJsZSA9IGZ1bmN0aW9uICh0YWJsZSkge1xuICAgICAgICB0aGlzLmhlYWRlclRhYmxlID0gdGFibGU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGhlYWRlciBjb2xncm91cCBlbGVtZW50XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUuZ2V0Q29sR3JvdXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbGdyb3VwO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBoZWFkZXIgY29sZ3JvdXAgZWxlbWVudFxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBjb2xHcm91cCAtIHNwZWNpZmllcyB0aGUgY29sZ3JvdXBcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUuc2V0Q29sR3JvdXAgPSBmdW5jdGlvbiAoY29sR3JvdXApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sZ3JvdXAgPSBjb2xHcm91cDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCB0aGUgaGVhZGVyIHJvdyBlbGVtZW50IGNvbGxlY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudFtdfSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5nZXRSb3dzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFibGUgPSB0aGlzLmdldFRhYmxlKCk7XG4gICAgICAgIHJldHVybiB0YWJsZS50SGVhZC5yb3dzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIGhlYWRlciB0YWJsZSBlbGVtZW50c1xuICAgICAqXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5jcmVhdGVIZWFkZXJUYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRhYmxlID0gdGhpcy5jcmVhdGVUYWJsZSgpO1xuICAgICAgICB2YXIgaW5uZXJEaXYgPSB0aGlzLmdldFBhbmVsKCkucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5oZWFkZXJDb250ZW50KTtcbiAgICAgICAgaW5uZXJEaXYuYXBwZW5kQ2hpbGQodGFibGUpO1xuICAgICAgICByZXR1cm4gaW5uZXJEaXY7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUaGUgZnVuY3Rpb24gaXMgdXNlZCB0byBjcmVhdGUgaGVhZGVyIHRhYmxlIGVsZW1lbnRzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhYmxlRWxlIC0gc3BlY2lmaWVzIHRoZSB0YWJsZSBFbGVtZW50XG4gICAgICogQHBhcmFtIHtmcmVlemVUYWJsZX0gdGFibGVOYW1lIC0gc3BlY2lmaWVzIHRoZSB0YWJsZSBuYW1lXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUuY3JlYXRlSGVhZGVyID0gZnVuY3Rpb24gKHRhYmxlRWxlLCB0YWJsZU5hbWUpIHtcbiAgICAgICAgaWYgKHRhYmxlRWxlID09PSB2b2lkIDApIHsgdGFibGVFbGUgPSBudWxsOyB9XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmICh0aGlzLmdldFRhYmxlKCkpIHtcbiAgICAgICAgICAgIHJlbW92ZSh0aGlzLmdldFRhYmxlKCkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0YWJsZSA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ3RhYmxlJywgeyBjbGFzc05hbWU6IGxpdGVyYWxzLnRhYmxlLCBhdHRyczogeyByb2xlOiAncHJlc2VudGF0aW9uJyB9IH0pO1xuICAgICAgICB0YWJsZS5zdHlsZS5jc3NUZXh0ID0gJ2JvcmRlci1jb2xsYXBzZTogc2VwYXJhdGU7IGJvcmRlci1zcGFjaW5nOiAuMjVweDsnO1xuICAgICAgICB2YXIgZmluZEhlYWRlclJvdyA9IHRoaXMuY3JlYXRlSGVhZGVyQ29udGVudCh0YWJsZU5hbWUpO1xuICAgICAgICB2YXIgdGhlYWQgPSBmaW5kSGVhZGVyUm93LnRoZWFkO1xuICAgICAgICB2YXIgdGJvZHkgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KGxpdGVyYWxzLnRib2R5LCB7IGNsYXNzTmFtZTogdGhpcy5wYXJlbnQuZnJvemVuUm93cyB8fFxuICAgICAgICAgICAgICAgICgodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gfHwgdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpICYmIHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93KSA/ICcnIDpcbiAgICAgICAgICAgICAgICAnZS1oaWRlJywgYXR0cnM6IHsgcm9sZTogJ3Jvd2dyb3VwJyB9IH0pO1xuICAgICAgICB0aGlzLmNhcHRpb24gPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdjYXB0aW9uJywgeyBpbm5lckhUTUw6IHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnX2hlYWRlcl90YWJsZScsIGNsYXNzTmFtZTogJ2UtaGlkZScgfSk7XG4gICAgICAgIHZhciBjb2xHcm91cCA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQobGl0ZXJhbHMuY29sR3JvdXApO1xuICAgICAgICB2YXIgcm93Qm9keSA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJywgeyBhdHRyczogeyByb2xlOiAncm93JyB9LCBjbGFzc05hbWU6ICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fFxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSAmJiB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyA/ICdlLWhpZGUnIDogJycgfSk7XG4gICAgICAgIHZhciBib2R5Q2VsbDtcbiAgICAgICAgdmFyIHJvd3MgPSB0aGlzLnJvd3MgPSBmaW5kSGVhZGVyUm93LnJvd3M7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByb3dzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbGVuXzEgPSByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxscy5sZW5ndGg7IGogPCBsZW5fMTsgaisrKSB7XG4gICAgICAgICAgICAgICAgYm9keUNlbGwgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgICAgICAgICAgICAgIHJvd0JvZHkuYXBwZW5kQ2hpbGQoYm9keUNlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChnT2JqLmFsbG93RmlsdGVyaW5nIHx8IGdPYmouYWxsb3dTb3J0aW5nIHx8IGdPYmouYWxsb3dHcm91cGluZykge1xuICAgICAgICAgICAgdGFibGUuY2xhc3NMaXN0LmFkZCgnZS1zb3J0ZmlsdGVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVDb2xHcm91cChjb2xHcm91cCk7XG4gICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvd0JvZHkpO1xuICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0aGlzLnNldENvbEdyb3VwKGNvbEdyb3VwKSk7XG4gICAgICAgIHRhYmxlLmFwcGVuZENoaWxkKHRoZWFkKTtcbiAgICAgICAgdGFibGUuYXBwZW5kQ2hpbGQodGJvZHkpO1xuICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0aGlzLmNhcHRpb24pO1xuICAgICAgICByZXR1cm4gdGFibGU7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhYmxlRWxlIC0gc3BlY2lmaWVzIHRoZSBjb2x1bW5cbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBIZWFkZXJSZW5kZXIucHJvdG90eXBlLmNyZWF0ZVRhYmxlID0gZnVuY3Rpb24gKHRhYmxlRWxlKSB7XG4gICAgICAgIGlmICh0YWJsZUVsZSA9PT0gdm9pZCAwKSB7IHRhYmxlRWxlID0gbnVsbDsgfVxuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVIZWFkZXIodGFibGVFbGUpO1xuICAgIH07XG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5jcmVhdGVIZWFkZXJDb250ZW50ID0gZnVuY3Rpb24gKHRhYmxlTmFtZSkge1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgY29sdW1ucyA9IGdPYmouZ2V0Q29sdW1ucygpO1xuICAgICAgICB2YXIgdGhlYWQgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCd0aGVhZCcsIHsgYXR0cnM6IHsgJ3JvbGUnOiAncm93Z3JvdXAnIH0gfSk7XG4gICAgICAgIHZhciBjb2xIZWFkZXIgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCd0cicsIHsgY2xhc3NOYW1lOiAnZS1jb2x1bW5oZWFkZXInLCBhdHRyczogeyByb2xlOiAncm93JyB9IH0pO1xuICAgICAgICB2YXIgcm93UmVuZGVyZXIgPSBuZXcgUm93UmVuZGVyZXIodGhpcy5zZXJ2aWNlTG9jYXRvciwgQ2VsbFR5cGUuSGVhZGVyLCBnT2JqKTtcbiAgICAgICAgcm93UmVuZGVyZXIuZWxlbWVudCA9IGNvbEhlYWRlcjtcbiAgICAgICAgdmFyIHJvd3MgPSBbXTtcbiAgICAgICAgdmFyIGhlYWRlclJvdztcbiAgICAgICAgdGhpcy5jb2xEZXB0aCA9IG1lYXN1cmVDb2x1bW5EZXB0aChnT2JqLmNvbHVtbnMpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5jb2xEZXB0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IHRoaXMuZ2VuZXJhdGVSb3coaSk7XG4gICAgICAgICAgICByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxscyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHJvd3MgPSB0aGlzLmVuc3VyZUNvbHVtbnMocm93cyk7XG4gICAgICAgIHJvd3MgPSB0aGlzLmdldEhlYWRlckNlbGxzKHJvd3MsIHRhYmxlTmFtZSk7XG4gICAgICAgIGlmIChnT2JqLmlzUm93RHJhZ2FibGUoKSAmJiB0aGlzLnBhcmVudC5nZXRGcm96ZW5Nb2RlKCkgPT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByb3dzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbHMucHVzaCh0aGlzLmdlbmVyYXRlQ2VsbCh7fSwgQ2VsbFR5cGUuUm93RHJhZ0hJY29uKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhlYWRlclRlbXBsYXRlQ29sdW1uID0gY29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuaGVhZGVyVGVtcGxhdGU7IH0pO1xuICAgICAgICBpZiAoaGVhZGVyVGVtcGxhdGVDb2x1bW4ubGVuZ3RoICYmICh0aGlzLnBhcmVudC5pc1JlYWN0IHx8IHRoaXMucGFyZW50LmlzVnVlKSkge1xuICAgICAgICAgICAgY2xlYXJSZWFjdFZ1ZVRlbXBsYXRlcyh0aGlzLnBhcmVudCwgWydoZWFkZXJUZW1wbGF0ZSddKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5jb2xEZXB0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBoZWFkZXJSb3cgPSByb3dSZW5kZXJlci5yZW5kZXIocm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGNvbHVtbnMpO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnJvd0hlaWdodCAmJiBoZWFkZXJSb3cucXVlcnlTZWxlY3RvcignLmUtaGVhZGVyY2VsbCcpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyUm93LnN0eWxlLmhlaWdodCA9IHRoaXMucGFyZW50LnJvd0hlaWdodCArICdweCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGRGaXhlZENvbHVtbkJvcmRlcihoZWFkZXJSb3cpO1xuICAgICAgICAgICAgdGhlYWQuYXBwZW5kQ2hpbGQoaGVhZGVyUm93KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZmluZEhlYWRlclJvdyA9IHtcbiAgICAgICAgICAgIHRoZWFkOiB0aGVhZCxcbiAgICAgICAgICAgIHJvd3M6IHJvd3NcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGZpbmRIZWFkZXJSb3c7XG4gICAgfTtcbiAgICBIZWFkZXJSZW5kZXIucHJvdG90eXBlLnVwZGF0ZUNvbEdyb3VwID0gZnVuY3Rpb24gKGNvbEdyb3VwKSB7XG4gICAgICAgIHZhciBjb2xzID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpO1xuICAgICAgICB2YXIgY29sO1xuICAgICAgICB2YXIgaW5kZXhlcyA9IHRoaXMucGFyZW50LmdldENvbHVtbkluZGV4ZXNJblZpZXcoKTtcbiAgICAgICAgY29sR3JvdXAuaWQgPSB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgbGl0ZXJhbHMuY29sR3JvdXA7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd0dyb3VwaW5nKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uICYmIGluZGV4ZXMuaW5kZXhPZihpKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbCA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2NvbCcsIHsgY2xhc3NOYW1lOiAnZS1ncm91cC1pbnRlbnQnIH0pO1xuICAgICAgICAgICAgICAgIGNvbEdyb3VwLmFwcGVuZENoaWxkKGNvbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmRldGFpbFRlbXBsYXRlIHx8IHRoaXMucGFyZW50LmNoaWxkR3JpZCkge1xuICAgICAgICAgICAgY29sID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnY29sJywgeyBjbGFzc05hbWU6ICdlLWRldGFpbC1pbnRlbnQnIH0pO1xuICAgICAgICAgICAgY29sR3JvdXAuYXBwZW5kQ2hpbGQoY29sKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNSb3dEcmFnYWJsZSgpICYmIHRoaXMucGFyZW50LmdldEZyb3plbk1vZGUoKSAhPT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgY29sID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnY29sJywgeyBjbGFzc05hbWU6ICdlLWRyYWctaW50ZW50JyB9KTtcbiAgICAgICAgICAgIGNvbEdyb3VwLmFwcGVuZENoaWxkKGNvbCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNvbHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGNvbCA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ2NvbCcpO1xuICAgICAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgc2V0U3R5bGVBdHRyaWJ1dGUoY29sLCB7ICdkaXNwbGF5JzogJ25vbmUnIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29sR3JvdXAuYXBwZW5kQ2hpbGQoY29sKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNSb3dEcmFnYWJsZSgpICYmIHRoaXMucGFyZW50LmdldEZyb3plbk1vZGUoKSA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgY29sID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnY29sJywgeyBjbGFzc05hbWU6ICdlLWRyYWctaW50ZW50JyB9KTtcbiAgICAgICAgICAgIGNvbEdyb3VwLmFwcGVuZENoaWxkKGNvbCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbEdyb3VwO1xuICAgIH07XG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5lbnN1cmVDb2x1bW5zID0gZnVuY3Rpb24gKHJvd3MpIHtcbiAgICAgICAgLy9UT0RPOiBnZW5lcmF0ZSBkdW1teSBjb2x1bW4gZm9yIGdyb3VwLCBkZXRhaWwsIHN0YWNrZWQgcm93IGhlcmU7IGVuc3VyZUNvbHVtbnMgaGVyZVxuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgaW5kZXhlcyA9IHRoaXMucGFyZW50LmdldENvbHVtbkluZGV4ZXNJblZpZXcoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJvd3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChnT2JqLmFsbG93R3JvdXBpbmcpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMCwgbGVuXzIgPSBnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGg7IGMgPCBsZW5fMjsgYysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJiBpbmRleGVzLmluZGV4T2YoYykgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxscy5wdXNoKHRoaXMuZ2VuZXJhdGVDZWxsKHt9LCBDZWxsVHlwZS5IZWFkZXJJbmRlbnQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ09iai5kZXRhaWxUZW1wbGF0ZSB8fCBnT2JqLmNoaWxkR3JpZCkge1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0ge307XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5kZXRhaWxJbmRlbnRDZWxsSW5mbywgYXJncyk7XG4gICAgICAgICAgICAgICAgcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbHMucHVzaCh0aGlzLmdlbmVyYXRlQ2VsbChhcmdzLCBDZWxsVHlwZS5EZXRhaWxIZWFkZXIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnT2JqLmlzUm93RHJhZ2FibGUoKSAmJiB0aGlzLnBhcmVudC5nZXRGcm96ZW5Nb2RlKCkgIT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgICAgICByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxscy5wdXNoKHRoaXMuZ2VuZXJhdGVDZWxsKHt9LCBDZWxsVHlwZS5Sb3dEcmFnSEljb24pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcm93cztcbiAgICB9O1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUuZ2V0SGVhZGVyQ2VsbHMgPSBmdW5jdGlvbiAocm93cywgdGFibGVOYW1lKSB7XG4gICAgICAgIHZhciB0aGVhZCA9IHRoaXMucGFyZW50LmdldEhlYWRlclRhYmxlKCkgJiYgdGhpcy5wYXJlbnQuZ2V0SGVhZGVyVGFibGUoKS5xdWVyeVNlbGVjdG9yKCd0aGVhZCcpO1xuICAgICAgICB2YXIgY29scyA9IHRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uID9cbiAgICAgICAgICAgIHRoaXMucGFyZW50LmdldENvbHVtbnModGhpcy5wYXJlbnQuZW5hYmxlUGVyc2lzdGVuY2UpIDogdGhpcy5wYXJlbnQuY29sdW1ucztcbiAgICAgICAgdGhpcy5mcnpJZHggPSAwO1xuICAgICAgICB0aGlzLm5vdGZyeklkeCA9IDA7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5sb2NrY29sUG9zaXRpb25Db3VudCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAoIWlzTnVsbE9yVW5kZWZpbmVkKGNvbHMpID8gY29scy5sZW5ndGggOiAwKTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2NrQ29sc1JlbmRlcmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcm93cyA9IHRoaXMuYXBwZW5kQ2VsbHMoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHJvd3MsIDAsIGkgPT09IDAsIGZhbHNlLCBpID09PSAoY29scy5sZW5ndGggLSAxKSwgdGhlYWQsIHRhYmxlTmFtZSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSAoIWlzTnVsbE9yVW5kZWZpbmVkKGNvbHMpID8gY29scy5sZW5ndGggOiAwKTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLm5vdGZyeklkeCA9IDA7XG4gICAgICAgICAgICB0aGlzLmxvY2tDb2xzUmVuZGVyZWQgPSB0cnVlO1xuICAgICAgICAgICAgcm93cyA9IHRoaXMuYXBwZW5kQ2VsbHMoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHJvd3MsIDAsIGkgPT09IDAsIGZhbHNlLCBpID09PSAobGVuIC0gMSksIHRoZWFkLCB0YWJsZU5hbWUsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcm93cztcbiAgICB9O1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUuYXBwZW5kQ2VsbHMgPSBmdW5jdGlvbiAoY29scywgcm93cywgaW5kZXgsIGlzRmlyc3RPYmosIGlzRmlyc3RDb2wsIGlzTGFzdENvbCwgaXNNb3ZhYmxlLCB0YWJsZU5hbWUsIGlzU3RhY2tMYXN0Q29sKSB7XG4gICAgICAgIHZhciBsYXN0Q29sID0gaXNMYXN0Q29sID8gaXNTdGFja0xhc3RDb2wgPyAnZS1sYXN0c3RhY2tjZWxsJyA6ICdlLWxhc3RjZWxsJyA6ICcnO1xuICAgICAgICB2YXIgaXNMb2NrQ29sdW1uID0gIXRoaXMucGFyZW50LmxvY2tjb2xQb3NpdGlvbkNvdW50XG4gICAgICAgICAgICB8fCAoY29scy5sb2NrQ29sdW1uICYmICF0aGlzLmxvY2tDb2xzUmVuZGVyZWQpIHx8ICghY29scy5sb2NrQ29sdW1uICYmIHRoaXMubG9ja0NvbHNSZW5kZXJlZCk7XG4gICAgICAgIGlmICghY29scy5jb2x1bW5zKSB7XG4gICAgICAgICAgICBpZiAoaXNMb2NrQ29sdW1uKSB7XG4gICAgICAgICAgICAgICAgcm93c1twYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldLmNlbGxzLnB1c2godGhpcy5nZW5lcmF0ZUNlbGwoY29scywgQ2VsbFR5cGUuSGVhZGVyLCB0aGlzLmNvbERlcHRoIC0gaW5kZXgsIChpc0ZpcnN0T2JqID8gJycgOiAoaXNGaXJzdENvbCA/ICdlLWZpcnN0Y2VsbCcgOiAnJykpICsgbGFzdENvbCwgaW5kZXgsIHRoaXMucGFyZW50LmdldENvbHVtbkluZGV4QnlVaWQoY29scy51aWQpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQubG9ja2NvbFBvc2l0aW9uQ291bnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoKHRoaXMuZnJ6SWR4ICsgdGhpcy5ub3RmcnpJZHggPCB0aGlzLnBhcmVudC5mcm96ZW5Db2x1bW5zKSAmJlxuICAgICAgICAgICAgICAgICAgICAoKGNvbHMubG9ja0NvbHVtbiAmJiAhdGhpcy5sb2NrQ29sc1JlbmRlcmVkKSB8fCAoIWNvbHMubG9ja0NvbHVtbiAmJiB0aGlzLmxvY2tDb2xzUmVuZGVyZWQpKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZyeklkeCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RmcnpJZHgrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZyeklkeCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5pc0ZpcnN0Q29sID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgY29sU3BhbiA9IHRoaXMuZ2V0Q2VsbENudChjb2xzLCAwKTtcbiAgICAgICAgICAgIGlmIChjb2xTcGFuKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YWNrZWRMb2NrQ29sc0NvdW50ID0gdGhpcy5nZXRTdGFja2VkTG9ja0NvbHNDb3VudChjb2xzLCAwKTtcbiAgICAgICAgICAgICAgICB2YXIgaXNTdGFja2VkTG9ja0NvbHVtbiA9IHRoaXMucGFyZW50LmxvY2tjb2xQb3NpdGlvbkNvdW50ID09PSAwXG4gICAgICAgICAgICAgICAgICAgIHx8ICghdGhpcy5sb2NrQ29sc1JlbmRlcmVkICYmIHN0YWNrZWRMb2NrQ29sc0NvdW50ICE9PSAwKVxuICAgICAgICAgICAgICAgICAgICB8fCAodGhpcy5sb2NrQ29sc1JlbmRlcmVkICYmIChjb2xTcGFuIC0gc3RhY2tlZExvY2tDb2xzQ291bnQpICE9PSAwKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNTdGFja2VkTG9ja0NvbHVtbikge1xuICAgICAgICAgICAgICAgICAgICByb3dzW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0uY2VsbHMucHVzaChuZXcgQ2VsbCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsVHlwZTogQ2VsbFR5cGUuU3RhY2tlZEhlYWRlciwgY29sdW1uOiBjb2xzLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sU3BhbjogdGhpcy5nZXRDb2xTcGFuKGNvbFNwYW4sIHN0YWNrZWRMb2NrQ29sc0NvdW50KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogaXNGaXJzdE9iaiA/ICcnIDogKGlzRmlyc3RDb2wgPyAnZS1maXJzdGNlbGwnIDogJycpXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQubG9ja2NvbFBvc2l0aW9uQ291bnQgJiYgIXRoaXMubG9ja0NvbHNSZW5kZXJlZCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29scy5jb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd3MgPSB0aGlzLmFwcGVuZENlbGxzKGNvbHMuY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHJvd3MsIGluZGV4ICsgMSwgaXNGaXJzdE9iaiwgaSA9PT0gMCwgaSA9PT0gKGNvbHMuY29sdW1ucy5sZW5ndGggLSAxKSAmJiBpc0xhc3RDb2wsIGlzTW92YWJsZSwgdGFibGVOYW1lLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubG9ja0NvbHNSZW5kZXJlZCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb2xzLmNvbHVtbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaXNGaXJzdE9iaiA9IGlzRmlyc3RPYmogJiYgaSA9PT0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzRmlyc3RDb2xfMSA9IHRoaXMuaXNGaXJzdENvbCA9IGNvbHMuY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgIWlzRmlyc3RPYmo7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc0xhc3RzdGFja2VkQ29sID0gaSA9PT0gKGxlbiAtIDEpICYmIGlzTGFzdENvbDtcbiAgICAgICAgICAgICAgICAgICAgcm93cyA9IHRoaXMuYXBwZW5kQ2VsbHMoY29scy5jb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgcm93cywgaW5kZXggKyAxLCBpc0ZpcnN0T2JqLCBpc0ZpcnN0Q29sXzEgJiYgIWlzTGFzdHN0YWNrZWRDb2wsIGlzTGFzdHN0YWNrZWRDb2wsIGlzTW92YWJsZSwgdGFibGVOYW1lLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJvd3M7XG4gICAgfTtcbiAgICBIZWFkZXJSZW5kZXIucHJvdG90eXBlLmdldFN0YWNrZWRMb2NrQ29sc0NvdW50ID0gZnVuY3Rpb24gKGNvbCwgbG9ja0NvbHNDb3VudCkge1xuICAgICAgICBpZiAoY29sLmNvbHVtbnMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sLmNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsb2NrQ29sc0NvdW50ID0gdGhpcy5nZXRTdGFja2VkTG9ja0NvbHNDb3VudChjb2wuY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGxvY2tDb2xzQ291bnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbC5sb2NrQ29sdW1uKSB7XG4gICAgICAgICAgICBsb2NrQ29sc0NvdW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxvY2tDb2xzQ291bnQ7XG4gICAgfTtcbiAgICBIZWFkZXJSZW5kZXIucHJvdG90eXBlLmdldENvbFNwYW4gPSBmdW5jdGlvbiAoY29sU3Bhbiwgc3RhY2tlZExvY2tDb2xzQ291bnQpIHtcbiAgICAgICAgY29sU3BhbiA9ICF0aGlzLmxvY2tDb2xzUmVuZGVyZWQgPyBzdGFja2VkTG9ja0NvbHNDb3VudCA6IGNvbFNwYW4gLSBzdGFja2VkTG9ja0NvbHNDb3VudDtcbiAgICAgICAgcmV0dXJuIGNvbFNwYW47XG4gICAgfTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5nZW5lcmF0ZVJvdyA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gbmV3IFJvdyh7fSk7XG4gICAgfTtcbiAgICBIZWFkZXJSZW5kZXIucHJvdG90eXBlLmdlbmVyYXRlQ2VsbCA9IGZ1bmN0aW9uIChjb2x1bW4sIGNlbGxUeXBlLCByb3dTcGFuLCBjbGFzc05hbWUsIHJvd0luZGV4LCBjb2xJbmRleCkge1xuICAgICAgICB2YXIgb3B0ID0ge1xuICAgICAgICAgICAgJ3Zpc2libGUnOiBjb2x1bW4udmlzaWJsZSxcbiAgICAgICAgICAgICdpc0RhdGFDZWxsJzogZmFsc2UsXG4gICAgICAgICAgICAnaXNUZW1wbGF0ZSc6ICFpc051bGxPclVuZGVmaW5lZChjb2x1bW4uaGVhZGVyVGVtcGxhdGUpLFxuICAgICAgICAgICAgJ3Jvd0lEJzogJycsXG4gICAgICAgICAgICAnY29sdW1uJzogY29sdW1uLFxuICAgICAgICAgICAgJ2NlbGxUeXBlJzogY2VsbFR5cGUsXG4gICAgICAgICAgICAncm93U3Bhbic6IHJvd1NwYW4sXG4gICAgICAgICAgICAnY2xhc3NOYW1lJzogY2xhc3NOYW1lLFxuICAgICAgICAgICAgJ2luZGV4Jzogcm93SW5kZXgsXG4gICAgICAgICAgICAnY29sSW5kZXgnOiBjb2xJbmRleFxuICAgICAgICB9O1xuICAgICAgICBpZiAoIW9wdC5yb3dTcGFuIHx8IG9wdC5yb3dTcGFuIDwgMikge1xuICAgICAgICAgICAgZGVsZXRlIG9wdC5yb3dTcGFuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgQ2VsbChvcHQpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdG8gaGlkZSBoZWFkZXIgdGFibGUgY29sdW1uIGJhc2VkIG9uIHZpc2libGUgcHJvcGVydHlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Q29sdW1uW119IGNvbHVtbnMgLSBzcGVjaWZpZXMgdGhlIGNvbHVtblxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUuc2V0VmlzaWJsZSA9IGZ1bmN0aW9uIChjb2x1bW5zKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciBkaXNwbGF5VmFsO1xuICAgICAgICB2YXIgaWR4O1xuICAgICAgICBmb3IgKHZhciBjID0gMCwgY2xlbiA9IGNvbHVtbnMubGVuZ3RoOyBjIDwgY2xlbjsgYysrKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1uID0gY29sdW1uc1twYXJzZUludChjLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICBpZHggPSBnT2JqLmdldE5vcm1hbGl6ZWRDb2x1bW5JbmRleChjb2x1bW4udWlkKTtcbiAgICAgICAgICAgIGRpc3BsYXlWYWwgPSBjb2x1bW4udmlzaWJsZSA/ICcnIDogJ25vbmUnO1xuICAgICAgICAgICAgc2V0U3R5bGVBdHRyaWJ1dGUodGhpcy5nZXRDb2xHcm91cCgpLmNoaWxkcmVuW3BhcnNlSW50KGlkeC50b1N0cmluZygpLCAxMCldLCB7ICdkaXNwbGF5JzogZGlzcGxheVZhbCB9KTtcbiAgICAgICAgICAgIGlmIChnT2JqLmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIGdPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1hZGRlZHJvdycpKSB7XG4gICAgICAgICAgICAgICAgc2V0U3R5bGVBdHRyaWJ1dGUoZ09iai5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWFkZGVkcm93JykucXVlcnlTZWxlY3RvcignY29sZ3JvdXAnKS5jaGlsZE5vZGVzW3BhcnNlSW50KGlkeC50b1N0cmluZygpLCAxMCldLCB7ICdkaXNwbGF5JzogZGlzcGxheVZhbCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZnJlc2hVSSgpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmlzQWRkTmV3Um93ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5jb2xQb3NSZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlZnJlc2hVSSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVmcmVzaCB0aGUgaGVhZGVyIG9mIHRoZSBHcmlkLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5yZWZyZXNoVUkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBoZWFkZXJEaXYgPSB0aGlzLmdldFBhbmVsKCk7XG4gICAgICAgIHRoaXMudG9nZ2xlU3RhY2tDbGFzcyhoZWFkZXJEaXYpO1xuICAgICAgICB2YXIgdGFibGUgPSB0aGlzLmdldFRhYmxlKCk7XG4gICAgICAgIHZhciB0YWJsZU5hbWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmICh0YWJsZSkge1xuICAgICAgICAgICAgcmVtb3ZlKHRhYmxlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJiAhdGhpcy5wYXJlbnQuaXNBZGROZXdSb3cgJiYgdGFibGUucXVlcnlTZWxlY3RvcignLmUtYWRkZWRyb3cnKSAmJlxuICAgICAgICAgICAgICAgICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZykpIHtcbiAgICAgICAgICAgICAgICAodGFibGUucXVlcnlTZWxlY3RvcignLmUtYWRkZWRyb3cnKSkuY2xhc3NMaXN0LmFkZCgnZS1hZGRyb3ctcmVtb3ZlZCcpO1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmlzQWRkTmV3Um93ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhYmxlLnJlbW92ZUNoaWxkKHRhYmxlLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgdGFibGUucmVtb3ZlQ2hpbGQodGFibGUuY2hpbGROb2Rlc1swXSk7XG4gICAgICAgICAgICB2YXIgY29sR3JvdXAgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KGxpdGVyYWxzLmNvbEdyb3VwKTtcbiAgICAgICAgICAgIHZhciBmaW5kSGVhZGVyUm93ID0gdGhpcy5jcmVhdGVIZWFkZXJDb250ZW50KHRhYmxlTmFtZSk7XG4gICAgICAgICAgICB0aGlzLnJvd3MgPSBmaW5kSGVhZGVyUm93LnJvd3M7XG4gICAgICAgICAgICB0YWJsZS5pbnNlcnRCZWZvcmUoZmluZEhlYWRlclJvdy50aGVhZCwgdGFibGUuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbEdyb3VwKGNvbEdyb3VwKTtcbiAgICAgICAgICAgIHRhYmxlLmluc2VydEJlZm9yZSh0aGlzLnNldENvbEdyb3VwKGNvbEdyb3VwKSwgdGFibGUuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB0aGlzLmFwcGVuZENvbnRlbnQodGFibGUpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5jb2xHcm91cFJlZnJlc2gsIHt9KTtcbiAgICAgICAgICAgIHRoaXMud2lkdGhTZXJ2aWNlLnNldFdpZHRoVG9Db2x1bW5zKCk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC51cGRhdGVEZWZhdWx0Q3Vyc29yKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemVIZWFkZXJEcmFnKCk7XG4gICAgICAgICAgICB2YXIgcm93cyA9IFtdLnNsaWNlLmNhbGwoaGVhZGVyRGl2LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyLmUtY29sdW1uaGVhZGVyJykpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCByb3dzXzEgPSByb3dzOyBfaSA8IHJvd3NfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcm93ID0gcm93c18xW19pXTtcbiAgICAgICAgICAgICAgICB2YXIgZ0NlbGxzID0gW10uc2xpY2UuY2FsbChyb3cuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1ncm91cHRvcGxlZnRjZWxsJykpO1xuICAgICAgICAgICAgICAgIGlmIChnQ2VsbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdDZWxsc1tnQ2VsbHMubGVuZ3RoIC0gMV0uY2xhc3NMaXN0LmFkZCgnZS1sYXN0Z3JvdXB0b3BsZWZ0Y2VsbCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMuaGVhZGVyUmVmcmVzaGVkLCB7IHJvd3M6IHRoaXMucm93cyB9KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJiBwYXJlbnRzVW50aWwodGFibGUsIGxpdGVyYWxzLm1vdmFibGVIZWFkZXIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5oZWFkZXJSZWZyZXNoZWQsIHsgcm93czogdGhpcy5yb3dzLCBhcmdzOiB7IGlzRnJvemVuOiBmYWxzZSwgaXNYYXhpczogdHJ1ZSB9IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93VGV4dFdyYXAgJiYgdGhpcy5wYXJlbnQudGV4dFdyYXBTZXR0aW5ncy53cmFwTW9kZSA9PT0gJ0hlYWRlcicpIHtcbiAgICAgICAgICAgICAgICB3cmFwKHJvd3MsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBmaXJzdEhlYWRlckNlbGwgPSB0aGlzLnBhcmVudC5nZXRIZWFkZXJDb250ZW50KCkucXVlcnlTZWxlY3RvcignLmUtaGVhZGVyY2VsbDpub3QoLmUtaGlkZSknKTtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChmaXJzdEhlYWRlckNlbGwpKSB7XG4gICAgICAgICAgICBmaXJzdEhlYWRlckNlbGwudGFiSW5kZXggPSAwO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBIZWFkZXJSZW5kZXIucHJvdG90eXBlLnRvZ2dsZVN0YWNrQ2xhc3MgPSBmdW5jdGlvbiAoZGl2KSB7XG4gICAgICAgIHZhciBjb2x1bW4gPSB0aGlzLnBhcmVudC5jb2x1bW5zO1xuICAgICAgICB2YXIgc3RhY2tlZEhkciA9ICghaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uKSA/IGNvbHVtbi5zb21lKGZ1bmN0aW9uIChjb2x1bW4pIHsgcmV0dXJuICFpc051bGxPclVuZGVmaW5lZChjb2x1bW4uY29sdW1ucyk7IH0pXG4gICAgICAgICAgICA6IGZhbHNlKTtcbiAgICAgICAgaWYgKHN0YWNrZWRIZHIpIHtcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdlLXN0YWNrZWRoZWFkZXInKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKCdlLXN0YWNrZWRoZWFkZXInKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5hcHBlbmRDb250ZW50ID0gZnVuY3Rpb24gKHRhYmxlKSB7XG4gICAgICAgIHRoaXMuZ2V0UGFuZWwoKS5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmhlYWRlckNvbnRlbnQpLmFwcGVuZENoaWxkKHRhYmxlKTtcbiAgICB9O1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUuZ2V0Q2VsbENudCA9IGZ1bmN0aW9uIChjb2wsIGNudCkge1xuICAgICAgICBpZiAoY29sLmNvbHVtbnMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb2wuY29sdW1ucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGNudCA9IHRoaXMuZ2V0Q2VsbENudChjb2wuY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGNudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoY29sLnZpc2libGUpIHtcbiAgICAgICAgICAgICAgICBjbnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY250O1xuICAgIH07XG4gICAgSGVhZGVyUmVuZGVyLnByb3RvdHlwZS5pbml0aWFsaXplSGVhZGVyRHJhZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKCEodGhpcy5wYXJlbnQuYWxsb3dSZW9yZGVyaW5nIHx8ICh0aGlzLnBhcmVudC5hbGxvd0dyb3VwaW5nICYmIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3Muc2hvd0Ryb3BBcmVhKSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRyYWdnYWJsZSA9IG5ldyBEcmFnZ2FibGUoZ09iai5nZXRIZWFkZXJDb250ZW50KCksIHtcbiAgICAgICAgICAgIGRyYWdUYXJnZXQ6ICcuZS1oZWFkZXJjZWxsJyxcbiAgICAgICAgICAgIGRpc3RhbmNlOiA1LFxuICAgICAgICAgICAgaGVscGVyOiB0aGlzLmhlbHBlcixcbiAgICAgICAgICAgIGRyYWdTdGFydDogdGhpcy5kcmFnU3RhcnQsXG4gICAgICAgICAgICBkcmFnOiB0aGlzLmRyYWcsXG4gICAgICAgICAgICBkcmFnU3RvcDogdGhpcy5kcmFnU3RvcCxcbiAgICAgICAgICAgIGFib3J0OiAnLmUtcmhhbmRsZXInLFxuICAgICAgICAgICAgaXNSZXBsYWNlRHJhZ0VsZTogdGhpcy5pc1JlcGxhY2VEcmFnRWxlXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuZGVzdHJveSwgdGhpcy5kcm9wcGFibGVEZXN0cm95LCB0aGlzKTtcbiAgICB9O1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUuaW5pdGlhbGl6ZUhlYWRlckRyb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHRoaXMuZHJvcHBhYmxlID0gbmV3IERyb3BwYWJsZShnT2JqLmdldEhlYWRlckNvbnRlbnQoKSwge1xuICAgICAgICAgICAgYWNjZXB0OiAnLmUtZHJhZ2Nsb25lJyxcbiAgICAgICAgICAgIGRyb3A6IHRoaXMuZHJvcFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLmRlc3Ryb3ksIHRoaXMuZHJvcHBhYmxlRGVzdHJveSwgdGhpcyk7XG4gICAgfTtcbiAgICBIZWFkZXJSZW5kZXIucHJvdG90eXBlLmRyb3BwYWJsZURlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmRyb3BwYWJsZSAmJiAhdGhpcy5kcm9wcGFibGUuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZHJvcHBhYmxlLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5kcmFnZ2FibGUgJiYgIXRoaXMuZHJhZ2dhYmxlLmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICB0aGlzLmRyYWdnYWJsZS5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUucmVuZGVyQ3VzdG9tVG9vbGJhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKGdPYmoucm93UmVuZGVyaW5nTW9kZSA9PT0gJ1ZlcnRpY2FsJyAmJiAhZ09iai50b29sYmFyXG4gICAgICAgICAgICAmJiAoZ09iai5hbGxvd1NvcnRpbmcgfHwgKGdPYmouYWxsb3dGaWx0ZXJpbmcgJiYgZ09iai5maWx0ZXJTZXR0aW5ncy50eXBlICE9PSAnRmlsdGVyQmFyJykpKSB7XG4gICAgICAgICAgICB2YXIgZGl2ID0gZ09iai5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtcmVzLXRvb2xiYXIgZS10b29sYmFyJyB9KTtcbiAgICAgICAgICAgIHZhciB0b29sYmFySXRlbXMgPSBnT2JqLmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnZS10b29sYmFyLWl0ZW1zJyB9KTtcbiAgICAgICAgICAgIHZhciB0b29sYmFyTGVmdCA9IGdPYmouY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLXRvb2xiYXItbGVmdCcgfSk7XG4gICAgICAgICAgICB2YXIgY291bnQgPSB0aGlzLnBhcmVudC5hbGxvd0ZpbHRlcmluZyAmJiB0aGlzLnBhcmVudC5hbGxvd1NvcnRpbmcgPyAyIDogMTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciB0b29sYmFySXRlbSA9IGdPYmouY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLXRvb2xiYXItaXRlbSBlLWdyaWRyZXNwb25zaXZlaWNvbnMgZS1pY29ucyBlLXRidG4tYWxpZ24nIH0pO1xuICAgICAgICAgICAgICAgIHZhciBjbHMgPSBjb3VudCA9PT0gMSA/IHRoaXMucGFyZW50LmFsbG93U29ydGluZyA/ICdzb3J0J1xuICAgICAgICAgICAgICAgICAgICA6ICdmaWx0ZXInIDogaSA9PT0gMSA/ICdzb3J0JyA6ICdmaWx0ZXInO1xuICAgICAgICAgICAgICAgIHZhciBidXR0b24gPSBnT2JqLmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIHsgY2xhc3NOYW1lOiAnZS10YmFyLWJ0biBlLWNvbnRyb2wgZS1idG4gZS1saWIgZS1pY29uLWJ0bicgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHNwYW4gPSBnT2JqLmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2UtYnRuLWljb24gZS1yZXMnICsgY2xzICsgJy1pY29uIGUtaWNvbnMnIH0pO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChzcGFuKTtcbiAgICAgICAgICAgICAgICB2YXIgYnRuT2JqID0gbmV3IEJ1dHRvbih7XG4gICAgICAgICAgICAgICAgICAgIGNzc0NsYXNzOiB0aGlzLnBhcmVudC5jc3NDbGFzcyA/IHRoaXMucGFyZW50LmNzc0NsYXNzIDogJydcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBidG5PYmouYXBwZW5kVG8oYnV0dG9uKTtcbiAgICAgICAgICAgICAgICBidXR0b24ub25jbGljayA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtcmVzc29ydC1idG4nKVxuICAgICAgICAgICAgICAgICAgICAgICAgfHwgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJlc3NvcnQtaWNvbicpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnRhcmdldC5xdWVyeVNlbGVjdG9yKCcuZS1yZXNzb3J0LWljb24nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LnNob3dSZXNwb25zaXZlQ3VzdG9tU29ydCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LnNob3dSZXNwb25zaXZlQ3VzdG9tRmlsdGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRvb2xiYXJJdGVtLmFwcGVuZENoaWxkKGJ1dHRvbik7XG4gICAgICAgICAgICAgICAgdG9vbGJhckxlZnQuYXBwZW5kQ2hpbGQodG9vbGJhckl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG9vbGJhckl0ZW1zLmFwcGVuZENoaWxkKHRvb2xiYXJMZWZ0KTtcbiAgICAgICAgICAgIGRpdi5hcHBlbmRDaGlsZCh0b29sYmFySXRlbXMpO1xuICAgICAgICAgICAgZ09iai5lbGVtZW50Lmluc2VydEJlZm9yZShkaXYsIHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBsaXRlcmFscy5ncmlkSGVhZGVyKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZ09iai5lbmFibGVBZGFwdGl2ZVVJICYmICFnT2JqLnRvb2xiYXIpIHtcbiAgICAgICAgICAgICAgICBnT2JqLmdldENvbnRlbnQoKS5jbGFzc0xpc3QuYWRkKCdlLXJlc3BvbnNpdmUtaGVhZGVyJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEhlYWRlclJlbmRlci5wcm90b3R5cGUudXBkYXRlQ3VzdG9tUmVzcG9uc2l2ZVRvb2xiYXIgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICB2YXIgcmVzVG9vbGJhciA9IHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtcmVzcG9uc2l2ZS10b29sYmFyJyk7XG4gICAgICAgIGlmIChhcmdzLm1vZHVsZSA9PT0gJ3Rvb2xiYXInKSB7XG4gICAgICAgICAgICBpZiAocmVzVG9vbGJhcikge1xuICAgICAgICAgICAgICAgIHJlbW92ZShyZXNUb29sYmFyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQ3VzdG9tVG9vbGJhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gSGVhZGVyUmVuZGVyO1xufSgpKTtcbmV4cG9ydCB7IEhlYWRlclJlbmRlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/indent-cell-renderer.js":
/*!***************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/indent-cell-renderer.js ***!
  \***************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   IndentCellRenderer: () => (/* binding */ IndentCellRenderer)\n/* harmony export */ });\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _cell_renderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/**\n * IndentCellRenderer class which responsible for building group indent cell.\n *\n * @hidden\n */\nvar IndentCellRenderer = /** @class */ (function (_super) {\n    __extends(IndentCellRenderer, _super);\n    function IndentCellRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.element = _this.parent.createElement('TD', { className: 'e-indentcell' });\n        return _this;\n    }\n    /**\n     * Function to render the indent cell\n     *\n     * @param  {Cell} cell - specifies the cell\n     * @param  {Object} data - specifies the data\n     * @returns {Element} returns the element\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    IndentCellRenderer.prototype.render = function (cell, data) {\n        var node = this.element.cloneNode();\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_0__.setStyleAndAttributes)(node, cell.attributes);\n        return node;\n    };\n    return IndentCellRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_1__.CellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9pbmRlbnQtY2VsbC1yZW5kZXJlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ29EO0FBQ047QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELDJCQUEyQjtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLE1BQU07QUFDdEIsZ0JBQWdCLFFBQVE7QUFDeEIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsd0RBQVk7QUFDZ0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9pbmRlbnQtY2VsbC1yZW5kZXJlci5qcz82YzI3Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgc2V0U3R5bGVBbmRBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbmltcG9ydCB7IENlbGxSZW5kZXJlciB9IGZyb20gJy4vY2VsbC1yZW5kZXJlcic7XG4vKipcbiAqIEluZGVudENlbGxSZW5kZXJlciBjbGFzcyB3aGljaCByZXNwb25zaWJsZSBmb3IgYnVpbGRpbmcgZ3JvdXAgaW5kZW50IGNlbGwuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgSW5kZW50Q2VsbFJlbmRlcmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbmRlbnRDZWxsUmVuZGVyZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW5kZW50Q2VsbFJlbmRlcmVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZWxlbWVudCA9IF90aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdURCcsIHsgY2xhc3NOYW1lOiAnZS1pbmRlbnRjZWxsJyB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byByZW5kZXIgdGhlIGluZGVudCBjZWxsXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtDZWxsfSBjZWxsIC0gc3BlY2lmaWVzIHRoZSBjZWxsXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBkYXRhIC0gc3BlY2lmaWVzIHRoZSBkYXRhXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgSW5kZW50Q2VsbFJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoY2VsbCwgZGF0YSkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICAgICAgc2V0U3R5bGVBbmRBdHRyaWJ1dGVzKG5vZGUsIGNlbGwuYXR0cmlidXRlcyk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgcmV0dXJuIEluZGVudENlbGxSZW5kZXJlcjtcbn0oQ2VsbFJlbmRlcmVyKSk7XG5leHBvcnQgeyBJbmRlbnRDZWxsUmVuZGVyZXIgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/indent-cell-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/render.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/render.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Render: () => (/* binding */ Render)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/manager.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/query.js\");\n/* harmony import */ var _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! @syncfusion/ej2-data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-data@29.1.33/node_modules/@syncfusion/ej2-data/src/util.js\");\n/* harmony import */ var _services_value_formatter__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../services/value-formatter */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/value-formatter.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _actions_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../actions/data */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/actions/data.js\");\n/* harmony import */ var _models_column__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../models/column */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column.js\");\n/* harmony import */ var _models_row__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../models/row */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/row.js\");\n/* harmony import */ var _models_cell__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../models/cell */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/cell.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _renderer_content_renderer__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../renderer/content-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/content-renderer.js\");\n/* harmony import */ var _renderer_header_renderer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../renderer/header-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-renderer.js\");\n/* harmony import */ var _renderer_cell_renderer__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../renderer/cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\n/* harmony import */ var _renderer_header_cell_renderer__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../renderer/header-cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-cell-renderer.js\");\n/* harmony import */ var _renderer_stacked_cell_renderer__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../renderer/stacked-cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/stacked-cell-renderer.js\");\n/* harmony import */ var _renderer_indent_cell_renderer__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../renderer/indent-cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/indent-cell-renderer.js\");\n/* harmony import */ var _renderer_caption_cell_renderer__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../renderer/caption-cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/caption-cell-renderer.js\");\n/* harmony import */ var _renderer_expand_cell_renderer__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../renderer/expand-cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/expand-cell-renderer.js\");\n/* harmony import */ var _renderer_header_indent_renderer__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../renderer/header-indent-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/header-indent-renderer.js\");\n/* harmony import */ var _renderer_detail_header_indent_renderer__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../renderer/detail-header-indent-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/detail-header-indent-renderer.js\");\n/* harmony import */ var _renderer_detail_expand_cell_renderer__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../renderer/detail-expand-cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/detail-expand-cell-renderer.js\");\n/* harmony import */ var _row_drag_drop_renderer__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./row-drag-drop-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-drag-drop-renderer.js\");\n/* harmony import */ var _renderer_row_drag_header_indent_render__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../renderer/row-drag-header-indent-render */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-drag-header-indent-render.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Content module is used to render grid content\n *\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    /**\n     * Constructor for render module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} locator - specifies the serviceLocator\n     */\n    function Render(parent, locator) {\n        this.emptyGrid = false;\n        this.counter = 0;\n        this.parent = parent;\n        this.locator = locator;\n        this.data = new _actions_data__WEBPACK_IMPORTED_MODULE_1__.Data(parent, locator);\n        this.l10n = locator.getService('localization');\n        this.ariaService = this.locator.getService('ariaService');\n        this.renderer = this.locator.getService('rendererFactory');\n        this.addEventListener();\n    }\n    /**\n     * To initialize grid header, content and footer rendering\n     *\n     * @returns {void}\n     */\n    Render.prototype.render = function () {\n        var gObj = this.parent;\n        this.headerRenderer = this.renderer.getRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.RenderType.Header);\n        this.contentRenderer = this.renderer.getRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.RenderType.Content);\n        this.headerRenderer.renderPanel();\n        this.contentRenderer.renderPanel();\n        if (gObj.getColumns().length) {\n            this.isLayoutRendered = true;\n            this.headerRenderer.renderTable();\n            this.contentRenderer.renderTable();\n            this.emptyRow(false);\n        }\n        this.parent.scrollModule.setWidth();\n        this.parent.scrollModule.setHeight();\n        if (this.parent.height !== 'auto') {\n            this.parent.scrollModule.setPadding();\n        }\n        this.refreshDataManager();\n    };\n    /**\n     * Refresh the entire Grid.\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     */\n    Render.prototype.refresh = function (e) {\n        var _this = this;\n        if (e === void 0) { e = { requestType: 'refresh' }; }\n        var gObj = this.parent;\n        gObj.notify(e.requestType + \"-begin\", e);\n        gObj.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionBegin, e, function (args) {\n            if (args === void 0) { args = { requestType: 'refresh' }; }\n            if (args.cancel) {\n                gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.cancelBegin, args);\n                if (args.action === 'clearFilter' && _this.parent.filterSettings.type === 'Menu') {\n                    _this.parent.filterSettings.columns[_this.parent.filterModule.filterObjIndex] = _this.parent.filterModule.prevFilterObject;\n                    var iconClass = _this.parent.showColumnMenu && _this.parent.filterModule['column'].showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n                    var col = _this.parent.element.querySelector('[e-mappinguid=\"' + _this.parent.filterModule['column'].uid + '\"]').parentElement;\n                    var flIcon = col.querySelector(iconClass);\n                    if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.parent.filterModule.prevFilterObject)) {\n                        flIcon.classList.add('e-filtered');\n                    }\n                }\n                if (args.action === 'clear-filter' && (_this.parent.filterSettings.type === 'CheckBox' || _this.parent.filterSettings.type === 'Excel')) {\n                    _this.parent.filterSettings.columns = _this.parent.filterModule.checkboxPrevFilterObject;\n                }\n                if (args.requestType === 'grouping') {\n                    // Remove the dropped column name from groupsettings.columns if args.cancel is true\n                    var index = gObj.groupSettings.columns.indexOf(args.columnName);\n                    if (index !== -1) {\n                        gObj.setProperties({ groupSettings: { Columns: gObj.groupSettings.columns.splice(index, 1) } }, true);\n                        gObj.setProperties({ sortSettings: { Columns: gObj.sortSettings.columns.splice(index, 1) } }, true);\n                        var column = gObj.getColumnByField(args.columnName);\n                        var headerCell = gObj.getColumnHeaderByField(column.field);\n                        column.visible = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(headerCell) && !headerCell.classList.contains('e-hide'));\n                    }\n                }\n                return;\n            }\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.destroyEditForm, args);\n            if (args.requestType === 'virtualscroll' && (_this.parent.getDataModule().isRemote() || 'result' in _this.parent.dataSource)\n                && args.virtualInfo && args.virtualInfo.direction === 'down') {\n                _this.parent.contentModule.prevInfo = args.virtualInfo;\n            }\n            if (_this.parent.groupModule && args.preventFocusOnGroup) {\n                _this.parent.groupModule.preventFocusOnGroup = args.preventFocusOnGroup;\n            }\n            if (gObj.allowSelection && (args.action === 'clearFilter' || args.action === 'clear-filter' ||\n                (args.requestType === 'searching' && args.searchString === '') || args.action === 'add')) {\n                gObj.selectionModule['rmtHdrChkbxClicked'] = false;\n                if (gObj.selectionModule.isPartialSelection) {\n                    gObj.selectionModule['isHdrSelectAllClicked'] = false;\n                }\n            }\n            if (gObj.allowPaging && gObj.pageSettings.pageSizes && gObj.pagerModule.pagerObj.isAllPage &&\n                (args.action === 'add' && args.requestType === 'save') && gObj.pagerModule.pagerObj.checkAll) {\n                gObj.setProperties({ pageSettings: { pageSize: gObj.pageSettings.pageSize + 1 } }, true);\n            }\n            if (args.requestType === 'delete' && gObj.allowPaging) {\n                var dataLength = args.data.length;\n                var count = gObj.pageSettings.totalRecordsCount - dataLength;\n                var currentViewData = gObj.getCurrentViewRecords().length;\n                // eslint-disable-next-line max-len\n                if ((!(currentViewData - dataLength) && count && ((gObj.pageSettings.currentPage - 1) * gObj.pageSettings.pageSize) === count) || (count && count <= dataLength)) {\n                    gObj.prevPageMoving = true;\n                    gObj.setProperties({\n                        pageSettings: {\n                            totalRecordsCount: count, currentPage: Math.ceil(count / gObj.pageSettings.pageSize)\n                        }\n                    }, true);\n                    gObj.pagerModule.pagerObj.totalRecordsCount = count;\n                }\n            }\n            if (args.requestType === 'reorder' && _this.parent.dataSource && 'result' in _this.parent.dataSource) {\n                _this.contentRenderer.refreshContentRows(args);\n            }\n            else if ((args.requestType === 'paging' || args.requestType === 'columnstate' || args.requestType === 'reorder')\n                && _this.parent.groupSettings.enableLazyLoading && _this.parent.groupSettings.columns.length\n                && (_this.parent.enableVirtualization ? _this.parent.lazyLoadRender :\n                    _this.parent.contentModule).getGroupCache()[_this.parent.pageSettings.currentPage]) {\n                _this.contentRenderer.refreshContentRows(args);\n            }\n            else {\n                _this.refreshDataManager(args);\n            }\n        });\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Render.prototype.resetTemplates = function () {\n        var gObj = this.parent;\n        var gridColumns = gObj.getColumns();\n        if (gObj.detailTemplate) {\n            var detailTemplateID = gObj.element.id + 'detailTemplate';\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.blazorTemplates[\"\" + detailTemplateID] = [];\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(detailTemplateID, 'DetailTemplate');\n        }\n        if (gObj.groupSettings.captionTemplate) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(gObj.element.id + 'captionTemplate', 'CaptionTemplate');\n        }\n        if (gObj.rowTemplate) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(gObj.element.id + 'rowTemplate', 'RowTemplate');\n        }\n        if (gObj.toolbarTemplate) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(gObj.element.id + 'toolbarTemplate', 'ToolbarTemplate');\n        }\n        if (gObj.pageSettings.template) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(gObj.element.id + '_template', 'pageSettings');\n        }\n        for (var i = 0; i < gridColumns.length; i++) {\n            if (gridColumns[parseInt(i.toString(), 10)].template) {\n                _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.blazorTemplates[gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid] = [];\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid, 'Template');\n            }\n            if (gridColumns[parseInt(i.toString(), 10)].headerTemplate) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid + 'headerTemplate', 'HeaderTemplate');\n            }\n            if (gridColumns[parseInt(i.toString(), 10)].filterTemplate) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(gObj.element.id + gridColumns[parseInt(i.toString(), 10)].uid + 'filterTemplate', 'FilterTemplate');\n            }\n        }\n        var guid = 'guid';\n        for (var k = 0; k < gObj.aggregates.length; k++) {\n            for (var j = 0; j < gObj.aggregates[parseInt(k.toString(), 10)].columns.length; j++) {\n                if (gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)].footerTemplate) {\n                    var tempID = gObj.element.id + gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)][\"\" + guid] + 'footerTemplate';\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(tempID, 'FooterTemplate');\n                }\n                if (gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)].groupFooterTemplate) {\n                    var tempID = gObj.element.id + gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)][\"\" + guid] + 'groupFooterTemplate';\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(tempID, 'GroupFooterTemplate');\n                }\n                if (gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)].groupCaptionTemplate) {\n                    var tempID = gObj.element.id + gObj.aggregates[parseInt(k.toString(), 10)].columns[parseInt(j.toString(), 10)][\"\" + guid] + 'groupCaptionTemplate';\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.resetBlazorTemplate)(tempID, 'GroupCaptionTemplate');\n                }\n            }\n        }\n    };\n    Render.prototype.refreshComplete = function (e) {\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionComplete, e);\n    };\n    /**\n     * The function is used to refresh the dataManager\n     *\n     * @param {NotifyArgs} args - specifies the args\n     * @returns {void}\n     */\n    Render.prototype.refreshDataManager = function (args) {\n        var _this = this;\n        if (args === void 0) { args = {}; }\n        var gObj = this.parent;\n        var maskRow = (gObj.loadingIndicator.indicatorType === 'Shimmer' && args.requestType !== 'virtualscroll'\n            && args.requestType !== 'infiniteScroll') || ((args.requestType === 'virtualscroll' || args.requestType === 'infiniteScroll')\n            && gObj.enableVirtualMaskRow);\n        if (args.requestType !== 'virtualscroll' && !args.isCaptionCollapse && !maskRow) {\n            this.parent.showSpinner();\n        }\n        if (maskRow) {\n            gObj.showMaskRow(args.requestType === 'virtualscroll' ? args.virtualInfo.sentinelInfo.axis\n                : args.requestType === 'infiniteScroll' ? args.direction : undefined);\n        }\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.resetInfiniteBlocks, args);\n        this.emptyGrid = false;\n        var dataManager;\n        var isFActon = this.isNeedForeignAction();\n        this.ariaService.setBusy(this.parent.getContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_4__.content), true);\n        if (isFActon) {\n            var deffered = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Deferred();\n            dataManager = this.getFData(deffered, args);\n        }\n        if (!dataManager) {\n            if (gObj.allowPaging && !gObj.getDataModule().dataManager.dataSource.offline && gObj.pageSettings\n                && gObj.pageSettings.pageSizes && gObj.pagerModule && gObj.pagerModule.pagerObj && gObj.pagerModule.pagerObj.isAllPage) {\n                gObj.pagerModule.pagerObj.isAllPage = undefined;\n            }\n            dataManager = this.data.getData(args, this.data.generateQuery().requiresCount());\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            dataManager = dataManager.then(function (e) {\n                var query = _this.data.generateQuery().requiresCount();\n                if (_this.emptyGrid) {\n                    var def = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Deferred();\n                    def.resolve({ result: [], count: 0 });\n                    return def.promise;\n                }\n                return _this.data.getData(args, query);\n            });\n        }\n        var foreignKeyColumns = this.parent.getForeignKeyColumns();\n        var foreignKeyLength = foreignKeyColumns.length;\n        if (this.parent.columnQueryMode === 'ExcludeHidden' && foreignKeyLength) {\n            foreignKeyLength = foreignKeyColumns.filter(function (col) { return col.visible !== false; }).length;\n        }\n        if (foreignKeyLength && (!isFActon || this.parent.searchSettings.key.length)) {\n            var deffered_1 = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Deferred();\n            dataManager = dataManager.then(function (e) {\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.getForeignKeyData, { dataManager: dataManager, result: e, promise: deffered_1, action: args });\n                return deffered_1.promise;\n            });\n        }\n        if (this.parent.groupSettings.disablePageWiseAggregates && this.parent.groupSettings.columns.length) {\n            dataManager = dataManager.then(function (e) { return _this.validateGroupRecords(e); });\n        }\n        dataManager.then(function (e) { return _this.dataManagerSuccess(e, args); })\n            .catch(function (e) { return _this.dataManagerFailure(e, args); });\n    };\n    Render.prototype.getFData = function (deferred, args) {\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.getForeignKeyData, { isComplex: true, promise: deferred, action: args });\n        return deferred.promise;\n    };\n    Render.prototype.isNeedForeignAction = function () {\n        var gObj = this.parent;\n        return !!((gObj.allowFiltering && gObj.filterSettings.columns.length) ||\n            (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.searchSettings.key) && gObj.searchSettings.key.length))\n            && this.foreignKey(this.parent.getForeignKeyColumns());\n    };\n    Render.prototype.foreignKey = function (columns) {\n        var _this = this;\n        return columns.some(function (col) {\n            var fbool = false;\n            fbool = _this.parent.filterSettings.columns.some(function (value) {\n                return col.uid === value.uid;\n            });\n            return !!(fbool || _this.parent.searchSettings.key.length);\n        });\n    };\n    Render.prototype.sendBulkRequest = function (args) {\n        var _this = this;\n        args.requestType = 'batchsave';\n        var gObj = this.parent;\n        if (gObj.allowPaging && gObj.pageSettings.pageSizes && gObj.pagerModule.pagerObj.isAllPage && gObj.pagerModule.pagerObj.checkAll) {\n            var dataLength = args['changes'].addedRecords.length;\n            if (dataLength) {\n                gObj.setProperties({ pageSettings: { pageSize: gObj.pageSettings.pageSize + dataLength } }, true);\n            }\n        }\n        if (gObj.allowPaging && (args.changes.addedRecords.length ||\n            args.changes.deletedRecords.length ||\n            args.changes.changedRecords.length) && gObj.pageSettings\n            && gObj.pageSettings.pageSizes && gObj.pagerModule && gObj.pagerModule.pagerObj\n            && !gObj.getDataModule().dataManager.dataSource.offline && gObj.pagerModule.pagerObj.isAllPage) {\n            gObj.pagerModule.pagerObj.isAllPage = undefined;\n        }\n        var promise = this.data.saveChanges(args.changes, this.parent.getPrimaryKeyFieldNames()[0], args.original);\n        var query = this.data.generateQuery().requiresCount();\n        if (this.data.dataManager.dataSource.offline) {\n            this.refreshDataManager({ requestType: 'batchsave' });\n            return;\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            promise.then(function (e) {\n                _this.data.getData(args, query)\n                    .then(function (e) { return _this.dmSuccess(e, args); })\n                    .catch(function (e) { return _this.dmFailure(e, args); });\n            })\n                .catch(function (e) { return _this.dmFailure(e, args); });\n        }\n    };\n    Render.prototype.dmSuccess = function (e, args) {\n        this.dataManagerSuccess(e, args);\n    };\n    Render.prototype.dmFailure = function (e, args) {\n        this.dataManagerFailure(e, args);\n    };\n    /**\n     * Render empty row to Grid which is used at the time to represent to no records.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Render.prototype.renderEmptyRow = function () {\n        this.emptyRow(true);\n    };\n    Render.prototype.emptyRow = function (isTrigger) {\n        var gObj = this.parent;\n        var tbody = this.contentRenderer.getTable().querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_4__.tbody);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(tbody)) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(tbody);\n        }\n        tbody = this.parent.createElement(_base_string_literals__WEBPACK_IMPORTED_MODULE_4__.tbody, { attrs: { role: 'rowgroup' } });\n        var spanCount = gObj.allowRowDragAndDrop && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.rowDropSettings.targetID) ? 1 : 0;\n        if (gObj.detailTemplate || gObj.childGrid) {\n            ++spanCount;\n        }\n        var className = gObj.editSettings.showAddNewRow && gObj.editSettings.newRowPosition === 'Bottom' ?\n            'e-emptyrow e-show-added-row' : 'e-emptyrow';\n        var tr = this.parent.createElement('tr', { className: className, attrs: { role: 'row' } });\n        var td;\n        if (gObj.emptyRecordTemplate) {\n            var emptyRecordTemplateID = gObj.element.id + 'emptyRecordTemplate';\n            td = this.parent.createElement('td', { attrs: { colspan: (gObj.getVisibleColumns().length +\n                        spanCount + gObj.groupSettings.columns.length).toString() } });\n            if (gObj.isVue || (gObj.parentDetails && gObj.parentDetails.parentInstObj && gObj.parentDetails.parentInstObj.isVue)) {\n                td.appendChild(gObj.getEmptyRecordTemplate()(gObj.dataSource, gObj, 'emptyRecordTemplate', emptyRecordTemplateID, undefined, undefined, undefined, this.parent['root'])[1]);\n            }\n            else {\n                td.appendChild(gObj.getEmptyRecordTemplate()(gObj.dataSource, gObj, 'emptyRecordTemplate', emptyRecordTemplateID, undefined, undefined, undefined, this.parent['root'])[0]);\n            }\n            if (gObj.isReact) {\n                this.parent.renderTemplates();\n            }\n        }\n        else {\n            td = this.parent.createElement('td', {\n                innerHTML: this.l10n.getConstant('EmptyRecord'),\n                attrs: { colspan: (gObj.getVisibleColumns().length + spanCount + (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(gObj.groupSettings.columns) ?\n                        gObj.groupSettings.columns.length : 0)).toString() }\n            });\n        }\n        if (gObj.isFrozenGrid()) {\n            td.classList.add('e-leftfreeze');\n            td.style.left = 0 + 'px';\n        }\n        if (gObj.frozenRows && gObj.element.querySelector('.e-frozenrow-border')) {\n            this.parent.element.querySelector('.e-frozenrow-border').classList.add('e-frozenrow-empty');\n        }\n        tr.appendChild(td);\n        tbody.appendChild(tr);\n        this.contentRenderer.renderEmpty(tbody);\n        if (isTrigger) {\n            if (!this.parent.isInitialLoad) {\n                this.parent.focusModule.setFirstFocusableTabIndex();\n            }\n            this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.dataBound, {});\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.onEmpty, { rows: [new _models_row__WEBPACK_IMPORTED_MODULE_6__.Row({ isDataRow: true, cells: [new _models_cell__WEBPACK_IMPORTED_MODULE_7__.Cell({ isDataCell: true, visible: true })] })] });\n            if (gObj.editSettings.showAddNewRow) {\n                gObj.addRecord();\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.showAddNewRowFocus, {});\n            }\n        }\n    };\n    Render.prototype.dynamicColumnChange = function () {\n        if (this.parent.getCurrentViewRecords().length) {\n            this.updateColumnType(this.parent.getCurrentViewRecords()[0]);\n        }\n    };\n    Render.prototype.updateColumnType = function (record) {\n        var columns = this.parent.getColumns();\n        var value;\n        var cFormat = 'customFormat';\n        var equalTo = 'equalTo';\n        var data = record && record.items ? record.items[0] : record;\n        var fmtr = this.locator.getService('valueFormatter');\n        for (var i = 0, len = columns.length; i < len; i++) {\n            value = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getObject)(columns[parseInt(i.toString(), 10)].field || '', data);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns[parseInt(i.toString(), 10)][\"\" + cFormat])) {\n                columns[parseInt(i.toString(), 10)].format = columns[parseInt(i.toString(), 10)][\"\" + cFormat];\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns[parseInt(i.toString(), 10)].validationRules)\n                && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(columns[parseInt(i.toString(), 10)].validationRules[\"\" + equalTo])) {\n                columns[parseInt(i.toString(), 10)].validationRules[\"\" + equalTo][0] = this.parent.element.id + columns[parseInt(i.toString(), 10)].validationRules[\"\" + equalTo][0];\n            }\n            if (columns[parseInt(i.toString(), 10)].isForeignColumn() && columns[parseInt(i.toString(), 10)].columnData) {\n                value = (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getObject)(columns[parseInt(i.toString(), 10)].foreignKeyValue || '', columns[parseInt(i.toString(), 10)].columnData[0]);\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value)) {\n                this.isColTypeDef = true;\n                if (!columns[parseInt(i.toString(), 10)].type) {\n                    columns[parseInt(i.toString(), 10)].type = value.getDay ? (value.getHours() > 0 || value.getMinutes() > 0 ||\n                        value.getSeconds() > 0 || value.getMilliseconds() > 0 ? 'datetime' : 'date') : typeof (value);\n                }\n            }\n            else {\n                columns[parseInt(i.toString(), 10)].type = columns[parseInt(i.toString(), 10)].type || null;\n            }\n            var valueFormatter = new _services_value_formatter__WEBPACK_IMPORTED_MODULE_9__.ValueFormatter();\n            if (columns[parseInt(i.toString(), 10)].format && (columns[parseInt(i.toString(), 10)].format.skeleton\n                || (columns[parseInt(i.toString(), 10)].format.format &&\n                    typeof columns[parseInt(i.toString(), 10)].format.format === 'string'))) {\n                columns[parseInt(i.toString(), 10)].setFormatter(valueFormatter.getFormatFunction((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, columns[parseInt(i.toString(), 10)].format)));\n                columns[parseInt(i.toString(), 10)].setParser(valueFormatter.getParserFunction(columns[parseInt(i.toString(), 10)].format));\n            }\n            if (typeof (columns[parseInt(i.toString(), 10)].format) === 'string') {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.setFormatter)(this.locator, columns[parseInt(i.toString(), 10)]);\n            }\n            else if (!columns[parseInt(i.toString(), 10)].format && columns[parseInt(i.toString(), 10)].type === 'number') {\n                columns[parseInt(i.toString(), 10)].setParser(fmtr.getParserFunction({ format: 'n2' }));\n            }\n            if (columns[parseInt(i.toString(), 10)].type === 'dateonly' && !columns[parseInt(i.toString(), 10)].format) {\n                columns[parseInt(i.toString(), 10)].format = 'yMd';\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.setFormatter)(this.locator, columns[parseInt(i.toString(), 10)]);\n            }\n        }\n    };\n    /**\n     * @param {ReturnType} e - specifies the return type\n     * @param {NotifyArgs} args - specifies the Notifyargs\n     * @returns {void}\n     * @hidden\n     */\n    // tslint:disable-next-line:max-func-body-length\n    Render.prototype.dataManagerSuccess = function (e, args) {\n        var _this = this;\n        var gObj = this.parent;\n        this.contentRenderer = this.renderer.getRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.RenderType.Content);\n        this.headerRenderer = this.renderer.getRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.RenderType.Header);\n        e.actionArgs = args;\n        var detailGrid = gObj.childGrid || gObj.detailTemplate ? true : false;\n        var isInfiniteDelete = this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache &&\n            !gObj.groupSettings.enableLazyLoading && ((args.requestType === 'delete' && !detailGrid) || (args.requestType === 'save' &&\n            this.parent.infiniteScrollModule.requestType === 'add' && !(gObj.sortSettings.columns.length ||\n            gObj.filterSettings.columns.length || this.parent.groupSettings.columns.length || gObj.searchSettings.key || detailGrid)));\n        // tslint:disable-next-line:max-func-body-length\n        gObj.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.beforeDataBound, e, function (dataArgs) {\n            if (dataArgs.cancel) {\n                return;\n            }\n            dataArgs.result = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(dataArgs.result) ? [] : dataArgs.result;\n            var len = Object.keys(dataArgs.result).length;\n            if (_this.parent.isDestroyed) {\n                return;\n            }\n            if ((!gObj.getColumns().length && !len) && !(gObj.columns.length && gObj.columns[0] instanceof _models_column__WEBPACK_IMPORTED_MODULE_10__.Column)) {\n                gObj.hideSpinner();\n                return;\n            }\n            if (_this.isInfiniteEnd(args) && !len) {\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.infiniteEditHandler, { e: args, result: e.result, count: e.count, agg: e.aggregates });\n                return;\n            }\n            _this.parent.isEdit = false;\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.editReset, {});\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.tooltipDestroy, {});\n            if (args && !((args.requestType === 'infiniteScroll' || args.requestType === 'delete' || args.action === 'add') &&\n                gObj.enableInfiniteScrolling)) {\n                _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.commandColumnDestroy, { type: 'refreshCommandColumn' });\n            }\n            _this.contentRenderer.prevCurrentView = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.parent.currentViewData) && _this.parent.currentViewData.slice();\n            gObj.currentViewData = dataArgs.result;\n            gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.refreshInfiniteCurrentViewData, { args: args, data: dataArgs.result });\n            if (dataArgs.count && !gObj.allowPaging && (gObj.enableVirtualization || gObj.enableInfiniteScrolling)) {\n                gObj.totalDataRecordsCount = dataArgs.count;\n            }\n            if (!len && dataArgs.count && gObj.allowPaging && args && args.requestType !== 'delete') {\n                if (_this.parent.groupSettings.enableLazyLoading\n                    && (args.requestType === 'grouping' || args.requestType === 'ungrouping')) {\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.groupComplete, args);\n                }\n                gObj.prevPageMoving = true;\n                gObj.pageSettings.totalRecordsCount = dataArgs.count;\n                if (args.requestType !== 'paging') {\n                    gObj.pageSettings.currentPage = Math.ceil(dataArgs.count / gObj.pageSettings.pageSize);\n                }\n                gObj.dataBind();\n                return;\n            }\n            if ((!gObj.getColumns().length && len || !_this.isLayoutRendered) && !(0,_base_util__WEBPACK_IMPORTED_MODULE_8__.isGroupAdaptive)(gObj)) {\n                gObj.removeMaskRow();\n                _this.updatesOnInitialRender(dataArgs);\n            }\n            if (!_this.isColTypeDef && gObj.getCurrentViewRecords()) {\n                if (_this.data.dataManager.dataSource.offline && gObj.dataSource && gObj.dataSource.length) {\n                    _this.updateColumnType(gObj.dataSource[0]);\n                }\n                else {\n                    _this.updateColumnType(gObj.getCurrentViewRecords()[0]);\n                }\n            }\n            if (!_this.parent.isInitialLoad && _this.parent.groupSettings.disablePageWiseAggregates &&\n                !_this.parent.groupSettings.columns.length) {\n                dataArgs.result = _this.parent.dataSource instanceof Array ? _this.parent.dataSource : _this.parent.currentViewData;\n            }\n            if ((_this.parent.isReact || _this.parent.isVue) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args) && args.requestType !== 'infiniteScroll' && !args.isFrozen) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.clearReactVueTemplates)(_this.parent, ['footerTemplate']);\n            }\n            if (_this.parent.isAngular && _this.parent.allowGrouping && _this.parent.groupSettings.captionTemplate\n                && !(!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args) && args.requestType === 'infiniteScroll')) {\n                _this.parent.destroyTemplate(['groupSettings_captionTemplate']);\n            }\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.dataReady, (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({ count: dataArgs.count, result: dataArgs.result, aggregates: dataArgs.aggregates, loadSummaryOnEmpty: false }, args));\n            if ((gObj.groupSettings.columns.length || (args && args.requestType === 'ungrouping'))\n                && (args && args.requestType !== 'filtering')) {\n                _this.headerRenderer.refreshUI();\n            }\n            if (len) {\n                if ((0,_base_util__WEBPACK_IMPORTED_MODULE_8__.isGroupAdaptive)(gObj)) {\n                    var content = 'content';\n                    args.scrollTop = { top: _this.contentRenderer[\"\" + content].scrollTop };\n                }\n                if (!isInfiniteDelete) {\n                    if (_this.parent.enableImmutableMode) {\n                        _this.contentRenderer.immutableModeRendering(args);\n                    }\n                    else {\n                        _this.contentRenderer.refreshContentRows(args);\n                    }\n                }\n                else {\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.infiniteEditHandler, { e: args, result: e.result, count: e.count, agg: e.aggregates });\n                }\n            }\n            else {\n                if (args && args.isCaptionCollapse) {\n                    return;\n                }\n                if (!gObj.getColumns().length) {\n                    gObj.element.innerHTML = '';\n                    alert(_this.l10n.getConstant('EmptyDataSourceError')); //ToDO: change this alert as dialog\n                    return;\n                }\n                _this.contentRenderer.setRowElements([]);\n                _this.contentRenderer.setRowObjects([]);\n                _this.ariaService.setBusy(_this.parent.getContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_4__.content), false);\n                gObj.removeMaskRow();\n                _this.renderEmptyRow();\n                if (gObj.enableColumnVirtualization && !len) {\n                    _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.contentReady, { rows: gObj.getRowsObject(), args: {} });\n                }\n                if (args) {\n                    var action = (args.requestType || '').toLowerCase() + '-complete';\n                    _this.parent.notify(action, args);\n                    if (args.requestType === 'batchsave') {\n                        args.cancel = false;\n                        args.rows = [];\n                        args.isFrozen = !args.isFrozen;\n                        _this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionComplete, args);\n                    }\n                }\n                if (_this.parent.autoFit) {\n                    _this.parent.preventAdjustColumns();\n                }\n                _this.parent.hideSpinner();\n            }\n            _this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.toolbarRefresh, {});\n            _this.setRowCount(_this.parent.getCurrentViewRecords().length);\n            if ('query' in e) {\n                _this.parent.getDataModule().isQueryInvokedFromData = false;\n            }\n        });\n    };\n    /**\n     * @param {object} e - specifies the object\n     * @param {Object[]} e.result - specifies the result\n     * @param {NotifyArgs} args - specifies the args\n     * @returns {void}\n     * @hidden\n     */\n    Render.prototype.dataManagerFailure = function (e, args) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.contentModule)) {\n            this.ariaService.setOptions(this.parent.getContent().querySelector('.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_4__.content), { busy: false, invalid: true });\n            this.setRowCount(1);\n        }\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.actionFailure, e && e.error ? e : { error: e });\n        this.parent.hideSpinner();\n        this.parent.removeMaskRow();\n        if (args.requestType === 'save' || args.requestType === 'delete'\n            || args.name === 'bulk-save') {\n            return;\n        }\n        this.parent.currentViewData = [];\n        this.renderEmptyRow();\n        if (!this.parent.isInitialLoad) {\n            this.parent.focusModule.setFirstFocusableTabIndex();\n        }\n        this.parent.log('actionfailure', { error: e });\n    };\n    Render.prototype.setRowCount = function (dataRowCount) {\n        this.ariaService.setOptions(this.parent.element, {\n            rowcount: dataRowCount ? dataRowCount.toString() : '1'\n        });\n    };\n    Render.prototype.isInfiniteEnd = function (args) {\n        return this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache && args.requestType === 'delete';\n    };\n    Render.prototype.updatesOnInitialRender = function (e) {\n        this.isLayoutRendered = true;\n        var isEmptyCol = false;\n        if (this.parent.columns.length < 1) {\n            this.buildColumns(e.result[0]);\n            isEmptyCol = true;\n        }\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.prepareColumns)(this.parent.columns, null, this.parent);\n        if (isEmptyCol) {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.refreshSplitFrozenColumn, {});\n        }\n        this.headerRenderer.renderTable();\n        this.contentRenderer.renderTable();\n        this.parent.isAutoGen = true;\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_3__.autoCol, {});\n    };\n    Render.prototype.iterateComplexColumns = function (obj, field, split) {\n        var keys = Object.keys(obj);\n        for (var i = 0; i < keys.length; i++) {\n            var childKeys = typeof obj[keys[parseInt(i.toString(), 10)]] === 'object'\n                && obj[keys[parseInt(i.toString(), 10)]] && !(obj[keys[parseInt(i.toString(), 10)]] instanceof Date) ?\n                Object.keys(obj[keys[parseInt(i.toString(), 10)]]) : [];\n            if (childKeys.length) {\n                this.iterateComplexColumns(obj[keys[parseInt(i.toString(), 10)]], field + (keys[parseInt(i.toString(), 10)] + '.'), split);\n            }\n            else {\n                split[this.counter] = field + keys[parseInt(i.toString(), 10)];\n                this.counter++;\n            }\n        }\n    };\n    Render.prototype.buildColumns = function (record) {\n        var cols = [];\n        var complexCols = {};\n        this.iterateComplexColumns(record, '', complexCols);\n        var columns = Object.keys(complexCols).filter(function (e) { return complexCols[\"\" + e] !== 'BlazId'; }).\n            map(function (field) { return complexCols[\"\" + field]; });\n        for (var i = 0, len = columns.length; i < len; i++) {\n            cols[parseInt(i.toString(), 10)] = { 'field': columns[parseInt(i.toString(), 10)] };\n            if (this.parent.enableColumnVirtualization) {\n                cols[parseInt(i.toString(), 10)].width = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cols[parseInt(i.toString(), 10)].width) ?\n                    cols[parseInt(i.toString(), 10)].width : 200;\n            }\n        }\n        this.parent.setProperties({ 'columns': cols }, true);\n    };\n    Render.prototype.instantiateRenderer = function () {\n        this.renderer.addRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.RenderType.Header, new _renderer_header_renderer__WEBPACK_IMPORTED_MODULE_11__.HeaderRender(this.parent, this.locator));\n        this.renderer.addRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.RenderType.Content, new _renderer_content_renderer__WEBPACK_IMPORTED_MODULE_12__.ContentRender(this.parent, this.locator));\n        var cellrender = this.locator.getService('cellRendererFactory');\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Header, new _renderer_header_cell_renderer__WEBPACK_IMPORTED_MODULE_13__.HeaderCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Data, new _renderer_cell_renderer__WEBPACK_IMPORTED_MODULE_14__.CellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.StackedHeader, new _renderer_stacked_cell_renderer__WEBPACK_IMPORTED_MODULE_15__.StackedHeaderCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Indent, new _renderer_indent_cell_renderer__WEBPACK_IMPORTED_MODULE_16__.IndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.GroupCaption, new _renderer_caption_cell_renderer__WEBPACK_IMPORTED_MODULE_17__.GroupCaptionCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.GroupCaptionEmpty, new _renderer_caption_cell_renderer__WEBPACK_IMPORTED_MODULE_17__.GroupCaptionEmptyCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Expand, new _renderer_expand_cell_renderer__WEBPACK_IMPORTED_MODULE_18__.ExpandCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.HeaderIndent, new _renderer_header_indent_renderer__WEBPACK_IMPORTED_MODULE_19__.HeaderIndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.StackedHeader, new _renderer_stacked_cell_renderer__WEBPACK_IMPORTED_MODULE_15__.StackedHeaderCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.DetailHeader, new _renderer_detail_header_indent_renderer__WEBPACK_IMPORTED_MODULE_20__.DetailHeaderIndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.RowDragHIcon, new _renderer_row_drag_header_indent_render__WEBPACK_IMPORTED_MODULE_21__.RowDragDropHeaderRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.DetailExpand, new _renderer_detail_expand_cell_renderer__WEBPACK_IMPORTED_MODULE_22__.DetailExpandCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.DetailFooterIntent, new _renderer_indent_cell_renderer__WEBPACK_IMPORTED_MODULE_16__.IndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(_base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.RowDragIcon, new _row_drag_drop_renderer__WEBPACK_IMPORTED_MODULE_23__.RowDragDropRenderer(this.parent, this.locator));\n    };\n    Render.prototype.addEventListener = function () {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.initialLoad, this.instantiateRenderer, this);\n        this.parent.on('refreshdataSource', this.dataManagerSuccess, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.modelChanged, this.refresh, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.refreshComplete, this.refreshComplete, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.bulkSave, this.sendBulkRequest, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.showEmptyGrid, function () { _this.emptyGrid = true; }, this);\n        this.parent.on(_base_constant__WEBPACK_IMPORTED_MODULE_3__.autoCol, this.dynamicColumnChange, this);\n    };\n    /**\n     * @param {ReturnType} e - specifies the Return type\n     * @returns {Promise<Object>} returns the object\n     * @hidden\n     */\n    Render.prototype.validateGroupRecords = function (e) {\n        var _this = this;\n        var index = e.result.length - 1;\n        if (index < 0) {\n            return Promise.resolve(e);\n        }\n        var group0 = e.result[0];\n        var groupN = e.result[parseInt(index.toString(), 10)];\n        var predicate = [];\n        var addWhere = function (input) {\n            var groups = [group0, groupN];\n            for (var i = 0; i < groups.length; i++) {\n                predicate.push(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_24__.Predicate('field', '==', groups[parseInt(i.toString(), 10)].field).and(_this.getPredicate('key', 'equal', groups[parseInt(i.toString(), 10)].key)));\n            }\n            input.where(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_24__.Predicate.or(predicate));\n        };\n        var query = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_24__.Query();\n        addWhere(query);\n        var curDm = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(e.result);\n        var curFilter = curDm.executeLocal(query);\n        var newQuery = this.data.generateQuery(true);\n        var rPredicate = [];\n        if (this.data.isRemote()) {\n            var groups = [group0, groupN];\n            for (var i = 0; i < groups.length; i++) {\n                rPredicate.push(this.getPredicate(groups[parseInt(i.toString(), 10)].field, 'equal', groups[parseInt(i.toString(), 10)].key));\n            }\n            newQuery.where(_syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_24__.Predicate.or(rPredicate));\n        }\n        else {\n            addWhere(newQuery);\n        }\n        var deferred = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.Deferred();\n        this.data.getData({}, newQuery).then(function (r) {\n            _this.updateGroupInfo(curFilter, r.result);\n            deferred.resolve(e);\n        }).catch(function (e) { return deferred.reject(e); });\n        return deferred.promise;\n    };\n    /**\n     * @param {string} key - Defines the key\n     * @param {string} operator - Defines the operator\n     * @param {string | number | Date} value - Defines the value\n     * @returns {Predicate} - Returns the predicate\n     * @hidden */\n    Render.prototype.getPredicate = function (key, operator, value) {\n        if (value instanceof Date) {\n            return (0,_base_util__WEBPACK_IMPORTED_MODULE_8__.getDatePredicate)({ field: key, operator: operator, value: value });\n        }\n        return new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_24__.Predicate(key, operator, value);\n    };\n    /**\n     * @param {Object[]} current - Defines the current object\n     * @param {Object[]} untouched - Defines the object needs to merge\n     * @returns {Object[]} - Returns the updated group information\n     * @hidden */\n    Render.prototype.updateGroupInfo = function (current, untouched) {\n        var dm = new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_5__.DataManager(untouched);\n        var elements = current;\n        for (var i = 0; i < elements.length; i++) {\n            var updatedGroup = dm.executeLocal(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_24__.Query()\n                .where(new _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_24__.Predicate('field', '==', elements[parseInt(i.toString(), 10)].field).and(this.getPredicate('key', 'equal', elements[parseInt(i.toString(), 10)].key))))[0];\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(updatedGroup)) {\n                elements[parseInt(i.toString(), 10)].count = updatedGroup.count;\n                var itemGroup = elements[parseInt(i.toString(), 10)].items;\n                var updatedGroupItem = updatedGroup.items;\n                if (itemGroup.GroupGuid) {\n                    elements[parseInt(i.toString(), 10)].items =\n                        this.updateGroupInfo(elements[parseInt(i.toString(), 10)].items, updatedGroup.items);\n                }\n                var rows = this.parent.aggregates;\n                for (var j = 0; j < rows.length; j++) {\n                    var row = rows[parseInt(j.toString(), 10)];\n                    for (var k = 0; k < row.columns.length; k++) {\n                        var column = row.columns[parseInt(k.toString(), 10)];\n                        var types = column.type instanceof Array ? (column.type) : [(column.type)];\n                        for (var l = 0; l < types.length; l++) {\n                            var key = column.field + ' - ' + types[parseInt(l.toString(), 10)].toLowerCase();\n                            var data = itemGroup.level ? updatedGroupItem.records : updatedGroup.items;\n                            var context = this.parent;\n                            if (types[parseInt(l.toString(), 10)] === 'Custom') {\n                                var data_1 = itemGroup.level ? updatedGroupItem : updatedGroup;\n                                var temp = column\n                                    .customAggregate;\n                                if (typeof temp === 'string') {\n                                    temp = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(temp, window);\n                                }\n                                elements[parseInt(i.toString(), 10)].aggregates[\"\" + key] = temp ? temp.call(context, data_1, row.columns[parseInt(k.toString(), 10)]) : '';\n                            }\n                            else {\n                                elements[parseInt(i.toString(), 10)].aggregates[\"\" + key] = _syncfusion_ej2_data__WEBPACK_IMPORTED_MODULE_25__.DataUtil.aggregates[types[parseInt(l.toString(), 10)].toLowerCase()](data, row.columns[parseInt(k.toString(), 10)].field);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return current;\n    };\n    return Render;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9yZW5kZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQThGO0FBQzdCO0FBQ3dCO0FBQzVCO0FBQ1Q7QUFDYjtBQUNHO0FBQ047QUFDRTtBQUNLO0FBQ3VGO0FBQ3JFO0FBQ0Y7QUFDRjtBQUNhO0FBQ1E7QUFDUjtBQUNzQztBQUN0QztBQUNRO0FBQ2E7QUFDUjtBQUNwQjtBQUN1QjtBQUNsQztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLCtDQUFJO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELGtEQUFVO0FBQ2xFLHlEQUF5RCxrREFBVTtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFlBQVk7QUFDM0IsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixNQUFNO0FBQ2xDO0FBQ0E7QUFDQSxxQkFBcUIsdURBQWtCO0FBQ3ZDLG1DQUFtQyxTQUFTO0FBQzVDO0FBQ0EsNEJBQTRCLHVEQUFrQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVFQUFpQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxpQkFBaUIsd0RBQXdE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NUQ7QUFDQTtBQUNBLHdDQUF3QyxrQkFBa0I7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyw4REFBUTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRGQUE0RiwyREFBUTtBQUNwRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ2lCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvcmVuZGVyZXIvcmVuZGVyLmpzP2U0YmQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVtb3ZlLCByZXNldEJsYXpvclRlbXBsYXRlLCBibGF6b3JUZW1wbGF0ZXMsIGdldFZhbHVlIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgaXNOdWxsT3JVbmRlZmluZWQsIGV4dGVuZCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IERhdGFNYW5hZ2VyLCBRdWVyeSwgRGVmZXJyZWQsIFByZWRpY2F0ZSwgRGF0YVV0aWwgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItZGF0YSc7XG5pbXBvcnQgeyBWYWx1ZUZvcm1hdHRlciB9IGZyb20gJy4uL3NlcnZpY2VzL3ZhbHVlLWZvcm1hdHRlcic7XG5pbXBvcnQgeyBSZW5kZXJUeXBlLCBDZWxsVHlwZSB9IGZyb20gJy4uL2Jhc2UvZW51bSc7XG5pbXBvcnQgeyBEYXRhIH0gZnJvbSAnLi4vYWN0aW9ucy9kYXRhJztcbmltcG9ydCB7IENvbHVtbiB9IGZyb20gJy4uL21vZGVscy9jb2x1bW4nO1xuaW1wb3J0IHsgUm93IH0gZnJvbSAnLi4vbW9kZWxzL3Jvdyc7XG5pbXBvcnQgeyBDZWxsIH0gZnJvbSAnLi4vbW9kZWxzL2NlbGwnO1xuaW1wb3J0ICogYXMgZXZlbnRzIGZyb20gJy4uL2Jhc2UvY29uc3RhbnQnO1xuaW1wb3J0IHsgcHJlcGFyZUNvbHVtbnMsIHNldEZvcm1hdHRlciwgaXNHcm91cEFkYXB0aXZlLCBnZXREYXRlUHJlZGljYXRlLCBnZXRPYmplY3QsIGNsZWFyUmVhY3RWdWVUZW1wbGF0ZXMgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0IHsgQ29udGVudFJlbmRlciB9IGZyb20gJy4uL3JlbmRlcmVyL2NvbnRlbnQtcmVuZGVyZXInO1xuaW1wb3J0IHsgSGVhZGVyUmVuZGVyIH0gZnJvbSAnLi4vcmVuZGVyZXIvaGVhZGVyLXJlbmRlcmVyJztcbmltcG9ydCB7IENlbGxSZW5kZXJlciB9IGZyb20gJy4uL3JlbmRlcmVyL2NlbGwtcmVuZGVyZXInO1xuaW1wb3J0IHsgSGVhZGVyQ2VsbFJlbmRlcmVyIH0gZnJvbSAnLi4vcmVuZGVyZXIvaGVhZGVyLWNlbGwtcmVuZGVyZXInO1xuaW1wb3J0IHsgU3RhY2tlZEhlYWRlckNlbGxSZW5kZXJlciB9IGZyb20gJy4uL3JlbmRlcmVyL3N0YWNrZWQtY2VsbC1yZW5kZXJlcic7XG5pbXBvcnQgeyBJbmRlbnRDZWxsUmVuZGVyZXIgfSBmcm9tICcuLi9yZW5kZXJlci9pbmRlbnQtY2VsbC1yZW5kZXJlcic7XG5pbXBvcnQgeyBHcm91cENhcHRpb25DZWxsUmVuZGVyZXIsIEdyb3VwQ2FwdGlvbkVtcHR5Q2VsbFJlbmRlcmVyIH0gZnJvbSAnLi4vcmVuZGVyZXIvY2FwdGlvbi1jZWxsLXJlbmRlcmVyJztcbmltcG9ydCB7IEV4cGFuZENlbGxSZW5kZXJlciB9IGZyb20gJy4uL3JlbmRlcmVyL2V4cGFuZC1jZWxsLXJlbmRlcmVyJztcbmltcG9ydCB7IEhlYWRlckluZGVudENlbGxSZW5kZXJlciB9IGZyb20gJy4uL3JlbmRlcmVyL2hlYWRlci1pbmRlbnQtcmVuZGVyZXInO1xuaW1wb3J0IHsgRGV0YWlsSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyIH0gZnJvbSAnLi4vcmVuZGVyZXIvZGV0YWlsLWhlYWRlci1pbmRlbnQtcmVuZGVyZXInO1xuaW1wb3J0IHsgRGV0YWlsRXhwYW5kQ2VsbFJlbmRlcmVyIH0gZnJvbSAnLi4vcmVuZGVyZXIvZGV0YWlsLWV4cGFuZC1jZWxsLXJlbmRlcmVyJztcbmltcG9ydCB7IFJvd0RyYWdEcm9wUmVuZGVyZXIgfSBmcm9tICcuL3Jvdy1kcmFnLWRyb3AtcmVuZGVyZXInO1xuaW1wb3J0IHsgUm93RHJhZ0Ryb3BIZWFkZXJSZW5kZXJlciB9IGZyb20gJy4uL3JlbmRlcmVyL3Jvdy1kcmFnLWhlYWRlci1pbmRlbnQtcmVuZGVyJztcbmltcG9ydCAqIGFzIGxpdGVyYWxzIGZyb20gJy4uL2Jhc2Uvc3RyaW5nLWxpdGVyYWxzJztcbi8qKlxuICogQ29udGVudCBtb2R1bGUgaXMgdXNlZCB0byByZW5kZXIgZ3JpZCBjb250ZW50XG4gKlxuICogQGhpZGRlblxuICovXG52YXIgUmVuZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIGZvciByZW5kZXIgbW9kdWxlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0lHcmlkfSBwYXJlbnQgLSBzcGVjaWZpZXMgdGhlIElHcmlkXG4gICAgICogQHBhcmFtIHtTZXJ2aWNlTG9jYXRvcn0gbG9jYXRvciAtIHNwZWNpZmllcyB0aGUgc2VydmljZUxvY2F0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBSZW5kZXIocGFyZW50LCBsb2NhdG9yKSB7XG4gICAgICAgIHRoaXMuZW1wdHlHcmlkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY291bnRlciA9IDA7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLmxvY2F0b3IgPSBsb2NhdG9yO1xuICAgICAgICB0aGlzLmRhdGEgPSBuZXcgRGF0YShwYXJlbnQsIGxvY2F0b3IpO1xuICAgICAgICB0aGlzLmwxMG4gPSBsb2NhdG9yLmdldFNlcnZpY2UoJ2xvY2FsaXphdGlvbicpO1xuICAgICAgICB0aGlzLmFyaWFTZXJ2aWNlID0gdGhpcy5sb2NhdG9yLmdldFNlcnZpY2UoJ2FyaWFTZXJ2aWNlJyk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSB0aGlzLmxvY2F0b3IuZ2V0U2VydmljZSgncmVuZGVyZXJGYWN0b3J5Jyk7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUbyBpbml0aWFsaXplIGdyaWQgaGVhZGVyLCBjb250ZW50IGFuZCBmb290ZXIgcmVuZGVyaW5nXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBSZW5kZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdGhpcy5oZWFkZXJSZW5kZXJlciA9IHRoaXMucmVuZGVyZXIuZ2V0UmVuZGVyZXIoUmVuZGVyVHlwZS5IZWFkZXIpO1xuICAgICAgICB0aGlzLmNvbnRlbnRSZW5kZXJlciA9IHRoaXMucmVuZGVyZXIuZ2V0UmVuZGVyZXIoUmVuZGVyVHlwZS5Db250ZW50KTtcbiAgICAgICAgdGhpcy5oZWFkZXJSZW5kZXJlci5yZW5kZXJQYW5lbCgpO1xuICAgICAgICB0aGlzLmNvbnRlbnRSZW5kZXJlci5yZW5kZXJQYW5lbCgpO1xuICAgICAgICBpZiAoZ09iai5nZXRDb2x1bW5zKCkubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmlzTGF5b3V0UmVuZGVyZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5oZWFkZXJSZW5kZXJlci5yZW5kZXJUYWJsZSgpO1xuICAgICAgICAgICAgdGhpcy5jb250ZW50UmVuZGVyZXIucmVuZGVyVGFibGUoKTtcbiAgICAgICAgICAgIHRoaXMuZW1wdHlSb3coZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyZW50LnNjcm9sbE1vZHVsZS5zZXRXaWR0aCgpO1xuICAgICAgICB0aGlzLnBhcmVudC5zY3JvbGxNb2R1bGUuc2V0SGVpZ2h0KCk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5oZWlnaHQgIT09ICdhdXRvJykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2Nyb2xsTW9kdWxlLnNldFBhZGRpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZnJlc2hEYXRhTWFuYWdlcigpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVmcmVzaCB0aGUgZW50aXJlIEdyaWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vdGlmeUFyZ3N9IGUgLSBzcGVjaWZpZXMgdGhlIE5vdGlmeUFyZ3NcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBSZW5kZXIucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoZSA9PT0gdm9pZCAwKSB7IGUgPSB7IHJlcXVlc3RUeXBlOiAncmVmcmVzaCcgfTsgfVxuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICBnT2JqLm5vdGlmeShlLnJlcXVlc3RUeXBlICsgXCItYmVnaW5cIiwgZSk7XG4gICAgICAgIGdPYmoudHJpZ2dlcihldmVudHMuYWN0aW9uQmVnaW4sIGUsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICBpZiAoYXJncyA9PT0gdm9pZCAwKSB7IGFyZ3MgPSB7IHJlcXVlc3RUeXBlOiAncmVmcmVzaCcgfTsgfVxuICAgICAgICAgICAgaWYgKGFyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgZ09iai5ub3RpZnkoZXZlbnRzLmNhbmNlbEJlZ2luLCBhcmdzKTtcbiAgICAgICAgICAgICAgICBpZiAoYXJncy5hY3Rpb24gPT09ICdjbGVhckZpbHRlcicgJiYgX3RoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLnR5cGUgPT09ICdNZW51Jykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuY29sdW1uc1tfdGhpcy5wYXJlbnQuZmlsdGVyTW9kdWxlLmZpbHRlck9iakluZGV4XSA9IF90aGlzLnBhcmVudC5maWx0ZXJNb2R1bGUucHJldkZpbHRlck9iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGljb25DbGFzcyA9IF90aGlzLnBhcmVudC5zaG93Q29sdW1uTWVudSAmJiBfdGhpcy5wYXJlbnQuZmlsdGVyTW9kdWxlWydjb2x1bW4nXS5zaG93Q29sdW1uTWVudSA/ICcuZS1jb2x1bW5tZW51JyA6ICcuZS1pY29uLWZpbHRlcic7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBfdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdbZS1tYXBwaW5ndWlkPVwiJyArIF90aGlzLnBhcmVudC5maWx0ZXJNb2R1bGVbJ2NvbHVtbiddLnVpZCArICdcIl0nKS5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmxJY29uID0gY29sLnF1ZXJ5U2VsZWN0b3IoaWNvbkNsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChfdGhpcy5wYXJlbnQuZmlsdGVyTW9kdWxlLnByZXZGaWx0ZXJPYmplY3QpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmbEljb24uY2xhc3NMaXN0LmFkZCgnZS1maWx0ZXJlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhcmdzLmFjdGlvbiA9PT0gJ2NsZWFyLWZpbHRlcicgJiYgKF90aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnQ2hlY2tCb3gnIHx8IF90aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnRXhjZWwnKSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MuY29sdW1ucyA9IF90aGlzLnBhcmVudC5maWx0ZXJNb2R1bGUuY2hlY2tib3hQcmV2RmlsdGVyT2JqZWN0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2dyb3VwaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGRyb3BwZWQgY29sdW1uIG5hbWUgZnJvbSBncm91cHNldHRpbmdzLmNvbHVtbnMgaWYgYXJncy5jYW5jZWwgaXMgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5pbmRleE9mKGFyZ3MuY29sdW1uTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdPYmouc2V0UHJvcGVydGllcyh7IGdyb3VwU2V0dGluZ3M6IHsgQ29sdW1uczogZ09iai5ncm91cFNldHRpbmdzLmNvbHVtbnMuc3BsaWNlKGluZGV4LCAxKSB9IH0sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ09iai5zZXRQcm9wZXJ0aWVzKHsgc29ydFNldHRpbmdzOiB7IENvbHVtbnM6IGdPYmouc29ydFNldHRpbmdzLmNvbHVtbnMuc3BsaWNlKGluZGV4LCAxKSB9IH0sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbHVtbiA9IGdPYmouZ2V0Q29sdW1uQnlGaWVsZChhcmdzLmNvbHVtbk5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlckNlbGwgPSBnT2JqLmdldENvbHVtbkhlYWRlckJ5RmllbGQoY29sdW1uLmZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbi52aXNpYmxlID0gKCFpc051bGxPclVuZGVmaW5lZChoZWFkZXJDZWxsKSAmJiAhaGVhZGVyQ2VsbC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaGlkZScpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5kZXN0cm95RWRpdEZvcm0sIGFyZ3MpO1xuICAgICAgICAgICAgaWYgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICd2aXJ0dWFsc2Nyb2xsJyAmJiAoX3RoaXMucGFyZW50LmdldERhdGFNb2R1bGUoKS5pc1JlbW90ZSgpIHx8ICdyZXN1bHQnIGluIF90aGlzLnBhcmVudC5kYXRhU291cmNlKVxuICAgICAgICAgICAgICAgICYmIGFyZ3MudmlydHVhbEluZm8gJiYgYXJncy52aXJ0dWFsSW5mby5kaXJlY3Rpb24gPT09ICdkb3duJykge1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5jb250ZW50TW9kdWxlLnByZXZJbmZvID0gYXJncy52aXJ0dWFsSW5mbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuZ3JvdXBNb2R1bGUgJiYgYXJncy5wcmV2ZW50Rm9jdXNPbkdyb3VwKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucGFyZW50Lmdyb3VwTW9kdWxlLnByZXZlbnRGb2N1c09uR3JvdXAgPSBhcmdzLnByZXZlbnRGb2N1c09uR3JvdXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ09iai5hbGxvd1NlbGVjdGlvbiAmJiAoYXJncy5hY3Rpb24gPT09ICdjbGVhckZpbHRlcicgfHwgYXJncy5hY3Rpb24gPT09ICdjbGVhci1maWx0ZXInIHx8XG4gICAgICAgICAgICAgICAgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdzZWFyY2hpbmcnICYmIGFyZ3Muc2VhcmNoU3RyaW5nID09PSAnJykgfHwgYXJncy5hY3Rpb24gPT09ICdhZGQnKSkge1xuICAgICAgICAgICAgICAgIGdPYmouc2VsZWN0aW9uTW9kdWxlWydybXRIZHJDaGtieENsaWNrZWQnXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChnT2JqLnNlbGVjdGlvbk1vZHVsZS5pc1BhcnRpYWxTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgZ09iai5zZWxlY3Rpb25Nb2R1bGVbJ2lzSGRyU2VsZWN0QWxsQ2xpY2tlZCddID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdPYmouYWxsb3dQYWdpbmcgJiYgZ09iai5wYWdlU2V0dGluZ3MucGFnZVNpemVzICYmIGdPYmoucGFnZXJNb2R1bGUucGFnZXJPYmouaXNBbGxQYWdlICYmXG4gICAgICAgICAgICAgICAgKGFyZ3MuYWN0aW9uID09PSAnYWRkJyAmJiBhcmdzLnJlcXVlc3RUeXBlID09PSAnc2F2ZScpICYmIGdPYmoucGFnZXJNb2R1bGUucGFnZXJPYmouY2hlY2tBbGwpIHtcbiAgICAgICAgICAgICAgICBnT2JqLnNldFByb3BlcnRpZXMoeyBwYWdlU2V0dGluZ3M6IHsgcGFnZVNpemU6IGdPYmoucGFnZVNldHRpbmdzLnBhZ2VTaXplICsgMSB9IH0sIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdkZWxldGUnICYmIGdPYmouYWxsb3dQYWdpbmcpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YUxlbmd0aCA9IGFyZ3MuZGF0YS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gZ09iai5wYWdlU2V0dGluZ3MudG90YWxSZWNvcmRzQ291bnQgLSBkYXRhTGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Vmlld0RhdGEgPSBnT2JqLmdldEN1cnJlbnRWaWV3UmVjb3JkcygpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxlblxuICAgICAgICAgICAgICAgIGlmICgoIShjdXJyZW50Vmlld0RhdGEgLSBkYXRhTGVuZ3RoKSAmJiBjb3VudCAmJiAoKGdPYmoucGFnZVNldHRpbmdzLmN1cnJlbnRQYWdlIC0gMSkgKiBnT2JqLnBhZ2VTZXR0aW5ncy5wYWdlU2l6ZSkgPT09IGNvdW50KSB8fCAoY291bnQgJiYgY291bnQgPD0gZGF0YUxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZ09iai5wcmV2UGFnZU1vdmluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGdPYmouc2V0UHJvcGVydGllcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlU2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFJlY29yZHNDb3VudDogY291bnQsIGN1cnJlbnRQYWdlOiBNYXRoLmNlaWwoY291bnQgLyBnT2JqLnBhZ2VTZXR0aW5ncy5wYWdlU2l6ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGdPYmoucGFnZXJNb2R1bGUucGFnZXJPYmoudG90YWxSZWNvcmRzQ291bnQgPSBjb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3Jlb3JkZXInICYmIF90aGlzLnBhcmVudC5kYXRhU291cmNlICYmICdyZXN1bHQnIGluIF90aGlzLnBhcmVudC5kYXRhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuY29udGVudFJlbmRlcmVyLnJlZnJlc2hDb250ZW50Um93cyhhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKChhcmdzLnJlcXVlc3RUeXBlID09PSAncGFnaW5nJyB8fCBhcmdzLnJlcXVlc3RUeXBlID09PSAnY29sdW1uc3RhdGUnIHx8IGFyZ3MucmVxdWVzdFR5cGUgPT09ICdyZW9yZGVyJylcbiAgICAgICAgICAgICAgICAmJiBfdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZyAmJiBfdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aFxuICAgICAgICAgICAgICAgICYmIChfdGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gPyBfdGhpcy5wYXJlbnQubGF6eUxvYWRSZW5kZXIgOlxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuY29udGVudE1vZHVsZSkuZ2V0R3JvdXBDYWNoZSgpW190aGlzLnBhcmVudC5wYWdlU2V0dGluZ3MuY3VycmVudFBhZ2VdKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuY29udGVudFJlbmRlcmVyLnJlZnJlc2hDb250ZW50Um93cyhhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hEYXRhTWFuYWdlcihhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgUmVuZGVyLnByb3RvdHlwZS5yZXNldFRlbXBsYXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIGdyaWRDb2x1bW5zID0gZ09iai5nZXRDb2x1bW5zKCk7XG4gICAgICAgIGlmIChnT2JqLmRldGFpbFRlbXBsYXRlKSB7XG4gICAgICAgICAgICB2YXIgZGV0YWlsVGVtcGxhdGVJRCA9IGdPYmouZWxlbWVudC5pZCArICdkZXRhaWxUZW1wbGF0ZSc7XG4gICAgICAgICAgICBibGF6b3JUZW1wbGF0ZXNbXCJcIiArIGRldGFpbFRlbXBsYXRlSURdID0gW107XG4gICAgICAgICAgICByZXNldEJsYXpvclRlbXBsYXRlKGRldGFpbFRlbXBsYXRlSUQsICdEZXRhaWxUZW1wbGF0ZScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnT2JqLmdyb3VwU2V0dGluZ3MuY2FwdGlvblRlbXBsYXRlKSB7XG4gICAgICAgICAgICByZXNldEJsYXpvclRlbXBsYXRlKGdPYmouZWxlbWVudC5pZCArICdjYXB0aW9uVGVtcGxhdGUnLCAnQ2FwdGlvblRlbXBsYXRlJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdPYmoucm93VGVtcGxhdGUpIHtcbiAgICAgICAgICAgIHJlc2V0Qmxhem9yVGVtcGxhdGUoZ09iai5lbGVtZW50LmlkICsgJ3Jvd1RlbXBsYXRlJywgJ1Jvd1RlbXBsYXRlJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdPYmoudG9vbGJhclRlbXBsYXRlKSB7XG4gICAgICAgICAgICByZXNldEJsYXpvclRlbXBsYXRlKGdPYmouZWxlbWVudC5pZCArICd0b29sYmFyVGVtcGxhdGUnLCAnVG9vbGJhclRlbXBsYXRlJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdPYmoucGFnZVNldHRpbmdzLnRlbXBsYXRlKSB7XG4gICAgICAgICAgICByZXNldEJsYXpvclRlbXBsYXRlKGdPYmouZWxlbWVudC5pZCArICdfdGVtcGxhdGUnLCAncGFnZVNldHRpbmdzJyk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBncmlkQ29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGdyaWRDb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS50ZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgIGJsYXpvclRlbXBsYXRlc1tnT2JqLmVsZW1lbnQuaWQgKyBncmlkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udWlkXSA9IFtdO1xuICAgICAgICAgICAgICAgIHJlc2V0Qmxhem9yVGVtcGxhdGUoZ09iai5lbGVtZW50LmlkICsgZ3JpZENvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZCwgJ1RlbXBsYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ3JpZENvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmhlYWRlclRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgcmVzZXRCbGF6b3JUZW1wbGF0ZShnT2JqLmVsZW1lbnQuaWQgKyBncmlkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udWlkICsgJ2hlYWRlclRlbXBsYXRlJywgJ0hlYWRlclRlbXBsYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ3JpZENvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpbHRlclRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgcmVzZXRCbGF6b3JUZW1wbGF0ZShnT2JqLmVsZW1lbnQuaWQgKyBncmlkQ29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udWlkICsgJ2ZpbHRlclRlbXBsYXRlJywgJ0ZpbHRlclRlbXBsYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGd1aWQgPSAnZ3VpZCc7XG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZ09iai5hZ2dyZWdhdGVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGdPYmouYWdncmVnYXRlc1twYXJzZUludChrLnRvU3RyaW5nKCksIDEwKV0uY29sdW1ucy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGlmIChnT2JqLmFnZ3JlZ2F0ZXNbcGFyc2VJbnQoay50b1N0cmluZygpLCAxMCldLmNvbHVtbnNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldLmZvb3RlclRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wSUQgPSBnT2JqLmVsZW1lbnQuaWQgKyBnT2JqLmFnZ3JlZ2F0ZXNbcGFyc2VJbnQoay50b1N0cmluZygpLCAxMCldLmNvbHVtbnNbcGFyc2VJbnQoai50b1N0cmluZygpLCAxMCldW1wiXCIgKyBndWlkXSArICdmb290ZXJUZW1wbGF0ZSc7XG4gICAgICAgICAgICAgICAgICAgIHJlc2V0Qmxhem9yVGVtcGxhdGUodGVtcElELCAnRm9vdGVyVGVtcGxhdGUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdPYmouYWdncmVnYXRlc1twYXJzZUludChrLnRvU3RyaW5nKCksIDEwKV0uY29sdW1uc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uZ3JvdXBGb290ZXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcElEID0gZ09iai5lbGVtZW50LmlkICsgZ09iai5hZ2dyZWdhdGVzW3BhcnNlSW50KGsudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXVtcIlwiICsgZ3VpZF0gKyAnZ3JvdXBGb290ZXJUZW1wbGF0ZSc7XG4gICAgICAgICAgICAgICAgICAgIHJlc2V0Qmxhem9yVGVtcGxhdGUodGVtcElELCAnR3JvdXBGb290ZXJUZW1wbGF0ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ09iai5hZ2dyZWdhdGVzW3BhcnNlSW50KGsudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5ncm91cENhcHRpb25UZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcElEID0gZ09iai5lbGVtZW50LmlkICsgZ09iai5hZ2dyZWdhdGVzW3BhcnNlSW50KGsudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXVtcIlwiICsgZ3VpZF0gKyAnZ3JvdXBDYXB0aW9uVGVtcGxhdGUnO1xuICAgICAgICAgICAgICAgICAgICByZXNldEJsYXpvclRlbXBsYXRlKHRlbXBJRCwgJ0dyb3VwQ2FwdGlvblRlbXBsYXRlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBSZW5kZXIucHJvdG90eXBlLnJlZnJlc2hDb21wbGV0ZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmFjdGlvbkNvbXBsZXRlLCBlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoZSBmdW5jdGlvbiBpcyB1c2VkIHRvIHJlZnJlc2ggdGhlIGRhdGFNYW5hZ2VyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge05vdGlmeUFyZ3N9IGFyZ3MgLSBzcGVjaWZpZXMgdGhlIGFyZ3NcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBSZW5kZXIucHJvdG90eXBlLnJlZnJlc2hEYXRhTWFuYWdlciA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChhcmdzID09PSB2b2lkIDApIHsgYXJncyA9IHt9OyB9XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciBtYXNrUm93ID0gKGdPYmoubG9hZGluZ0luZGljYXRvci5pbmRpY2F0b3JUeXBlID09PSAnU2hpbW1lcicgJiYgYXJncy5yZXF1ZXN0VHlwZSAhPT0gJ3ZpcnR1YWxzY3JvbGwnXG4gICAgICAgICAgICAmJiBhcmdzLnJlcXVlc3RUeXBlICE9PSAnaW5maW5pdGVTY3JvbGwnKSB8fCAoKGFyZ3MucmVxdWVzdFR5cGUgPT09ICd2aXJ0dWFsc2Nyb2xsJyB8fCBhcmdzLnJlcXVlc3RUeXBlID09PSAnaW5maW5pdGVTY3JvbGwnKVxuICAgICAgICAgICAgJiYgZ09iai5lbmFibGVWaXJ0dWFsTWFza1Jvdyk7XG4gICAgICAgIGlmIChhcmdzLnJlcXVlc3RUeXBlICE9PSAndmlydHVhbHNjcm9sbCcgJiYgIWFyZ3MuaXNDYXB0aW9uQ29sbGFwc2UgJiYgIW1hc2tSb3cpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LnNob3dTcGlubmVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1hc2tSb3cpIHtcbiAgICAgICAgICAgIGdPYmouc2hvd01hc2tSb3coYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3ZpcnR1YWxzY3JvbGwnID8gYXJncy52aXJ0dWFsSW5mby5zZW50aW5lbEluZm8uYXhpc1xuICAgICAgICAgICAgICAgIDogYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2luZmluaXRlU2Nyb2xsJyA/IGFyZ3MuZGlyZWN0aW9uIDogdW5kZWZpbmVkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnJlc2V0SW5maW5pdGVCbG9ja3MsIGFyZ3MpO1xuICAgICAgICB0aGlzLmVtcHR5R3JpZCA9IGZhbHNlO1xuICAgICAgICB2YXIgZGF0YU1hbmFnZXI7XG4gICAgICAgIHZhciBpc0ZBY3RvbiA9IHRoaXMuaXNOZWVkRm9yZWlnbkFjdGlvbigpO1xuICAgICAgICB0aGlzLmFyaWFTZXJ2aWNlLnNldEJ1c3kodGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLnF1ZXJ5U2VsZWN0b3IoJy4nICsgbGl0ZXJhbHMuY29udGVudCksIHRydWUpO1xuICAgICAgICBpZiAoaXNGQWN0b24pIHtcbiAgICAgICAgICAgIHZhciBkZWZmZXJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgZGF0YU1hbmFnZXIgPSB0aGlzLmdldEZEYXRhKGRlZmZlcmVkLCBhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRhdGFNYW5hZ2VyKSB7XG4gICAgICAgICAgICBpZiAoZ09iai5hbGxvd1BhZ2luZyAmJiAhZ09iai5nZXREYXRhTW9kdWxlKCkuZGF0YU1hbmFnZXIuZGF0YVNvdXJjZS5vZmZsaW5lICYmIGdPYmoucGFnZVNldHRpbmdzXG4gICAgICAgICAgICAgICAgJiYgZ09iai5wYWdlU2V0dGluZ3MucGFnZVNpemVzICYmIGdPYmoucGFnZXJNb2R1bGUgJiYgZ09iai5wYWdlck1vZHVsZS5wYWdlck9iaiAmJiBnT2JqLnBhZ2VyTW9kdWxlLnBhZ2VyT2JqLmlzQWxsUGFnZSkge1xuICAgICAgICAgICAgICAgIGdPYmoucGFnZXJNb2R1bGUucGFnZXJPYmouaXNBbGxQYWdlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YU1hbmFnZXIgPSB0aGlzLmRhdGEuZ2V0RGF0YShhcmdzLCB0aGlzLmRhdGEuZ2VuZXJhdGVRdWVyeSgpLnJlcXVpcmVzQ291bnQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgICAgICAgICBkYXRhTWFuYWdlciA9IGRhdGFNYW5hZ2VyLnRoZW4oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSBfdGhpcy5kYXRhLmdlbmVyYXRlUXVlcnkoKS5yZXF1aXJlc0NvdW50KCk7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmVtcHR5R3JpZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKHsgcmVzdWx0OiBbXSwgY291bnQ6IDAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmRhdGEuZ2V0RGF0YShhcmdzLCBxdWVyeSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZm9yZWlnbktleUNvbHVtbnMgPSB0aGlzLnBhcmVudC5nZXRGb3JlaWduS2V5Q29sdW1ucygpO1xuICAgICAgICB2YXIgZm9yZWlnbktleUxlbmd0aCA9IGZvcmVpZ25LZXlDb2x1bW5zLmxlbmd0aDtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmNvbHVtblF1ZXJ5TW9kZSA9PT0gJ0V4Y2x1ZGVIaWRkZW4nICYmIGZvcmVpZ25LZXlMZW5ndGgpIHtcbiAgICAgICAgICAgIGZvcmVpZ25LZXlMZW5ndGggPSBmb3JlaWduS2V5Q29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKGNvbCkgeyByZXR1cm4gY29sLnZpc2libGUgIT09IGZhbHNlOyB9KS5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZvcmVpZ25LZXlMZW5ndGggJiYgKCFpc0ZBY3RvbiB8fCB0aGlzLnBhcmVudC5zZWFyY2hTZXR0aW5ncy5rZXkubGVuZ3RoKSkge1xuICAgICAgICAgICAgdmFyIGRlZmZlcmVkXzEgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgICAgIGRhdGFNYW5hZ2VyID0gZGF0YU1hbmFnZXIudGhlbihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmdldEZvcmVpZ25LZXlEYXRhLCB7IGRhdGFNYW5hZ2VyOiBkYXRhTWFuYWdlciwgcmVzdWx0OiBlLCBwcm9taXNlOiBkZWZmZXJlZF8xLCBhY3Rpb246IGFyZ3MgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmZlcmVkXzEucHJvbWlzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmRpc2FibGVQYWdlV2lzZUFnZ3JlZ2F0ZXMgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgZGF0YU1hbmFnZXIgPSBkYXRhTWFuYWdlci50aGVuKGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy52YWxpZGF0ZUdyb3VwUmVjb3JkcyhlKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZGF0YU1hbmFnZXIudGhlbihmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMuZGF0YU1hbmFnZXJTdWNjZXNzKGUsIGFyZ3MpOyB9KVxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5kYXRhTWFuYWdlckZhaWx1cmUoZSwgYXJncyk7IH0pO1xuICAgIH07XG4gICAgUmVuZGVyLnByb3RvdHlwZS5nZXRGRGF0YSA9IGZ1bmN0aW9uIChkZWZlcnJlZCwgYXJncykge1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmdldEZvcmVpZ25LZXlEYXRhLCB7IGlzQ29tcGxleDogdHJ1ZSwgcHJvbWlzZTogZGVmZXJyZWQsIGFjdGlvbjogYXJncyB9KTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfTtcbiAgICBSZW5kZXIucHJvdG90eXBlLmlzTmVlZEZvcmVpZ25BY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiAhISgoZ09iai5hbGxvd0ZpbHRlcmluZyAmJiBnT2JqLmZpbHRlclNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKSB8fFxuICAgICAgICAgICAgKCFpc051bGxPclVuZGVmaW5lZChnT2JqLnNlYXJjaFNldHRpbmdzLmtleSkgJiYgZ09iai5zZWFyY2hTZXR0aW5ncy5rZXkubGVuZ3RoKSlcbiAgICAgICAgICAgICYmIHRoaXMuZm9yZWlnbktleSh0aGlzLnBhcmVudC5nZXRGb3JlaWduS2V5Q29sdW1ucygpKTtcbiAgICB9O1xuICAgIFJlbmRlci5wcm90b3R5cGUuZm9yZWlnbktleSA9IGZ1bmN0aW9uIChjb2x1bW5zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBjb2x1bW5zLnNvbWUoZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgdmFyIGZib29sID0gZmFsc2U7XG4gICAgICAgICAgICBmYm9vbCA9IF90aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy5jb2x1bW5zLnNvbWUoZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbC51aWQgPT09IHZhbHVlLnVpZDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuICEhKGZib29sIHx8IF90aGlzLnBhcmVudC5zZWFyY2hTZXR0aW5ncy5rZXkubGVuZ3RoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBSZW5kZXIucHJvdG90eXBlLnNlbmRCdWxrUmVxdWVzdCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGFyZ3MucmVxdWVzdFR5cGUgPSAnYmF0Y2hzYXZlJztcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKGdPYmouYWxsb3dQYWdpbmcgJiYgZ09iai5wYWdlU2V0dGluZ3MucGFnZVNpemVzICYmIGdPYmoucGFnZXJNb2R1bGUucGFnZXJPYmouaXNBbGxQYWdlICYmIGdPYmoucGFnZXJNb2R1bGUucGFnZXJPYmouY2hlY2tBbGwpIHtcbiAgICAgICAgICAgIHZhciBkYXRhTGVuZ3RoID0gYXJnc1snY2hhbmdlcyddLmFkZGVkUmVjb3Jkcy5sZW5ndGg7XG4gICAgICAgICAgICBpZiAoZGF0YUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGdPYmouc2V0UHJvcGVydGllcyh7IHBhZ2VTZXR0aW5nczogeyBwYWdlU2l6ZTogZ09iai5wYWdlU2V0dGluZ3MucGFnZVNpemUgKyBkYXRhTGVuZ3RoIH0gfSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdPYmouYWxsb3dQYWdpbmcgJiYgKGFyZ3MuY2hhbmdlcy5hZGRlZFJlY29yZHMubGVuZ3RoIHx8XG4gICAgICAgICAgICBhcmdzLmNoYW5nZXMuZGVsZXRlZFJlY29yZHMubGVuZ3RoIHx8XG4gICAgICAgICAgICBhcmdzLmNoYW5nZXMuY2hhbmdlZFJlY29yZHMubGVuZ3RoKSAmJiBnT2JqLnBhZ2VTZXR0aW5nc1xuICAgICAgICAgICAgJiYgZ09iai5wYWdlU2V0dGluZ3MucGFnZVNpemVzICYmIGdPYmoucGFnZXJNb2R1bGUgJiYgZ09iai5wYWdlck1vZHVsZS5wYWdlck9ialxuICAgICAgICAgICAgJiYgIWdPYmouZ2V0RGF0YU1vZHVsZSgpLmRhdGFNYW5hZ2VyLmRhdGFTb3VyY2Uub2ZmbGluZSAmJiBnT2JqLnBhZ2VyTW9kdWxlLnBhZ2VyT2JqLmlzQWxsUGFnZSkge1xuICAgICAgICAgICAgZ09iai5wYWdlck1vZHVsZS5wYWdlck9iai5pc0FsbFBhZ2UgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByb21pc2UgPSB0aGlzLmRhdGEuc2F2ZUNoYW5nZXMoYXJncy5jaGFuZ2VzLCB0aGlzLnBhcmVudC5nZXRQcmltYXJ5S2V5RmllbGROYW1lcygpWzBdLCBhcmdzLm9yaWdpbmFsKTtcbiAgICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy5kYXRhLmdlbmVyYXRlUXVlcnkoKS5yZXF1aXJlc0NvdW50KCk7XG4gICAgICAgIGlmICh0aGlzLmRhdGEuZGF0YU1hbmFnZXIuZGF0YVNvdXJjZS5vZmZsaW5lKSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hEYXRhTWFuYWdlcih7IHJlcXVlc3RUeXBlOiAnYmF0Y2hzYXZlJyB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICAgICAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLmRhdGEuZ2V0RGF0YShhcmdzLCBxdWVyeSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLmRtU3VjY2VzcyhlLCBhcmdzKTsgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5kbUZhaWx1cmUoZSwgYXJncyk7IH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLmRtRmFpbHVyZShlLCBhcmdzKTsgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlbmRlci5wcm90b3R5cGUuZG1TdWNjZXNzID0gZnVuY3Rpb24gKGUsIGFyZ3MpIHtcbiAgICAgICAgdGhpcy5kYXRhTWFuYWdlclN1Y2Nlc3MoZSwgYXJncyk7XG4gICAgfTtcbiAgICBSZW5kZXIucHJvdG90eXBlLmRtRmFpbHVyZSA9IGZ1bmN0aW9uIChlLCBhcmdzKSB7XG4gICAgICAgIHRoaXMuZGF0YU1hbmFnZXJGYWlsdXJlKGUsIGFyZ3MpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVuZGVyIGVtcHR5IHJvdyB0byBHcmlkIHdoaWNoIGlzIHVzZWQgYXQgdGhlIHRpbWUgdG8gcmVwcmVzZW50IHRvIG5vIHJlY29yZHMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgUmVuZGVyLnByb3RvdHlwZS5yZW5kZXJFbXB0eVJvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5lbXB0eVJvdyh0cnVlKTtcbiAgICB9O1xuICAgIFJlbmRlci5wcm90b3R5cGUuZW1wdHlSb3cgPSBmdW5jdGlvbiAoaXNUcmlnZ2VyKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciB0Ym9keSA9IHRoaXMuY29udGVudFJlbmRlcmVyLmdldFRhYmxlKCkucXVlcnlTZWxlY3RvcihsaXRlcmFscy50Ym9keSk7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGJvZHkpKSB7XG4gICAgICAgICAgICByZW1vdmUodGJvZHkpO1xuICAgICAgICB9XG4gICAgICAgIHRib2R5ID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudChsaXRlcmFscy50Ym9keSwgeyBhdHRyczogeyByb2xlOiAncm93Z3JvdXAnIH0gfSk7XG4gICAgICAgIHZhciBzcGFuQ291bnQgPSBnT2JqLmFsbG93Um93RHJhZ0FuZERyb3AgJiYgaXNOdWxsT3JVbmRlZmluZWQoZ09iai5yb3dEcm9wU2V0dGluZ3MudGFyZ2V0SUQpID8gMSA6IDA7XG4gICAgICAgIGlmIChnT2JqLmRldGFpbFRlbXBsYXRlIHx8IGdPYmouY2hpbGRHcmlkKSB7XG4gICAgICAgICAgICArK3NwYW5Db3VudDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2xhc3NOYW1lID0gZ09iai5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJiBnT2JqLmVkaXRTZXR0aW5ncy5uZXdSb3dQb3NpdGlvbiA9PT0gJ0JvdHRvbScgP1xuICAgICAgICAgICAgJ2UtZW1wdHlyb3cgZS1zaG93LWFkZGVkLXJvdycgOiAnZS1lbXB0eXJvdyc7XG4gICAgICAgIHZhciB0ciA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJywgeyBjbGFzc05hbWU6IGNsYXNzTmFtZSwgYXR0cnM6IHsgcm9sZTogJ3JvdycgfSB9KTtcbiAgICAgICAgdmFyIHRkO1xuICAgICAgICBpZiAoZ09iai5lbXB0eVJlY29yZFRlbXBsYXRlKSB7XG4gICAgICAgICAgICB2YXIgZW1wdHlSZWNvcmRUZW1wbGF0ZUlEID0gZ09iai5lbGVtZW50LmlkICsgJ2VtcHR5UmVjb3JkVGVtcGxhdGUnO1xuICAgICAgICAgICAgdGQgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCd0ZCcsIHsgYXR0cnM6IHsgY29sc3BhbjogKGdPYmouZ2V0VmlzaWJsZUNvbHVtbnMoKS5sZW5ndGggK1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BhbkNvdW50ICsgZ09iai5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKS50b1N0cmluZygpIH0gfSk7XG4gICAgICAgICAgICBpZiAoZ09iai5pc1Z1ZSB8fCAoZ09iai5wYXJlbnREZXRhaWxzICYmIGdPYmoucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqICYmIGdPYmoucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqLmlzVnVlKSkge1xuICAgICAgICAgICAgICAgIHRkLmFwcGVuZENoaWxkKGdPYmouZ2V0RW1wdHlSZWNvcmRUZW1wbGF0ZSgpKGdPYmouZGF0YVNvdXJjZSwgZ09iaiwgJ2VtcHR5UmVjb3JkVGVtcGxhdGUnLCBlbXB0eVJlY29yZFRlbXBsYXRlSUQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRoaXMucGFyZW50Wydyb290J10pWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRkLmFwcGVuZENoaWxkKGdPYmouZ2V0RW1wdHlSZWNvcmRUZW1wbGF0ZSgpKGdPYmouZGF0YVNvdXJjZSwgZ09iaiwgJ2VtcHR5UmVjb3JkVGVtcGxhdGUnLCBlbXB0eVJlY29yZFRlbXBsYXRlSUQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRoaXMucGFyZW50Wydyb290J10pWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnT2JqLmlzUmVhY3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5yZW5kZXJUZW1wbGF0ZXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRkID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgndGQnLCB7XG4gICAgICAgICAgICAgICAgaW5uZXJIVE1MOiB0aGlzLmwxMG4uZ2V0Q29uc3RhbnQoJ0VtcHR5UmVjb3JkJyksXG4gICAgICAgICAgICAgICAgYXR0cnM6IHsgY29sc3BhbjogKGdPYmouZ2V0VmlzaWJsZUNvbHVtbnMoKS5sZW5ndGggKyBzcGFuQ291bnQgKyAoIWlzTnVsbE9yVW5kZWZpbmVkKGdPYmouZ3JvdXBTZXR0aW5ncy5jb2x1bW5zKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICBnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggOiAwKSkudG9TdHJpbmcoKSB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ09iai5pc0Zyb3plbkdyaWQoKSkge1xuICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZCgnZS1sZWZ0ZnJlZXplJyk7XG4gICAgICAgICAgICB0ZC5zdHlsZS5sZWZ0ID0gMCArICdweCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdPYmouZnJvemVuUm93cyAmJiBnT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZnJvemVucm93LWJvcmRlcicpKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWZyb3plbnJvdy1ib3JkZXInKS5jbGFzc0xpc3QuYWRkKCdlLWZyb3plbnJvdy1lbXB0eScpO1xuICAgICAgICB9XG4gICAgICAgIHRyLmFwcGVuZENoaWxkKHRkKTtcbiAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpO1xuICAgICAgICB0aGlzLmNvbnRlbnRSZW5kZXJlci5yZW5kZXJFbXB0eSh0Ym9keSk7XG4gICAgICAgIGlmIChpc1RyaWdnZXIpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQuaXNJbml0aWFsTG9hZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmZvY3VzTW9kdWxlLnNldEZpcnN0Rm9jdXNhYmxlVGFiSW5kZXgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmRhdGFCb3VuZCwge30pO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5vbkVtcHR5LCB7IHJvd3M6IFtuZXcgUm93KHsgaXNEYXRhUm93OiB0cnVlLCBjZWxsczogW25ldyBDZWxsKHsgaXNEYXRhQ2VsbDogdHJ1ZSwgdmlzaWJsZTogdHJ1ZSB9KV0gfSldIH0pO1xuICAgICAgICAgICAgaWYgKGdPYmouZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cpIHtcbiAgICAgICAgICAgICAgICBnT2JqLmFkZFJlY29yZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMuc2hvd0FkZE5ld1Jvd0ZvY3VzLCB7fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlbmRlci5wcm90b3R5cGUuZHluYW1pY0NvbHVtbkNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmdldEN1cnJlbnRWaWV3UmVjb3JkcygpLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVDb2x1bW5UeXBlKHRoaXMucGFyZW50LmdldEN1cnJlbnRWaWV3UmVjb3JkcygpWzBdKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVuZGVyLnByb3RvdHlwZS51cGRhdGVDb2x1bW5UeXBlID0gZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICB2YXIgY29sdW1ucyA9IHRoaXMucGFyZW50LmdldENvbHVtbnMoKTtcbiAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICB2YXIgY0Zvcm1hdCA9ICdjdXN0b21Gb3JtYXQnO1xuICAgICAgICB2YXIgZXF1YWxUbyA9ICdlcXVhbFRvJztcbiAgICAgICAgdmFyIGRhdGEgPSByZWNvcmQgJiYgcmVjb3JkLml0ZW1zID8gcmVjb3JkLml0ZW1zWzBdIDogcmVjb3JkO1xuICAgICAgICB2YXIgZm10ciA9IHRoaXMubG9jYXRvci5nZXRTZXJ2aWNlKCd2YWx1ZUZvcm1hdHRlcicpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gY29sdW1ucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFsdWUgPSBnZXRPYmplY3QoY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQgfHwgJycsIGRhdGEpO1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVtcIlwiICsgY0Zvcm1hdF0pKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZm9ybWF0ID0gY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1bXCJcIiArIGNGb3JtYXRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52YWxpZGF0aW9uUnVsZXMpXG4gICAgICAgICAgICAgICAgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZhbGlkYXRpb25SdWxlc1tcIlwiICsgZXF1YWxUb10pKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmFsaWRhdGlvblJ1bGVzW1wiXCIgKyBlcXVhbFRvXVswXSA9IHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52YWxpZGF0aW9uUnVsZXNbXCJcIiArIGVxdWFsVG9dWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlzRm9yZWlnbkNvbHVtbigpICYmIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbkRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGdldE9iamVjdChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mb3JlaWduS2V5VmFsdWUgfHwgJycsIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbkRhdGFbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzQ29sVHlwZURlZiA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKCFjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnR5cGUgPSB2YWx1ZS5nZXREYXkgPyAodmFsdWUuZ2V0SG91cnMoKSA+IDAgfHwgdmFsdWUuZ2V0TWludXRlcygpID4gMCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuZ2V0U2Vjb25kcygpID4gMCB8fCB2YWx1ZS5nZXRNaWxsaXNlY29uZHMoKSA+IDAgPyAnZGF0ZXRpbWUnIDogJ2RhdGUnKSA6IHR5cGVvZiAodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnR5cGUgPSBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS50eXBlIHx8IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdmFsdWVGb3JtYXR0ZXIgPSBuZXcgVmFsdWVGb3JtYXR0ZXIoKTtcbiAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mb3JtYXQgJiYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZvcm1hdC5za2VsZXRvblxuICAgICAgICAgICAgICAgIHx8IChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mb3JtYXQuZm9ybWF0ICYmXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mb3JtYXQuZm9ybWF0ID09PSAnc3RyaW5nJykpKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uc2V0Rm9ybWF0dGVyKHZhbHVlRm9ybWF0dGVyLmdldEZvcm1hdEZ1bmN0aW9uKGV4dGVuZCh7fSwgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZm9ybWF0KSkpO1xuICAgICAgICAgICAgICAgIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnNldFBhcnNlcih2YWx1ZUZvcm1hdHRlci5nZXRQYXJzZXJGdW5jdGlvbihjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mb3JtYXQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZvcm1hdCkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgc2V0Rm9ybWF0dGVyKHRoaXMubG9jYXRvciwgY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIWNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZvcm1hdCAmJiBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS50eXBlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnNldFBhcnNlcihmbXRyLmdldFBhcnNlckZ1bmN0aW9uKHsgZm9ybWF0OiAnbjInIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS50eXBlID09PSAnZGF0ZW9ubHknICYmICFjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mb3JtYXQpIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mb3JtYXQgPSAneU1kJztcbiAgICAgICAgICAgICAgICBzZXRGb3JtYXR0ZXIodGhpcy5sb2NhdG9yLCBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7UmV0dXJuVHlwZX0gZSAtIHNwZWNpZmllcyB0aGUgcmV0dXJuIHR5cGVcbiAgICAgKiBAcGFyYW0ge05vdGlmeUFyZ3N9IGFyZ3MgLSBzcGVjaWZpZXMgdGhlIE5vdGlmeWFyZ3NcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1mdW5jLWJvZHktbGVuZ3RoXG4gICAgUmVuZGVyLnByb3RvdHlwZS5kYXRhTWFuYWdlclN1Y2Nlc3MgPSBmdW5jdGlvbiAoZSwgYXJncykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB0aGlzLmNvbnRlbnRSZW5kZXJlciA9IHRoaXMucmVuZGVyZXIuZ2V0UmVuZGVyZXIoUmVuZGVyVHlwZS5Db250ZW50KTtcbiAgICAgICAgdGhpcy5oZWFkZXJSZW5kZXJlciA9IHRoaXMucmVuZGVyZXIuZ2V0UmVuZGVyZXIoUmVuZGVyVHlwZS5IZWFkZXIpO1xuICAgICAgICBlLmFjdGlvbkFyZ3MgPSBhcmdzO1xuICAgICAgICB2YXIgZGV0YWlsR3JpZCA9IGdPYmouY2hpbGRHcmlkIHx8IGdPYmouZGV0YWlsVGVtcGxhdGUgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIHZhciBpc0luZmluaXRlRGVsZXRlID0gdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgJiYgIXRoaXMucGFyZW50LmluZmluaXRlU2Nyb2xsU2V0dGluZ3MuZW5hYmxlQ2FjaGUgJiZcbiAgICAgICAgICAgICFnT2JqLmdyb3VwU2V0dGluZ3MuZW5hYmxlTGF6eUxvYWRpbmcgJiYgKChhcmdzLnJlcXVlc3RUeXBlID09PSAnZGVsZXRlJyAmJiAhZGV0YWlsR3JpZCkgfHwgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdzYXZlJyAmJlxuICAgICAgICAgICAgdGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxNb2R1bGUucmVxdWVzdFR5cGUgPT09ICdhZGQnICYmICEoZ09iai5zb3J0U2V0dGluZ3MuY29sdW1ucy5sZW5ndGggfHxcbiAgICAgICAgICAgIGdPYmouZmlsdGVyU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggfHwgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCB8fCBnT2JqLnNlYXJjaFNldHRpbmdzLmtleSB8fCBkZXRhaWxHcmlkKSkpO1xuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWZ1bmMtYm9keS1sZW5ndGhcbiAgICAgICAgZ09iai50cmlnZ2VyKGV2ZW50cy5iZWZvcmVEYXRhQm91bmQsIGUsIGZ1bmN0aW9uIChkYXRhQXJncykge1xuICAgICAgICAgICAgaWYgKGRhdGFBcmdzLmNhbmNlbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGFBcmdzLnJlc3VsdCA9IGlzTnVsbE9yVW5kZWZpbmVkKGRhdGFBcmdzLnJlc3VsdCkgPyBbXSA6IGRhdGFBcmdzLnJlc3VsdDtcbiAgICAgICAgICAgIHZhciBsZW4gPSBPYmplY3Qua2V5cyhkYXRhQXJncy5yZXN1bHQpLmxlbmd0aDtcbiAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKCFnT2JqLmdldENvbHVtbnMoKS5sZW5ndGggJiYgIWxlbikgJiYgIShnT2JqLmNvbHVtbnMubGVuZ3RoICYmIGdPYmouY29sdW1uc1swXSBpbnN0YW5jZW9mIENvbHVtbikpIHtcbiAgICAgICAgICAgICAgICBnT2JqLmhpZGVTcGlubmVyKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF90aGlzLmlzSW5maW5pdGVFbmQoYXJncykgJiYgIWxlbikge1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmluZmluaXRlRWRpdEhhbmRsZXIsIHsgZTogYXJncywgcmVzdWx0OiBlLnJlc3VsdCwgY291bnQ6IGUuY291bnQsIGFnZzogZS5hZ2dyZWdhdGVzIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLnBhcmVudC5pc0VkaXQgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmVkaXRSZXNldCwge30pO1xuICAgICAgICAgICAgX3RoaXMucGFyZW50Lm5vdGlmeShldmVudHMudG9vbHRpcERlc3Ryb3ksIHt9KTtcbiAgICAgICAgICAgIGlmIChhcmdzICYmICEoKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdpbmZpbml0ZVNjcm9sbCcgfHwgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2RlbGV0ZScgfHwgYXJncy5hY3Rpb24gPT09ICdhZGQnKSAmJlxuICAgICAgICAgICAgICAgIGdPYmouZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucGFyZW50Lm5vdGlmeShldmVudHMuY29tbWFuZENvbHVtbkRlc3Ryb3ksIHsgdHlwZTogJ3JlZnJlc2hDb21tYW5kQ29sdW1uJyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLmNvbnRlbnRSZW5kZXJlci5wcmV2Q3VycmVudFZpZXcgPSAhaXNOdWxsT3JVbmRlZmluZWQoX3RoaXMucGFyZW50LmN1cnJlbnRWaWV3RGF0YSkgJiYgX3RoaXMucGFyZW50LmN1cnJlbnRWaWV3RGF0YS5zbGljZSgpO1xuICAgICAgICAgICAgZ09iai5jdXJyZW50Vmlld0RhdGEgPSBkYXRhQXJncy5yZXN1bHQ7XG4gICAgICAgICAgICBnT2JqLm5vdGlmeShldmVudHMucmVmcmVzaEluZmluaXRlQ3VycmVudFZpZXdEYXRhLCB7IGFyZ3M6IGFyZ3MsIGRhdGE6IGRhdGFBcmdzLnJlc3VsdCB9KTtcbiAgICAgICAgICAgIGlmIChkYXRhQXJncy5jb3VudCAmJiAhZ09iai5hbGxvd1BhZ2luZyAmJiAoZ09iai5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCBnT2JqLmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSkge1xuICAgICAgICAgICAgICAgIGdPYmoudG90YWxEYXRhUmVjb3Jkc0NvdW50ID0gZGF0YUFyZ3MuY291bnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWxlbiAmJiBkYXRhQXJncy5jb3VudCAmJiBnT2JqLmFsbG93UGFnaW5nICYmIGFyZ3MgJiYgYXJncy5yZXF1ZXN0VHlwZSAhPT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuZW5hYmxlTGF6eUxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgJiYgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdncm91cGluZycgfHwgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3VuZ3JvdXBpbmcnKSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5ncm91cENvbXBsZXRlLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ09iai5wcmV2UGFnZU1vdmluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgZ09iai5wYWdlU2V0dGluZ3MudG90YWxSZWNvcmRzQ291bnQgPSBkYXRhQXJncy5jb3VudDtcbiAgICAgICAgICAgICAgICBpZiAoYXJncy5yZXF1ZXN0VHlwZSAhPT0gJ3BhZ2luZycpIHtcbiAgICAgICAgICAgICAgICAgICAgZ09iai5wYWdlU2V0dGluZ3MuY3VycmVudFBhZ2UgPSBNYXRoLmNlaWwoZGF0YUFyZ3MuY291bnQgLyBnT2JqLnBhZ2VTZXR0aW5ncy5wYWdlU2l6ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdPYmouZGF0YUJpbmQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKCFnT2JqLmdldENvbHVtbnMoKS5sZW5ndGggJiYgbGVuIHx8ICFfdGhpcy5pc0xheW91dFJlbmRlcmVkKSAmJiAhaXNHcm91cEFkYXB0aXZlKGdPYmopKSB7XG4gICAgICAgICAgICAgICAgZ09iai5yZW1vdmVNYXNrUm93KCk7XG4gICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlc09uSW5pdGlhbFJlbmRlcihkYXRhQXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIV90aGlzLmlzQ29sVHlwZURlZiAmJiBnT2JqLmdldEN1cnJlbnRWaWV3UmVjb3JkcygpKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmRhdGEuZGF0YU1hbmFnZXIuZGF0YVNvdXJjZS5vZmZsaW5lICYmIGdPYmouZGF0YVNvdXJjZSAmJiBnT2JqLmRhdGFTb3VyY2UubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZUNvbHVtblR5cGUoZ09iai5kYXRhU291cmNlWzBdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZUNvbHVtblR5cGUoZ09iai5nZXRDdXJyZW50Vmlld1JlY29yZHMoKVswXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFfdGhpcy5wYXJlbnQuaXNJbml0aWFsTG9hZCAmJiBfdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5kaXNhYmxlUGFnZVdpc2VBZ2dyZWdhdGVzICYmXG4gICAgICAgICAgICAgICAgIV90aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZGF0YUFyZ3MucmVzdWx0ID0gX3RoaXMucGFyZW50LmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBBcnJheSA/IF90aGlzLnBhcmVudC5kYXRhU291cmNlIDogX3RoaXMucGFyZW50LmN1cnJlbnRWaWV3RGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoX3RoaXMucGFyZW50LmlzUmVhY3QgfHwgX3RoaXMucGFyZW50LmlzVnVlKSAmJiAhaXNOdWxsT3JVbmRlZmluZWQoYXJncykgJiYgYXJncy5yZXF1ZXN0VHlwZSAhPT0gJ2luZmluaXRlU2Nyb2xsJyAmJiAhYXJncy5pc0Zyb3plbikge1xuICAgICAgICAgICAgICAgIGNsZWFyUmVhY3RWdWVUZW1wbGF0ZXMoX3RoaXMucGFyZW50LCBbJ2Zvb3RlclRlbXBsYXRlJ10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5pc0FuZ3VsYXIgJiYgX3RoaXMucGFyZW50LmFsbG93R3JvdXBpbmcgJiYgX3RoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY2FwdGlvblRlbXBsYXRlXG4gICAgICAgICAgICAgICAgJiYgISghaXNOdWxsT3JVbmRlZmluZWQoYXJncykgJiYgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2luZmluaXRlU2Nyb2xsJykpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuZGVzdHJveVRlbXBsYXRlKFsnZ3JvdXBTZXR0aW5nc19jYXB0aW9uVGVtcGxhdGUnXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5kYXRhUmVhZHksIGV4dGVuZCh7IGNvdW50OiBkYXRhQXJncy5jb3VudCwgcmVzdWx0OiBkYXRhQXJncy5yZXN1bHQsIGFnZ3JlZ2F0ZXM6IGRhdGFBcmdzLmFnZ3JlZ2F0ZXMsIGxvYWRTdW1tYXJ5T25FbXB0eTogZmFsc2UgfSwgYXJncykpO1xuICAgICAgICAgICAgaWYgKChnT2JqLmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggfHwgKGFyZ3MgJiYgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3VuZ3JvdXBpbmcnKSlcbiAgICAgICAgICAgICAgICAmJiAoYXJncyAmJiBhcmdzLnJlcXVlc3RUeXBlICE9PSAnZmlsdGVyaW5nJykpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5oZWFkZXJSZW5kZXJlci5yZWZyZXNoVUkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsZW4pIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNHcm91cEFkYXB0aXZlKGdPYmopKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gJ2NvbnRlbnQnO1xuICAgICAgICAgICAgICAgICAgICBhcmdzLnNjcm9sbFRvcCA9IHsgdG9wOiBfdGhpcy5jb250ZW50UmVuZGVyZXJbXCJcIiArIGNvbnRlbnRdLnNjcm9sbFRvcCB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWlzSW5maW5pdGVEZWxldGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5lbmFibGVJbW11dGFibGVNb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5jb250ZW50UmVuZGVyZXIuaW1tdXRhYmxlTW9kZVJlbmRlcmluZyhhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbnRlbnRSZW5kZXJlci5yZWZyZXNoQ29udGVudFJvd3MoYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmluZmluaXRlRWRpdEhhbmRsZXIsIHsgZTogYXJncywgcmVzdWx0OiBlLnJlc3VsdCwgY291bnQ6IGUuY291bnQsIGFnZzogZS5hZ2dyZWdhdGVzIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChhcmdzICYmIGFyZ3MuaXNDYXB0aW9uQ29sbGFwc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWdPYmouZ2V0Q29sdW1ucygpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBnT2JqLmVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KF90aGlzLmwxMG4uZ2V0Q29uc3RhbnQoJ0VtcHR5RGF0YVNvdXJjZUVycm9yJykpOyAvL1RvRE86IGNoYW5nZSB0aGlzIGFsZXJ0IGFzIGRpYWxvZ1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLmNvbnRlbnRSZW5kZXJlci5zZXRSb3dFbGVtZW50cyhbXSk7XG4gICAgICAgICAgICAgICAgX3RoaXMuY29udGVudFJlbmRlcmVyLnNldFJvd09iamVjdHMoW10pO1xuICAgICAgICAgICAgICAgIF90aGlzLmFyaWFTZXJ2aWNlLnNldEJ1c3koX3RoaXMucGFyZW50LmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmNvbnRlbnQpLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgZ09iai5yZW1vdmVNYXNrUm93KCk7XG4gICAgICAgICAgICAgICAgX3RoaXMucmVuZGVyRW1wdHlSb3coKTtcbiAgICAgICAgICAgICAgICBpZiAoZ09iai5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJiAhbGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmNvbnRlbnRSZWFkeSwgeyByb3dzOiBnT2JqLmdldFJvd3NPYmplY3QoKSwgYXJnczoge30gfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSAoYXJncy5yZXF1ZXN0VHlwZSB8fCAnJykudG9Mb3dlckNhc2UoKSArICctY29tcGxldGUnO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQubm90aWZ5KGFjdGlvbiwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLnJlcXVlc3RUeXBlID09PSAnYmF0Y2hzYXZlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5jYW5jZWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3Mucm93cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5pc0Zyb3plbiA9ICFhcmdzLmlzRnJvemVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmFjdGlvbkNvbXBsZXRlLCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmF1dG9GaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LnByZXZlbnRBZGp1c3RDb2x1bW5zKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5oaWRlU3Bpbm5lcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMucGFyZW50Lm5vdGlmeShldmVudHMudG9vbGJhclJlZnJlc2gsIHt9KTtcbiAgICAgICAgICAgIF90aGlzLnNldFJvd0NvdW50KF90aGlzLnBhcmVudC5nZXRDdXJyZW50Vmlld1JlY29yZHMoKS5sZW5ndGgpO1xuICAgICAgICAgICAgaWYgKCdxdWVyeScgaW4gZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudC5nZXREYXRhTW9kdWxlKCkuaXNRdWVyeUludm9rZWRGcm9tRGF0YSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBlIC0gc3BlY2lmaWVzIHRoZSBvYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdFtdfSBlLnJlc3VsdCAtIHNwZWNpZmllcyB0aGUgcmVzdWx0XG4gICAgICogQHBhcmFtIHtOb3RpZnlBcmdzfSBhcmdzIC0gc3BlY2lmaWVzIHRoZSBhcmdzXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFJlbmRlci5wcm90b3R5cGUuZGF0YU1hbmFnZXJGYWlsdXJlID0gZnVuY3Rpb24gKGUsIGFyZ3MpIHtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5jb250ZW50TW9kdWxlKSkge1xuICAgICAgICAgICAgdGhpcy5hcmlhU2VydmljZS5zZXRPcHRpb25zKHRoaXMucGFyZW50LmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuJyArIGxpdGVyYWxzLmNvbnRlbnQpLCB7IGJ1c3k6IGZhbHNlLCBpbnZhbGlkOiB0cnVlIH0pO1xuICAgICAgICAgICAgdGhpcy5zZXRSb3dDb3VudCgxKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC50cmlnZ2VyKGV2ZW50cy5hY3Rpb25GYWlsdXJlLCBlICYmIGUuZXJyb3IgPyBlIDogeyBlcnJvcjogZSB9KTtcbiAgICAgICAgdGhpcy5wYXJlbnQuaGlkZVNwaW5uZXIoKTtcbiAgICAgICAgdGhpcy5wYXJlbnQucmVtb3ZlTWFza1JvdygpO1xuICAgICAgICBpZiAoYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3NhdmUnIHx8IGFyZ3MucmVxdWVzdFR5cGUgPT09ICdkZWxldGUnXG4gICAgICAgICAgICB8fCBhcmdzLm5hbWUgPT09ICdidWxrLXNhdmUnKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQuY3VycmVudFZpZXdEYXRhID0gW107XG4gICAgICAgIHRoaXMucmVuZGVyRW1wdHlSb3coKTtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5pc0luaXRpYWxMb2FkKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5mb2N1c01vZHVsZS5zZXRGaXJzdEZvY3VzYWJsZVRhYkluZGV4KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQubG9nKCdhY3Rpb25mYWlsdXJlJywgeyBlcnJvcjogZSB9KTtcbiAgICB9O1xuICAgIFJlbmRlci5wcm90b3R5cGUuc2V0Um93Q291bnQgPSBmdW5jdGlvbiAoZGF0YVJvd0NvdW50KSB7XG4gICAgICAgIHRoaXMuYXJpYVNlcnZpY2Uuc2V0T3B0aW9ucyh0aGlzLnBhcmVudC5lbGVtZW50LCB7XG4gICAgICAgICAgICByb3djb3VudDogZGF0YVJvd0NvdW50ID8gZGF0YVJvd0NvdW50LnRvU3RyaW5nKCkgOiAnMSdcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBSZW5kZXIucHJvdG90eXBlLmlzSW5maW5pdGVFbmQgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgJiYgIXRoaXMucGFyZW50LmluZmluaXRlU2Nyb2xsU2V0dGluZ3MuZW5hYmxlQ2FjaGUgJiYgYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2RlbGV0ZSc7XG4gICAgfTtcbiAgICBSZW5kZXIucHJvdG90eXBlLnVwZGF0ZXNPbkluaXRpYWxSZW5kZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB0aGlzLmlzTGF5b3V0UmVuZGVyZWQgPSB0cnVlO1xuICAgICAgICB2YXIgaXNFbXB0eUNvbCA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuY29sdW1ucy5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkQ29sdW1ucyhlLnJlc3VsdFswXSk7XG4gICAgICAgICAgICBpc0VtcHR5Q29sID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBwcmVwYXJlQ29sdW1ucyh0aGlzLnBhcmVudC5jb2x1bW5zLCBudWxsLCB0aGlzLnBhcmVudCk7XG4gICAgICAgIGlmIChpc0VtcHR5Q29sKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnJlZnJlc2hTcGxpdEZyb3plbkNvbHVtbiwge30pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGVhZGVyUmVuZGVyZXIucmVuZGVyVGFibGUoKTtcbiAgICAgICAgdGhpcy5jb250ZW50UmVuZGVyZXIucmVuZGVyVGFibGUoKTtcbiAgICAgICAgdGhpcy5wYXJlbnQuaXNBdXRvR2VuID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5hdXRvQ29sLCB7fSk7XG4gICAgfTtcbiAgICBSZW5kZXIucHJvdG90eXBlLml0ZXJhdGVDb21wbGV4Q29sdW1ucyA9IGZ1bmN0aW9uIChvYmosIGZpZWxkLCBzcGxpdCkge1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iaik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNoaWxkS2V5cyA9IHR5cGVvZiBvYmpba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dID09PSAnb2JqZWN0J1xuICAgICAgICAgICAgICAgICYmIG9ialtrZXlzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0gJiYgIShvYmpba2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dIGluc3RhbmNlb2YgRGF0ZSkgP1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKG9ialtrZXlzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0pIDogW107XG4gICAgICAgICAgICBpZiAoY2hpbGRLZXlzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXRlcmF0ZUNvbXBsZXhDb2x1bW5zKG9ialtrZXlzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0sIGZpZWxkICsgKGtleXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldICsgJy4nKSwgc3BsaXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3BsaXRbdGhpcy5jb3VudGVyXSA9IGZpZWxkICsga2V5c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgdGhpcy5jb3VudGVyKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlbmRlci5wcm90b3R5cGUuYnVpbGRDb2x1bW5zID0gZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICB2YXIgY29scyA9IFtdO1xuICAgICAgICB2YXIgY29tcGxleENvbHMgPSB7fTtcbiAgICAgICAgdGhpcy5pdGVyYXRlQ29tcGxleENvbHVtbnMocmVjb3JkLCAnJywgY29tcGxleENvbHMpO1xuICAgICAgICB2YXIgY29sdW1ucyA9IE9iamVjdC5rZXlzKGNvbXBsZXhDb2xzKS5maWx0ZXIoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGNvbXBsZXhDb2xzW1wiXCIgKyBlXSAhPT0gJ0JsYXpJZCc7IH0pLlxuICAgICAgICAgICAgbWFwKGZ1bmN0aW9uIChmaWVsZCkgeyByZXR1cm4gY29tcGxleENvbHNbXCJcIiArIGZpZWxkXTsgfSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb2x1bW5zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IHsgJ2ZpZWxkJzogY29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0gfTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbikge1xuICAgICAgICAgICAgICAgIGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLndpZHRoID0gIWlzTnVsbE9yVW5kZWZpbmVkKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLndpZHRoKSA/XG4gICAgICAgICAgICAgICAgICAgIGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLndpZHRoIDogMjAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyZW50LnNldFByb3BlcnRpZXMoeyAnY29sdW1ucyc6IGNvbHMgfSwgdHJ1ZSk7XG4gICAgfTtcbiAgICBSZW5kZXIucHJvdG90eXBlLmluc3RhbnRpYXRlUmVuZGVyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuYWRkUmVuZGVyZXIoUmVuZGVyVHlwZS5IZWFkZXIsIG5ldyBIZWFkZXJSZW5kZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZFJlbmRlcmVyKFJlbmRlclR5cGUuQ29udGVudCwgbmV3IENvbnRlbnRSZW5kZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgICAgICB2YXIgY2VsbHJlbmRlciA9IHRoaXMubG9jYXRvci5nZXRTZXJ2aWNlKCdjZWxsUmVuZGVyZXJGYWN0b3J5Jyk7XG4gICAgICAgIGNlbGxyZW5kZXIuYWRkQ2VsbFJlbmRlcmVyKENlbGxUeXBlLkhlYWRlciwgbmV3IEhlYWRlckNlbGxSZW5kZXJlcih0aGlzLnBhcmVudCwgdGhpcy5sb2NhdG9yKSk7XG4gICAgICAgIGNlbGxyZW5kZXIuYWRkQ2VsbFJlbmRlcmVyKENlbGxUeXBlLkRhdGEsIG5ldyBDZWxsUmVuZGVyZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgICAgICBjZWxscmVuZGVyLmFkZENlbGxSZW5kZXJlcihDZWxsVHlwZS5TdGFja2VkSGVhZGVyLCBuZXcgU3RhY2tlZEhlYWRlckNlbGxSZW5kZXJlcih0aGlzLnBhcmVudCwgdGhpcy5sb2NhdG9yKSk7XG4gICAgICAgIGNlbGxyZW5kZXIuYWRkQ2VsbFJlbmRlcmVyKENlbGxUeXBlLkluZGVudCwgbmV3IEluZGVudENlbGxSZW5kZXJlcih0aGlzLnBhcmVudCwgdGhpcy5sb2NhdG9yKSk7XG4gICAgICAgIGNlbGxyZW5kZXIuYWRkQ2VsbFJlbmRlcmVyKENlbGxUeXBlLkdyb3VwQ2FwdGlvbiwgbmV3IEdyb3VwQ2FwdGlvbkNlbGxSZW5kZXJlcih0aGlzLnBhcmVudCwgdGhpcy5sb2NhdG9yKSk7XG4gICAgICAgIGNlbGxyZW5kZXIuYWRkQ2VsbFJlbmRlcmVyKENlbGxUeXBlLkdyb3VwQ2FwdGlvbkVtcHR5LCBuZXcgR3JvdXBDYXB0aW9uRW1wdHlDZWxsUmVuZGVyZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgICAgICBjZWxscmVuZGVyLmFkZENlbGxSZW5kZXJlcihDZWxsVHlwZS5FeHBhbmQsIG5ldyBFeHBhbmRDZWxsUmVuZGVyZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgICAgICBjZWxscmVuZGVyLmFkZENlbGxSZW5kZXJlcihDZWxsVHlwZS5IZWFkZXJJbmRlbnQsIG5ldyBIZWFkZXJJbmRlbnRDZWxsUmVuZGVyZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgICAgICBjZWxscmVuZGVyLmFkZENlbGxSZW5kZXJlcihDZWxsVHlwZS5TdGFja2VkSGVhZGVyLCBuZXcgU3RhY2tlZEhlYWRlckNlbGxSZW5kZXJlcih0aGlzLnBhcmVudCwgdGhpcy5sb2NhdG9yKSk7XG4gICAgICAgIGNlbGxyZW5kZXIuYWRkQ2VsbFJlbmRlcmVyKENlbGxUeXBlLkRldGFpbEhlYWRlciwgbmV3IERldGFpbEhlYWRlckluZGVudENlbGxSZW5kZXJlcih0aGlzLnBhcmVudCwgdGhpcy5sb2NhdG9yKSk7XG4gICAgICAgIGNlbGxyZW5kZXIuYWRkQ2VsbFJlbmRlcmVyKENlbGxUeXBlLlJvd0RyYWdISWNvbiwgbmV3IFJvd0RyYWdEcm9wSGVhZGVyUmVuZGVyZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgICAgICBjZWxscmVuZGVyLmFkZENlbGxSZW5kZXJlcihDZWxsVHlwZS5EZXRhaWxFeHBhbmQsIG5ldyBEZXRhaWxFeHBhbmRDZWxsUmVuZGVyZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgICAgICBjZWxscmVuZGVyLmFkZENlbGxSZW5kZXJlcihDZWxsVHlwZS5EZXRhaWxGb290ZXJJbnRlbnQsIG5ldyBJbmRlbnRDZWxsUmVuZGVyZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgICAgICBjZWxscmVuZGVyLmFkZENlbGxSZW5kZXJlcihDZWxsVHlwZS5Sb3dEcmFnSWNvbiwgbmV3IFJvd0RyYWdEcm9wUmVuZGVyZXIodGhpcy5wYXJlbnQsIHRoaXMubG9jYXRvcikpO1xuICAgIH07XG4gICAgUmVuZGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuaW5pdGlhbExvYWQsIHRoaXMuaW5zdGFudGlhdGVSZW5kZXJlciwgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKCdyZWZyZXNoZGF0YVNvdXJjZScsIHRoaXMuZGF0YU1hbmFnZXJTdWNjZXNzLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLm1vZGVsQ2hhbmdlZCwgdGhpcy5yZWZyZXNoLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLnJlZnJlc2hDb21wbGV0ZSwgdGhpcy5yZWZyZXNoQ29tcGxldGUsIHRoaXMpO1xuICAgICAgICB0aGlzLnBhcmVudC5vbihldmVudHMuYnVsa1NhdmUsIHRoaXMuc2VuZEJ1bGtSZXF1ZXN0LCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQub24oZXZlbnRzLnNob3dFbXB0eUdyaWQsIGZ1bmN0aW9uICgpIHsgX3RoaXMuZW1wdHlHcmlkID0gdHJ1ZTsgfSwgdGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50Lm9uKGV2ZW50cy5hdXRvQ29sLCB0aGlzLmR5bmFtaWNDb2x1bW5DaGFuZ2UsIHRoaXMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtSZXR1cm5UeXBlfSBlIC0gc3BlY2lmaWVzIHRoZSBSZXR1cm4gdHlwZVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdD59IHJldHVybnMgdGhlIG9iamVjdFxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBSZW5kZXIucHJvdG90eXBlLnZhbGlkYXRlR3JvdXBSZWNvcmRzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGluZGV4ID0gZS5yZXN1bHQubGVuZ3RoIC0gMTtcbiAgICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ3JvdXAwID0gZS5yZXN1bHRbMF07XG4gICAgICAgIHZhciBncm91cE4gPSBlLnJlc3VsdFtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldO1xuICAgICAgICB2YXIgcHJlZGljYXRlID0gW107XG4gICAgICAgIHZhciBhZGRXaGVyZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICAgICAgdmFyIGdyb3VwcyA9IFtncm91cDAsIGdyb3VwTl07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGdyb3Vwcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHByZWRpY2F0ZS5wdXNoKG5ldyBQcmVkaWNhdGUoJ2ZpZWxkJywgJz09JywgZ3JvdXBzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maWVsZCkuYW5kKF90aGlzLmdldFByZWRpY2F0ZSgna2V5JywgJ2VxdWFsJywgZ3JvdXBzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5rZXkpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbnB1dC53aGVyZShQcmVkaWNhdGUub3IocHJlZGljYXRlKSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBxdWVyeSA9IG5ldyBRdWVyeSgpO1xuICAgICAgICBhZGRXaGVyZShxdWVyeSk7XG4gICAgICAgIHZhciBjdXJEbSA9IG5ldyBEYXRhTWFuYWdlcihlLnJlc3VsdCk7XG4gICAgICAgIHZhciBjdXJGaWx0ZXIgPSBjdXJEbS5leGVjdXRlTG9jYWwocXVlcnkpO1xuICAgICAgICB2YXIgbmV3UXVlcnkgPSB0aGlzLmRhdGEuZ2VuZXJhdGVRdWVyeSh0cnVlKTtcbiAgICAgICAgdmFyIHJQcmVkaWNhdGUgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuZGF0YS5pc1JlbW90ZSgpKSB7XG4gICAgICAgICAgICB2YXIgZ3JvdXBzID0gW2dyb3VwMCwgZ3JvdXBOXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ3JvdXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgclByZWRpY2F0ZS5wdXNoKHRoaXMuZ2V0UHJlZGljYXRlKGdyb3Vwc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQsICdlcXVhbCcsIGdyb3Vwc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ua2V5KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdRdWVyeS53aGVyZShQcmVkaWNhdGUub3IoclByZWRpY2F0ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYWRkV2hlcmUobmV3UXVlcnkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICB0aGlzLmRhdGEuZ2V0RGF0YSh7fSwgbmV3UXVlcnkpLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIF90aGlzLnVwZGF0ZUdyb3VwSW5mbyhjdXJGaWx0ZXIsIHIucmVzdWx0KTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZSk7XG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7IHJldHVybiBkZWZlcnJlZC5yZWplY3QoZSk7IH0pO1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSBEZWZpbmVzIHRoZSBrZXlcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb3BlcmF0b3IgLSBEZWZpbmVzIHRoZSBvcGVyYXRvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgbnVtYmVyIHwgRGF0ZX0gdmFsdWUgLSBEZWZpbmVzIHRoZSB2YWx1ZVxuICAgICAqIEByZXR1cm5zIHtQcmVkaWNhdGV9IC0gUmV0dXJucyB0aGUgcHJlZGljYXRlXG4gICAgICogQGhpZGRlbiAqL1xuICAgIFJlbmRlci5wcm90b3R5cGUuZ2V0UHJlZGljYXRlID0gZnVuY3Rpb24gKGtleSwgb3BlcmF0b3IsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXREYXRlUHJlZGljYXRlKHsgZmllbGQ6IGtleSwgb3BlcmF0b3I6IG9wZXJhdG9yLCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcmVkaWNhdGUoa2V5LCBvcGVyYXRvciwgdmFsdWUpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3RbXX0gY3VycmVudCAtIERlZmluZXMgdGhlIGN1cnJlbnQgb2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3RbXX0gdW50b3VjaGVkIC0gRGVmaW5lcyB0aGUgb2JqZWN0IG5lZWRzIHRvIG1lcmdlXG4gICAgICogQHJldHVybnMge09iamVjdFtdfSAtIFJldHVybnMgdGhlIHVwZGF0ZWQgZ3JvdXAgaW5mb3JtYXRpb25cbiAgICAgKiBAaGlkZGVuICovXG4gICAgUmVuZGVyLnByb3RvdHlwZS51cGRhdGVHcm91cEluZm8gPSBmdW5jdGlvbiAoY3VycmVudCwgdW50b3VjaGVkKSB7XG4gICAgICAgIHZhciBkbSA9IG5ldyBEYXRhTWFuYWdlcih1bnRvdWNoZWQpO1xuICAgICAgICB2YXIgZWxlbWVudHMgPSBjdXJyZW50O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdXBkYXRlZEdyb3VwID0gZG0uZXhlY3V0ZUxvY2FsKG5ldyBRdWVyeSgpXG4gICAgICAgICAgICAgICAgLndoZXJlKG5ldyBQcmVkaWNhdGUoJ2ZpZWxkJywgJz09JywgZWxlbWVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkKS5hbmQodGhpcy5nZXRQcmVkaWNhdGUoJ2tleScsICdlcXVhbCcsIGVsZW1lbnRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5rZXkpKSkpWzBdO1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh1cGRhdGVkR3JvdXApKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvdW50ID0gdXBkYXRlZEdyb3VwLmNvdW50O1xuICAgICAgICAgICAgICAgIHZhciBpdGVtR3JvdXAgPSBlbGVtZW50c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXRlbXM7XG4gICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWRHcm91cEl0ZW0gPSB1cGRhdGVkR3JvdXAuaXRlbXM7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1Hcm91cC5Hcm91cEd1aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLml0ZW1zID1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlR3JvdXBJbmZvKGVsZW1lbnRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pdGVtcywgdXBkYXRlZEdyb3VwLml0ZW1zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJvd3MgPSB0aGlzLnBhcmVudC5hZ2dyZWdhdGVzO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcm93cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm93ID0gcm93c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcm93LmNvbHVtbnMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2x1bW4gPSByb3cuY29sdW1uc1twYXJzZUludChrLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZXMgPSBjb2x1bW4udHlwZSBpbnN0YW5jZW9mIEFycmF5ID8gKGNvbHVtbi50eXBlKSA6IFsoY29sdW1uLnR5cGUpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGwgPSAwOyBsIDwgdHlwZXMubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gY29sdW1uLmZpZWxkICsgJyAtICcgKyB0eXBlc1twYXJzZUludChsLnRvU3RyaW5nKCksIDEwKV0udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGl0ZW1Hcm91cC5sZXZlbCA/IHVwZGF0ZWRHcm91cEl0ZW0ucmVjb3JkcyA6IHVwZGF0ZWRHcm91cC5pdGVtcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMucGFyZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlc1twYXJzZUludChsLnRvU3RyaW5nKCksIDEwKV0gPT09ICdDdXN0b20nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhXzEgPSBpdGVtR3JvdXAubGV2ZWwgPyB1cGRhdGVkR3JvdXBJdGVtIDogdXBkYXRlZEdyb3VwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGNvbHVtblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmN1c3RvbUFnZ3JlZ2F0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0ZW1wID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IGdldFZhbHVlKHRlbXAsIHdpbmRvdyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmFnZ3JlZ2F0ZXNbXCJcIiArIGtleV0gPSB0ZW1wID8gdGVtcC5jYWxsKGNvbnRleHQsIGRhdGFfMSwgcm93LmNvbHVtbnNbcGFyc2VJbnQoay50b1N0cmluZygpLCAxMCldKSA6ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmFnZ3JlZ2F0ZXNbXCJcIiArIGtleV0gPSBEYXRhVXRpbC5hZ2dyZWdhdGVzW3R5cGVzW3BhcnNlSW50KGwudG9TdHJpbmcoKSwgMTApXS50b0xvd2VyQ2FzZSgpXShkYXRhLCByb3cuY29sdW1uc1twYXJzZUludChrLnRvU3RyaW5nKCksIDEwKV0uZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3VycmVudDtcbiAgICB9O1xuICAgIHJldHVybiBSZW5kZXI7XG59KCkpO1xuZXhwb3J0IHsgUmVuZGVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/render.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/responsive-dialog-renderer.js":
/*!*********************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/responsive-dialog-renderer.js ***!
  \*********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ResponsiveDialogRenderer: () => (/* binding */ ResponsiveDialogRenderer)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @syncfusion/ej2-popups */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-popups@29.1.37/node_modules/@syncfusion/ej2-popups/src/dialog/dialog.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @syncfusion/ej2-buttons */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-buttons@29.1.34/node_modules/@syncfusion/ej2-buttons/src/button/button.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n\n\n\n\n\n\n/**\n *\n * The `ResponsiveDialogRenderer` module is used to render the responsive dialogs.\n */\nvar ResponsiveDialogRenderer = /** @class */ (function () {\n    function ResponsiveDialogRenderer(parent, serviceLocator) {\n        this.sortedCols = [];\n        this.sortPredicate = [];\n        /** @hidden */\n        this.isCustomDialog = false;\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.addEventListener();\n    }\n    ResponsiveDialogRenderer.prototype.addEventListener = function () {\n        this.evtHandlers = [{ event: _base_constant__WEBPACK_IMPORTED_MODULE_1__.filterDialogClose, handler: this.closeCustomDialog },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_1__.refreshCustomFilterOkBtn, handler: this.refreshCustomFilterOkBtn },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_1__.renderResponsiveCmenu, handler: this.renderResponsiveContextMenu },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_1__.filterCmenuSelect, handler: this.renderCustomFilterDiv },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_1__.customFilterClose, handler: this.customExFilterClose },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_1__.refreshCustomFilterClearBtn, handler: this.refreshCustomFilterClearBtn }];\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveEventListener)(this.parent, this.evtHandlers, true, this);\n        this.onActionCompleteFn = this.editComplate.bind(this);\n        this.parent.addEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_1__.actionComplete, this.onActionCompleteFn);\n    };\n    ResponsiveDialogRenderer.prototype.customExFilterClose = function () {\n        this.isCustomDlgRender = false;\n    };\n    ResponsiveDialogRenderer.prototype.renderCustomFilterDiv = function () {\n        var header = this.customResponsiveDlg.element.querySelector('.e-dlg-header-content');\n        var title = header.querySelector('.e-dlg-custom-header');\n        var closeBtn = header.querySelector('.e-dlg-closeicon-btn');\n        this.isCustomDlgRender = true;\n        this.parent.filterModule.filterModule.closeDialog();\n        this.saveBtn.element.style.display = '';\n        this.refreshCustomFilterOkBtn({ disabled: false });\n        this.backBtn.element.style.display = 'none';\n        closeBtn.style.display = '';\n        title.innerHTML = this.parent.localeObj.getConstant('CustomFilter');\n        var content = this.customResponsiveDlg.element.querySelector('.e-dlg-content');\n        this.customExcelFilterParent = this.parent.createElement('div', { className: 'e-xl-customfilterdiv e-default-filter' });\n        content.appendChild(this.customExcelFilterParent);\n    };\n    ResponsiveDialogRenderer.prototype.renderResponsiveContextMenu = function (args) {\n        if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter) {\n            var content = this.customResponsiveDlg.element.querySelector('.e-dlg-content');\n            var header = this.customResponsiveDlg.element.querySelector('.e-dlg-header-content');\n            var closeBtn = header.querySelector('.e-dlg-closeicon-btn');\n            var text = header.querySelector('.e-dlg-custom-header');\n            if (args.isOpen) {\n                content.firstChild.style.display = 'none';\n                content.appendChild(args.target);\n                closeBtn.style.display = 'none';\n                this.saveBtn.element.style.display = 'none';\n                this.filterClearBtn.element.style.display = 'none';\n                text.innerHTML = args.header;\n                var backBtn = this.parent.createElement('button');\n                var span = this.parent.createElement('span', { className: 'e-btn-icon e-resfilterback e-icons' });\n                backBtn.appendChild(span);\n                this.backBtn = new _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_4__.Button({\n                    cssClass: this.parent.cssClass ? 'e-res-back-btn' + ' ' + this.parent.cssClass : 'e-res-back-btn'\n                });\n                this.backBtn.appendTo(backBtn);\n                text.parentElement.insertBefore(backBtn, text);\n            }\n            else if (this.backBtn && !this.isCustomDlgRender) {\n                content.firstChild.style.display = '';\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(this.backBtn.element);\n                closeBtn.style.display = '';\n                this.saveBtn.element.style.display = '';\n                if (this.isFiltered) {\n                    this.filterClearBtn.element.style.display = '';\n                }\n                text.innerHTML = this.getHeaderTitle({ action: _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter }, args.col);\n            }\n        }\n    };\n    ResponsiveDialogRenderer.prototype.refreshCustomFilterClearBtn = function (args) {\n        if (this.filterClearBtn) {\n            this.isFiltered = args.isFiltered;\n            this.filterClearBtn.element.style.display = args.isFiltered ? '' : 'none';\n        }\n    };\n    ResponsiveDialogRenderer.prototype.refreshCustomFilterOkBtn = function (args) {\n        if (this.saveBtn) {\n            this.saveBtn.disabled = args.disabled;\n        }\n        if (this.parent.columnChooserModule && this.parent.columnChooserModule.responsiveDialogRenderer.saveBtn) {\n            this.parent.columnChooserModule.responsiveDialogRenderer.saveBtn.disabled = args.disabled;\n        }\n    };\n    ResponsiveDialogRenderer.prototype.columnMenuResponsiveContent = function (str, locale, disabled) {\n        var cDiv = this.parent.createElement('div', { className: 'e-responsivecoldiv e-responsive' + str.toLowerCase() + 'div' + (disabled ? ' e-disabled' : '') });\n        var span = this.parent.createElement('span', { className: 'e-icons e-res' + str.toLowerCase() + '-icon e-btn-icon' });\n        var icon = this.parent.createElement('span', { innerHTML: locale, className: 'e-rescolumn-menu e-res-header-text' });\n        cDiv.appendChild(span);\n        cDiv.appendChild(icon);\n        this.customColumnDiv.appendChild(cDiv);\n    };\n    ResponsiveDialogRenderer.prototype.renderResponsiveContent = function (col, column) {\n        var _this = this;\n        var gObj = this.parent;\n        var isColumnChooser = this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColumnChooser;\n        if (col || isColumnChooser) {\n            this.filterParent = this.parent.createElement('div', { className: (isColumnChooser ? 'e-maincolumnchooserdiv ' : '') + 'e-mainfilterdiv e-default-filter',\n                id: (isColumnChooser ? 'columchooser' : col.uid) + '-main-filter' });\n            return this.filterParent;\n        }\n        else {\n            this.customColumnDiv = gObj.createElement('div', { className: 'columndiv columnmenudiv' });\n            this.customColumnDiv.style.width = '100%';\n            if (this.parent.showColumnMenu && this.parent.rowRenderingMode === 'Horizontal' && this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColMenu) {\n                this.columnMenuResponsiveContent('AutoFitAll', gObj.localeObj.getConstant('AutoFitAll'));\n                this.columnMenuResponsiveContent('AutoFit', gObj.localeObj.getConstant('AutoFit'));\n                if (column.allowGrouping && gObj.allowGrouping) {\n                    this.columnMenuResponsiveContent('Group', gObj.localeObj.getConstant('Group'), gObj.groupSettings.columns.indexOf(column.field) >= 0);\n                    this.columnMenuResponsiveContent('UnGroup', gObj.localeObj.getConstant('Ungroup'), gObj.groupSettings.columns.indexOf(column.field) < 0);\n                }\n                if (column.allowSorting && gObj.allowSorting) {\n                    var direction = 'None';\n                    var sortColumns = this.parent.sortSettings.columns;\n                    for (var i = 0; i < sortColumns.length; i++) {\n                        if (sortColumns[parseInt(i.toString(), 10)].field === column.field) {\n                            direction = sortColumns[parseInt(i.toString(), 10)].direction;\n                            break;\n                        }\n                    }\n                    this.columnMenuResponsiveContent('ascending', gObj.localeObj.getConstant('SortAscending'), direction === 'Ascending');\n                    this.columnMenuResponsiveContent('descending', gObj.localeObj.getConstant('SortDescending'), direction === 'Descending');\n                }\n                if (gObj.showColumnChooser) {\n                    this.columnMenuResponsiveContent('Column', gObj.localeObj.getConstant('Columnchooser'));\n                }\n                if (column.allowFiltering && gObj.allowFiltering) {\n                    this.columnMenuResponsiveContent('Filter', gObj.localeObj.getConstant('FilterMenu'));\n                }\n            }\n            else {\n                var cols = gObj.getColumns();\n                var sortBtnParent = gObj.createElement('div', { className: 'e-ressortbutton-parent' });\n                var filteredCols = [];\n                var isSort = this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isSort;\n                var isFilter = this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter;\n                if (isFilter) {\n                    for (var i = 0; i < gObj.filterSettings.columns.length; i++) {\n                        filteredCols.push(gObj.filterSettings.columns[parseInt(i.toString(), 10)].field);\n                    }\n                }\n                for (var i = 0; i < cols.length; i++) {\n                    if (!cols[parseInt(i.toString(), 10)].visible || (!cols[parseInt(i.toString(), 10)].allowSorting && isSort)\n                        || (!cols[parseInt(i.toString(), 10)].allowFiltering && isFilter)) {\n                        continue;\n                    }\n                    var cDiv = gObj.createElement('div', { className: 'e-responsivecoldiv' });\n                    cDiv.setAttribute('data-e-mappingname', cols[parseInt(i.toString(), 10)].field);\n                    cDiv.setAttribute('data-e-mappinguid', cols[parseInt(i.toString(), 10)].uid);\n                    var span = gObj.createElement('span', { innerHTML: cols[parseInt(i.toString(), 10)].headerText, className: 'e-res-header-text' });\n                    cDiv.appendChild(span);\n                    this.customColumnDiv.appendChild(cDiv);\n                    if (isSort) {\n                        var fields = this.getSortedFieldsAndDirections('field');\n                        var index = fields.indexOf(cols[parseInt(i.toString(), 10)].field);\n                        var button = gObj.createElement('button', { id: gObj.element.id + cols[parseInt(i.toString(), 10)].field + 'sortbutton' });\n                        var clone = sortBtnParent.cloneNode();\n                        clone.appendChild(button);\n                        cDiv.appendChild(clone);\n                        var btnObj = new _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_4__.Button({\n                            cssClass: this.parent.cssClass ? 'e-ressortbutton' + ' ' + this.parent.cssClass : 'e-ressortbutton'\n                        });\n                        btnObj.appendTo(button);\n                        var buttonInnerText = void 0;\n                        if ((!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.sortSettings.columns[parseInt(index.toString(), 10)]))) {\n                            buttonInnerText = (this.parent.sortSettings.columns[parseInt(index.toString(), 10)].direction === 'Ascending') ?\n                                this.parent.localeObj.getConstant('AscendingText') : this.parent.localeObj.getConstant('DescendingText');\n                        }\n                        button.innerHTML = index > -1 ? buttonInnerText : this.parent.localeObj.getConstant('NoneText');\n                        button.onclick = function (e) {\n                            _this.sortButtonClickHandler(e.target);\n                        };\n                    }\n                    if (isFilter && filteredCols.indexOf(cols[parseInt(i.toString(), 10)].field) > -1) {\n                        var divIcon = gObj.createElement('div', { className: 'e-icons e-res-icon e-filtersetdiv' });\n                        var iconSpan = gObj.createElement('span', { className: 'e-icons e-res-icon e-filterset' });\n                        iconSpan.setAttribute('colType', cols[parseInt(i.toString(), 10)].type);\n                        divIcon.appendChild(iconSpan);\n                        cDiv.appendChild(divIcon);\n                    }\n                }\n            }\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.customColumnDiv, _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice ? 'touchend' : 'click', this.customFilterColumnClickHandler, this);\n            return this.customColumnDiv;\n        }\n    };\n    ResponsiveDialogRenderer.prototype.getSortedFieldsAndDirections = function (name) {\n        var fields = [];\n        for (var i = 0; i < this.parent.sortSettings.columns.length; i++) {\n            fields.push(this.parent.sortSettings.columns[parseInt(i.toString(), 10)][\"\" + name]);\n        }\n        return fields;\n    };\n    ResponsiveDialogRenderer.prototype.sortButtonClickHandler = function (target) {\n        if (target) {\n            var columndiv = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsivecoldiv');\n            var field = columndiv.getAttribute('data-e-mappingname');\n            if (!this.parent.allowMultiSorting) {\n                this.sortPredicate = [];\n                this.sortedCols = [];\n                this.isSortApplied = false;\n                this.resetSortButtons(target);\n            }\n            var txt = target.textContent;\n            var directionTxt = txt === this.parent.localeObj.getConstant('NoneText') ? this.parent.localeObj.getConstant('AscendingText')\n                : txt === this.parent.localeObj.getConstant('AscendingText') ? this.parent.localeObj.getConstant('DescendingText')\n                    : this.parent.localeObj.getConstant('NoneText');\n            var direction = directionTxt === this.parent.localeObj.getConstant('AscendingText') ? 'Ascending'\n                : directionTxt === this.parent.localeObj.getConstant('DescendingText') ? 'Descending' : 'None';\n            target.innerHTML = directionTxt;\n            this.setSortedCols(field, direction);\n        }\n    };\n    ResponsiveDialogRenderer.prototype.resetSortButtons = function (target) {\n        var buttons = [].slice.call(this.customColumnDiv.getElementsByClassName('e-ressortbutton'));\n        for (var i = 0; i < buttons.length; i++) {\n            if (buttons[parseInt(i.toString(), 10)] !== target) {\n                buttons[parseInt(i.toString(), 10)].innerHTML = this.parent.localeObj.getConstant('NoneText');\n            }\n        }\n    };\n    ResponsiveDialogRenderer.prototype.setSortedCols = function (field, direction) {\n        var fields = this.getCurrentSortedFields();\n        var index = fields.indexOf(field);\n        if (this.parent.allowMultiSorting && index > -1) {\n            this.sortedCols.splice(index, 1);\n            this.sortPredicate.splice(index, 1);\n        }\n        this.isSortApplied = true;\n        if (direction !== 'None') {\n            this.sortedCols.push(field);\n            this.sortPredicate.push({ field: field, direction: direction });\n        }\n    };\n    ResponsiveDialogRenderer.prototype.getCurrentSortedFields = function () {\n        var fields = [];\n        for (var i = 0; i < this.sortedCols.length; i++) {\n            fields.push(this.sortedCols[parseInt(i.toString(), 10)]);\n        }\n        return fields;\n    };\n    ResponsiveDialogRenderer.prototype.customFilterColumnClickHandler = function (e) {\n        var gObj = this.parent;\n        var target = e.target;\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'columnmenudiv') && this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColMenu && !(0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-disabled')) {\n            var column = this.menuCol ? this.menuCol : this.filteredCol;\n            if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsiveautofitalldiv')) {\n                gObj.autoFitColumns([]);\n                this.closeCustomFilter();\n            }\n            else if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsiveautofitdiv')) {\n                gObj.autoFitColumns(column.field);\n                this.closeCustomFilter();\n            }\n            else if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsivegroupdiv')) {\n                gObj.groupColumn(column.field);\n                this.closeCustomFilter();\n            }\n            else if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsiveungroupdiv')) {\n                gObj.ungroupColumn(column.field);\n                this.closeCustomFilter();\n            }\n            else if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsiveascendingdiv')) {\n                gObj.sortColumn(column.field, 'Ascending');\n                this.closeCustomFilter();\n            }\n            else if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsivedescendingdiv')) {\n                gObj.sortColumn(column.field, 'Descending');\n                this.closeCustomFilter();\n            }\n            else if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsivecolumndiv')) {\n                gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.renderResponsiveChangeAction, { action: 5 });\n                gObj.showResponsiveCustomColumnChooser();\n            }\n            else if ((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsivefilterdiv')) {\n                gObj.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.renderResponsiveChangeAction, { action: 3 });\n                this.isRowResponsive = true;\n                this.isCustomDialog = false;\n                if (gObj.filterModule) {\n                    gObj.filterModule.responsiveDialogRenderer.showResponsiveDialog(column);\n                }\n            }\n            e.preventDefault();\n        }\n        if (this.action !== _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter) {\n            return;\n        }\n        if (gObj.filterSettings.type !== 'FilterBar') {\n            if (target.classList.contains('e-responsivecoldiv') || target.parentElement.classList.contains('e-responsivecoldiv')) {\n                var field = target.getAttribute('data-e-mappingname');\n                if (!field) {\n                    field = target.parentElement.getAttribute('data-e-mappingname');\n                }\n                if (field) {\n                    var col = gObj.getColumnByField(field);\n                    this.isRowResponsive = true;\n                    this.showResponsiveDialog(col);\n                }\n            }\n            else if (target.classList.contains('e-filterset') || target.parentElement.classList.contains('e-filtersetdiv')) {\n                var colDiv = (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(target, 'e-responsivecoldiv');\n                if (colDiv) {\n                    var field = colDiv.getAttribute('data-e-mappingname');\n                    var col = gObj.getColumnByField(field);\n                    if (col.filter.type === 'Menu' || (!col.filter.type && gObj.filterSettings.type === 'Menu')) {\n                        this.isDialogClose = true;\n                    }\n                    this.parent.filterModule.filterModule.clearCustomFilter(col);\n                    this.removeCustomDlgFilterEle(target);\n                }\n            }\n        }\n    };\n    /**\n     * Function to show the responsive dialog\n     *\n     * @param {Column} col - specifies the filter column\n     * @param {Column} column - specifies the menu column\n     * @returns {void}\n     */\n    ResponsiveDialogRenderer.prototype.showResponsiveDialog = function (col, column) {\n        if ((this.isCustomDialog && this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter && !this.isRowResponsive) ||\n            (column && this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColMenu)) {\n            this.menuCol = column;\n            this.renderCustomFilterDialog(null, column);\n        }\n        else {\n            this.filteredCol = col;\n            this.renderResponsiveDialog(col);\n            if (this.parent.enableAdaptiveUI && col) {\n                this.parent.filterModule.setFilterModel(col);\n                this.parent.filterModule.filterModule.openDialog(this.parent.filterModule.createOptions(col, undefined));\n            }\n            if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColumnChooser) {\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.renderResponsiveColumnChooserDiv, { action: 'open' });\n            }\n            if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isSort) {\n                var args = {\n                    cancel: false, dialogObj: this.customResponsiveDlg, requestType: 'beforeOpenAptiveSortDialog'\n                };\n                this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.beforeOpenAdaptiveDialog, args);\n                if (args.cancel) {\n                    return;\n                }\n            }\n            this.customResponsiveDlg.show(true);\n            this.customResponsiveDlg.element.style.maxHeight = '100%';\n            this.setTopToChildDialog(this.customResponsiveDlg.element);\n            if (this.parent.enableAdaptiveUI && this.parent.filterSettings && (this.parent.filterSettings.type === 'CheckBox'\n                || this.parent.filterSettings.type === 'Excel') && this.parent.filterSettings.enableInfiniteScrolling\n                && this.parent.filterSettings.loadingIndicator === 'Shimmer') {\n                var filterBase = this.parent.filterSettings.type === 'CheckBox' ? this.parent.filterModule.filterModule.checkBoxBase : this.parent.filterModule.filterModule.excelFilterBase;\n                filterBase.showMask();\n            }\n        }\n    };\n    ResponsiveDialogRenderer.prototype.setTopToChildDialog = function (dialogEle) {\n        var child = dialogEle.querySelector('.e-dialog');\n        if (child) {\n            var top_1 = dialogEle.querySelector('.e-dlg-header-content').getBoundingClientRect().height;\n            child.style.top = top_1 + 'px';\n        }\n    };\n    ResponsiveDialogRenderer.prototype.renderCustomFilterDialog = function (col, column) {\n        var gObj = this.parent;\n        var isColMenu = this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColMenu;\n        if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter && gObj.filterSettings.type === 'FilterBar') {\n            return;\n        }\n        var colMenu = isColMenu ? 'e-customcolumnmenudiv ' : '';\n        var outerDiv = this.parent.createElement('div', {\n            id: gObj.element.id + (isColMenu ? 'customcolumnmenu' : 'customfilter'),\n            className: this.parent.cssClass ? colMenu +\n                'e-customfilterdiv e-responsive-dialog ' + this.parent.cssClass : colMenu + 'e-customfilterdiv e-responsive-dialog'\n        });\n        this.parent.element.appendChild(outerDiv);\n        this.customFilterDlg = this.getDialogOptions(col, true, null, column);\n        var args = {\n            cancel: false, dialogObj: this.customFilterDlg, requestType: 'beforeOpenAptiveFilterDialog'\n        };\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_1__.beforeOpenAdaptiveDialog, args);\n        if (args.cancel) {\n            return;\n        }\n        this.customFilterDlg.appendTo(outerDiv);\n        this.customFilterDlg.show(true);\n        this.customFilterDlg.element.style.maxHeight = '100%';\n    };\n    ResponsiveDialogRenderer.prototype.getDialogOptions = function (col, isCustomFilter, id, column) {\n        var options = new _syncfusion_ej2_popups__WEBPACK_IMPORTED_MODULE_5__.Dialog({\n            isModal: true,\n            showCloseIcon: (id === 'columnchooser' && this.parent.columnChooserSettings.headerTemplate &&\n                !this.parent.enableColumnVirtualization) ? false : true,\n            closeOnEscape: false,\n            locale: this.parent.locale,\n            target: this.parent.adaptiveDlgTarget ? this.parent.adaptiveDlgTarget : document.body,\n            visible: false,\n            enableRtl: this.parent.enableRtl,\n            content: this.renderResponsiveContent(col, column),\n            open: this.dialogOpen.bind(this),\n            created: this.dialogCreated.bind(this),\n            close: this.beforeDialogClose.bind(this),\n            width: '100%',\n            height: '100%',\n            animationSettings: { effect: 'None' },\n            cssClass: this.parent.cssClass ? this.parent.cssClass : ''\n        });\n        var isStringTemplate = 'isStringTemplate';\n        options[\"\" + isStringTemplate] = true;\n        if (isCustomFilter) {\n            options.header = this.renderResponsiveHeader(col, undefined, true);\n            var colMenu = this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColMenu ? 'e-customcolumnmenu ' : '';\n            options.cssClass = colMenu + 'e-customfilter';\n        }\n        else {\n            options.header = this.renderResponsiveHeader(col);\n            options.cssClass = this.parent.rowRenderingMode === 'Vertical' && this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter\n                ? 'e-res' + id + ' e-row-responsive-filter' : 'e-res' + id;\n        }\n        return options;\n    };\n    ResponsiveDialogRenderer.prototype.renderResponsiveDialog = function (col) {\n        var gObj = this.parent;\n        if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter && gObj.filterSettings.type === 'FilterBar') {\n            return;\n        }\n        var id = this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter ? 'filter' : 'sort';\n        id = this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColumnChooser ? 'columnchooser' : id;\n        var outerDiv = this.parent.createElement('div', {\n            id: gObj.element.id + 'responsive' + id,\n            className: this.parent.cssClass ?\n                'e-res' + id + 'div e-responsive-dialog ' + this.parent.cssClass : 'e-res' + id + 'div e-responsive-dialog'\n        });\n        this.parent.element.appendChild(outerDiv);\n        this.customResponsiveDlg = this.getDialogOptions(col, false, id);\n        this.customResponsiveDlg.appendTo(outerDiv);\n    };\n    ResponsiveDialogRenderer.prototype.dialogCreated = function () {\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addBiggerDialog)(this.parent);\n    };\n    ResponsiveDialogRenderer.prototype.dialogOpen = function () {\n        if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isSort && this.parent.allowMultiSorting) {\n            for (var i = 0; i < this.parent.sortSettings.columns.length; i++) {\n                this.sortedCols.push(this.parent.sortSettings.columns[parseInt(i.toString(), 10)].field);\n                var sortField = this.parent.sortSettings.columns[parseInt(i.toString(), 10)].field;\n                var sortDirection = this.parent.sortSettings.columns[parseInt(i.toString(), 10)].direction;\n                this.sortPredicate.push({ field: sortField, direction: sortDirection });\n            }\n        }\n    };\n    ResponsiveDialogRenderer.prototype.beforeDialogClose = function (args) {\n        this.isDialogClose = args.element && !args.element.querySelector('.e-xl-customfilterdiv')\n            && args.element.classList.contains('e-resfilterdiv');\n        if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter) {\n            if (args.element.classList.contains('e-resfilterdiv')) {\n                this.parent.filterModule.filterModule.closeResponsiveDialog(this.isCustomDlgRender);\n            }\n            else if (args.element.classList.contains('e-customfilterdiv')) {\n                this.closeCustomFilter();\n            }\n            if (this.parent.rowRenderingMode === 'Horizontal' && this.parent.showColumnMenu) {\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.renderResponsiveChangeAction, { action: 4 });\n                var custom = document.querySelector('.e-resfilter');\n                if (custom) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(custom);\n                }\n            }\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isSort) {\n            this.closeCustomDialog();\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColMenu) {\n            this.closeCustomFilter();\n            var custom = document.querySelector('.e-rescolummenu');\n            if (custom) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(custom);\n            }\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColumnChooser) {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.renderResponsiveColumnChooserDiv, { action: 'clear' });\n            var custom = document.querySelector('.e-rescolumnchooser');\n            if (custom) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(custom);\n            }\n            if (this.parent.rowRenderingMode === 'Horizontal' && this.parent.showColumnMenu) {\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.renderResponsiveChangeAction, { action: 4 });\n            }\n            this.isCustomDialog = false;\n            this.isDialogClose = false;\n        }\n        this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.enterKeyHandler, this.keyHandler);\n    };\n    ResponsiveDialogRenderer.prototype.sortColumn = function () {\n        if (!this.isSortApplied) {\n            this.closeCustomDialog();\n            return;\n        }\n        if (this.sortPredicate.length) {\n            this.parent.setProperties({ sortSettings: { columns: [] } }, true);\n        }\n        for (var i = 0; i < this.sortPredicate.length; i++) {\n            this.parent.sortColumn(this.sortPredicate[parseInt(i.toString(), 10)].field, this.sortPredicate[parseInt(i.toString(), 10)].direction, this.parent.allowMultiSorting);\n        }\n        if (!this.sortPredicate.length) {\n            this.parent.clearSorting();\n        }\n        this.closeCustomDialog();\n    };\n    ResponsiveDialogRenderer.prototype.getHeaderTitle = function (args, col) {\n        var gObj = this.parent;\n        var title;\n        if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isEdit) {\n            title = gObj.localeObj.getConstant('EditFormTitle') + args.primaryKeyValue[0];\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isAdd) {\n            title = gObj.localeObj.getConstant('AddFormTitle');\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter) {\n            title = col ? col.headerText || col.field : gObj.localeObj.getConstant('FilterTitle');\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isSort) {\n            title = gObj.localeObj.getConstant('Sort');\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColMenu) {\n            title = gObj.localeObj.getConstant('ColumnMenu');\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColumnChooser) {\n            title = gObj.localeObj.getConstant('ChooseColumns');\n        }\n        return title;\n    };\n    ResponsiveDialogRenderer.prototype.getDialogName = function (action) {\n        var name;\n        if (action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isAdd || action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isEdit) {\n            name = 'dialogEdit_wrapper_title';\n        }\n        else if (action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter) {\n            name = 'responsive_filter_dialog_wrapper';\n        }\n        else if (action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColumnChooser) {\n            name = 'responsive_column_chooser_dialog_wrapper';\n        }\n        return name;\n    };\n    ResponsiveDialogRenderer.prototype.getButtonText = function (action) {\n        var text;\n        if (action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isAdd || action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isEdit) {\n            text = 'Save';\n        }\n        else if (action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter || this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isSort ||\n            action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColumnChooser || this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColumnChooser) {\n            text = 'OKButton';\n        }\n        return text;\n    };\n    /**\n     * Function to render the responsive header\n     *\n     * @param {Column} col - specifies the column\n     * @param {ResponsiveDialogArgs} args - specifies the responsive dialog arguments\n     * @param {boolean} isCustomFilter - specifies whether it is custom filter or not\n     * @returns {HTMLElement | string} returns the html element or string\n     */\n    ResponsiveDialogRenderer.prototype.renderResponsiveHeader = function (col, args, isCustomFilter) {\n        var _this = this;\n        var gObj = this.parent;\n        gObj.on(_base_constant__WEBPACK_IMPORTED_MODULE_1__.enterKeyHandler, this.keyHandler, this);\n        var id = gObj.element.id + this.getDialogName(this.action);\n        if (this.parent.columnChooserSettings.headerTemplate && !this.parent.enableColumnVirtualization &&\n            this.getHeaderTitle(args, col) === gObj.localeObj.getConstant('ChooseColumns')) {\n            var headerTempteElement = this.parent.columnChooserModule.renderHeader();\n            return headerTempteElement;\n        }\n        var header = gObj.createElement('div', { className: 'e-res-custom-element' });\n        var titleDiv = gObj.createElement('div', { className: 'e-dlg-custom-header', id: id });\n        titleDiv.innerHTML = this.getHeaderTitle(args, col);\n        header.appendChild(titleDiv);\n        var saveBtn = gObj.createElement('button');\n        if (!isCustomFilter) {\n            this.saveBtn = new _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_4__.Button({\n                cssClass: this.parent.cssClass ?\n                    'e-primary e-flat e-res-apply-btn' + ' ' + this.parent.cssClass : 'e-primary e-flat e-res-apply-btn'\n            });\n            saveBtn.innerHTML = gObj.localeObj.getConstant(this.getButtonText(this.action));\n            this.saveBtn.appendTo(saveBtn);\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            saveBtn.onclick = function (e) {\n                _this.dialogHdrBtnClickHandler();\n            };\n        }\n        var isSort = this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isSort;\n        var isFilter = this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter;\n        if (isFilter || isSort) {\n            var id_1 = isSort ? 'sort' : 'filter';\n            var clearBtn = gObj.createElement('button');\n            this.filterClearBtn = new _syncfusion_ej2_buttons__WEBPACK_IMPORTED_MODULE_4__.Button({\n                cssClass: this.parent.cssClass ? 'e-primary e-flat e-res-' + id_1 + '-clear-btn' + ' ' + this.parent.cssClass\n                    : 'e-primary e-flat e-res-' + id_1 + '-clear-btn'\n            });\n            if (isFilter) {\n                var span = gObj.createElement('span', { className: 'e-btn-icon e-icon-filter-clear e-icons' });\n                clearBtn.appendChild(span);\n            }\n            else {\n                clearBtn.innerHTML = gObj.localeObj.getConstant('Clear');\n            }\n            header.appendChild(clearBtn);\n            this.filterClearBtn.appendTo(clearBtn);\n            clearBtn.onclick = function (e) {\n                if (((0,_base_util__WEBPACK_IMPORTED_MODULE_2__.parentsUntil)(e.target, 'e-customfilter'))) {\n                    _this.parent.filterModule.clearFiltering();\n                    _this.removeCustomDlgFilterEle();\n                }\n                else {\n                    if (isFilter) {\n                        _this.filterClear();\n                    }\n                    else {\n                        _this.resetSortButtons();\n                        _this.sortedCols = [];\n                        _this.sortPredicate = [];\n                        _this.isSortApplied = true;\n                    }\n                }\n            };\n            header.appendChild(clearBtn);\n        }\n        if (!isCustomFilter) {\n            header.appendChild(saveBtn);\n        }\n        return header;\n    };\n    ResponsiveDialogRenderer.prototype.filterClear = function () {\n        this.parent.filterModule.filterModule.clearCustomFilter(this.filteredCol);\n        this.parent.filterModule.filterModule.closeResponsiveDialog();\n    };\n    ResponsiveDialogRenderer.prototype.removeCustomFilterElement = function () {\n        var elem = document.getElementById(this.parent.element.id + 'customcolumnmenu');\n        if (elem) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(elem);\n            var custom = document.querySelector('.e-customfilter');\n            if (custom) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(custom);\n            }\n        }\n        var custommenu = document.querySelector('.e-rescolumnchooser');\n        if (custommenu) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(custommenu);\n        }\n    };\n    /**\n     * Function to close the Responsive Column Chooser dialog.\n     * @returns {void}\n     * @hidden\n     */\n    ResponsiveDialogRenderer.prototype.hideResponsiveColumnChooser = function () {\n        var columnChooserElement = document.querySelector('.e-rescolumnchooser');\n        if (columnChooserElement) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(columnChooserElement);\n            this.isCustomDialog = false;\n            this.isDialogClose = false;\n        }\n    };\n    ResponsiveDialogRenderer.prototype.dialogHdrBtnClickHandler = function () {\n        if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isEdit || this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isAdd) {\n            this.parent.endEdit();\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter) {\n            this.parent.filterModule.filterModule.applyCustomFilter({ col: this.filteredCol, isCustomFilter: this.isCustomDlgRender });\n            this.removeCustomFilterElement();\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isSort) {\n            this.sortColumn();\n            this.removeCustomFilterElement();\n        }\n        else if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isColumnChooser) {\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.renderResponsiveColumnChooserDiv, { action: 'confirm' });\n            this.removeCustomFilterElement();\n            this.isCustomDialog = false;\n            this.isDialogClose = false;\n        }\n    };\n    ResponsiveDialogRenderer.prototype.closeCustomDialog = function () {\n        if (this.isCustomDlgRender) {\n            var mainfilterdiv = this.customResponsiveDlg.element.querySelector('.e-mainfilterdiv');\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(mainfilterdiv);\n            return;\n        }\n        this.isRowResponsive = false;\n        this.isCustomDlgRender = false;\n        this.destroyCustomFilterDialog();\n    };\n    ResponsiveDialogRenderer.prototype.destroyCustomFilterDialog = function () {\n        if (!this.customResponsiveDlg) {\n            return;\n        }\n        var elem = document.getElementById(this.customResponsiveDlg.element.id);\n        if (this.customResponsiveDlg && !this.customResponsiveDlg.isDestroyed && elem) {\n            this.customResponsiveDlg.destroy();\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(elem);\n        }\n        this.closeCustomFilter();\n        if (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isSort) {\n            this.sortPredicate = [];\n            this.sortedCols = [];\n            this.isSortApplied = false;\n        }\n    };\n    ResponsiveDialogRenderer.prototype.closeCustomFilter = function () {\n        if (!this.isDialogClose && this.customFilterDlg) {\n            var customEle = document.getElementById(this.customFilterDlg.element.id);\n            if (this.customFilterDlg && !this.customFilterDlg.isDestroyed && customEle) {\n                this.customFilterDlg.destroy();\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(customEle);\n            }\n        }\n        this.isCustomDialog = false;\n        this.isDialogClose = false;\n    };\n    ResponsiveDialogRenderer.prototype.removeCustomDlgFilterEle = function (target) {\n        if (target) {\n            if (target.parentElement.classList.contains('e-filtersetdiv')) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(target.parentElement);\n            }\n            else {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(target);\n            }\n        }\n        else {\n            var child = this.customColumnDiv.children;\n            for (var i = 0; i < child.length; i++) {\n                target = child[parseInt(i.toString(), 10)].querySelector('.e-filtersetdiv');\n                if (target) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.remove)(target);\n                    i--;\n                }\n            }\n        }\n    };\n    ResponsiveDialogRenderer.prototype.keyHandler = function (e) {\n        if (e.keyCode === 13 && ((this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isFilter\n            && e.target.classList.contains('e-searchinput'))\n            || (this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isEdit || this.action === _base_enum__WEBPACK_IMPORTED_MODULE_3__.ResponsiveDialogAction.isAdd))) {\n            this.dialogHdrBtnClickHandler();\n        }\n    };\n    ResponsiveDialogRenderer.prototype.editComplate = function (args) {\n        if (args.requestType === 'save' || args.requestType === 'cancel') {\n            this.parent.off(_base_constant__WEBPACK_IMPORTED_MODULE_1__.enterKeyHandler, this.keyHandler);\n        }\n    };\n    ResponsiveDialogRenderer.prototype.removeEventListener = function () {\n        if (this.customColumnDiv) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.customColumnDiv, _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice ? 'touchend' : 'click', this.customFilterColumnClickHandler);\n        }\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_2__.addRemoveEventListener)(this.parent, this.evtHandlers, true, this);\n        this.parent.removeEventListener(_base_constant__WEBPACK_IMPORTED_MODULE_1__.actionComplete, this.onActionCompleteFn);\n    };\n    return ResponsiveDialogRenderer;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9yZXNwb25zaXZlLWRpYWxvZy1yZW5kZXJlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQWdEO0FBQ3dDO0FBQ0g7QUFDMUM7QUFDTTtBQUNLO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixPQUFPLDZEQUF3QixtQ0FBbUM7QUFDaEcsY0FBYyxPQUFPLG9FQUErQiwwQ0FBMEM7QUFDOUYsY0FBYyxPQUFPLGlFQUE0Qiw2Q0FBNkM7QUFDOUYsY0FBYyxPQUFPLDZEQUF3Qix1Q0FBdUM7QUFDcEYsY0FBYyxPQUFPLDZEQUF3QixxQ0FBcUM7QUFDbEYsY0FBYyxPQUFPLHVFQUFrQyw2Q0FBNkM7QUFDcEcsUUFBUSxrRUFBc0I7QUFDOUI7QUFDQSxxQ0FBcUMsMERBQXFCO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsaUJBQWlCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEVBQTBFLG9EQUFvRDtBQUM5SDtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOERBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCxpREFBaUQ7QUFDaEg7QUFDQSxtQ0FBbUMsMkRBQU07QUFDekM7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw0REFBTTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELFFBQVEsOERBQXNCLFdBQVc7QUFDaEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELDRHQUE0RztBQUNsSyx1REFBdUQscUVBQXFFO0FBQzVILHVEQUF1RCxvRUFBb0U7QUFDM0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsOERBQXNCO0FBQ3BFO0FBQ0EsbUVBQW1FO0FBQ25FLG1GQUFtRjtBQUNuRjtBQUNBO0FBQ0E7QUFDQSwrREFBK0Qsc0NBQXNDO0FBQ3JHO0FBQ0EsK0dBQStHLDhEQUFzQjtBQUNySTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0Msd0JBQXdCO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UscUNBQXFDO0FBQ3JHO0FBQ0EsNkNBQTZDLDhEQUFzQjtBQUNuRSwrQ0FBK0MsOERBQXNCO0FBQ3JFO0FBQ0Esb0NBQW9DLHdDQUF3QztBQUM1RTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsaUJBQWlCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELGlDQUFpQztBQUM1RjtBQUNBO0FBQ0EsNERBQTRELHdGQUF3RjtBQUNwSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FLDZFQUE2RTtBQUNqSjtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsMkRBQU07QUFDL0M7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLDhCQUE4Qix1RUFBaUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLGdEQUFnRDtBQUNsSCxvRUFBb0UsNkNBQTZDO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksOERBQVksMkJBQTJCLHlEQUFPO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkNBQTZDO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix3REFBWTtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixvQkFBb0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLG9DQUFvQztBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw0QkFBNEI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdEQUFZLDZDQUE2Qyw4REFBc0IsZUFBZSx3REFBWTtBQUN0SDtBQUNBLGdCQUFnQix3REFBWTtBQUM1QjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsd0RBQVk7QUFDakM7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLHdEQUFZO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix3REFBWTtBQUNqQztBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsd0RBQVk7QUFDakM7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLHdEQUFZO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix3REFBWTtBQUNqQyw0QkFBNEIsd0VBQW1DLElBQUksV0FBVztBQUM5RTtBQUNBO0FBQ0EscUJBQXFCLHdEQUFZO0FBQ2pDLDRCQUE0Qix3RUFBbUMsSUFBSSxXQUFXO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOERBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qix3REFBWTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0Esb0RBQW9ELDhEQUFzQjtBQUMxRSx1Q0FBdUMsOERBQXNCO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLDhEQUFzQjtBQUN0RCxtQ0FBbUMsNEVBQXVDLElBQUksZ0JBQWdCO0FBQzlGO0FBQ0EsZ0NBQWdDLDhEQUFzQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0Msb0VBQStCO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3Qyw4REFBc0I7QUFDOUQsNEJBQTRCLDhEQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLG9FQUErQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBEQUFNO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsZ0JBQWdCO0FBQ2pEO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDhEQUFzQjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhGQUE4Riw4REFBc0I7QUFDcEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDhEQUFzQjtBQUNsRDtBQUNBO0FBQ0EsaUNBQWlDLDhEQUFzQjtBQUN2RCw2QkFBNkIsOERBQXNCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDJEQUFlO0FBQ3ZCO0FBQ0E7QUFDQSw0QkFBNEIsOERBQXNCO0FBQ2xELDRCQUE0Qiw2Q0FBNkM7QUFDekU7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDRDQUE0QztBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOERBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLHdFQUFtQyxJQUFJLFdBQVc7QUFDckY7QUFDQTtBQUNBLG9CQUFvQiw0REFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsOERBQXNCO0FBQ3ZEO0FBQ0E7QUFDQSxpQ0FBaUMsOERBQXNCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw0REFBTTtBQUN0QjtBQUNBO0FBQ0EsaUNBQWlDLDhEQUFzQjtBQUN2RCwrQkFBK0IsNEVBQXVDLElBQUksaUJBQWlCO0FBQzNGO0FBQ0E7QUFDQSxnQkFBZ0IsNERBQU07QUFDdEI7QUFDQTtBQUNBLG1DQUFtQyx3RUFBbUMsSUFBSSxXQUFXO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDJEQUFzQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxnQkFBZ0IsZUFBZTtBQUN2RTtBQUNBLHdCQUF3QiwrQkFBK0I7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOERBQXNCO0FBQ2xEO0FBQ0E7QUFDQSxpQ0FBaUMsOERBQXNCO0FBQ3ZEO0FBQ0E7QUFDQSxpQ0FBaUMsOERBQXNCO0FBQ3ZEO0FBQ0E7QUFDQSxpQ0FBaUMsOERBQXNCO0FBQ3ZEO0FBQ0E7QUFDQSxpQ0FBaUMsOERBQXNCO0FBQ3ZEO0FBQ0E7QUFDQSxpQ0FBaUMsOERBQXNCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qiw4REFBc0IscUJBQXFCLDhEQUFzQjtBQUN4RjtBQUNBO0FBQ0EsNEJBQTRCLDhEQUFzQjtBQUNsRDtBQUNBO0FBQ0EsNEJBQTRCLDhEQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsOERBQXNCLHFCQUFxQiw4REFBc0I7QUFDeEY7QUFDQTtBQUNBLDRCQUE0Qiw4REFBc0IsNkJBQTZCLDhEQUFzQjtBQUNyRyx1QkFBdUIsOERBQXNCLG9DQUFvQyw4REFBc0I7QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxzQkFBc0I7QUFDckMsZUFBZSxTQUFTO0FBQ3hCLGlCQUFpQixzQkFBc0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMkRBQXNCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxtQ0FBbUM7QUFDcEYsbURBQW1ELDBDQUEwQztBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiwyREFBTTtBQUNyQztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDhEQUFzQjtBQUMzRCx1Q0FBdUMsOERBQXNCO0FBQzdEO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQywyREFBTTtBQUM1QztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0Esd0RBQXdELHFEQUFxRDtBQUM3RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLHdEQUFZO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDREQUFNO0FBQ2xCO0FBQ0E7QUFDQSxnQkFBZ0IsNERBQU07QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDREQUFNO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDREQUFNO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOERBQXNCLDJCQUEyQiw4REFBc0I7QUFDbkc7QUFDQTtBQUNBLGlDQUFpQyw4REFBc0I7QUFDdkQsc0VBQXNFLCtEQUErRDtBQUNySTtBQUNBO0FBQ0EsaUNBQWlDLDhEQUFzQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsOERBQXNCO0FBQ3ZELCtCQUErQiw0RUFBdUMsSUFBSSxtQkFBbUI7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksNERBQU07QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDREQUFNO0FBQ2xCO0FBQ0E7QUFDQSw0QkFBNEIsOERBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDREQUFNO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsNERBQU07QUFDdEI7QUFDQTtBQUNBLGdCQUFnQiw0REFBTTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixrQkFBa0I7QUFDOUM7QUFDQTtBQUNBLG9CQUFvQiw0REFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsOERBQXNCO0FBQ3hFO0FBQ0EsZ0NBQWdDLDhEQUFzQiwyQkFBMkIsOERBQXNCO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMkRBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSw4REFBWSw4QkFBOEIseURBQU87QUFDN0Q7QUFDQSxRQUFRLGtFQUFzQjtBQUM5Qix3Q0FBd0MsMERBQXFCO0FBQzdEO0FBQ0E7QUFDQSxDQUFDO0FBQ21DIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvcmVuZGVyZXIvcmVzcG9uc2l2ZS1kaWFsb2ctcmVuZGVyZXIuanM/OTQ4MSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaWFsb2cgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItcG9wdXBzJztcbmltcG9ydCB7IEV2ZW50SGFuZGxlciwgaXNOdWxsT3JVbmRlZmluZWQsIHJlbW92ZSwgQnJvd3NlciB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IHBhcmVudHNVbnRpbCwgYWRkQmlnZ2VyRGlhbG9nLCBhZGRSZW1vdmVFdmVudExpc3RlbmVyIH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbmltcG9ydCAqIGFzIGV2ZW50cyBmcm9tICcuLi9iYXNlL2NvbnN0YW50JztcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1idXR0b25zJztcbmltcG9ydCB7IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24gfSBmcm9tICcuLi9iYXNlL2VudW0nO1xuLyoqXG4gKlxuICogVGhlIGBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXJgIG1vZHVsZSBpcyB1c2VkIHRvIHJlbmRlciB0aGUgcmVzcG9uc2l2ZSBkaWFsb2dzLlxuICovXG52YXIgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlcihwYXJlbnQsIHNlcnZpY2VMb2NhdG9yKSB7XG4gICAgICAgIHRoaXMuc29ydGVkQ29scyA9IFtdO1xuICAgICAgICB0aGlzLnNvcnRQcmVkaWNhdGUgPSBbXTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgdGhpcy5pc0N1c3RvbURpYWxvZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTG9jYXRvciA9IHNlcnZpY2VMb2NhdG9yO1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoKTtcbiAgICB9XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmV2dEhhbmRsZXJzID0gW3sgZXZlbnQ6IGV2ZW50cy5maWx0ZXJEaWFsb2dDbG9zZSwgaGFuZGxlcjogdGhpcy5jbG9zZUN1c3RvbURpYWxvZyB9LFxuICAgICAgICAgICAgeyBldmVudDogZXZlbnRzLnJlZnJlc2hDdXN0b21GaWx0ZXJPa0J0biwgaGFuZGxlcjogdGhpcy5yZWZyZXNoQ3VzdG9tRmlsdGVyT2tCdG4gfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50cy5yZW5kZXJSZXNwb25zaXZlQ21lbnUsIGhhbmRsZXI6IHRoaXMucmVuZGVyUmVzcG9uc2l2ZUNvbnRleHRNZW51IH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudHMuZmlsdGVyQ21lbnVTZWxlY3QsIGhhbmRsZXI6IHRoaXMucmVuZGVyQ3VzdG9tRmlsdGVyRGl2IH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudHMuY3VzdG9tRmlsdGVyQ2xvc2UsIGhhbmRsZXI6IHRoaXMuY3VzdG9tRXhGaWx0ZXJDbG9zZSB9LFxuICAgICAgICAgICAgeyBldmVudDogZXZlbnRzLnJlZnJlc2hDdXN0b21GaWx0ZXJDbGVhckJ0biwgaGFuZGxlcjogdGhpcy5yZWZyZXNoQ3VzdG9tRmlsdGVyQ2xlYXJCdG4gfV07XG4gICAgICAgIGFkZFJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5wYXJlbnQsIHRoaXMuZXZ0SGFuZGxlcnMsIHRydWUsIHRoaXMpO1xuICAgICAgICB0aGlzLm9uQWN0aW9uQ29tcGxldGVGbiA9IHRoaXMuZWRpdENvbXBsYXRlLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMucGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRzLmFjdGlvbkNvbXBsZXRlLCB0aGlzLm9uQWN0aW9uQ29tcGxldGVGbik7XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLmN1c3RvbUV4RmlsdGVyQ2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNDdXN0b21EbGdSZW5kZXIgPSBmYWxzZTtcbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyQ3VzdG9tRmlsdGVyRGl2ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaGVhZGVyID0gdGhpcy5jdXN0b21SZXNwb25zaXZlRGxnLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZGxnLWhlYWRlci1jb250ZW50Jyk7XG4gICAgICAgIHZhciB0aXRsZSA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZS1kbGctY3VzdG9tLWhlYWRlcicpO1xuICAgICAgICB2YXIgY2xvc2VCdG4gPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmUtZGxnLWNsb3NlaWNvbi1idG4nKTtcbiAgICAgICAgdGhpcy5pc0N1c3RvbURsZ1JlbmRlciA9IHRydWU7XG4gICAgICAgIHRoaXMucGFyZW50LmZpbHRlck1vZHVsZS5maWx0ZXJNb2R1bGUuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgdGhpcy5zYXZlQnRuLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICB0aGlzLnJlZnJlc2hDdXN0b21GaWx0ZXJPa0J0bih7IGRpc2FibGVkOiBmYWxzZSB9KTtcbiAgICAgICAgdGhpcy5iYWNrQnRuLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgY2xvc2VCdG4uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICB0aXRsZS5pbm5lckhUTUwgPSB0aGlzLnBhcmVudC5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ0N1c3RvbUZpbHRlcicpO1xuICAgICAgICB2YXIgY29udGVudCA9IHRoaXMuY3VzdG9tUmVzcG9uc2l2ZURsZy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWRsZy1jb250ZW50Jyk7XG4gICAgICAgIHRoaXMuY3VzdG9tRXhjZWxGaWx0ZXJQYXJlbnQgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UteGwtY3VzdG9tZmlsdGVyZGl2IGUtZGVmYXVsdC1maWx0ZXInIH0pO1xuICAgICAgICBjb250ZW50LmFwcGVuZENoaWxkKHRoaXMuY3VzdG9tRXhjZWxGaWx0ZXJQYXJlbnQpO1xuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXJSZXNwb25zaXZlQ29udGV4dE1lbnUgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICBpZiAodGhpcy5hY3Rpb24gPT09IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24uaXNGaWx0ZXIpIHtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5jdXN0b21SZXNwb25zaXZlRGxnLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZGxnLWNvbnRlbnQnKTtcbiAgICAgICAgICAgIHZhciBoZWFkZXIgPSB0aGlzLmN1c3RvbVJlc3BvbnNpdmVEbGcuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1kbGctaGVhZGVyLWNvbnRlbnQnKTtcbiAgICAgICAgICAgIHZhciBjbG9zZUJ0biA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZS1kbGctY2xvc2VpY29uLWJ0bicpO1xuICAgICAgICAgICAgdmFyIHRleHQgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmUtZGxnLWN1c3RvbS1oZWFkZXInKTtcbiAgICAgICAgICAgIGlmIChhcmdzLmlzT3Blbikge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQuZmlyc3RDaGlsZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQoYXJncy50YXJnZXQpO1xuICAgICAgICAgICAgICAgIGNsb3NlQnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlQnRuLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlckNsZWFyQnRuLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB0ZXh0LmlubmVySFRNTCA9IGFyZ3MuaGVhZGVyO1xuICAgICAgICAgICAgICAgIHZhciBiYWNrQnRuID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgICAgICAgdmFyIHNwYW4gPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICdlLWJ0bi1pY29uIGUtcmVzZmlsdGVyYmFjayBlLWljb25zJyB9KTtcbiAgICAgICAgICAgICAgICBiYWNrQnRuLmFwcGVuZENoaWxkKHNwYW4pO1xuICAgICAgICAgICAgICAgIHRoaXMuYmFja0J0biA9IG5ldyBCdXR0b24oe1xuICAgICAgICAgICAgICAgICAgICBjc3NDbGFzczogdGhpcy5wYXJlbnQuY3NzQ2xhc3MgPyAnZS1yZXMtYmFjay1idG4nICsgJyAnICsgdGhpcy5wYXJlbnQuY3NzQ2xhc3MgOiAnZS1yZXMtYmFjay1idG4nXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5iYWNrQnRuLmFwcGVuZFRvKGJhY2tCdG4pO1xuICAgICAgICAgICAgICAgIHRleHQucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUoYmFja0J0biwgdGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmJhY2tCdG4gJiYgIXRoaXMuaXNDdXN0b21EbGdSZW5kZXIpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50LmZpcnN0Q2hpbGQuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgICAgIHJlbW92ZSh0aGlzLmJhY2tCdG4uZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgY2xvc2VCdG4uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUJ0bi5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0ZpbHRlcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVyQ2xlYXJCdG4uZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRleHQuaW5uZXJIVE1MID0gdGhpcy5nZXRIZWFkZXJUaXRsZSh7IGFjdGlvbjogUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0ZpbHRlciB9LCBhcmdzLmNvbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUucmVmcmVzaEN1c3RvbUZpbHRlckNsZWFyQnRuID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyQ2xlYXJCdG4pIHtcbiAgICAgICAgICAgIHRoaXMuaXNGaWx0ZXJlZCA9IGFyZ3MuaXNGaWx0ZXJlZDtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyQ2xlYXJCdG4uZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gYXJncy5pc0ZpbHRlcmVkID8gJycgOiAnbm9uZSc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUucmVmcmVzaEN1c3RvbUZpbHRlck9rQnRuID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgaWYgKHRoaXMuc2F2ZUJ0bikge1xuICAgICAgICAgICAgdGhpcy5zYXZlQnRuLmRpc2FibGVkID0gYXJncy5kaXNhYmxlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuY29sdW1uQ2hvb3Nlck1vZHVsZSAmJiB0aGlzLnBhcmVudC5jb2x1bW5DaG9vc2VyTW9kdWxlLnJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5zYXZlQnRuKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5jb2x1bW5DaG9vc2VyTW9kdWxlLnJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5zYXZlQnRuLmRpc2FibGVkID0gYXJncy5kaXNhYmxlZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5jb2x1bW5NZW51UmVzcG9uc2l2ZUNvbnRlbnQgPSBmdW5jdGlvbiAoc3RyLCBsb2NhbGUsIGRpc2FibGVkKSB7XG4gICAgICAgIHZhciBjRGl2ID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLXJlc3BvbnNpdmVjb2xkaXYgZS1yZXNwb25zaXZlJyArIHN0ci50b0xvd2VyQ2FzZSgpICsgJ2RpdicgKyAoZGlzYWJsZWQgPyAnIGUtZGlzYWJsZWQnIDogJycpIH0pO1xuICAgICAgICB2YXIgc3BhbiA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2UtaWNvbnMgZS1yZXMnICsgc3RyLnRvTG93ZXJDYXNlKCkgKyAnLWljb24gZS1idG4taWNvbicgfSk7XG4gICAgICAgIHZhciBpY29uID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgaW5uZXJIVE1MOiBsb2NhbGUsIGNsYXNzTmFtZTogJ2UtcmVzY29sdW1uLW1lbnUgZS1yZXMtaGVhZGVyLXRleHQnIH0pO1xuICAgICAgICBjRGl2LmFwcGVuZENoaWxkKHNwYW4pO1xuICAgICAgICBjRGl2LmFwcGVuZENoaWxkKGljb24pO1xuICAgICAgICB0aGlzLmN1c3RvbUNvbHVtbkRpdi5hcHBlbmRDaGlsZChjRGl2KTtcbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyUmVzcG9uc2l2ZUNvbnRlbnQgPSBmdW5jdGlvbiAoY29sLCBjb2x1bW4pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIGlzQ29sdW1uQ2hvb3NlciA9IHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQ29sdW1uQ2hvb3NlcjtcbiAgICAgICAgaWYgKGNvbCB8fCBpc0NvbHVtbkNob29zZXIpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyUGFyZW50ID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6IChpc0NvbHVtbkNob29zZXIgPyAnZS1tYWluY29sdW1uY2hvb3NlcmRpdiAnIDogJycpICsgJ2UtbWFpbmZpbHRlcmRpdiBlLWRlZmF1bHQtZmlsdGVyJyxcbiAgICAgICAgICAgICAgICBpZDogKGlzQ29sdW1uQ2hvb3NlciA/ICdjb2x1bWNob29zZXInIDogY29sLnVpZCkgKyAnLW1haW4tZmlsdGVyJyB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbHRlclBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY3VzdG9tQ29sdW1uRGl2ID0gZ09iai5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2NvbHVtbmRpdiBjb2x1bW5tZW51ZGl2JyB9KTtcbiAgICAgICAgICAgIHRoaXMuY3VzdG9tQ29sdW1uRGl2LnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnNob3dDb2x1bW5NZW51ICYmIHRoaXMucGFyZW50LnJvd1JlbmRlcmluZ01vZGUgPT09ICdIb3Jpem9udGFsJyAmJiB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbE1lbnUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbk1lbnVSZXNwb25zaXZlQ29udGVudCgnQXV0b0ZpdEFsbCcsIGdPYmoubG9jYWxlT2JqLmdldENvbnN0YW50KCdBdXRvRml0QWxsJykpO1xuICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uTWVudVJlc3BvbnNpdmVDb250ZW50KCdBdXRvRml0JywgZ09iai5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ0F1dG9GaXQnKSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5hbGxvd0dyb3VwaW5nICYmIGdPYmouYWxsb3dHcm91cGluZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbk1lbnVSZXNwb25zaXZlQ29udGVudCgnR3JvdXAnLCBnT2JqLmxvY2FsZU9iai5nZXRDb25zdGFudCgnR3JvdXAnKSwgZ09iai5ncm91cFNldHRpbmdzLmNvbHVtbnMuaW5kZXhPZihjb2x1bW4uZmllbGQpID49IDApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbk1lbnVSZXNwb25zaXZlQ29udGVudCgnVW5Hcm91cCcsIGdPYmoubG9jYWxlT2JqLmdldENvbnN0YW50KCdVbmdyb3VwJyksIGdPYmouZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmluZGV4T2YoY29sdW1uLmZpZWxkKSA8IDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uLmFsbG93U29ydGluZyAmJiBnT2JqLmFsbG93U29ydGluZykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGlyZWN0aW9uID0gJ05vbmUnO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc29ydENvbHVtbnMgPSB0aGlzLnBhcmVudC5zb3J0U2V0dGluZ3MuY29sdW1ucztcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzb3J0Q29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvcnRDb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maWVsZCA9PT0gY29sdW1uLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID0gc29ydENvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmRpcmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbk1lbnVSZXNwb25zaXZlQ29udGVudCgnYXNjZW5kaW5nJywgZ09iai5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ1NvcnRBc2NlbmRpbmcnKSwgZGlyZWN0aW9uID09PSAnQXNjZW5kaW5nJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uTWVudVJlc3BvbnNpdmVDb250ZW50KCdkZXNjZW5kaW5nJywgZ09iai5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ1NvcnREZXNjZW5kaW5nJyksIGRpcmVjdGlvbiA9PT0gJ0Rlc2NlbmRpbmcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdPYmouc2hvd0NvbHVtbkNob29zZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2x1bW5NZW51UmVzcG9uc2l2ZUNvbnRlbnQoJ0NvbHVtbicsIGdPYmoubG9jYWxlT2JqLmdldENvbnN0YW50KCdDb2x1bW5jaG9vc2VyJykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uLmFsbG93RmlsdGVyaW5nICYmIGdPYmouYWxsb3dGaWx0ZXJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2x1bW5NZW51UmVzcG9uc2l2ZUNvbnRlbnQoJ0ZpbHRlcicsIGdPYmoubG9jYWxlT2JqLmdldENvbnN0YW50KCdGaWx0ZXJNZW51JykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBjb2xzID0gZ09iai5nZXRDb2x1bW5zKCk7XG4gICAgICAgICAgICAgICAgdmFyIHNvcnRCdG5QYXJlbnQgPSBnT2JqLmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnZS1yZXNzb3J0YnV0dG9uLXBhcmVudCcgfSk7XG4gICAgICAgICAgICAgICAgdmFyIGZpbHRlcmVkQ29scyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBpc1NvcnQgPSB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc1NvcnQ7XG4gICAgICAgICAgICAgICAgdmFyIGlzRmlsdGVyID0gdGhpcy5hY3Rpb24gPT09IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24uaXNGaWx0ZXI7XG4gICAgICAgICAgICAgICAgaWYgKGlzRmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ09iai5maWx0ZXJTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZENvbHMucHVzaChnT2JqLmZpbHRlclNldHRpbmdzLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlIHx8ICghY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uYWxsb3dTb3J0aW5nICYmIGlzU29ydClcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8ICghY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uYWxsb3dGaWx0ZXJpbmcgJiYgaXNGaWx0ZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgY0RpdiA9IGdPYmouY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLXJlc3BvbnNpdmVjb2xkaXYnIH0pO1xuICAgICAgICAgICAgICAgICAgICBjRGl2LnNldEF0dHJpYnV0ZSgnZGF0YS1lLW1hcHBpbmduYW1lJywgY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICBjRGl2LnNldEF0dHJpYnV0ZSgnZGF0YS1lLW1hcHBpbmd1aWQnLCBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS51aWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3BhbiA9IGdPYmouY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgaW5uZXJIVE1MOiBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5oZWFkZXJUZXh0LCBjbGFzc05hbWU6ICdlLXJlcy1oZWFkZXItdGV4dCcgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNEaXYuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tQ29sdW1uRGl2LmFwcGVuZENoaWxkKGNEaXYpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTb3J0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGRzID0gdGhpcy5nZXRTb3J0ZWRGaWVsZHNBbmREaXJlY3Rpb25zKCdmaWVsZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gZmllbGRzLmluZGV4T2YoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IGdPYmouY3JlYXRlRWxlbWVudCgnYnV0dG9uJywgeyBpZDogZ09iai5lbGVtZW50LmlkICsgY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQgKyAnc29ydGJ1dHRvbicgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xvbmUgPSBzb3J0QnRuUGFyZW50LmNsb25lTm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xvbmUuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNEaXYuYXBwZW5kQ2hpbGQoY2xvbmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ0bk9iaiA9IG5ldyBCdXR0b24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzc0NsYXNzOiB0aGlzLnBhcmVudC5jc3NDbGFzcyA/ICdlLXJlc3NvcnRidXR0b24nICsgJyAnICsgdGhpcy5wYXJlbnQuY3NzQ2xhc3MgOiAnZS1yZXNzb3J0YnV0dG9uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBidG5PYmouYXBwZW5kVG8oYnV0dG9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidXR0b25Jbm5lclRleHQgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5zb3J0U2V0dGluZ3MuY29sdW1uc1twYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25Jbm5lclRleHQgPSAodGhpcy5wYXJlbnQuc29ydFNldHRpbmdzLmNvbHVtbnNbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS5kaXJlY3Rpb24gPT09ICdBc2NlbmRpbmcnKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmxvY2FsZU9iai5nZXRDb25zdGFudCgnQXNjZW5kaW5nVGV4dCcpIDogdGhpcy5wYXJlbnQubG9jYWxlT2JqLmdldENvbnN0YW50KCdEZXNjZW5kaW5nVGV4dCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9IGluZGV4ID4gLTEgPyBidXR0b25Jbm5lclRleHQgOiB0aGlzLnBhcmVudC5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ05vbmVUZXh0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24ub25jbGljayA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc29ydEJ1dHRvbkNsaWNrSGFuZGxlcihlLnRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0ZpbHRlciAmJiBmaWx0ZXJlZENvbHMuaW5kZXhPZihjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maWVsZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdkljb24gPSBnT2JqLmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnZS1pY29ucyBlLXJlcy1pY29uIGUtZmlsdGVyc2V0ZGl2JyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpY29uU3BhbiA9IGdPYmouY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAnZS1pY29ucyBlLXJlcy1pY29uIGUtZmlsdGVyc2V0JyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGljb25TcGFuLnNldEF0dHJpYnV0ZSgnY29sVHlwZScsIGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGl2SWNvbi5hcHBlbmRDaGlsZChpY29uU3Bhbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjRGl2LmFwcGVuZENoaWxkKGRpdkljb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmN1c3RvbUNvbHVtbkRpdiwgQnJvd3Nlci5pc0RldmljZSA/ICd0b3VjaGVuZCcgOiAnY2xpY2snLCB0aGlzLmN1c3RvbUZpbHRlckNvbHVtbkNsaWNrSGFuZGxlciwgdGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jdXN0b21Db2x1bW5EaXY7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUuZ2V0U29ydGVkRmllbGRzQW5kRGlyZWN0aW9ucyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBmaWVsZHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBhcmVudC5zb3J0U2V0dGluZ3MuY29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZmllbGRzLnB1c2godGhpcy5wYXJlbnQuc29ydFNldHRpbmdzLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldW1wiXCIgKyBuYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpZWxkcztcbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUuc29ydEJ1dHRvbkNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgaWYgKHRhcmdldCkge1xuICAgICAgICAgICAgdmFyIGNvbHVtbmRpdiA9IHBhcmVudHNVbnRpbCh0YXJnZXQsICdlLXJlc3BvbnNpdmVjb2xkaXYnKTtcbiAgICAgICAgICAgIHZhciBmaWVsZCA9IGNvbHVtbmRpdi5nZXRBdHRyaWJ1dGUoJ2RhdGEtZS1tYXBwaW5nbmFtZScpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5hbGxvd011bHRpU29ydGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc29ydFByZWRpY2F0ZSA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMuc29ydGVkQ29scyA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNTb3J0QXBwbGllZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRTb3J0QnV0dG9ucyh0YXJnZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHR4dCA9IHRhcmdldC50ZXh0Q29udGVudDtcbiAgICAgICAgICAgIHZhciBkaXJlY3Rpb25UeHQgPSB0eHQgPT09IHRoaXMucGFyZW50LmxvY2FsZU9iai5nZXRDb25zdGFudCgnTm9uZVRleHQnKSA/IHRoaXMucGFyZW50LmxvY2FsZU9iai5nZXRDb25zdGFudCgnQXNjZW5kaW5nVGV4dCcpXG4gICAgICAgICAgICAgICAgOiB0eHQgPT09IHRoaXMucGFyZW50LmxvY2FsZU9iai5nZXRDb25zdGFudCgnQXNjZW5kaW5nVGV4dCcpID8gdGhpcy5wYXJlbnQubG9jYWxlT2JqLmdldENvbnN0YW50KCdEZXNjZW5kaW5nVGV4dCcpXG4gICAgICAgICAgICAgICAgICAgIDogdGhpcy5wYXJlbnQubG9jYWxlT2JqLmdldENvbnN0YW50KCdOb25lVGV4dCcpO1xuICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IGRpcmVjdGlvblR4dCA9PT0gdGhpcy5wYXJlbnQubG9jYWxlT2JqLmdldENvbnN0YW50KCdBc2NlbmRpbmdUZXh0JykgPyAnQXNjZW5kaW5nJ1xuICAgICAgICAgICAgICAgIDogZGlyZWN0aW9uVHh0ID09PSB0aGlzLnBhcmVudC5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ0Rlc2NlbmRpbmdUZXh0JykgPyAnRGVzY2VuZGluZycgOiAnTm9uZSc7XG4gICAgICAgICAgICB0YXJnZXQuaW5uZXJIVE1MID0gZGlyZWN0aW9uVHh0O1xuICAgICAgICAgICAgdGhpcy5zZXRTb3J0ZWRDb2xzKGZpZWxkLCBkaXJlY3Rpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLnJlc2V0U29ydEJ1dHRvbnMgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgIHZhciBidXR0b25zID0gW10uc2xpY2UuY2FsbCh0aGlzLmN1c3RvbUNvbHVtbkRpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlLXJlc3NvcnRidXR0b24nKSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGJ1dHRvbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldICE9PSB0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBidXR0b25zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbm5lckhUTUwgPSB0aGlzLnBhcmVudC5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ05vbmVUZXh0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUuc2V0U29ydGVkQ29scyA9IGZ1bmN0aW9uIChmaWVsZCwgZGlyZWN0aW9uKSB7XG4gICAgICAgIHZhciBmaWVsZHMgPSB0aGlzLmdldEN1cnJlbnRTb3J0ZWRGaWVsZHMoKTtcbiAgICAgICAgdmFyIGluZGV4ID0gZmllbGRzLmluZGV4T2YoZmllbGQpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dNdWx0aVNvcnRpbmcgJiYgaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgdGhpcy5zb3J0ZWRDb2xzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB0aGlzLnNvcnRQcmVkaWNhdGUuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzU29ydEFwcGxpZWQgPSB0cnVlO1xuICAgICAgICBpZiAoZGlyZWN0aW9uICE9PSAnTm9uZScpIHtcbiAgICAgICAgICAgIHRoaXMuc29ydGVkQ29scy5wdXNoKGZpZWxkKTtcbiAgICAgICAgICAgIHRoaXMuc29ydFByZWRpY2F0ZS5wdXNoKHsgZmllbGQ6IGZpZWxkLCBkaXJlY3Rpb246IGRpcmVjdGlvbiB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5nZXRDdXJyZW50U29ydGVkRmllbGRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZmllbGRzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zb3J0ZWRDb2xzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBmaWVsZHMucHVzaCh0aGlzLnNvcnRlZENvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmllbGRzO1xuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5jdXN0b21GaWx0ZXJDb2x1bW5DbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgIGlmIChwYXJlbnRzVW50aWwodGFyZ2V0LCAnY29sdW1ubWVudWRpdicpICYmIHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQ29sTWVudSAmJiAhcGFyZW50c1VudGlsKHRhcmdldCwgJ2UtZGlzYWJsZWQnKSkge1xuICAgICAgICAgICAgdmFyIGNvbHVtbiA9IHRoaXMubWVudUNvbCA/IHRoaXMubWVudUNvbCA6IHRoaXMuZmlsdGVyZWRDb2w7XG4gICAgICAgICAgICBpZiAocGFyZW50c1VudGlsKHRhcmdldCwgJ2UtcmVzcG9uc2l2ZWF1dG9maXRhbGxkaXYnKSkge1xuICAgICAgICAgICAgICAgIGdPYmouYXV0b0ZpdENvbHVtbnMoW10pO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VDdXN0b21GaWx0ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmVudHNVbnRpbCh0YXJnZXQsICdlLXJlc3BvbnNpdmVhdXRvZml0ZGl2JykpIHtcbiAgICAgICAgICAgICAgICBnT2JqLmF1dG9GaXRDb2x1bW5zKGNvbHVtbi5maWVsZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZUN1c3RvbUZpbHRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50c1VudGlsKHRhcmdldCwgJ2UtcmVzcG9uc2l2ZWdyb3VwZGl2JykpIHtcbiAgICAgICAgICAgICAgICBnT2JqLmdyb3VwQ29sdW1uKGNvbHVtbi5maWVsZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZUN1c3RvbUZpbHRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50c1VudGlsKHRhcmdldCwgJ2UtcmVzcG9uc2l2ZXVuZ3JvdXBkaXYnKSkge1xuICAgICAgICAgICAgICAgIGdPYmoudW5ncm91cENvbHVtbihjb2x1bW4uZmllbGQpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VDdXN0b21GaWx0ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmVudHNVbnRpbCh0YXJnZXQsICdlLXJlc3BvbnNpdmVhc2NlbmRpbmdkaXYnKSkge1xuICAgICAgICAgICAgICAgIGdPYmouc29ydENvbHVtbihjb2x1bW4uZmllbGQsICdBc2NlbmRpbmcnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlQ3VzdG9tRmlsdGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJlbnRzVW50aWwodGFyZ2V0LCAnZS1yZXNwb25zaXZlZGVzY2VuZGluZ2RpdicpKSB7XG4gICAgICAgICAgICAgICAgZ09iai5zb3J0Q29sdW1uKGNvbHVtbi5maWVsZCwgJ0Rlc2NlbmRpbmcnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlQ3VzdG9tRmlsdGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJlbnRzVW50aWwodGFyZ2V0LCAnZS1yZXNwb25zaXZlY29sdW1uZGl2JykpIHtcbiAgICAgICAgICAgICAgICBnT2JqLm5vdGlmeShldmVudHMucmVuZGVyUmVzcG9uc2l2ZUNoYW5nZUFjdGlvbiwgeyBhY3Rpb246IDUgfSk7XG4gICAgICAgICAgICAgICAgZ09iai5zaG93UmVzcG9uc2l2ZUN1c3RvbUNvbHVtbkNob29zZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmVudHNVbnRpbCh0YXJnZXQsICdlLXJlc3BvbnNpdmVmaWx0ZXJkaXYnKSkge1xuICAgICAgICAgICAgICAgIGdPYmoubm90aWZ5KGV2ZW50cy5yZW5kZXJSZXNwb25zaXZlQ2hhbmdlQWN0aW9uLCB7IGFjdGlvbjogMyB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzUm93UmVzcG9uc2l2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5pc0N1c3RvbURpYWxvZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChnT2JqLmZpbHRlck1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICBnT2JqLmZpbHRlck1vZHVsZS5yZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIuc2hvd1Jlc3BvbnNpdmVEaWFsb2coY29sdW1uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYWN0aW9uICE9PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzRmlsdGVyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdPYmouZmlsdGVyU2V0dGluZ3MudHlwZSAhPT0gJ0ZpbHRlckJhcicpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJlc3BvbnNpdmVjb2xkaXYnKSB8fCB0YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtcmVzcG9uc2l2ZWNvbGRpdicpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1lLW1hcHBpbmduYW1lJyk7XG4gICAgICAgICAgICAgICAgaWYgKCFmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZCA9IHRhcmdldC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1lLW1hcHBpbmduYW1lJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sID0gZ09iai5nZXRDb2x1bW5CeUZpZWxkKGZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1Jvd1Jlc3BvbnNpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dSZXNwb25zaXZlRGlhbG9nKGNvbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1maWx0ZXJzZXQnKSB8fCB0YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZmlsdGVyc2V0ZGl2JykpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29sRGl2ID0gcGFyZW50c1VudGlsKHRhcmdldCwgJ2UtcmVzcG9uc2l2ZWNvbGRpdicpO1xuICAgICAgICAgICAgICAgIGlmIChjb2xEaXYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gY29sRGl2LmdldEF0dHJpYnV0ZSgnZGF0YS1lLW1hcHBpbmduYW1lJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2wgPSBnT2JqLmdldENvbHVtbkJ5RmllbGQoZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sLmZpbHRlci50eXBlID09PSAnTWVudScgfHwgKCFjb2wuZmlsdGVyLnR5cGUgJiYgZ09iai5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnTWVudScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRGlhbG9nQ2xvc2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmZpbHRlck1vZHVsZS5maWx0ZXJNb2R1bGUuY2xlYXJDdXN0b21GaWx0ZXIoY29sKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDdXN0b21EbGdGaWx0ZXJFbGUodGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIHNob3cgdGhlIHJlc3BvbnNpdmUgZGlhbG9nXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0NvbHVtbn0gY29sIC0gc3BlY2lmaWVzIHRoZSBmaWx0ZXIgY29sdW1uXG4gICAgICogQHBhcmFtIHtDb2x1bW59IGNvbHVtbiAtIHNwZWNpZmllcyB0aGUgbWVudSBjb2x1bW5cbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLnNob3dSZXNwb25zaXZlRGlhbG9nID0gZnVuY3Rpb24gKGNvbCwgY29sdW1uKSB7XG4gICAgICAgIGlmICgodGhpcy5pc0N1c3RvbURpYWxvZyAmJiB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0ZpbHRlciAmJiAhdGhpcy5pc1Jvd1Jlc3BvbnNpdmUpIHx8XG4gICAgICAgICAgICAoY29sdW1uICYmIHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQ29sTWVudSkpIHtcbiAgICAgICAgICAgIHRoaXMubWVudUNvbCA9IGNvbHVtbjtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyQ3VzdG9tRmlsdGVyRGlhbG9nKG51bGwsIGNvbHVtbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlcmVkQ29sID0gY29sO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJSZXNwb25zaXZlRGlhbG9nKGNvbCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlQWRhcHRpdmVVSSAmJiBjb2wpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5maWx0ZXJNb2R1bGUuc2V0RmlsdGVyTW9kZWwoY29sKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5maWx0ZXJNb2R1bGUuZmlsdGVyTW9kdWxlLm9wZW5EaWFsb2codGhpcy5wYXJlbnQuZmlsdGVyTW9kdWxlLmNyZWF0ZU9wdGlvbnMoY29sLCB1bmRlZmluZWQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbHVtbkNob29zZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLnJlbmRlclJlc3BvbnNpdmVDb2x1bW5DaG9vc2VyRGl2LCB7IGFjdGlvbjogJ29wZW4nIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzU29ydCkge1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgICAgICAgICBjYW5jZWw6IGZhbHNlLCBkaWFsb2dPYmo6IHRoaXMuY3VzdG9tUmVzcG9uc2l2ZURsZywgcmVxdWVzdFR5cGU6ICdiZWZvcmVPcGVuQXB0aXZlU29ydERpYWxvZydcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmJlZm9yZU9wZW5BZGFwdGl2ZURpYWxvZywgYXJncyk7XG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmN1c3RvbVJlc3BvbnNpdmVEbGcuc2hvdyh0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuY3VzdG9tUmVzcG9uc2l2ZURsZy5lbGVtZW50LnN0eWxlLm1heEhlaWdodCA9ICcxMDAlJztcbiAgICAgICAgICAgIHRoaXMuc2V0VG9wVG9DaGlsZERpYWxvZyh0aGlzLmN1c3RvbVJlc3BvbnNpdmVEbGcuZWxlbWVudCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlQWRhcHRpdmVVSSAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncyAmJiAodGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MudHlwZSA9PT0gJ0NoZWNrQm94J1xuICAgICAgICAgICAgICAgIHx8IHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLnR5cGUgPT09ICdFeGNlbCcpICYmIHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nXG4gICAgICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MubG9hZGluZ0luZGljYXRvciA9PT0gJ1NoaW1tZXInKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpbHRlckJhc2UgPSB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnQ2hlY2tCb3gnID8gdGhpcy5wYXJlbnQuZmlsdGVyTW9kdWxlLmZpbHRlck1vZHVsZS5jaGVja0JveEJhc2UgOiB0aGlzLnBhcmVudC5maWx0ZXJNb2R1bGUuZmlsdGVyTW9kdWxlLmV4Y2VsRmlsdGVyQmFzZTtcbiAgICAgICAgICAgICAgICBmaWx0ZXJCYXNlLnNob3dNYXNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUuc2V0VG9wVG9DaGlsZERpYWxvZyA9IGZ1bmN0aW9uIChkaWFsb2dFbGUpIHtcbiAgICAgICAgdmFyIGNoaWxkID0gZGlhbG9nRWxlLnF1ZXJ5U2VsZWN0b3IoJy5lLWRpYWxvZycpO1xuICAgICAgICBpZiAoY2hpbGQpIHtcbiAgICAgICAgICAgIHZhciB0b3BfMSA9IGRpYWxvZ0VsZS5xdWVyeVNlbGVjdG9yKCcuZS1kbGctaGVhZGVyLWNvbnRlbnQnKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XG4gICAgICAgICAgICBjaGlsZC5zdHlsZS50b3AgPSB0b3BfMSArICdweCc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyQ3VzdG9tRmlsdGVyRGlhbG9nID0gZnVuY3Rpb24gKGNvbCwgY29sdW1uKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciBpc0NvbE1lbnUgPSB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbE1lbnU7XG4gICAgICAgIGlmICh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0ZpbHRlciAmJiBnT2JqLmZpbHRlclNldHRpbmdzLnR5cGUgPT09ICdGaWx0ZXJCYXInKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbE1lbnUgPSBpc0NvbE1lbnUgPyAnZS1jdXN0b21jb2x1bW5tZW51ZGl2ICcgOiAnJztcbiAgICAgICAgdmFyIG91dGVyRGl2ID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgaWQ6IGdPYmouZWxlbWVudC5pZCArIChpc0NvbE1lbnUgPyAnY3VzdG9tY29sdW1ubWVudScgOiAnY3VzdG9tZmlsdGVyJyksXG4gICAgICAgICAgICBjbGFzc05hbWU6IHRoaXMucGFyZW50LmNzc0NsYXNzID8gY29sTWVudSArXG4gICAgICAgICAgICAgICAgJ2UtY3VzdG9tZmlsdGVyZGl2IGUtcmVzcG9uc2l2ZS1kaWFsb2cgJyArIHRoaXMucGFyZW50LmNzc0NsYXNzIDogY29sTWVudSArICdlLWN1c3RvbWZpbHRlcmRpdiBlLXJlc3BvbnNpdmUtZGlhbG9nJ1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wYXJlbnQuZWxlbWVudC5hcHBlbmRDaGlsZChvdXRlckRpdik7XG4gICAgICAgIHRoaXMuY3VzdG9tRmlsdGVyRGxnID0gdGhpcy5nZXREaWFsb2dPcHRpb25zKGNvbCwgdHJ1ZSwgbnVsbCwgY29sdW1uKTtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICBjYW5jZWw6IGZhbHNlLCBkaWFsb2dPYmo6IHRoaXMuY3VzdG9tRmlsdGVyRGxnLCByZXF1ZXN0VHlwZTogJ2JlZm9yZU9wZW5BcHRpdmVGaWx0ZXJEaWFsb2cnXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucGFyZW50LnRyaWdnZXIoZXZlbnRzLmJlZm9yZU9wZW5BZGFwdGl2ZURpYWxvZywgYXJncyk7XG4gICAgICAgIGlmIChhcmdzLmNhbmNlbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3VzdG9tRmlsdGVyRGxnLmFwcGVuZFRvKG91dGVyRGl2KTtcbiAgICAgICAgdGhpcy5jdXN0b21GaWx0ZXJEbGcuc2hvdyh0cnVlKTtcbiAgICAgICAgdGhpcy5jdXN0b21GaWx0ZXJEbGcuZWxlbWVudC5zdHlsZS5tYXhIZWlnaHQgPSAnMTAwJSc7XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLmdldERpYWxvZ09wdGlvbnMgPSBmdW5jdGlvbiAoY29sLCBpc0N1c3RvbUZpbHRlciwgaWQsIGNvbHVtbikge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IG5ldyBEaWFsb2coe1xuICAgICAgICAgICAgaXNNb2RhbDogdHJ1ZSxcbiAgICAgICAgICAgIHNob3dDbG9zZUljb246IChpZCA9PT0gJ2NvbHVtbmNob29zZXInICYmIHRoaXMucGFyZW50LmNvbHVtbkNob29zZXJTZXR0aW5ncy5oZWFkZXJUZW1wbGF0ZSAmJlxuICAgICAgICAgICAgICAgICF0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbikgPyBmYWxzZSA6IHRydWUsXG4gICAgICAgICAgICBjbG9zZU9uRXNjYXBlOiBmYWxzZSxcbiAgICAgICAgICAgIGxvY2FsZTogdGhpcy5wYXJlbnQubG9jYWxlLFxuICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLnBhcmVudC5hZGFwdGl2ZURsZ1RhcmdldCA/IHRoaXMucGFyZW50LmFkYXB0aXZlRGxnVGFyZ2V0IDogZG9jdW1lbnQuYm9keSxcbiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgZW5hYmxlUnRsOiB0aGlzLnBhcmVudC5lbmFibGVSdGwsXG4gICAgICAgICAgICBjb250ZW50OiB0aGlzLnJlbmRlclJlc3BvbnNpdmVDb250ZW50KGNvbCwgY29sdW1uKSxcbiAgICAgICAgICAgIG9wZW46IHRoaXMuZGlhbG9nT3Blbi5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgY3JlYXRlZDogdGhpcy5kaWFsb2dDcmVhdGVkLmJpbmQodGhpcyksXG4gICAgICAgICAgICBjbG9zZTogdGhpcy5iZWZvcmVEaWFsb2dDbG9zZS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgICAgICAgIGhlaWdodDogJzEwMCUnLFxuICAgICAgICAgICAgYW5pbWF0aW9uU2V0dGluZ3M6IHsgZWZmZWN0OiAnTm9uZScgfSxcbiAgICAgICAgICAgIGNzc0NsYXNzOiB0aGlzLnBhcmVudC5jc3NDbGFzcyA/IHRoaXMucGFyZW50LmNzc0NsYXNzIDogJydcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBpc1N0cmluZ1RlbXBsYXRlID0gJ2lzU3RyaW5nVGVtcGxhdGUnO1xuICAgICAgICBvcHRpb25zW1wiXCIgKyBpc1N0cmluZ1RlbXBsYXRlXSA9IHRydWU7XG4gICAgICAgIGlmIChpc0N1c3RvbUZpbHRlcikge1xuICAgICAgICAgICAgb3B0aW9ucy5oZWFkZXIgPSB0aGlzLnJlbmRlclJlc3BvbnNpdmVIZWFkZXIoY29sLCB1bmRlZmluZWQsIHRydWUpO1xuICAgICAgICAgICAgdmFyIGNvbE1lbnUgPSB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbE1lbnUgPyAnZS1jdXN0b21jb2x1bW5tZW51ICcgOiAnJztcbiAgICAgICAgICAgIG9wdGlvbnMuY3NzQ2xhc3MgPSBjb2xNZW51ICsgJ2UtY3VzdG9tZmlsdGVyJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG9wdGlvbnMuaGVhZGVyID0gdGhpcy5yZW5kZXJSZXNwb25zaXZlSGVhZGVyKGNvbCk7XG4gICAgICAgICAgICBvcHRpb25zLmNzc0NsYXNzID0gdGhpcy5wYXJlbnQucm93UmVuZGVyaW5nTW9kZSA9PT0gJ1ZlcnRpY2FsJyAmJiB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0ZpbHRlclxuICAgICAgICAgICAgICAgID8gJ2UtcmVzJyArIGlkICsgJyBlLXJvdy1yZXNwb25zaXZlLWZpbHRlcicgOiAnZS1yZXMnICsgaWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlclJlc3BvbnNpdmVEaWFsb2cgPSBmdW5jdGlvbiAoY29sKSB7XG4gICAgICAgIHZhciBnT2JqID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmICh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0ZpbHRlciAmJiBnT2JqLmZpbHRlclNldHRpbmdzLnR5cGUgPT09ICdGaWx0ZXJCYXInKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlkID0gdGhpcy5hY3Rpb24gPT09IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24uaXNGaWx0ZXIgPyAnZmlsdGVyJyA6ICdzb3J0JztcbiAgICAgICAgaWQgPSB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbHVtbkNob29zZXIgPyAnY29sdW1uY2hvb3NlcicgOiBpZDtcbiAgICAgICAgdmFyIG91dGVyRGl2ID0gdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgaWQ6IGdPYmouZWxlbWVudC5pZCArICdyZXNwb25zaXZlJyArIGlkLFxuICAgICAgICAgICAgY2xhc3NOYW1lOiB0aGlzLnBhcmVudC5jc3NDbGFzcyA/XG4gICAgICAgICAgICAgICAgJ2UtcmVzJyArIGlkICsgJ2RpdiBlLXJlc3BvbnNpdmUtZGlhbG9nICcgKyB0aGlzLnBhcmVudC5jc3NDbGFzcyA6ICdlLXJlcycgKyBpZCArICdkaXYgZS1yZXNwb25zaXZlLWRpYWxvZydcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucGFyZW50LmVsZW1lbnQuYXBwZW5kQ2hpbGQob3V0ZXJEaXYpO1xuICAgICAgICB0aGlzLmN1c3RvbVJlc3BvbnNpdmVEbGcgPSB0aGlzLmdldERpYWxvZ09wdGlvbnMoY29sLCBmYWxzZSwgaWQpO1xuICAgICAgICB0aGlzLmN1c3RvbVJlc3BvbnNpdmVEbGcuYXBwZW5kVG8ob3V0ZXJEaXYpO1xuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5kaWFsb2dDcmVhdGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBhZGRCaWdnZXJEaWFsb2codGhpcy5wYXJlbnQpO1xuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5kaWFsb2dPcGVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5hY3Rpb24gPT09IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24uaXNTb3J0ICYmIHRoaXMucGFyZW50LmFsbG93TXVsdGlTb3J0aW5nKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGFyZW50LnNvcnRTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3J0ZWRDb2xzLnB1c2godGhpcy5wYXJlbnQuc29ydFNldHRpbmdzLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkKTtcbiAgICAgICAgICAgICAgICB2YXIgc29ydEZpZWxkID0gdGhpcy5wYXJlbnQuc29ydFNldHRpbmdzLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZpZWxkO1xuICAgICAgICAgICAgICAgIHZhciBzb3J0RGlyZWN0aW9uID0gdGhpcy5wYXJlbnQuc29ydFNldHRpbmdzLmNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmRpcmVjdGlvbjtcbiAgICAgICAgICAgICAgICB0aGlzLnNvcnRQcmVkaWNhdGUucHVzaCh7IGZpZWxkOiBzb3J0RmllbGQsIGRpcmVjdGlvbjogc29ydERpcmVjdGlvbiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5iZWZvcmVEaWFsb2dDbG9zZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHRoaXMuaXNEaWFsb2dDbG9zZSA9IGFyZ3MuZWxlbWVudCAmJiAhYXJncy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXhsLWN1c3RvbWZpbHRlcmRpdicpXG4gICAgICAgICAgICAmJiBhcmdzLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJlc2ZpbHRlcmRpdicpO1xuICAgICAgICBpZiAodGhpcy5hY3Rpb24gPT09IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24uaXNGaWx0ZXIpIHtcbiAgICAgICAgICAgIGlmIChhcmdzLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJlc2ZpbHRlcmRpdicpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuZmlsdGVyTW9kdWxlLmZpbHRlck1vZHVsZS5jbG9zZVJlc3BvbnNpdmVEaWFsb2codGhpcy5pc0N1c3RvbURsZ1JlbmRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhcmdzLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWN1c3RvbWZpbHRlcmRpdicpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZUN1c3RvbUZpbHRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnJvd1JlbmRlcmluZ01vZGUgPT09ICdIb3Jpem9udGFsJyAmJiB0aGlzLnBhcmVudC5zaG93Q29sdW1uTWVudSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMucmVuZGVyUmVzcG9uc2l2ZUNoYW5nZUFjdGlvbiwgeyBhY3Rpb246IDQgfSk7XG4gICAgICAgICAgICAgICAgdmFyIGN1c3RvbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXJlc2ZpbHRlcicpO1xuICAgICAgICAgICAgICAgIGlmIChjdXN0b20pIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlKGN1c3RvbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzU29ydCkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZUN1c3RvbURpYWxvZygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQ29sTWVudSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZUN1c3RvbUZpbHRlcigpO1xuICAgICAgICAgICAgdmFyIGN1c3RvbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXJlc2NvbHVtbWVudScpO1xuICAgICAgICAgICAgaWYgKGN1c3RvbSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZShjdXN0b20pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQ29sdW1uQ2hvb3Nlcikge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KGV2ZW50cy5yZW5kZXJSZXNwb25zaXZlQ29sdW1uQ2hvb3NlckRpdiwgeyBhY3Rpb246ICdjbGVhcicgfSk7XG4gICAgICAgICAgICB2YXIgY3VzdG9tID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmUtcmVzY29sdW1uY2hvb3NlcicpO1xuICAgICAgICAgICAgaWYgKGN1c3RvbSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZShjdXN0b20pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnJvd1JlbmRlcmluZ01vZGUgPT09ICdIb3Jpem9udGFsJyAmJiB0aGlzLnBhcmVudC5zaG93Q29sdW1uTWVudSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMucmVuZGVyUmVzcG9uc2l2ZUNoYW5nZUFjdGlvbiwgeyBhY3Rpb246IDQgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmlzQ3VzdG9tRGlhbG9nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmlzRGlhbG9nQ2xvc2UgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5vZmYoZXZlbnRzLmVudGVyS2V5SGFuZGxlciwgdGhpcy5rZXlIYW5kbGVyKTtcbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUuc29ydENvbHVtbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU29ydEFwcGxpZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VDdXN0b21EaWFsb2coKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zb3J0UHJlZGljYXRlLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2V0UHJvcGVydGllcyh7IHNvcnRTZXR0aW5nczogeyBjb2x1bW5zOiBbXSB9IH0sIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zb3J0UHJlZGljYXRlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5zb3J0Q29sdW1uKHRoaXMuc29ydFByZWRpY2F0ZVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQsIHRoaXMuc29ydFByZWRpY2F0ZVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZGlyZWN0aW9uLCB0aGlzLnBhcmVudC5hbGxvd011bHRpU29ydGluZyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnNvcnRQcmVkaWNhdGUubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5jbGVhclNvcnRpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsb3NlQ3VzdG9tRGlhbG9nKCk7XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLmdldEhlYWRlclRpdGxlID0gZnVuY3Rpb24gKGFyZ3MsIGNvbCkge1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgdGl0bGU7XG4gICAgICAgIGlmICh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0VkaXQpIHtcbiAgICAgICAgICAgIHRpdGxlID0gZ09iai5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ0VkaXRGb3JtVGl0bGUnKSArIGFyZ3MucHJpbWFyeUtleVZhbHVlWzBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQWRkKSB7XG4gICAgICAgICAgICB0aXRsZSA9IGdPYmoubG9jYWxlT2JqLmdldENvbnN0YW50KCdBZGRGb3JtVGl0bGUnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0ZpbHRlcikge1xuICAgICAgICAgICAgdGl0bGUgPSBjb2wgPyBjb2wuaGVhZGVyVGV4dCB8fCBjb2wuZmllbGQgOiBnT2JqLmxvY2FsZU9iai5nZXRDb25zdGFudCgnRmlsdGVyVGl0bGUnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc1NvcnQpIHtcbiAgICAgICAgICAgIHRpdGxlID0gZ09iai5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ1NvcnQnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbE1lbnUpIHtcbiAgICAgICAgICAgIHRpdGxlID0gZ09iai5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ0NvbHVtbk1lbnUnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbHVtbkNob29zZXIpIHtcbiAgICAgICAgICAgIHRpdGxlID0gZ09iai5sb2NhbGVPYmouZ2V0Q29uc3RhbnQoJ0Nob29zZUNvbHVtbnMnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGl0bGU7XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLmdldERpYWxvZ05hbWUgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHZhciBuYW1lO1xuICAgICAgICBpZiAoYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQWRkIHx8IGFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0VkaXQpIHtcbiAgICAgICAgICAgIG5hbWUgPSAnZGlhbG9nRWRpdF93cmFwcGVyX3RpdGxlJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhY3Rpb24gPT09IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24uaXNGaWx0ZXIpIHtcbiAgICAgICAgICAgIG5hbWUgPSAncmVzcG9uc2l2ZV9maWx0ZXJfZGlhbG9nX3dyYXBwZXInO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbHVtbkNob29zZXIpIHtcbiAgICAgICAgICAgIG5hbWUgPSAncmVzcG9uc2l2ZV9jb2x1bW5fY2hvb3Nlcl9kaWFsb2dfd3JhcHBlcic7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLmdldEJ1dHRvblRleHQgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHZhciB0ZXh0O1xuICAgICAgICBpZiAoYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQWRkIHx8IGFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0VkaXQpIHtcbiAgICAgICAgICAgIHRleHQgPSAnU2F2ZSc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzRmlsdGVyIHx8IHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzU29ydCB8fFxuICAgICAgICAgICAgYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQ29sdW1uQ2hvb3NlciB8fCB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbHVtbkNob29zZXIpIHtcbiAgICAgICAgICAgIHRleHQgPSAnT0tCdXR0b24nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0ZXh0O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdG8gcmVuZGVyIHRoZSByZXNwb25zaXZlIGhlYWRlclxuICAgICAqXG4gICAgICogQHBhcmFtIHtDb2x1bW59IGNvbCAtIHNwZWNpZmllcyB0aGUgY29sdW1uXG4gICAgICogQHBhcmFtIHtSZXNwb25zaXZlRGlhbG9nQXJnc30gYXJncyAtIHNwZWNpZmllcyB0aGUgcmVzcG9uc2l2ZSBkaWFsb2cgYXJndW1lbnRzXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0N1c3RvbUZpbHRlciAtIHNwZWNpZmllcyB3aGV0aGVyIGl0IGlzIGN1c3RvbSBmaWx0ZXIgb3Igbm90XG4gICAgICogQHJldHVybnMge0hUTUxFbGVtZW50IHwgc3RyaW5nfSByZXR1cm5zIHRoZSBodG1sIGVsZW1lbnQgb3Igc3RyaW5nXG4gICAgICovXG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXJSZXNwb25zaXZlSGVhZGVyID0gZnVuY3Rpb24gKGNvbCwgYXJncywgaXNDdXN0b21GaWx0ZXIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgZ09iai5vbihldmVudHMuZW50ZXJLZXlIYW5kbGVyLCB0aGlzLmtleUhhbmRsZXIsIHRoaXMpO1xuICAgICAgICB2YXIgaWQgPSBnT2JqLmVsZW1lbnQuaWQgKyB0aGlzLmdldERpYWxvZ05hbWUodGhpcy5hY3Rpb24pO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuY29sdW1uQ2hvb3NlclNldHRpbmdzLmhlYWRlclRlbXBsYXRlICYmICF0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJlxuICAgICAgICAgICAgdGhpcy5nZXRIZWFkZXJUaXRsZShhcmdzLCBjb2wpID09PSBnT2JqLmxvY2FsZU9iai5nZXRDb25zdGFudCgnQ2hvb3NlQ29sdW1ucycpKSB7XG4gICAgICAgICAgICB2YXIgaGVhZGVyVGVtcHRlRWxlbWVudCA9IHRoaXMucGFyZW50LmNvbHVtbkNob29zZXJNb2R1bGUucmVuZGVySGVhZGVyKCk7XG4gICAgICAgICAgICByZXR1cm4gaGVhZGVyVGVtcHRlRWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaGVhZGVyID0gZ09iai5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtcmVzLWN1c3RvbS1lbGVtZW50JyB9KTtcbiAgICAgICAgdmFyIHRpdGxlRGl2ID0gZ09iai5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtZGxnLWN1c3RvbS1oZWFkZXInLCBpZDogaWQgfSk7XG4gICAgICAgIHRpdGxlRGl2LmlubmVySFRNTCA9IHRoaXMuZ2V0SGVhZGVyVGl0bGUoYXJncywgY29sKTtcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKHRpdGxlRGl2KTtcbiAgICAgICAgdmFyIHNhdmVCdG4gPSBnT2JqLmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICBpZiAoIWlzQ3VzdG9tRmlsdGVyKSB7XG4gICAgICAgICAgICB0aGlzLnNhdmVCdG4gPSBuZXcgQnV0dG9uKHtcbiAgICAgICAgICAgICAgICBjc3NDbGFzczogdGhpcy5wYXJlbnQuY3NzQ2xhc3MgP1xuICAgICAgICAgICAgICAgICAgICAnZS1wcmltYXJ5IGUtZmxhdCBlLXJlcy1hcHBseS1idG4nICsgJyAnICsgdGhpcy5wYXJlbnQuY3NzQ2xhc3MgOiAnZS1wcmltYXJ5IGUtZmxhdCBlLXJlcy1hcHBseS1idG4nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNhdmVCdG4uaW5uZXJIVE1MID0gZ09iai5sb2NhbGVPYmouZ2V0Q29uc3RhbnQodGhpcy5nZXRCdXR0b25UZXh0KHRoaXMuYWN0aW9uKSk7XG4gICAgICAgICAgICB0aGlzLnNhdmVCdG4uYXBwZW5kVG8oc2F2ZUJ0bik7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgICAgICAgICBzYXZlQnRuLm9uY2xpY2sgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLmRpYWxvZ0hkckJ0bkNsaWNrSGFuZGxlcigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNTb3J0ID0gdGhpcy5hY3Rpb24gPT09IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24uaXNTb3J0O1xuICAgICAgICB2YXIgaXNGaWx0ZXIgPSB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0ZpbHRlcjtcbiAgICAgICAgaWYgKGlzRmlsdGVyIHx8IGlzU29ydCkge1xuICAgICAgICAgICAgdmFyIGlkXzEgPSBpc1NvcnQgPyAnc29ydCcgOiAnZmlsdGVyJztcbiAgICAgICAgICAgIHZhciBjbGVhckJ0biA9IGdPYmouY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgICB0aGlzLmZpbHRlckNsZWFyQnRuID0gbmV3IEJ1dHRvbih7XG4gICAgICAgICAgICAgICAgY3NzQ2xhc3M6IHRoaXMucGFyZW50LmNzc0NsYXNzID8gJ2UtcHJpbWFyeSBlLWZsYXQgZS1yZXMtJyArIGlkXzEgKyAnLWNsZWFyLWJ0bicgKyAnICcgKyB0aGlzLnBhcmVudC5jc3NDbGFzc1xuICAgICAgICAgICAgICAgICAgICA6ICdlLXByaW1hcnkgZS1mbGF0IGUtcmVzLScgKyBpZF8xICsgJy1jbGVhci1idG4nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChpc0ZpbHRlcikge1xuICAgICAgICAgICAgICAgIHZhciBzcGFuID0gZ09iai5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICdlLWJ0bi1pY29uIGUtaWNvbi1maWx0ZXItY2xlYXIgZS1pY29ucycgfSk7XG4gICAgICAgICAgICAgICAgY2xlYXJCdG4uYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbGVhckJ0bi5pbm5lckhUTUwgPSBnT2JqLmxvY2FsZU9iai5nZXRDb25zdGFudCgnQ2xlYXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZChjbGVhckJ0bik7XG4gICAgICAgICAgICB0aGlzLmZpbHRlckNsZWFyQnRuLmFwcGVuZFRvKGNsZWFyQnRuKTtcbiAgICAgICAgICAgIGNsZWFyQnRuLm9uY2xpY2sgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmICgocGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1jdXN0b21maWx0ZXInKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LmZpbHRlck1vZHVsZS5jbGVhckZpbHRlcmluZygpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdmVDdXN0b21EbGdGaWx0ZXJFbGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0ZpbHRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmlsdGVyQ2xlYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlc2V0U29ydEJ1dHRvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNvcnRlZENvbHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNvcnRQcmVkaWNhdGUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzU29ydEFwcGxpZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZChjbGVhckJ0bik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc0N1c3RvbUZpbHRlcikge1xuICAgICAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKHNhdmVCdG4pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoZWFkZXI7XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLmZpbHRlckNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnBhcmVudC5maWx0ZXJNb2R1bGUuZmlsdGVyTW9kdWxlLmNsZWFyQ3VzdG9tRmlsdGVyKHRoaXMuZmlsdGVyZWRDb2wpO1xuICAgICAgICB0aGlzLnBhcmVudC5maWx0ZXJNb2R1bGUuZmlsdGVyTW9kdWxlLmNsb3NlUmVzcG9uc2l2ZURpYWxvZygpO1xuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5yZW1vdmVDdXN0b21GaWx0ZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnY3VzdG9tY29sdW1ubWVudScpO1xuICAgICAgICBpZiAoZWxlbSkge1xuICAgICAgICAgICAgcmVtb3ZlKGVsZW0pO1xuICAgICAgICAgICAgdmFyIGN1c3RvbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWN1c3RvbWZpbHRlcicpO1xuICAgICAgICAgICAgaWYgKGN1c3RvbSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZShjdXN0b20pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBjdXN0b21tZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmUtcmVzY29sdW1uY2hvb3NlcicpO1xuICAgICAgICBpZiAoY3VzdG9tbWVudSkge1xuICAgICAgICAgICAgcmVtb3ZlKGN1c3RvbW1lbnUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byBjbG9zZSB0aGUgUmVzcG9uc2l2ZSBDb2x1bW4gQ2hvb3NlciBkaWFsb2cuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUuaGlkZVJlc3BvbnNpdmVDb2x1bW5DaG9vc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29sdW1uQ2hvb3NlckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZS1yZXNjb2x1bW5jaG9vc2VyJyk7XG4gICAgICAgIGlmIChjb2x1bW5DaG9vc2VyRWxlbWVudCkge1xuICAgICAgICAgICAgcmVtb3ZlKGNvbHVtbkNob29zZXJFbGVtZW50KTtcbiAgICAgICAgICAgIHRoaXMuaXNDdXN0b21EaWFsb2cgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaXNEaWFsb2dDbG9zZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLmRpYWxvZ0hkckJ0bkNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzRWRpdCB8fCB0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0FkZCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuZW5kRWRpdCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzRmlsdGVyKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5maWx0ZXJNb2R1bGUuZmlsdGVyTW9kdWxlLmFwcGx5Q3VzdG9tRmlsdGVyKHsgY29sOiB0aGlzLmZpbHRlcmVkQ29sLCBpc0N1c3RvbUZpbHRlcjogdGhpcy5pc0N1c3RvbURsZ1JlbmRlciB9KTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ3VzdG9tRmlsdGVyRWxlbWVudCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzU29ydCkge1xuICAgICAgICAgICAgdGhpcy5zb3J0Q29sdW1uKCk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUN1c3RvbUZpbHRlckVsZW1lbnQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0NvbHVtbkNob29zZXIpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudHMucmVuZGVyUmVzcG9uc2l2ZUNvbHVtbkNob29zZXJEaXYsIHsgYWN0aW9uOiAnY29uZmlybScgfSk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUN1c3RvbUZpbHRlckVsZW1lbnQoKTtcbiAgICAgICAgICAgIHRoaXMuaXNDdXN0b21EaWFsb2cgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaXNEaWFsb2dDbG9zZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIucHJvdG90eXBlLmNsb3NlQ3VzdG9tRGlhbG9nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pc0N1c3RvbURsZ1JlbmRlcikge1xuICAgICAgICAgICAgdmFyIG1haW5maWx0ZXJkaXYgPSB0aGlzLmN1c3RvbVJlc3BvbnNpdmVEbGcuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1tYWluZmlsdGVyZGl2Jyk7XG4gICAgICAgICAgICByZW1vdmUobWFpbmZpbHRlcmRpdik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc1Jvd1Jlc3BvbnNpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc0N1c3RvbURsZ1JlbmRlciA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRlc3Ryb3lDdXN0b21GaWx0ZXJEaWFsb2coKTtcbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUuZGVzdHJveUN1c3RvbUZpbHRlckRpYWxvZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmN1c3RvbVJlc3BvbnNpdmVEbGcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuY3VzdG9tUmVzcG9uc2l2ZURsZy5lbGVtZW50LmlkKTtcbiAgICAgICAgaWYgKHRoaXMuY3VzdG9tUmVzcG9uc2l2ZURsZyAmJiAhdGhpcy5jdXN0b21SZXNwb25zaXZlRGxnLmlzRGVzdHJveWVkICYmIGVsZW0pIHtcbiAgICAgICAgICAgIHRoaXMuY3VzdG9tUmVzcG9uc2l2ZURsZy5kZXN0cm95KCk7XG4gICAgICAgICAgICByZW1vdmUoZWxlbSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbG9zZUN1c3RvbUZpbHRlcigpO1xuICAgICAgICBpZiAodGhpcy5hY3Rpb24gPT09IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24uaXNTb3J0KSB7XG4gICAgICAgICAgICB0aGlzLnNvcnRQcmVkaWNhdGUgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuc29ydGVkQ29scyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5pc1NvcnRBcHBsaWVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUuY2xvc2VDdXN0b21GaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0RpYWxvZ0Nsb3NlICYmIHRoaXMuY3VzdG9tRmlsdGVyRGxnKSB7XG4gICAgICAgICAgICB2YXIgY3VzdG9tRWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5jdXN0b21GaWx0ZXJEbGcuZWxlbWVudC5pZCk7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXN0b21GaWx0ZXJEbGcgJiYgIXRoaXMuY3VzdG9tRmlsdGVyRGxnLmlzRGVzdHJveWVkICYmIGN1c3RvbUVsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tRmlsdGVyRGxnLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICByZW1vdmUoY3VzdG9tRWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzQ3VzdG9tRGlhbG9nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNEaWFsb2dDbG9zZSA9IGZhbHNlO1xuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5yZW1vdmVDdXN0b21EbGdGaWx0ZXJFbGUgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZmlsdGVyc2V0ZGl2JykpIHtcbiAgICAgICAgICAgICAgICByZW1vdmUodGFyZ2V0LnBhcmVudEVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlKHRhcmdldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLmN1c3RvbUNvbHVtbkRpdi5jaGlsZHJlbjtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBjaGlsZFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ucXVlcnlTZWxlY3RvcignLmUtZmlsdGVyc2V0ZGl2Jyk7XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmUodGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgaS0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyLnByb3RvdHlwZS5rZXlIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMTMgJiYgKCh0aGlzLmFjdGlvbiA9PT0gUmVzcG9uc2l2ZURpYWxvZ0FjdGlvbi5pc0ZpbHRlclxuICAgICAgICAgICAgJiYgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXNlYXJjaGlucHV0JykpXG4gICAgICAgICAgICB8fCAodGhpcy5hY3Rpb24gPT09IFJlc3BvbnNpdmVEaWFsb2dBY3Rpb24uaXNFZGl0IHx8IHRoaXMuYWN0aW9uID09PSBSZXNwb25zaXZlRGlhbG9nQWN0aW9uLmlzQWRkKSkpIHtcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nSGRyQnRuQ2xpY2tIYW5kbGVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUuZWRpdENvbXBsYXRlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgaWYgKGFyZ3MucmVxdWVzdFR5cGUgPT09ICdzYXZlJyB8fCBhcmdzLnJlcXVlc3RUeXBlID09PSAnY2FuY2VsJykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQub2ZmKGV2ZW50cy5lbnRlcktleUhhbmRsZXIsIHRoaXMua2V5SGFuZGxlcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuY3VzdG9tQ29sdW1uRGl2KSB7XG4gICAgICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuY3VzdG9tQ29sdW1uRGl2LCBCcm93c2VyLmlzRGV2aWNlID8gJ3RvdWNoZW5kJyA6ICdjbGljaycsIHRoaXMuY3VzdG9tRmlsdGVyQ29sdW1uQ2xpY2tIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBhZGRSZW1vdmVFdmVudExpc3RlbmVyKHRoaXMucGFyZW50LCB0aGlzLmV2dEhhbmRsZXJzLCB0cnVlLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudHMuYWN0aW9uQ29tcGxldGUsIHRoaXMub25BY3Rpb25Db21wbGV0ZUZuKTtcbiAgICB9O1xuICAgIHJldHVybiBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXI7XG59KCkpO1xuZXhwb3J0IHsgUmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/responsive-dialog-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-drag-drop-renderer.js":
/*!*****************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-drag-drop-renderer.js ***!
  \*****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RowDragDropRenderer: () => (/* binding */ RowDragDropRenderer)\n/* harmony export */ });\n/* harmony import */ var _cell_renderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/**\n * ExpandCellRenderer class which responsible for building group expand cell.\n *\n * @hidden\n */\nvar RowDragDropRenderer = /** @class */ (function (_super) {\n    __extends(RowDragDropRenderer, _super);\n    function RowDragDropRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.element = _this.parent.createElement('TD', {\n            className: 'e-rowdragdrop e-rowdragdropcell',\n            attrs: { tabindex: '-1', role: 'gridcell' }\n        });\n        return _this;\n    }\n    /**\n     * Function to render the detail expand cell\n     *\n     * @param {Cell<Column>} cell - specifies the cell\n     * @param {Object} data - specifies the data\n     * @returns {Element} returns the element\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    RowDragDropRenderer.prototype.render = function (cell, data) {\n        var nodeElement = this.element.cloneNode();\n        nodeElement.appendChild(this.parent.createElement('div', {\n            className: 'e-icons e-rowcelldrag e-dtdiagonalright e-icon-rowdragicon',\n            attrs: { 'aria-hidden': 'true' }\n        }));\n        if (cell.isSelected) {\n            nodeElement.classList.add('e-selectionbackground');\n            nodeElement.classList.add('e-active');\n        }\n        if (this.parent.getVisibleFrozenRightCount() || this.parent.getVisibleFrozenLeftCount()) {\n            nodeElement.classList.add('e-leftfreeze');\n            var width = this.parent.getFrozenMode() === 'Right' ? 0 : this.parent.groupSettings.columns.length * 30;\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_0__.applyStickyLeftRightPosition)(nodeElement, width, this.parent.enableRtl, this.parent.getFrozenMode() === 'Right' ? 'Right' : 'Left');\n        }\n        return nodeElement;\n    };\n    return RowDragDropRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_1__.CellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9yb3ctZHJhZy1kcm9wLXJlbmRlcmVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3QjtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLENBQUM7QUFDOEM7QUFDYTtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxjQUFjO0FBQzdCLGVBQWUsUUFBUTtBQUN2QixpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx3RUFBNEI7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsd0RBQVk7QUFDaUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9yb3ctZHJhZy1kcm9wLXJlbmRlcmVyLmpzPzZhMjgiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5pbXBvcnQgeyBDZWxsUmVuZGVyZXIgfSBmcm9tICcuL2NlbGwtcmVuZGVyZXInO1xuaW1wb3J0IHsgYXBwbHlTdGlja3lMZWZ0UmlnaHRQb3NpdGlvbiB9IGZyb20gJy4uL2Jhc2UvdXRpbCc7XG4vKipcbiAqIEV4cGFuZENlbGxSZW5kZXJlciBjbGFzcyB3aGljaCByZXNwb25zaWJsZSBmb3IgYnVpbGRpbmcgZ3JvdXAgZXhwYW5kIGNlbGwuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgUm93RHJhZ0Ryb3BSZW5kZXJlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUm93RHJhZ0Ryb3BSZW5kZXJlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBSb3dEcmFnRHJvcFJlbmRlcmVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZWxlbWVudCA9IF90aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdURCcsIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2Utcm93ZHJhZ2Ryb3AgZS1yb3dkcmFnZHJvcGNlbGwnLFxuICAgICAgICAgICAgYXR0cnM6IHsgdGFiaW5kZXg6ICctMScsIHJvbGU6ICdncmlkY2VsbCcgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byByZW5kZXIgdGhlIGRldGFpbCBleHBhbmQgY2VsbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtDZWxsPENvbHVtbj59IGNlbGwgLSBzcGVjaWZpZXMgdGhlIGNlbGxcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIHNwZWNpZmllcyB0aGUgZGF0YVxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSByZXR1cm5zIHRoZSBlbGVtZW50XG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIFJvd0RyYWdEcm9wUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIChjZWxsLCBkYXRhKSB7XG4gICAgICAgIHZhciBub2RlRWxlbWVudCA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICAgICAgbm9kZUVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiAnZS1pY29ucyBlLXJvd2NlbGxkcmFnIGUtZHRkaWFnb25hbHJpZ2h0IGUtaWNvbi1yb3dkcmFnaWNvbicsXG4gICAgICAgICAgICBhdHRyczogeyAnYXJpYS1oaWRkZW4nOiAndHJ1ZScgfVxuICAgICAgICB9KSk7XG4gICAgICAgIGlmIChjZWxsLmlzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Utc2VsZWN0aW9uYmFja2dyb3VuZCcpO1xuICAgICAgICAgICAgbm9kZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1hY3RpdmUnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZ2V0VmlzaWJsZUZyb3plblJpZ2h0Q291bnQoKSB8fCB0aGlzLnBhcmVudC5nZXRWaXNpYmxlRnJvemVuTGVmdENvdW50KCkpIHtcbiAgICAgICAgICAgIG5vZGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2UtbGVmdGZyZWV6ZScpO1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gdGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSAnUmlnaHQnID8gMCA6IHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggKiAzMDtcbiAgICAgICAgICAgIGFwcGx5U3RpY2t5TGVmdFJpZ2h0UG9zaXRpb24obm9kZUVsZW1lbnQsIHdpZHRoLCB0aGlzLnBhcmVudC5lbmFibGVSdGwsIHRoaXMucGFyZW50LmdldEZyb3plbk1vZGUoKSA9PT0gJ1JpZ2h0JyA/ICdSaWdodCcgOiAnTGVmdCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlRWxlbWVudDtcbiAgICB9O1xuICAgIHJldHVybiBSb3dEcmFnRHJvcFJlbmRlcmVyO1xufShDZWxsUmVuZGVyZXIpKTtcbmV4cG9ydCB7IFJvd0RyYWdEcm9wUmVuZGVyZXIgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-drag-drop-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-drag-header-indent-render.js":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-drag-header-indent-render.js ***!
  \************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RowDragDropHeaderRenderer: () => (/* binding */ RowDragDropHeaderRenderer)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _cell_renderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n/**\n * DetailHeaderIndentCellRenderer class which responsible for building detail header indent cell.\n *\n * @hidden\n */\nvar RowDragDropHeaderRenderer = /** @class */ (function (_super) {\n    __extends(RowDragDropHeaderRenderer, _super);\n    function RowDragDropHeaderRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.element = _this.parent.createElement('TH', { className: 'e-rowdragheader' });\n        return _this;\n    }\n    /**\n     * Function to render the detail indent cell\n     *\n     * @param  {Cell} cell - specifies the cell\n     * @param  {Object} data - specifies the data\n     * @returns {Element} returns the element\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    RowDragDropHeaderRenderer.prototype.render = function (cell, data) {\n        var node = this.element.cloneNode();\n        node.appendChild((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', { className: 'e-emptycell' }));\n        if (this.parent.getVisibleFrozenRightCount() || this.parent.getVisibleFrozenLeftCount()) {\n            node.classList.add('e-leftfreeze');\n            var width = this.parent.getFrozenMode() === 'Right' ? 0 : this.parent.groupSettings.columns.length * 30;\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.applyStickyLeftRightPosition)(node, width, this.parent.enableRtl, this.parent.getFrozenMode() === 'Right' ? 'Right' : 'Left');\n        }\n        return node;\n    };\n    return RowDragDropHeaderRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_2__.CellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9yb3ctZHJhZy1oZWFkZXItaW5kZW50LXJlbmRlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUNvRDtBQUNOO0FBQ2E7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELDhCQUE4QjtBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLE1BQU07QUFDdEIsZ0JBQWdCLFFBQVE7QUFDeEIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsbUVBQWEsVUFBVSwwQkFBMEI7QUFDMUU7QUFDQTtBQUNBO0FBQ0EsWUFBWSx3RUFBNEI7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsd0RBQVk7QUFDdUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9yb3ctZHJhZy1oZWFkZXItaW5kZW50LXJlbmRlci5qcz81NTBmIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgY3JlYXRlRWxlbWVudCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IENlbGxSZW5kZXJlciB9IGZyb20gJy4vY2VsbC1yZW5kZXJlcic7XG5pbXBvcnQgeyBhcHBseVN0aWNreUxlZnRSaWdodFBvc2l0aW9uIH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbi8qKlxuICogRGV0YWlsSGVhZGVySW5kZW50Q2VsbFJlbmRlcmVyIGNsYXNzIHdoaWNoIHJlc3BvbnNpYmxlIGZvciBidWlsZGluZyBkZXRhaWwgaGVhZGVyIGluZGVudCBjZWxsLlxuICpcbiAqIEBoaWRkZW5cbiAqL1xudmFyIFJvd0RyYWdEcm9wSGVhZGVyUmVuZGVyZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFJvd0RyYWdEcm9wSGVhZGVyUmVuZGVyZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUm93RHJhZ0Ryb3BIZWFkZXJSZW5kZXJlcigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmVsZW1lbnQgPSBfdGhpcy5wYXJlbnQuY3JlYXRlRWxlbWVudCgnVEgnLCB7IGNsYXNzTmFtZTogJ2Utcm93ZHJhZ2hlYWRlcicgfSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdG8gcmVuZGVyIHRoZSBkZXRhaWwgaW5kZW50IGNlbGxcbiAgICAgKlxuICAgICAqIEBwYXJhbSAge0NlbGx9IGNlbGwgLSBzcGVjaWZpZXMgdGhlIGNlbGxcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGRhdGEgLSBzcGVjaWZpZXMgdGhlIGRhdGFcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBSb3dEcmFnRHJvcEhlYWRlclJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoY2VsbCwgZGF0YSkge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ2UtZW1wdHljZWxsJyB9KSk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5nZXRWaXNpYmxlRnJvemVuUmlnaHRDb3VudCgpIHx8IHRoaXMucGFyZW50LmdldFZpc2libGVGcm96ZW5MZWZ0Q291bnQoKSkge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWxlZnRmcmVlemUnKTtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHRoaXMucGFyZW50LmdldEZyb3plbk1vZGUoKSA9PT0gJ1JpZ2h0JyA/IDAgOiB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICogMzA7XG4gICAgICAgICAgICBhcHBseVN0aWNreUxlZnRSaWdodFBvc2l0aW9uKG5vZGUsIHdpZHRoLCB0aGlzLnBhcmVudC5lbmFibGVSdGwsIHRoaXMucGFyZW50LmdldEZyb3plbk1vZGUoKSA9PT0gJ1JpZ2h0JyA/ICdSaWdodCcgOiAnTGVmdCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgcmV0dXJuIFJvd0RyYWdEcm9wSGVhZGVyUmVuZGVyZXI7XG59KENlbGxSZW5kZXJlcikpO1xuZXhwb3J0IHsgUm93RHJhZ0Ryb3BIZWFkZXJSZW5kZXJlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-drag-header-indent-render.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-renderer.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-renderer.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RowRenderer: () => (/* binding */ RowRenderer)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _cell_merge_renderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cell-merge-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-merge-renderer.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n\n/**\n * RowRenderer class which responsible for building row content.\n *\n * @hidden\n */\nvar RowRenderer = /** @class */ (function () {\n    function RowRenderer(serviceLocator, cellType, parent) {\n        this.isSpan = false;\n        this.cellType = cellType;\n        this.serviceLocator = serviceLocator;\n        this.parent = parent;\n        this.element = this.parent.createElement('tr', { attrs: { role: 'row' } });\n    }\n    /* eslint-disable */\n    /**\n     * Function to render the row content based on Column[] and data.\n     *\n     * @param {Row<T>} row - specifies the row\n     * @param {Column[]} columns - specifies the columns\n     * @param {Object} attributes - specifies the attributes\n     * @param {string} rowTemplate - specifies the rowTemplate\n     * @param {Element} cloneNode - specifies the cloneNode\n     * @returns {Element} returns the element\n     */\n    /* eslint-enable */\n    RowRenderer.prototype.render = function (row, columns, attributes, rowTemplate, cloneNode) {\n        return this.refreshRow(row, columns, attributes, rowTemplate, cloneNode);\n    };\n    /* eslint-disable */\n    /**\n     * Function to refresh the row content based on Column[] and data.\n     *\n     * @param {Row<T>} row - specifies the row\n     * @param {Column[]} columns - specifies the column\n     * @param {boolean} isChanged - specifies isChanged\n     * @param {Object} attributes - specifies the attributes\n     * @param {string} rowTemplate - specifies the rowTemplate\n     * @returns {void}\n     */\n    /* eslint-enable */\n    RowRenderer.prototype.refresh = function (row, columns, isChanged, attributes, rowTemplate) {\n        var _this = this;\n        if (isChanged) {\n            row.data = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.extendObjWithFn)({}, row.changes);\n            this.refreshMergeCells(row);\n        }\n        var node = this.parent.element.querySelector('[data-uid=' + row.uid + ']');\n        var tr = this.refreshRow(row, columns, attributes, rowTemplate, null, isChanged);\n        var cells = [].slice.call(tr.cells);\n        var tempCells = [].slice.call(node.querySelectorAll('.e-templatecell'));\n        if (this.parent.isReact && tempCells.length) {\n            var _loop_1 = function (col) {\n                if (col.template) {\n                    setTimeout(function () {\n                        _this.parent.refreshReactColumnTemplateByUid(col.uid, true);\n                    }, 0);\n                    return \"break\";\n                }\n            };\n            for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n                var col = columns_1[_i];\n                var state_1 = _loop_1(col);\n                if (state_1 === \"break\")\n                    break;\n            }\n        }\n        var attr = [].slice.call(tr.attributes);\n        attr.map(function (item) {\n            node.setAttribute(item['name'], item['value']);\n        });\n        node.innerHTML = '';\n        for (var _a = 0, cells_1 = cells; _a < cells_1.length; _a++) {\n            var cell = cells_1[_a];\n            node.appendChild(cell);\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    RowRenderer.prototype.refreshRow = function (row, columns, attributes, rowTemplate, cloneNode, isEdit) {\n        var tr = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cloneNode) ? cloneNode : this.element.cloneNode();\n        var rowArgs = { data: row.data };\n        var cellArgs = { data: row.data };\n        var chekBoxEnable = this.parent.getColumns().filter(function (col) { return col.type === 'checkbox' && col.field; })[0];\n        var value = false;\n        var isFrozen = this.parent.isFrozenGrid();\n        var isFirstVisibleCell = true;\n        if (chekBoxEnable) {\n            value = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.getObject)(chekBoxEnable.field, rowArgs.data);\n        }\n        var selIndex = this.parent.getSelectedRowIndexes();\n        if (row.isDataRow) {\n            row.isSelected = selIndex.indexOf(row.index) > -1 || value;\n        }\n        if (row.isDataRow && this.parent.isCheckBoxSelection\n            && this.parent.checkAllRows === 'Check' && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n            row.isSelected = true;\n            if (selIndex.indexOf(row.index) === -1) {\n                selIndex.push(row.index);\n            }\n        }\n        this.buildAttributeFromRow(tr, row);\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(tr, (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, attributes, {}));\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.setStyleAndAttributes)(tr, row.attributes);\n        var cellRendererFact = this.serviceLocator.getService('cellRendererFactory');\n        var _loop_2 = function (i, len) {\n            var cell = row.cells[parseInt(i.toString(), 10)];\n            cell.isSelected = row.isSelected;\n            cell.isColumnSelected = cell.column.isSelected;\n            var cellRenderer = cellRendererFact.getCellRenderer(row.cells[parseInt(i.toString(), 10)].cellType\n                || _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Data);\n            var attrs = { 'index': !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row.index) ? row.index.toString() : '' };\n            if (row.isExpand && row.cells[parseInt(i.toString(), 10)].cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.DetailExpand) {\n                attrs['class'] = this_1.parent.isPrinting ? 'e-detailrowcollapse' : 'e-detailrowexpand';\n            }\n            var isGroupFirstCell = !this_1.parent.enableRtl && this_1.parent.groupSettings && isFirstVisibleCell &&\n                this_1.parent.groupSettings.columns.length && (this_1.parent.gridLines === 'Vertical' || this_1.parent.gridLines === 'Both');\n            var td = cellRenderer.render(row.cells[parseInt(i.toString(), 10)], row.data, attrs, row.isExpand, isEdit);\n            if (row.cells[parseInt(i.toString(), 10)].cellType !== _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Filter) {\n                if (row.cells[parseInt(i.toString(), 10)].cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Data\n                    || row.cells[parseInt(i.toString(), 10)].cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.CommandColumn) {\n                    if (cell.visible && isGroupFirstCell) {\n                        td.classList.add('e-grid-group-first-cell');\n                        isFirstVisibleCell = false;\n                    }\n                    var isReactChild = this_1.parent.parentDetails && this_1.parent.parentDetails.parentInstObj &&\n                        this_1.parent.parentDetails.parentInstObj.isReact;\n                    var isReactPrintGrid = this_1.parent.printGridParent && this_1.parent.printGridParent.isReact;\n                    if (((this_1.parent.isReact && this_1.parent.requireTemplateRef) || (isReactChild &&\n                        this_1.parent.parentDetails.parentInstObj.requireTemplateRef) || (isReactPrintGrid\n                        && this_1.parent.printGridParent.requireTemplateRef)) && cell.isTemplate) {\n                        // eslint-disable-next-line @typescript-eslint/no-this-alias\n                        var thisRef_1 = this_1;\n                        thisRef_1.parent.renderTemplates(function () {\n                            if (typeof (cell.column.template) !== 'string') {\n                                var ariaAttr = td.getAttribute('aria-label');\n                                td.setAttribute('aria-label', td.innerText + ariaAttr);\n                            }\n                            thisRef_1.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.queryCellInfo, (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(cellArgs, {\n                                cell: td, column: cell.column, colSpan: 1,\n                                rowSpan: 1, foreignKeyData: row.cells[parseInt(i.toString(), 10)].foreignKeyData,\n                                requestType: thisRef_1.parent.requestTypeAction\n                            }));\n                        });\n                    }\n                    else {\n                        this_1.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.queryCellInfo, (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(cellArgs, {\n                            cell: td, column: cell.column, colSpan: 1,\n                            rowSpan: 1, foreignKeyData: row.cells[parseInt(i.toString(), 10)].foreignKeyData,\n                            requestType: this_1.parent.requestTypeAction\n                        }));\n                    }\n                    var isRowSpanned = false;\n                    if (row.index > 0 && (this_1.isSpan || (this_1.parent.isSpan && isEdit))) {\n                        var rowsObject = this_1.parent.getRowsObject();\n                        var prevRowCells = this_1.parent.groupSettings.columns.length > 0 &&\n                            !rowsObject[row.index - 1].isDataRow ? rowsObject[row.index].cells : rowsObject[row.index - 1].cells;\n                        var uid_1 = 'uid';\n                        var prevRowCell = prevRowCells.filter(function (cell) {\n                            return cell.column.uid === row.cells[parseInt(i.toString(), 10)].column[\"\" + uid_1];\n                        })[0];\n                        isRowSpanned = prevRowCell.isRowSpanned ? prevRowCell.isRowSpanned : prevRowCell.rowSpanRange > 1;\n                    }\n                    if ((cellArgs.rowSpan > 1 || cellArgs.colSpan > 1)) {\n                        this_1.resetrowSpanvalue(this_1.parent.frozenRows > row.index ? this_1.parent.frozenRows :\n                            this_1.parent.currentViewData.length, cellArgs, row.index);\n                        if (cellArgs.column.visible === false) {\n                            cellArgs.colSpan = 1;\n                        }\n                        else {\n                            if (isFrozen) {\n                                var columns_2 = this_1.parent.getColumns();\n                                var right = this_1.parent.getFrozenRightColumnsCount();\n                                var left = this_1.parent.getFrozenLeftCount();\n                                var movableCount = columns_2.length - right;\n                                var cellIdx = cellArgs.column.index;\n                                if (left > cellIdx && left < (cellIdx + cellArgs.colSpan)) {\n                                    var colSpan = (cellIdx + cellArgs.colSpan) - left;\n                                    cellArgs.colSpan = cellArgs.colSpan - colSpan;\n                                }\n                                else if (movableCount <= cellIdx && columns_2.length < (cellIdx + cellArgs.colSpan)) {\n                                    var colSpan = (cellIdx + cellArgs.colSpan) - columns_2.length;\n                                    cellArgs.colSpan = cellArgs.colSpan - colSpan;\n                                }\n                                else if (cellArgs.column.freeze === 'Fixed') {\n                                    var colSpan = 1;\n                                    var index = cellIdx;\n                                    for (var j = index + 1; j < index + cellArgs.colSpan; j++) {\n                                        if (columns_2[parseInt(j.toString(), 10)].freeze === 'Fixed') {\n                                            colSpan++;\n                                        }\n                                        else {\n                                            break;\n                                        }\n                                    }\n                                    cellArgs.colSpan = colSpan;\n                                }\n                                else if (movableCount > cellIdx && movableCount < (cellIdx + cellArgs.colSpan)) {\n                                    var colSpan = (cellIdx + cellArgs.colSpan) - movableCount;\n                                    cellArgs.colSpan = cellArgs.colSpan - colSpan;\n                                }\n                            }\n                        }\n                    }\n                    if (cellArgs.colSpan > 1 || row.cells[parseInt(i.toString(), 10)].cellSpan > 1 || cellArgs.rowSpan > 1\n                        || isRowSpanned) {\n                        this_1.parent.isSpan = true;\n                        this_1.isSpan = true;\n                        var cellMerge = new _cell_merge_renderer__WEBPACK_IMPORTED_MODULE_4__.CellMergeRender(this_1.serviceLocator, this_1.parent);\n                        td = cellMerge.render(cellArgs, row, i, td);\n                        if (isFrozen) {\n                            (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.resetColandRowSpanStickyPosition)(this_1.parent, cellArgs.column, td, cellArgs.colSpan);\n                        }\n                    }\n                }\n                if ((cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Header || cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.StackedHeader) &&\n                    isGroupFirstCell && (cell.visible || cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.StackedHeader)) {\n                    var visibleColumns = this_1.parent.getVisibleColumns();\n                    var field = 'field';\n                    var type = 'type';\n                    if ((cell.column[\"\" + type] && cell.column[\"\" + type] === 'checkbox') ||\n                        (cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Header && cell.column[\"\" + field] && visibleColumns.length &&\n                            visibleColumns[0].field === cell.column[\"\" + field]) || cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.StackedHeader) {\n                        td.classList.add('e-grid-group-first-cell');\n                        isFirstVisibleCell = false;\n                    }\n                }\n                if (cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Header && (row.cells[parseInt(i.toString(), 10)].colSpan > 1 ||\n                    row.cells[parseInt(i.toString(), 10)].rowSpan > 1)) {\n                    var cellMerge = new _cell_merge_renderer__WEBPACK_IMPORTED_MODULE_4__.CellMergeRender(this_1.serviceLocator, this_1.parent);\n                    td = cellMerge.render(row.cells[parseInt(i.toString(), 10)], row, i, td);\n                }\n                if (this_1.isSpan) {\n                    var rowsObject = this_1.parent.getRowsObject();\n                    var isRtl = this_1.parent.enableRtl;\n                    if (rowsObject[row.index - 1]) {\n                        var prevRowCells = rowsObject[row.index - 1].cells;\n                        var prevRowCell = prevRowCells[i - 1];\n                        var currentRowCell = prevRowCells[parseInt(i.toString(), 10)];\n                        var nextRowCell = prevRowCells[i + 1];\n                        var direction = prevRowCells[parseInt(i.toString(), 10)].column.freeze;\n                        if (prevRowCell && (prevRowCell.isRowSpanned || prevRowCell.rowSpanRange > 1) && prevRowCell.visible) {\n                            if (!isRtl && (!currentRowCell.isRowSpanned || prevRowCell.rowSpanRange > currentRowCell.rowSpanRange)) {\n                                td.classList.add('e-rowcell-firstchild');\n                            }\n                            if (isFrozen) {\n                                if (prevRowCell.column.freeze === 'Fixed' && direction === 'Fixed') {\n                                    td.classList.add(isRtl ? 'e-removefreezerightborder' : 'e-removefreezeleftborder');\n                                }\n                                else if (!isRtl && i === 1 && direction === 'Left') {\n                                    td.classList.add('e-addfreezefirstchildborder');\n                                }\n                            }\n                        }\n                        if (nextRowCell && (nextRowCell.isRowSpanned || nextRowCell.rowSpanRange > 1) && nextRowCell.visible) {\n                            if (isRtl && (!currentRowCell.isRowSpanned || nextRowCell.rowSpanRange > currentRowCell.rowSpanRange)) {\n                                td.classList.add('e-rowcell-lastchild');\n                            }\n                            if (isFrozen && nextRowCell.column.freeze === 'Fixed' && direction === 'Fixed' && cellArgs.colSpan < 2) {\n                                td.classList.add(isRtl ? 'e-removefreezeleftborder' : 'e-removefreezerightborder');\n                            }\n                        }\n                    }\n                }\n                if (cellArgs.rowSpan > 1 && this_1.parent.currentViewData.length - row.index === cellArgs.rowSpan) {\n                    td.classList.add('e-row-span-lastrowcell');\n                }\n                if (!row.cells[parseInt(i.toString(), 10)].isSpanned) {\n                    tr.appendChild(td);\n                }\n            }\n        };\n        var this_1 = this;\n        for (var i = 0, len = row.cells.length; i < len; i++) {\n            _loop_2(i, len);\n        }\n        var emptyColspan = 0;\n        if (this.parent.groupSettings.columns.length && this.parent.getFrozenLeftColumnsCount()) {\n            if (tr.classList.contains('e-groupcaptionrow')) {\n                var freezeCells = [].slice.call(tr.querySelectorAll('.e-leftfreeze,.e-unfreeze,.e-rightfreeze,.e-fixedfreeze,.e-freezerightborder,.e-freezeleftborder'));\n                if (freezeCells.length) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)(freezeCells, ['e-leftfreeze', 'e-unfreeze', 'e-rightfreeze', 'e-fixedfreeze', 'e-freezerightborder', 'e-freezeleftborder']);\n                }\n                if (tr.querySelector('.e-summarycell')) {\n                    (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.groupCaptionRowLeftRightPos)(tr, this.parent);\n                }\n                else {\n                    for (var j = 0; j < tr.childNodes.length; j++) {\n                        var td = tr.childNodes[parseInt(j.toString(), 10)];\n                        td.classList.add('e-leftfreeze');\n                        (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.applyStickyLeftRightPosition)(td, j * 30, this.parent.enableRtl, 'Left');\n                        if (td.classList.contains('e-groupcaption')) {\n                            var oldColspan = parseInt(td.getAttribute('colspan'), 10);\n                            var colspan = (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.resetColspanGroupCaption)(this.parent, j);\n                            td.setAttribute('colspan', colspan.toString());\n                            emptyColspan = oldColspan - colspan;\n                        }\n                    }\n                    if (emptyColspan) {\n                        var td = this.parent.createElement('TD', {\n                            className: 'e-groupcaption',\n                            attrs: { colspan: emptyColspan.toString(), id: this.parent.element.id + 'captioncell', tabindex: '-1' }\n                        });\n                        tr.appendChild(td);\n                    }\n                }\n            }\n            if ((tr.querySelectorAll('.e-leftfreeze').length || tr.classList.contains('e-columnheader')) &&\n                (tr.querySelectorAll('.e-indentcell').length || tr.querySelectorAll('.e-grouptopleftcell').length)) {\n                var td = tr.querySelectorAll('.e-indentcell, .e-grouptopleftcell');\n                for (var i = 0; i < td.length; i++) {\n                    td[parseInt(i.toString(), 10)].classList.add('e-leftfreeze');\n                    (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.applyStickyLeftRightPosition)(td[parseInt(i.toString(), 10)], i * 30, this.parent.enableRtl, 'Left');\n                }\n            }\n        }\n        var args = { row: tr, rowHeight: this.parent.rowHeight };\n        if (row.isDataRow) {\n            var eventArg_1 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(rowArgs, args);\n            eventArg_1.isSelectable = true;\n            var isReactChild = this.parent.parentDetails && this.parent.parentDetails.parentInstObj &&\n                this.parent.parentDetails.parentInstObj.isReact;\n            var cellTemplate = eventArg_1.row.querySelectorAll('.e-templatecell');\n            if (((this.parent.isReact && this.parent.requireTemplateRef) || (isReactChild &&\n                this.parent.parentDetails.parentInstObj.requireTemplateRef)) && cellTemplate.length) {\n                // eslint-disable-next-line @typescript-eslint/no-this-alias\n                var thisRef_2 = this;\n                thisRef_2.parent.renderTemplates(function () {\n                    thisRef_2.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowDataBound, eventArg_1);\n                    if (!eventArg_1.isSelectable) {\n                        row.isSelectable = eventArg_1.isSelectable;\n                        thisRef_2.disableRowSelection(thisRef_2, row, args, eventArg_1);\n                    }\n                });\n            }\n            else {\n                this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_3__.rowDataBound, eventArg_1);\n            }\n            row.isSelectable = eventArg_1.isSelectable;\n            var isDraggable = this.parent.isRowDragable();\n            if (this.parent.allowPaging && this.parent.selectionSettings.persistSelection) {\n                var primaryKey_1 = this.parent.getPrimaryKeyFieldNames()[0];\n                var pKey_1 = row.data ? row.data[\"\" + primaryKey_1] : null;\n                var SelectedRecords = eventArg_1.isSelectable ? this.parent.partialSelectedRecords :\n                    this.parent.disableSelectedRecords;\n                if (!SelectedRecords.some(function (data) { return data[\"\" + primaryKey_1] === pKey_1; })) {\n                    SelectedRecords.push(row.data);\n                }\n            }\n            if (!eventArg_1.isSelectable) {\n                this.disableRowSelection(this, row, args, eventArg_1);\n            }\n            if (this.parent.childGrid || isDraggable || this.parent.detailTemplate) {\n                var td = tr.querySelectorAll('.e-rowcell:not(.e-hide)')[0];\n                if (td) {\n                    td.classList.add('e-detailrowvisible');\n                }\n            }\n        }\n        if (this.parent.enableVirtualization) {\n            rowArgs.rowHeight = this.parent.rowHeight;\n        }\n        if (rowArgs.rowHeight) {\n            tr.style.height = rowArgs.rowHeight + 'px';\n        }\n        else if (this.parent.rowHeight && (tr.querySelector('.e-headercell') || tr.querySelector('.e-groupcaption'))) {\n            tr.style.height = this.parent.rowHeight + 'px';\n        }\n        if (row.cssClass) {\n            tr.classList.add(row.cssClass);\n        }\n        if (row.lazyLoadCssClass) {\n            tr.classList.add(row.lazyLoadCssClass);\n        }\n        if (this.parent.rowRenderingMode === 'Vertical' && this.parent.allowTextWrap && (this.parent.textWrapSettings.wrapMode === 'Header'\n            || this.parent.textWrapSettings.wrapMode === 'Both')) {\n            tr.classList.add('e-verticalwrap');\n        }\n        var vFTable = this.parent.enableColumnVirtualization;\n        if (!vFTable && this.parent.aggregates.length && this.parent.element.scrollHeight > this.parent.height) {\n            for (var i = 0; i < this.parent.aggregates.length; i++) {\n                var property = 'properties';\n                var column = 'columns';\n                if (this.parent.aggregates[parseInt(i.toString(), 10)][\"\" + property][\"\" + column][0].footerTemplate) {\n                    var summarycell = [].slice.call(tr.getElementsByClassName('e-summarycell'));\n                    if (summarycell.length) {\n                        var lastSummaryCell = (summarycell[summarycell.length - 1]);\n                        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([lastSummaryCell], ['e-lastsummarycell']);\n                        var firstSummaryCell = (summarycell[0]);\n                        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([firstSummaryCell], ['e-firstsummarycell']);\n                    }\n                }\n            }\n        }\n        return tr;\n    };\n    RowRenderer.prototype.resetrowSpanvalue = function (rowCount, cellArgs, rowIndex) {\n        if (rowCount > rowIndex && rowCount < rowIndex + cellArgs.rowSpan) {\n            var rowSpan = (rowIndex + cellArgs.rowSpan) - rowCount;\n            cellArgs.rowSpan = cellArgs.rowSpan - rowSpan;\n        }\n    };\n    RowRenderer.prototype.disableRowSelection = function (thisRef, row, args, eventArg) {\n        var selIndex = this.parent.getSelectedRowIndexes();\n        this.parent.selectionModule.isPartialSelection = true;\n        row.isSelected = false;\n        var selRowIndex = selIndex.indexOf(row.index);\n        if (selRowIndex > -1) {\n            selIndex.splice(selRowIndex, 1);\n        }\n        var chkBox = args.row.querySelectorAll('.e-rowcell.e-gridchkbox');\n        var isDrag = eventArg.row.querySelector('.e-rowdragdrop');\n        var cellIdx = thisRef.parent.groupSettings.columns.length + (isDrag || thisRef.parent.isDetail() ? 1 : 0);\n        for (var i = 0; i < chkBox.length; i++) {\n            chkBox[parseInt(i.toString(), 10)].firstElementChild.classList.add('e-checkbox-disabled');\n            chkBox[parseInt(i.toString(), 10)].querySelector('.e-frame').classList.remove('e-check');\n        }\n        if (row.cells.length) {\n            for (var i = cellIdx; i < row.cells.length; i++) {\n                var cell = eventArg.row.querySelector('.e-rowcell[aria-colindex=\"' + (row.cells[parseInt(i.toString(), 10)].index + 1) + '\"]');\n                if (cell) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([cell], ['e-selectionbackground', 'e-active']);\n                }\n            }\n        }\n        if (isDrag) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([isDrag], ['e-selectionbackground', 'e-active']);\n        }\n    };\n    RowRenderer.prototype.refreshMergeCells = function (row) {\n        for (var _i = 0, _a = row.cells; _i < _a.length; _i++) {\n            var cell = _a[_i];\n            cell.isSpanned = false;\n        }\n        return row;\n    };\n    /* eslint-disable */\n    /**\n     * Function to check and add alternative row css class.\n     *\n     * @param {Element} tr - specifies the tr element\n     * @param {Row<T>} row - specifies the row\n     * @returns {void}\n     */\n    /* eslint-enable */\n    RowRenderer.prototype.buildAttributeFromRow = function (tr, row) {\n        var attr = {};\n        var prop = { 'dataUID': 'data-uid', 'ariaSelected': 'aria-selected' };\n        var classes = [];\n        if (row.isDataRow) {\n            classes.push(_base_string_literals__WEBPACK_IMPORTED_MODULE_5__.row);\n        }\n        if (row.isAltRow) {\n            classes.push('e-altrow');\n        }\n        if (row.isCaptionRow) {\n            classes.push('e-groupcaptionrow');\n        }\n        if (row.isAggregateRow && row.parentUid) {\n            classes.push('e-groupfooterrow');\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row.index)) {\n            attr[_base_string_literals__WEBPACK_IMPORTED_MODULE_5__.ariaRowIndex] = row.index + 1;\n        }\n        if (row.rowSpan) {\n            attr.rowSpan = row.rowSpan;\n        }\n        if (row.uid) {\n            attr[prop.dataUID] = row.uid;\n        }\n        if (row.isSelected) {\n            attr[prop.ariaSelected] = true;\n        }\n        if (row.visible === false) {\n            classes.push('e-hide');\n        }\n        attr.class = classes;\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.setStyleAndAttributes)(tr, attr);\n    };\n    return RowRenderer;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9yb3ctcmVuZGVyZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF3RjtBQUNyQjtBQUNKO0FBQ3lJO0FBQ2hLO0FBQ2dCO0FBQ0o7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxTQUFTLGVBQWU7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFVBQVU7QUFDekIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFNBQVM7QUFDeEIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsVUFBVTtBQUN6QixlQUFlLFNBQVM7QUFDeEIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QiwyREFBZSxHQUFHO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELHVCQUF1QjtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSwwQ0FBMEMscUJBQXFCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix1RUFBaUI7QUFDbkMsd0JBQXdCO0FBQ3hCLHlCQUF5QjtBQUN6Qiw2RUFBNkUsOENBQThDO0FBQzNIO0FBQ0E7QUFDQTtBQUNBO0FB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBcUI7QUFDN0I7QUFDQTtBQUNBLENBQUM7QUFDc0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9yb3ctcmVuZGVyZXIuanM/ZjQ3MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc051bGxPclVuZGVmaW5lZCwgZXh0ZW5kLCBhZGRDbGFzcywgcmVtb3ZlQ2xhc3MgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBhdHRyaWJ1dGVzIGFzIGFkZEF0dHJpYnV0ZXMgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyByb3dEYXRhQm91bmQsIHF1ZXJ5Q2VsbEluZm8gfSBmcm9tICcuLi9iYXNlL2NvbnN0YW50JztcbmltcG9ydCB7IHNldFN0eWxlQW5kQXR0cmlidXRlcywgZ2V0T2JqZWN0LCBleHRlbmRPYmpXaXRoRm4sIGFwcGx5U3RpY2t5TGVmdFJpZ2h0UG9zaXRpb24sIGdyb3VwQ2FwdGlvblJvd0xlZnRSaWdodFBvcywgcmVzZXRDb2xzcGFuR3JvdXBDYXB0aW9uLCByZXNldENvbGFuZFJvd1NwYW5TdGlja3lQb3NpdGlvbiB9IGZyb20gJy4uL2Jhc2UvdXRpbCc7XG5pbXBvcnQgeyBDZWxsVHlwZSB9IGZyb20gJy4uL2Jhc2UvZW51bSc7XG5pbXBvcnQgeyBDZWxsTWVyZ2VSZW5kZXIgfSBmcm9tICcuL2NlbGwtbWVyZ2UtcmVuZGVyZXInO1xuaW1wb3J0ICogYXMgbGl0ZXJhbHMgZnJvbSAnLi4vYmFzZS9zdHJpbmctbGl0ZXJhbHMnO1xuLyoqXG4gKiBSb3dSZW5kZXJlciBjbGFzcyB3aGljaCByZXNwb25zaWJsZSBmb3IgYnVpbGRpbmcgcm93IGNvbnRlbnQuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgUm93UmVuZGVyZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUm93UmVuZGVyZXIoc2VydmljZUxvY2F0b3IsIGNlbGxUeXBlLCBwYXJlbnQpIHtcbiAgICAgICAgdGhpcy5pc1NwYW4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jZWxsVHlwZSA9IGNlbGxUeXBlO1xuICAgICAgICB0aGlzLnNlcnZpY2VMb2NhdG9yID0gc2VydmljZUxvY2F0b3I7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCd0cicsIHsgYXR0cnM6IHsgcm9sZTogJ3JvdycgfSB9KTtcbiAgICB9XG4gICAgLyogZXNsaW50LWRpc2FibGUgKi9cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byByZW5kZXIgdGhlIHJvdyBjb250ZW50IGJhc2VkIG9uIENvbHVtbltdIGFuZCBkYXRhLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtSb3c8VD59IHJvdyAtIHNwZWNpZmllcyB0aGUgcm93XG4gICAgICogQHBhcmFtIHtDb2x1bW5bXX0gY29sdW1ucyAtIHNwZWNpZmllcyB0aGUgY29sdW1uc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhdHRyaWJ1dGVzIC0gc3BlY2lmaWVzIHRoZSBhdHRyaWJ1dGVzXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJvd1RlbXBsYXRlIC0gc3BlY2lmaWVzIHRoZSByb3dUZW1wbGF0ZVxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gY2xvbmVOb2RlIC0gc3BlY2lmaWVzIHRoZSBjbG9uZU5vZGVcbiAgICAgKiBAcmV0dXJucyB7RWxlbWVudH0gcmV0dXJucyB0aGUgZWxlbWVudFxuICAgICAqL1xuICAgIC8qIGVzbGludC1lbmFibGUgKi9cbiAgICBSb3dSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKHJvdywgY29sdW1ucywgYXR0cmlidXRlcywgcm93VGVtcGxhdGUsIGNsb25lTm9kZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWZyZXNoUm93KHJvdywgY29sdW1ucywgYXR0cmlidXRlcywgcm93VGVtcGxhdGUsIGNsb25lTm9kZSk7XG4gICAgfTtcbiAgICAvKiBlc2xpbnQtZGlzYWJsZSAqL1xuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIHJlZnJlc2ggdGhlIHJvdyBjb250ZW50IGJhc2VkIG9uIENvbHVtbltdIGFuZCBkYXRhLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtSb3c8VD59IHJvdyAtIHNwZWNpZmllcyB0aGUgcm93XG4gICAgICogQHBhcmFtIHtDb2x1bW5bXX0gY29sdW1ucyAtIHNwZWNpZmllcyB0aGUgY29sdW1uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0NoYW5nZWQgLSBzcGVjaWZpZXMgaXNDaGFuZ2VkXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGF0dHJpYnV0ZXMgLSBzcGVjaWZpZXMgdGhlIGF0dHJpYnV0ZXNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcm93VGVtcGxhdGUgLSBzcGVjaWZpZXMgdGhlIHJvd1RlbXBsYXRlXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgLyogZXNsaW50LWVuYWJsZSAqL1xuICAgIFJvd1JlbmRlcmVyLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKHJvdywgY29sdW1ucywgaXNDaGFuZ2VkLCBhdHRyaWJ1dGVzLCByb3dUZW1wbGF0ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoaXNDaGFuZ2VkKSB7XG4gICAgICAgICAgICByb3cuZGF0YSA9IGV4dGVuZE9ialdpdGhGbih7fSwgcm93LmNoYW5nZXMpO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoTWVyZ2VDZWxscyhyb3cpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS11aWQ9JyArIHJvdy51aWQgKyAnXScpO1xuICAgICAgICB2YXIgdHIgPSB0aGlzLnJlZnJlc2hSb3cocm93LCBjb2x1bW5zLCBhdHRyaWJ1dGVzLCByb3dUZW1wbGF0ZSwgbnVsbCwgaXNDaGFuZ2VkKTtcbiAgICAgICAgdmFyIGNlbGxzID0gW10uc2xpY2UuY2FsbCh0ci5jZWxscyk7XG4gICAgICAgIHZhciB0ZW1wQ2VsbHMgPSBbXS5zbGljZS5jYWxsKG5vZGUucXVlcnlTZWxlY3RvckFsbCgnLmUtdGVtcGxhdGVjZWxsJykpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNSZWFjdCAmJiB0ZW1wQ2VsbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChjb2wpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29sLnRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LnJlZnJlc2hSZWFjdENvbHVtblRlbXBsYXRlQnlVaWQoY29sLnVpZCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJicmVha1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGNvbHVtbnNfMSA9IGNvbHVtbnM7IF9pIDwgY29sdW1uc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb2x1bW5zXzFbX2ldO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZV8xID0gX2xvb3BfMShjb2wpO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZV8xID09PSBcImJyZWFrXCIpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBhdHRyID0gW10uc2xpY2UuY2FsbCh0ci5hdHRyaWJ1dGVzKTtcbiAgICAgICAgYXR0ci5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGl0ZW1bJ25hbWUnXSwgaXRlbVsndmFsdWUnXSk7XG4gICAgICAgIH0pO1xuICAgICAgICBub2RlLmlubmVySFRNTCA9ICcnO1xuICAgICAgICBmb3IgKHZhciBfYSA9IDAsIGNlbGxzXzEgPSBjZWxsczsgX2EgPCBjZWxsc18xLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgdmFyIGNlbGwgPSBjZWxsc18xW19hXTtcbiAgICAgICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQoY2VsbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtZnVuYy1ib2R5LWxlbmd0aFxuICAgIFJvd1JlbmRlcmVyLnByb3RvdHlwZS5yZWZyZXNoUm93ID0gZnVuY3Rpb24gKHJvdywgY29sdW1ucywgYXR0cmlidXRlcywgcm93VGVtcGxhdGUsIGNsb25lTm9kZSwgaXNFZGl0KSB7XG4gICAgICAgIHZhciB0ciA9ICFpc051bGxPclVuZGVmaW5lZChjbG9uZU5vZGUpID8gY2xvbmVOb2RlIDogdGhpcy5lbGVtZW50LmNsb25lTm9kZSgpO1xuICAgICAgICB2YXIgcm93QXJncyA9IHsgZGF0YTogcm93LmRhdGEgfTtcbiAgICAgICAgdmFyIGNlbGxBcmdzID0geyBkYXRhOiByb3cuZGF0YSB9O1xuICAgICAgICB2YXIgY2hla0JveEVuYWJsZSA9IHRoaXMucGFyZW50LmdldENvbHVtbnMoKS5maWx0ZXIoZnVuY3Rpb24gKGNvbCkgeyByZXR1cm4gY29sLnR5cGUgPT09ICdjaGVja2JveCcgJiYgY29sLmZpZWxkOyB9KVswXTtcbiAgICAgICAgdmFyIHZhbHVlID0gZmFsc2U7XG4gICAgICAgIHZhciBpc0Zyb3plbiA9IHRoaXMucGFyZW50LmlzRnJvemVuR3JpZCgpO1xuICAgICAgICB2YXIgaXNGaXJzdFZpc2libGVDZWxsID0gdHJ1ZTtcbiAgICAgICAgaWYgKGNoZWtCb3hFbmFibGUpIHtcbiAgICAgICAgICAgIHZhbHVlID0gZ2V0T2JqZWN0KGNoZWtCb3hFbmFibGUuZmllbGQsIHJvd0FyZ3MuZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNlbEluZGV4ID0gdGhpcy5wYXJlbnQuZ2V0U2VsZWN0ZWRSb3dJbmRleGVzKCk7XG4gICAgICAgIGlmIChyb3cuaXNEYXRhUm93KSB7XG4gICAgICAgICAgICByb3cuaXNTZWxlY3RlZCA9IHNlbEluZGV4LmluZGV4T2Yocm93LmluZGV4KSA+IC0xIHx8IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyb3cuaXNEYXRhUm93ICYmIHRoaXMucGFyZW50LmlzQ2hlY2tCb3hTZWxlY3Rpb25cbiAgICAgICAgICAgICYmIHRoaXMucGFyZW50LmNoZWNrQWxsUm93cyA9PT0gJ0NoZWNrJyAmJiAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gfHwgdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpKSB7XG4gICAgICAgICAgICByb3cuaXNTZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoc2VsSW5kZXguaW5kZXhPZihyb3cuaW5kZXgpID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHNlbEluZGV4LnB1c2gocm93LmluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmJ1aWxkQXR0cmlidXRlRnJvbVJvdyh0ciwgcm93KTtcbiAgICAgICAgYWRkQXR0cmlidXRlcyh0ciwgZXh0ZW5kKHt9LCBhdHRyaWJ1dGVzLCB7fSkpO1xuICAgICAgICBzZXRTdHlsZUFuZEF0dHJpYnV0ZXModHIsIHJvdy5hdHRyaWJ1dGVzKTtcbiAgICAgICAgdmFyIGNlbGxSZW5kZXJlckZhY3QgPSB0aGlzLnNlcnZpY2VMb2NhdG9yLmdldFNlcnZpY2UoJ2NlbGxSZW5kZXJlckZhY3RvcnknKTtcbiAgICAgICAgdmFyIF9sb29wXzIgPSBmdW5jdGlvbiAoaSwgbGVuKSB7XG4gICAgICAgICAgICB2YXIgY2VsbCA9IHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICBjZWxsLmlzU2VsZWN0ZWQgPSByb3cuaXNTZWxlY3RlZDtcbiAgICAgICAgICAgIGNlbGwuaXNDb2x1bW5TZWxlY3RlZCA9IGNlbGwuY29sdW1uLmlzU2VsZWN0ZWQ7XG4gICAgICAgICAgICB2YXIgY2VsbFJlbmRlcmVyID0gY2VsbFJlbmRlcmVyRmFjdC5nZXRDZWxsUmVuZGVyZXIocm93LmNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxsVHlwZVxuICAgICAgICAgICAgICAgIHx8IENlbGxUeXBlLkRhdGEpO1xuICAgICAgICAgICAgdmFyIGF0dHJzID0geyAnaW5kZXgnOiAhaXNOdWxsT3JVbmRlZmluZWQocm93LmluZGV4KSA/IHJvdy5pbmRleC50b1N0cmluZygpIDogJycgfTtcbiAgICAgICAgICAgIGlmIChyb3cuaXNFeHBhbmQgJiYgcm93LmNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxsVHlwZSA9PT0gQ2VsbFR5cGUuRGV0YWlsRXhwYW5kKSB7XG4gICAgICAgICAgICAgICAgYXR0cnNbJ2NsYXNzJ10gPSB0aGlzXzEucGFyZW50LmlzUHJpbnRpbmcgPyAnZS1kZXRhaWxyb3djb2xsYXBzZScgOiAnZS1kZXRhaWxyb3dleHBhbmQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlzR3JvdXBGaXJzdENlbGwgPSAhdGhpc18xLnBhcmVudC5lbmFibGVSdGwgJiYgdGhpc18xLnBhcmVudC5ncm91cFNldHRpbmdzICYmIGlzRmlyc3RWaXNpYmxlQ2VsbCAmJlxuICAgICAgICAgICAgICAgIHRoaXNfMS5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAmJiAodGhpc18xLnBhcmVudC5ncmlkTGluZXMgPT09ICdWZXJ0aWNhbCcgfHwgdGhpc18xLnBhcmVudC5ncmlkTGluZXMgPT09ICdCb3RoJyk7XG4gICAgICAgICAgICB2YXIgdGQgPSBjZWxsUmVuZGVyZXIucmVuZGVyKHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHJvdy5kYXRhLCBhdHRycywgcm93LmlzRXhwYW5kLCBpc0VkaXQpO1xuICAgICAgICAgICAgaWYgKHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbFR5cGUgIT09IENlbGxUeXBlLkZpbHRlcikge1xuICAgICAgICAgICAgICAgIGlmIChyb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxUeXBlID09PSBDZWxsVHlwZS5EYXRhXG4gICAgICAgICAgICAgICAgICAgIHx8IHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbFR5cGUgPT09IENlbGxUeXBlLkNvbW1hbmRDb2x1bW4pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGwudmlzaWJsZSAmJiBpc0dyb3VwRmlyc3RDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZC5jbGFzc0xpc3QuYWRkKCdlLWdyaWQtZ3JvdXAtZmlyc3QtY2VsbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNGaXJzdFZpc2libGVDZWxsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzUmVhY3RDaGlsZCA9IHRoaXNfMS5wYXJlbnQucGFyZW50RGV0YWlscyAmJiB0aGlzXzEucGFyZW50LnBhcmVudERldGFpbHMucGFyZW50SW5zdE9iaiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc18xLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmouaXNSZWFjdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzUmVhY3RQcmludEdyaWQgPSB0aGlzXzEucGFyZW50LnByaW50R3JpZFBhcmVudCAmJiB0aGlzXzEucGFyZW50LnByaW50R3JpZFBhcmVudC5pc1JlYWN0O1xuICAgICAgICAgICAgICAgICAgICBpZiAoKCh0aGlzXzEucGFyZW50LmlzUmVhY3QgJiYgdGhpc18xLnBhcmVudC5yZXF1aXJlVGVtcGxhdGVSZWYpIHx8IChpc1JlYWN0Q2hpbGQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNfMS5wYXJlbnQucGFyZW50RGV0YWlscy5wYXJlbnRJbnN0T2JqLnJlcXVpcmVUZW1wbGF0ZVJlZikgfHwgKGlzUmVhY3RQcmludEdyaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHRoaXNfMS5wYXJlbnQucHJpbnRHcmlkUGFyZW50LnJlcXVpcmVUZW1wbGF0ZVJlZikpICYmIGNlbGwuaXNUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc1JlZl8xID0gdGhpc18xO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1JlZl8xLnBhcmVudC5yZW5kZXJUZW1wbGF0ZXMoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKGNlbGwuY29sdW1uLnRlbXBsYXRlKSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyaWFBdHRyID0gdGQuZ2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRkLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHRkLmlubmVyVGV4dCArIGFyaWFBdHRyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1JlZl8xLnBhcmVudC50cmlnZ2VyKHF1ZXJ5Q2VsbEluZm8sIGV4dGVuZChjZWxsQXJncywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsOiB0ZCwgY29sdW1uOiBjZWxsLmNvbHVtbiwgY29sU3BhbjogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93U3BhbjogMSwgZm9yZWlnbktleURhdGE6IHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZm9yZWlnbktleURhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RUeXBlOiB0aGlzUmVmXzEucGFyZW50LnJlcXVlc3RUeXBlQWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzXzEucGFyZW50LnRyaWdnZXIocXVlcnlDZWxsSW5mbywgZXh0ZW5kKGNlbGxBcmdzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbDogdGQsIGNvbHVtbjogY2VsbC5jb2x1bW4sIGNvbFNwYW46IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93U3BhbjogMSwgZm9yZWlnbktleURhdGE6IHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZm9yZWlnbktleURhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFR5cGU6IHRoaXNfMS5wYXJlbnQucmVxdWVzdFR5cGVBY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgaXNSb3dTcGFubmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyb3cuaW5kZXggPiAwICYmICh0aGlzXzEuaXNTcGFuIHx8ICh0aGlzXzEucGFyZW50LmlzU3BhbiAmJiBpc0VkaXQpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJvd3NPYmplY3QgPSB0aGlzXzEucGFyZW50LmdldFJvd3NPYmplY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmV2Um93Q2VsbHMgPSB0aGlzXzEucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXJvd3NPYmplY3Rbcm93LmluZGV4IC0gMV0uaXNEYXRhUm93ID8gcm93c09iamVjdFtyb3cuaW5kZXhdLmNlbGxzIDogcm93c09iamVjdFtyb3cuaW5kZXggLSAxXS5jZWxscztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1aWRfMSA9ICd1aWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZSb3dDZWxsID0gcHJldlJvd0NlbGxzLmZpbHRlcihmdW5jdGlvbiAoY2VsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZWxsLmNvbHVtbi51aWQgPT09IHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1uW1wiXCIgKyB1aWRfMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzUm93U3Bhbm5lZCA9IHByZXZSb3dDZWxsLmlzUm93U3Bhbm5lZCA/IHByZXZSb3dDZWxsLmlzUm93U3Bhbm5lZCA6IHByZXZSb3dDZWxsLnJvd1NwYW5SYW5nZSA+IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKChjZWxsQXJncy5yb3dTcGFuID4gMSB8fCBjZWxsQXJncy5jb2xTcGFuID4gMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNfMS5yZXNldHJvd1NwYW52YWx1ZSh0aGlzXzEucGFyZW50LmZyb3plblJvd3MgPiByb3cuaW5kZXggPyB0aGlzXzEucGFyZW50LmZyb3plblJvd3MgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNfMS5wYXJlbnQuY3VycmVudFZpZXdEYXRhLmxlbmd0aCwgY2VsbEFyZ3MsIHJvdy5pbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbEFyZ3MuY29sdW1uLnZpc2libGUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbEFyZ3MuY29sU3BhbiA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNGcm96ZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbHVtbnNfMiA9IHRoaXNfMS5wYXJlbnQuZ2V0Q29sdW1ucygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmlnaHQgPSB0aGlzXzEucGFyZW50LmdldEZyb3plblJpZ2h0Q29sdW1uc0NvdW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZWZ0ID0gdGhpc18xLnBhcmVudC5nZXRGcm96ZW5MZWZ0Q291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vdmFibGVDb3VudCA9IGNvbHVtbnNfMi5sZW5ndGggLSByaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGxJZHggPSBjZWxsQXJncy5jb2x1bW4uaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsZWZ0ID4gY2VsbElkeCAmJiBsZWZ0IDwgKGNlbGxJZHggKyBjZWxsQXJncy5jb2xTcGFuKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbFNwYW4gPSAoY2VsbElkeCArIGNlbGxBcmdzLmNvbFNwYW4pIC0gbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxBcmdzLmNvbFNwYW4gPSBjZWxsQXJncy5jb2xTcGFuIC0gY29sU3BhbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChtb3ZhYmxlQ291bnQgPD0gY2VsbElkeCAmJiBjb2x1bW5zXzIubGVuZ3RoIDwgKGNlbGxJZHggKyBjZWxsQXJncy5jb2xTcGFuKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbFNwYW4gPSAoY2VsbElkeCArIGNlbGxBcmdzLmNvbFNwYW4pIC0gY29sdW1uc18yLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxBcmdzLmNvbFNwYW4gPSBjZWxsQXJncy5jb2xTcGFuIC0gY29sU3BhbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChjZWxsQXJncy5jb2x1bW4uZnJlZXplID09PSAnRml4ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sU3BhbiA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBjZWxsSWR4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IGluZGV4ICsgMTsgaiA8IGluZGV4ICsgY2VsbEFyZ3MuY29sU3BhbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHVtbnNfMltwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnRml4ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbFNwYW4rKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxBcmdzLmNvbFNwYW4gPSBjb2xTcGFuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG1vdmFibGVDb3VudCA+IGNlbGxJZHggJiYgbW92YWJsZUNvdW50IDwgKGNlbGxJZHggKyBjZWxsQXJncy5jb2xTcGFuKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbFNwYW4gPSAoY2VsbElkeCArIGNlbGxBcmdzLmNvbFNwYW4pIC0gbW92YWJsZUNvdW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbEFyZ3MuY29sU3BhbiA9IGNlbGxBcmdzLmNvbFNwYW4gLSBjb2xTcGFuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjZWxsQXJncy5jb2xTcGFuID4gMSB8fCByb3cuY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNlbGxTcGFuID4gMSB8fCBjZWxsQXJncy5yb3dTcGFuID4gMVxuICAgICAgICAgICAgICAgICAgICAgICAgfHwgaXNSb3dTcGFubmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzXzEucGFyZW50LmlzU3BhbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzXzEuaXNTcGFuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjZWxsTWVyZ2UgPSBuZXcgQ2VsbE1lcmdlUmVuZGVyKHRoaXNfMS5zZXJ2aWNlTG9jYXRvciwgdGhpc18xLnBhcmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZCA9IGNlbGxNZXJnZS5yZW5kZXIoY2VsbEFyZ3MsIHJvdywgaSwgdGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzRnJvemVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzZXRDb2xhbmRSb3dTcGFuU3RpY2t5UG9zaXRpb24odGhpc18xLnBhcmVudCwgY2VsbEFyZ3MuY29sdW1uLCB0ZCwgY2VsbEFyZ3MuY29sU3Bhbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKChjZWxsLmNlbGxUeXBlID09PSBDZWxsVHlwZS5IZWFkZXIgfHwgY2VsbC5jZWxsVHlwZSA9PT0gQ2VsbFR5cGUuU3RhY2tlZEhlYWRlcikgJiZcbiAgICAgICAgICAgICAgICAgICAgaXNHcm91cEZpcnN0Q2VsbCAmJiAoY2VsbC52aXNpYmxlIHx8IGNlbGwuY2VsbFR5cGUgPT09IENlbGxUeXBlLlN0YWNrZWRIZWFkZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2aXNpYmxlQ29sdW1ucyA9IHRoaXNfMS5wYXJlbnQuZ2V0VmlzaWJsZUNvbHVtbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gJ2ZpZWxkJztcbiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSAndHlwZSc7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoY2VsbC5jb2x1bW5bXCJcIiArIHR5cGVdICYmIGNlbGwuY29sdW1uW1wiXCIgKyB0eXBlXSA9PT0gJ2NoZWNrYm94JykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIChjZWxsLmNlbGxUeXBlID09PSBDZWxsVHlwZS5IZWFkZXIgJiYgY2VsbC5jb2x1bW5bXCJcIiArIGZpZWxkXSAmJiB2aXNpYmxlQ29sdW1ucy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlQ29sdW1uc1swXS5maWVsZCA9PT0gY2VsbC5jb2x1bW5bXCJcIiArIGZpZWxkXSkgfHwgY2VsbC5jZWxsVHlwZSA9PT0gQ2VsbFR5cGUuU3RhY2tlZEhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZCgnZS1ncmlkLWdyb3VwLWZpcnN0LWNlbGwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRmlyc3RWaXNpYmxlQ2VsbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjZWxsLmNlbGxUeXBlID09PSBDZWxsVHlwZS5IZWFkZXIgJiYgKHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sU3BhbiA+IDEgfHxcbiAgICAgICAgICAgICAgICAgICAgcm93LmNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5yb3dTcGFuID4gMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGxNZXJnZSA9IG5ldyBDZWxsTWVyZ2VSZW5kZXIodGhpc18xLnNlcnZpY2VMb2NhdG9yLCB0aGlzXzEucGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgdGQgPSBjZWxsTWVyZ2UucmVuZGVyKHJvdy5jZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHJvdywgaSwgdGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpc18xLmlzU3Bhbikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm93c09iamVjdCA9IHRoaXNfMS5wYXJlbnQuZ2V0Um93c09iamVjdCgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNSdGwgPSB0aGlzXzEucGFyZW50LmVuYWJsZVJ0bDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd3NPYmplY3Rbcm93LmluZGV4IC0gMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmV2Um93Q2VsbHMgPSByb3dzT2JqZWN0W3Jvdy5pbmRleCAtIDFdLmNlbGxzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZSb3dDZWxsID0gcHJldlJvd0NlbGxzW2kgLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Um93Q2VsbCA9IHByZXZSb3dDZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dFJvd0NlbGwgPSBwcmV2Um93Q2VsbHNbaSArIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IHByZXZSb3dDZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY29sdW1uLmZyZWV6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2Um93Q2VsbCAmJiAocHJldlJvd0NlbGwuaXNSb3dTcGFubmVkIHx8IHByZXZSb3dDZWxsLnJvd1NwYW5SYW5nZSA+IDEpICYmIHByZXZSb3dDZWxsLnZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzUnRsICYmICghY3VycmVudFJvd0NlbGwuaXNSb3dTcGFubmVkIHx8IHByZXZSb3dDZWxsLnJvd1NwYW5SYW5nZSA+IGN1cnJlbnRSb3dDZWxsLnJvd1NwYW5SYW5nZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZCgnZS1yb3djZWxsLWZpcnN0Y2hpbGQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzRnJvemVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcmV2Um93Q2VsbC5jb2x1bW4uZnJlZXplID09PSAnRml4ZWQnICYmIGRpcmVjdGlvbiA9PT0gJ0ZpeGVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZChpc1J0bCA/ICdlLXJlbW92ZWZyZWV6ZXJpZ2h0Ym9yZGVyJyA6ICdlLXJlbW92ZWZyZWV6ZWxlZnRib3JkZXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghaXNSdGwgJiYgaSA9PT0gMSAmJiBkaXJlY3Rpb24gPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZCgnZS1hZGRmcmVlemVmaXJzdGNoaWxkYm9yZGVyJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dFJvd0NlbGwgJiYgKG5leHRSb3dDZWxsLmlzUm93U3Bhbm5lZCB8fCBuZXh0Um93Q2VsbC5yb3dTcGFuUmFuZ2UgPiAxKSAmJiBuZXh0Um93Q2VsbC52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzUnRsICYmICghY3VycmVudFJvd0NlbGwuaXNSb3dTcGFubmVkIHx8IG5leHRSb3dDZWxsLnJvd1NwYW5SYW5nZSA+IGN1cnJlbnRSb3dDZWxsLnJvd1NwYW5SYW5nZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZCgnZS1yb3djZWxsLWxhc3RjaGlsZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNGcm96ZW4gJiYgbmV4dFJvd0NlbGwuY29sdW1uLmZyZWV6ZSA9PT0gJ0ZpeGVkJyAmJiBkaXJlY3Rpb24gPT09ICdGaXhlZCcgJiYgY2VsbEFyZ3MuY29sU3BhbiA8IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZChpc1J0bCA/ICdlLXJlbW92ZWZyZWV6ZWxlZnRib3JkZXInIDogJ2UtcmVtb3ZlZnJlZXplcmlnaHRib3JkZXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNlbGxBcmdzLnJvd1NwYW4gPiAxICYmIHRoaXNfMS5wYXJlbnQuY3VycmVudFZpZXdEYXRhLmxlbmd0aCAtIHJvdy5pbmRleCA9PT0gY2VsbEFyZ3Mucm93U3Bhbikge1xuICAgICAgICAgICAgICAgICAgICB0ZC5jbGFzc0xpc3QuYWRkKCdlLXJvdy1zcGFuLWxhc3Ryb3djZWxsJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghcm93LmNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc1NwYW5uZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdHIuYXBwZW5kQ2hpbGQodGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRoaXNfMSA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByb3cuY2VsbHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIF9sb29wXzIoaSwgbGVuKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZW1wdHlDb2xzcGFuID0gMDtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiYgdGhpcy5wYXJlbnQuZ2V0RnJvemVuTGVmdENvbHVtbnNDb3VudCgpKSB7XG4gICAgICAgICAgICBpZiAodHIuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWdyb3VwY2FwdGlvbnJvdycpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyZWV6ZUNlbGxzID0gW10uc2xpY2UuY2FsbCh0ci5xdWVyeVNlbGVjdG9yQWxsKCcuZS1sZWZ0ZnJlZXplLC5lLXVuZnJlZXplLC5lLXJpZ2h0ZnJlZXplLC5lLWZpeGVkZnJlZXplLC5lLWZyZWV6ZXJpZ2h0Ym9yZGVyLC5lLWZyZWV6ZWxlZnRib3JkZXInKSk7XG4gICAgICAgICAgICAgICAgaWYgKGZyZWV6ZUNlbGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhmcmVlemVDZWxscywgWydlLWxlZnRmcmVlemUnLCAnZS11bmZyZWV6ZScsICdlLXJpZ2h0ZnJlZXplJywgJ2UtZml4ZWRmcmVlemUnLCAnZS1mcmVlemVyaWdodGJvcmRlcicsICdlLWZyZWV6ZWxlZnRib3JkZXInXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0ci5xdWVyeVNlbGVjdG9yKCcuZS1zdW1tYXJ5Y2VsbCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwQ2FwdGlvblJvd0xlZnRSaWdodFBvcyh0ciwgdGhpcy5wYXJlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0ci5jaGlsZE5vZGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGQgPSB0ci5jaGlsZE5vZGVzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRkLmNsYXNzTGlzdC5hZGQoJ2UtbGVmdGZyZWV6ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXBwbHlTdGlja3lMZWZ0UmlnaHRQb3NpdGlvbih0ZCwgaiAqIDMwLCB0aGlzLnBhcmVudC5lbmFibGVSdGwsICdMZWZ0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWdyb3VwY2FwdGlvbicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9sZENvbHNwYW4gPSBwYXJzZUludCh0ZC5nZXRBdHRyaWJ1dGUoJ2NvbHNwYW4nKSwgMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xzcGFuID0gcmVzZXRDb2xzcGFuR3JvdXBDYXB0aW9uKHRoaXMucGFyZW50LCBqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZC5zZXRBdHRyaWJ1dGUoJ2NvbHNwYW4nLCBjb2xzcGFuLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtcHR5Q29sc3BhbiA9IG9sZENvbHNwYW4gLSBjb2xzcGFuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbXB0eUNvbHNwYW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZCA9IHRoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ1REJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UtZ3JvdXBjYXB0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyczogeyBjb2xzcGFuOiBlbXB0eUNvbHNwYW4udG9TdHJpbmcoKSwgaWQ6IHRoaXMucGFyZW50LmVsZW1lbnQuaWQgKyAnY2FwdGlvbmNlbGwnLCB0YWJpbmRleDogJy0xJyB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyLmFwcGVuZENoaWxkKHRkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgodHIucXVlcnlTZWxlY3RvckFsbCgnLmUtbGVmdGZyZWV6ZScpLmxlbmd0aCB8fCB0ci5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY29sdW1uaGVhZGVyJykpICYmXG4gICAgICAgICAgICAgICAgKHRyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLWluZGVudGNlbGwnKS5sZW5ndGggfHwgdHIucXVlcnlTZWxlY3RvckFsbCgnLmUtZ3JvdXB0b3BsZWZ0Y2VsbCcpLmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGQgPSB0ci5xdWVyeVNlbGVjdG9yQWxsKCcuZS1pbmRlbnRjZWxsLCAuZS1ncm91cHRvcGxlZnRjZWxsJyk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB0ZFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmFkZCgnZS1sZWZ0ZnJlZXplJyk7XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5U3RpY2t5TGVmdFJpZ2h0UG9zaXRpb24odGRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBpICogMzAsIHRoaXMucGFyZW50LmVuYWJsZVJ0bCwgJ0xlZnQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFyZ3MgPSB7IHJvdzogdHIsIHJvd0hlaWdodDogdGhpcy5wYXJlbnQucm93SGVpZ2h0IH07XG4gICAgICAgIGlmIChyb3cuaXNEYXRhUm93KSB7XG4gICAgICAgICAgICB2YXIgZXZlbnRBcmdfMSA9IGV4dGVuZChyb3dBcmdzLCBhcmdzKTtcbiAgICAgICAgICAgIGV2ZW50QXJnXzEuaXNTZWxlY3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBpc1JlYWN0Q2hpbGQgPSB0aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzICYmIHRoaXMucGFyZW50LnBhcmVudERldGFpbHMucGFyZW50SW5zdE9iaiAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnBhcmVudERldGFpbHMucGFyZW50SW5zdE9iai5pc1JlYWN0O1xuICAgICAgICAgICAgdmFyIGNlbGxUZW1wbGF0ZSA9IGV2ZW50QXJnXzEucm93LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXRlbXBsYXRlY2VsbCcpO1xuICAgICAgICAgICAgaWYgKCgodGhpcy5wYXJlbnQuaXNSZWFjdCAmJiB0aGlzLnBhcmVudC5yZXF1aXJlVGVtcGxhdGVSZWYpIHx8IChpc1JlYWN0Q2hpbGQgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5wYXJlbnREZXRhaWxzLnBhcmVudEluc3RPYmoucmVxdWlyZVRlbXBsYXRlUmVmKSkgJiYgY2VsbFRlbXBsYXRlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhc1xuICAgICAgICAgICAgICAgIHZhciB0aGlzUmVmXzIgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXNSZWZfMi5wYXJlbnQucmVuZGVyVGVtcGxhdGVzKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1JlZl8yLnBhcmVudC50cmlnZ2VyKHJvd0RhdGFCb3VuZCwgZXZlbnRBcmdfMSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZXZlbnRBcmdfMS5pc1NlbGVjdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5pc1NlbGVjdGFibGUgPSBldmVudEFyZ18xLmlzU2VsZWN0YWJsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNSZWZfMi5kaXNhYmxlUm93U2VsZWN0aW9uKHRoaXNSZWZfMiwgcm93LCBhcmdzLCBldmVudEFyZ18xKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQudHJpZ2dlcihyb3dEYXRhQm91bmQsIGV2ZW50QXJnXzEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcm93LmlzU2VsZWN0YWJsZSA9IGV2ZW50QXJnXzEuaXNTZWxlY3RhYmxlO1xuICAgICAgICAgICAgdmFyIGlzRHJhZ2dhYmxlID0gdGhpcy5wYXJlbnQuaXNSb3dEcmFnYWJsZSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93UGFnaW5nICYmIHRoaXMucGFyZW50LnNlbGVjdGlvblNldHRpbmdzLnBlcnNpc3RTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJpbWFyeUtleV8xID0gdGhpcy5wYXJlbnQuZ2V0UHJpbWFyeUtleUZpZWxkTmFtZXMoKVswXTtcbiAgICAgICAgICAgICAgICB2YXIgcEtleV8xID0gcm93LmRhdGEgPyByb3cuZGF0YVtcIlwiICsgcHJpbWFyeUtleV8xXSA6IG51bGw7XG4gICAgICAgICAgICAgICAgdmFyIFNlbGVjdGVkUmVjb3JkcyA9IGV2ZW50QXJnXzEuaXNTZWxlY3RhYmxlID8gdGhpcy5wYXJlbnQucGFydGlhbFNlbGVjdGVkUmVjb3JkcyA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmRpc2FibGVTZWxlY3RlZFJlY29yZHM7XG4gICAgICAgICAgICAgICAgaWYgKCFTZWxlY3RlZFJlY29yZHMuc29tZShmdW5jdGlvbiAoZGF0YSkgeyByZXR1cm4gZGF0YVtcIlwiICsgcHJpbWFyeUtleV8xXSA9PT0gcEtleV8xOyB9KSkge1xuICAgICAgICAgICAgICAgICAgICBTZWxlY3RlZFJlY29yZHMucHVzaChyb3cuZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFldmVudEFyZ18xLmlzU2VsZWN0YWJsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZVJvd1NlbGVjdGlvbih0aGlzLCByb3csIGFyZ3MsIGV2ZW50QXJnXzEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmNoaWxkR3JpZCB8fCBpc0RyYWdnYWJsZSB8fCB0aGlzLnBhcmVudC5kZXRhaWxUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0ZCA9IHRyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXJvd2NlbGw6bm90KC5lLWhpZGUpJylbMF07XG4gICAgICAgICAgICAgICAgaWYgKHRkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRkLmNsYXNzTGlzdC5hZGQoJ2UtZGV0YWlscm93dmlzaWJsZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgIHJvd0FyZ3Mucm93SGVpZ2h0ID0gdGhpcy5wYXJlbnQucm93SGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChyb3dBcmdzLnJvd0hlaWdodCkge1xuICAgICAgICAgICAgdHIuc3R5bGUuaGVpZ2h0ID0gcm93QXJncy5yb3dIZWlnaHQgKyAncHgnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMucGFyZW50LnJvd0hlaWdodCAmJiAodHIucXVlcnlTZWxlY3RvcignLmUtaGVhZGVyY2VsbCcpIHx8IHRyLnF1ZXJ5U2VsZWN0b3IoJy5lLWdyb3VwY2FwdGlvbicpKSkge1xuICAgICAgICAgICAgdHIuc3R5bGUuaGVpZ2h0ID0gdGhpcy5wYXJlbnQucm93SGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgfVxuICAgICAgICBpZiAocm93LmNzc0NsYXNzKSB7XG4gICAgICAgICAgICB0ci5jbGFzc0xpc3QuYWRkKHJvdy5jc3NDbGFzcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdy5sYXp5TG9hZENzc0NsYXNzKSB7XG4gICAgICAgICAgICB0ci5jbGFzc0xpc3QuYWRkKHJvdy5sYXp5TG9hZENzc0NsYXNzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQucm93UmVuZGVyaW5nTW9kZSA9PT0gJ1ZlcnRpY2FsJyAmJiB0aGlzLnBhcmVudC5hbGxvd1RleHRXcmFwICYmICh0aGlzLnBhcmVudC50ZXh0V3JhcFNldHRpbmdzLndyYXBNb2RlID09PSAnSGVhZGVyJ1xuICAgICAgICAgICAgfHwgdGhpcy5wYXJlbnQudGV4dFdyYXBTZXR0aW5ncy53cmFwTW9kZSA9PT0gJ0JvdGgnKSkge1xuICAgICAgICAgICAgdHIuY2xhc3NMaXN0LmFkZCgnZS12ZXJ0aWNhbHdyYXAnKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdkZUYWJsZSA9IHRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uO1xuICAgICAgICBpZiAoIXZGVGFibGUgJiYgdGhpcy5wYXJlbnQuYWdncmVnYXRlcy5sZW5ndGggJiYgdGhpcy5wYXJlbnQuZWxlbWVudC5zY3JvbGxIZWlnaHQgPiB0aGlzLnBhcmVudC5oZWlnaHQpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wYXJlbnQuYWdncmVnYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9ICdwcm9wZXJ0aWVzJztcbiAgICAgICAgICAgICAgICB2YXIgY29sdW1uID0gJ2NvbHVtbnMnO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5hZ2dyZWdhdGVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXVtcIlwiICsgcHJvcGVydHldW1wiXCIgKyBjb2x1bW5dWzBdLmZvb3RlclRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdW1tYXJ5Y2VsbCA9IFtdLnNsaWNlLmNhbGwodHIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1zdW1tYXJ5Y2VsbCcpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1bW1hcnljZWxsLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RTdW1tYXJ5Q2VsbCA9IChzdW1tYXJ5Y2VsbFtzdW1tYXJ5Y2VsbC5sZW5ndGggLSAxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhbbGFzdFN1bW1hcnlDZWxsXSwgWydlLWxhc3RzdW1tYXJ5Y2VsbCddKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaXJzdFN1bW1hcnlDZWxsID0gKHN1bW1hcnljZWxsWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZENsYXNzKFtmaXJzdFN1bW1hcnlDZWxsXSwgWydlLWZpcnN0c3VtbWFyeWNlbGwnXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRyO1xuICAgIH07XG4gICAgUm93UmVuZGVyZXIucHJvdG90eXBlLnJlc2V0cm93U3BhbnZhbHVlID0gZnVuY3Rpb24gKHJvd0NvdW50LCBjZWxsQXJncywgcm93SW5kZXgpIHtcbiAgICAgICAgaWYgKHJvd0NvdW50ID4gcm93SW5kZXggJiYgcm93Q291bnQgPCByb3dJbmRleCArIGNlbGxBcmdzLnJvd1NwYW4pIHtcbiAgICAgICAgICAgIHZhciByb3dTcGFuID0gKHJvd0luZGV4ICsgY2VsbEFyZ3Mucm93U3BhbikgLSByb3dDb3VudDtcbiAgICAgICAgICAgIGNlbGxBcmdzLnJvd1NwYW4gPSBjZWxsQXJncy5yb3dTcGFuIC0gcm93U3BhbjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUm93UmVuZGVyZXIucHJvdG90eXBlLmRpc2FibGVSb3dTZWxlY3Rpb24gPSBmdW5jdGlvbiAodGhpc1JlZiwgcm93LCBhcmdzLCBldmVudEFyZykge1xuICAgICAgICB2YXIgc2VsSW5kZXggPSB0aGlzLnBhcmVudC5nZXRTZWxlY3RlZFJvd0luZGV4ZXMoKTtcbiAgICAgICAgdGhpcy5wYXJlbnQuc2VsZWN0aW9uTW9kdWxlLmlzUGFydGlhbFNlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgIHJvdy5pc1NlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgIHZhciBzZWxSb3dJbmRleCA9IHNlbEluZGV4LmluZGV4T2Yocm93LmluZGV4KTtcbiAgICAgICAgaWYgKHNlbFJvd0luZGV4ID4gLTEpIHtcbiAgICAgICAgICAgIHNlbEluZGV4LnNwbGljZShzZWxSb3dJbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoa0JveCA9IGFyZ3Mucm93LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXJvd2NlbGwuZS1ncmlkY2hrYm94Jyk7XG4gICAgICAgIHZhciBpc0RyYWcgPSBldmVudEFyZy5yb3cucXVlcnlTZWxlY3RvcignLmUtcm93ZHJhZ2Ryb3AnKTtcbiAgICAgICAgdmFyIGNlbGxJZHggPSB0aGlzUmVmLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICsgKGlzRHJhZyB8fCB0aGlzUmVmLnBhcmVudC5pc0RldGFpbCgpID8gMSA6IDApO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoa0JveC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY2hrQm94W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maXJzdEVsZW1lbnRDaGlsZC5jbGFzc0xpc3QuYWRkKCdlLWNoZWNrYm94LWRpc2FibGVkJyk7XG4gICAgICAgICAgICBjaGtCb3hbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnF1ZXJ5U2VsZWN0b3IoJy5lLWZyYW1lJykuY2xhc3NMaXN0LnJlbW92ZSgnZS1jaGVjaycpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyb3cuY2VsbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gY2VsbElkeDsgaSA8IHJvdy5jZWxscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjZWxsID0gZXZlbnRBcmcucm93LnF1ZXJ5U2VsZWN0b3IoJy5lLXJvd2NlbGxbYXJpYS1jb2xpbmRleD1cIicgKyAocm93LmNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRleCArIDEpICsgJ1wiXScpO1xuICAgICAgICAgICAgICAgIGlmIChjZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKFtjZWxsXSwgWydlLXNlbGVjdGlvbmJhY2tncm91bmQnLCAnZS1hY3RpdmUnXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpc0RyYWcpIHtcbiAgICAgICAgICAgIHJlbW92ZUNsYXNzKFtpc0RyYWddLCBbJ2Utc2VsZWN0aW9uYmFja2dyb3VuZCcsICdlLWFjdGl2ZSddKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUm93UmVuZGVyZXIucHJvdG90eXBlLnJlZnJlc2hNZXJnZUNlbGxzID0gZnVuY3Rpb24gKHJvdykge1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gcm93LmNlbGxzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGNlbGwgPSBfYVtfaV07XG4gICAgICAgICAgICBjZWxsLmlzU3Bhbm5lZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByb3c7XG4gICAgfTtcbiAgICAvKiBlc2xpbnQtZGlzYWJsZSAqL1xuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRvIGNoZWNrIGFuZCBhZGQgYWx0ZXJuYXRpdmUgcm93IGNzcyBjbGFzcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdHIgLSBzcGVjaWZpZXMgdGhlIHRyIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge1JvdzxUPn0gcm93IC0gc3BlY2lmaWVzIHRoZSByb3dcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICAvKiBlc2xpbnQtZW5hYmxlICovXG4gICAgUm93UmVuZGVyZXIucHJvdG90eXBlLmJ1aWxkQXR0cmlidXRlRnJvbVJvdyA9IGZ1bmN0aW9uICh0ciwgcm93KSB7XG4gICAgICAgIHZhciBhdHRyID0ge307XG4gICAgICAgIHZhciBwcm9wID0geyAnZGF0YVVJRCc6ICdkYXRhLXVpZCcsICdhcmlhU2VsZWN0ZWQnOiAnYXJpYS1zZWxlY3RlZCcgfTtcbiAgICAgICAgdmFyIGNsYXNzZXMgPSBbXTtcbiAgICAgICAgaWYgKHJvdy5pc0RhdGFSb3cpIHtcbiAgICAgICAgICAgIGNsYXNzZXMucHVzaChsaXRlcmFscy5yb3cpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyb3cuaXNBbHRSb3cpIHtcbiAgICAgICAgICAgIGNsYXNzZXMucHVzaCgnZS1hbHRyb3cnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm93LmlzQ2FwdGlvblJvdykge1xuICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCdlLWdyb3VwY2FwdGlvbnJvdycpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyb3cuaXNBZ2dyZWdhdGVSb3cgJiYgcm93LnBhcmVudFVpZCkge1xuICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCdlLWdyb3VwZm9vdGVycm93Jyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChyb3cuaW5kZXgpKSB7XG4gICAgICAgICAgICBhdHRyW2xpdGVyYWxzLmFyaWFSb3dJbmRleF0gPSByb3cuaW5kZXggKyAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyb3cucm93U3Bhbikge1xuICAgICAgICAgICAgYXR0ci5yb3dTcGFuID0gcm93LnJvd1NwYW47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdy51aWQpIHtcbiAgICAgICAgICAgIGF0dHJbcHJvcC5kYXRhVUlEXSA9IHJvdy51aWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdy5pc1NlbGVjdGVkKSB7XG4gICAgICAgICAgICBhdHRyW3Byb3AuYXJpYVNlbGVjdGVkXSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdy52aXNpYmxlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCdlLWhpZGUnKTtcbiAgICAgICAgfVxuICAgICAgICBhdHRyLmNsYXNzID0gY2xhc3NlcztcbiAgICAgICAgc2V0U3R5bGVBbmRBdHRyaWJ1dGVzKHRyLCBhdHRyKTtcbiAgICB9O1xuICAgIHJldHVybiBSb3dSZW5kZXJlcjtcbn0oKSk7XG5leHBvcnQgeyBSb3dSZW5kZXJlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/row-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/stacked-cell-renderer.js":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/stacked-cell-renderer.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StackedHeaderCellRenderer: () => (/* binding */ StackedHeaderCellRenderer)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _cell_renderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cell-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/cell-renderer.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n/**\n * StackedHeaderCellRenderer class which responsible for building stacked header cell content.\n *\n * @hidden\n */\nvar StackedHeaderCellRenderer = /** @class */ (function (_super) {\n    __extends(StackedHeaderCellRenderer, _super);\n    function StackedHeaderCellRenderer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.element = _this.parent.createElement('TH', {\n            className: 'e-headercell e-stackedheadercell', attrs: {\n                tabindex: '-1', role: 'columnheader'\n            }\n        });\n        return _this;\n    }\n    /**\n     * Function to render the cell content based on Column object.\n     *\n     * @param {Cell<Column>} cell - specifies the cell\n     * @param {Object} data - specifies the data\n     * @param {object} attributes - specifies the attributes\n     * @returns {Element} returns the element\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    StackedHeaderCellRenderer.prototype.render = function (cell, data, attributes) {\n        var node = this.element.cloneNode();\n        var div = this.parent.createElement('div', {\n            className: 'e-stackedheadercelldiv',\n            attrs: { 'e-mappinguid': cell.column.uid }\n        });\n        var column = cell.column;\n        node.appendChild(div);\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.headerTemplate)) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.appendChildren)(div, column.getHeaderTemplate()(column, this.parent, 'headerTemplate', null, null, null, null, this.parent.root));\n        }\n        else {\n            this.appendHtml(div, this.parent.sanitize(column.headerText), column.getDomSetter());\n        }\n        if (cell.column.toolTip) {\n            node.setAttribute('title', cell.column.toolTip);\n        }\n        if (column.clipMode === 'Clip' || (!column.clipMode && this.parent.clipMode === 'Clip')) {\n            node.classList.add('e-gridclip');\n        }\n        else if (column.clipMode === 'EllipsisWithTooltip' || (!column.clipMode && this.parent.clipMode === 'EllipsisWithTooltip')) {\n            node.classList.add('e-ellipsistooltip');\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell.column.textAlign)) {\n            var alignmentClassMap = { right: 'e-rightalign', left: 'e-leftalign', center: 'e-centeralign', justify: 'e-justifyalign' };\n            if (alignmentClassMap[cell.column.textAlign.toLowerCase()]) {\n                node.classList.add(alignmentClassMap[cell.column.textAlign.toLowerCase()]);\n            }\n        }\n        if (cell.column.customAttributes) {\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.setStyleAndAttributes)(node, cell.column.customAttributes);\n        }\n        node.setAttribute('colspan', cell.colSpan.toString());\n        node.setAttribute('aria-colspan', cell.colSpan.toString());\n        node.setAttribute('aria-rowspan', '1');\n        if (this.parent.allowResizing) {\n            var handler = this.parent.createElement('div');\n            handler.className = cell.column.allowResizing ? 'e-rhandler e-rcursor' : 'e-rsuppress';\n            node.appendChild(handler);\n        }\n        if (cell.className) {\n            node.classList.add(cell.className);\n        }\n        this.parent.trigger(_base_constant__WEBPACK_IMPORTED_MODULE_2__.headerCellInfo, { cell: cell, node: node });\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_1__.frozenDirection)(column) === 'Left') {\n            node.classList.add('e-leftfreeze');\n            if (column.border === 'Left') {\n                node.classList.add('e-freezeleftborder');\n            }\n            if (column.index === 0) {\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.applyStickyLeftRightPosition)(node, (this.parent.getIndentCount() * 30), this.parent.enableRtl, 'Left');\n            }\n            else {\n                var cols = this.parent.getColumns();\n                var width = this.parent.getIndentCount() * 30;\n                for (var i = 0; i < cols.length; i++) {\n                    if (column.index < cols[parseInt(i.toString(), 10)].index) {\n                        break;\n                    }\n                    if (cols[parseInt(i.toString(), 10)].visible) {\n                        width += parseFloat(cols[parseInt(i.toString(), 10)].width.toString());\n                    }\n                }\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.applyStickyLeftRightPosition)(node, width, this.parent.enableRtl, 'Left');\n            }\n        }\n        else if ((0,_base_util__WEBPACK_IMPORTED_MODULE_1__.frozenDirection)(column) === 'Right') {\n            node.classList.add('e-rightfreeze');\n            var cols = this.parent.getColumns();\n            var width = this.parent.getFrozenMode() === 'Right' && this.parent.isRowDragable() ? 30 : 0;\n            for (var i = cols.length - 1; i >= 0; i--) {\n                if ((0,_base_util__WEBPACK_IMPORTED_MODULE_1__.isChildColumn)(column, cols[parseInt(i.toString(), 10)].uid) || column.index > cols[parseInt(i.toString(), 10)].index) {\n                    break;\n                }\n                if (cols[parseInt(i.toString(), 10)].visible) {\n                    width += parseFloat(cols[parseInt(i.toString(), 10)].width.toString());\n                }\n            }\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.applyStickyLeftRightPosition)(node, width, this.parent.enableRtl, 'Right');\n            if (column.border === 'Right') {\n                node.classList.add('e-freezerightborder');\n            }\n        }\n        else if ((0,_base_util__WEBPACK_IMPORTED_MODULE_1__.frozenDirection)(column) === 'Fixed') {\n            node.classList.add('e-fixedfreeze');\n            var cols = this.parent.getColumns();\n            var width = 0;\n            if (this.parent.getVisibleFrozenLeftCount()) {\n                width = this.parent.getIndentCount() * 30;\n            }\n            else if (this.parent.getFrozenMode() === 'Right') {\n                width = this.parent.groupSettings.columns.length * 30;\n            }\n            for (var i = 0; i < cols.length; i++) {\n                if (column.index > cols[parseInt(i.toString(), 10)].index) {\n                    if ((cols[parseInt(i.toString(), 10)].freeze === 'Left' || cols[parseInt(i.toString(), 10)].isFrozen) ||\n                        cols[parseInt(i.toString(), 10)].freeze === 'Fixed') {\n                        if (cols[parseInt(i.toString(), 10)].visible) {\n                            width += parseFloat(cols[parseInt(i.toString(), 10)].width.toString());\n                        }\n                    }\n                }\n            }\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.applyStickyLeftRightPosition)(node, width - 1, this.parent.enableRtl, 'Left');\n            width = this.parent.getFrozenMode() === 'Right' && this.parent.isRowDragable() ? 30 : 0;\n            for (var i = cols.length - 1; i >= 0; i--) {\n                if (column.index < cols[parseInt(i.toString(), 10)].index) {\n                    if ((0,_base_util__WEBPACK_IMPORTED_MODULE_1__.isChildColumn)(column, cols[parseInt(i.toString(), 10)].uid) ||\n                        column.index > cols[parseInt(i.toString(), 10)].index) {\n                        break;\n                    }\n                    if (cols[parseInt(i.toString(), 10)].freeze === 'Right' || cols[parseInt(i.toString(), 10)].freeze === 'Fixed') {\n                        if (cols[parseInt(i.toString(), 10)].visible) {\n                            width += parseFloat(cols[parseInt(i.toString(), 10)].width.toString());\n                        }\n                    }\n                }\n            }\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_1__.applyStickyLeftRightPosition)(node, width - 1, this.parent.enableRtl, 'Right');\n        }\n        else {\n            node.classList.add('e-unfreeze');\n        }\n        return node;\n    };\n    return StackedHeaderCellRenderer;\n}(_cell_renderer__WEBPACK_IMPORTED_MODULE_3__.CellRenderer));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9yZW5kZXJlci9zdGFja2VkLWNlbGwtcmVuZGVyZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ3dEO0FBQ1Y7QUFDRztBQUNpRjtBQUNuSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxjQUFjO0FBQzdCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLFNBQVM7QUFDVDtBQUNBO0FBQ0EsYUFBYSx1RUFBaUI7QUFDOUIsWUFBWSwwREFBYztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsdUVBQWlCO0FBQzlCLHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxpRUFBcUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDBEQUFjLElBQUksd0JBQXdCO0FBQ3RFLFlBQVksMkRBQWU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3RUFBNEI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsaUJBQWlCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHdFQUE0QjtBQUM1QztBQUNBO0FBQ0EsaUJBQWlCLDJEQUFlO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxRQUFRO0FBQ2xELG9CQUFvQix5REFBYTtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdFQUE0QjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwyREFBZTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsaUJBQWlCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0VBQTRCO0FBQ3hDO0FBQ0EsMENBQTBDLFFBQVE7QUFDbEQ7QUFDQSx3QkFBd0IseURBQWE7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdFQUE0QjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyx3REFBWTtBQUN1QiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpX3RyYXZlbC8uL25vZGVfbW9kdWxlcy8ucG5wbS9Ac3luY2Z1c2lvbitlajItZ3JpZHNAMjkuMS40MC9ub2RlX21vZHVsZXMvQHN5bmNmdXNpb24vZWoyLWdyaWRzL3NyYy9ncmlkL3JlbmRlcmVyL3N0YWNrZWQtY2VsbC1yZW5kZXJlci5qcz83MjdmIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBDZWxsUmVuZGVyZXIgfSBmcm9tICcuL2NlbGwtcmVuZGVyZXInO1xuaW1wb3J0IHsgaGVhZGVyQ2VsbEluZm8gfSBmcm9tICcuLi9iYXNlL2NvbnN0YW50JztcbmltcG9ydCB7IHNldFN0eWxlQW5kQXR0cmlidXRlcywgYXBwZW5kQ2hpbGRyZW4sIGZyb3plbkRpcmVjdGlvbiwgaXNDaGlsZENvbHVtbiwgYXBwbHlTdGlja3lMZWZ0UmlnaHRQb3NpdGlvbiB9IGZyb20gJy4uL2Jhc2UvdXRpbCc7XG4vKipcbiAqIFN0YWNrZWRIZWFkZXJDZWxsUmVuZGVyZXIgY2xhc3Mgd2hpY2ggcmVzcG9uc2libGUgZm9yIGJ1aWxkaW5nIHN0YWNrZWQgaGVhZGVyIGNlbGwgY29udGVudC5cbiAqXG4gKiBAaGlkZGVuXG4gKi9cbnZhciBTdGFja2VkSGVhZGVyQ2VsbFJlbmRlcmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdGFja2VkSGVhZGVyQ2VsbFJlbmRlcmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN0YWNrZWRIZWFkZXJDZWxsUmVuZGVyZXIoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5lbGVtZW50ID0gX3RoaXMucGFyZW50LmNyZWF0ZUVsZW1lbnQoJ1RIJywge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiAnZS1oZWFkZXJjZWxsIGUtc3RhY2tlZGhlYWRlcmNlbGwnLCBhdHRyczoge1xuICAgICAgICAgICAgICAgIHRhYmluZGV4OiAnLTEnLCByb2xlOiAnY29sdW1uaGVhZGVyJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0byByZW5kZXIgdGhlIGNlbGwgY29udGVudCBiYXNlZCBvbiBDb2x1bW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtDZWxsPENvbHVtbj59IGNlbGwgLSBzcGVjaWZpZXMgdGhlIGNlbGxcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIHNwZWNpZmllcyB0aGUgZGF0YVxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBhdHRyaWJ1dGVzIC0gc3BlY2lmaWVzIHRoZSBhdHRyaWJ1dGVzXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IHJldHVybnMgdGhlIGVsZW1lbnRcbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgU3RhY2tlZEhlYWRlckNlbGxSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKGNlbGwsIGRhdGEsIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLmVsZW1lbnQuY2xvbmVOb2RlKCk7XG4gICAgICAgIHZhciBkaXYgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICBjbGFzc05hbWU6ICdlLXN0YWNrZWRoZWFkZXJjZWxsZGl2JyxcbiAgICAgICAgICAgIGF0dHJzOiB7ICdlLW1hcHBpbmd1aWQnOiBjZWxsLmNvbHVtbi51aWQgfVxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGNvbHVtbiA9IGNlbGwuY29sdW1uO1xuICAgICAgICBub2RlLmFwcGVuZENoaWxkKGRpdik7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLmhlYWRlclRlbXBsYXRlKSkge1xuICAgICAgICAgICAgYXBwZW5kQ2hpbGRyZW4oZGl2LCBjb2x1bW4uZ2V0SGVhZGVyVGVtcGxhdGUoKShjb2x1bW4sIHRoaXMucGFyZW50LCAnaGVhZGVyVGVtcGxhdGUnLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCB0aGlzLnBhcmVudC5yb290KSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFwcGVuZEh0bWwoZGl2LCB0aGlzLnBhcmVudC5zYW5pdGl6ZShjb2x1bW4uaGVhZGVyVGV4dCksIGNvbHVtbi5nZXREb21TZXR0ZXIoKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlbGwuY29sdW1uLnRvb2xUaXApIHtcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCd0aXRsZScsIGNlbGwuY29sdW1uLnRvb2xUaXApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2x1bW4uY2xpcE1vZGUgPT09ICdDbGlwJyB8fCAoIWNvbHVtbi5jbGlwTW9kZSAmJiB0aGlzLnBhcmVudC5jbGlwTW9kZSA9PT0gJ0NsaXAnKSkge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWdyaWRjbGlwJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29sdW1uLmNsaXBNb2RlID09PSAnRWxsaXBzaXNXaXRoVG9vbHRpcCcgfHwgKCFjb2x1bW4uY2xpcE1vZGUgJiYgdGhpcy5wYXJlbnQuY2xpcE1vZGUgPT09ICdFbGxpcHNpc1dpdGhUb29sdGlwJykpIHtcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnZS1lbGxpcHNpc3Rvb2x0aXAnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGNlbGwuY29sdW1uLnRleHRBbGlnbikpIHtcbiAgICAgICAgICAgIHZhciBhbGlnbm1lbnRDbGFzc01hcCA9IHsgcmlnaHQ6ICdlLXJpZ2h0YWxpZ24nLCBsZWZ0OiAnZS1sZWZ0YWxpZ24nLCBjZW50ZXI6ICdlLWNlbnRlcmFsaWduJywganVzdGlmeTogJ2UtanVzdGlmeWFsaWduJyB9O1xuICAgICAgICAgICAgaWYgKGFsaWdubWVudENsYXNzTWFwW2NlbGwuY29sdW1uLnRleHRBbGlnbi50b0xvd2VyQ2FzZSgpXSkge1xuICAgICAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZChhbGlnbm1lbnRDbGFzc01hcFtjZWxsLmNvbHVtbi50ZXh0QWxpZ24udG9Mb3dlckNhc2UoKV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjZWxsLmNvbHVtbi5jdXN0b21BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBzZXRTdHlsZUFuZEF0dHJpYnV0ZXMobm9kZSwgY2VsbC5jb2x1bW4uY3VzdG9tQXR0cmlidXRlcyk7XG4gICAgICAgIH1cbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoJ2NvbHNwYW4nLCBjZWxsLmNvbFNwYW4udG9TdHJpbmcoKSk7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLWNvbHNwYW4nLCBjZWxsLmNvbFNwYW4udG9TdHJpbmcoKSk7XG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLXJvd3NwYW4nLCAnMScpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dSZXNpemluZykge1xuICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLnBhcmVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGhhbmRsZXIuY2xhc3NOYW1lID0gY2VsbC5jb2x1bW4uYWxsb3dSZXNpemluZyA/ICdlLXJoYW5kbGVyIGUtcmN1cnNvcicgOiAnZS1yc3VwcHJlc3MnO1xuICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChoYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VsbC5jbGFzc05hbWUpIHtcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZChjZWxsLmNsYXNzTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJlbnQudHJpZ2dlcihoZWFkZXJDZWxsSW5mbywgeyBjZWxsOiBjZWxsLCBub2RlOiBub2RlIH0pO1xuICAgICAgICBpZiAoZnJvemVuRGlyZWN0aW9uKGNvbHVtbikgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWxlZnRmcmVlemUnKTtcbiAgICAgICAgICAgIGlmIChjb2x1bW4uYm9yZGVyID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ2UtZnJlZXplbGVmdGJvcmRlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbHVtbi5pbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGFwcGx5U3RpY2t5TGVmdFJpZ2h0UG9zaXRpb24obm9kZSwgKHRoaXMucGFyZW50LmdldEluZGVudENvdW50KCkgKiAzMCksIHRoaXMucGFyZW50LmVuYWJsZVJ0bCwgJ0xlZnQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBjb2xzID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpO1xuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHRoaXMucGFyZW50LmdldEluZGVudENvdW50KCkgKiAzMDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5pbmRleCA8IGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggKz0gcGFyc2VGbG9hdChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS53aWR0aC50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhcHBseVN0aWNreUxlZnRSaWdodFBvc2l0aW9uKG5vZGUsIHdpZHRoLCB0aGlzLnBhcmVudC5lbmFibGVSdGwsICdMZWZ0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZnJvemVuRGlyZWN0aW9uKGNvbHVtbikgPT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnZS1yaWdodGZyZWV6ZScpO1xuICAgICAgICAgICAgdmFyIGNvbHMgPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCk7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSB0aGlzLnBhcmVudC5nZXRGcm96ZW5Nb2RlKCkgPT09ICdSaWdodCcgJiYgdGhpcy5wYXJlbnQuaXNSb3dEcmFnYWJsZSgpID8gMzAgOiAwO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGNvbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNDaGlsZENvbHVtbihjb2x1bW4sIGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnVpZCkgfHwgY29sdW1uLmluZGV4ID4gY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICs9IHBhcnNlRmxvYXQoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ud2lkdGgudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXBwbHlTdGlja3lMZWZ0UmlnaHRQb3NpdGlvbihub2RlLCB3aWR0aCwgdGhpcy5wYXJlbnQuZW5hYmxlUnRsLCAnUmlnaHQnKTtcbiAgICAgICAgICAgIGlmIChjb2x1bW4uYm9yZGVyID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdlLWZyZWV6ZXJpZ2h0Ym9yZGVyJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZnJvemVuRGlyZWN0aW9uKGNvbHVtbikgPT09ICdGaXhlZCcpIHtcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnZS1maXhlZGZyZWV6ZScpO1xuICAgICAgICAgICAgdmFyIGNvbHMgPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCk7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSAwO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmdldFZpc2libGVGcm96ZW5MZWZ0Q291bnQoKSkge1xuICAgICAgICAgICAgICAgIHdpZHRoID0gdGhpcy5wYXJlbnQuZ2V0SW5kZW50Q291bnQoKSAqIDMwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICAgICAgd2lkdGggPSB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICogMzA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uLmluZGV4ID4gY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mcmVlemUgPT09ICdMZWZ0JyB8fCBjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0Zyb3plbikgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmZyZWV6ZSA9PT0gJ0ZpeGVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCArPSBwYXJzZUZsb2F0KGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLndpZHRoLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXBwbHlTdGlja3lMZWZ0UmlnaHRQb3NpdGlvbihub2RlLCB3aWR0aCAtIDEsIHRoaXMucGFyZW50LmVuYWJsZVJ0bCwgJ0xlZnQnKTtcbiAgICAgICAgICAgIHdpZHRoID0gdGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSAnUmlnaHQnICYmIHRoaXMucGFyZW50LmlzUm93RHJhZ2FibGUoKSA/IDMwIDogMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBjb2xzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5pbmRleCA8IGNvbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0NoaWxkQ29sdW1uKGNvbHVtbiwgY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udWlkKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uLmluZGV4ID4gY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2xzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5mcmVlemUgPT09ICdSaWdodCcgfHwgY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZnJlZXplID09PSAnRml4ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoICs9IHBhcnNlRmxvYXQoY29sc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ud2lkdGgudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhcHBseVN0aWNreUxlZnRSaWdodFBvc2l0aW9uKG5vZGUsIHdpZHRoIC0gMSwgdGhpcy5wYXJlbnQuZW5hYmxlUnRsLCAnUmlnaHQnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnZS11bmZyZWV6ZScpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgcmV0dXJuIFN0YWNrZWRIZWFkZXJDZWxsUmVuZGVyZXI7XG59KENlbGxSZW5kZXJlcikpO1xuZXhwb3J0IHsgU3RhY2tlZEhlYWRlckNlbGxSZW5kZXJlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/stacked-cell-renderer.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/aria-service.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/aria-service.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AriaService: () => (/* binding */ AriaService)\n/* harmony export */ });\n/**\n * AriaService\n *\n * @hidden\n */\nvar AriaService = /** @class */ (function () {\n    function AriaService() {\n    }\n    AriaService.prototype.setOptions = function (target, options) {\n        var props = Object.keys(options);\n        for (var i = 0; i < props.length; i++) {\n            setStateAndProperties(target, config[props[parseInt(i.toString(), 10)]], options[props[parseInt(i.toString(), 10)]]);\n        }\n    };\n    AriaService.prototype.setExpand = function (target, expand) {\n        setStateAndProperties(target, config.expand, expand);\n    };\n    AriaService.prototype.setSort = function (target, direction) {\n        setStateAndProperties(target, config.sort, direction, typeof direction === 'boolean');\n    };\n    AriaService.prototype.setBusy = function (target, isBusy) {\n        setStateAndProperties(target, config.busy, isBusy);\n        setStateAndProperties(target, config.invalid, null, true);\n    };\n    AriaService.prototype.setGrabbed = function (target, isGrabbed, remove) {\n        setStateAndProperties(target, config.grabbed, isGrabbed, remove);\n    };\n    AriaService.prototype.setDropTarget = function (target, isTarget) {\n        setStateAndProperties(target, config.dropeffect, 'copy', !isTarget);\n    };\n    return AriaService;\n}());\n\n/**\n * @param {HTMLElement} target - specifies the target\n * @param {string} attribute - specifies the attribute\n * @param {ValueType} value - specifies the value\n * @param {boolean} remove - specifies the boolean for remove\n * @returns {void}\n * @hidden\n */\nfunction setStateAndProperties(target, attribute, value, remove) {\n    if (remove && target) {\n        target.removeAttribute(attribute);\n        return;\n    }\n    if (target) {\n        target.setAttribute(attribute, value);\n    }\n}\nvar config = {\n    expand: 'aria-expanded',\n    role: 'role',\n    datarole: 'data-role',\n    selected: 'aria-selected',\n    multiselectable: 'aria-multiselectable',\n    sort: 'aria-sort',\n    busy: 'aria-busy',\n    invalid: 'aria-invalid',\n    grabbed: 'aria-grabbed',\n    dropeffect: 'aria-dropeffect',\n    haspopup: 'aria-haspopup',\n    level: 'aria-level',\n    colcount: 'aria-colcount',\n    rowcount: 'aria-rowcount'\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9hcmlhLXNlcnZpY2UuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNzQjtBQUN2QjtBQUNBLFdBQVcsYUFBYTtBQUN4QixXQUFXLFFBQVE7QUFDbkIsV0FBVyxXQUFXO0FBQ3RCLFdBQVcsU0FBUztBQUNwQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvc2VydmljZXMvYXJpYS1zZXJ2aWNlLmpzP2ZjMDciXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBcmlhU2VydmljZVxuICpcbiAqIEBoaWRkZW5cbiAqL1xudmFyIEFyaWFTZXJ2aWNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFyaWFTZXJ2aWNlKCkge1xuICAgIH1cbiAgICBBcmlhU2VydmljZS5wcm90b3R5cGUuc2V0T3B0aW9ucyA9IGZ1bmN0aW9uICh0YXJnZXQsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHByb3BzID0gT2JqZWN0LmtleXMob3B0aW9ucyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHNldFN0YXRlQW5kUHJvcGVydGllcyh0YXJnZXQsIGNvbmZpZ1twcm9wc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dLCBvcHRpb25zW3Byb3BzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXV0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBcmlhU2VydmljZS5wcm90b3R5cGUuc2V0RXhwYW5kID0gZnVuY3Rpb24gKHRhcmdldCwgZXhwYW5kKSB7XG4gICAgICAgIHNldFN0YXRlQW5kUHJvcGVydGllcyh0YXJnZXQsIGNvbmZpZy5leHBhbmQsIGV4cGFuZCk7XG4gICAgfTtcbiAgICBBcmlhU2VydmljZS5wcm90b3R5cGUuc2V0U29ydCA9IGZ1bmN0aW9uICh0YXJnZXQsIGRpcmVjdGlvbikge1xuICAgICAgICBzZXRTdGF0ZUFuZFByb3BlcnRpZXModGFyZ2V0LCBjb25maWcuc29ydCwgZGlyZWN0aW9uLCB0eXBlb2YgZGlyZWN0aW9uID09PSAnYm9vbGVhbicpO1xuICAgIH07XG4gICAgQXJpYVNlcnZpY2UucHJvdG90eXBlLnNldEJ1c3kgPSBmdW5jdGlvbiAodGFyZ2V0LCBpc0J1c3kpIHtcbiAgICAgICAgc2V0U3RhdGVBbmRQcm9wZXJ0aWVzKHRhcmdldCwgY29uZmlnLmJ1c3ksIGlzQnVzeSk7XG4gICAgICAgIHNldFN0YXRlQW5kUHJvcGVydGllcyh0YXJnZXQsIGNvbmZpZy5pbnZhbGlkLCBudWxsLCB0cnVlKTtcbiAgICB9O1xuICAgIEFyaWFTZXJ2aWNlLnByb3RvdHlwZS5zZXRHcmFiYmVkID0gZnVuY3Rpb24gKHRhcmdldCwgaXNHcmFiYmVkLCByZW1vdmUpIHtcbiAgICAgICAgc2V0U3RhdGVBbmRQcm9wZXJ0aWVzKHRhcmdldCwgY29uZmlnLmdyYWJiZWQsIGlzR3JhYmJlZCwgcmVtb3ZlKTtcbiAgICB9O1xuICAgIEFyaWFTZXJ2aWNlLnByb3RvdHlwZS5zZXREcm9wVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldCwgaXNUYXJnZXQpIHtcbiAgICAgICAgc2V0U3RhdGVBbmRQcm9wZXJ0aWVzKHRhcmdldCwgY29uZmlnLmRyb3BlZmZlY3QsICdjb3B5JywgIWlzVGFyZ2V0KTtcbiAgICB9O1xuICAgIHJldHVybiBBcmlhU2VydmljZTtcbn0oKSk7XG5leHBvcnQgeyBBcmlhU2VydmljZSB9O1xuLyoqXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSB0YXJnZXQgLSBzcGVjaWZpZXMgdGhlIHRhcmdldFxuICogQHBhcmFtIHtzdHJpbmd9IGF0dHJpYnV0ZSAtIHNwZWNpZmllcyB0aGUgYXR0cmlidXRlXG4gKiBAcGFyYW0ge1ZhbHVlVHlwZX0gdmFsdWUgLSBzcGVjaWZpZXMgdGhlIHZhbHVlXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHJlbW92ZSAtIHNwZWNpZmllcyB0aGUgYm9vbGVhbiBmb3IgcmVtb3ZlXG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gc2V0U3RhdGVBbmRQcm9wZXJ0aWVzKHRhcmdldCwgYXR0cmlidXRlLCB2YWx1ZSwgcmVtb3ZlKSB7XG4gICAgaWYgKHJlbW92ZSAmJiB0YXJnZXQpIHtcbiAgICAgICAgdGFyZ2V0LnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgdGFyZ2V0LnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICB9XG59XG52YXIgY29uZmlnID0ge1xuICAgIGV4cGFuZDogJ2FyaWEtZXhwYW5kZWQnLFxuICAgIHJvbGU6ICdyb2xlJyxcbiAgICBkYXRhcm9sZTogJ2RhdGEtcm9sZScsXG4gICAgc2VsZWN0ZWQ6ICdhcmlhLXNlbGVjdGVkJyxcbiAgICBtdWx0aXNlbGVjdGFibGU6ICdhcmlhLW11bHRpc2VsZWN0YWJsZScsXG4gICAgc29ydDogJ2FyaWEtc29ydCcsXG4gICAgYnVzeTogJ2FyaWEtYnVzeScsXG4gICAgaW52YWxpZDogJ2FyaWEtaW52YWxpZCcsXG4gICAgZ3JhYmJlZDogJ2FyaWEtZ3JhYmJlZCcsXG4gICAgZHJvcGVmZmVjdDogJ2FyaWEtZHJvcGVmZmVjdCcsXG4gICAgaGFzcG9wdXA6ICdhcmlhLWhhc3BvcHVwJyxcbiAgICBsZXZlbDogJ2FyaWEtbGV2ZWwnLFxuICAgIGNvbGNvdW50OiAnYXJpYS1jb2xjb3VudCcsXG4gICAgcm93Y291bnQ6ICdhcmlhLXJvd2NvdW50J1xufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/aria-service.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/cell-render-factory.js":
/*!**************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/cell-render-factory.js ***!
  \**************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CellRendererFactory: () => (/* binding */ CellRendererFactory)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n\n\n/**\n * CellRendererFactory\n *\n * @hidden\n */\nvar CellRendererFactory = /** @class */ (function () {\n    function CellRendererFactory() {\n        this.cellRenderMap = {};\n    }\n    CellRendererFactory.prototype.addCellRenderer = function (name, type) {\n        name = typeof name === 'string' ? name : (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getEnumValue)(_base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType, name);\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.cellRenderMap[\"\" + name])) {\n            this.cellRenderMap[\"\" + name] = type;\n        }\n    };\n    CellRendererFactory.prototype.getCellRenderer = function (name) {\n        name = typeof name === 'string' ? name : (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getEnumValue)(_base_enum__WEBPACK_IMPORTED_MODULE_1__.CellType, name);\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.cellRenderMap[\"\" + name])) {\n            // eslint-disable-next-line no-throw-literal\n            throw \"The cellRenderer \" + name + \" is not found\";\n        }\n        else {\n            return this.cellRenderMap[\"\" + name];\n        }\n    };\n    return CellRendererFactory;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9jZWxsLXJlbmRlci1mYWN0b3J5LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1RTtBQUMvQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxrRUFBWSxDQUFDLGdEQUFRO0FBQ3RFLFlBQVksdUVBQWlCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELGtFQUFZLENBQUMsZ0RBQVE7QUFDdEUsWUFBWSx1RUFBaUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDOEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9jZWxsLXJlbmRlci1mYWN0b3J5LmpzPzNiODQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNOdWxsT3JVbmRlZmluZWQsIGdldEVudW1WYWx1ZSB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IENlbGxUeXBlIH0gZnJvbSAnLi4vYmFzZS9lbnVtJztcbi8qKlxuICogQ2VsbFJlbmRlcmVyRmFjdG9yeVxuICpcbiAqIEBoaWRkZW5cbiAqL1xudmFyIENlbGxSZW5kZXJlckZhY3RvcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2VsbFJlbmRlcmVyRmFjdG9yeSgpIHtcbiAgICAgICAgdGhpcy5jZWxsUmVuZGVyTWFwID0ge307XG4gICAgfVxuICAgIENlbGxSZW5kZXJlckZhY3RvcnkucHJvdG90eXBlLmFkZENlbGxSZW5kZXJlciA9IGZ1bmN0aW9uIChuYW1lLCB0eXBlKSB7XG4gICAgICAgIG5hbWUgPSB0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycgPyBuYW1lIDogZ2V0RW51bVZhbHVlKENlbGxUeXBlLCBuYW1lKTtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuY2VsbFJlbmRlck1hcFtcIlwiICsgbmFtZV0pKSB7XG4gICAgICAgICAgICB0aGlzLmNlbGxSZW5kZXJNYXBbXCJcIiArIG5hbWVdID0gdHlwZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2VsbFJlbmRlcmVyRmFjdG9yeS5wcm90b3R5cGUuZ2V0Q2VsbFJlbmRlcmVyID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgbmFtZSA9IHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJyA/IG5hbWUgOiBnZXRFbnVtVmFsdWUoQ2VsbFR5cGUsIG5hbWUpO1xuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jZWxsUmVuZGVyTWFwW1wiXCIgKyBuYW1lXSkpIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby10aHJvdy1saXRlcmFsXG4gICAgICAgICAgICB0aHJvdyBcIlRoZSBjZWxsUmVuZGVyZXIgXCIgKyBuYW1lICsgXCIgaXMgbm90IGZvdW5kXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jZWxsUmVuZGVyTWFwW1wiXCIgKyBuYW1lXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIENlbGxSZW5kZXJlckZhY3Rvcnk7XG59KCkpO1xuZXhwb3J0IHsgQ2VsbFJlbmRlcmVyRmFjdG9yeSB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/cell-render-factory.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/focus-strategy.js":
/*!*********************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/focus-strategy.js ***!
  \*********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ContentFocus: () => (/* binding */ ContentFocus),\n/* harmony export */   FocusStrategy: () => (/* binding */ FocusStrategy),\n/* harmony export */   HeaderFocus: () => (/* binding */ HeaderFocus),\n/* harmony export */   Matrix: () => (/* binding */ Matrix),\n/* harmony export */   SearchBox: () => (/* binding */ SearchBox)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _models_row__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../models/row */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/row.js\");\n/* harmony import */ var _row_model_generator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./row-model-generator */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/row-model-generator.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n\n\n/**\n * FocusStrategy class\n *\n * @hidden\n */\nvar FocusStrategy = /** @class */ (function () {\n    function FocusStrategy(parent) {\n        this.currentInfo = {};\n        this.oneTime = true;\n        this.swap = {};\n        /** @hidden */\n        this.isInfiniteScroll = false;\n        /** @hidden */\n        this.virtualSelectionInfo = {};\n        this.forget = false;\n        this.skipFocus = true;\n        this.focusByClick = false;\n        this.firstHeaderCellClick = false;\n        /** @hidden */\n        this.prevIndexes = {};\n        this.refMatrix = this.refreshMatrix(true);\n        this.actions = ['downArrow', 'upArrow'];\n        this.isVirtualScroll = false;\n        this.groupedFrozenRow = 0;\n        this.parent = parent;\n        this.rowModelGen = new _row_model_generator__WEBPACK_IMPORTED_MODULE_1__.RowModelGenerator(this.parent);\n        this.addEventListener();\n    }\n    FocusStrategy.prototype.focusCheck = function (e) {\n        var target = e.target;\n        this.focusByClick = true;\n        this.firstHeaderCellClick = true;\n        this.skipFocus = target.classList.contains('e-grid');\n    };\n    FocusStrategy.prototype.onFocus = function (e) {\n        if (this.parent.isDestroyed || _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice || this.parent.enableVirtualization\n            || this.parent.element.querySelector('.e-masked-table') || (!this.parent.isInitialLoad && e\n            && e.target === this.parent.element && this.parent.element.querySelector('.e-spin-show'))) {\n            return;\n        }\n        this.setActive(!this.parent.enableHeaderFocus && this.parent.frozenRows === 0);\n        if (!this.parent.enableHeaderFocus && !this.parent.getCurrentViewRecords().length && ((this.parent.editSettings.mode !== 'Batch')\n            || (this.parent.editSettings.mode === 'Batch' && this.parent.editModule && !this.parent.editModule.getBatchChanges()[_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.addedRecords].length))) {\n            this.getContent().matrix.\n                generate(this.rowModelGen.generateRows({ rows: [new _models_row__WEBPACK_IMPORTED_MODULE_3__.Row({ isDataRow: true })] }), this.getContent().selector, false);\n        }\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator(), this.active);\n        this.getContent().matrix.select(current[0], current[1]);\n        if (this.skipFocus && !(e && e.target === this.parent.element)) {\n            this.focus(e);\n            this.skipFocus = false;\n        }\n    };\n    FocusStrategy.prototype.passiveFocus = function (e) {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        var firstHeaderCell = this.parent.getHeaderContent().querySelector('.e-headercell:not(.e-hide)');\n        if (e.target === firstHeaderCell && e.relatedTarget && !(0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.relatedTarget, 'e-grid')\n            && !this.firstHeaderCellClick) {\n            var firstHeaderCellIndex = [0, 0];\n            if (this.active.matrix.matrix[firstHeaderCellIndex[0]][firstHeaderCellIndex[1]] === 0) {\n                firstHeaderCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, firstHeaderCellIndex, true);\n            }\n            this.active.matrix.current = firstHeaderCellIndex;\n            this.currentInfo.element = e.target;\n            this.currentInfo.elementToFocus = e.target;\n            if (this.currentInfo.element.querySelector('.e-checkselectall')) {\n                this.removeFocus();\n                this.addFocus(this.getContent().getFocusInfo(), e);\n            }\n            else {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.currentInfo.element], ['e-focused', 'e-focus']);\n            }\n        }\n        this.firstHeaderCellClick = false;\n        if (e.target && e.target.classList.contains('e-detailcell')) {\n            this.currentInfo.skipAction = false;\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.currentInfo.element], ['e-focused', 'e-focus']);\n        }\n    };\n    FocusStrategy.prototype.onBlur = function (e) {\n        if (this.parent.allowPaging && this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer')) {\n            this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer').removeAttribute('aria-hidden');\n        }\n        // The below boolean condition for gantt team focus fix.\n        var isGantt = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-gantt') && e.target.classList.contains('e-rowcell')\n            && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.target.nextElementSibling)\n                && e.target.nextElementSibling.classList.contains('e-rowcell')) ? true : false;\n        if ((this.parent.isEdit || e && (!e.relatedTarget || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.relatedTarget, '.e-grid') || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.relatedTarget, '.e-grid-popup'))\n            && !(this.parent.element.classList.contains('e-childgrid') && !this.parent.element.matches(':focus-within')))\n            && !(!isGantt && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.relatedTarget) && parseInt(e.target.getAttribute('aria-colindex'), 10) - 1 === 0\n                && parseInt(e.target.getAttribute('index'), 10) === 0) && !(!isGantt && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.relatedTarget)\n            && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(document.activeElement, '.e-grid') && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e['sourceCapabilities']))) {\n            return;\n        }\n        this.removeFocus();\n        this.skipFocus = true;\n        this.currentInfo.skipAction = false;\n        this.setLastContentCellTabIndex();\n        this.setFirstFocusableTabIndex();\n        this.firstHeaderCellClick = false;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.setFirstFocusableTabIndex = function () {\n        var gObj = this.parent;\n        gObj.element.tabIndex = -1;\n        if (gObj.allowGrouping && gObj.groupSettings.showDropArea) {\n            var groupModule = gObj.groupModule;\n            var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n            if (focusableGroupedItems.length > 0) {\n                groupModule.element.tabIndex = -1;\n                focusableGroupedItems[0].tabIndex = 0;\n            }\n            else {\n                groupModule.element.tabIndex = 0;\n            }\n            return;\n        }\n        if (gObj.toolbar || gObj.toolbarTemplate) {\n            var toolbarElement = gObj.toolbarModule.element;\n            var focusableToolbarItems = this.parent.toolbarModule.getFocusableToolbarItems();\n            if (focusableToolbarItems.length > 0 && focusableToolbarItems[0].querySelector('.e-toolbar-item-focus,.e-btn,.e-input')) {\n                toolbarElement.tabIndex = -1;\n                focusableToolbarItems[0].querySelector('.e-toolbar-item-focus,.e-btn,.e-input').tabIndex = 0;\n            }\n            else {\n                toolbarElement.tabIndex = 0;\n            }\n            return;\n        }\n        if (gObj.getColumns().length) {\n            var firstHeaderCell = gObj.getHeaderContent().querySelector('.e-headercell:not(.e-hide)');\n            firstHeaderCell.tabIndex = 0;\n            this.setActive(false);\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.active) && ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.active.target) || !this.active.target.classList.contains('e-columnmenu'))) {\n                var firstHeaderCellIndex = [0, 0];\n                if (this.active.matrix.matrix[firstHeaderCellIndex[0]][firstHeaderCellIndex[1]] === 0) {\n                    firstHeaderCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, firstHeaderCellIndex, true);\n                }\n                this.active.matrix.current = firstHeaderCellIndex;\n            }\n            return;\n        }\n    };\n    FocusStrategy.prototype.setLastContentCellTabIndex = function () {\n        var contentTable = this.parent.getContentTable();\n        if (contentTable.rows[contentTable.rows.length - 1]) {\n            var lastCell = contentTable.rows[contentTable.rows.length - 1].lastElementChild;\n            lastCell.tabIndex = 0;\n        }\n    };\n    FocusStrategy.prototype.onClick = function (e, force, isFocusFirstCell) {\n        if ((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-filterbarcell') && ((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-multiselect') ||\n            e.target.classList.contains('e-input-group-icon'))) {\n            return;\n        }\n        var isContent = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridContent));\n        var isHeader = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridHeader));\n        isContent = isContent && isHeader ? !isContent : isContent;\n        if (!isContent && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridHeader)) ||\n            e.target.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.content) || e.target.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.headerContent) ||\n            (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-unboundcell')) && !force)) {\n            return;\n        }\n        this.setActive(isContent);\n        var beforeArgs = { cancel: false, byKey: false, byClick: !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e.target), clickArgs: e };\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_5__.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel || ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-inline-edit') && (!this.parent.editSettings.showAddNewRow &&\n            (this.parent.editSettings.showAddNewRow && !this.parent.element.querySelector('.e-editedrow'))))) {\n            return;\n        }\n        this.setActive(isContent);\n        if (this.getContent()) {\n            var returnVal = this.getContent().onClick(e, force);\n            if (returnVal === false) {\n                return;\n            }\n            this.focus();\n            if (this.currentInfo.element.classList.contains('e-rowcell') && e.type && e.type === 'click' && !isFocusFirstCell) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.currentInfo.element], ['e-focused', 'e-focus']);\n            }\n            if (isFocusFirstCell && e && e.target) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([e.target], ['e-focused', 'e-focus']);\n            }\n        }\n    };\n    FocusStrategy.prototype.handleFilterNavigation = function (e, inputSelector, buttonSelector) {\n        if (e.target === document.querySelector(inputSelector) && e.key === 'Tab' && e.shiftKey) {\n            e.preventDefault();\n            document.querySelector(buttonSelector).focus();\n        }\n        else if (e.target === document.querySelector(buttonSelector) && e.key === 'Tab' && !e.shiftKey &&\n            document.activeElement === document.querySelector(buttonSelector)) {\n            e.preventDefault();\n            document.querySelector(inputSelector).focus();\n        }\n    };\n    FocusStrategy.prototype.onKeyPress = function (e) {\n        if (this.content && this.content.target) {\n            this.content.target = null;\n        }\n        if (this.parent.allowPaging) {\n            var pagerElement = this.parent.pagerModule.pagerObj.element;\n            var focusablePagerElements = this.parent.pagerModule.pagerObj.getFocusablePagerElements(pagerElement, []);\n            if (this.parent.childGrid && !(0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-gridpager') && this.allowToPaging(e) && focusablePagerElements.length) {\n                focusablePagerElements[0].tabIndex = 0;\n            }\n            if (this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n                if (e.action === 'shiftTab' && focusablePagerElements.length && focusablePagerElements[0] === e.target) {\n                    this.setActive(true);\n                    var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1,\n                        this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n                    if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n                        lastHeaderCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, lastHeaderCellIndex, false);\n                    }\n                    this.active.matrix.current = this.parent.editSettings.mode === 'Batch' ?\n                        this.isValidBatchEditCell(lastHeaderCellIndex) ? lastHeaderCellIndex :\n                            this.findBatchEditCell(lastHeaderCellIndex, false) : lastHeaderCellIndex;\n                    e.preventDefault();\n                    this.focus(e);\n                    return;\n                }\n                if (!(e.action === 'tab' && this.parent.element.classList.contains('e-childgrid')\n                    && ((!this.parent.pageSettings.pageSizes && focusablePagerElements.length\n                        && focusablePagerElements[focusablePagerElements.length - 1] === e.target)\n                        || (this.parent.pagerModule.pagerObj.getDropDownPage() === e.target)))) {\n                    this.parent.pagerModule.pagerObj.changePagerFocus(e);\n                    return;\n                }\n                else {\n                    var parentCell = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(this.parent.element, 'e-detailcell');\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([this.parent.element], ['e-focus']);\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([parentCell], ['e-focused']);\n                    parentCell.tabIndex = -1;\n                }\n            }\n            if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && (e.keyCode === 38 || (e.shiftKey && e.keyCode === 9))) {\n                e.preventDefault();\n                this.focus(e);\n                return;\n            }\n            else if (this.parent.pagerModule.pagerObj.element.tabIndex === 0 && e.keyCode === 9) {\n                e.preventDefault();\n                this.parent.pagerModule.pagerObj.setPagerFocus();\n                return;\n            }\n            if (this.parent.pagerModule.pagerObj.checkFirstPagerFocus()) {\n                var lastRow = this.getContent().matrix.rows;\n                var lastColumn = this.getContent().matrix.columns;\n                this.getContent().matrix.current = [lastRow, lastColumn];\n            }\n        }\n        if (this.parent.filterSettings.type === 'Excel') {\n            this.handleFilterNavigation(e, '.e-excelfilter .e-menu-item:not(.e-disabled)', '.e-excelfilter .e-footer-content button:nth-child(2)');\n        }\n        if (this.parent.filterSettings.type === 'CheckBox') {\n            var focusedColumn = this.parent.getColumnByUid(this.focusedColumnUid);\n            var focusTarget = focusedColumn && focusedColumn.filter && focusedColumn.filter.hideSearchbox ? '.e-chk-hidden' : '.e-searchinput.e-input';\n            this.handleFilterNavigation(e, focusTarget, '.e-checkboxfilter .e-footer-content button:nth-child(2)');\n        }\n        if (this.parent.filterSettings.type === 'Menu') {\n            this.handleFilterNavigation(e, '.e-flmenu .e-input-group.e-popup-flmenu', '.e-flmenu .e-footer-content button:nth-child(2)');\n        }\n        if (this.parent.showColumnChooser) {\n            this.handleFilterNavigation(e, '.e-ccdlg .e-ccsearch.e-cc.e-input', '.e-ccdlg .e-footer-content button:nth-child(2)');\n        }\n        if (this.skipOn(e)) {\n            return;\n        }\n        if (e.target && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-gridcontent')) {\n            var rows = [].slice.call(this.parent.getContentTable().rows);\n            var lastCell = rows[rows.length - 1].lastElementChild;\n            if (e.target === lastCell) {\n                this.setActive(true);\n                this.setLastContentCellActive();\n            }\n        }\n        if (e.action === 'shiftTab' && e.target && (e.target === this.parent.element || (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-toolbar')\n            || (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-groupdroparea'))) {\n            if (e.target === this.parent.element) {\n                if (this.parent.element.classList.contains('e-childgrid')) {\n                    this.focusOutFromChildGrid(e);\n                }\n                return;\n            }\n            if ((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-groupdroparea')) {\n                if (this.parent.element.classList.contains('e-childgrid')) {\n                    e.preventDefault();\n                    this.parent.element.focus();\n                }\n                return;\n            }\n            if ((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-toolbar')) {\n                if (this.parent.allowGrouping && this.parent.groupSettings.showDropArea) {\n                    var groupModule = this.parent.groupModule;\n                    var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n                    e.preventDefault();\n                    if (focusableGroupedItems.length > 0) {\n                        focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n                    }\n                    else {\n                        groupModule.element.focus();\n                    }\n                }\n                else if (this.parent.element.classList.contains('e-childgrid')) {\n                    e.preventDefault();\n                    this.parent.element.focus();\n                }\n                return;\n            }\n        }\n        var focusFirstHeaderCell = false;\n        if (e.action === 'tab' && e.target && (e.target === this.parent.element || (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-toolbar')\n            || (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-groupdroparea'))) {\n            if (this.parent.allowGrouping && this.parent.groupSettings.showDropArea\n                && (e.target === this.parent.element || e.target.classList.contains('e-groupdroparea'))) {\n                var groupModule = this.parent.groupModule;\n                var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n                if (focusableGroupedItems.length > 0) {\n                    e.preventDefault();\n                    focusableGroupedItems[0].focus();\n                    return;\n                }\n                if (!e.target.classList.contains('e-groupdroparea')) {\n                    e.preventDefault();\n                    groupModule.element.focus();\n                    return;\n                }\n            }\n            if ((this.parent.toolbar || this.parent.toolbarTemplate) && (e.target === this.parent.element\n                || (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-groupdroparea')\n                || e.target.classList.contains('e-toolbar'))) {\n                var toolbarElement = this.parent.toolbarModule.element;\n                var focusableToolbarItems = this.parent.toolbarModule.getFocusableToolbarItems();\n                if (focusableToolbarItems.length > 0) {\n                    e.preventDefault();\n                    focusableToolbarItems[0].querySelector('.e-toolbar-item-focus,.e-btn,.e-input').focus();\n                    return;\n                }\n                if (!e.target.classList.contains('e-toolbar')) {\n                    e.preventDefault();\n                    toolbarElement.focus();\n                    return;\n                }\n            }\n            if (e.target === this.parent.element || (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-toolbar')\n                || (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-groupdroparea')) {\n                focusFirstHeaderCell = true;\n            }\n        }\n        if (focusFirstHeaderCell) {\n            if (this.parent.allowGrouping && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.groupSettings.columns)\n                && this.parent.groupSettings.columns.length === this.parent.columns.length) {\n                this.setActive(true);\n            }\n            else {\n                this.setActive(false);\n            }\n            this.active.matrix.current = [0, -1];\n        }\n        this.activeKey = e.action;\n        var beforeArgs = { cancel: false, byKey: true, byClick: false, keyArgs: e };\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_5__.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        var bValue = this.getContent().matrix.current;\n        var prevBatchValue = this.active && this.active.matrix.current ?\n            [this.active.matrix.current[0], this.active.matrix.current[1]] : undefined;\n        this.currentInfo.outline = true;\n        var swapInfo = this.getContent().jump(e.action, bValue);\n        this.swap = swapInfo;\n        if (swapInfo.swap && !(this.parent.editSettings.mode === 'Batch'\n            && (e.action === 'tab' || e.action === 'shiftTab'))) {\n            this.setActive(!swapInfo.toHeader);\n            this.getContent().matrix.current = this.getContent().getNextCurrent(bValue, swapInfo, this.active, e.action);\n            this.prevIndexes = {};\n        }\n        this.setActiveByKey(e.action, this.getContent());\n        var returnVal = this.content.lastIdxCell ? false : this.getContent().onKeyPress(e);\n        if (e.target && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-gridheader')) {\n            if (e.action === 'tab' && bValue.toString() === this.active.matrix.current.toString()) {\n                var nextHeaderCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, this.active.matrix.current, true);\n                var lastHeaderCellIndex = [this.active.matrix.matrix.length - 1,\n                    this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n                if (this.active.matrix.matrix[lastHeaderCellIndex[0]][lastHeaderCellIndex[1]] === 0) {\n                    lastHeaderCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, lastHeaderCellIndex, false);\n                }\n                var nextCell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(nextHeaderCellIndex[0] + \".cells.\" + nextHeaderCellIndex[1], this.active.matrix.getRowsFromIndex(nextHeaderCellIndex[0], this.active));\n                if (nextCell && nextCell.getBoundingClientRect().width === 0\n                    && this.active.matrix.matrix.length - 1 === nextHeaderCellIndex[0]) {\n                    lastHeaderCellIndex = this.active.matrix.nextVisibleCellFocus(nextHeaderCellIndex[0], nextHeaderCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                }\n                if (this.active.matrix.current.toString() === lastHeaderCellIndex.toString() && this.content.matrix.matrix.length) {\n                    returnVal = true;\n                    this.setActive(true);\n                    var firstContentCellIndex = [0, 0];\n                    if (this.parent.allowPaging && this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer')) {\n                        this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer').setAttribute('aria-hidden', 'true');\n                    }\n                    if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n                        firstContentCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, [0, 0], true);\n                    }\n                    var firstCell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(firstContentCellIndex[0] + \".cells.\" + firstContentCellIndex[1], this.active.matrix.getRowsFromIndex(firstContentCellIndex[0], this.active));\n                    if (firstCell && firstCell.getBoundingClientRect().width === 0) {\n                        firstContentCellIndex = this.active.matrix.nextVisibleCellFocus(firstContentCellIndex[0], firstContentCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                    }\n                    this.active.matrix.current = this.parent.editSettings.mode === 'Batch' ?\n                        this.isValidBatchEditCell(firstContentCellIndex) ? firstContentCellIndex :\n                            this.findBatchEditCell(firstContentCellIndex, true) : firstContentCellIndex;\n                    if (this.parent.enableVirtualization && !this.parent.enableColumnVirtualization\n                        && this.parent.contentModule.prevInfo.blockIndexes[0] !== 1) {\n                        e.preventDefault();\n                        this.removeFocus();\n                        var virtual = this.parent.contentModule;\n                        virtual.firstCellFocus = true;\n                        virtual.content.scrollTop = 0;\n                        return;\n                    }\n                }\n                else if (this.active.matrix.current.toString() !== nextHeaderCellIndex.toString()) {\n                    this.active.matrix.current = nextHeaderCellIndex;\n                }\n            }\n            if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n                var previousCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, this.active.matrix.current, false);\n                var prevCell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(previousCellIndex[0] + \".cells.\" + previousCellIndex[1], this.active.matrix.getRowsFromIndex(previousCellIndex[0], this.active));\n                if (prevCell && prevCell.getBoundingClientRect().width === 0 && previousCellIndex[0] === 0) {\n                    previousCellIndex = this.active.matrix.nextVisibleCellFocus(previousCellIndex[0], previousCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                }\n                if (previousCellIndex.toString() === this.active.matrix.current.toString()) {\n                    this.focusOutFromHeader(e);\n                    return;\n                }\n                if (this.active.matrix.current.toString() !== previousCellIndex.toString() && !returnVal) {\n                    returnVal = true;\n                    var prevCell_1 = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(previousCellIndex[0] + \".cells.\" + previousCellIndex[1], this.active.matrix.getRowsFromIndex(previousCellIndex[0], this.active));\n                    if (prevCell_1 && prevCell_1.getBoundingClientRect().width === 0 && previousCellIndex[0] === 0) {\n                        previousCellIndex = this.active.matrix.nextVisibleCellFocus(previousCellIndex[0], previousCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                    }\n                    this.active.matrix.current = previousCellIndex;\n                }\n            }\n        }\n        if (e.target && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-gridcontent')) {\n            if (this.parent.allowPaging && this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer')) {\n                this.parent.pagerModule.pagerObj.element.querySelector('.e-pagercontainer').removeAttribute('aria-hidden');\n            }\n            if (this.parent.editSettings.mode === 'Batch' && (e.action === 'tab' || e.action === 'shiftTab')) {\n                this.active.matrix.current = this.findBatchEditCell(prevBatchValue, e.action === 'tab' ? true : false);\n                if (e.action === 'tab' && prevBatchValue.toString() === this.active.matrix.current.toString()) {\n                    this.parent.editModule.editModule.addBatchRow = true;\n                }\n            }\n            if (e.action === 'shiftTab' && bValue.toString() === this.active.matrix.current.toString()) {\n                if (this.parent.allowGrouping && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.groupSettings.columns)\n                    && this.parent.groupSettings.columns.length === this.parent.columns.length) {\n                    this.focusOutFromHeader(e);\n                    return;\n                }\n                var firstContentCellIndex = [0, 0];\n                if (this.active.matrix.matrix[firstContentCellIndex[0]][firstContentCellIndex[1]] === 0) {\n                    firstContentCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, [0, 0], true);\n                }\n                var firstCell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(firstContentCellIndex[0] + \".cells.\" + firstContentCellIndex[1], this.active.matrix.getRowsFromIndex(firstContentCellIndex[0], this.active));\n                if (firstCell && firstCell.getBoundingClientRect().width === 0) {\n                    firstContentCellIndex = this.active.matrix.nextVisibleCellFocus(firstContentCellIndex[0], firstContentCellIndex[1], e.action, this.active.keyActions[e.action], this.active, this.active.matrix.current[1]);\n                }\n                if (!returnVal && (firstContentCellIndex.toString() === this.active.matrix.current.toString()\n                    || (this.parent.editSettings.mode === 'Batch'\n                        && prevBatchValue.toString() === this.active.matrix.current.toString()))) {\n                    returnVal = true;\n                    this.setActive(false);\n                    this.setLastContentCellActive();\n                }\n            }\n        }\n        if (returnVal === false) {\n            this.clearIndicator();\n            if (e.action === 'shiftTab' && bValue.toString() === [0, 0].toString()) {\n                this.parent.element.tabIndex = -1;\n            }\n            if (this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus() && this.allowToPaging(e)\n                && bValue.toString() !== [0, 0].toString()) {\n                e.preventDefault();\n                if (e.keyCode === 40) {\n                    this.parent.pagerModule.pagerObj.setPagerContainerFocus();\n                    return;\n                }\n                else if (e.keyCode === 9) {\n                    this.parent.pagerModule.pagerObj.setPagerFocus();\n                    return;\n                }\n            }\n            if (this.parent.element.classList.contains('e-childgrid')) {\n                this.focusOutFromChildGrid(e);\n            }\n            return;\n        }\n        this.header.action = e.action;\n        this.header.currentTarget = null;\n        this.header.focusType = 'key';\n        if (e.target && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-fltrtemp') && (e.action === 'tab' || e.action === 'shiftTab')) {\n            var target = e.target;\n            var focusElement = [].slice.call((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, 'th').querySelectorAll('.e-fltrtemp-focus'));\n            if (focusElement.length) {\n                var elementIndex = focusElement.indexOf(target);\n                var resetActive = ((e.action === 'tab' && elementIndex < focusElement.length - 1)\n                    || (e.action === 'shiftTab' && elementIndex > 0)) ? true : false;\n                if (resetActive) {\n                    this.setActive(false);\n                    this.active.matrix.current = bValue;\n                    this.active.currentTarget = target;\n                }\n            }\n        }\n        if (focusFirstHeaderCell && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(this.active.getTable(), 'e-gridheader')\n            && e.target && e.target.id === this.parent.element.id + '_searchbar') {\n            this.parent.searchModule.headerFocus = true;\n        }\n        e.preventDefault();\n        this.focus(e);\n    };\n    FocusStrategy.prototype.isValidBatchEditCell = function (cellIndex) {\n        var cell = this.active.getTable().rows[cellIndex[0]].cells[cellIndex[1]];\n        var tr = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(cell, 'tr');\n        var cellColIndex = parseInt(cell.getAttribute('aria-colindex'), 10) - 1;\n        var cellCol = this.parent.getColumns()[parseInt(cellColIndex.toString(), 10)];\n        if (this.active.matrix.matrix[cellIndex[0]][cellIndex[1]] === 1\n            && (!tr.classList.contains('e-row') || (tr.classList.contains('e-insertedrow') || !cellCol.isPrimaryKey) && cellCol.allowEditing)) {\n            return true;\n        }\n        return false;\n    };\n    FocusStrategy.prototype.findBatchEditCell = function (currentCellIndex, next, limitRow) {\n        var cellIndex = currentCellIndex;\n        var tempCellIndex = currentCellIndex;\n        var cellIndexObtain = false;\n        while (!cellIndexObtain) {\n            var prevTempCellIndex = tempCellIndex;\n            tempCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, tempCellIndex, next);\n            var tempCell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(tempCellIndex[0] + \".cells.\" + tempCellIndex[1], this.active.getTable().rows);\n            if (tempCell && tempCell.getBoundingClientRect().width === 0) {\n                tempCellIndex = this.active.matrix.nextVisibleCellFocus(tempCellIndex[0], tempCellIndex[1], this.activeKey, this.active.keyActions[this.activeKey], this.active, this.active.matrix.current[1]);\n            }\n            if ((prevTempCellIndex.toString() === tempCellIndex.toString())\n                || (limitRow && prevTempCellIndex[0] !== tempCellIndex[0])) {\n                cellIndexObtain = true;\n                continue;\n            }\n            if (this.isValidBatchEditCell(tempCellIndex)) {\n                cellIndex = tempCellIndex;\n                cellIndexObtain = true;\n            }\n        }\n        return cellIndex;\n    };\n    FocusStrategy.prototype.setLastContentCellActive = function () {\n        var lastContentCellIndex = [this.active.matrix.matrix.length - 1,\n            this.active.matrix.matrix[this.active.matrix.matrix.length - 1].length - 1];\n        if (this.active.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n            lastContentCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.active.matrix.matrix, lastContentCellIndex, false);\n        }\n        var lastCell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(lastContentCellIndex[0] + \".cells.\" + lastContentCellIndex[1], this.active.matrix.getRowsFromIndex(lastContentCellIndex[0], this.active));\n        if (lastCell && lastCell.getBoundingClientRect().width === 0) {\n            lastContentCellIndex = this.active.matrix.nextVisibleCellFocus(lastContentCellIndex[0], lastContentCellIndex[1], this.activeKey, this.active.keyActions[this.activeKey], this.active, this.active.matrix.current[1]);\n        }\n        this.active.matrix.current = lastContentCellIndex;\n    };\n    FocusStrategy.prototype.focusOutFromChildGrid = function (e) {\n        var parentTable = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(this.parent.element, 'e-table');\n        var parentGrid = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(parentTable, 'e-grid').ej2_instances[0];\n        var parentCell = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(this.parent.element, 'e-detailcell');\n        var uid = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(this.parent.element, 'e-detailrow').getAttribute('data-uid');\n        var parentRows = [].slice.call(parentGrid.getContentTable().rows);\n        var parentRowIndex = parentRows.map(function (m) { return m.getAttribute('data-uid'); }).indexOf(uid);\n        if (e.action === 'tab' && parentRowIndex >= parentRows.length - 1) {\n            return;\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([this.parent.element], ['e-focus']);\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([parentCell], ['e-focused']);\n        parentCell.tabIndex = -1;\n        e.preventDefault();\n        var nextFocusCell;\n        parentGrid.focusModule.removeFocus();\n        if (e.action === 'shiftTab') {\n            var previousRow = parentRows[parentRowIndex - 1];\n            var rowCells = previousRow.cells;\n            for (var i = rowCells.length - 1; i >= 0; i--) {\n                nextFocusCell = rowCells[parseInt(i.toString(), 10)];\n                if (!nextFocusCell.classList.contains('e-hide')) {\n                    parentGrid.focusModule.active.matrix.current = [parentRowIndex - 1, i];\n                    break;\n                }\n            }\n        }\n        else {\n            nextFocusCell = parentRows[parentRowIndex + 1].cells[0];\n            parentGrid.focusModule.active.matrix.current = [parentRowIndex + 1, 0];\n        }\n        parentGrid.focusModule.currentInfo.element = nextFocusCell;\n        parentGrid.focusModule.currentInfo.elementToFocus = nextFocusCell;\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([nextFocusCell], ['e-focused', 'e-focus']);\n        nextFocusCell.tabIndex = 0;\n        nextFocusCell.focus();\n    };\n    FocusStrategy.prototype.focusOutFromHeader = function (e) {\n        this.removeFocus();\n        if (this.parent.toolbar || this.parent.toolbarTemplate) {\n            var toolbarElement = this.parent.toolbarModule.element;\n            var focusableToolbarItems = this.parent.toolbarModule.getFocusableToolbarItems();\n            e.preventDefault();\n            if (focusableToolbarItems.length > 0) {\n                focusableToolbarItems[focusableToolbarItems.length - 1].querySelector('.e-toolbar-item-focus,.e-btn,.e-input').focus();\n            }\n            else {\n                toolbarElement.focus();\n            }\n            return;\n        }\n        if (this.parent.allowGrouping && this.parent.groupSettings.showDropArea) {\n            var groupModule = this.parent.groupModule;\n            var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n            e.preventDefault();\n            if (focusableGroupedItems.length > 0) {\n                focusableGroupedItems[focusableGroupedItems.length - 1].focus();\n            }\n            else {\n                groupModule.element.focus();\n            }\n            return;\n        }\n        if (this.parent.element.classList.contains('e-childgrid')) {\n            e.preventDefault();\n            this.parent.element.focus();\n        }\n    };\n    FocusStrategy.prototype.allowToPaging = function (e) {\n        if (this.parent.editSettings.mode === 'Batch' && this.parent.editSettings.allowAdding && e.keyCode !== 40) {\n            return false;\n        }\n        return true;\n    };\n    FocusStrategy.prototype.skipOn = function (e) {\n        var target = e.target;\n        if (!target) {\n            return false;\n        }\n        if (!this.parent.isEdit && target && target.closest('.e-unboundcell') && this.currentInfo.skipAction && ((e.action === 'shiftTab' &&\n            this.commandColumnFocusElement(target.closest('.e-unboundcell'), false) === target) ||\n            (e.action === 'tab' &&\n                this.commandColumnFocusElement(target.closest('.e-unboundcell'), true) === target))) {\n            return this.currentInfo.skipAction = false;\n        }\n        if (this.currentInfo.skipAction) {\n            this.clearIndicator();\n            return true;\n        }\n        if (['pageUp', 'pageDown', 'altDownArrow'].indexOf(e.action) > -1) {\n            this.clearIndicator();\n            return true;\n        }\n        if (this.parent.allowGrouping) {\n            var focusableGroupedItems = this.parent.groupModule.getFocusableGroupedItems();\n            if ((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-groupheadercell')\n                && !((e.target === focusableGroupedItems[0] && e.action === 'shiftTab')\n                    || (e.target === focusableGroupedItems[focusableGroupedItems.length - 1] && e.action === 'tab'))) {\n                return true;\n            }\n        }\n        if (this.parent.toolbar || this.parent.toolbarTemplate) {\n            var toolbarElement = this.parent.toolbarModule.element;\n            var focusableToolbarItems = toolbarElement\n                .querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)');\n            if ((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-toolbar-item')\n                && !(focusableToolbarItems.length > 0 && (((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-toolbar-item') === focusableToolbarItems[0] && e.action === 'shiftTab')\n                    || ((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-toolbar-item') === focusableToolbarItems[focusableToolbarItems.length - 1] && e.action === 'tab')))) {\n                return true;\n            }\n        }\n        var th = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, 'th') && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, 'th').tabIndex;\n        if (e.target.classList.contains('e-filterbaroperator') && (e.keyCode === 13 || e.keyCode === 27)) {\n            var inputTarget = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-filterbarcell');\n            inputTarget.querySelector('input').focus();\n        }\n        var addNewRow = this.parent.editSettings.showAddNewRow && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(document.activeElement, '.e-addedrow') !== null;\n        if ((th && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(document.activeElement, '.e-filterbarcell') !== null) || addNewRow) {\n            this.removeFocus();\n        }\n        var filterCell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(document.activeElement, '.e-filterbarcell') !== null;\n        if (this.parent.enableHeaderFocus && filterCell) {\n            var matrix = this.active.matrix;\n            var current = matrix.current;\n            filterCell = matrix.matrix[current[0]].lastIndexOf(1) !== current[1];\n        }\n        if (this.parent.isEdit && (e.action === 'tab' || e.action === 'shiftTab') && this.parent.editSettings.mode === 'Normal'\n            && !this.parent.editSettings.showAddNewRow && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(target, 'e-addedrow'))) {\n            var inputElements = this.parent.editModule.formObj.element.querySelectorAll('input:not([type=\"hidden\"],.e-numeric-hidden,.e-disabled), select:not([aria-hidden=\"true\"]), button:not(.e-hide), textarea:not(.e-hide,.e-disabled,[disabled])');\n            var inputTarget = target.classList.contains('e-ddl') ? target.querySelector('input') : target;\n            var firstEditCell = e.action === 'tab' && inputTarget === inputElements[inputElements.length - 1];\n            var lastEditCell = e.action === 'shiftTab' && inputTarget === inputElements[0];\n            if (firstEditCell || lastEditCell) {\n                e.preventDefault();\n                var focusElement = inputElements[firstEditCell ? 0 : inputElements.length - 1];\n                focusElement = focusElement.parentElement.classList.contains('e-ddl') ? focusElement.parentElement : focusElement;\n                focusElement.focus();\n            }\n        }\n        return (e.action === 'delete'\n            || (this.parent.editSettings.mode !== 'Batch' && ((this.parent.isEdit && (!this.parent.editSettings.showAddNewRow ||\n                (this.parent.editSettings.showAddNewRow && ((!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.element.querySelector('.e-editedrow')) ||\n                    (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(target, 'e-addedrow')) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, 'input')) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(document.querySelector('.e-popup-open'))) ||\n                    (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(target, 'e-addedrow')) && (target && !target.querySelector('.e-cancel-icon')) &&\n                        !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(target, 'e-unboundcell')))))))) || ['insert', 'f2'].indexOf(e.action) > -1))\n            || ((filterCell && this.parent.enableHeaderFocus) || ((filterCell || addNewRow) && e.action !== 'tab' && e.action !== 'shiftTab') ||\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(document.activeElement, '#' + this.parent.element.id + '_searchbar') !== null\n                    && ['enter', 'leftArrow', 'rightArrow',\n                        'shiftLeft', 'shiftRight', 'ctrlPlusA'].indexOf(e.action) > -1)\n            || ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridContent) === null && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridHeader) === null\n                && !(e.target === this.parent.element || (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-toolbar')\n                    || (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-groupdroparea')))\n            || (e.action === 'space' && (!target.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridChkBox) && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.' + _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.gridChkBox) === null\n                && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.e-headerchkcelldiv') === null))) || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, '.e-filter-popup') !== null;\n    };\n    FocusStrategy.prototype.focusVirtualElement = function (e) {\n        var _this = this;\n        if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {\n            var data = { virtualData: {}, isAdd: false, isCancel: false };\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_5__.getVirtualData, data);\n            var isKeyFocus = this.actions.some(function (value) { return value === _this.activeKey; });\n            var isSelected = this.parent.contentModule ?\n                this.parent.contentModule.selectedRowIndex > -1 : false;\n            if (data.isAdd || Object.keys(data.virtualData).length || isKeyFocus || data.isCancel || isSelected) {\n                this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_5__.resetVirtualFocus, { isCancel: false });\n                data.isCancel = false;\n                if (((this.parent.enableVirtualization && !this.parent.selectVirtualRowOnAdd) && (!e || (e && e.action !== 'ctrlHome' && e.action !== 'ctrlEnd'))) ||\n                    !this.parent.enableVirtualization) {\n                    this.parent.contentModule.selectedRowIndex = -1;\n                }\n                this.parent.selectVirtualRowOnAdd = false;\n                if (isKeyFocus) {\n                    this.activeKey = this.empty;\n                    this.parent.notify('virtaul-key-handler', e);\n                }\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                this.currentInfo.elementToFocus.focus({ preventScroll: true });\n            }\n            else {\n                if (this.isVirtualScroll || this.isInfiniteScroll) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    this.currentInfo.elementToFocus.focus({ preventScroll: true });\n                }\n                else {\n                    this.currentInfo.elementToFocus.focus();\n                }\n            }\n        }\n        this.isVirtualScroll = this.isInfiniteScroll = false;\n    };\n    FocusStrategy.prototype.getFocusedElement = function () {\n        return this.currentInfo.elementToFocus;\n    };\n    FocusStrategy.prototype.getContent = function () {\n        return this.active || this.content;\n    };\n    FocusStrategy.prototype.setActive = function (content) {\n        this.active = content ? this.content : this.header;\n    };\n    FocusStrategy.prototype.setFocusedElement = function (element, e) {\n        var _this = this;\n        this.currentInfo.elementToFocus = element;\n        setTimeout(function () {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.currentInfo.elementToFocus)) {\n                var filterMenuElement = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.parent.element.querySelector('.e-flmenu')) ?\n                    document.querySelector('.e-grid-popup .e-flmenu') : _this.parent.element.querySelector('.e-flmenu');\n                if ((_this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling) && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(filterMenuElement)) {\n                    _this.focusVirtualElement(e);\n                }\n                else if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(filterMenuElement) ||\n                    (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(document.activeElement, 'e-flmenu-valuediv') !== filterMenuElement.querySelector('.e-flmenu-valuediv')) {\n                    _this.currentInfo.elementToFocus.focus();\n                }\n            }\n        }, 0);\n    };\n    FocusStrategy.prototype.focus = function (e) {\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_5__.virtaulCellFocus, e);\n        this.removeFocus();\n        this.addFocus(this.getContent().getFocusInfo(), e);\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    FocusStrategy.prototype.removeFocus = function (e) {\n        if (!this.currentInfo.element) {\n            return;\n        }\n        if (this.parent.isReact && !this.parent.isEdit && this.currentInfo.element.classList.contains('e-rowcell')\n            && !this.currentInfo.element.parentElement && !(this.parent.allowGrouping\n            && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.groupSettings.columns) && this.parent.groupSettings.columns.length) &&\n            this.parent.getRowByIndex(this.prevIndexes.rowIndex)) {\n            var cellElem = this.parent.getCellFromIndex(this.prevIndexes.rowIndex, this.prevIndexes\n                .cellIndex);\n            this.currentInfo.element = cellElem ? cellElem : this.currentInfo.element;\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n        this.currentInfo.element.tabIndex = -1;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.addOutline = function () {\n        var info = this.getContent().getFocusInfo();\n        if (info.element) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([info.element], ['e-focused']);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([info.elementToFocus], ['e-focus']);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.focusHeader = function () {\n        this.setActive(false);\n        this.resetFocus();\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    FocusStrategy.prototype.focusContent = function () {\n        this.setActive(true);\n        this.resetFocus();\n    };\n    FocusStrategy.prototype.resetFocus = function () {\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n        this.getContent().matrix.select(current[0], current[1]);\n        this.focus();\n    };\n    FocusStrategy.prototype.addFocus = function (info, e) {\n        this.currentInfo = info;\n        this.currentInfo.outline = info.outline && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e) || this.isVirtualScroll);\n        if (this.isInfiniteScroll) {\n            this.currentInfo.outline = true;\n        }\n        if (!info.element) {\n            return;\n        }\n        var isFocused = info.elementToFocus.classList.contains('e-focus');\n        if (isFocused) {\n            return;\n        }\n        if (this.currentInfo.outline) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([info.element], ['e-focused']);\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([info.elementToFocus], ['e-focus']);\n        info.element.tabIndex = 0;\n        if (!isFocused) {\n            this.setFocusedElement(info.elementToFocus, e);\n        }\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_5__.cellFocused, {\n            element: info.elementToFocus,\n            parent: info.element,\n            indexes: this.getContent().matrix.current,\n            byKey: !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e),\n            byClick: (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e),\n            keyArgs: e,\n            isJump: this.swap.swap,\n            container: this.getContent().getInfo(e),\n            outline: !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(e),\n            swapInfo: this.swap\n        });\n        var _a = this.getContent().matrix.current, rowIndex = _a[0], cellIndex = _a[1];\n        this.prevIndexes = { rowIndex: rowIndex, cellIndex: cellIndex };\n        this.focusedColumnUid = this.parent.getColumnByIndex(cellIndex).uid;\n        this.focusByClick = false;\n    };\n    FocusStrategy.prototype.refreshMatrix = function (content) {\n        var _this = this;\n        return function (e) {\n            if (content && !_this.content) {\n                _this.content = new ContentFocus(_this.parent);\n            }\n            if (!content && !_this.header) {\n                _this.header = new HeaderFocus(_this.parent);\n            }\n            var cFocus = content ? _this.content : _this.header;\n            var frozenRow = _this.parent.frozenRows;\n            var batchLen = 0;\n            if (frozenRow && _this.parent.editSettings.mode === 'Batch') {\n                batchLen = _this.parent.getHeaderContent().querySelectorAll('.e-insertedrow').length +\n                    _this.parent.getHeaderContent().querySelectorAll('.e-hiddenrow').length;\n            }\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.parent.groupSettings.columns) && _this.parent.groupSettings.columns.length && frozenRow && content) {\n                frozenRow = 0;\n                for (var i = 0; i < e.rows.length; i++) {\n                    frozenRow++;\n                    if (e.rows[parseInt(i.toString(), 10)].index + 1 === _this.parent.frozenRows) {\n                        break;\n                    }\n                }\n                _this.groupedFrozenRow = frozenRow;\n            }\n            var rows = content ? e.rows.slice(frozenRow + batchLen) : e.rows;\n            var updateRow = content ? e.rows.slice(0, frozenRow + batchLen) : e.rows;\n            if (_this.parent.isCollapseStateEnabled() && content) {\n                rows = rows.filter(function (x) { return x.visible !== false; });\n            }\n            var isRowTemplate = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(_this.parent.rowTemplate);\n            if (frozenRow && ((_this.parent.editSettings.mode === 'Batch' && content && (e.name === 'batchDelete' || e.name === 'batchAdd' ||\n                e.name === 'batchCancel' || (e.args && (e.args.requestType === 'batchsave')))) ||\n                (e.args && (e.args.requestType === 'delete' || e.args.requestType === 'save')))) {\n                var matrixcs = _this.header.matrix.matrix;\n                var hdrLen = _this.parent.headerModule.rows.length;\n                matrixcs.splice(hdrLen, matrixcs.length - hdrLen);\n            }\n            var matrix = cFocus.matrix.generate(updateRow, cFocus.selector, isRowTemplate);\n            cFocus.matrix.generate(rows, cFocus.selector, isRowTemplate);\n            var isScroll = _this.parent.enableVirtualization || _this.parent.enableInfiniteScrolling;\n            if ((_this.parent.editSettings.showAddNewRow && content && _this.header && _this.header.matrix) &&\n                (!isScroll || (isScroll && _this.parent.isAddNewRow))) {\n                var tempMatrix = _this.header.matrix.matrix;\n                var lastRowHeaderIdx = _this.parent.allowFiltering && _this.parent.filterSettings.type === 'FilterBar' ? 2 : 1;\n                cFocus.matrix.rows = _this.parent.frozenRows && _this.parent.editSettings.newRowPosition === 'Top' ?\n                    cFocus.matrix.rows : ++cFocus.matrix.rows;\n                if (_this.parent.editSettings.newRowPosition === 'Top') {\n                    (_this.parent.frozenRows || isScroll ?\n                        matrix : cFocus.matrix.matrix).unshift(_this.refreshAddNewRowMatrix(tempMatrix[tempMatrix.length -\n                        lastRowHeaderIdx]));\n                }\n                else {\n                    cFocus.matrix.matrix.push(_this.refreshAddNewRowMatrix(tempMatrix[tempMatrix.length - lastRowHeaderIdx]));\n                }\n                _this.parent.isAddNewRow = false;\n            }\n            if (!(_this.parent.isFrozenGrid() && (e.args && (e.args.requestType === 'sorting'\n                || e.args.requestType === 'batchsave' || e.args.requestType === 'paging'))) ||\n                (frozenRow && _this.parent.editSettings.mode === 'Batch' && content && (e.name === 'batchDelete' || e.name === 'batchAdd' ||\n                    e.name === 'batchCancel' || e.args.requestType === 'batchsave'))) {\n                cFocus.generateRows(updateRow, {\n                    matrix: matrix, handlerInstance: _this.header\n                });\n            }\n            if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice && e && e.args) {\n                if (!_this.focusByClick && e.args.requestType === 'paging' && !_this.parent.pagerModule.pagerObj.checkPagerHasFocus()) {\n                    _this.skipFocus = false;\n                    _this.parent.element.focus();\n                }\n                if (e.args.requestType === 'grouping') {\n                    _this.skipFocus = true;\n                }\n            }\n            if (e && e.args && e.args.requestType === 'virtualscroll') {\n                if (_this.currentInfo.uid) {\n                    var index_1;\n                    var bool = e.rows.some(function (row, i) {\n                        index_1 = i;\n                        return row.uid === _this.currentInfo.uid;\n                    });\n                    if (bool) {\n                        _this.content.matrix.current[0] = index_1;\n                        _this.content.matrix.current[1] = _this.parent.getColumnIndexByUid(_this.focusedColumnUid) || 0;\n                        var frzLeftCount = _this.parent.getVisibleFrozenLeftCount();\n                        var frzRightCount = _this.parent.getVisibleFrozenRightCount();\n                        if (_this.parent.enableColumnVirtualization && !(frzLeftCount && frzRightCount) && _this.parent.isFrozenGrid() &&\n                            e.args.virtualInfo.direction === 'right') {\n                            _this.content.matrix.current[1] = _this.content.matrix.current[1] - (frzLeftCount + (frzRightCount ? frzRightCount + 1 : 0));\n                        }\n                        var isGroup = _this.parent.allowGrouping && _this.parent.groupSettings.columns.length ? true : false;\n                        if (isGroup) {\n                            _this.content.matrix.current[1] = _this.prevIndexes.cellIndex;\n                            if (_this.virtualSelectionInfo.isPending) {\n                                _this.content.matrix.current[0] = _this.virtualSelectionInfo.direction === 'downArrow' ? _this.content.matrix.current[0] + 1\n                                    : _this.content.matrix.current[0] - 1;\n                            }\n                        }\n                        var focusElement = _this.getContent().getFocusInfo().elementToFocus;\n                        if (focusElement) {\n                            var cellPosition = focusElement.getBoundingClientRect();\n                            var gridPosition = _this.parent.element.getBoundingClientRect();\n                            var freezeLeftColWidth = 0;\n                            var freezeRightColWidth = 0;\n                            if (_this.parent.enableColumnVirtualization && !(frzLeftCount && frzRightCount) && _this.parent.isFrozenGrid() &&\n                                e.args.virtualInfo.direction === 'right') {\n                                if (frzLeftCount) {\n                                    freezeLeftColWidth = _this.parent.leftrightColumnWidth('left');\n                                }\n                                else {\n                                    freezeRightColWidth = _this.parent.leftrightColumnWidth('right');\n                                }\n                            }\n                            if ((cellPosition.top >= 0 && cellPosition.left >= 0 &&\n                                (cellPosition.right - freezeLeftColWidth - freezeRightColWidth) <= (Math.min(gridPosition.right, window.innerWidth || document.documentElement.clientWidth) + freezeRightColWidth)\n                                && cellPosition.bottom <= Math.min(gridPosition.bottom, window.innerHeight ||\n                                    document.documentElement.clientHeight)) || isGroup) {\n                                _this.isVirtualScroll = true;\n                                _this.focus(isGroup && _this.virtualSelectionInfo.isPending ?\n                                    _this.virtualSelectionInfo.event : undefined);\n                            }\n                        }\n                    }\n                }\n                else if (e.args.focusElement && e.args.focusElement.classList.contains('e-filtertext')) {\n                    var focusElement = _this.parent.element.querySelector('#' + e.args.focusElement.id);\n                    if (focusElement) {\n                        focusElement.focus();\n                    }\n                }\n                _this.virtualSelectionInfo = {};\n            }\n            if (e && e.args && e.args.requestType === 'infiniteScroll') {\n                _this.isInfiniteScroll = true;\n            }\n        };\n    };\n    FocusStrategy.prototype.refreshAddNewRowMatrix = function (matrix) {\n        var cols = this.parent.getColumns();\n        var indent = this.parent.getIndentCount();\n        for (var i = indent; i < matrix.length - 1; i++) {\n            if (cols[i - indent] && cols[i - indent].visible && cols[i - indent].allowEditing) {\n                matrix[parseInt(i.toString(), 10)] = 1;\n            }\n            else {\n                matrix[parseInt(i.toString(), 10)] = 0;\n            }\n        }\n        return matrix;\n    };\n    FocusStrategy.prototype.addEventListener = function () {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'mousedown', this.focusCheck, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'touchstart', this.focusCheck, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'focus', this.onFocus, this);\n        this.parent.element.addEventListener('focus', this.passiveHandler = function (e) { return _this.passiveFocus(e); }, true);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.parent.element, 'focusout', this.onBlur, this);\n        this.evtHandlers = [{ event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.keyPressed, handler: this.onKeyPress },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.click, handler: this.onClick },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.contentReady, handler: this.refMatrix },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.partialRefresh, handler: this.refMatrix },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.refreshExpandandCollapse, handler: this.refMatrix },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.showAddNewRowFocus, handler: this.showAddNewRowFocus },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.headerRefreshed, handler: this.refreshMatrix() },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.closeEdit, handler: this.restoreFocus },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.restoreFocus, handler: this.restoreFocus },\n            { event: 'start-edit', handler: this.clearIndicator },\n            { event: 'start-add', handler: this.clearIndicator },\n            { event: 'sorting-complete', handler: this.restoreFocus },\n            { event: 'filtering-complete', handler: this.filterfocus },\n            { event: 'custom-filter-close', handler: this.filterfocus },\n            { event: 'grouping-complete', handler: this.restoreFocusWithAction },\n            { event: 'ungrouping-complete', handler: this.restoreFocusWithAction },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.batchAdd, handler: this.refMatrix },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.batchCancel, handler: this.refMatrix },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.batchDelete, handler: this.refMatrix },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.detailDataBound, handler: this.refMatrix },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.onEmpty, handler: this.refMatrix },\n            { event: _base_constant__WEBPACK_IMPORTED_MODULE_5__.cellFocused, handler: this.internalCellFocus }];\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.addRemoveEventListener)(this.parent, this.evtHandlers, true, this);\n    };\n    FocusStrategy.prototype.showAddNewRowFocus = function () {\n        if (this.parent.editSettings.showAddNewRow) {\n            var startIdx = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.content.matrix.matrix.length - 1;\n            var startCellIdx = this.parent.getIndentCount();\n            if (this.parent.editSettings.newRowPosition === 'Top' && (this.parent.frozenRows ||\n                this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n                var headrIdx = this.header.matrix.matrix.length - (this.groupedFrozenRow ?\n                    this.groupedFrozenRow : this.parent.frozenRows);\n                startCellIdx = this.findNextCellFocus(this.header.matrix.matrix[headrIdx - 1], startCellIdx);\n                this.header.matrix.current = [headrIdx - 1, startCellIdx];\n                this.active = this.header;\n            }\n            else {\n                startCellIdx = this.findNextCellFocus(this.content.matrix.matrix[parseInt(startIdx.toString(), 10)], startCellIdx);\n                this.content.matrix.current = [startIdx, startCellIdx];\n                this.active = this.content;\n            }\n            var addedrow = this.parent.element.querySelector('.e-addedrow');\n            if (addedrow && addedrow.querySelectorAll('tr') &&\n                addedrow.querySelector('tr').cells[parseInt(startCellIdx.toString(), 10)].querySelector('input')) {\n                addedrow.querySelector('tr').cells[parseInt(startCellIdx.toString(), 10)].querySelector('input').select();\n            }\n        }\n    };\n    FocusStrategy.prototype.findNextCellFocus = function (matrix, cellIndex) {\n        for (var i = cellIndex; i < matrix.length; i++) {\n            if (matrix[parseInt(i.toString(), 10)] === 1) {\n                return i;\n            }\n        }\n        return cellIndex;\n    };\n    FocusStrategy.prototype.filterfocus = function () {\n        if (this.parent.filterSettings.type !== 'FilterBar') {\n            this.removeFocus();\n            this.restoreFocus();\n        }\n    };\n    FocusStrategy.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'mousedown', this.focusCheck);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'touchstart', this.focusCheck);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'focus', this.onFocus);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.parent.element, 'focusout', this.onBlur);\n        this.parent.element.removeEventListener('focus', this.passiveHandler, true);\n        (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.addRemoveEventListener)(this.parent, this.evtHandlers, false);\n    };\n    FocusStrategy.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    FocusStrategy.prototype.restoreFocus = function (arg) {\n        if (arg && arg.requestType === 'sorting' && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(arg.target)) {\n            return;\n        }\n        var groupModule = this.parent.groupModule;\n        if (this.parent.allowGrouping && groupModule && (groupModule.groupSortFocus || groupModule.groupTextFocus)) {\n            groupModule.groupSortFocus = false;\n            groupModule.groupTextFocus = false;\n            return;\n        }\n        this.firstHeaderCellClick = true;\n        this.addFocus(this.getContent().getFocusInfo());\n        var requestTypes = ['add', 'save', 'delete', 'cancel', 'batchsave', 'batchDelete', 'batchCancel'];\n        var focusInfo = this.getContent().getFocusInfo();\n        if (arg && requestTypes.indexOf(arg.requestType) > -1 && focusInfo && focusInfo.elementToFocus && focusInfo.elementToFocus.matches('.e-rowcell.e-focus')) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([focusInfo.elementToFocus], ['e-focused', 'e-focus']);\n        }\n    };\n    FocusStrategy.prototype.restoreFocusWithAction = function (e) {\n        if (!this.parent.enableInfiniteScrolling &&\n            !(this.parent.groupModule && this.parent.groupModule.preventFocusOnGroup)) {\n            var matrix = this.getContent().matrix;\n            var current = matrix.current;\n            switch (e.requestType) {\n                case 'grouping':\n                case 'ungrouping':\n                    current[1] = current.length &&\n                        !this.parent.groupSettings.showGroupedColumn && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(matrix.matrix[current[0]]) ?\n                        matrix.matrix[current[0]].indexOf(1) : e.requestType === 'grouping' ? current[1] + 1 : current[1] - 1;\n                    break;\n            }\n            this.getContent().matrix.current = current;\n            this.prevIndexes = { rowIndex: current[0], cellIndex: current[1] };\n            var groupModule = this.parent.groupModule;\n            if (this.parent.allowGrouping && groupModule && groupModule.groupCancelFocus) {\n                var focusableGroupedItems = groupModule.getFocusableGroupedItems();\n                if (focusableGroupedItems.length) {\n                    if (focusableGroupedItems[0].parentElement.getAttribute('ej-mappingname') === e.columnName) {\n                        focusableGroupedItems[3].focus();\n                    }\n                    else {\n                        focusableGroupedItems[0].focus();\n                    }\n                }\n                else {\n                    groupModule.element.focus();\n                }\n                groupModule.groupCancelFocus = false;\n                return;\n            }\n            this.addFocus(this.getContent().getFocusInfo());\n        }\n    };\n    FocusStrategy.prototype.clearIndicator = function () {\n        if (!this.currentInfo.element || !this.currentInfo.elementToFocus) {\n            return;\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focus', 'e-focused']);\n    };\n    FocusStrategy.prototype.getPrevIndexes = function () {\n        var forget = this.forget;\n        this.forget = false;\n        return forget || !Object.keys(this.prevIndexes).length ? { rowIndex: null, cellIndex: null } : this.prevIndexes;\n    };\n    FocusStrategy.prototype.forgetPrevious = function () {\n        this.forget = true;\n    };\n    FocusStrategy.prototype.setActiveByKey = function (action, active) {\n        if (this.parent.frozenRows === 0) {\n            return;\n        }\n        // eslint-disable-next-line prefer-const\n        var info;\n        var actions = {\n            'home': function () { return ({ toHeader: !info.isContent, toFrozen: true }); },\n            'end': function () { return ({ toHeader: !info.isContent, toFrozen: false }); },\n            'ctrlHome': function () { return ({ toHeader: true, toFrozen: false }); },\n            'ctrlEnd': function () { return ({ toHeader: false, toFrozen: false }); }\n        };\n        if (!(action in actions)) {\n            return;\n        }\n        info = active.getInfo();\n        var swap = actions[\"\" + action]();\n        this.setActive(!swap.toHeader);\n        this.getContent().matrix.current = active.matrix.current;\n    };\n    FocusStrategy.prototype.internalCellFocus = function (e) {\n        if (!(e.byKey && e.container.isContent && ((e.keyArgs.action === 'enter' && e.parent.classList.contains('e-detailcell')) ||\n            ((e.keyArgs.action === 'tab' || e.keyArgs.action === 'shiftTab') && e.parent.classList.contains('e-unboundcell'))))) {\n            return;\n        }\n        this.clearIndicator();\n        var focusEle;\n        if (e.parent && e.parent.closest('.e-unboundcell') && e.keyArgs.action === 'shiftTab') {\n            focusEle = this.commandColumnFocusElement(e.parent, true);\n        }\n        else {\n            focusEle = this.getContent().getFocusable(this.getFocusedElement());\n        }\n        this.setFocusedElement(focusEle);\n        this.currentInfo.skipAction = true;\n    };\n    FocusStrategy.prototype.commandColumnFocusElement = function (cell, isLast) {\n        var commandButtons = cell.querySelectorAll('button:not(.e-hide)');\n        return isLast ? commandButtons[commandButtons.length - 1] : commandButtons[0];\n    };\n    return FocusStrategy;\n}());\n\n/**\n * Create matrix from row collection which act as mental model for cell navigation\n *\n * @hidden\n */\nvar Matrix = /** @class */ (function () {\n    function Matrix() {\n        this.matrix = [];\n        this.current = [];\n    }\n    Matrix.prototype.set = function (rowIndex, columnIndex, allow) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.columns));\n        this.matrix[parseInt(rowIndex.toString(), 10)] = this.matrix[parseInt(rowIndex.toString(), 10)] || [];\n        this.matrix[parseInt(rowIndex.toString(), 10)][parseInt(columnIndex.toString(), 10)] = allow ? 1 : 0;\n    };\n    Matrix.prototype.get = function (rowIndex, columnIndex, navigator, action, validator, active) {\n        var tmp = columnIndex;\n        if (rowIndex + navigator[0] < 0) {\n            return [rowIndex, columnIndex];\n        }\n        rowIndex = Math.max(0, Math.min(rowIndex + navigator[0], this.rows));\n        var emptyTable = true;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.matrix[parseInt(rowIndex.toString(), 10)])) {\n            return null;\n        }\n        columnIndex = Math.max(0, Math.min(columnIndex + navigator[1], this.matrix[parseInt(rowIndex.toString(), 10)].length - 1));\n        if (tmp + navigator[1] > this.matrix[parseInt(rowIndex.toString(), 10)].length - 1\n            && validator(rowIndex, columnIndex, action)) {\n            return [rowIndex, tmp];\n        }\n        var first = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n        columnIndex = first === null ? tmp : first;\n        var val = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(rowIndex + \".\" + columnIndex, this.matrix);\n        if (rowIndex === this.rows && (action === 'downArrow' || action === 'enter')) {\n            navigator[0] = -1;\n        }\n        var cell;\n        if (active) {\n            var rows = this.getRowsFromIndex(rowIndex, active);\n            cell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(rowIndex + \".cells.\" + columnIndex, rows);\n        }\n        if (cell && cell.getBoundingClientRect().width === 0) {\n            var current = this.nextVisibleCellFocus(rowIndex, columnIndex, action, navigator, active, tmp);\n            rowIndex = current[0];\n            columnIndex = current[1];\n        }\n        if (first === null) {\n            for (var i = 0; i < this.rows; i++) {\n                if (this.matrix[parseInt(i.toString(), 10)].some(function (v) { return v === 1; })) {\n                    emptyTable = false;\n                    break;\n                }\n            }\n            if (emptyTable) {\n                rowIndex = this.current.length ? this.current[0] : 0;\n                return [rowIndex, columnIndex];\n            }\n        }\n        return this.inValid(val) || !validator(rowIndex, columnIndex, action) ?\n            this.get(rowIndex, tmp, navigator, action, validator) : [rowIndex, columnIndex];\n    };\n    Matrix.prototype.getRowsFromIndex = function (rowIndex, active) {\n        return active.getTable().rows[parseInt(rowIndex.toString(), 10)].classList.contains('e-addedrow') ?\n            active.getTable().rows[parseInt(rowIndex.toString(), 10)].querySelector('table').rows : active.getTable().rows;\n    };\n    Matrix.prototype.nextVisibleCellFocus = function (rowIndex, columnIndex, action, navigator, active, tmp) {\n        var rows = this.getRowsFromIndex(rowIndex, active);\n        var cell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(rowIndex + \".cells.\" + columnIndex, rows);\n        var rowMatrix = active.matrix.matrix;\n        var maxRow = rowMatrix.length - 1;\n        var isTab = action === 'tab';\n        var isShiftTab = action === 'shiftTab';\n        var skipAction = action === 'enter' || action === 'shiftEnter' || action === 'downArrow' || action === 'upArrow';\n        if (skipAction) {\n            return [rowIndex, columnIndex];\n        }\n        while (cell && cell.getBoundingClientRect().width === 0) {\n            if ((isTab && rowIndex === maxRow && columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1)) ||\n                (isShiftTab && rowIndex === 0 && columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1))) {\n                columnIndex = tmp;\n                return [rowIndex, columnIndex];\n            }\n            if (isTab) {\n                if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1)) {\n                    rowIndex++;\n                    columnIndex = rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1);\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                    rows = this.getRowsFromIndex(rowIndex, active);\n                }\n                else {\n                    columnIndex++;\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                }\n            }\n            else if (isShiftTab) {\n                if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1)) {\n                    rowIndex--;\n                    columnIndex = rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1);\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                    rows = this.getRowsFromIndex(rowIndex, active);\n                }\n                else {\n                    columnIndex--;\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                }\n            }\n            else if ((action === 'rightArrow' || action === 'shiftRight')) {\n                if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].lastIndexOf(1)) {\n                    columnIndex = tmp;\n                }\n                else {\n                    columnIndex++;\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                }\n            }\n            else if ((action === 'leftArrow' || action === 'shiftLeft')) {\n                if (columnIndex === rowMatrix[parseInt(rowIndex.toString(), 10)].indexOf(1)) {\n                    columnIndex = tmp;\n                }\n                else {\n                    columnIndex--;\n                    columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n                }\n            }\n            else if (action === null) {\n                columnIndex++;\n                columnIndex = this.first(this.matrix[parseInt(rowIndex.toString(), 10)], columnIndex, navigator, true, action);\n            }\n            cell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(rowIndex + \".cells.\" + columnIndex, rows);\n        }\n        return [rowIndex, columnIndex];\n    };\n    Matrix.prototype.first = function (vector, index, navigator, moveTo, action) {\n        if (((index < 0 || index === vector.length) && this.inValid(vector[parseInt(index.toString(), 10)])\n            && (action !== 'upArrow' && action !== 'downArrow')) || !vector.some(function (v) { return v === 1; })) {\n            return null;\n        }\n        return !this.inValid(vector[parseInt(index.toString(), 10)]) ? index :\n            this.first(vector, (['upArrow', 'downArrow', 'shiftUp', 'shiftDown', 'enter', 'shiftEnter'].indexOf(action) !== -1) ? moveTo ? 0 : ++index :\n                index + navigator[1], navigator, false, action);\n    };\n    Matrix.prototype.select = function (rowIndex, columnIndex) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.matrix[parseInt(rowIndex.toString(), 10)].length - 1));\n        this.current = [rowIndex, columnIndex];\n    };\n    Matrix.prototype.generate = function (rows, selector, isRowTemplate) {\n        this.rows = rows.length - 1;\n        this.matrix = [];\n        for (var i = 0; i < rows.length; i++) {\n            var cells = rows[parseInt(i.toString(), 10)].cells.filter(function (c) { return c.isSpanned !== true; });\n            this.columns = Math.max(cells.length - 1, this.columns | 0);\n            var incrementNumber = 0;\n            for (var j = 0; j < cells.length; j++) {\n                if (cells[parseInt(j.toString(), 10)].column && cells[parseInt(j.toString(), 10)].column.columns) {\n                    incrementNumber = this.columnsCount(cells[parseInt(j.toString(), 10)].column.columns, incrementNumber);\n                }\n                else {\n                    incrementNumber++;\n                }\n                this.set(i, j, rows[parseInt(i.toString(), 10)].visible === false ?\n                    false : selector(rows[parseInt(i.toString(), 10)], cells[parseInt(j.toString(), 10)], isRowTemplate));\n            }\n            this.columns = Math.max(incrementNumber - 1, this.columns | 0);\n        }\n        return this.matrix;\n    };\n    Matrix.prototype.columnsCount = function (rowColumns, currentColumnCount) {\n        var columns = rowColumns;\n        var incrementNumber = currentColumnCount;\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[parseInt(i.toString(), 10)].columns) {\n                incrementNumber = this.columnsCount(columns[parseInt(i.toString(), 10)].columns, incrementNumber);\n            }\n            else {\n                incrementNumber++;\n            }\n        }\n        return incrementNumber;\n    };\n    Matrix.prototype.inValid = function (value) {\n        return value === 0 || value === undefined;\n    };\n    return Matrix;\n}());\n\n/**\n * @hidden\n */\nvar ContentFocus = /** @class */ (function () {\n    function ContentFocus(parent) {\n        var _this = this;\n        this.matrix = new Matrix();\n        this.lastIdxCell = false;\n        this.parent = parent;\n        this.keyActions = {\n            'rightArrow': [0, 1],\n            'tab': [0, 1],\n            'leftArrow': [0, -1],\n            'shiftTab': [0, -1],\n            'upArrow': [-1, 0],\n            'downArrow': [1, 0],\n            'shiftUp': [-1, 0],\n            'shiftDown': [1, 0],\n            'shiftRight': [0, 1],\n            'shiftLeft': [0, -1],\n            'enter': [1, 0],\n            'shiftEnter': [-1, 0]\n        };\n        this.indexesByKey = function (action) {\n            var opt = {\n                'home': [_this.matrix.current[0], -1, 0, 1],\n                'end': [_this.matrix.current[0], _this.matrix.columns + 1, 0, -1],\n                'ctrlHome': [0, -1, 0, 1],\n                'ctrlEnd': [_this.matrix.rows, _this.matrix.columns + 1, 0, -1]\n            };\n            return opt[\"\" + action] || null;\n        };\n    }\n    ContentFocus.prototype.getTable = function () {\n        return (this.parent.getContentTable());\n    };\n    ContentFocus.prototype.onKeyPress = function (e) {\n        var isMacLike = /(Mac)/i.test(navigator.platform);\n        if (isMacLike && e.metaKey) {\n            if (e.action === 'home') {\n                e.action = 'ctrlHome';\n            }\n            else if (e.action === 'end') {\n                e.action = 'ctrlEnd';\n            }\n            else if (['downArrow', 'upArrow', 'leftArrow', 'rightArrow'].indexOf(e.action) !== -1) {\n                return;\n            }\n        }\n        var navigators = this.keyActions[e.action];\n        var current = this.getCurrentFromAction(e.action, navigators, e.action in this.keyActions, e);\n        if (!current) {\n            return;\n        }\n        if (((['tab', 'shiftTab'].indexOf(e.action) > -1 && this.matrix.current || []).toString() === current.toString())\n            || (this.parent.allowPaging && !this.parent.pagerModule.pagerObj.checkPagerHasFocus()\n                && this.matrix.current[0] === this.matrix.rows && ((this.parent.editSettings.mode === 'Batch'\n                && this.parent.editSettings.allowAdding && e.keyCode === 40) || (e.keyCode === 40)))) {\n            if (current.toString() === [this.matrix.rows, this.matrix.columns].toString() ||\n                current.toString() === [0, 0].toString() || (this.matrix.current[0] === this.matrix.rows &&\n                this.matrix.current.toString() === current.toString()) || (this.parent.allowGrouping &&\n                this.parent.infiniteScrollSettings.enableCache && current.toString() === [0, 1].toString())) {\n                return false;\n            }\n            else {\n                current = this.editNextRow(current[0], current[1], e.action);\n            }\n        }\n        this.matrix.select(current[0], current[1]);\n    };\n    ContentFocus.prototype.editNextRow = function (rowIndex, cellIndex, action) {\n        var gObj = this.parent;\n        var editNextRow = gObj.editSettings.allowNextRowEdit && (gObj.isEdit || gObj.isLastCellPrimaryKey);\n        var visibleIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);\n        var row = this.getTable().rows[parseInt(rowIndex.toString(), 10)];\n        var cell = gObj.editSettings.showAddNewRow && row.classList.contains('e-addedrow') ?\n            (row.querySelectorAll('td:not(.e-editcell)'))[parseInt(cellIndex.toString(), 10)]\n            : row.cells[parseInt(cellIndex.toString(), 10)];\n        if (action === 'tab' && editNextRow) {\n            rowIndex++;\n            var index = (this.getTable().rows[parseInt(rowIndex.toString(), 10)].getElementsByClassName('e-indentcell').length +\n                this.getTable().rows[parseInt(rowIndex.toString(), 10)].getElementsByClassName('e-detailrowcollapse').length);\n            cellIndex = visibleIndex + index;\n        }\n        if (action === 'shiftTab' && editNextRow) {\n            rowIndex--;\n            cellIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length - 1].field);\n        }\n        return !cell.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.rowCell) && !cell.classList.contains('e-headercell') &&\n            !cell.classList.contains('e-groupcaption') && !cell.classList.contains('e-filterbarcell') ?\n            this.editNextRow(rowIndex, cellIndex, action) : [rowIndex, cellIndex];\n    };\n    ContentFocus.prototype.getCurrentFromAction = function (action, navigator, isPresent, e) {\n        if (navigator === void 0) { navigator = [0, 0]; }\n        if (!isPresent && !this.indexesByKey(action) || (this.matrix.current.length === 0)) {\n            return null;\n        }\n        if (!this.shouldFocusChange(e)) {\n            return this.matrix.current;\n        }\n        // eslint-disable-next-line\n        var _a = this.indexesByKey(action) || this.matrix.current.concat(navigator), rowIndex = _a[0], cellIndex = _a[1], rN = _a[2], cN = _a[3];\n        if (this.parent.allowGrouping && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.groupSettings.columns) && this.parent.groupSettings.columns.length && this.parent.aggregates.length && action === 'enter') {\n            for (var i = rowIndex; i < this.matrix.matrix.length; i++) {\n                var row = this.getTable().rows[i + 1];\n                if (row && row.cells[parseInt(cellIndex.toString(), 10)] && row.cells[parseInt(cellIndex.toString(), 10)].classList.contains('e-rowcell')) {\n                    return [i + 1, cellIndex];\n                }\n                if (i === this.matrix.matrix.length - 1) {\n                    return [rowIndex, cellIndex];\n                }\n            }\n        }\n        if (action === 'ctrlEnd' || action === 'end') {\n            var lastContentCellIndex = [this.matrix.matrix.length - 1,\n                this.matrix.matrix[this.matrix.matrix.length - 1].length - 1];\n            if (action === 'end') {\n                lastContentCellIndex = [rowIndex, this.matrix.matrix[parseInt(rowIndex.toString(), 10)].length - 1];\n            }\n            if (this.matrix.matrix[lastContentCellIndex[0]][lastContentCellIndex[1]] === 0) {\n                lastContentCellIndex = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.findCellIndex)(this.matrix.matrix, lastContentCellIndex, false);\n            }\n            rowIndex = lastContentCellIndex[0];\n            cellIndex = lastContentCellIndex[1] + 1;\n        }\n        var current = this.matrix.get(rowIndex, cellIndex, [rN, cN], action, this.validator(), this);\n        return current;\n    };\n    ContentFocus.prototype.checkRowCellFocus = function (target) {\n        return target.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.rowCell) ? target.classList.contains('e-focused') : true;\n    };\n    ContentFocus.prototype.onClick = function (e, force) {\n        var target = e.target;\n        this.target = target;\n        target = (target.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.rowCell) ? target : (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, 'td'));\n        target = target ? target : (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, 'td.e-detailrowcollapse')\n            || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, 'td.e-detailrowexpand');\n        target = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, 'td.e-detailcell') ?\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, '.e-grid'), 'td.e-detailcell')) ? null : target : target;\n        target = target && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, 'table').classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.table) ? target : null;\n        if (!target) {\n            return false;\n        }\n        var rowIdx = target.parentElement.rowIndex;\n        if (this.parent.editSettings.showAddNewRow && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(target, 'e-addedrow')) {\n            rowIdx = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(target, 'e-addedrow').rowIndex;\n        }\n        var _a = [rowIdx, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var _b = this.matrix.current, oRowIndex = _b[0], oCellIndex = _b[1];\n        var val = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val) || (!force && oRowIndex === rowIndex && oCellIndex === cellIndex && this.checkRowCellFocus(target)) ||\n            (!(0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, _base_string_literals__WEBPACK_IMPORTED_MODULE_2__.rowCell) && !(0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-groupcaption')\n                && !(0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-recordpluscollapse') && !(0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-recordplusexpand')\n                && !(0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-detailrowcollapse') && !(0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-detailrowexpand')\n                && !(0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(e.target, 'e-templatecell'))) {\n            return false;\n        }\n        this.matrix.select(rowIndex, cellIndex);\n    };\n    ContentFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        this.matrix.current = [rowIndex, cellIndex];\n        var row = this.getTable().rows[parseInt(rowIndex.toString(), 10)];\n        info.element = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row) ? this.parent.editSettings.showAddNewRow && row.classList.contains('e-addedrow') ?\n            (row.querySelectorAll('td:not(.e-editcell)'))[parseInt(cellIndex.toString(), 10)]\n            : row.cells[parseInt(cellIndex.toString(), 10)] : null;\n        if (!info.element) {\n            return info;\n        }\n        info.elementToFocus = (!info.element.classList.contains('e-unboundcell') || (this.parent.editSettings.showAddNewRow &&\n            info.element.classList.contains('e-unboundcell') && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(info.element, 'e-addedrow'))) &&\n            !info.element.classList.contains('e-detailcell') ? this.getFocusable(info.element) : info.element;\n        info.elementToFocus = info.element.classList.contains('e-detailcell') && info.element.querySelector('.e-childgrid')\n            ? info.element.querySelector('.e-childgrid') : info.elementToFocus;\n        if (this.parent.editSettings.mode === 'Batch' && this.parent.isEdit && info.elementToFocus.tagName.toLowerCase() === 'input'\n            && info.elementToFocus.classList.contains('e-dropdownlist')) {\n            info.elementToFocus = info.elementToFocus.parentElement;\n        }\n        info.outline = true;\n        info.uid = info.element.parentElement.getAttribute('data-uid');\n        return info;\n    };\n    ContentFocus.prototype.getFocusable = function (element) {\n        var query = 'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n        var isTemplate = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(element, '.e-templatecell'));\n        if (this.parent.isEdit) {\n            var commandCellQuery = this.parent.editSettings.showAddNewRow && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(element, 'e-addedrow') ?\n                ', button:not(.e-hide)' : '';\n            query = 'input:not([type=\"hidden\"]), select:not([aria-hidden=\"true\"]), textarea' + commandCellQuery;\n        }\n        var child = [].slice.call(element.querySelectorAll(query));\n        if (element.classList.contains('e-fltrtemp')) {\n            var focusElement = [].slice.call(element.querySelectorAll('.e-fltrtemp-focus'));\n            if (this.focusType === 'click' && this.target && this.target.classList.contains('e-fltrtemp-focus')) {\n                return this.target;\n            }\n            else if (this.focusType === 'key' && focusElement.length && (this.action === 'tab' || this.action === 'shiftTab')) {\n                var elementIndex = focusElement.indexOf(this.currentTarget);\n                return elementIndex === -1 ? focusElement[this.action === 'tab' ? 0 : focusElement.length - 1]\n                    : focusElement[this.action === 'tab' ? elementIndex + 1 : elementIndex - 1];\n            }\n        }\n        /* Select the first focusable child element\n         * if no child found then select the cell itself.\n         * if Grid is in editable state, check for editable control inside child.\n         */\n        return child.length ? isTemplate && child.length > 1 && !(this.parent.editSettings.mode === 'Batch'\n            && this.parent.isEdit && this.target) ? this.target ? this.target : element : child[0] : element;\n    };\n    ContentFocus.prototype.selector = function (row, cell, isRowTemplate) {\n        var types = [_base_enum__WEBPACK_IMPORTED_MODULE_6__.CellType.Expand, _base_enum__WEBPACK_IMPORTED_MODULE_6__.CellType.GroupCaption, _base_enum__WEBPACK_IMPORTED_MODULE_6__.CellType.CaptionSummary, _base_enum__WEBPACK_IMPORTED_MODULE_6__.CellType.GroupSummary];\n        return ((row.isDataRow && cell.visible && (cell.isDataCell || cell.isTemplate))\n            || (row.isDataRow && cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_6__.CellType.DetailExpand && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell.visible))\n            || (!row.isDataRow && types.indexOf(cell.cellType) > -1\n                && !((cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_6__.CellType.GroupSummary || cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_6__.CellType.CaptionSummary)\n                    && !(cell.isDataCell && cell.visible)))\n            || (cell.column && cell.visible && cell.column.type === 'checkbox')\n            || (cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_6__.CellType.CommandColumn)\n            || (row.isDataRow && isRowTemplate))\n            && !(row.edit === 'delete' && row.isDirty);\n    };\n    ContentFocus.prototype.nextRowFocusValidate = function (index) {\n        var lastIndex = index;\n        for (var i = index, len = this.matrix.rows; i <= len; i++) {\n            if (this.matrix.matrix[parseInt(index.toString(), 10)].indexOf(1) === -1) {\n                index = index + 1;\n            }\n            else {\n                return index;\n            }\n        }\n        this.lastIdxCell = true;\n        return lastIndex;\n    };\n    ContentFocus.prototype.previousRowFocusValidate = function (index) {\n        var firstIndex = index;\n        for (var i = index, len = 0; i >= len; i--) {\n            if (this.matrix.matrix[parseInt(index.toString(), 10)].indexOf(1) === -1) {\n                index = index - 1;\n                if (index < 0) {\n                    this.lastIdxCell = true;\n                    return firstIndex;\n                }\n            }\n            else {\n                return index;\n            }\n        }\n        return firstIndex;\n    };\n    ContentFocus.prototype.jump = function (action, current) {\n        this.lastIdxCell = false;\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        var headerSwap = (action === 'upArrow' || enterFrozen) && current[0] === 0;\n        if (this.matrix.matrix[current[0]]) {\n            if (action === 'tab' && this.matrix.matrix.length &&\n                current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) && this.matrix.matrix.length - 1 !== current[0]) {\n                this.matrix.current[0] = this.nextRowFocusValidate(this.matrix.current[0] + 1);\n                this.matrix.current[1] = -1;\n            }\n        }\n        if (action === 'shiftTab' &&\n            current[0] !== 0 && this.matrix.matrix[current[0]].indexOf(1) === current[1]) {\n            this.matrix.current[0] = this.previousRowFocusValidate(this.matrix.current[0] - 1);\n            this.matrix.current[1] = this.matrix.matrix[current[0]].length;\n        }\n        var isHeaderFocus = false;\n        var row = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(document.activeElement, 'e-addedrow') && this.parent.editSettings.showAddNewRow ?\n            (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(document.activeElement, 'e-addedrow') : document.activeElement.parentElement;\n        if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache)\n            && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row) && row.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.row)) {\n            var rowIndex = parseInt(row.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.ariaRowIndex), 10) - 1;\n            isHeaderFocus = rowIndex > 0;\n        }\n        var info = {\n            swap: !isHeaderFocus ? ((action === 'upArrow' || enterFrozen) && current[0] === 0) : false,\n            toHeader: headerSwap\n        };\n        return info;\n    };\n    ContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current = [];\n        if (action === 'rightArrow' || action === 'tab') {\n            current[0] = previous[0];\n            current[1] = -1;\n        }\n        if (action === 'downArrow' || action === 'enter') {\n            current[0] = -1;\n            current[1] = previous[1];\n        }\n        return current;\n    };\n    ContentFocus.prototype.generateRows = function (rows, optionals) {\n        var _a;\n        var matrix = optionals.matrix, handlerInstance = optionals.handlerInstance;\n        var len = handlerInstance.matrix.matrix.length;\n        var defaultLen = this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' ? len + 1 : len;\n        handlerInstance.matrix.matrix = handlerInstance.matrix.matrix.slice(0, defaultLen); //Header matrix update.\n        handlerInstance.matrix.rows = defaultLen;\n        (_a = handlerInstance.matrix.matrix).push.apply(_a, matrix);\n        handlerInstance.matrix.rows += matrix.length;\n    };\n    ContentFocus.prototype.getInfo = function (e) {\n        var info = this.getFocusInfo();\n        var _a = this.matrix.current, rIndex = _a[0], cIndex = _a[1];\n        var isData = info.element.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.rowCell);\n        var isSelectable = isData || (e && e.action !== 'enter' && (info.element.classList.contains('e-detailrowcollapse')\n            || info.element.classList.contains('e-detailrowexpand')));\n        // eslint-disable-next-line\n        var _b = [Math.min(parseInt(info.element.parentElement.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.ariaRowIndex), 10) - 1, rIndex),\n            Math.min(parseInt(info.element.getAttribute(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.ariaColIndex), 10) - 1, cIndex)], rowIndex = _b[0], cellIndex = _b[1];\n        if (this.parent.allowGrouping && this.parent.groupSettings.enableLazyLoading && isData) {\n            rowIndex = this.parent.getDataRows().indexOf(info.element.parentElement);\n        }\n        if (this.parent.enableVirtualization && this.parent.groupSettings.columns.length) {\n            rowIndex = rIndex;\n            cellIndex = cIndex;\n        }\n        if (this.parent.editSettings.showAddNewRow && this.parent.editSettings.newRowPosition === 'Top' &&\n            !this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling && e && e.action === 'downArrow') {\n            rowIndex++;\n        }\n        return { isContent: true, isDataCell: isData, indexes: [rowIndex, cellIndex], isSelectable: isSelectable };\n    };\n    ContentFocus.prototype.validator = function () {\n        var table = this.getTable();\n        return function (rowIndex, cellIndex, action) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(table.rows[parseInt(rowIndex.toString(), 10)])) {\n                var cell = void 0;\n                cellIndex = table.querySelector('.e-emptyrow') ? 0 : cellIndex;\n                if (table.rows[parseInt(rowIndex.toString(), 10)].cells[0].classList.contains('e-editcell')) {\n                    cell = table.rows[parseInt(rowIndex.toString(), 10)].cells[0].querySelectorAll('td')[parseInt(cellIndex.toString(), 10)];\n                }\n                else {\n                    cell = table.rows[parseInt(rowIndex.toString(), 10)].cells[parseInt(cellIndex.toString(), 10)];\n                }\n                var isCellWidth = cell.getBoundingClientRect().width !== 0;\n                if (action === 'enter' || action === 'shiftEnter') {\n                    return isCellWidth && cell.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.rowCell);\n                }\n                if ((action === 'shiftUp' || action === 'shiftDown') && cell.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.rowCell)) {\n                    return isCellWidth;\n                }\n                else if (action !== 'shiftUp' && action !== 'shiftDown') {\n                    return isCellWidth;\n                }\n            }\n            return false;\n        };\n    };\n    ContentFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, _b = _a[0], rIndex = _b === void 0 ? -1 : _b, _c = _a[1], cIndex = _c === void 0 ? -1 : _c;\n        if (rIndex < 0 || cIndex < 0) {\n            return true;\n        }\n        var cell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(rIndex + \".cells.\" + cIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'shiftEnter' ?\n            cell.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.rowCell) && !cell.classList.contains('e-unboundcell')\n                || cell.classList.contains('e-editedbatchcell') && !cell.classList.contains('e-detailcell') : true;\n    };\n    ContentFocus.prototype.getGridSeletion = function () {\n        return this.parent.allowSelection && this.parent.selectionSettings.allowColumnSelection;\n    };\n    return ContentFocus;\n}());\n\n/**\n * @hidden\n */\nvar HeaderFocus = /** @class */ (function (_super) {\n    __extends(HeaderFocus, _super);\n    function HeaderFocus(parent) {\n        return _super.call(this, parent) || this;\n    }\n    HeaderFocus.prototype.getTable = function () {\n        return (this.parent.getHeaderTable());\n    };\n    HeaderFocus.prototype.onClick = function (e) {\n        this.focusType = 'click';\n        var target = e.target;\n        this.target = target;\n        target = (target.classList.contains('e-headercell') ? target : (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(target, 'th'));\n        if (!target && (this.parent.frozenRows !== 0 || ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) &&\n            this.parent.editSettings.showAddNewRow))) {\n            target = (e.target.classList.contains(_base_string_literals__WEBPACK_IMPORTED_MODULE_2__.rowCell) ? e.target :\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.closest)(e.target, 'td'));\n        }\n        if (e.target.classList.contains('e-columnheader') ||\n            e.target.querySelector('.e-stackedheadercell')) {\n            return false;\n        }\n        if (!target) {\n            return;\n        }\n        var rowIdx = target.parentElement.rowIndex;\n        if (this.parent.editSettings.showAddNewRow && (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(target, 'e-addedrow')) {\n            rowIdx = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(target, 'e-addedrow').rowIndex;\n        }\n        var _a = [rowIdx, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var val = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val)) {\n            return false;\n        }\n        this.matrix.select(rowIdx, target.cellIndex);\n    };\n    HeaderFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        var row = this.getTable().rows[parseInt(rowIndex.toString(), 10)];\n        info.element = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(row) ? this.parent.editSettings.showAddNewRow && row.classList.contains('e-addedrow') ?\n            (row.querySelectorAll('td:not(.e-editcell)'))[parseInt(cellIndex.toString(), 10)]\n            : row.cells[parseInt(cellIndex.toString(), 10)] : null;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(info.element)) {\n            info.elementToFocus = this.getFocusable(info.element);\n            info.outline = !info.element.classList.contains('e-filterbarcell');\n        }\n        return info;\n    };\n    HeaderFocus.prototype.selector = function (row, cell) {\n        return (cell.visible && (cell.column.field !== undefined || cell.isTemplate || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell.column.template)\n            || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cell.column.commands) || cell.column.type === 'checkbox')) || cell.cellType === _base_enum__WEBPACK_IMPORTED_MODULE_6__.CellType.StackedHeader;\n    };\n    HeaderFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        var isLastCell;\n        var lastRow;\n        if (this.parent.enableHeaderFocus && action === 'tab') {\n            lastRow = this.matrix.matrix.length - 1 === current[0];\n            isLastCell = current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n            if (isLastCell) {\n                if (!lastRow) {\n                    this.matrix.current[0] = this.matrix.current[0] + 1;\n                }\n                else {\n                    this.matrix.current[0] = 0;\n                }\n                this.matrix.current[1] = -1;\n            }\n        }\n        return {\n            swap: ((action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1) ||\n                (action === 'tab' && lastRow && isLastCell)\n        };\n    };\n    HeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current1 = [];\n        if (action === 'rightArrow' || (action === 'shiftRight' && this.getGridSeletion()) || action === 'tab') {\n            current1[0] = previous[0];\n            current1[1] = -1;\n        }\n        if (action === 'upArrow' || action === 'shiftEnter') {\n            current1[0] = this.matrix.matrix.length;\n            current1[1] = previous[1];\n        }\n        return current1;\n    };\n    HeaderFocus.prototype.generateRows = function (rows) {\n        var length = this.matrix.matrix.length;\n        if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar') {\n            this.matrix.rows = ++this.matrix.rows;\n            var cells = rows[0].cells;\n            var incrementNumber = 0;\n            for (var i = 0; i < cells.length; i++) {\n                if (cells[parseInt(i.toString(), 10)].column && cells[parseInt(i.toString(), 10)].column.columns) {\n                    incrementNumber = this.checkFilterColumn(cells[parseInt(i.toString(), 10)].column.columns, length, incrementNumber);\n                }\n                else {\n                    this.matrix.set(length, incrementNumber, cells[parseInt(i.toString(), 10)].visible && cells[parseInt(i.toString(), 10)].column.allowFiltering !== false);\n                    incrementNumber++;\n                }\n            }\n        }\n    };\n    HeaderFocus.prototype.checkFilterColumn = function (rowColumns, rowIndex, columnIndex) {\n        var columns = rowColumns;\n        var incrementNumber = columnIndex;\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[parseInt(i.toString(), 10)].columns) {\n                incrementNumber = this.checkFilterColumn(columns[parseInt(i.toString(), 10)].columns, rowIndex, incrementNumber);\n            }\n            else {\n                this.matrix.set(rowIndex, incrementNumber, columns[parseInt(i.toString(), 10)].visible && columns[parseInt(i.toString(), 10)].allowFiltering !== false);\n                incrementNumber++;\n            }\n        }\n        return incrementNumber;\n    };\n    HeaderFocus.prototype.getInfo = function (e) {\n        return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(_super.prototype.getInfo.call(this, e), { isContent: false, isHeader: true });\n    };\n    HeaderFocus.prototype.validator = function () {\n        return function () { return true; };\n    };\n    HeaderFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, rowIndex = _a[0], columnIndex = _a[1];\n        if (rowIndex < 0 || columnIndex < 0) {\n            return true;\n        }\n        var cell = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(rowIndex + \".cells.\" + columnIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'altDownArrow' ? !cell.classList.contains('e-headercell') : true;\n    };\n    HeaderFocus.prototype.getHeaderType = function () {\n        return 'HeaderFocus';\n    };\n    return HeaderFocus;\n}(ContentFocus));\n\n/** @hidden */\nvar SearchBox = /** @class */ (function () {\n    function SearchBox(searchBox, serviceLocator) {\n        this.searchBox = searchBox;\n        this.serviceLocator = serviceLocator;\n        this.l10n = this.serviceLocator.getService('localization');\n    }\n    SearchBox.prototype.searchFocus = function (args) {\n        args.target.parentElement.classList.add('e-input-focus');\n        if (args.target.classList.contains('e-input') && args.target.classList.contains('e-search') && args.target.value) {\n            var sIcon = args.target.parentElement.querySelector('.e-sicon');\n            sIcon.classList.add('e-clear-icon');\n            sIcon.setAttribute('title', this.l10n.getConstant('Clear'));\n            (sIcon).style.cursor = 'pointer';\n        }\n    };\n    SearchBox.prototype.searchBlur = function (args) {\n        var relatedTarget = args.relatedTarget ? args.relatedTarget : null;\n        if (relatedTarget && relatedTarget.classList.contains('e-sicon')) {\n            if (relatedTarget.classList.contains('e-clear-icon')) {\n                args.target.parentElement.classList.remove('e-input-focus');\n            }\n        }\n        else {\n            args.target.parentElement.classList.remove('e-input-focus');\n        }\n        if (args.target.classList.contains('e-search') && ((relatedTarget && !(relatedTarget.classList.contains('e-sicon e-clear-icon'))\n            && !(relatedTarget.classList.contains('e-sicon'))) || (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(relatedTarget))) {\n            var sIcon = args.target.parentElement.querySelector('.e-sicon');\n            sIcon.classList.remove('e-clear-icon');\n            sIcon.removeAttribute('title');\n            sIcon.style.cursor = 'default';\n        }\n    };\n    SearchBox.prototype.wireEvent = function () {\n        if (this.searchBox) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.searchBox, 'focus', this.searchFocus, this);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.searchBox, 'blur', this.searchBlur, this);\n        }\n    };\n    SearchBox.prototype.unWireEvent = function () {\n        if (this.searchBox) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.searchBox, 'focus', this.searchFocus);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.searchBox, 'blur', this.searchBlur);\n        }\n    };\n    return SearchBox;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9mb2N1cy1zdHJhdGVneS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ3lGO0FBQ1o7QUFDdEM7QUFDRTtBQUNOO0FBQ3NCO0FBQ3lCO0FBQy9CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLG1FQUFpQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMseURBQU87QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUlBQWlJLCtEQUFxQjtBQUN0SjtBQUNBLHlEQUF5RCxXQUFXLDRDQUFHLEdBQUcsaUJBQWlCLElBQUk7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0Usd0RBQVk7QUFDNUU7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHlEQUFhO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw4REFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSw4REFBUTtBQUNwQjtBQUNBO0FB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O0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSw4REFBWTtBQUN4QixZQUFZLDhEQUFZO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDb0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9mb2N1cy1zdHJhdGVneS5qcz8wZGZhIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0IHsgRXZlbnRIYW5kbGVyLCBnZXRWYWx1ZSwgY2xvc2VzdCwgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBhZGRDbGFzcywgcmVtb3ZlQ2xhc3MsIGV4dGVuZCwgQnJvd3NlciB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IENlbGxUeXBlIH0gZnJvbSAnLi4vYmFzZS9lbnVtJztcbmltcG9ydCAqIGFzIGV2ZW50IGZyb20gJy4uL2Jhc2UvY29uc3RhbnQnO1xuaW1wb3J0IHsgUm93IH0gZnJvbSAnLi4vbW9kZWxzL3Jvdyc7XG5pbXBvcnQgeyBSb3dNb2RlbEdlbmVyYXRvciB9IGZyb20gJy4vcm93LW1vZGVsLWdlbmVyYXRvcic7XG5pbXBvcnQgeyBwYXJlbnRzVW50aWwsIGFkZFJlbW92ZUV2ZW50TGlzdGVuZXIsIGZpbmRDZWxsSW5kZXggfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0ICogYXMgbGl0ZXJhbHMgZnJvbSAnLi4vYmFzZS9zdHJpbmctbGl0ZXJhbHMnO1xuLyoqXG4gKiBGb2N1c1N0cmF0ZWd5IGNsYXNzXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgRm9jdXNTdHJhdGVneSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGb2N1c1N0cmF0ZWd5KHBhcmVudCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRJbmZvID0ge307XG4gICAgICAgIHRoaXMub25lVGltZSA9IHRydWU7XG4gICAgICAgIHRoaXMuc3dhcCA9IHt9O1xuICAgICAgICAvKiogQGhpZGRlbiAqL1xuICAgICAgICB0aGlzLmlzSW5maW5pdGVTY3JvbGwgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgdGhpcy52aXJ0dWFsU2VsZWN0aW9uSW5mbyA9IHt9O1xuICAgICAgICB0aGlzLmZvcmdldCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNraXBGb2N1cyA9IHRydWU7XG4gICAgICAgIHRoaXMuZm9jdXNCeUNsaWNrID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZmlyc3RIZWFkZXJDZWxsQ2xpY2sgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgdGhpcy5wcmV2SW5kZXhlcyA9IHt9O1xuICAgICAgICB0aGlzLnJlZk1hdHJpeCA9IHRoaXMucmVmcmVzaE1hdHJpeCh0cnVlKTtcbiAgICAgICAgdGhpcy5hY3Rpb25zID0gWydkb3duQXJyb3cnLCAndXBBcnJvdyddO1xuICAgICAgICB0aGlzLmlzVmlydHVhbFNjcm9sbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmdyb3VwZWRGcm96ZW5Sb3cgPSAwO1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5yb3dNb2RlbEdlbiA9IG5ldyBSb3dNb2RlbEdlbmVyYXRvcih0aGlzLnBhcmVudCk7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigpO1xuICAgIH1cbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5mb2N1c0NoZWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICB0aGlzLmZvY3VzQnlDbGljayA9IHRydWU7XG4gICAgICAgIHRoaXMuZmlyc3RIZWFkZXJDZWxsQ2xpY2sgPSB0cnVlO1xuICAgICAgICB0aGlzLnNraXBGb2N1cyA9IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZ3JpZCcpO1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUub25Gb2N1cyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0Rlc3Ryb3llZCB8fCBCcm93c2VyLmlzRGV2aWNlIHx8IHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uXG4gICAgICAgICAgICB8fCB0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLW1hc2tlZC10YWJsZScpIHx8ICghdGhpcy5wYXJlbnQuaXNJbml0aWFsTG9hZCAmJiBlXG4gICAgICAgICAgICAmJiBlLnRhcmdldCA9PT0gdGhpcy5wYXJlbnQuZWxlbWVudCAmJiB0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXNwaW4tc2hvdycpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0QWN0aXZlKCF0aGlzLnBhcmVudC5lbmFibGVIZWFkZXJGb2N1cyAmJiB0aGlzLnBhcmVudC5mcm96ZW5Sb3dzID09PSAwKTtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5lbmFibGVIZWFkZXJGb2N1cyAmJiAhdGhpcy5wYXJlbnQuZ2V0Q3VycmVudFZpZXdSZWNvcmRzKCkubGVuZ3RoICYmICgodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm1vZGUgIT09ICdCYXRjaCcpXG4gICAgICAgICAgICB8fCAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm1vZGUgPT09ICdCYXRjaCcgJiYgdGhpcy5wYXJlbnQuZWRpdE1vZHVsZSAmJiAhdGhpcy5wYXJlbnQuZWRpdE1vZHVsZS5nZXRCYXRjaENoYW5nZXMoKVtsaXRlcmFscy5hZGRlZFJlY29yZHNdLmxlbmd0aCkpKSB7XG4gICAgICAgICAgICB0aGlzLmdldENvbnRlbnQoKS5tYXRyaXguXG4gICAgICAgICAgICAgICAgZ2VuZXJhdGUodGhpcy5yb3dNb2RlbEdlbi5nZW5lcmF0ZVJvd3MoeyByb3dzOiBbbmV3IFJvdyh7IGlzRGF0YVJvdzogdHJ1ZSB9KV0gfSksIHRoaXMuZ2V0Q29udGVudCgpLnNlbGVjdG9yLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzLmdldENvbnRlbnQoKS5tYXRyaXguZ2V0KDAsIC0xLCBbMCwgMV0sIG51bGwsIHRoaXMuZ2V0Q29udGVudCgpLnZhbGlkYXRvcigpLCB0aGlzLmFjdGl2ZSk7XG4gICAgICAgIHRoaXMuZ2V0Q29udGVudCgpLm1hdHJpeC5zZWxlY3QoY3VycmVudFswXSwgY3VycmVudFsxXSk7XG4gICAgICAgIGlmICh0aGlzLnNraXBGb2N1cyAmJiAhKGUgJiYgZS50YXJnZXQgPT09IHRoaXMucGFyZW50LmVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzKGUpO1xuICAgICAgICAgICAgdGhpcy5za2lwRm9jdXMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUucGFzc2l2ZUZvY3VzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpcnN0SGVhZGVyQ2VsbCA9IHRoaXMucGFyZW50LmdldEhlYWRlckNvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuZS1oZWFkZXJjZWxsOm5vdCguZS1oaWRlKScpO1xuICAgICAgICBpZiAoZS50YXJnZXQgPT09IGZpcnN0SGVhZGVyQ2VsbCAmJiBlLnJlbGF0ZWRUYXJnZXQgJiYgIXBhcmVudHNVbnRpbChlLnJlbGF0ZWRUYXJnZXQsICdlLWdyaWQnKVxuICAgICAgICAgICAgJiYgIXRoaXMuZmlyc3RIZWFkZXJDZWxsQ2xpY2spIHtcbiAgICAgICAgICAgIHZhciBmaXJzdEhlYWRlckNlbGxJbmRleCA9IFswLCAwXTtcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZS5tYXRyaXgubWF0cml4W2ZpcnN0SGVhZGVyQ2VsbEluZGV4WzBdXVtmaXJzdEhlYWRlckNlbGxJbmRleFsxXV0gPT09IDApIHtcbiAgICAgICAgICAgICAgICBmaXJzdEhlYWRlckNlbGxJbmRleCA9IGZpbmRDZWxsSW5kZXgodGhpcy5hY3RpdmUubWF0cml4Lm1hdHJpeCwgZmlyc3RIZWFkZXJDZWxsSW5kZXgsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hY3RpdmUubWF0cml4LmN1cnJlbnQgPSBmaXJzdEhlYWRlckNlbGxJbmRleDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEluZm8uZWxlbWVudCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5mby5lbGVtZW50VG9Gb2N1cyA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEluZm8uZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1jaGVja3NlbGVjdGFsbCcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVGb2N1cygpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkRm9jdXModGhpcy5nZXRDb250ZW50KCkuZ2V0Rm9jdXNJbmZvKCksIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoW3RoaXMuY3VycmVudEluZm8uZWxlbWVudF0sIFsnZS1mb2N1c2VkJywgJ2UtZm9jdXMnXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maXJzdEhlYWRlckNlbGxDbGljayA9IGZhbHNlO1xuICAgICAgICBpZiAoZS50YXJnZXQgJiYgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWRldGFpbGNlbGwnKSkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5mby5za2lwQWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICBhZGRDbGFzcyhbdGhpcy5jdXJyZW50SW5mby5lbGVtZW50XSwgWydlLWZvY3VzZWQnLCAnZS1mb2N1cyddKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUub25CbHVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93UGFnaW5nICYmIHRoaXMucGFyZW50LnBhZ2VyTW9kdWxlLnBhZ2VyT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtcGFnZXJjb250YWluZXInKSkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1wYWdlcmNvbnRhaW5lcicpLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGUgYmVsb3cgYm9vbGVhbiBjb25kaXRpb24gZm9yIGdhbnR0IHRlYW0gZm9jdXMgZml4LlxuICAgICAgICB2YXIgaXNHYW50dCA9IHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ2FudHQnKSAmJiBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2Utcm93Y2VsbCcpXG4gICAgICAgICAgICAmJiAoIWlzTnVsbE9yVW5kZWZpbmVkKGUudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZylcbiAgICAgICAgICAgICAgICAmJiBlLnRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJvd2NlbGwnKSkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIGlmICgodGhpcy5wYXJlbnQuaXNFZGl0IHx8IGUgJiYgKCFlLnJlbGF0ZWRUYXJnZXQgfHwgY2xvc2VzdChlLnJlbGF0ZWRUYXJnZXQsICcuZS1ncmlkJykgfHwgY2xvc2VzdChlLnJlbGF0ZWRUYXJnZXQsICcuZS1ncmlkLXBvcHVwJykpXG4gICAgICAgICAgICAmJiAhKHRoaXMucGFyZW50LmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNoaWxkZ3JpZCcpICYmICF0aGlzLnBhcmVudC5lbGVtZW50Lm1hdGNoZXMoJzpmb2N1cy13aXRoaW4nKSkpXG4gICAgICAgICAgICAmJiAhKCFpc0dhbnR0ICYmIGlzTnVsbE9yVW5kZWZpbmVkKGUucmVsYXRlZFRhcmdldCkgJiYgcGFyc2VJbnQoZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdhcmlhLWNvbGluZGV4JyksIDEwKSAtIDEgPT09IDBcbiAgICAgICAgICAgICAgICAmJiBwYXJzZUludChlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2luZGV4JyksIDEwKSA9PT0gMCkgJiYgISghaXNHYW50dCAmJiBpc051bGxPclVuZGVmaW5lZChlLnJlbGF0ZWRUYXJnZXQpXG4gICAgICAgICAgICAmJiAhY2xvc2VzdChkb2N1bWVudC5hY3RpdmVFbGVtZW50LCAnLmUtZ3JpZCcpICYmICFpc051bGxPclVuZGVmaW5lZChlWydzb3VyY2VDYXBhYmlsaXRpZXMnXSkpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmVGb2N1cygpO1xuICAgICAgICB0aGlzLnNraXBGb2N1cyA9IHRydWU7XG4gICAgICAgIHRoaXMuY3VycmVudEluZm8uc2tpcEFjdGlvbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNldExhc3RDb250ZW50Q2VsbFRhYkluZGV4KCk7XG4gICAgICAgIHRoaXMuc2V0Rmlyc3RGb2N1c2FibGVUYWJJbmRleCgpO1xuICAgICAgICB0aGlzLmZpcnN0SGVhZGVyQ2VsbENsaWNrID0gZmFsc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuICovXG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuc2V0Rmlyc3RGb2N1c2FibGVUYWJJbmRleCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgZ09iai5lbGVtZW50LnRhYkluZGV4ID0gLTE7XG4gICAgICAgIGlmIChnT2JqLmFsbG93R3JvdXBpbmcgJiYgZ09iai5ncm91cFNldHRpbmdzLnNob3dEcm9wQXJlYSkge1xuICAgICAgICAgICAgdmFyIGdyb3VwTW9kdWxlID0gZ09iai5ncm91cE1vZHVsZTtcbiAgICAgICAgICAgIHZhciBmb2N1c2FibGVHcm91cGVkSXRlbXMgPSBncm91cE1vZHVsZS5nZXRGb2N1c2FibGVHcm91cGVkSXRlbXMoKTtcbiAgICAgICAgICAgIGlmIChmb2N1c2FibGVHcm91cGVkSXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGdyb3VwTW9kdWxlLmVsZW1lbnQudGFiSW5kZXggPSAtMTtcbiAgICAgICAgICAgICAgICBmb2N1c2FibGVHcm91cGVkSXRlbXNbMF0udGFiSW5kZXggPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ3JvdXBNb2R1bGUuZWxlbWVudC50YWJJbmRleCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdPYmoudG9vbGJhciB8fCBnT2JqLnRvb2xiYXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgdmFyIHRvb2xiYXJFbGVtZW50ID0gZ09iai50b29sYmFyTW9kdWxlLmVsZW1lbnQ7XG4gICAgICAgICAgICB2YXIgZm9jdXNhYmxlVG9vbGJhckl0ZW1zID0gdGhpcy5wYXJlbnQudG9vbGJhck1vZHVsZS5nZXRGb2N1c2FibGVUb29sYmFySXRlbXMoKTtcbiAgICAgICAgICAgIGlmIChmb2N1c2FibGVUb29sYmFySXRlbXMubGVuZ3RoID4gMCAmJiBmb2N1c2FibGVUb29sYmFySXRlbXNbMF0ucXVlcnlTZWxlY3RvcignLmUtdG9vbGJhci1pdGVtLWZvY3VzLC5lLWJ0biwuZS1pbnB1dCcpKSB7XG4gICAgICAgICAgICAgICAgdG9vbGJhckVsZW1lbnQudGFiSW5kZXggPSAtMTtcbiAgICAgICAgICAgICAgICBmb2N1c2FibGVUb29sYmFySXRlbXNbMF0ucXVlcnlTZWxlY3RvcignLmUtdG9vbGJhci1pdGVtLWZvY3VzLC5lLWJ0biwuZS1pbnB1dCcpLnRhYkluZGV4ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRvb2xiYXJFbGVtZW50LnRhYkluZGV4ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ09iai5nZXRDb2x1bW5zKCkubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgZmlyc3RIZWFkZXJDZWxsID0gZ09iai5nZXRIZWFkZXJDb250ZW50KCkucXVlcnlTZWxlY3RvcignLmUtaGVhZGVyY2VsbDpub3QoLmUtaGlkZSknKTtcbiAgICAgICAgICAgIGZpcnN0SGVhZGVyQ2VsbC50YWJJbmRleCA9IDA7XG4gICAgICAgICAgICB0aGlzLnNldEFjdGl2ZShmYWxzZSk7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuYWN0aXZlKSAmJiAoaXNOdWxsT3JVbmRlZmluZWQodGhpcy5hY3RpdmUudGFyZ2V0KSB8fCAhdGhpcy5hY3RpdmUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1jb2x1bW5tZW51JykpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0SGVhZGVyQ2VsbEluZGV4ID0gWzAsIDBdO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZS5tYXRyaXgubWF0cml4W2ZpcnN0SGVhZGVyQ2VsbEluZGV4WzBdXVtmaXJzdEhlYWRlckNlbGxJbmRleFsxXV0gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RIZWFkZXJDZWxsSW5kZXggPSBmaW5kQ2VsbEluZGV4KHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXgsIGZpcnN0SGVhZGVyQ2VsbEluZGV4LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUubWF0cml4LmN1cnJlbnQgPSBmaXJzdEhlYWRlckNlbGxJbmRleDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuc2V0TGFzdENvbnRlbnRDZWxsVGFiSW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb250ZW50VGFibGUgPSB0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKTtcbiAgICAgICAgaWYgKGNvbnRlbnRUYWJsZS5yb3dzW2NvbnRlbnRUYWJsZS5yb3dzLmxlbmd0aCAtIDFdKSB7XG4gICAgICAgICAgICB2YXIgbGFzdENlbGwgPSBjb250ZW50VGFibGUucm93c1tjb250ZW50VGFibGUucm93cy5sZW5ndGggLSAxXS5sYXN0RWxlbWVudENoaWxkO1xuICAgICAgICAgICAgbGFzdENlbGwudGFiSW5kZXggPSAwO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5vbkNsaWNrID0gZnVuY3Rpb24gKGUsIGZvcmNlLCBpc0ZvY3VzRmlyc3RDZWxsKSB7XG4gICAgICAgIGlmIChwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLWZpbHRlcmJhcmNlbGwnKSAmJiAocGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1tdWx0aXNlbGVjdCcpIHx8XG4gICAgICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaW5wdXQtZ3JvdXAtaWNvbicpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpc0NvbnRlbnQgPSAhaXNOdWxsT3JVbmRlZmluZWQoY2xvc2VzdChlLnRhcmdldCwgJy4nICsgbGl0ZXJhbHMuZ3JpZENvbnRlbnQpKTtcbiAgICAgICAgdmFyIGlzSGVhZGVyID0gIWlzTnVsbE9yVW5kZWZpbmVkKGNsb3Nlc3QoZS50YXJnZXQsICcuJyArIGxpdGVyYWxzLmdyaWRIZWFkZXIpKTtcbiAgICAgICAgaXNDb250ZW50ID0gaXNDb250ZW50ICYmIGlzSGVhZGVyID8gIWlzQ29udGVudCA6IGlzQ29udGVudDtcbiAgICAgICAgaWYgKCFpc0NvbnRlbnQgJiYgaXNOdWxsT3JVbmRlZmluZWQoY2xvc2VzdChlLnRhcmdldCwgJy4nICsgbGl0ZXJhbHMuZ3JpZEhlYWRlcikpIHx8XG4gICAgICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMuY29udGVudCkgfHwgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKGxpdGVyYWxzLmhlYWRlckNvbnRlbnQpIHx8XG4gICAgICAgICAgICAoIWlzTnVsbE9yVW5kZWZpbmVkKGNsb3Nlc3QoZS50YXJnZXQsICcuZS11bmJvdW5kY2VsbCcpKSAmJiAhZm9yY2UpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRBY3RpdmUoaXNDb250ZW50KTtcbiAgICAgICAgdmFyIGJlZm9yZUFyZ3MgPSB7IGNhbmNlbDogZmFsc2UsIGJ5S2V5OiBmYWxzZSwgYnlDbGljazogIWlzTnVsbE9yVW5kZWZpbmVkKGUudGFyZ2V0KSwgY2xpY2tBcmdzOiBlIH07XG4gICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudC5iZWZvcmVDZWxsRm9jdXNlZCwgYmVmb3JlQXJncyk7XG4gICAgICAgIGlmIChiZWZvcmVBcmdzLmNhbmNlbCB8fCAoY2xvc2VzdChlLnRhcmdldCwgJy5lLWlubGluZS1lZGl0JykgJiYgKCF0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJlxuICAgICAgICAgICAgKHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmICF0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWVkaXRlZHJvdycpKSkpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRBY3RpdmUoaXNDb250ZW50KTtcbiAgICAgICAgaWYgKHRoaXMuZ2V0Q29udGVudCgpKSB7XG4gICAgICAgICAgICB2YXIgcmV0dXJuVmFsID0gdGhpcy5nZXRDb250ZW50KCkub25DbGljayhlLCBmb3JjZSk7XG4gICAgICAgICAgICBpZiAocmV0dXJuVmFsID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmZvLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJvd2NlbGwnKSAmJiBlLnR5cGUgJiYgZS50eXBlID09PSAnY2xpY2snICYmICFpc0ZvY3VzRmlyc3RDZWxsKSB7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoW3RoaXMuY3VycmVudEluZm8uZWxlbWVudF0sIFsnZS1mb2N1c2VkJywgJ2UtZm9jdXMnXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNGb2N1c0ZpcnN0Q2VsbCAmJiBlICYmIGUudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoW2UudGFyZ2V0XSwgWydlLWZvY3VzZWQnLCAnZS1mb2N1cyddKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuaGFuZGxlRmlsdGVyTmF2aWdhdGlvbiA9IGZ1bmN0aW9uIChlLCBpbnB1dFNlbGVjdG9yLCBidXR0b25TZWxlY3Rvcikge1xuICAgICAgICBpZiAoZS50YXJnZXQgPT09IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaW5wdXRTZWxlY3RvcikgJiYgZS5rZXkgPT09ICdUYWInICYmIGUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYnV0dG9uU2VsZWN0b3IpLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZS50YXJnZXQgPT09IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYnV0dG9uU2VsZWN0b3IpICYmIGUua2V5ID09PSAnVGFiJyAmJiAhZS5zaGlmdEtleSAmJlxuICAgICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihidXR0b25TZWxlY3RvcikpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaW5wdXRTZWxlY3RvcikuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUub25LZXlQcmVzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbnRlbnQgJiYgdGhpcy5jb250ZW50LnRhcmdldCkge1xuICAgICAgICAgICAgdGhpcy5jb250ZW50LnRhcmdldCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93UGFnaW5nKSB7XG4gICAgICAgICAgICB2YXIgcGFnZXJFbGVtZW50ID0gdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouZWxlbWVudDtcbiAgICAgICAgICAgIHZhciBmb2N1c2FibGVQYWdlckVsZW1lbnRzID0gdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouZ2V0Rm9jdXNhYmxlUGFnZXJFbGVtZW50cyhwYWdlckVsZW1lbnQsIFtdKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5jaGlsZEdyaWQgJiYgIXBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JpZHBhZ2VyJykgJiYgdGhpcy5hbGxvd1RvUGFnaW5nKGUpICYmIGZvY3VzYWJsZVBhZ2VyRWxlbWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9jdXNhYmxlUGFnZXJFbGVtZW50c1swXS50YWJJbmRleCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouY2hlY2tQYWdlckhhc0ZvY3VzKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS5hY3Rpb24gPT09ICdzaGlmdFRhYicgJiYgZm9jdXNhYmxlUGFnZXJFbGVtZW50cy5sZW5ndGggJiYgZm9jdXNhYmxlUGFnZXJFbGVtZW50c1swXSA9PT0gZS50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXN0SGVhZGVyQ2VsbEluZGV4ID0gW3RoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXgubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXhbdGhpcy5hY3RpdmUubWF0cml4Lm1hdHJpeC5sZW5ndGggLSAxXS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXhbbGFzdEhlYWRlckNlbGxJbmRleFswXV1bbGFzdEhlYWRlckNlbGxJbmRleFsxXV0gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RIZWFkZXJDZWxsSW5kZXggPSBmaW5kQ2VsbEluZGV4KHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXgsIGxhc3RIZWFkZXJDZWxsSW5kZXgsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudCA9IHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5tb2RlID09PSAnQmF0Y2gnID9cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNWYWxpZEJhdGNoRWRpdENlbGwobGFzdEhlYWRlckNlbGxJbmRleCkgPyBsYXN0SGVhZGVyQ2VsbEluZGV4IDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmRCYXRjaEVkaXRDZWxsKGxhc3RIZWFkZXJDZWxsSW5kZXgsIGZhbHNlKSA6IGxhc3RIZWFkZXJDZWxsSW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1cyhlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIShlLmFjdGlvbiA9PT0gJ3RhYicgJiYgdGhpcy5wYXJlbnQuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY2hpbGRncmlkJylcbiAgICAgICAgICAgICAgICAgICAgJiYgKCghdGhpcy5wYXJlbnQucGFnZVNldHRpbmdzLnBhZ2VTaXplcyAmJiBmb2N1c2FibGVQYWdlckVsZW1lbnRzLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgZm9jdXNhYmxlUGFnZXJFbGVtZW50c1tmb2N1c2FibGVQYWdlckVsZW1lbnRzLmxlbmd0aCAtIDFdID09PSBlLnRhcmdldClcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8ICh0aGlzLnBhcmVudC5wYWdlck1vZHVsZS5wYWdlck9iai5nZXREcm9wRG93blBhZ2UoKSA9PT0gZS50YXJnZXQpKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouY2hhbmdlUGFnZXJGb2N1cyhlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudENlbGwgPSBwYXJlbnRzVW50aWwodGhpcy5wYXJlbnQuZWxlbWVudCwgJ2UtZGV0YWlsY2VsbCcpO1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhbdGhpcy5wYXJlbnQuZWxlbWVudF0sIFsnZS1mb2N1cyddKTtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoW3BhcmVudENlbGxdLCBbJ2UtZm9jdXNlZCddKTtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Q2VsbC50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5wYWdlck1vZHVsZS5wYWdlck9iai5lbGVtZW50LnRhYkluZGV4ID09PSAwICYmIChlLmtleUNvZGUgPT09IDM4IHx8IChlLnNoaWZ0S2V5ICYmIGUua2V5Q29kZSA9PT0gOSkpKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXMoZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouZWxlbWVudC50YWJJbmRleCA9PT0gMCAmJiBlLmtleUNvZGUgPT09IDkpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouc2V0UGFnZXJGb2N1cygpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5wYWdlck1vZHVsZS5wYWdlck9iai5jaGVja0ZpcnN0UGFnZXJGb2N1cygpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxhc3RSb3cgPSB0aGlzLmdldENvbnRlbnQoKS5tYXRyaXgucm93cztcbiAgICAgICAgICAgICAgICB2YXIgbGFzdENvbHVtbiA9IHRoaXMuZ2V0Q29udGVudCgpLm1hdHJpeC5jb2x1bW5zO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29udGVudCgpLm1hdHJpeC5jdXJyZW50ID0gW2xhc3RSb3csIGxhc3RDb2x1bW5dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnRXhjZWwnKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUZpbHRlck5hdmlnYXRpb24oZSwgJy5lLWV4Y2VsZmlsdGVyIC5lLW1lbnUtaXRlbTpub3QoLmUtZGlzYWJsZWQpJywgJy5lLWV4Y2VsZmlsdGVyIC5lLWZvb3Rlci1jb250ZW50IGJ1dHRvbjpudGgtY2hpbGQoMiknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MudHlwZSA9PT0gJ0NoZWNrQm94Jykge1xuICAgICAgICAgICAgdmFyIGZvY3VzZWRDb2x1bW4gPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5CeVVpZCh0aGlzLmZvY3VzZWRDb2x1bW5VaWQpO1xuICAgICAgICAgICAgdmFyIGZvY3VzVGFyZ2V0ID0gZm9jdXNlZENvbHVtbiAmJiBmb2N1c2VkQ29sdW1uLmZpbHRlciAmJiBmb2N1c2VkQ29sdW1uLmZpbHRlci5oaWRlU2VhcmNoYm94ID8gJy5lLWNoay1oaWRkZW4nIDogJy5lLXNlYXJjaGlucHV0LmUtaW5wdXQnO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVGaWx0ZXJOYXZpZ2F0aW9uKGUsIGZvY3VzVGFyZ2V0LCAnLmUtY2hlY2tib3hmaWx0ZXIgLmUtZm9vdGVyLWNvbnRlbnQgYnV0dG9uOm50aC1jaGlsZCgyKScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnTWVudScpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRmlsdGVyTmF2aWdhdGlvbihlLCAnLmUtZmxtZW51IC5lLWlucHV0LWdyb3VwLmUtcG9wdXAtZmxtZW51JywgJy5lLWZsbWVudSAuZS1mb290ZXItY29udGVudCBidXR0b246bnRoLWNoaWxkKDIpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LnNob3dDb2x1bW5DaG9vc2VyKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUZpbHRlck5hdmlnYXRpb24oZSwgJy5lLWNjZGxnIC5lLWNjc2VhcmNoLmUtY2MuZS1pbnB1dCcsICcuZS1jY2RsZyAuZS1mb290ZXItY29udGVudCBidXR0b246bnRoLWNoaWxkKDIpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc2tpcE9uKGUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUudGFyZ2V0ICYmIHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JpZGNvbnRlbnQnKSkge1xuICAgICAgICAgICAgdmFyIHJvd3MgPSBbXS5zbGljZS5jYWxsKHRoaXMucGFyZW50LmdldENvbnRlbnRUYWJsZSgpLnJvd3MpO1xuICAgICAgICAgICAgdmFyIGxhc3RDZWxsID0gcm93c1tyb3dzLmxlbmd0aCAtIDFdLmxhc3RFbGVtZW50Q2hpbGQ7XG4gICAgICAgICAgICBpZiAoZS50YXJnZXQgPT09IGxhc3RDZWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRMYXN0Q29udGVudENlbGxBY3RpdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZS5hY3Rpb24gPT09ICdzaGlmdFRhYicgJiYgZS50YXJnZXQgJiYgKGUudGFyZ2V0ID09PSB0aGlzLnBhcmVudC5lbGVtZW50IHx8IHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtdG9vbGJhcicpXG4gICAgICAgICAgICB8fCBwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLWdyb3VwZHJvcGFyZWEnKSkpIHtcbiAgICAgICAgICAgIGlmIChlLnRhcmdldCA9PT0gdGhpcy5wYXJlbnQuZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1jaGlsZGdyaWQnKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzT3V0RnJvbUNoaWxkR3JpZChlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JvdXBkcm9wYXJlYScpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNoaWxkZ3JpZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuZWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS10b29sYmFyJykpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dHcm91cGluZyAmJiB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLnNob3dEcm9wQXJlYSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXBNb2R1bGUgPSB0aGlzLnBhcmVudC5ncm91cE1vZHVsZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvY3VzYWJsZUdyb3VwZWRJdGVtcyA9IGdyb3VwTW9kdWxlLmdldEZvY3VzYWJsZUdyb3VwZWRJdGVtcygpO1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmb2N1c2FibGVHcm91cGVkSXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNhYmxlR3JvdXBlZEl0ZW1zW2ZvY3VzYWJsZUdyb3VwZWRJdGVtcy5sZW5ndGggLSAxXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBNb2R1bGUuZWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucGFyZW50LmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNoaWxkZ3JpZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuZWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZvY3VzRmlyc3RIZWFkZXJDZWxsID0gZmFsc2U7XG4gICAgICAgIGlmIChlLmFjdGlvbiA9PT0gJ3RhYicgJiYgZS50YXJnZXQgJiYgKGUudGFyZ2V0ID09PSB0aGlzLnBhcmVudC5lbGVtZW50IHx8IHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtdG9vbGJhcicpXG4gICAgICAgICAgICB8fCBwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLWdyb3VwZHJvcGFyZWEnKSkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd0dyb3VwaW5nICYmIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3Muc2hvd0Ryb3BBcmVhXG4gICAgICAgICAgICAgICAgJiYgKGUudGFyZ2V0ID09PSB0aGlzLnBhcmVudC5lbGVtZW50IHx8IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1ncm91cGRyb3BhcmVhJykpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdyb3VwTW9kdWxlID0gdGhpcy5wYXJlbnQuZ3JvdXBNb2R1bGU7XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzYWJsZUdyb3VwZWRJdGVtcyA9IGdyb3VwTW9kdWxlLmdldEZvY3VzYWJsZUdyb3VwZWRJdGVtcygpO1xuICAgICAgICAgICAgICAgIGlmIChmb2N1c2FibGVHcm91cGVkSXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzYWJsZUdyb3VwZWRJdGVtc1swXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWdyb3VwZHJvcGFyZWEnKSkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwTW9kdWxlLmVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgodGhpcy5wYXJlbnQudG9vbGJhciB8fCB0aGlzLnBhcmVudC50b29sYmFyVGVtcGxhdGUpICYmIChlLnRhcmdldCA9PT0gdGhpcy5wYXJlbnQuZWxlbWVudFxuICAgICAgICAgICAgICAgIHx8IHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JvdXBkcm9wYXJlYScpXG4gICAgICAgICAgICAgICAgfHwgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXRvb2xiYXInKSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9vbGJhckVsZW1lbnQgPSB0aGlzLnBhcmVudC50b29sYmFyTW9kdWxlLmVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzYWJsZVRvb2xiYXJJdGVtcyA9IHRoaXMucGFyZW50LnRvb2xiYXJNb2R1bGUuZ2V0Rm9jdXNhYmxlVG9vbGJhckl0ZW1zKCk7XG4gICAgICAgICAgICAgICAgaWYgKGZvY3VzYWJsZVRvb2xiYXJJdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNhYmxlVG9vbGJhckl0ZW1zWzBdLnF1ZXJ5U2VsZWN0b3IoJy5lLXRvb2xiYXItaXRlbS1mb2N1cywuZS1idG4sLmUtaW5wdXQnKS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXRvb2xiYXInKSkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRvb2xiYXJFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMucGFyZW50LmVsZW1lbnQgfHwgcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS10b29sYmFyJylcbiAgICAgICAgICAgICAgICB8fCBwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLWdyb3VwZHJvcGFyZWEnKSkge1xuICAgICAgICAgICAgICAgIGZvY3VzRmlyc3RIZWFkZXJDZWxsID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZm9jdXNGaXJzdEhlYWRlckNlbGwpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd0dyb3VwaW5nICYmICFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMpXG4gICAgICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCA9PT0gdGhpcy5wYXJlbnQuY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEFjdGl2ZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50ID0gWzAsIC0xXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFjdGl2ZUtleSA9IGUuYWN0aW9uO1xuICAgICAgICB2YXIgYmVmb3JlQXJncyA9IHsgY2FuY2VsOiBmYWxzZSwgYnlLZXk6IHRydWUsIGJ5Q2xpY2s6IGZhbHNlLCBrZXlBcmdzOiBlIH07XG4gICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudC5iZWZvcmVDZWxsRm9jdXNlZCwgYmVmb3JlQXJncyk7XG4gICAgICAgIGlmIChiZWZvcmVBcmdzLmNhbmNlbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiVmFsdWUgPSB0aGlzLmdldENvbnRlbnQoKS5tYXRyaXguY3VycmVudDtcbiAgICAgICAgdmFyIHByZXZCYXRjaFZhbHVlID0gdGhpcy5hY3RpdmUgJiYgdGhpcy5hY3RpdmUubWF0cml4LmN1cnJlbnQgP1xuICAgICAgICAgICAgW3RoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50WzBdLCB0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudFsxXV0gOiB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuY3VycmVudEluZm8ub3V0bGluZSA9IHRydWU7XG4gICAgICAgIHZhciBzd2FwSW5mbyA9IHRoaXMuZ2V0Q29udGVudCgpLmp1bXAoZS5hY3Rpb24sIGJWYWx1ZSk7XG4gICAgICAgIHRoaXMuc3dhcCA9IHN3YXBJbmZvO1xuICAgICAgICBpZiAoc3dhcEluZm8uc3dhcCAmJiAhKHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5tb2RlID09PSAnQmF0Y2gnXG4gICAgICAgICAgICAmJiAoZS5hY3Rpb24gPT09ICd0YWInIHx8IGUuYWN0aW9uID09PSAnc2hpZnRUYWInKSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlKCFzd2FwSW5mby50b0hlYWRlcik7XG4gICAgICAgICAgICB0aGlzLmdldENvbnRlbnQoKS5tYXRyaXguY3VycmVudCA9IHRoaXMuZ2V0Q29udGVudCgpLmdldE5leHRDdXJyZW50KGJWYWx1ZSwgc3dhcEluZm8sIHRoaXMuYWN0aXZlLCBlLmFjdGlvbik7XG4gICAgICAgICAgICB0aGlzLnByZXZJbmRleGVzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRBY3RpdmVCeUtleShlLmFjdGlvbiwgdGhpcy5nZXRDb250ZW50KCkpO1xuICAgICAgICB2YXIgcmV0dXJuVmFsID0gdGhpcy5jb250ZW50Lmxhc3RJZHhDZWxsID8gZmFsc2UgOiB0aGlzLmdldENvbnRlbnQoKS5vbktleVByZXNzKGUpO1xuICAgICAgICBpZiAoZS50YXJnZXQgJiYgcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1ncmlkaGVhZGVyJykpIHtcbiAgICAgICAgICAgIGlmIChlLmFjdGlvbiA9PT0gJ3RhYicgJiYgYlZhbHVlLnRvU3RyaW5nKCkgPT09IHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50LnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV4dEhlYWRlckNlbGxJbmRleCA9IGZpbmRDZWxsSW5kZXgodGhpcy5hY3RpdmUubWF0cml4Lm1hdHJpeCwgdGhpcy5hY3RpdmUubWF0cml4LmN1cnJlbnQsIHRydWUpO1xuICAgICAgICAgICAgICAgIHZhciBsYXN0SGVhZGVyQ2VsbEluZGV4ID0gW3RoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXgubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUubWF0cml4Lm1hdHJpeFt0aGlzLmFjdGl2ZS5tYXRyaXgubWF0cml4Lmxlbmd0aCAtIDFdLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZS5tYXRyaXgubWF0cml4W2xhc3RIZWFkZXJDZWxsSW5kZXhbMF1dW2xhc3RIZWFkZXJDZWxsSW5kZXhbMV1dID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxhc3RIZWFkZXJDZWxsSW5kZXggPSBmaW5kQ2VsbEluZGV4KHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXgsIGxhc3RIZWFkZXJDZWxsSW5kZXgsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5leHRDZWxsID0gZ2V0VmFsdWUobmV4dEhlYWRlckNlbGxJbmRleFswXSArIFwiLmNlbGxzLlwiICsgbmV4dEhlYWRlckNlbGxJbmRleFsxXSwgdGhpcy5hY3RpdmUubWF0cml4LmdldFJvd3NGcm9tSW5kZXgobmV4dEhlYWRlckNlbGxJbmRleFswXSwgdGhpcy5hY3RpdmUpKTtcbiAgICAgICAgICAgICAgICBpZiAobmV4dENlbGwgJiYgbmV4dENlbGwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggPT09IDBcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5hY3RpdmUubWF0cml4Lm1hdHJpeC5sZW5ndGggLSAxID09PSBuZXh0SGVhZGVyQ2VsbEluZGV4WzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIGxhc3RIZWFkZXJDZWxsSW5kZXggPSB0aGlzLmFjdGl2ZS5tYXRyaXgubmV4dFZpc2libGVDZWxsRm9jdXMobmV4dEhlYWRlckNlbGxJbmRleFswXSwgbmV4dEhlYWRlckNlbGxJbmRleFsxXSwgZS5hY3Rpb24sIHRoaXMuYWN0aXZlLmtleUFjdGlvbnNbZS5hY3Rpb25dLCB0aGlzLmFjdGl2ZSwgdGhpcy5hY3RpdmUubWF0cml4LmN1cnJlbnRbMV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hY3RpdmUubWF0cml4LmN1cnJlbnQudG9TdHJpbmcoKSA9PT0gbGFzdEhlYWRlckNlbGxJbmRleC50b1N0cmluZygpICYmIHRoaXMuY29udGVudC5tYXRyaXgubWF0cml4Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEFjdGl2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0Q29udGVudENlbGxJbmRleCA9IFswLCAwXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93UGFnaW5nICYmIHRoaXMucGFyZW50LnBhZ2VyTW9kdWxlLnBhZ2VyT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtcGFnZXJjb250YWluZXInKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1wYWdlcmNvbnRhaW5lcicpLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZS5tYXRyaXgubWF0cml4W2ZpcnN0Q29udGVudENlbGxJbmRleFswXV1bZmlyc3RDb250ZW50Q2VsbEluZGV4WzFdXSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb250ZW50Q2VsbEluZGV4ID0gZmluZENlbGxJbmRleCh0aGlzLmFjdGl2ZS5tYXRyaXgubWF0cml4LCBbMCwgMF0sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaXJzdENlbGwgPSBnZXRWYWx1ZShmaXJzdENvbnRlbnRDZWxsSW5kZXhbMF0gKyBcIi5jZWxscy5cIiArIGZpcnN0Q29udGVudENlbGxJbmRleFsxXSwgdGhpcy5hY3RpdmUubWF0cml4LmdldFJvd3NGcm9tSW5kZXgoZmlyc3RDb250ZW50Q2VsbEluZGV4WzBdLCB0aGlzLmFjdGl2ZSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDZWxsICYmIGZpcnN0Q2VsbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb250ZW50Q2VsbEluZGV4ID0gdGhpcy5hY3RpdmUubWF0cml4Lm5leHRWaXNpYmxlQ2VsbEZvY3VzKGZpcnN0Q29udGVudENlbGxJbmRleFswXSwgZmlyc3RDb250ZW50Q2VsbEluZGV4WzFdLCBlLmFjdGlvbiwgdGhpcy5hY3RpdmUua2V5QWN0aW9uc1tlLmFjdGlvbl0sIHRoaXMuYWN0aXZlLCB0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudFsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUubWF0cml4LmN1cnJlbnQgPSB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ0JhdGNoJyA/XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzVmFsaWRCYXRjaEVkaXRDZWxsKGZpcnN0Q29udGVudENlbGxJbmRleCkgPyBmaXJzdENvbnRlbnRDZWxsSW5kZXggOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmluZEJhdGNoRWRpdENlbGwoZmlyc3RDb250ZW50Q2VsbEluZGV4LCB0cnVlKSA6IGZpcnN0Q29udGVudENlbGxJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uICYmICF0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuY29udGVudE1vZHVsZS5wcmV2SW5mby5ibG9ja0luZGV4ZXNbMF0gIT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aXJ0dWFsID0gdGhpcy5wYXJlbnQuY29udGVudE1vZHVsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpcnR1YWwuZmlyc3RDZWxsRm9jdXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlydHVhbC5jb250ZW50LnNjcm9sbFRvcCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5hY3RpdmUubWF0cml4LmN1cnJlbnQudG9TdHJpbmcoKSAhPT0gbmV4dEhlYWRlckNlbGxJbmRleC50b1N0cmluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50ID0gbmV4dEhlYWRlckNlbGxJbmRleDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5hY3Rpb24gPT09ICdzaGlmdFRhYicgJiYgYlZhbHVlLnRvU3RyaW5nKCkgPT09IHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50LnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJldmlvdXNDZWxsSW5kZXggPSBmaW5kQ2VsbEluZGV4KHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXgsIHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdmFyIHByZXZDZWxsID0gZ2V0VmFsdWUocHJldmlvdXNDZWxsSW5kZXhbMF0gKyBcIi5jZWxscy5cIiArIHByZXZpb3VzQ2VsbEluZGV4WzFdLCB0aGlzLmFjdGl2ZS5tYXRyaXguZ2V0Um93c0Zyb21JbmRleChwcmV2aW91c0NlbGxJbmRleFswXSwgdGhpcy5hY3RpdmUpKTtcbiAgICAgICAgICAgICAgICBpZiAocHJldkNlbGwgJiYgcHJldkNlbGwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggPT09IDAgJiYgcHJldmlvdXNDZWxsSW5kZXhbMF0gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNDZWxsSW5kZXggPSB0aGlzLmFjdGl2ZS5tYXRyaXgubmV4dFZpc2libGVDZWxsRm9jdXMocHJldmlvdXNDZWxsSW5kZXhbMF0sIHByZXZpb3VzQ2VsbEluZGV4WzFdLCBlLmFjdGlvbiwgdGhpcy5hY3RpdmUua2V5QWN0aW9uc1tlLmFjdGlvbl0sIHRoaXMuYWN0aXZlLCB0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudFsxXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c0NlbGxJbmRleC50b1N0cmluZygpID09PSB0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudC50b1N0cmluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNPdXRGcm9tSGVhZGVyKGUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudC50b1N0cmluZygpICE9PSBwcmV2aW91c0NlbGxJbmRleC50b1N0cmluZygpICYmICFyZXR1cm5WYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVmFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZDZWxsXzEgPSBnZXRWYWx1ZShwcmV2aW91c0NlbGxJbmRleFswXSArIFwiLmNlbGxzLlwiICsgcHJldmlvdXNDZWxsSW5kZXhbMV0sIHRoaXMuYWN0aXZlLm1hdHJpeC5nZXRSb3dzRnJvbUluZGV4KHByZXZpb3VzQ2VsbEluZGV4WzBdLCB0aGlzLmFjdGl2ZSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJldkNlbGxfMSAmJiBwcmV2Q2VsbF8xLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoID09PSAwICYmIHByZXZpb3VzQ2VsbEluZGV4WzBdID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c0NlbGxJbmRleCA9IHRoaXMuYWN0aXZlLm1hdHJpeC5uZXh0VmlzaWJsZUNlbGxGb2N1cyhwcmV2aW91c0NlbGxJbmRleFswXSwgcHJldmlvdXNDZWxsSW5kZXhbMV0sIGUuYWN0aW9uLCB0aGlzLmFjdGl2ZS5rZXlBY3Rpb25zW2UuYWN0aW9uXSwgdGhpcy5hY3RpdmUsIHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50WzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudCA9IHByZXZpb3VzQ2VsbEluZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZS50YXJnZXQgJiYgcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1ncmlkY29udGVudCcpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dQYWdpbmcgJiYgdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1wYWdlcmNvbnRhaW5lcicpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1wYWdlcmNvbnRhaW5lcicpLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ0JhdGNoJyAmJiAoZS5hY3Rpb24gPT09ICd0YWInIHx8IGUuYWN0aW9uID09PSAnc2hpZnRUYWInKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50ID0gdGhpcy5maW5kQmF0Y2hFZGl0Q2VsbChwcmV2QmF0Y2hWYWx1ZSwgZS5hY3Rpb24gPT09ICd0YWInID8gdHJ1ZSA6IGZhbHNlKTtcbiAgICAgICAgICAgICAgICBpZiAoZS5hY3Rpb24gPT09ICd0YWInICYmIHByZXZCYXRjaFZhbHVlLnRvU3RyaW5nKCkgPT09IHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50LnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuZWRpdE1vZHVsZS5lZGl0TW9kdWxlLmFkZEJhdGNoUm93ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5hY3Rpb24gPT09ICdzaGlmdFRhYicgJiYgYlZhbHVlLnRvU3RyaW5nKCkgPT09IHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50LnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dHcm91cGluZyAmJiAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zKVxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoID09PSB0aGlzLnBhcmVudC5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzT3V0RnJvbUhlYWRlcihlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZmlyc3RDb250ZW50Q2VsbEluZGV4ID0gWzAsIDBdO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZS5tYXRyaXgubWF0cml4W2ZpcnN0Q29udGVudENlbGxJbmRleFswXV1bZmlyc3RDb250ZW50Q2VsbEluZGV4WzFdXSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmaXJzdENvbnRlbnRDZWxsSW5kZXggPSBmaW5kQ2VsbEluZGV4KHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXgsIFswLCAwXSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBmaXJzdENlbGwgPSBnZXRWYWx1ZShmaXJzdENvbnRlbnRDZWxsSW5kZXhbMF0gKyBcIi5jZWxscy5cIiArIGZpcnN0Q29udGVudENlbGxJbmRleFsxXSwgdGhpcy5hY3RpdmUubWF0cml4LmdldFJvd3NGcm9tSW5kZXgoZmlyc3RDb250ZW50Q2VsbEluZGV4WzBdLCB0aGlzLmFjdGl2ZSkpO1xuICAgICAgICAgICAgICAgIGlmIChmaXJzdENlbGwgJiYgZmlyc3RDZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0Q29udGVudENlbGxJbmRleCA9IHRoaXMuYWN0aXZlLm1hdHJpeC5uZXh0VmlzaWJsZUNlbGxGb2N1cyhmaXJzdENvbnRlbnRDZWxsSW5kZXhbMF0sIGZpcnN0Q29udGVudENlbGxJbmRleFsxXSwgZS5hY3Rpb24sIHRoaXMuYWN0aXZlLmtleUFjdGlvbnNbZS5hY3Rpb25dLCB0aGlzLmFjdGl2ZSwgdGhpcy5hY3RpdmUubWF0cml4LmN1cnJlbnRbMV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXJldHVyblZhbCAmJiAoZmlyc3RDb250ZW50Q2VsbEluZGV4LnRvU3RyaW5nKCkgPT09IHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50LnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgfHwgKHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5tb2RlID09PSAnQmF0Y2gnXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBwcmV2QmF0Y2hWYWx1ZS50b1N0cmluZygpID09PSB0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudC50b1N0cmluZygpKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuVmFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldExhc3RDb250ZW50Q2VsbEFjdGl2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocmV0dXJuVmFsID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5jbGVhckluZGljYXRvcigpO1xuICAgICAgICAgICAgaWYgKGUuYWN0aW9uID09PSAnc2hpZnRUYWInICYmIGJWYWx1ZS50b1N0cmluZygpID09PSBbMCwgMF0udG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmVsZW1lbnQudGFiSW5kZXggPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd1BhZ2luZyAmJiAhdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouY2hlY2tQYWdlckhhc0ZvY3VzKCkgJiYgdGhpcy5hbGxvd1RvUGFnaW5nKGUpXG4gICAgICAgICAgICAgICAgJiYgYlZhbHVlLnRvU3RyaW5nKCkgIT09IFswLCAwXS50b1N0cmluZygpKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDQwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnBhZ2VyTW9kdWxlLnBhZ2VyT2JqLnNldFBhZ2VyQ29udGFpbmVyRm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChlLmtleUNvZGUgPT09IDkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQucGFnZXJNb2R1bGUucGFnZXJPYmouc2V0UGFnZXJGb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWNoaWxkZ3JpZCcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1c091dEZyb21DaGlsZEdyaWQoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oZWFkZXIuYWN0aW9uID0gZS5hY3Rpb247XG4gICAgICAgIHRoaXMuaGVhZGVyLmN1cnJlbnRUYXJnZXQgPSBudWxsO1xuICAgICAgICB0aGlzLmhlYWRlci5mb2N1c1R5cGUgPSAna2V5JztcbiAgICAgICAgaWYgKGUudGFyZ2V0ICYmIHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZmx0cnRlbXAnKSAmJiAoZS5hY3Rpb24gPT09ICd0YWInIHx8IGUuYWN0aW9uID09PSAnc2hpZnRUYWInKSkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgdmFyIGZvY3VzRWxlbWVudCA9IFtdLnNsaWNlLmNhbGwoY2xvc2VzdCh0YXJnZXQsICd0aCcpLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLWZsdHJ0ZW1wLWZvY3VzJykpO1xuICAgICAgICAgICAgaWYgKGZvY3VzRWxlbWVudC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudEluZGV4ID0gZm9jdXNFbGVtZW50LmluZGV4T2YodGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgcmVzZXRBY3RpdmUgPSAoKGUuYWN0aW9uID09PSAndGFiJyAmJiBlbGVtZW50SW5kZXggPCBmb2N1c0VsZW1lbnQubGVuZ3RoIC0gMSlcbiAgICAgICAgICAgICAgICAgICAgfHwgKGUuYWN0aW9uID09PSAnc2hpZnRUYWInICYmIGVsZW1lbnRJbmRleCA+IDApKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAocmVzZXRBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudCA9IGJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUuY3VycmVudFRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZvY3VzRmlyc3RIZWFkZXJDZWxsICYmIHBhcmVudHNVbnRpbCh0aGlzLmFjdGl2ZS5nZXRUYWJsZSgpLCAnZS1ncmlkaGVhZGVyJylcbiAgICAgICAgICAgICYmIGUudGFyZ2V0ICYmIGUudGFyZ2V0LmlkID09PSB0aGlzLnBhcmVudC5lbGVtZW50LmlkICsgJ19zZWFyY2hiYXInKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5zZWFyY2hNb2R1bGUuaGVhZGVyRm9jdXMgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5mb2N1cyhlKTtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLmlzVmFsaWRCYXRjaEVkaXRDZWxsID0gZnVuY3Rpb24gKGNlbGxJbmRleCkge1xuICAgICAgICB2YXIgY2VsbCA9IHRoaXMuYWN0aXZlLmdldFRhYmxlKCkucm93c1tjZWxsSW5kZXhbMF1dLmNlbGxzW2NlbGxJbmRleFsxXV07XG4gICAgICAgIHZhciB0ciA9IGNsb3Nlc3QoY2VsbCwgJ3RyJyk7XG4gICAgICAgIHZhciBjZWxsQ29sSW5kZXggPSBwYXJzZUludChjZWxsLmdldEF0dHJpYnV0ZSgnYXJpYS1jb2xpbmRleCcpLCAxMCkgLSAxO1xuICAgICAgICB2YXIgY2VsbENvbCA9IHRoaXMucGFyZW50LmdldENvbHVtbnMoKVtwYXJzZUludChjZWxsQ29sSW5kZXgudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXhbY2VsbEluZGV4WzBdXVtjZWxsSW5kZXhbMV1dID09PSAxXG4gICAgICAgICAgICAmJiAoIXRyLmNsYXNzTGlzdC5jb250YWlucygnZS1yb3cnKSB8fCAodHIuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWluc2VydGVkcm93JykgfHwgIWNlbGxDb2wuaXNQcmltYXJ5S2V5KSAmJiBjZWxsQ29sLmFsbG93RWRpdGluZykpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLmZpbmRCYXRjaEVkaXRDZWxsID0gZnVuY3Rpb24gKGN1cnJlbnRDZWxsSW5kZXgsIG5leHQsIGxpbWl0Um93KSB7XG4gICAgICAgIHZhciBjZWxsSW5kZXggPSBjdXJyZW50Q2VsbEluZGV4O1xuICAgICAgICB2YXIgdGVtcENlbGxJbmRleCA9IGN1cnJlbnRDZWxsSW5kZXg7XG4gICAgICAgIHZhciBjZWxsSW5kZXhPYnRhaW4gPSBmYWxzZTtcbiAgICAgICAgd2hpbGUgKCFjZWxsSW5kZXhPYnRhaW4pIHtcbiAgICAgICAgICAgIHZhciBwcmV2VGVtcENlbGxJbmRleCA9IHRlbXBDZWxsSW5kZXg7XG4gICAgICAgICAgICB0ZW1wQ2VsbEluZGV4ID0gZmluZENlbGxJbmRleCh0aGlzLmFjdGl2ZS5tYXRyaXgubWF0cml4LCB0ZW1wQ2VsbEluZGV4LCBuZXh0KTtcbiAgICAgICAgICAgIHZhciB0ZW1wQ2VsbCA9IGdldFZhbHVlKHRlbXBDZWxsSW5kZXhbMF0gKyBcIi5jZWxscy5cIiArIHRlbXBDZWxsSW5kZXhbMV0sIHRoaXMuYWN0aXZlLmdldFRhYmxlKCkucm93cyk7XG4gICAgICAgICAgICBpZiAodGVtcENlbGwgJiYgdGVtcENlbGwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0ZW1wQ2VsbEluZGV4ID0gdGhpcy5hY3RpdmUubWF0cml4Lm5leHRWaXNpYmxlQ2VsbEZvY3VzKHRlbXBDZWxsSW5kZXhbMF0sIHRlbXBDZWxsSW5kZXhbMV0sIHRoaXMuYWN0aXZlS2V5LCB0aGlzLmFjdGl2ZS5rZXlBY3Rpb25zW3RoaXMuYWN0aXZlS2V5XSwgdGhpcy5hY3RpdmUsIHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50WzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgocHJldlRlbXBDZWxsSW5kZXgudG9TdHJpbmcoKSA9PT0gdGVtcENlbGxJbmRleC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgIHx8IChsaW1pdFJvdyAmJiBwcmV2VGVtcENlbGxJbmRleFswXSAhPT0gdGVtcENlbGxJbmRleFswXSkpIHtcbiAgICAgICAgICAgICAgICBjZWxsSW5kZXhPYnRhaW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZEJhdGNoRWRpdENlbGwodGVtcENlbGxJbmRleCkpIHtcbiAgICAgICAgICAgICAgICBjZWxsSW5kZXggPSB0ZW1wQ2VsbEluZGV4O1xuICAgICAgICAgICAgICAgIGNlbGxJbmRleE9idGFpbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNlbGxJbmRleDtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLnNldExhc3RDb250ZW50Q2VsbEFjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxhc3RDb250ZW50Q2VsbEluZGV4ID0gW3RoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXgubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXhbdGhpcy5hY3RpdmUubWF0cml4Lm1hdHJpeC5sZW5ndGggLSAxXS5sZW5ndGggLSAxXTtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXhbbGFzdENvbnRlbnRDZWxsSW5kZXhbMF1dW2xhc3RDb250ZW50Q2VsbEluZGV4WzFdXSA9PT0gMCkge1xuICAgICAgICAgICAgbGFzdENvbnRlbnRDZWxsSW5kZXggPSBmaW5kQ2VsbEluZGV4KHRoaXMuYWN0aXZlLm1hdHJpeC5tYXRyaXgsIGxhc3RDb250ZW50Q2VsbEluZGV4LCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxhc3RDZWxsID0gZ2V0VmFsdWUobGFzdENvbnRlbnRDZWxsSW5kZXhbMF0gKyBcIi5jZWxscy5cIiArIGxhc3RDb250ZW50Q2VsbEluZGV4WzFdLCB0aGlzLmFjdGl2ZS5tYXRyaXguZ2V0Um93c0Zyb21JbmRleChsYXN0Q29udGVudENlbGxJbmRleFswXSwgdGhpcy5hY3RpdmUpKTtcbiAgICAgICAgaWYgKGxhc3RDZWxsICYmIGxhc3RDZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoID09PSAwKSB7XG4gICAgICAgICAgICBsYXN0Q29udGVudENlbGxJbmRleCA9IHRoaXMuYWN0aXZlLm1hdHJpeC5uZXh0VmlzaWJsZUNlbGxGb2N1cyhsYXN0Q29udGVudENlbGxJbmRleFswXSwgbGFzdENvbnRlbnRDZWxsSW5kZXhbMV0sIHRoaXMuYWN0aXZlS2V5LCB0aGlzLmFjdGl2ZS5rZXlBY3Rpb25zW3RoaXMuYWN0aXZlS2V5XSwgdGhpcy5hY3RpdmUsIHRoaXMuYWN0aXZlLm1hdHJpeC5jdXJyZW50WzFdKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFjdGl2ZS5tYXRyaXguY3VycmVudCA9IGxhc3RDb250ZW50Q2VsbEluZGV4O1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuZm9jdXNPdXRGcm9tQ2hpbGRHcmlkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHBhcmVudFRhYmxlID0gcGFyZW50c1VudGlsKHRoaXMucGFyZW50LmVsZW1lbnQsICdlLXRhYmxlJyk7XG4gICAgICAgIHZhciBwYXJlbnRHcmlkID0gcGFyZW50c1VudGlsKHBhcmVudFRhYmxlLCAnZS1ncmlkJykuZWoyX2luc3RhbmNlc1swXTtcbiAgICAgICAgdmFyIHBhcmVudENlbGwgPSBwYXJlbnRzVW50aWwodGhpcy5wYXJlbnQuZWxlbWVudCwgJ2UtZGV0YWlsY2VsbCcpO1xuICAgICAgICB2YXIgdWlkID0gcGFyZW50c1VudGlsKHRoaXMucGFyZW50LmVsZW1lbnQsICdlLWRldGFpbHJvdycpLmdldEF0dHJpYnV0ZSgnZGF0YS11aWQnKTtcbiAgICAgICAgdmFyIHBhcmVudFJvd3MgPSBbXS5zbGljZS5jYWxsKHBhcmVudEdyaWQuZ2V0Q29udGVudFRhYmxlKCkucm93cyk7XG4gICAgICAgIHZhciBwYXJlbnRSb3dJbmRleCA9IHBhcmVudFJvd3MubWFwKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLmdldEF0dHJpYnV0ZSgnZGF0YS11aWQnKTsgfSkuaW5kZXhPZih1aWQpO1xuICAgICAgICBpZiAoZS5hY3Rpb24gPT09ICd0YWInICYmIHBhcmVudFJvd0luZGV4ID49IHBhcmVudFJvd3MubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJlbW92ZUNsYXNzKFt0aGlzLnBhcmVudC5lbGVtZW50XSwgWydlLWZvY3VzJ10pO1xuICAgICAgICByZW1vdmVDbGFzcyhbcGFyZW50Q2VsbF0sIFsnZS1mb2N1c2VkJ10pO1xuICAgICAgICBwYXJlbnRDZWxsLnRhYkluZGV4ID0gLTE7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIG5leHRGb2N1c0NlbGw7XG4gICAgICAgIHBhcmVudEdyaWQuZm9jdXNNb2R1bGUucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgaWYgKGUuYWN0aW9uID09PSAnc2hpZnRUYWInKSB7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNSb3cgPSBwYXJlbnRSb3dzW3BhcmVudFJvd0luZGV4IC0gMV07XG4gICAgICAgICAgICB2YXIgcm93Q2VsbHMgPSBwcmV2aW91c1Jvdy5jZWxscztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSByb3dDZWxscy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgIG5leHRGb2N1c0NlbGwgPSByb3dDZWxsc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgaWYgKCFuZXh0Rm9jdXNDZWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1oaWRlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50R3JpZC5mb2N1c01vZHVsZS5hY3RpdmUubWF0cml4LmN1cnJlbnQgPSBbcGFyZW50Um93SW5kZXggLSAxLCBpXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmV4dEZvY3VzQ2VsbCA9IHBhcmVudFJvd3NbcGFyZW50Um93SW5kZXggKyAxXS5jZWxsc1swXTtcbiAgICAgICAgICAgIHBhcmVudEdyaWQuZm9jdXNNb2R1bGUuYWN0aXZlLm1hdHJpeC5jdXJyZW50ID0gW3BhcmVudFJvd0luZGV4ICsgMSwgMF07XG4gICAgICAgIH1cbiAgICAgICAgcGFyZW50R3JpZC5mb2N1c01vZHVsZS5jdXJyZW50SW5mby5lbGVtZW50ID0gbmV4dEZvY3VzQ2VsbDtcbiAgICAgICAgcGFyZW50R3JpZC5mb2N1c01vZHVsZS5jdXJyZW50SW5mby5lbGVtZW50VG9Gb2N1cyA9IG5leHRGb2N1c0NlbGw7XG4gICAgICAgIGFkZENsYXNzKFtuZXh0Rm9jdXNDZWxsXSwgWydlLWZvY3VzZWQnLCAnZS1mb2N1cyddKTtcbiAgICAgICAgbmV4dEZvY3VzQ2VsbC50YWJJbmRleCA9IDA7XG4gICAgICAgIG5leHRGb2N1c0NlbGwuZm9jdXMoKTtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLmZvY3VzT3V0RnJvbUhlYWRlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LnRvb2xiYXIgfHwgdGhpcy5wYXJlbnQudG9vbGJhclRlbXBsYXRlKSB7XG4gICAgICAgICAgICB2YXIgdG9vbGJhckVsZW1lbnQgPSB0aGlzLnBhcmVudC50b29sYmFyTW9kdWxlLmVsZW1lbnQ7XG4gICAgICAgICAgICB2YXIgZm9jdXNhYmxlVG9vbGJhckl0ZW1zID0gdGhpcy5wYXJlbnQudG9vbGJhck1vZHVsZS5nZXRGb2N1c2FibGVUb29sYmFySXRlbXMoKTtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmIChmb2N1c2FibGVUb29sYmFySXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvY3VzYWJsZVRvb2xiYXJJdGVtc1tmb2N1c2FibGVUb29sYmFySXRlbXMubGVuZ3RoIC0gMV0ucXVlcnlTZWxlY3RvcignLmUtdG9vbGJhci1pdGVtLWZvY3VzLC5lLWJ0biwuZS1pbnB1dCcpLmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0b29sYmFyRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd0dyb3VwaW5nICYmIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3Muc2hvd0Ryb3BBcmVhKSB7XG4gICAgICAgICAgICB2YXIgZ3JvdXBNb2R1bGUgPSB0aGlzLnBhcmVudC5ncm91cE1vZHVsZTtcbiAgICAgICAgICAgIHZhciBmb2N1c2FibGVHcm91cGVkSXRlbXMgPSBncm91cE1vZHVsZS5nZXRGb2N1c2FibGVHcm91cGVkSXRlbXMoKTtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmIChmb2N1c2FibGVHcm91cGVkSXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvY3VzYWJsZUdyb3VwZWRJdGVtc1tmb2N1c2FibGVHcm91cGVkSXRlbXMubGVuZ3RoIC0gMV0uZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGdyb3VwTW9kdWxlLmVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY2hpbGRncmlkJykpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuYWxsb3dUb1BhZ2luZyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ0JhdGNoJyAmJiB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MuYWxsb3dBZGRpbmcgJiYgZS5rZXlDb2RlICE9PSA0MCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuc2tpcE9uID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQuaXNFZGl0ICYmIHRhcmdldCAmJiB0YXJnZXQuY2xvc2VzdCgnLmUtdW5ib3VuZGNlbGwnKSAmJiB0aGlzLmN1cnJlbnRJbmZvLnNraXBBY3Rpb24gJiYgKChlLmFjdGlvbiA9PT0gJ3NoaWZ0VGFiJyAmJlxuICAgICAgICAgICAgdGhpcy5jb21tYW5kQ29sdW1uRm9jdXNFbGVtZW50KHRhcmdldC5jbG9zZXN0KCcuZS11bmJvdW5kY2VsbCcpLCBmYWxzZSkgPT09IHRhcmdldCkgfHxcbiAgICAgICAgICAgIChlLmFjdGlvbiA9PT0gJ3RhYicgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRDb2x1bW5Gb2N1c0VsZW1lbnQodGFyZ2V0LmNsb3Nlc3QoJy5lLXVuYm91bmRjZWxsJyksIHRydWUpID09PSB0YXJnZXQpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudEluZm8uc2tpcEFjdGlvbiA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmZvLnNraXBBY3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJJbmRpY2F0b3IoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChbJ3BhZ2VVcCcsICdwYWdlRG93bicsICdhbHREb3duQXJyb3cnXS5pbmRleE9mKGUuYWN0aW9uKSA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFySW5kaWNhdG9yKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dHcm91cGluZykge1xuICAgICAgICAgICAgdmFyIGZvY3VzYWJsZUdyb3VwZWRJdGVtcyA9IHRoaXMucGFyZW50Lmdyb3VwTW9kdWxlLmdldEZvY3VzYWJsZUdyb3VwZWRJdGVtcygpO1xuICAgICAgICAgICAgaWYgKHBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZ3JvdXBoZWFkZXJjZWxsJylcbiAgICAgICAgICAgICAgICAmJiAhKChlLnRhcmdldCA9PT0gZm9jdXNhYmxlR3JvdXBlZEl0ZW1zWzBdICYmIGUuYWN0aW9uID09PSAnc2hpZnRUYWInKVxuICAgICAgICAgICAgICAgICAgICB8fCAoZS50YXJnZXQgPT09IGZvY3VzYWJsZUdyb3VwZWRJdGVtc1tmb2N1c2FibGVHcm91cGVkSXRlbXMubGVuZ3RoIC0gMV0gJiYgZS5hY3Rpb24gPT09ICd0YWInKSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQudG9vbGJhciB8fCB0aGlzLnBhcmVudC50b29sYmFyVGVtcGxhdGUpIHtcbiAgICAgICAgICAgIHZhciB0b29sYmFyRWxlbWVudCA9IHRoaXMucGFyZW50LnRvb2xiYXJNb2R1bGUuZWxlbWVudDtcbiAgICAgICAgICAgIHZhciBmb2N1c2FibGVUb29sYmFySXRlbXMgPSB0b29sYmFyRWxlbWVudFxuICAgICAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKCcuZS10b29sYmFyLWl0ZW06bm90KC5lLW92ZXJsYXkpOm5vdCguZS1oaWRkZW4pJyk7XG4gICAgICAgICAgICBpZiAocGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS10b29sYmFyLWl0ZW0nKVxuICAgICAgICAgICAgICAgICYmICEoZm9jdXNhYmxlVG9vbGJhckl0ZW1zLmxlbmd0aCA+IDAgJiYgKChwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLXRvb2xiYXItaXRlbScpID09PSBmb2N1c2FibGVUb29sYmFySXRlbXNbMF0gJiYgZS5hY3Rpb24gPT09ICdzaGlmdFRhYicpXG4gICAgICAgICAgICAgICAgICAgIHx8IChwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLXRvb2xiYXItaXRlbScpID09PSBmb2N1c2FibGVUb29sYmFySXRlbXNbZm9jdXNhYmxlVG9vbGJhckl0ZW1zLmxlbmd0aCAtIDFdICYmIGUuYWN0aW9uID09PSAndGFiJykpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciB0aCA9IGNsb3Nlc3QodGFyZ2V0LCAndGgnKSAmJiAhY2xvc2VzdCh0YXJnZXQsICd0aCcpLnRhYkluZGV4O1xuICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWZpbHRlcmJhcm9wZXJhdG9yJykgJiYgKGUua2V5Q29kZSA9PT0gMTMgfHwgZS5rZXlDb2RlID09PSAyNykpIHtcbiAgICAgICAgICAgIHZhciBpbnB1dFRhcmdldCA9IGNsb3Nlc3QoZS50YXJnZXQsICcuZS1maWx0ZXJiYXJjZWxsJyk7XG4gICAgICAgICAgICBpbnB1dFRhcmdldC5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFkZE5ld1JvdyA9IHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIGNsb3Nlc3QoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCwgJy5lLWFkZGVkcm93JykgIT09IG51bGw7XG4gICAgICAgIGlmICgodGggJiYgY2xvc2VzdChkb2N1bWVudC5hY3RpdmVFbGVtZW50LCAnLmUtZmlsdGVyYmFyY2VsbCcpICE9PSBudWxsKSB8fCBhZGROZXdSb3cpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlsdGVyQ2VsbCA9IGNsb3Nlc3QoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCwgJy5lLWZpbHRlcmJhcmNlbGwnKSAhPT0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZUhlYWRlckZvY3VzICYmIGZpbHRlckNlbGwpIHtcbiAgICAgICAgICAgIHZhciBtYXRyaXggPSB0aGlzLmFjdGl2ZS5tYXRyaXg7XG4gICAgICAgICAgICB2YXIgY3VycmVudCA9IG1hdHJpeC5jdXJyZW50O1xuICAgICAgICAgICAgZmlsdGVyQ2VsbCA9IG1hdHJpeC5tYXRyaXhbY3VycmVudFswXV0ubGFzdEluZGV4T2YoMSkgIT09IGN1cnJlbnRbMV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRWRpdCAmJiAoZS5hY3Rpb24gPT09ICd0YWInIHx8IGUuYWN0aW9uID09PSAnc2hpZnRUYWInKSAmJiB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ05vcm1hbCdcbiAgICAgICAgICAgICYmICF0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJiAhaXNOdWxsT3JVbmRlZmluZWQocGFyZW50c1VudGlsKHRhcmdldCwgJ2UtYWRkZWRyb3cnKSkpIHtcbiAgICAgICAgICAgIHZhciBpbnB1dEVsZW1lbnRzID0gdGhpcy5wYXJlbnQuZWRpdE1vZHVsZS5mb3JtT2JqLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQ6bm90KFt0eXBlPVwiaGlkZGVuXCJdLC5lLW51bWVyaWMtaGlkZGVuLC5lLWRpc2FibGVkKSwgc2VsZWN0Om5vdChbYXJpYS1oaWRkZW49XCJ0cnVlXCJdKSwgYnV0dG9uOm5vdCguZS1oaWRlKSwgdGV4dGFyZWE6bm90KC5lLWhpZGUsLmUtZGlzYWJsZWQsW2Rpc2FibGVkXSknKTtcbiAgICAgICAgICAgIHZhciBpbnB1dFRhcmdldCA9IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZGRsJykgPyB0YXJnZXQucXVlcnlTZWxlY3RvcignaW5wdXQnKSA6IHRhcmdldDtcbiAgICAgICAgICAgIHZhciBmaXJzdEVkaXRDZWxsID0gZS5hY3Rpb24gPT09ICd0YWInICYmIGlucHV0VGFyZ2V0ID09PSBpbnB1dEVsZW1lbnRzW2lucHV0RWxlbWVudHMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB2YXIgbGFzdEVkaXRDZWxsID0gZS5hY3Rpb24gPT09ICdzaGlmdFRhYicgJiYgaW5wdXRUYXJnZXQgPT09IGlucHV0RWxlbWVudHNbMF07XG4gICAgICAgICAgICBpZiAoZmlyc3RFZGl0Q2VsbCB8fCBsYXN0RWRpdENlbGwpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzRWxlbWVudCA9IGlucHV0RWxlbWVudHNbZmlyc3RFZGl0Q2VsbCA/IDAgOiBpbnB1dEVsZW1lbnRzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIGZvY3VzRWxlbWVudCA9IGZvY3VzRWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1kZGwnKSA/IGZvY3VzRWxlbWVudC5wYXJlbnRFbGVtZW50IDogZm9jdXNFbGVtZW50O1xuICAgICAgICAgICAgICAgIGZvY3VzRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoZS5hY3Rpb24gPT09ICdkZWxldGUnXG4gICAgICAgICAgICB8fCAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm1vZGUgIT09ICdCYXRjaCcgJiYgKCh0aGlzLnBhcmVudC5pc0VkaXQgJiYgKCF0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyB8fFxuICAgICAgICAgICAgICAgICh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJiAoKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWVkaXRlZHJvdycpKSB8fFxuICAgICAgICAgICAgICAgICAgICAoIWlzTnVsbE9yVW5kZWZpbmVkKHBhcmVudHNVbnRpbCh0YXJnZXQsICdlLWFkZGVkcm93JykpICYmICFpc051bGxPclVuZGVmaW5lZChjbG9zZXN0KGUudGFyZ2V0LCAnaW5wdXQnKSkgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXBvcHVwLW9wZW4nKSkpIHx8XG4gICAgICAgICAgICAgICAgICAgICghaXNOdWxsT3JVbmRlZmluZWQocGFyZW50c1VudGlsKHRhcmdldCwgJ2UtYWRkZWRyb3cnKSkgJiYgKHRhcmdldCAmJiAhdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5lLWNhbmNlbC1pY29uJykpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAhaXNOdWxsT3JVbmRlZmluZWQocGFyZW50c1VudGlsKHRhcmdldCwgJ2UtdW5ib3VuZGNlbGwnKSkpKSkpKSkgfHwgWydpbnNlcnQnLCAnZjInXS5pbmRleE9mKGUuYWN0aW9uKSA+IC0xKSlcbiAgICAgICAgICAgIHx8ICgoZmlsdGVyQ2VsbCAmJiB0aGlzLnBhcmVudC5lbmFibGVIZWFkZXJGb2N1cykgfHwgKChmaWx0ZXJDZWxsIHx8IGFkZE5ld1JvdykgJiYgZS5hY3Rpb24gIT09ICd0YWInICYmIGUuYWN0aW9uICE9PSAnc2hpZnRUYWInKSB8fFxuICAgICAgICAgICAgICAgIGNsb3Nlc3QoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCwgJyMnICsgdGhpcy5wYXJlbnQuZWxlbWVudC5pZCArICdfc2VhcmNoYmFyJykgIT09IG51bGxcbiAgICAgICAgICAgICAgICAgICAgJiYgWydlbnRlcicsICdsZWZ0QXJyb3cnLCAncmlnaHRBcnJvdycsXG4gICAgICAgICAgICAgICAgICAgICAgICAnc2hpZnRMZWZ0JywgJ3NoaWZ0UmlnaHQnLCAnY3RybFBsdXNBJ10uaW5kZXhPZihlLmFjdGlvbikgPiAtMSlcbiAgICAgICAgICAgIHx8IChjbG9zZXN0KHRhcmdldCwgJy4nICsgbGl0ZXJhbHMuZ3JpZENvbnRlbnQpID09PSBudWxsICYmIGNsb3Nlc3QodGFyZ2V0LCAnLicgKyBsaXRlcmFscy5ncmlkSGVhZGVyKSA9PT0gbnVsbFxuICAgICAgICAgICAgICAgICYmICEoZS50YXJnZXQgPT09IHRoaXMucGFyZW50LmVsZW1lbnQgfHwgcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS10b29sYmFyJylcbiAgICAgICAgICAgICAgICAgICAgfHwgcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1ncm91cGRyb3BhcmVhJykpKVxuICAgICAgICAgICAgfHwgKGUuYWN0aW9uID09PSAnc3BhY2UnICYmICghdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhsaXRlcmFscy5ncmlkQ2hrQm94KSAmJiBjbG9zZXN0KHRhcmdldCwgJy4nICsgbGl0ZXJhbHMuZ3JpZENoa0JveCkgPT09IG51bGxcbiAgICAgICAgICAgICAgICAmJiBjbG9zZXN0KHRhcmdldCwgJy5lLWhlYWRlcmNoa2NlbGxkaXYnKSA9PT0gbnVsbCkpKSB8fCBjbG9zZXN0KHRhcmdldCwgJy5lLWZpbHRlci1wb3B1cCcpICE9PSBudWxsO1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuZm9jdXNWaXJ0dWFsRWxlbWVudCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZykge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7IHZpcnR1YWxEYXRhOiB7fSwgaXNBZGQ6IGZhbHNlLCBpc0NhbmNlbDogZmFsc2UgfTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudC5nZXRWaXJ0dWFsRGF0YSwgZGF0YSk7XG4gICAgICAgICAgICB2YXIgaXNLZXlGb2N1cyA9IHRoaXMuYWN0aW9ucy5zb21lKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgPT09IF90aGlzLmFjdGl2ZUtleTsgfSk7XG4gICAgICAgICAgICB2YXIgaXNTZWxlY3RlZCA9IHRoaXMucGFyZW50LmNvbnRlbnRNb2R1bGUgP1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNvbnRlbnRNb2R1bGUuc2VsZWN0ZWRSb3dJbmRleCA+IC0xIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoZGF0YS5pc0FkZCB8fCBPYmplY3Qua2V5cyhkYXRhLnZpcnR1YWxEYXRhKS5sZW5ndGggfHwgaXNLZXlGb2N1cyB8fCBkYXRhLmlzQ2FuY2VsIHx8IGlzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnQucmVzZXRWaXJ0dWFsRm9jdXMsIHsgaXNDYW5jZWw6IGZhbHNlIH0pO1xuICAgICAgICAgICAgICAgIGRhdGEuaXNDYW5jZWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoKCh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiAhdGhpcy5wYXJlbnQuc2VsZWN0VmlydHVhbFJvd09uQWRkKSAmJiAoIWUgfHwgKGUgJiYgZS5hY3Rpb24gIT09ICdjdHJsSG9tZScgJiYgZS5hY3Rpb24gIT09ICdjdHJsRW5kJykpKSB8fFxuICAgICAgICAgICAgICAgICAgICAhdGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuY29udGVudE1vZHVsZS5zZWxlY3RlZFJvd0luZGV4ID0gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LnNlbGVjdFZpcnR1YWxSb3dPbkFkZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChpc0tleUZvY3VzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlS2V5ID0gdGhpcy5lbXB0eTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5KCd2aXJ0YXVsLWtleS1oYW5kbGVyJywgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5mby5lbGVtZW50VG9Gb2N1cy5mb2N1cyh7IHByZXZlbnRTY3JvbGw6IHRydWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1ZpcnR1YWxTY3JvbGwgfHwgdGhpcy5pc0luZmluaXRlU2Nyb2xsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEluZm8uZWxlbWVudFRvRm9jdXMuZm9jdXMoeyBwcmV2ZW50U2Nyb2xsOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5mby5lbGVtZW50VG9Gb2N1cy5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzVmlydHVhbFNjcm9sbCA9IHRoaXMuaXNJbmZpbml0ZVNjcm9sbCA9IGZhbHNlO1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuZ2V0Rm9jdXNlZEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRJbmZvLmVsZW1lbnRUb0ZvY3VzO1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuZ2V0Q29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlIHx8IHRoaXMuY29udGVudDtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLnNldEFjdGl2ZSA9IGZ1bmN0aW9uIChjb250ZW50KSB7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gY29udGVudCA/IHRoaXMuY29udGVudCA6IHRoaXMuaGVhZGVyO1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuc2V0Rm9jdXNlZEVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCwgZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmN1cnJlbnRJbmZvLmVsZW1lbnRUb0ZvY3VzID0gZWxlbWVudDtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKF90aGlzLmN1cnJlbnRJbmZvLmVsZW1lbnRUb0ZvY3VzKSkge1xuICAgICAgICAgICAgICAgIHZhciBmaWx0ZXJNZW51RWxlbWVudCA9IGlzTnVsbE9yVW5kZWZpbmVkKF90aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWZsbWVudScpKSA/XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWdyaWQtcG9wdXAgLmUtZmxtZW51JykgOiBfdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1mbG1lbnUnKTtcbiAgICAgICAgICAgICAgICBpZiAoKF90aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCBfdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcpICYmIGlzTnVsbE9yVW5kZWZpbmVkKGZpbHRlck1lbnVFbGVtZW50KSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5mb2N1c1ZpcnR1YWxFbGVtZW50KGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc051bGxPclVuZGVmaW5lZChmaWx0ZXJNZW51RWxlbWVudCkgfHxcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50c1VudGlsKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQsICdlLWZsbWVudS12YWx1ZWRpdicpICE9PSBmaWx0ZXJNZW51RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1mbG1lbnUtdmFsdWVkaXYnKSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5jdXJyZW50SW5mby5lbGVtZW50VG9Gb2N1cy5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgMCk7XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5mb2N1cyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeShldmVudC52aXJ0YXVsQ2VsbEZvY3VzLCBlKTtcbiAgICAgICAgdGhpcy5yZW1vdmVGb2N1cygpO1xuICAgICAgICB0aGlzLmFkZEZvY3VzKHRoaXMuZ2V0Q29udGVudCgpLmdldEZvY3VzSW5mbygpLCBlKTtcbiAgICB9O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5yZW1vdmVGb2N1cyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghdGhpcy5jdXJyZW50SW5mby5lbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzUmVhY3QgJiYgIXRoaXMucGFyZW50LmlzRWRpdCAmJiB0aGlzLmN1cnJlbnRJbmZvLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXJvd2NlbGwnKVxuICAgICAgICAgICAgJiYgIXRoaXMuY3VycmVudEluZm8uZWxlbWVudC5wYXJlbnRFbGVtZW50ICYmICEodGhpcy5wYXJlbnQuYWxsb3dHcm91cGluZ1xuICAgICAgICAgICAgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucykgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkgJiZcbiAgICAgICAgICAgIHRoaXMucGFyZW50LmdldFJvd0J5SW5kZXgodGhpcy5wcmV2SW5kZXhlcy5yb3dJbmRleCkpIHtcbiAgICAgICAgICAgIHZhciBjZWxsRWxlbSA9IHRoaXMucGFyZW50LmdldENlbGxGcm9tSW5kZXgodGhpcy5wcmV2SW5kZXhlcy5yb3dJbmRleCwgdGhpcy5wcmV2SW5kZXhlc1xuICAgICAgICAgICAgICAgIC5jZWxsSW5kZXgpO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5mby5lbGVtZW50ID0gY2VsbEVsZW0gPyBjZWxsRWxlbSA6IHRoaXMuY3VycmVudEluZm8uZWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICByZW1vdmVDbGFzcyhbdGhpcy5jdXJyZW50SW5mby5lbGVtZW50LCB0aGlzLmN1cnJlbnRJbmZvLmVsZW1lbnRUb0ZvY3VzXSwgWydlLWZvY3VzZWQnLCAnZS1mb2N1cyddKTtcbiAgICAgICAgdGhpcy5jdXJyZW50SW5mby5lbGVtZW50LnRhYkluZGV4ID0gLTE7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuICovXG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuYWRkT3V0bGluZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGluZm8gPSB0aGlzLmdldENvbnRlbnQoKS5nZXRGb2N1c0luZm8oKTtcbiAgICAgICAgaWYgKGluZm8uZWxlbWVudCkge1xuICAgICAgICAgICAgYWRkQ2xhc3MoW2luZm8uZWxlbWVudF0sIFsnZS1mb2N1c2VkJ10pO1xuICAgICAgICAgICAgYWRkQ2xhc3MoW2luZm8uZWxlbWVudFRvRm9jdXNdLCBbJ2UtZm9jdXMnXSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW4gKi9cbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5mb2N1c0hlYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXRBY3RpdmUoZmFsc2UpO1xuICAgICAgICB0aGlzLnJlc2V0Rm9jdXMoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW4gKi9cbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5mb2N1c0NvbnRlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2V0QWN0aXZlKHRydWUpO1xuICAgICAgICB0aGlzLnJlc2V0Rm9jdXMoKTtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLnJlc2V0Rm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjdXJyZW50ID0gdGhpcy5nZXRDb250ZW50KCkubWF0cml4LmdldCgwLCAtMSwgWzAsIDFdLCBudWxsLCB0aGlzLmdldENvbnRlbnQoKS52YWxpZGF0b3IoKSk7XG4gICAgICAgIHRoaXMuZ2V0Q29udGVudCgpLm1hdHJpeC5zZWxlY3QoY3VycmVudFswXSwgY3VycmVudFsxXSk7XG4gICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLmFkZEZvY3VzID0gZnVuY3Rpb24gKGluZm8sIGUpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50SW5mbyA9IGluZm87XG4gICAgICAgIHRoaXMuY3VycmVudEluZm8ub3V0bGluZSA9IGluZm8ub3V0bGluZSAmJiAoIWlzTnVsbE9yVW5kZWZpbmVkKGUpIHx8IHRoaXMuaXNWaXJ0dWFsU2Nyb2xsKTtcbiAgICAgICAgaWYgKHRoaXMuaXNJbmZpbml0ZVNjcm9sbCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5mby5vdXRsaW5lID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWluZm8uZWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpc0ZvY3VzZWQgPSBpbmZvLmVsZW1lbnRUb0ZvY3VzLmNsYXNzTGlzdC5jb250YWlucygnZS1mb2N1cycpO1xuICAgICAgICBpZiAoaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEluZm8ub3V0bGluZSkge1xuICAgICAgICAgICAgYWRkQ2xhc3MoW2luZm8uZWxlbWVudF0sIFsnZS1mb2N1c2VkJ10pO1xuICAgICAgICB9XG4gICAgICAgIGFkZENsYXNzKFtpbmZvLmVsZW1lbnRUb0ZvY3VzXSwgWydlLWZvY3VzJ10pO1xuICAgICAgICBpbmZvLmVsZW1lbnQudGFiSW5kZXggPSAwO1xuICAgICAgICBpZiAoIWlzRm9jdXNlZCkge1xuICAgICAgICAgICAgdGhpcy5zZXRGb2N1c2VkRWxlbWVudChpbmZvLmVsZW1lbnRUb0ZvY3VzLCBlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnQuY2VsbEZvY3VzZWQsIHtcbiAgICAgICAgICAgIGVsZW1lbnQ6IGluZm8uZWxlbWVudFRvRm9jdXMsXG4gICAgICAgICAgICBwYXJlbnQ6IGluZm8uZWxlbWVudCxcbiAgICAgICAgICAgIGluZGV4ZXM6IHRoaXMuZ2V0Q29udGVudCgpLm1hdHJpeC5jdXJyZW50LFxuICAgICAgICAgICAgYnlLZXk6ICFpc051bGxPclVuZGVmaW5lZChlKSxcbiAgICAgICAgICAgIGJ5Q2xpY2s6IGlzTnVsbE9yVW5kZWZpbmVkKGUpLFxuICAgICAgICAgICAga2V5QXJnczogZSxcbiAgICAgICAgICAgIGlzSnVtcDogdGhpcy5zd2FwLnN3YXAsXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuZ2V0Q29udGVudCgpLmdldEluZm8oZSksXG4gICAgICAgICAgICBvdXRsaW5lOiAhaXNOdWxsT3JVbmRlZmluZWQoZSksXG4gICAgICAgICAgICBzd2FwSW5mbzogdGhpcy5zd2FwXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgX2EgPSB0aGlzLmdldENvbnRlbnQoKS5tYXRyaXguY3VycmVudCwgcm93SW5kZXggPSBfYVswXSwgY2VsbEluZGV4ID0gX2FbMV07XG4gICAgICAgIHRoaXMucHJldkluZGV4ZXMgPSB7IHJvd0luZGV4OiByb3dJbmRleCwgY2VsbEluZGV4OiBjZWxsSW5kZXggfTtcbiAgICAgICAgdGhpcy5mb2N1c2VkQ29sdW1uVWlkID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1uQnlJbmRleChjZWxsSW5kZXgpLnVpZDtcbiAgICAgICAgdGhpcy5mb2N1c0J5Q2xpY2sgPSBmYWxzZTtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLnJlZnJlc2hNYXRyaXggPSBmdW5jdGlvbiAoY29udGVudCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChjb250ZW50ICYmICFfdGhpcy5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuY29udGVudCA9IG5ldyBDb250ZW50Rm9jdXMoX3RoaXMucGFyZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghY29udGVudCAmJiAhX3RoaXMuaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaGVhZGVyID0gbmV3IEhlYWRlckZvY3VzKF90aGlzLnBhcmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY0ZvY3VzID0gY29udGVudCA/IF90aGlzLmNvbnRlbnQgOiBfdGhpcy5oZWFkZXI7XG4gICAgICAgICAgICB2YXIgZnJvemVuUm93ID0gX3RoaXMucGFyZW50LmZyb3plblJvd3M7XG4gICAgICAgICAgICB2YXIgYmF0Y2hMZW4gPSAwO1xuICAgICAgICAgICAgaWYgKGZyb3plblJvdyAmJiBfdGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm1vZGUgPT09ICdCYXRjaCcpIHtcbiAgICAgICAgICAgICAgICBiYXRjaExlbiA9IF90aGlzLnBhcmVudC5nZXRIZWFkZXJDb250ZW50KCkucXVlcnlTZWxlY3RvckFsbCgnLmUtaW5zZXJ0ZWRyb3cnKS5sZW5ndGggK1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wYXJlbnQuZ2V0SGVhZGVyQ29udGVudCgpLnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLWhpZGRlbnJvdycpLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoX3RoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucykgJiYgX3RoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggJiYgZnJvemVuUm93ICYmIGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBmcm96ZW5Sb3cgPSAwO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZS5yb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb3plblJvdysrO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5yb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRleCArIDEgPT09IF90aGlzLnBhcmVudC5mcm96ZW5Sb3dzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5ncm91cGVkRnJvemVuUm93ID0gZnJvemVuUm93O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJvd3MgPSBjb250ZW50ID8gZS5yb3dzLnNsaWNlKGZyb3plblJvdyArIGJhdGNoTGVuKSA6IGUucm93cztcbiAgICAgICAgICAgIHZhciB1cGRhdGVSb3cgPSBjb250ZW50ID8gZS5yb3dzLnNsaWNlKDAsIGZyb3plblJvdyArIGJhdGNoTGVuKSA6IGUucm93cztcbiAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQuaXNDb2xsYXBzZVN0YXRlRW5hYmxlZCgpICYmIGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICByb3dzID0gcm93cy5maWx0ZXIoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgudmlzaWJsZSAhPT0gZmFsc2U7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlzUm93VGVtcGxhdGUgPSAhaXNOdWxsT3JVbmRlZmluZWQoX3RoaXMucGFyZW50LnJvd1RlbXBsYXRlKTtcbiAgICAgICAgICAgIGlmIChmcm96ZW5Sb3cgJiYgKChfdGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm1vZGUgPT09ICdCYXRjaCcgJiYgY29udGVudCAmJiAoZS5uYW1lID09PSAnYmF0Y2hEZWxldGUnIHx8IGUubmFtZSA9PT0gJ2JhdGNoQWRkJyB8fFxuICAgICAgICAgICAgICAgIGUubmFtZSA9PT0gJ2JhdGNoQ2FuY2VsJyB8fCAoZS5hcmdzICYmIChlLmFyZ3MucmVxdWVzdFR5cGUgPT09ICdiYXRjaHNhdmUnKSkpKSB8fFxuICAgICAgICAgICAgICAgIChlLmFyZ3MgJiYgKGUuYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2RlbGV0ZScgfHwgZS5hcmdzLnJlcXVlc3RUeXBlID09PSAnc2F2ZScpKSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF0cml4Y3MgPSBfdGhpcy5oZWFkZXIubWF0cml4Lm1hdHJpeDtcbiAgICAgICAgICAgICAgICB2YXIgaGRyTGVuID0gX3RoaXMucGFyZW50LmhlYWRlck1vZHVsZS5yb3dzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBtYXRyaXhjcy5zcGxpY2UoaGRyTGVuLCBtYXRyaXhjcy5sZW5ndGggLSBoZHJMZW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG1hdHJpeCA9IGNGb2N1cy5tYXRyaXguZ2VuZXJhdGUodXBkYXRlUm93LCBjRm9jdXMuc2VsZWN0b3IsIGlzUm93VGVtcGxhdGUpO1xuICAgICAgICAgICAgY0ZvY3VzLm1hdHJpeC5nZW5lcmF0ZShyb3dzLCBjRm9jdXMuc2VsZWN0b3IsIGlzUm93VGVtcGxhdGUpO1xuICAgICAgICAgICAgdmFyIGlzU2Nyb2xsID0gX3RoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8IF90aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZztcbiAgICAgICAgICAgIGlmICgoX3RoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIGNvbnRlbnQgJiYgX3RoaXMuaGVhZGVyICYmIF90aGlzLmhlYWRlci5tYXRyaXgpICYmXG4gICAgICAgICAgICAgICAgKCFpc1Njcm9sbCB8fCAoaXNTY3JvbGwgJiYgX3RoaXMucGFyZW50LmlzQWRkTmV3Um93KSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGVtcE1hdHJpeCA9IF90aGlzLmhlYWRlci5tYXRyaXgubWF0cml4O1xuICAgICAgICAgICAgICAgIHZhciBsYXN0Um93SGVhZGVySWR4ID0gX3RoaXMucGFyZW50LmFsbG93RmlsdGVyaW5nICYmIF90aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnRmlsdGVyQmFyJyA/IDIgOiAxO1xuICAgICAgICAgICAgICAgIGNGb2N1cy5tYXRyaXgucm93cyA9IF90aGlzLnBhcmVudC5mcm96ZW5Sb3dzICYmIF90aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubmV3Um93UG9zaXRpb24gPT09ICdUb3AnID9cbiAgICAgICAgICAgICAgICAgICAgY0ZvY3VzLm1hdHJpeC5yb3dzIDogKytjRm9jdXMubWF0cml4LnJvd3M7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubmV3Um93UG9zaXRpb24gPT09ICdUb3AnKSB7XG4gICAgICAgICAgICAgICAgICAgIChfdGhpcy5wYXJlbnQuZnJvemVuUm93cyB8fCBpc1Njcm9sbCA/XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRyaXggOiBjRm9jdXMubWF0cml4Lm1hdHJpeCkudW5zaGlmdChfdGhpcy5yZWZyZXNoQWRkTmV3Um93TWF0cml4KHRlbXBNYXRyaXhbdGVtcE1hdHJpeC5sZW5ndGggLVxuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFJvd0hlYWRlcklkeF0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNGb2N1cy5tYXRyaXgubWF0cml4LnB1c2goX3RoaXMucmVmcmVzaEFkZE5ld1Jvd01hdHJpeCh0ZW1wTWF0cml4W3RlbXBNYXRyaXgubGVuZ3RoIC0gbGFzdFJvd0hlYWRlcklkeF0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LmlzQWRkTmV3Um93ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIShfdGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkgJiYgKGUuYXJncyAmJiAoZS5hcmdzLnJlcXVlc3RUeXBlID09PSAnc29ydGluZydcbiAgICAgICAgICAgICAgICB8fCBlLmFyZ3MucmVxdWVzdFR5cGUgPT09ICdiYXRjaHNhdmUnIHx8IGUuYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3BhZ2luZycpKSkgfHxcbiAgICAgICAgICAgICAgICAoZnJvemVuUm93ICYmIF90aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ0JhdGNoJyAmJiBjb250ZW50ICYmIChlLm5hbWUgPT09ICdiYXRjaERlbGV0ZScgfHwgZS5uYW1lID09PSAnYmF0Y2hBZGQnIHx8XG4gICAgICAgICAgICAgICAgICAgIGUubmFtZSA9PT0gJ2JhdGNoQ2FuY2VsJyB8fCBlLmFyZ3MucmVxdWVzdFR5cGUgPT09ICdiYXRjaHNhdmUnKSkpIHtcbiAgICAgICAgICAgICAgICBjRm9jdXMuZ2VuZXJhdGVSb3dzKHVwZGF0ZVJvdywge1xuICAgICAgICAgICAgICAgICAgICBtYXRyaXg6IG1hdHJpeCwgaGFuZGxlckluc3RhbmNlOiBfdGhpcy5oZWFkZXJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghQnJvd3Nlci5pc0RldmljZSAmJiBlICYmIGUuYXJncykge1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuZm9jdXNCeUNsaWNrICYmIGUuYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ3BhZ2luZycgJiYgIV90aGlzLnBhcmVudC5wYWdlck1vZHVsZS5wYWdlck9iai5jaGVja1BhZ2VySGFzRm9jdXMoKSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5za2lwRm9jdXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucGFyZW50LmVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGUuYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2dyb3VwaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5za2lwRm9jdXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlICYmIGUuYXJncyAmJiBlLmFyZ3MucmVxdWVzdFR5cGUgPT09ICd2aXJ0dWFsc2Nyb2xsJykge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5jdXJyZW50SW5mby51aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4XzE7XG4gICAgICAgICAgICAgICAgICAgIHZhciBib29sID0gZS5yb3dzLnNvbWUoZnVuY3Rpb24gKHJvdywgaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXhfMSA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm93LnVpZCA9PT0gX3RoaXMuY3VycmVudEluZm8udWlkO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJvb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbnRlbnQubWF0cml4LmN1cnJlbnRbMF0gPSBpbmRleF8xO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29udGVudC5tYXRyaXguY3VycmVudFsxXSA9IF90aGlzLnBhcmVudC5nZXRDb2x1bW5JbmRleEJ5VWlkKF90aGlzLmZvY3VzZWRDb2x1bW5VaWQpIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJ6TGVmdENvdW50ID0gX3RoaXMucGFyZW50LmdldFZpc2libGVGcm96ZW5MZWZ0Q291bnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmcnpSaWdodENvdW50ID0gX3RoaXMucGFyZW50LmdldFZpc2libGVGcm96ZW5SaWdodENvdW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uICYmICEoZnJ6TGVmdENvdW50ICYmIGZyelJpZ2h0Q291bnQpICYmIF90aGlzLnBhcmVudC5pc0Zyb3plbkdyaWQoKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuYXJncy52aXJ0dWFsSW5mby5kaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5jb250ZW50Lm1hdHJpeC5jdXJyZW50WzFdID0gX3RoaXMuY29udGVudC5tYXRyaXguY3VycmVudFsxXSAtIChmcnpMZWZ0Q291bnQgKyAoZnJ6UmlnaHRDb3VudCA/IGZyelJpZ2h0Q291bnQgKyAxIDogMCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzR3JvdXAgPSBfdGhpcy5wYXJlbnQuYWxsb3dHcm91cGluZyAmJiBfdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0dyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29udGVudC5tYXRyaXguY3VycmVudFsxXSA9IF90aGlzLnByZXZJbmRleGVzLmNlbGxJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMudmlydHVhbFNlbGVjdGlvbkluZm8uaXNQZW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbnRlbnQubWF0cml4LmN1cnJlbnRbMF0gPSBfdGhpcy52aXJ0dWFsU2VsZWN0aW9uSW5mby5kaXJlY3Rpb24gPT09ICdkb3duQXJyb3cnID8gX3RoaXMuY29udGVudC5tYXRyaXguY3VycmVudFswXSArIDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX3RoaXMuY29udGVudC5tYXRyaXguY3VycmVudFswXSAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvY3VzRWxlbWVudCA9IF90aGlzLmdldENvbnRlbnQoKS5nZXRGb2N1c0luZm8oKS5lbGVtZW50VG9Gb2N1cztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb2N1c0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbFBvc2l0aW9uID0gZm9jdXNFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncmlkUG9zaXRpb24gPSBfdGhpcy5wYXJlbnQuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJlZXplTGVmdENvbFdpZHRoID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJlZXplUmlnaHRDb2xXaWR0aCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiAmJiAhKGZyekxlZnRDb3VudCAmJiBmcnpSaWdodENvdW50KSAmJiBfdGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5hcmdzLnZpcnR1YWxJbmZvLmRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnJ6TGVmdENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcmVlemVMZWZ0Q29sV2lkdGggPSBfdGhpcy5wYXJlbnQubGVmdHJpZ2h0Q29sdW1uV2lkdGgoJ2xlZnQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyZWV6ZVJpZ2h0Q29sV2lkdGggPSBfdGhpcy5wYXJlbnQubGVmdHJpZ2h0Q29sdW1uV2lkdGgoJ3JpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChjZWxsUG9zaXRpb24udG9wID49IDAgJiYgY2VsbFBvc2l0aW9uLmxlZnQgPj0gMCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY2VsbFBvc2l0aW9uLnJpZ2h0IC0gZnJlZXplTGVmdENvbFdpZHRoIC0gZnJlZXplUmlnaHRDb2xXaWR0aCkgPD0gKE1hdGgubWluKGdyaWRQb3NpdGlvbi5yaWdodCwgd2luZG93LmlubmVyV2lkdGggfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKSArIGZyZWV6ZVJpZ2h0Q29sV2lkdGgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGNlbGxQb3NpdGlvbi5ib3R0b20gPD0gTWF0aC5taW4oZ3JpZFBvc2l0aW9uLmJvdHRvbSwgd2luZG93LmlubmVySGVpZ2h0IHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KSkgfHwgaXNHcm91cCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc1ZpcnR1YWxTY3JvbGwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5mb2N1cyhpc0dyb3VwICYmIF90aGlzLnZpcnR1YWxTZWxlY3Rpb25JbmZvLmlzUGVuZGluZyA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy52aXJ0dWFsU2VsZWN0aW9uSW5mby5ldmVudCA6IHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGUuYXJncy5mb2N1c0VsZW1lbnQgJiYgZS5hcmdzLmZvY3VzRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZmlsdGVydGV4dCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmb2N1c0VsZW1lbnQgPSBfdGhpcy5wYXJlbnQuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGUuYXJncy5mb2N1c0VsZW1lbnQuaWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZm9jdXNFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb2N1c0VsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy52aXJ0dWFsU2VsZWN0aW9uSW5mbyA9IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUgJiYgZS5hcmdzICYmIGUuYXJncy5yZXF1ZXN0VHlwZSA9PT0gJ2luZmluaXRlU2Nyb2xsJykge1xuICAgICAgICAgICAgICAgIF90aGlzLmlzSW5maW5pdGVTY3JvbGwgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUucmVmcmVzaEFkZE5ld1Jvd01hdHJpeCA9IGZ1bmN0aW9uIChtYXRyaXgpIHtcbiAgICAgICAgdmFyIGNvbHMgPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCk7XG4gICAgICAgIHZhciBpbmRlbnQgPSB0aGlzLnBhcmVudC5nZXRJbmRlbnRDb3VudCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gaW5kZW50OyBpIDwgbWF0cml4Lmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgaWYgKGNvbHNbaSAtIGluZGVudF0gJiYgY29sc1tpIC0gaW5kZW50XS52aXNpYmxlICYmIGNvbHNbaSAtIGluZGVudF0uYWxsb3dFZGl0aW5nKSB7XG4gICAgICAgICAgICAgICAgbWF0cml4W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYXRyaXhbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF0cml4O1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnBhcmVudC5lbGVtZW50LCAnbW91c2Vkb3duJywgdGhpcy5mb2N1c0NoZWNrLCB0aGlzKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnBhcmVudC5lbGVtZW50LCAndG91Y2hzdGFydCcsIHRoaXMuZm9jdXNDaGVjaywgdGhpcyk7XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5wYXJlbnQuZWxlbWVudCwgJ2ZvY3VzJywgdGhpcy5vbkZvY3VzLCB0aGlzKTtcbiAgICAgICAgdGhpcy5wYXJlbnQuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMucGFzc2l2ZUhhbmRsZXIgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMucGFzc2l2ZUZvY3VzKGUpOyB9LCB0cnVlKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnBhcmVudC5lbGVtZW50LCAnZm9jdXNvdXQnLCB0aGlzLm9uQmx1ciwgdGhpcyk7XG4gICAgICAgIHRoaXMuZXZ0SGFuZGxlcnMgPSBbeyBldmVudDogZXZlbnQua2V5UHJlc3NlZCwgaGFuZGxlcjogdGhpcy5vbktleVByZXNzIH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudC5jbGljaywgaGFuZGxlcjogdGhpcy5vbkNsaWNrIH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudC5jb250ZW50UmVhZHksIGhhbmRsZXI6IHRoaXMucmVmTWF0cml4IH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudC5wYXJ0aWFsUmVmcmVzaCwgaGFuZGxlcjogdGhpcy5yZWZNYXRyaXggfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50LnJlZnJlc2hFeHBhbmRhbmRDb2xsYXBzZSwgaGFuZGxlcjogdGhpcy5yZWZNYXRyaXggfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50LnNob3dBZGROZXdSb3dGb2N1cywgaGFuZGxlcjogdGhpcy5zaG93QWRkTmV3Um93Rm9jdXMgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50LmhlYWRlclJlZnJlc2hlZCwgaGFuZGxlcjogdGhpcy5yZWZyZXNoTWF0cml4KCkgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50LmNsb3NlRWRpdCwgaGFuZGxlcjogdGhpcy5yZXN0b3JlRm9jdXMgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50LnJlc3RvcmVGb2N1cywgaGFuZGxlcjogdGhpcy5yZXN0b3JlRm9jdXMgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6ICdzdGFydC1lZGl0JywgaGFuZGxlcjogdGhpcy5jbGVhckluZGljYXRvciB9LFxuICAgICAgICAgICAgeyBldmVudDogJ3N0YXJ0LWFkZCcsIGhhbmRsZXI6IHRoaXMuY2xlYXJJbmRpY2F0b3IgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6ICdzb3J0aW5nLWNvbXBsZXRlJywgaGFuZGxlcjogdGhpcy5yZXN0b3JlRm9jdXMgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6ICdmaWx0ZXJpbmctY29tcGxldGUnLCBoYW5kbGVyOiB0aGlzLmZpbHRlcmZvY3VzIH0sXG4gICAgICAgICAgICB7IGV2ZW50OiAnY3VzdG9tLWZpbHRlci1jbG9zZScsIGhhbmRsZXI6IHRoaXMuZmlsdGVyZm9jdXMgfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6ICdncm91cGluZy1jb21wbGV0ZScsIGhhbmRsZXI6IHRoaXMucmVzdG9yZUZvY3VzV2l0aEFjdGlvbiB9LFxuICAgICAgICAgICAgeyBldmVudDogJ3VuZ3JvdXBpbmctY29tcGxldGUnLCBoYW5kbGVyOiB0aGlzLnJlc3RvcmVGb2N1c1dpdGhBY3Rpb24gfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50LmJhdGNoQWRkLCBoYW5kbGVyOiB0aGlzLnJlZk1hdHJpeCB9LFxuICAgICAgICAgICAgeyBldmVudDogZXZlbnQuYmF0Y2hDYW5jZWwsIGhhbmRsZXI6IHRoaXMucmVmTWF0cml4IH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudC5iYXRjaERlbGV0ZSwgaGFuZGxlcjogdGhpcy5yZWZNYXRyaXggfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50LmRldGFpbERhdGFCb3VuZCwgaGFuZGxlcjogdGhpcy5yZWZNYXRyaXggfSxcbiAgICAgICAgICAgIHsgZXZlbnQ6IGV2ZW50Lm9uRW1wdHksIGhhbmRsZXI6IHRoaXMucmVmTWF0cml4IH0sXG4gICAgICAgICAgICB7IGV2ZW50OiBldmVudC5jZWxsRm9jdXNlZCwgaGFuZGxlcjogdGhpcy5pbnRlcm5hbENlbGxGb2N1cyB9XTtcbiAgICAgICAgYWRkUmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLnBhcmVudCwgdGhpcy5ldnRIYW5kbGVycywgdHJ1ZSwgdGhpcyk7XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5zaG93QWRkTmV3Um93Rm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1Jvdykge1xuICAgICAgICAgICAgdmFyIHN0YXJ0SWR4ID0gdGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm5ld1Jvd1Bvc2l0aW9uID09PSAnVG9wJyA/IDAgOiB0aGlzLmNvbnRlbnQubWF0cml4Lm1hdHJpeC5sZW5ndGggLSAxO1xuICAgICAgICAgICAgdmFyIHN0YXJ0Q2VsbElkeCA9IHRoaXMucGFyZW50LmdldEluZGVudENvdW50KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm5ld1Jvd1Bvc2l0aW9uID09PSAnVG9wJyAmJiAodGhpcy5wYXJlbnQuZnJvemVuUm93cyB8fFxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8IHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSkge1xuICAgICAgICAgICAgICAgIHZhciBoZWFkcklkeCA9IHRoaXMuaGVhZGVyLm1hdHJpeC5tYXRyaXgubGVuZ3RoIC0gKHRoaXMuZ3JvdXBlZEZyb3plblJvdyA/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXBlZEZyb3plblJvdyA6IHRoaXMucGFyZW50LmZyb3plblJvd3MpO1xuICAgICAgICAgICAgICAgIHN0YXJ0Q2VsbElkeCA9IHRoaXMuZmluZE5leHRDZWxsRm9jdXModGhpcy5oZWFkZXIubWF0cml4Lm1hdHJpeFtoZWFkcklkeCAtIDFdLCBzdGFydENlbGxJZHgpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyLm1hdHJpeC5jdXJyZW50ID0gW2hlYWRySWR4IC0gMSwgc3RhcnRDZWxsSWR4XTtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IHRoaXMuaGVhZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RhcnRDZWxsSWR4ID0gdGhpcy5maW5kTmV4dENlbGxGb2N1cyh0aGlzLmNvbnRlbnQubWF0cml4Lm1hdHJpeFtwYXJzZUludChzdGFydElkeC50b1N0cmluZygpLCAxMCldLCBzdGFydENlbGxJZHgpO1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudC5tYXRyaXguY3VycmVudCA9IFtzdGFydElkeCwgc3RhcnRDZWxsSWR4XTtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IHRoaXMuY29udGVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhZGRlZHJvdyA9IHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtYWRkZWRyb3cnKTtcbiAgICAgICAgICAgIGlmIChhZGRlZHJvdyAmJiBhZGRlZHJvdy5xdWVyeVNlbGVjdG9yQWxsKCd0cicpICYmXG4gICAgICAgICAgICAgICAgYWRkZWRyb3cucXVlcnlTZWxlY3RvcigndHInKS5jZWxsc1twYXJzZUludChzdGFydENlbGxJZHgudG9TdHJpbmcoKSwgMTApXS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpKSB7XG4gICAgICAgICAgICAgICAgYWRkZWRyb3cucXVlcnlTZWxlY3RvcigndHInKS5jZWxsc1twYXJzZUludChzdGFydENlbGxJZHgudG9TdHJpbmcoKSwgMTApXS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLnNlbGVjdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5maW5kTmV4dENlbGxGb2N1cyA9IGZ1bmN0aW9uIChtYXRyaXgsIGNlbGxJbmRleCkge1xuICAgICAgICBmb3IgKHZhciBpID0gY2VsbEluZGV4OyBpIDwgbWF0cml4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobWF0cml4W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjZWxsSW5kZXg7XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5maWx0ZXJmb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmZpbHRlclNldHRpbmdzLnR5cGUgIT09ICdGaWx0ZXJCYXInKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUZvY3VzKCk7XG4gICAgICAgICAgICB0aGlzLnJlc3RvcmVGb2N1cygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMucGFyZW50LmVsZW1lbnQsICdtb3VzZWRvd24nLCB0aGlzLmZvY3VzQ2hlY2spO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMucGFyZW50LmVsZW1lbnQsICd0b3VjaHN0YXJ0JywgdGhpcy5mb2N1c0NoZWNrKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLnBhcmVudC5lbGVtZW50LCAnZm9jdXMnLCB0aGlzLm9uRm9jdXMpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMucGFyZW50LmVsZW1lbnQsICdmb2N1c291dCcsIHRoaXMub25CbHVyKTtcbiAgICAgICAgdGhpcy5wYXJlbnQuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMucGFzc2l2ZUhhbmRsZXIsIHRydWUpO1xuICAgICAgICBhZGRSZW1vdmVFdmVudExpc3RlbmVyKHRoaXMucGFyZW50LCB0aGlzLmV2dEhhbmRsZXJzLCBmYWxzZSk7XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLnJlc3RvcmVGb2N1cyA9IGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgaWYgKGFyZyAmJiBhcmcucmVxdWVzdFR5cGUgPT09ICdzb3J0aW5nJyAmJiBpc051bGxPclVuZGVmaW5lZChhcmcudGFyZ2V0KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBncm91cE1vZHVsZSA9IHRoaXMucGFyZW50Lmdyb3VwTW9kdWxlO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dHcm91cGluZyAmJiBncm91cE1vZHVsZSAmJiAoZ3JvdXBNb2R1bGUuZ3JvdXBTb3J0Rm9jdXMgfHwgZ3JvdXBNb2R1bGUuZ3JvdXBUZXh0Rm9jdXMpKSB7XG4gICAgICAgICAgICBncm91cE1vZHVsZS5ncm91cFNvcnRGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgICAgZ3JvdXBNb2R1bGUuZ3JvdXBUZXh0Rm9jdXMgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZpcnN0SGVhZGVyQ2VsbENsaWNrID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5hZGRGb2N1cyh0aGlzLmdldENvbnRlbnQoKS5nZXRGb2N1c0luZm8oKSk7XG4gICAgICAgIHZhciByZXF1ZXN0VHlwZXMgPSBbJ2FkZCcsICdzYXZlJywgJ2RlbGV0ZScsICdjYW5jZWwnLCAnYmF0Y2hzYXZlJywgJ2JhdGNoRGVsZXRlJywgJ2JhdGNoQ2FuY2VsJ107XG4gICAgICAgIHZhciBmb2N1c0luZm8gPSB0aGlzLmdldENvbnRlbnQoKS5nZXRGb2N1c0luZm8oKTtcbiAgICAgICAgaWYgKGFyZyAmJiByZXF1ZXN0VHlwZXMuaW5kZXhPZihhcmcucmVxdWVzdFR5cGUpID4gLTEgJiYgZm9jdXNJbmZvICYmIGZvY3VzSW5mby5lbGVtZW50VG9Gb2N1cyAmJiBmb2N1c0luZm8uZWxlbWVudFRvRm9jdXMubWF0Y2hlcygnLmUtcm93Y2VsbC5lLWZvY3VzJykpIHtcbiAgICAgICAgICAgIGFkZENsYXNzKFtmb2N1c0luZm8uZWxlbWVudFRvRm9jdXNdLCBbJ2UtZm9jdXNlZCcsICdlLWZvY3VzJ10pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5yZXN0b3JlRm9jdXNXaXRoQWN0aW9uID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5lbmFibGVJbmZpbml0ZVNjcm9sbGluZyAmJlxuICAgICAgICAgICAgISh0aGlzLnBhcmVudC5ncm91cE1vZHVsZSAmJiB0aGlzLnBhcmVudC5ncm91cE1vZHVsZS5wcmV2ZW50Rm9jdXNPbkdyb3VwKSkge1xuICAgICAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZ2V0Q29udGVudCgpLm1hdHJpeDtcbiAgICAgICAgICAgIHZhciBjdXJyZW50ID0gbWF0cml4LmN1cnJlbnQ7XG4gICAgICAgICAgICBzd2l0Y2ggKGUucmVxdWVzdFR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdncm91cGluZyc6XG4gICAgICAgICAgICAgICAgY2FzZSAndW5ncm91cGluZyc6XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRbMV0gPSBjdXJyZW50Lmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3Muc2hvd0dyb3VwZWRDb2x1bW4gJiYgIWlzTnVsbE9yVW5kZWZpbmVkKG1hdHJpeC5tYXRyaXhbY3VycmVudFswXV0pID9cbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5tYXRyaXhbY3VycmVudFswXV0uaW5kZXhPZigxKSA6IGUucmVxdWVzdFR5cGUgPT09ICdncm91cGluZycgPyBjdXJyZW50WzFdICsgMSA6IGN1cnJlbnRbMV0gLSAxO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZ2V0Q29udGVudCgpLm1hdHJpeC5jdXJyZW50ID0gY3VycmVudDtcbiAgICAgICAgICAgIHRoaXMucHJldkluZGV4ZXMgPSB7IHJvd0luZGV4OiBjdXJyZW50WzBdLCBjZWxsSW5kZXg6IGN1cnJlbnRbMV0gfTtcbiAgICAgICAgICAgIHZhciBncm91cE1vZHVsZSA9IHRoaXMucGFyZW50Lmdyb3VwTW9kdWxlO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93R3JvdXBpbmcgJiYgZ3JvdXBNb2R1bGUgJiYgZ3JvdXBNb2R1bGUuZ3JvdXBDYW5jZWxGb2N1cykge1xuICAgICAgICAgICAgICAgIHZhciBmb2N1c2FibGVHcm91cGVkSXRlbXMgPSBncm91cE1vZHVsZS5nZXRGb2N1c2FibGVHcm91cGVkSXRlbXMoKTtcbiAgICAgICAgICAgICAgICBpZiAoZm9jdXNhYmxlR3JvdXBlZEl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZm9jdXNhYmxlR3JvdXBlZEl0ZW1zWzBdLnBhcmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdlai1tYXBwaW5nbmFtZScpID09PSBlLmNvbHVtbk5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzYWJsZUdyb3VwZWRJdGVtc1szXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNhYmxlR3JvdXBlZEl0ZW1zWzBdLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwTW9kdWxlLmVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ3JvdXBNb2R1bGUuZ3JvdXBDYW5jZWxGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYWRkRm9jdXModGhpcy5nZXRDb250ZW50KCkuZ2V0Rm9jdXNJbmZvKCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5jbGVhckluZGljYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRJbmZvLmVsZW1lbnQgfHwgIXRoaXMuY3VycmVudEluZm8uZWxlbWVudFRvRm9jdXMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZW1vdmVDbGFzcyhbdGhpcy5jdXJyZW50SW5mby5lbGVtZW50LCB0aGlzLmN1cnJlbnRJbmZvLmVsZW1lbnRUb0ZvY3VzXSwgWydlLWZvY3VzJywgJ2UtZm9jdXNlZCddKTtcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLmdldFByZXZJbmRleGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZm9yZ2V0ID0gdGhpcy5mb3JnZXQ7XG4gICAgICAgIHRoaXMuZm9yZ2V0ID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBmb3JnZXQgfHwgIU9iamVjdC5rZXlzKHRoaXMucHJldkluZGV4ZXMpLmxlbmd0aCA/IHsgcm93SW5kZXg6IG51bGwsIGNlbGxJbmRleDogbnVsbCB9IDogdGhpcy5wcmV2SW5kZXhlcztcbiAgICB9O1xuICAgIEZvY3VzU3RyYXRlZ3kucHJvdG90eXBlLmZvcmdldFByZXZpb3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmZvcmdldCA9IHRydWU7XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5zZXRBY3RpdmVCeUtleSA9IGZ1bmN0aW9uIChhY3Rpb24sIGFjdGl2ZSkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZnJvemVuUm93cyA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItY29uc3RcbiAgICAgICAgdmFyIGluZm87XG4gICAgICAgIHZhciBhY3Rpb25zID0ge1xuICAgICAgICAgICAgJ2hvbWUnOiBmdW5jdGlvbiAoKSB7IHJldHVybiAoeyB0b0hlYWRlcjogIWluZm8uaXNDb250ZW50LCB0b0Zyb3plbjogdHJ1ZSB9KTsgfSxcbiAgICAgICAgICAgICdlbmQnOiBmdW5jdGlvbiAoKSB7IHJldHVybiAoeyB0b0hlYWRlcjogIWluZm8uaXNDb250ZW50LCB0b0Zyb3plbjogZmFsc2UgfSk7IH0sXG4gICAgICAgICAgICAnY3RybEhvbWUnOiBmdW5jdGlvbiAoKSB7IHJldHVybiAoeyB0b0hlYWRlcjogdHJ1ZSwgdG9Gcm96ZW46IGZhbHNlIH0pOyB9LFxuICAgICAgICAgICAgJ2N0cmxFbmQnOiBmdW5jdGlvbiAoKSB7IHJldHVybiAoeyB0b0hlYWRlcjogZmFsc2UsIHRvRnJvemVuOiBmYWxzZSB9KTsgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAoIShhY3Rpb24gaW4gYWN0aW9ucykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpbmZvID0gYWN0aXZlLmdldEluZm8oKTtcbiAgICAgICAgdmFyIHN3YXAgPSBhY3Rpb25zW1wiXCIgKyBhY3Rpb25dKCk7XG4gICAgICAgIHRoaXMuc2V0QWN0aXZlKCFzd2FwLnRvSGVhZGVyKTtcbiAgICAgICAgdGhpcy5nZXRDb250ZW50KCkubWF0cml4LmN1cnJlbnQgPSBhY3RpdmUubWF0cml4LmN1cnJlbnQ7XG4gICAgfTtcbiAgICBGb2N1c1N0cmF0ZWd5LnByb3RvdHlwZS5pbnRlcm5hbENlbGxGb2N1cyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghKGUuYnlLZXkgJiYgZS5jb250YWluZXIuaXNDb250ZW50ICYmICgoZS5rZXlBcmdzLmFjdGlvbiA9PT0gJ2VudGVyJyAmJiBlLnBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZGV0YWlsY2VsbCcpKSB8fFxuICAgICAgICAgICAgKChlLmtleUFyZ3MuYWN0aW9uID09PSAndGFiJyB8fCBlLmtleUFyZ3MuYWN0aW9uID09PSAnc2hpZnRUYWInKSAmJiBlLnBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtdW5ib3VuZGNlbGwnKSkpKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xlYXJJbmRpY2F0b3IoKTtcbiAgICAgICAgdmFyIGZvY3VzRWxlO1xuICAgICAgICBpZiAoZS5wYXJlbnQgJiYgZS5wYXJlbnQuY2xvc2VzdCgnLmUtdW5ib3VuZGNlbGwnKSAmJiBlLmtleUFyZ3MuYWN0aW9uID09PSAnc2hpZnRUYWInKSB7XG4gICAgICAgICAgICBmb2N1c0VsZSA9IHRoaXMuY29tbWFuZENvbHVtbkZvY3VzRWxlbWVudChlLnBhcmVudCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb2N1c0VsZSA9IHRoaXMuZ2V0Q29udGVudCgpLmdldEZvY3VzYWJsZSh0aGlzLmdldEZvY3VzZWRFbGVtZW50KCkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0Rm9jdXNlZEVsZW1lbnQoZm9jdXNFbGUpO1xuICAgICAgICB0aGlzLmN1cnJlbnRJbmZvLnNraXBBY3Rpb24gPSB0cnVlO1xuICAgIH07XG4gICAgRm9jdXNTdHJhdGVneS5wcm90b3R5cGUuY29tbWFuZENvbHVtbkZvY3VzRWxlbWVudCA9IGZ1bmN0aW9uIChjZWxsLCBpc0xhc3QpIHtcbiAgICAgICAgdmFyIGNvbW1hbmRCdXR0b25zID0gY2VsbC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b246bm90KC5lLWhpZGUpJyk7XG4gICAgICAgIHJldHVybiBpc0xhc3QgPyBjb21tYW5kQnV0dG9uc1tjb21tYW5kQnV0dG9ucy5sZW5ndGggLSAxXSA6IGNvbW1hbmRCdXR0b25zWzBdO1xuICAgIH07XG4gICAgcmV0dXJuIEZvY3VzU3RyYXRlZ3k7XG59KCkpO1xuZXhwb3J0IHsgRm9jdXNTdHJhdGVneSB9O1xuLyoqXG4gKiBDcmVhdGUgbWF0cml4IGZyb20gcm93IGNvbGxlY3Rpb24gd2hpY2ggYWN0IGFzIG1lbnRhbCBtb2RlbCBmb3IgY2VsbCBuYXZpZ2F0aW9uXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgTWF0cml4ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1hdHJpeCgpIHtcbiAgICAgICAgdGhpcy5tYXRyaXggPSBbXTtcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gW107XG4gICAgfVxuICAgIE1hdHJpeC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjb2x1bW5JbmRleCwgYWxsb3cpIHtcbiAgICAgICAgcm93SW5kZXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihyb3dJbmRleCwgdGhpcy5yb3dzKSk7XG4gICAgICAgIGNvbHVtbkluZGV4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oY29sdW1uSW5kZXgsIHRoaXMuY29sdW1ucykpO1xuICAgICAgICB0aGlzLm1hdHJpeFtwYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldID0gdGhpcy5tYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXSB8fCBbXTtcbiAgICAgICAgdGhpcy5tYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXVtwYXJzZUludChjb2x1bW5JbmRleC50b1N0cmluZygpLCAxMCldID0gYWxsb3cgPyAxIDogMDtcbiAgICB9O1xuICAgIE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjb2x1bW5JbmRleCwgbmF2aWdhdG9yLCBhY3Rpb24sIHZhbGlkYXRvciwgYWN0aXZlKSB7XG4gICAgICAgIHZhciB0bXAgPSBjb2x1bW5JbmRleDtcbiAgICAgICAgaWYgKHJvd0luZGV4ICsgbmF2aWdhdG9yWzBdIDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuIFtyb3dJbmRleCwgY29sdW1uSW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIHJvd0luZGV4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4ocm93SW5kZXggKyBuYXZpZ2F0b3JbMF0sIHRoaXMucm93cykpO1xuICAgICAgICB2YXIgZW1wdHlUYWJsZSA9IHRydWU7XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZCh0aGlzLm1hdHJpeFtwYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29sdW1uSW5kZXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihjb2x1bW5JbmRleCArIG5hdmlnYXRvclsxXSwgdGhpcy5tYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXS5sZW5ndGggLSAxKSk7XG4gICAgICAgIGlmICh0bXAgKyBuYXZpZ2F0b3JbMV0gPiB0aGlzLm1hdHJpeFtwYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICYmIHZhbGlkYXRvcihyb3dJbmRleCwgY29sdW1uSW5kZXgsIGFjdGlvbikpIHtcbiAgICAgICAgICAgIHJldHVybiBbcm93SW5kZXgsIHRtcF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpcnN0ID0gdGhpcy5maXJzdCh0aGlzLm1hdHJpeFtwYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLCBjb2x1bW5JbmRleCwgbmF2aWdhdG9yLCB0cnVlLCBhY3Rpb24pO1xuICAgICAgICBjb2x1bW5JbmRleCA9IGZpcnN0ID09PSBudWxsID8gdG1wIDogZmlyc3Q7XG4gICAgICAgIHZhciB2YWwgPSBnZXRWYWx1ZShyb3dJbmRleCArIFwiLlwiICsgY29sdW1uSW5kZXgsIHRoaXMubWF0cml4KTtcbiAgICAgICAgaWYgKHJvd0luZGV4ID09PSB0aGlzLnJvd3MgJiYgKGFjdGlvbiA9PT0gJ2Rvd25BcnJvdycgfHwgYWN0aW9uID09PSAnZW50ZXInKSkge1xuICAgICAgICAgICAgbmF2aWdhdG9yWzBdID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNlbGw7XG4gICAgICAgIGlmIChhY3RpdmUpIHtcbiAgICAgICAgICAgIHZhciByb3dzID0gdGhpcy5nZXRSb3dzRnJvbUluZGV4KHJvd0luZGV4LCBhY3RpdmUpO1xuICAgICAgICAgICAgY2VsbCA9IGdldFZhbHVlKHJvd0luZGV4ICsgXCIuY2VsbHMuXCIgKyBjb2x1bW5JbmRleCwgcm93cyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlbGwgJiYgY2VsbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCA9PT0gMCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzLm5leHRWaXNpYmxlQ2VsbEZvY3VzKHJvd0luZGV4LCBjb2x1bW5JbmRleCwgYWN0aW9uLCBuYXZpZ2F0b3IsIGFjdGl2ZSwgdG1wKTtcbiAgICAgICAgICAgIHJvd0luZGV4ID0gY3VycmVudFswXTtcbiAgICAgICAgICAgIGNvbHVtbkluZGV4ID0gY3VycmVudFsxXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlyc3QgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5yb3dzOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tYXRyaXhbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnNvbWUoZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHYgPT09IDE7IH0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGVtcHR5VGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVtcHR5VGFibGUpIHtcbiAgICAgICAgICAgICAgICByb3dJbmRleCA9IHRoaXMuY3VycmVudC5sZW5ndGggPyB0aGlzLmN1cnJlbnRbMF0gOiAwO1xuICAgICAgICAgICAgICAgIHJldHVybiBbcm93SW5kZXgsIGNvbHVtbkluZGV4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5pblZhbGlkKHZhbCkgfHwgIXZhbGlkYXRvcihyb3dJbmRleCwgY29sdW1uSW5kZXgsIGFjdGlvbikgP1xuICAgICAgICAgICAgdGhpcy5nZXQocm93SW5kZXgsIHRtcCwgbmF2aWdhdG9yLCBhY3Rpb24sIHZhbGlkYXRvcikgOiBbcm93SW5kZXgsIGNvbHVtbkluZGV4XTtcbiAgICB9O1xuICAgIE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93c0Zyb21JbmRleCA9IGZ1bmN0aW9uIChyb3dJbmRleCwgYWN0aXZlKSB7XG4gICAgICAgIHJldHVybiBhY3RpdmUuZ2V0VGFibGUoKS5yb3dzW3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWFkZGVkcm93JykgP1xuICAgICAgICAgICAgYWN0aXZlLmdldFRhYmxlKCkucm93c1twYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLnF1ZXJ5U2VsZWN0b3IoJ3RhYmxlJykucm93cyA6IGFjdGl2ZS5nZXRUYWJsZSgpLnJvd3M7XG4gICAgfTtcbiAgICBNYXRyaXgucHJvdG90eXBlLm5leHRWaXNpYmxlQ2VsbEZvY3VzID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjb2x1bW5JbmRleCwgYWN0aW9uLCBuYXZpZ2F0b3IsIGFjdGl2ZSwgdG1wKSB7XG4gICAgICAgIHZhciByb3dzID0gdGhpcy5nZXRSb3dzRnJvbUluZGV4KHJvd0luZGV4LCBhY3RpdmUpO1xuICAgICAgICB2YXIgY2VsbCA9IGdldFZhbHVlKHJvd0luZGV4ICsgXCIuY2VsbHMuXCIgKyBjb2x1bW5JbmRleCwgcm93cyk7XG4gICAgICAgIHZhciByb3dNYXRyaXggPSBhY3RpdmUubWF0cml4Lm1hdHJpeDtcbiAgICAgICAgdmFyIG1heFJvdyA9IHJvd01hdHJpeC5sZW5ndGggLSAxO1xuICAgICAgICB2YXIgaXNUYWIgPSBhY3Rpb24gPT09ICd0YWInO1xuICAgICAgICB2YXIgaXNTaGlmdFRhYiA9IGFjdGlvbiA9PT0gJ3NoaWZ0VGFiJztcbiAgICAgICAgdmFyIHNraXBBY3Rpb24gPSBhY3Rpb24gPT09ICdlbnRlcicgfHwgYWN0aW9uID09PSAnc2hpZnRFbnRlcicgfHwgYWN0aW9uID09PSAnZG93bkFycm93JyB8fCBhY3Rpb24gPT09ICd1cEFycm93JztcbiAgICAgICAgaWYgKHNraXBBY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBbcm93SW5kZXgsIGNvbHVtbkluZGV4XTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoY2VsbCAmJiBjZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoID09PSAwKSB7XG4gICAgICAgICAgICBpZiAoKGlzVGFiICYmIHJvd0luZGV4ID09PSBtYXhSb3cgJiYgY29sdW1uSW5kZXggPT09IHJvd01hdHJpeFtwYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLmxhc3RJbmRleE9mKDEpKSB8fFxuICAgICAgICAgICAgICAgIChpc1NoaWZ0VGFiICYmIHJvd0luZGV4ID09PSAwICYmIGNvbHVtbkluZGV4ID09PSByb3dNYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXS5pbmRleE9mKDEpKSkge1xuICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4ID0gdG1wO1xuICAgICAgICAgICAgICAgIHJldHVybiBbcm93SW5kZXgsIGNvbHVtbkluZGV4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc1RhYikge1xuICAgICAgICAgICAgICAgIGlmIChjb2x1bW5JbmRleCA9PT0gcm93TWF0cml4W3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0ubGFzdEluZGV4T2YoMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93SW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uSW5kZXggPSByb3dNYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXS5pbmRleE9mKDEpO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5JbmRleCA9IHRoaXMuZmlyc3QodGhpcy5tYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXSwgY29sdW1uSW5kZXgsIG5hdmlnYXRvciwgdHJ1ZSwgYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcm93cyA9IHRoaXMuZ2V0Um93c0Zyb21JbmRleChyb3dJbmRleCwgYWN0aXZlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4ID0gdGhpcy5maXJzdCh0aGlzLm1hdHJpeFtwYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLCBjb2x1bW5JbmRleCwgbmF2aWdhdG9yLCB0cnVlLCBhY3Rpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzU2hpZnRUYWIpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29sdW1uSW5kZXggPT09IHJvd01hdHJpeFtwYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLmluZGV4T2YoMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93SW5kZXgtLTtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uSW5kZXggPSByb3dNYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXS5sYXN0SW5kZXhPZigxKTtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uSW5kZXggPSB0aGlzLmZpcnN0KHRoaXMubWF0cml4W3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0sIGNvbHVtbkluZGV4LCBuYXZpZ2F0b3IsIHRydWUsIGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHJvd3MgPSB0aGlzLmdldFJvd3NGcm9tSW5kZXgocm93SW5kZXgsIGFjdGl2ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5JbmRleC0tO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5JbmRleCA9IHRoaXMuZmlyc3QodGhpcy5tYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXSwgY29sdW1uSW5kZXgsIG5hdmlnYXRvciwgdHJ1ZSwgYWN0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICgoYWN0aW9uID09PSAncmlnaHRBcnJvdycgfHwgYWN0aW9uID09PSAnc2hpZnRSaWdodCcpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbkluZGV4ID09PSByb3dNYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXS5sYXN0SW5kZXhPZigxKSkge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5JbmRleCA9IHRtcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4ID0gdGhpcy5maXJzdCh0aGlzLm1hdHJpeFtwYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLCBjb2x1bW5JbmRleCwgbmF2aWdhdG9yLCB0cnVlLCBhY3Rpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKChhY3Rpb24gPT09ICdsZWZ0QXJyb3cnIHx8IGFjdGlvbiA9PT0gJ3NoaWZ0TGVmdCcpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbkluZGV4ID09PSByb3dNYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXS5pbmRleE9mKDEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4ID0gdG1wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uSW5kZXgtLTtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uSW5kZXggPSB0aGlzLmZpcnN0KHRoaXMubWF0cml4W3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0sIGNvbHVtbkluZGV4LCBuYXZpZ2F0b3IsIHRydWUsIGFjdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYWN0aW9uID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uSW5kZXgrKztcbiAgICAgICAgICAgICAgICBjb2x1bW5JbmRleCA9IHRoaXMuZmlyc3QodGhpcy5tYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXSwgY29sdW1uSW5kZXgsIG5hdmlnYXRvciwgdHJ1ZSwgYWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNlbGwgPSBnZXRWYWx1ZShyb3dJbmRleCArIFwiLmNlbGxzLlwiICsgY29sdW1uSW5kZXgsIHJvd3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbcm93SW5kZXgsIGNvbHVtbkluZGV4XTtcbiAgICB9O1xuICAgIE1hdHJpeC5wcm90b3R5cGUuZmlyc3QgPSBmdW5jdGlvbiAodmVjdG9yLCBpbmRleCwgbmF2aWdhdG9yLCBtb3ZlVG8sIGFjdGlvbikge1xuICAgICAgICBpZiAoKChpbmRleCA8IDAgfHwgaW5kZXggPT09IHZlY3Rvci5sZW5ndGgpICYmIHRoaXMuaW5WYWxpZCh2ZWN0b3JbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXSlcbiAgICAgICAgICAgICYmIChhY3Rpb24gIT09ICd1cEFycm93JyAmJiBhY3Rpb24gIT09ICdkb3duQXJyb3cnKSkgfHwgIXZlY3Rvci5zb21lKGZ1bmN0aW9uICh2KSB7IHJldHVybiB2ID09PSAxOyB9KSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICF0aGlzLmluVmFsaWQodmVjdG9yW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0pID8gaW5kZXggOlxuICAgICAgICAgICAgdGhpcy5maXJzdCh2ZWN0b3IsIChbJ3VwQXJyb3cnLCAnZG93bkFycm93JywgJ3NoaWZ0VXAnLCAnc2hpZnREb3duJywgJ2VudGVyJywgJ3NoaWZ0RW50ZXInXS5pbmRleE9mKGFjdGlvbikgIT09IC0xKSA/IG1vdmVUbyA/IDAgOiArK2luZGV4IDpcbiAgICAgICAgICAgICAgICBpbmRleCArIG5hdmlnYXRvclsxXSwgbmF2aWdhdG9yLCBmYWxzZSwgYWN0aW9uKTtcbiAgICB9O1xuICAgIE1hdHJpeC5wcm90b3R5cGUuc2VsZWN0ID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjb2x1bW5JbmRleCkge1xuICAgICAgICByb3dJbmRleCA9IE1hdGgubWF4KDAsIE1hdGgubWluKHJvd0luZGV4LCB0aGlzLnJvd3MpKTtcbiAgICAgICAgY29sdW1uSW5kZXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihjb2x1bW5JbmRleCwgdGhpcy5tYXRyaXhbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXS5sZW5ndGggLSAxKSk7XG4gICAgICAgIHRoaXMuY3VycmVudCA9IFtyb3dJbmRleCwgY29sdW1uSW5kZXhdO1xuICAgIH07XG4gICAgTWF0cml4LnByb3RvdHlwZS5nZW5lcmF0ZSA9IGZ1bmN0aW9uIChyb3dzLCBzZWxlY3RvciwgaXNSb3dUZW1wbGF0ZSkge1xuICAgICAgICB0aGlzLnJvd3MgPSByb3dzLmxlbmd0aCAtIDE7XG4gICAgICAgIHRoaXMubWF0cml4ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNlbGxzID0gcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbHMuZmlsdGVyKGZ1bmN0aW9uIChjKSB7IHJldHVybiBjLmlzU3Bhbm5lZCAhPT0gdHJ1ZTsgfSk7XG4gICAgICAgICAgICB0aGlzLmNvbHVtbnMgPSBNYXRoLm1heChjZWxscy5sZW5ndGggLSAxLCB0aGlzLmNvbHVtbnMgfCAwKTtcbiAgICAgICAgICAgIHZhciBpbmNyZW1lbnROdW1iZXIgPSAwO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjZWxscy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGlmIChjZWxsc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uY29sdW1uICYmIGNlbGxzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXS5jb2x1bW4uY29sdW1ucykge1xuICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnROdW1iZXIgPSB0aGlzLmNvbHVtbnNDb3VudChjZWxsc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0uY29sdW1uLmNvbHVtbnMsIGluY3JlbWVudE51bWJlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnROdW1iZXIrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoaSwgaiwgcm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSA9PT0gZmFsc2UgP1xuICAgICAgICAgICAgICAgICAgICBmYWxzZSA6IHNlbGVjdG9yKHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBjZWxsc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0sIGlzUm93VGVtcGxhdGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29sdW1ucyA9IE1hdGgubWF4KGluY3JlbWVudE51bWJlciAtIDEsIHRoaXMuY29sdW1ucyB8IDApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm1hdHJpeDtcbiAgICB9O1xuICAgIE1hdHJpeC5wcm90b3R5cGUuY29sdW1uc0NvdW50ID0gZnVuY3Rpb24gKHJvd0NvbHVtbnMsIGN1cnJlbnRDb2x1bW5Db3VudCkge1xuICAgICAgICB2YXIgY29sdW1ucyA9IHJvd0NvbHVtbnM7XG4gICAgICAgIHZhciBpbmNyZW1lbnROdW1iZXIgPSBjdXJyZW50Q29sdW1uQ291bnQ7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICBpbmNyZW1lbnROdW1iZXIgPSB0aGlzLmNvbHVtbnNDb3VudChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zLCBpbmNyZW1lbnROdW1iZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5jcmVtZW50TnVtYmVyKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluY3JlbWVudE51bWJlcjtcbiAgICB9O1xuICAgIE1hdHJpeC5wcm90b3R5cGUuaW5WYWxpZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgPT09IDAgfHwgdmFsdWUgPT09IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIHJldHVybiBNYXRyaXg7XG59KCkpO1xuZXhwb3J0IHsgTWF0cml4IH07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xudmFyIENvbnRlbnRGb2N1cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb250ZW50Rm9jdXMocGFyZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMubWF0cml4ID0gbmV3IE1hdHJpeCgpO1xuICAgICAgICB0aGlzLmxhc3RJZHhDZWxsID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLmtleUFjdGlvbnMgPSB7XG4gICAgICAgICAgICAncmlnaHRBcnJvdyc6IFswLCAxXSxcbiAgICAgICAgICAgICd0YWInOiBbMCwgMV0sXG4gICAgICAgICAgICAnbGVmdEFycm93JzogWzAsIC0xXSxcbiAgICAgICAgICAgICdzaGlmdFRhYic6IFswLCAtMV0sXG4gICAgICAgICAgICAndXBBcnJvdyc6IFstMSwgMF0sXG4gICAgICAgICAgICAnZG93bkFycm93JzogWzEsIDBdLFxuICAgICAgICAgICAgJ3NoaWZ0VXAnOiBbLTEsIDBdLFxuICAgICAgICAgICAgJ3NoaWZ0RG93bic6IFsxLCAwXSxcbiAgICAgICAgICAgICdzaGlmdFJpZ2h0JzogWzAsIDFdLFxuICAgICAgICAgICAgJ3NoaWZ0TGVmdCc6IFswLCAtMV0sXG4gICAgICAgICAgICAnZW50ZXInOiBbMSwgMF0sXG4gICAgICAgICAgICAnc2hpZnRFbnRlcic6IFstMSwgMF1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5pbmRleGVzQnlLZXkgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgICAgICB2YXIgb3B0ID0ge1xuICAgICAgICAgICAgICAgICdob21lJzogW190aGlzLm1hdHJpeC5jdXJyZW50WzBdLCAtMSwgMCwgMV0sXG4gICAgICAgICAgICAgICAgJ2VuZCc6IFtfdGhpcy5tYXRyaXguY3VycmVudFswXSwgX3RoaXMubWF0cml4LmNvbHVtbnMgKyAxLCAwLCAtMV0sXG4gICAgICAgICAgICAgICAgJ2N0cmxIb21lJzogWzAsIC0xLCAwLCAxXSxcbiAgICAgICAgICAgICAgICAnY3RybEVuZCc6IFtfdGhpcy5tYXRyaXgucm93cywgX3RoaXMubWF0cml4LmNvbHVtbnMgKyAxLCAwLCAtMV1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gb3B0W1wiXCIgKyBhY3Rpb25dIHx8IG51bGw7XG4gICAgICAgIH07XG4gICAgfVxuICAgIENvbnRlbnRGb2N1cy5wcm90b3R5cGUuZ2V0VGFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5wYXJlbnQuZ2V0Q29udGVudFRhYmxlKCkpO1xuICAgIH07XG4gICAgQ29udGVudEZvY3VzLnByb3RvdHlwZS5vbktleVByZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIGlzTWFjTGlrZSA9IC8oTWFjKS9pLnRlc3QobmF2aWdhdG9yLnBsYXRmb3JtKTtcbiAgICAgICAgaWYgKGlzTWFjTGlrZSAmJiBlLm1ldGFLZXkpIHtcbiAgICAgICAgICAgIGlmIChlLmFjdGlvbiA9PT0gJ2hvbWUnKSB7XG4gICAgICAgICAgICAgICAgZS5hY3Rpb24gPSAnY3RybEhvbWUnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZS5hY3Rpb24gPT09ICdlbmQnKSB7XG4gICAgICAgICAgICAgICAgZS5hY3Rpb24gPSAnY3RybEVuZCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChbJ2Rvd25BcnJvdycsICd1cEFycm93JywgJ2xlZnRBcnJvdycsICdyaWdodEFycm93J10uaW5kZXhPZihlLmFjdGlvbikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBuYXZpZ2F0b3JzID0gdGhpcy5rZXlBY3Rpb25zW2UuYWN0aW9uXTtcbiAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzLmdldEN1cnJlbnRGcm9tQWN0aW9uKGUuYWN0aW9uLCBuYXZpZ2F0b3JzLCBlLmFjdGlvbiBpbiB0aGlzLmtleUFjdGlvbnMsIGUpO1xuICAgICAgICBpZiAoIWN1cnJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKChbJ3RhYicsICdzaGlmdFRhYiddLmluZGV4T2YoZS5hY3Rpb24pID4gLTEgJiYgdGhpcy5tYXRyaXguY3VycmVudCB8fCBbXSkudG9TdHJpbmcoKSA9PT0gY3VycmVudC50b1N0cmluZygpKVxuICAgICAgICAgICAgfHwgKHRoaXMucGFyZW50LmFsbG93UGFnaW5nICYmICF0aGlzLnBhcmVudC5wYWdlck1vZHVsZS5wYWdlck9iai5jaGVja1BhZ2VySGFzRm9jdXMoKVxuICAgICAgICAgICAgICAgICYmIHRoaXMubWF0cml4LmN1cnJlbnRbMF0gPT09IHRoaXMubWF0cml4LnJvd3MgJiYgKCh0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3MubW9kZSA9PT0gJ0JhdGNoJ1xuICAgICAgICAgICAgICAgICYmIHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5hbGxvd0FkZGluZyAmJiBlLmtleUNvZGUgPT09IDQwKSB8fCAoZS5rZXlDb2RlID09PSA0MCkpKSkge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnQudG9TdHJpbmcoKSA9PT0gW3RoaXMubWF0cml4LnJvd3MsIHRoaXMubWF0cml4LmNvbHVtbnNdLnRvU3RyaW5nKCkgfHxcbiAgICAgICAgICAgICAgICBjdXJyZW50LnRvU3RyaW5nKCkgPT09IFswLCAwXS50b1N0cmluZygpIHx8ICh0aGlzLm1hdHJpeC5jdXJyZW50WzBdID09PSB0aGlzLm1hdHJpeC5yb3dzICYmXG4gICAgICAgICAgICAgICAgdGhpcy5tYXRyaXguY3VycmVudC50b1N0cmluZygpID09PSBjdXJyZW50LnRvU3RyaW5nKCkpIHx8ICh0aGlzLnBhcmVudC5hbGxvd0dyb3VwaW5nICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuaW5maW5pdGVTY3JvbGxTZXR0aW5ncy5lbmFibGVDYWNoZSAmJiBjdXJyZW50LnRvU3RyaW5nKCkgPT09IFswLCAxXS50b1N0cmluZygpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSB0aGlzLmVkaXROZXh0Um93KGN1cnJlbnRbMF0sIGN1cnJlbnRbMV0sIGUuYWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1hdHJpeC5zZWxlY3QoY3VycmVudFswXSwgY3VycmVudFsxXSk7XG4gICAgfTtcbiAgICBDb250ZW50Rm9jdXMucHJvdG90eXBlLmVkaXROZXh0Um93ID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjZWxsSW5kZXgsIGFjdGlvbikge1xuICAgICAgICB2YXIgZ09iaiA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgZWRpdE5leHRSb3cgPSBnT2JqLmVkaXRTZXR0aW5ncy5hbGxvd05leHRSb3dFZGl0ICYmIChnT2JqLmlzRWRpdCB8fCBnT2JqLmlzTGFzdENlbGxQcmltYXJ5S2V5KTtcbiAgICAgICAgdmFyIHZpc2libGVJbmRleCA9IGdPYmouZ2V0Q29sdW1uSW5kZXhCeUZpZWxkKGdPYmouZ2V0VmlzaWJsZUNvbHVtbnMoKVswXS5maWVsZCk7XG4gICAgICAgIHZhciByb3cgPSB0aGlzLmdldFRhYmxlKCkucm93c1twYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldO1xuICAgICAgICB2YXIgY2VsbCA9IGdPYmouZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cgJiYgcm93LmNsYXNzTGlzdC5jb250YWlucygnZS1hZGRlZHJvdycpID9cbiAgICAgICAgICAgIChyb3cucXVlcnlTZWxlY3RvckFsbCgndGQ6bm90KC5lLWVkaXRjZWxsKScpKVtwYXJzZUludChjZWxsSW5kZXgudG9TdHJpbmcoKSwgMTApXVxuICAgICAgICAgICAgOiByb3cuY2VsbHNbcGFyc2VJbnQoY2VsbEluZGV4LnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgIGlmIChhY3Rpb24gPT09ICd0YWInICYmIGVkaXROZXh0Um93KSB7XG4gICAgICAgICAgICByb3dJbmRleCsrO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gKHRoaXMuZ2V0VGFibGUoKS5yb3dzW3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZS1pbmRlbnRjZWxsJykubGVuZ3RoICtcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRhYmxlKCkucm93c1twYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2UtZGV0YWlscm93Y29sbGFwc2UnKS5sZW5ndGgpO1xuICAgICAgICAgICAgY2VsbEluZGV4ID0gdmlzaWJsZUluZGV4ICsgaW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ3NoaWZ0VGFiJyAmJiBlZGl0TmV4dFJvdykge1xuICAgICAgICAgICAgcm93SW5kZXgtLTtcbiAgICAgICAgICAgIGNlbGxJbmRleCA9IGdPYmouZ2V0Q29sdW1uSW5kZXhCeUZpZWxkKGdPYmouZ2V0VmlzaWJsZUNvbHVtbnMoKVtnT2JqLmdldFZpc2libGVDb2x1bW5zKCkubGVuZ3RoIC0gMV0uZmllbGQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhY2VsbC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMucm93Q2VsbCkgJiYgIWNlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWhlYWRlcmNlbGwnKSAmJlxuICAgICAgICAgICAgIWNlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWdyb3VwY2FwdGlvbicpICYmICFjZWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1maWx0ZXJiYXJjZWxsJykgP1xuICAgICAgICAgICAgdGhpcy5lZGl0TmV4dFJvdyhyb3dJbmRleCwgY2VsbEluZGV4LCBhY3Rpb24pIDogW3Jvd0luZGV4LCBjZWxsSW5kZXhdO1xuICAgIH07XG4gICAgQ29udGVudEZvY3VzLnByb3RvdHlwZS5nZXRDdXJyZW50RnJvbUFjdGlvbiA9IGZ1bmN0aW9uIChhY3Rpb24sIG5hdmlnYXRvciwgaXNQcmVzZW50LCBlKSB7XG4gICAgICAgIGlmIChuYXZpZ2F0b3IgPT09IHZvaWQgMCkgeyBuYXZpZ2F0b3IgPSBbMCwgMF07IH1cbiAgICAgICAgaWYgKCFpc1ByZXNlbnQgJiYgIXRoaXMuaW5kZXhlc0J5S2V5KGFjdGlvbikgfHwgKHRoaXMubWF0cml4LmN1cnJlbnQubGVuZ3RoID09PSAwKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnNob3VsZEZvY3VzQ2hhbmdlKGUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXguY3VycmVudDtcbiAgICAgICAgfVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgdmFyIF9hID0gdGhpcy5pbmRleGVzQnlLZXkoYWN0aW9uKSB8fCB0aGlzLm1hdHJpeC5jdXJyZW50LmNvbmNhdChuYXZpZ2F0b3IpLCByb3dJbmRleCA9IF9hWzBdLCBjZWxsSW5kZXggPSBfYVsxXSwgck4gPSBfYVsyXSwgY04gPSBfYVszXTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93R3JvdXBpbmcgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucykgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAmJiB0aGlzLnBhcmVudC5hZ2dyZWdhdGVzLmxlbmd0aCAmJiBhY3Rpb24gPT09ICdlbnRlcicpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSByb3dJbmRleDsgaSA8IHRoaXMubWF0cml4Lm1hdHJpeC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciByb3cgPSB0aGlzLmdldFRhYmxlKCkucm93c1tpICsgMV07XG4gICAgICAgICAgICAgICAgaWYgKHJvdyAmJiByb3cuY2VsbHNbcGFyc2VJbnQoY2VsbEluZGV4LnRvU3RyaW5nKCksIDEwKV0gJiYgcm93LmNlbGxzW3BhcnNlSW50KGNlbGxJbmRleC50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5jb250YWlucygnZS1yb3djZWxsJykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtpICsgMSwgY2VsbEluZGV4XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IHRoaXMubWF0cml4Lm1hdHJpeC5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbcm93SW5kZXgsIGNlbGxJbmRleF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChhY3Rpb24gPT09ICdjdHJsRW5kJyB8fCBhY3Rpb24gPT09ICdlbmQnKSB7XG4gICAgICAgICAgICB2YXIgbGFzdENvbnRlbnRDZWxsSW5kZXggPSBbdGhpcy5tYXRyaXgubWF0cml4Lmxlbmd0aCAtIDEsXG4gICAgICAgICAgICAgICAgdGhpcy5tYXRyaXgubWF0cml4W3RoaXMubWF0cml4Lm1hdHJpeC5sZW5ndGggLSAxXS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdlbmQnKSB7XG4gICAgICAgICAgICAgICAgbGFzdENvbnRlbnRDZWxsSW5kZXggPSBbcm93SW5kZXgsIHRoaXMubWF0cml4Lm1hdHJpeFtwYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubWF0cml4Lm1hdHJpeFtsYXN0Q29udGVudENlbGxJbmRleFswXV1bbGFzdENvbnRlbnRDZWxsSW5kZXhbMV1dID09PSAwKSB7XG4gICAgICAgICAgICAgICAgbGFzdENvbnRlbnRDZWxsSW5kZXggPSBmaW5kQ2VsbEluZGV4KHRoaXMubWF0cml4Lm1hdHJpeCwgbGFzdENvbnRlbnRDZWxsSW5kZXgsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJvd0luZGV4ID0gbGFzdENvbnRlbnRDZWxsSW5kZXhbMF07XG4gICAgICAgICAgICBjZWxsSW5kZXggPSBsYXN0Q29udGVudENlbGxJbmRleFsxXSArIDE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzLm1hdHJpeC5nZXQocm93SW5kZXgsIGNlbGxJbmRleCwgW3JOLCBjTl0sIGFjdGlvbiwgdGhpcy52YWxpZGF0b3IoKSwgdGhpcyk7XG4gICAgICAgIHJldHVybiBjdXJyZW50O1xuICAgIH07XG4gICAgQ29udGVudEZvY3VzLnByb3RvdHlwZS5jaGVja1Jvd0NlbGxGb2N1cyA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgcmV0dXJuIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMucm93Q2VsbCkgPyB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWZvY3VzZWQnKSA6IHRydWU7XG4gICAgfTtcbiAgICBDb250ZW50Rm9jdXMucHJvdG90eXBlLm9uQ2xpY2sgPSBmdW5jdGlvbiAoZSwgZm9yY2UpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgdGFyZ2V0ID0gKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMucm93Q2VsbCkgPyB0YXJnZXQgOiBjbG9zZXN0KHRhcmdldCwgJ3RkJykpO1xuICAgICAgICB0YXJnZXQgPSB0YXJnZXQgPyB0YXJnZXQgOiBjbG9zZXN0KGUudGFyZ2V0LCAndGQuZS1kZXRhaWxyb3djb2xsYXBzZScpXG4gICAgICAgICAgICB8fCBjbG9zZXN0KGUudGFyZ2V0LCAndGQuZS1kZXRhaWxyb3dleHBhbmQnKTtcbiAgICAgICAgdGFyZ2V0ID0gY2xvc2VzdChlLnRhcmdldCwgJ3RkLmUtZGV0YWlsY2VsbCcpID9cbiAgICAgICAgICAgIGlzTnVsbE9yVW5kZWZpbmVkKGNsb3Nlc3QoY2xvc2VzdChlLnRhcmdldCwgJy5lLWdyaWQnKSwgJ3RkLmUtZGV0YWlsY2VsbCcpKSA/IG51bGwgOiB0YXJnZXQgOiB0YXJnZXQ7XG4gICAgICAgIHRhcmdldCA9IHRhcmdldCAmJiBjbG9zZXN0KHRhcmdldCwgJ3RhYmxlJykuY2xhc3NMaXN0LmNvbnRhaW5zKGxpdGVyYWxzLnRhYmxlKSA/IHRhcmdldCA6IG51bGw7XG4gICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvd0lkeCA9IHRhcmdldC5wYXJlbnRFbGVtZW50LnJvd0luZGV4O1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cgJiYgcGFyZW50c1VudGlsKHRhcmdldCwgJ2UtYWRkZWRyb3cnKSkge1xuICAgICAgICAgICAgcm93SWR4ID0gcGFyZW50c1VudGlsKHRhcmdldCwgJ2UtYWRkZWRyb3cnKS5yb3dJbmRleDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX2EgPSBbcm93SWR4LCB0YXJnZXQuY2VsbEluZGV4XSwgcm93SW5kZXggPSBfYVswXSwgY2VsbEluZGV4ID0gX2FbMV07XG4gICAgICAgIHZhciBfYiA9IHRoaXMubWF0cml4LmN1cnJlbnQsIG9Sb3dJbmRleCA9IF9iWzBdLCBvQ2VsbEluZGV4ID0gX2JbMV07XG4gICAgICAgIHZhciB2YWwgPSBnZXRWYWx1ZShyb3dJbmRleCArIFwiLlwiICsgY2VsbEluZGV4LCB0aGlzLm1hdHJpeC5tYXRyaXgpO1xuICAgICAgICBpZiAodGhpcy5tYXRyaXguaW5WYWxpZCh2YWwpIHx8ICghZm9yY2UgJiYgb1Jvd0luZGV4ID09PSByb3dJbmRleCAmJiBvQ2VsbEluZGV4ID09PSBjZWxsSW5kZXggJiYgdGhpcy5jaGVja1Jvd0NlbGxGb2N1cyh0YXJnZXQpKSB8fFxuICAgICAgICAgICAgKCFwYXJlbnRzVW50aWwoZS50YXJnZXQsIGxpdGVyYWxzLnJvd0NlbGwpICYmICFwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLWdyb3VwY2FwdGlvbicpXG4gICAgICAgICAgICAgICAgJiYgIXBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtcmVjb3JkcGx1c2NvbGxhcHNlJykgJiYgIXBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtcmVjb3JkcGx1c2V4cGFuZCcpXG4gICAgICAgICAgICAgICAgJiYgIXBhcmVudHNVbnRpbChlLnRhcmdldCwgJ2UtZGV0YWlscm93Y29sbGFwc2UnKSAmJiAhcGFyZW50c1VudGlsKGUudGFyZ2V0LCAnZS1kZXRhaWxyb3dleHBhbmQnKVxuICAgICAgICAgICAgICAgICYmICFwYXJlbnRzVW50aWwoZS50YXJnZXQsICdlLXRlbXBsYXRlY2VsbCcpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubWF0cml4LnNlbGVjdChyb3dJbmRleCwgY2VsbEluZGV4KTtcbiAgICB9O1xuICAgIENvbnRlbnRGb2N1cy5wcm90b3R5cGUuZ2V0Rm9jdXNJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW5mbyA9IHt9O1xuICAgICAgICB2YXIgX2EgPSB0aGlzLm1hdHJpeC5jdXJyZW50LCBfYiA9IF9hWzBdLCByb3dJbmRleCA9IF9iID09PSB2b2lkIDAgPyAwIDogX2IsIF9jID0gX2FbMV0sIGNlbGxJbmRleCA9IF9jID09PSB2b2lkIDAgPyAwIDogX2M7XG4gICAgICAgIHRoaXMubWF0cml4LmN1cnJlbnQgPSBbcm93SW5kZXgsIGNlbGxJbmRleF07XG4gICAgICAgIHZhciByb3cgPSB0aGlzLmdldFRhYmxlKCkucm93c1twYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldO1xuICAgICAgICBpbmZvLmVsZW1lbnQgPSAhaXNOdWxsT3JVbmRlZmluZWQocm93KSA/IHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2UtYWRkZWRyb3cnKSA/XG4gICAgICAgICAgICAocm93LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkOm5vdCguZS1lZGl0Y2VsbCknKSlbcGFyc2VJbnQoY2VsbEluZGV4LnRvU3RyaW5nKCksIDEwKV1cbiAgICAgICAgICAgIDogcm93LmNlbGxzW3BhcnNlSW50KGNlbGxJbmRleC50b1N0cmluZygpLCAxMCldIDogbnVsbDtcbiAgICAgICAgaWYgKCFpbmZvLmVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBpbmZvO1xuICAgICAgICB9XG4gICAgICAgIGluZm8uZWxlbWVudFRvRm9jdXMgPSAoIWluZm8uZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtdW5ib3VuZGNlbGwnKSB8fCAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cgJiZcbiAgICAgICAgICAgIGluZm8uZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtdW5ib3VuZGNlbGwnKSAmJiBwYXJlbnRzVW50aWwoaW5mby5lbGVtZW50LCAnZS1hZGRlZHJvdycpKSkgJiZcbiAgICAgICAgICAgICFpbmZvLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWRldGFpbGNlbGwnKSA/IHRoaXMuZ2V0Rm9jdXNhYmxlKGluZm8uZWxlbWVudCkgOiBpbmZvLmVsZW1lbnQ7XG4gICAgICAgIGluZm8uZWxlbWVudFRvRm9jdXMgPSBpbmZvLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWRldGFpbGNlbGwnKSAmJiBpbmZvLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtY2hpbGRncmlkJylcbiAgICAgICAgICAgID8gaW5mby5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLWNoaWxkZ3JpZCcpIDogaW5mby5lbGVtZW50VG9Gb2N1cztcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5tb2RlID09PSAnQmF0Y2gnICYmIHRoaXMucGFyZW50LmlzRWRpdCAmJiBpbmZvLmVsZW1lbnRUb0ZvY3VzLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0J1xuICAgICAgICAgICAgJiYgaW5mby5lbGVtZW50VG9Gb2N1cy5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZHJvcGRvd25saXN0JykpIHtcbiAgICAgICAgICAgIGluZm8uZWxlbWVudFRvRm9jdXMgPSBpbmZvLmVsZW1lbnRUb0ZvY3VzLnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaW5mby5vdXRsaW5lID0gdHJ1ZTtcbiAgICAgICAgaW5mby51aWQgPSBpbmZvLmVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdWlkJyk7XG4gICAgICAgIHJldHVybiBpbmZvO1xuICAgIH07XG4gICAgQ29udGVudEZvY3VzLnByb3RvdHlwZS5nZXRGb2N1c2FibGUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICB2YXIgcXVlcnkgPSAnYnV0dG9uLCBbaHJlZl0sIGlucHV0Om5vdChbdHlwZT1cImhpZGRlblwiXSksIHNlbGVjdCwgdGV4dGFyZWEsIFt0YWJpbmRleF06bm90KFt0YWJpbmRleD1cIi0xXCJdKSc7XG4gICAgICAgIHZhciBpc1RlbXBsYXRlID0gIWlzTnVsbE9yVW5kZWZpbmVkKGNsb3Nlc3QoZWxlbWVudCwgJy5lLXRlbXBsYXRlY2VsbCcpKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzRWRpdCkge1xuICAgICAgICAgICAgdmFyIGNvbW1hbmRDZWxsUXVlcnkgPSB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyAmJiBwYXJlbnRzVW50aWwoZWxlbWVudCwgJ2UtYWRkZWRyb3cnKSA/XG4gICAgICAgICAgICAgICAgJywgYnV0dG9uOm5vdCguZS1oaWRlKScgOiAnJztcbiAgICAgICAgICAgIHF1ZXJ5ID0gJ2lucHV0Om5vdChbdHlwZT1cImhpZGRlblwiXSksIHNlbGVjdDpub3QoW2FyaWEtaGlkZGVuPVwidHJ1ZVwiXSksIHRleHRhcmVhJyArIGNvbW1hbmRDZWxsUXVlcnk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkID0gW10uc2xpY2UuY2FsbChlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpKTtcbiAgICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWZsdHJ0ZW1wJykpIHtcbiAgICAgICAgICAgIHZhciBmb2N1c0VsZW1lbnQgPSBbXS5zbGljZS5jYWxsKGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtZmx0cnRlbXAtZm9jdXMnKSk7XG4gICAgICAgICAgICBpZiAodGhpcy5mb2N1c1R5cGUgPT09ICdjbGljaycgJiYgdGhpcy50YXJnZXQgJiYgdGhpcy50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWZsdHJ0ZW1wLWZvY3VzJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50YXJnZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmZvY3VzVHlwZSA9PT0gJ2tleScgJiYgZm9jdXNFbGVtZW50Lmxlbmd0aCAmJiAodGhpcy5hY3Rpb24gPT09ICd0YWInIHx8IHRoaXMuYWN0aW9uID09PSAnc2hpZnRUYWInKSkge1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50SW5kZXggPSBmb2N1c0VsZW1lbnQuaW5kZXhPZih0aGlzLmN1cnJlbnRUYXJnZXQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50SW5kZXggPT09IC0xID8gZm9jdXNFbGVtZW50W3RoaXMuYWN0aW9uID09PSAndGFiJyA/IDAgOiBmb2N1c0VsZW1lbnQubGVuZ3RoIC0gMV1cbiAgICAgICAgICAgICAgICAgICAgOiBmb2N1c0VsZW1lbnRbdGhpcy5hY3Rpb24gPT09ICd0YWInID8gZWxlbWVudEluZGV4ICsgMSA6IGVsZW1lbnRJbmRleCAtIDFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIFNlbGVjdCB0aGUgZmlyc3QgZm9jdXNhYmxlIGNoaWxkIGVsZW1lbnRcbiAgICAgICAgICogaWYgbm8gY2hpbGQgZm91bmQgdGhlbiBzZWxlY3QgdGhlIGNlbGwgaXRzZWxmLlxuICAgICAgICAgKiBpZiBHcmlkIGlzIGluIGVkaXRhYmxlIHN0YXRlLCBjaGVjayBmb3IgZWRpdGFibGUgY29udHJvbCBpbnNpZGUgY2hpbGQuXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gY2hpbGQubGVuZ3RoID8gaXNUZW1wbGF0ZSAmJiBjaGlsZC5sZW5ndGggPiAxICYmICEodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLm1vZGUgPT09ICdCYXRjaCdcbiAgICAgICAgICAgICYmIHRoaXMucGFyZW50LmlzRWRpdCAmJiB0aGlzLnRhcmdldCkgPyB0aGlzLnRhcmdldCA/IHRoaXMudGFyZ2V0IDogZWxlbWVudCA6IGNoaWxkWzBdIDogZWxlbWVudDtcbiAgICB9O1xuICAgIENvbnRlbnRGb2N1cy5wcm90b3R5cGUuc2VsZWN0b3IgPSBmdW5jdGlvbiAocm93LCBjZWxsLCBpc1Jvd1RlbXBsYXRlKSB7XG4gICAgICAgIHZhciB0eXBlcyA9IFtDZWxsVHlwZS5FeHBhbmQsIENlbGxUeXBlLkdyb3VwQ2FwdGlvbiwgQ2VsbFR5cGUuQ2FwdGlvblN1bW1hcnksIENlbGxUeXBlLkdyb3VwU3VtbWFyeV07XG4gICAgICAgIHJldHVybiAoKHJvdy5pc0RhdGFSb3cgJiYgY2VsbC52aXNpYmxlICYmIChjZWxsLmlzRGF0YUNlbGwgfHwgY2VsbC5pc1RlbXBsYXRlKSlcbiAgICAgICAgICAgIHx8IChyb3cuaXNEYXRhUm93ICYmIGNlbGwuY2VsbFR5cGUgPT09IENlbGxUeXBlLkRldGFpbEV4cGFuZCAmJiBpc051bGxPclVuZGVmaW5lZChjZWxsLnZpc2libGUpKVxuICAgICAgICAgICAgfHwgKCFyb3cuaXNEYXRhUm93ICYmIHR5cGVzLmluZGV4T2YoY2VsbC5jZWxsVHlwZSkgPiAtMVxuICAgICAgICAgICAgICAgICYmICEoKGNlbGwuY2VsbFR5cGUgPT09IENlbGxUeXBlLkdyb3VwU3VtbWFyeSB8fCBjZWxsLmNlbGxUeXBlID09PSBDZWxsVHlwZS5DYXB0aW9uU3VtbWFyeSlcbiAgICAgICAgICAgICAgICAgICAgJiYgIShjZWxsLmlzRGF0YUNlbGwgJiYgY2VsbC52aXNpYmxlKSkpXG4gICAgICAgICAgICB8fCAoY2VsbC5jb2x1bW4gJiYgY2VsbC52aXNpYmxlICYmIGNlbGwuY29sdW1uLnR5cGUgPT09ICdjaGVja2JveCcpXG4gICAgICAgICAgICB8fCAoY2VsbC5jZWxsVHlwZSA9PT0gQ2VsbFR5cGUuQ29tbWFuZENvbHVtbilcbiAgICAgICAgICAgIHx8IChyb3cuaXNEYXRhUm93ICYmIGlzUm93VGVtcGxhdGUpKVxuICAgICAgICAgICAgJiYgIShyb3cuZWRpdCA9PT0gJ2RlbGV0ZScgJiYgcm93LmlzRGlydHkpO1xuICAgIH07XG4gICAgQ29udGVudEZvY3VzLnByb3RvdHlwZS5uZXh0Um93Rm9jdXNWYWxpZGF0ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgbGFzdEluZGV4ID0gaW5kZXg7XG4gICAgICAgIGZvciAodmFyIGkgPSBpbmRleCwgbGVuID0gdGhpcy5tYXRyaXgucm93czsgaSA8PSBsZW47IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMubWF0cml4Lm1hdHJpeFtwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldLmluZGV4T2YoMSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleCArIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYXN0SWR4Q2VsbCA9IHRydWU7XG4gICAgICAgIHJldHVybiBsYXN0SW5kZXg7XG4gICAgfTtcbiAgICBDb250ZW50Rm9jdXMucHJvdG90eXBlLnByZXZpb3VzUm93Rm9jdXNWYWxpZGF0ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgZmlyc3RJbmRleCA9IGluZGV4O1xuICAgICAgICBmb3IgKHZhciBpID0gaW5kZXgsIGxlbiA9IDA7IGkgPj0gbGVuOyBpLS0pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm1hdHJpeC5tYXRyaXhbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS5pbmRleE9mKDEpID09PSAtMSkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaW5kZXggLSAxO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0SWR4Q2VsbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaXJzdEluZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlyc3RJbmRleDtcbiAgICB9O1xuICAgIENvbnRlbnRGb2N1cy5wcm90b3R5cGUuanVtcCA9IGZ1bmN0aW9uIChhY3Rpb24sIGN1cnJlbnQpIHtcbiAgICAgICAgdGhpcy5sYXN0SWR4Q2VsbCA9IGZhbHNlO1xuICAgICAgICB2YXIgZW50ZXJGcm96ZW4gPSB0aGlzLnBhcmVudC5mcm96ZW5Sb3dzICE9PSAwICYmIGFjdGlvbiA9PT0gJ3NoaWZ0RW50ZXInO1xuICAgICAgICB2YXIgaGVhZGVyU3dhcCA9IChhY3Rpb24gPT09ICd1cEFycm93JyB8fCBlbnRlckZyb3plbikgJiYgY3VycmVudFswXSA9PT0gMDtcbiAgICAgICAgaWYgKHRoaXMubWF0cml4Lm1hdHJpeFtjdXJyZW50WzBdXSkge1xuICAgICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ3RhYicgJiYgdGhpcy5tYXRyaXgubWF0cml4Lmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgIGN1cnJlbnRbMV0gPT09IHRoaXMubWF0cml4Lm1hdHJpeFtjdXJyZW50WzBdXS5sYXN0SW5kZXhPZigxKSAmJiB0aGlzLm1hdHJpeC5tYXRyaXgubGVuZ3RoIC0gMSAhPT0gY3VycmVudFswXSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWF0cml4LmN1cnJlbnRbMF0gPSB0aGlzLm5leHRSb3dGb2N1c1ZhbGlkYXRlKHRoaXMubWF0cml4LmN1cnJlbnRbMF0gKyAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hdHJpeC5jdXJyZW50WzFdID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ3NoaWZ0VGFiJyAmJlxuICAgICAgICAgICAgY3VycmVudFswXSAhPT0gMCAmJiB0aGlzLm1hdHJpeC5tYXRyaXhbY3VycmVudFswXV0uaW5kZXhPZigxKSA9PT0gY3VycmVudFsxXSkge1xuICAgICAgICAgICAgdGhpcy5tYXRyaXguY3VycmVudFswXSA9IHRoaXMucHJldmlvdXNSb3dGb2N1c1ZhbGlkYXRlKHRoaXMubWF0cml4LmN1cnJlbnRbMF0gLSAxKTtcbiAgICAgICAgICAgIHRoaXMubWF0cml4LmN1cnJlbnRbMV0gPSB0aGlzLm1hdHJpeC5tYXRyaXhbY3VycmVudFswXV0ubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpc0hlYWRlckZvY3VzID0gZmFsc2U7XG4gICAgICAgIHZhciByb3cgPSBwYXJlbnRzVW50aWwoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCwgJ2UtYWRkZWRyb3cnKSAmJiB0aGlzLnBhcmVudC5lZGl0U2V0dGluZ3Muc2hvd0FkZE5ld1JvdyA/XG4gICAgICAgICAgICBwYXJlbnRzVW50aWwoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCwgJ2UtYWRkZWRyb3cnKSA6IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgaWYgKCh0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLnBhcmVudC5pbmZpbml0ZVNjcm9sbFNldHRpbmdzLmVuYWJsZUNhY2hlKVxuICAgICAgICAgICAgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKHJvdykgJiYgcm93LmNsYXNzTGlzdC5jb250YWlucyhsaXRlcmFscy5yb3cpKSB7XG4gICAgICAgICAgICB2YXIgcm93SW5kZXggPSBwYXJzZUludChyb3cuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDE7XG4gICAgICAgICAgICBpc0hlYWRlckZvY3VzID0gcm93SW5kZXggPiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbmZvID0ge1xuICAgICAgICAgICAgc3dhcDogIWlzSGVhZGVyRm9jdXMgPyAoKGFjdGlvbiA9PT0gJ3VwQXJyb3cnIHx8IGVudGVyRnJvemVuKSAmJiBjdXJyZW50WzBdID09PSAwKSA6IGZhbHNlLFxuICAgICAgICAgICAgdG9IZWFkZXI6IGhlYWRlclN3YXBcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGluZm87XG4gICAgfTtcbiAgICBDb250ZW50Rm9jdXMucHJvdG90eXBlLmdldE5leHRDdXJyZW50ID0gZnVuY3Rpb24gKHByZXZpb3VzLCBzd2FwLCBhY3RpdmUsIGFjdGlvbikge1xuICAgICAgICBpZiAocHJldmlvdXMgPT09IHZvaWQgMCkgeyBwcmV2aW91cyA9IFtdOyB9XG4gICAgICAgIHZhciBjdXJyZW50ID0gW107XG4gICAgICAgIGlmIChhY3Rpb24gPT09ICdyaWdodEFycm93JyB8fCBhY3Rpb24gPT09ICd0YWInKSB7XG4gICAgICAgICAgICBjdXJyZW50WzBdID0gcHJldmlvdXNbMF07XG4gICAgICAgICAgICBjdXJyZW50WzFdID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ2Rvd25BcnJvdycgfHwgYWN0aW9uID09PSAnZW50ZXInKSB7XG4gICAgICAgICAgICBjdXJyZW50WzBdID0gLTE7XG4gICAgICAgICAgICBjdXJyZW50WzFdID0gcHJldmlvdXNbMV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGN1cnJlbnQ7XG4gICAgfTtcbiAgICBDb250ZW50Rm9jdXMucHJvdG90eXBlLmdlbmVyYXRlUm93cyA9IGZ1bmN0aW9uIChyb3dzLCBvcHRpb25hbHMpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgbWF0cml4ID0gb3B0aW9uYWxzLm1hdHJpeCwgaGFuZGxlckluc3RhbmNlID0gb3B0aW9uYWxzLmhhbmRsZXJJbnN0YW5jZTtcbiAgICAgICAgdmFyIGxlbiA9IGhhbmRsZXJJbnN0YW5jZS5tYXRyaXgubWF0cml4Lmxlbmd0aDtcbiAgICAgICAgdmFyIGRlZmF1bHRMZW4gPSB0aGlzLnBhcmVudC5hbGxvd0ZpbHRlcmluZyAmJiB0aGlzLnBhcmVudC5maWx0ZXJTZXR0aW5ncy50eXBlID09PSAnRmlsdGVyQmFyJyA/IGxlbiArIDEgOiBsZW47XG4gICAgICAgIGhhbmRsZXJJbnN0YW5jZS5tYXRyaXgubWF0cml4ID0gaGFuZGxlckluc3RhbmNlLm1hdHJpeC5tYXRyaXguc2xpY2UoMCwgZGVmYXVsdExlbik7IC8vSGVhZGVyIG1hdHJpeCB1cGRhdGUuXG4gICAgICAgIGhhbmRsZXJJbnN0YW5jZS5tYXRyaXgucm93cyA9IGRlZmF1bHRMZW47XG4gICAgICAgIChfYSA9IGhhbmRsZXJJbnN0YW5jZS5tYXRyaXgubWF0cml4KS5wdXNoLmFwcGx5KF9hLCBtYXRyaXgpO1xuICAgICAgICBoYW5kbGVySW5zdGFuY2UubWF0cml4LnJvd3MgKz0gbWF0cml4Lmxlbmd0aDtcbiAgICB9O1xuICAgIENvbnRlbnRGb2N1cy5wcm90b3R5cGUuZ2V0SW5mbyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBpbmZvID0gdGhpcy5nZXRGb2N1c0luZm8oKTtcbiAgICAgICAgdmFyIF9hID0gdGhpcy5tYXRyaXguY3VycmVudCwgckluZGV4ID0gX2FbMF0sIGNJbmRleCA9IF9hWzFdO1xuICAgICAgICB2YXIgaXNEYXRhID0gaW5mby5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhsaXRlcmFscy5yb3dDZWxsKTtcbiAgICAgICAgdmFyIGlzU2VsZWN0YWJsZSA9IGlzRGF0YSB8fCAoZSAmJiBlLmFjdGlvbiAhPT0gJ2VudGVyJyAmJiAoaW5mby5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1kZXRhaWxyb3djb2xsYXBzZScpXG4gICAgICAgICAgICB8fCBpbmZvLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWRldGFpbHJvd2V4cGFuZCcpKSk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICB2YXIgX2IgPSBbTWF0aC5taW4ocGFyc2VJbnQoaW5mby5lbGVtZW50LnBhcmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFSb3dJbmRleCksIDEwKSAtIDEsIHJJbmRleCksXG4gICAgICAgICAgICBNYXRoLm1pbihwYXJzZUludChpbmZvLmVsZW1lbnQuZ2V0QXR0cmlidXRlKGxpdGVyYWxzLmFyaWFDb2xJbmRleCksIDEwKSAtIDEsIGNJbmRleCldLCByb3dJbmRleCA9IF9iWzBdLCBjZWxsSW5kZXggPSBfYlsxXTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93R3JvdXBpbmcgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5lbmFibGVMYXp5TG9hZGluZyAmJiBpc0RhdGEpIHtcbiAgICAgICAgICAgIHJvd0luZGV4ID0gdGhpcy5wYXJlbnQuZ2V0RGF0YVJvd3MoKS5pbmRleE9mKGluZm8uZWxlbWVudC5wYXJlbnRFbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlVmlydHVhbGl6YXRpb24gJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgICAgICAgcm93SW5kZXggPSBySW5kZXg7XG4gICAgICAgICAgICBjZWxsSW5kZXggPSBjSW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5uZXdSb3dQb3NpdGlvbiA9PT0gJ1RvcCcgJiZcbiAgICAgICAgICAgICF0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiAmJiAhdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgJiYgZSAmJiBlLmFjdGlvbiA9PT0gJ2Rvd25BcnJvdycpIHtcbiAgICAgICAgICAgIHJvd0luZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgaXNDb250ZW50OiB0cnVlLCBpc0RhdGFDZWxsOiBpc0RhdGEsIGluZGV4ZXM6IFtyb3dJbmRleCwgY2VsbEluZGV4XSwgaXNTZWxlY3RhYmxlOiBpc1NlbGVjdGFibGUgfTtcbiAgICB9O1xuICAgIENvbnRlbnRGb2N1cy5wcm90b3R5cGUudmFsaWRhdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFibGUgPSB0aGlzLmdldFRhYmxlKCk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAocm93SW5kZXgsIGNlbGxJbmRleCwgYWN0aW9uKSB7XG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRhYmxlLnJvd3NbcGFyc2VJbnQocm93SW5kZXgudG9TdHJpbmcoKSwgMTApXSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2VsbCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBjZWxsSW5kZXggPSB0YWJsZS5xdWVyeVNlbGVjdG9yKCcuZS1lbXB0eXJvdycpID8gMCA6IGNlbGxJbmRleDtcbiAgICAgICAgICAgICAgICBpZiAodGFibGUucm93c1twYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldLmNlbGxzWzBdLmNsYXNzTGlzdC5jb250YWlucygnZS1lZGl0Y2VsbCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNlbGwgPSB0YWJsZS5yb3dzW3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0uY2VsbHNbMF0ucXVlcnlTZWxlY3RvckFsbCgndGQnKVtwYXJzZUludChjZWxsSW5kZXgudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNlbGwgPSB0YWJsZS5yb3dzW3BhcnNlSW50KHJvd0luZGV4LnRvU3RyaW5nKCksIDEwKV0uY2VsbHNbcGFyc2VJbnQoY2VsbEluZGV4LnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBpc0NlbGxXaWR0aCA9IGNlbGwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggIT09IDA7XG4gICAgICAgICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ2VudGVyJyB8fCBhY3Rpb24gPT09ICdzaGlmdEVudGVyJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNDZWxsV2lkdGggJiYgY2VsbC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMucm93Q2VsbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgoYWN0aW9uID09PSAnc2hpZnRVcCcgfHwgYWN0aW9uID09PSAnc2hpZnREb3duJykgJiYgY2VsbC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMucm93Q2VsbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzQ2VsbFdpZHRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhY3Rpb24gIT09ICdzaGlmdFVwJyAmJiBhY3Rpb24gIT09ICdzaGlmdERvd24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpc0NlbGxXaWR0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBDb250ZW50Rm9jdXMucHJvdG90eXBlLnNob3VsZEZvY3VzQ2hhbmdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIF9hID0gdGhpcy5tYXRyaXguY3VycmVudCwgX2IgPSBfYVswXSwgckluZGV4ID0gX2IgPT09IHZvaWQgMCA/IC0xIDogX2IsIF9jID0gX2FbMV0sIGNJbmRleCA9IF9jID09PSB2b2lkIDAgPyAtMSA6IF9jO1xuICAgICAgICBpZiAockluZGV4IDwgMCB8fCBjSW5kZXggPCAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2VsbCA9IGdldFZhbHVlKHJJbmRleCArIFwiLmNlbGxzLlwiICsgY0luZGV4LCB0aGlzLmdldFRhYmxlKCkucm93cyk7XG4gICAgICAgIGlmICghY2VsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGUuYWN0aW9uID09PSAnZW50ZXInIHx8IGUuYWN0aW9uID09PSAnc2hpZnRFbnRlcicgP1xuICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuY29udGFpbnMobGl0ZXJhbHMucm93Q2VsbCkgJiYgIWNlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXVuYm91bmRjZWxsJylcbiAgICAgICAgICAgICAgICB8fCBjZWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1lZGl0ZWRiYXRjaGNlbGwnKSAmJiAhY2VsbC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZGV0YWlsY2VsbCcpIDogdHJ1ZTtcbiAgICB9O1xuICAgIENvbnRlbnRGb2N1cy5wcm90b3R5cGUuZ2V0R3JpZFNlbGV0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuYWxsb3dTZWxlY3Rpb24gJiYgdGhpcy5wYXJlbnQuc2VsZWN0aW9uU2V0dGluZ3MuYWxsb3dDb2x1bW5TZWxlY3Rpb247XG4gICAgfTtcbiAgICByZXR1cm4gQ29udGVudEZvY3VzO1xufSgpKTtcbmV4cG9ydCB7IENvbnRlbnRGb2N1cyB9O1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbnZhciBIZWFkZXJGb2N1cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSGVhZGVyRm9jdXMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSGVhZGVyRm9jdXMocGFyZW50KSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwYXJlbnQpIHx8IHRoaXM7XG4gICAgfVxuICAgIEhlYWRlckZvY3VzLnByb3RvdHlwZS5nZXRUYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnBhcmVudC5nZXRIZWFkZXJUYWJsZSgpKTtcbiAgICB9O1xuICAgIEhlYWRlckZvY3VzLnByb3RvdHlwZS5vbkNsaWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdGhpcy5mb2N1c1R5cGUgPSAnY2xpY2snO1xuICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB0YXJnZXQgPSAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1oZWFkZXJjZWxsJykgPyB0YXJnZXQgOiBjbG9zZXN0KHRhcmdldCwgJ3RoJykpO1xuICAgICAgICBpZiAoIXRhcmdldCAmJiAodGhpcy5wYXJlbnQuZnJvemVuUm93cyAhPT0gMCB8fCAoKHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uIHx8IHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSAmJlxuICAgICAgICAgICAgdGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cpKSkge1xuICAgICAgICAgICAgdGFyZ2V0ID0gKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhsaXRlcmFscy5yb3dDZWxsKSA/IGUudGFyZ2V0IDpcbiAgICAgICAgICAgICAgICBjbG9zZXN0KGUudGFyZ2V0LCAndGQnKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1jb2x1bW5oZWFkZXInKSB8fFxuICAgICAgICAgICAgZS50YXJnZXQucXVlcnlTZWxlY3RvcignLmUtc3RhY2tlZGhlYWRlcmNlbGwnKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvd0lkeCA9IHRhcmdldC5wYXJlbnRFbGVtZW50LnJvd0luZGV4O1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZWRpdFNldHRpbmdzLnNob3dBZGROZXdSb3cgJiYgcGFyZW50c1VudGlsKHRhcmdldCwgJ2UtYWRkZWRyb3cnKSkge1xuICAgICAgICAgICAgcm93SWR4ID0gcGFyZW50c1VudGlsKHRhcmdldCwgJ2UtYWRkZWRyb3cnKS5yb3dJbmRleDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX2EgPSBbcm93SWR4LCB0YXJnZXQuY2VsbEluZGV4XSwgcm93SW5kZXggPSBfYVswXSwgY2VsbEluZGV4ID0gX2FbMV07XG4gICAgICAgIHZhciB2YWwgPSBnZXRWYWx1ZShyb3dJbmRleCArIFwiLlwiICsgY2VsbEluZGV4LCB0aGlzLm1hdHJpeC5tYXRyaXgpO1xuICAgICAgICBpZiAodGhpcy5tYXRyaXguaW5WYWxpZCh2YWwpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tYXRyaXguc2VsZWN0KHJvd0lkeCwgdGFyZ2V0LmNlbGxJbmRleCk7XG4gICAgfTtcbiAgICBIZWFkZXJGb2N1cy5wcm90b3R5cGUuZ2V0Rm9jdXNJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW5mbyA9IHt9O1xuICAgICAgICB2YXIgX2EgPSB0aGlzLm1hdHJpeC5jdXJyZW50LCBfYiA9IF9hWzBdLCByb3dJbmRleCA9IF9iID09PSB2b2lkIDAgPyAwIDogX2IsIF9jID0gX2FbMV0sIGNlbGxJbmRleCA9IF9jID09PSB2b2lkIDAgPyAwIDogX2M7XG4gICAgICAgIHZhciByb3cgPSB0aGlzLmdldFRhYmxlKCkucm93c1twYXJzZUludChyb3dJbmRleC50b1N0cmluZygpLCAxMCldO1xuICAgICAgICBpbmZvLmVsZW1lbnQgPSAhaXNOdWxsT3JVbmRlZmluZWQocm93KSA/IHRoaXMucGFyZW50LmVkaXRTZXR0aW5ncy5zaG93QWRkTmV3Um93ICYmIHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2UtYWRkZWRyb3cnKSA/XG4gICAgICAgICAgICAocm93LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkOm5vdCguZS1lZGl0Y2VsbCknKSlbcGFyc2VJbnQoY2VsbEluZGV4LnRvU3RyaW5nKCksIDEwKV1cbiAgICAgICAgICAgIDogcm93LmNlbGxzW3BhcnNlSW50KGNlbGxJbmRleC50b1N0cmluZygpLCAxMCldIDogbnVsbDtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChpbmZvLmVsZW1lbnQpKSB7XG4gICAgICAgICAgICBpbmZvLmVsZW1lbnRUb0ZvY3VzID0gdGhpcy5nZXRGb2N1c2FibGUoaW5mby5lbGVtZW50KTtcbiAgICAgICAgICAgIGluZm8ub3V0bGluZSA9ICFpbmZvLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWZpbHRlcmJhcmNlbGwnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5mbztcbiAgICB9O1xuICAgIEhlYWRlckZvY3VzLnByb3RvdHlwZS5zZWxlY3RvciA9IGZ1bmN0aW9uIChyb3csIGNlbGwpIHtcbiAgICAgICAgcmV0dXJuIChjZWxsLnZpc2libGUgJiYgKGNlbGwuY29sdW1uLmZpZWxkICE9PSB1bmRlZmluZWQgfHwgY2VsbC5pc1RlbXBsYXRlIHx8ICFpc051bGxPclVuZGVmaW5lZChjZWxsLmNvbHVtbi50ZW1wbGF0ZSlcbiAgICAgICAgICAgIHx8ICFpc051bGxPclVuZGVmaW5lZChjZWxsLmNvbHVtbi5jb21tYW5kcykgfHwgY2VsbC5jb2x1bW4udHlwZSA9PT0gJ2NoZWNrYm94JykpIHx8IGNlbGwuY2VsbFR5cGUgPT09IENlbGxUeXBlLlN0YWNrZWRIZWFkZXI7XG4gICAgfTtcbiAgICBIZWFkZXJGb2N1cy5wcm90b3R5cGUuanVtcCA9IGZ1bmN0aW9uIChhY3Rpb24sIGN1cnJlbnQpIHtcbiAgICAgICAgdmFyIGVudGVyRnJvemVuID0gdGhpcy5wYXJlbnQuZnJvemVuUm93cyAhPT0gMCAmJiBhY3Rpb24gPT09ICdlbnRlcic7XG4gICAgICAgIHZhciBpc0xhc3RDZWxsO1xuICAgICAgICB2YXIgbGFzdFJvdztcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZUhlYWRlckZvY3VzICYmIGFjdGlvbiA9PT0gJ3RhYicpIHtcbiAgICAgICAgICAgIGxhc3RSb3cgPSB0aGlzLm1hdHJpeC5tYXRyaXgubGVuZ3RoIC0gMSA9PT0gY3VycmVudFswXTtcbiAgICAgICAgICAgIGlzTGFzdENlbGwgPSBjdXJyZW50WzFdID09PSB0aGlzLm1hdHJpeC5tYXRyaXhbY3VycmVudFswXV0ubGFzdEluZGV4T2YoMSk7XG4gICAgICAgICAgICBpZiAoaXNMYXN0Q2VsbCkge1xuICAgICAgICAgICAgICAgIGlmICghbGFzdFJvdykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1hdHJpeC5jdXJyZW50WzBdID0gdGhpcy5tYXRyaXguY3VycmVudFswXSArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1hdHJpeC5jdXJyZW50WzBdID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5tYXRyaXguY3VycmVudFsxXSA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzd2FwOiAoKGFjdGlvbiA9PT0gJ2Rvd25BcnJvdycgfHwgZW50ZXJGcm96ZW4pICYmIGN1cnJlbnRbMF0gPT09IHRoaXMubWF0cml4Lm1hdHJpeC5sZW5ndGggLSAxKSB8fFxuICAgICAgICAgICAgICAgIChhY3Rpb24gPT09ICd0YWInICYmIGxhc3RSb3cgJiYgaXNMYXN0Q2VsbClcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEhlYWRlckZvY3VzLnByb3RvdHlwZS5nZXROZXh0Q3VycmVudCA9IGZ1bmN0aW9uIChwcmV2aW91cywgc3dhcCwgYWN0aXZlLCBhY3Rpb24pIHtcbiAgICAgICAgaWYgKHByZXZpb3VzID09PSB2b2lkIDApIHsgcHJldmlvdXMgPSBbXTsgfVxuICAgICAgICB2YXIgY3VycmVudDEgPSBbXTtcbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ3JpZ2h0QXJyb3cnIHx8IChhY3Rpb24gPT09ICdzaGlmdFJpZ2h0JyAmJiB0aGlzLmdldEdyaWRTZWxldGlvbigpKSB8fCBhY3Rpb24gPT09ICd0YWInKSB7XG4gICAgICAgICAgICBjdXJyZW50MVswXSA9IHByZXZpb3VzWzBdO1xuICAgICAgICAgICAgY3VycmVudDFbMV0gPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYWN0aW9uID09PSAndXBBcnJvdycgfHwgYWN0aW9uID09PSAnc2hpZnRFbnRlcicpIHtcbiAgICAgICAgICAgIGN1cnJlbnQxWzBdID0gdGhpcy5tYXRyaXgubWF0cml4Lmxlbmd0aDtcbiAgICAgICAgICAgIGN1cnJlbnQxWzFdID0gcHJldmlvdXNbMV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGN1cnJlbnQxO1xuICAgIH07XG4gICAgSGVhZGVyRm9jdXMucHJvdG90eXBlLmdlbmVyYXRlUm93cyA9IGZ1bmN0aW9uIChyb3dzKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLm1hdHJpeC5tYXRyaXgubGVuZ3RoO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dGaWx0ZXJpbmcgJiYgdGhpcy5wYXJlbnQuZmlsdGVyU2V0dGluZ3MudHlwZSA9PT0gJ0ZpbHRlckJhcicpIHtcbiAgICAgICAgICAgIHRoaXMubWF0cml4LnJvd3MgPSArK3RoaXMubWF0cml4LnJvd3M7XG4gICAgICAgICAgICB2YXIgY2VsbHMgPSByb3dzWzBdLmNlbGxzO1xuICAgICAgICAgICAgdmFyIGluY3JlbWVudE51bWJlciA9IDA7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNlbGxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW4gJiYgY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbi5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgICAgIGluY3JlbWVudE51bWJlciA9IHRoaXMuY2hlY2tGaWx0ZXJDb2x1bW4oY2VsbHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbi5jb2x1bW5zLCBsZW5ndGgsIGluY3JlbWVudE51bWJlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1hdHJpeC5zZXQobGVuZ3RoLCBpbmNyZW1lbnROdW1iZXIsIGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlICYmIGNlbGxzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW4uYWxsb3dGaWx0ZXJpbmcgIT09IGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgaW5jcmVtZW50TnVtYmVyKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBIZWFkZXJGb2N1cy5wcm90b3R5cGUuY2hlY2tGaWx0ZXJDb2x1bW4gPSBmdW5jdGlvbiAocm93Q29sdW1ucywgcm93SW5kZXgsIGNvbHVtbkluZGV4KSB7XG4gICAgICAgIHZhciBjb2x1bW5zID0gcm93Q29sdW1ucztcbiAgICAgICAgdmFyIGluY3JlbWVudE51bWJlciA9IGNvbHVtbkluZGV4O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgaW5jcmVtZW50TnVtYmVyID0gdGhpcy5jaGVja0ZpbHRlckNvbHVtbihjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zLCByb3dJbmRleCwgaW5jcmVtZW50TnVtYmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubWF0cml4LnNldChyb3dJbmRleCwgaW5jcmVtZW50TnVtYmVyLCBjb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS52aXNpYmxlICYmIGNvbHVtbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmFsbG93RmlsdGVyaW5nICE9PSBmYWxzZSk7XG4gICAgICAgICAgICAgICAgaW5jcmVtZW50TnVtYmVyKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluY3JlbWVudE51bWJlcjtcbiAgICB9O1xuICAgIEhlYWRlckZvY3VzLnByb3RvdHlwZS5nZXRJbmZvID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgcmV0dXJuIGV4dGVuZChfc3VwZXIucHJvdG90eXBlLmdldEluZm8uY2FsbCh0aGlzLCBlKSwgeyBpc0NvbnRlbnQ6IGZhbHNlLCBpc0hlYWRlcjogdHJ1ZSB9KTtcbiAgICB9O1xuICAgIEhlYWRlckZvY3VzLnByb3RvdHlwZS52YWxpZGF0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9O1xuICAgIH07XG4gICAgSGVhZGVyRm9jdXMucHJvdG90eXBlLnNob3VsZEZvY3VzQ2hhbmdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIF9hID0gdGhpcy5tYXRyaXguY3VycmVudCwgcm93SW5kZXggPSBfYVswXSwgY29sdW1uSW5kZXggPSBfYVsxXTtcbiAgICAgICAgaWYgKHJvd0luZGV4IDwgMCB8fCBjb2x1bW5JbmRleCA8IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjZWxsID0gZ2V0VmFsdWUocm93SW5kZXggKyBcIi5jZWxscy5cIiArIGNvbHVtbkluZGV4LCB0aGlzLmdldFRhYmxlKCkucm93cyk7XG4gICAgICAgIGlmICghY2VsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGUuYWN0aW9uID09PSAnZW50ZXInIHx8IGUuYWN0aW9uID09PSAnYWx0RG93bkFycm93JyA/ICFjZWxsLmNsYXNzTGlzdC5jb250YWlucygnZS1oZWFkZXJjZWxsJykgOiB0cnVlO1xuICAgIH07XG4gICAgSGVhZGVyRm9jdXMucHJvdG90eXBlLmdldEhlYWRlclR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnSGVhZGVyRm9jdXMnO1xuICAgIH07XG4gICAgcmV0dXJuIEhlYWRlckZvY3VzO1xufShDb250ZW50Rm9jdXMpKTtcbmV4cG9ydCB7IEhlYWRlckZvY3VzIH07XG4vKiogQGhpZGRlbiAqL1xudmFyIFNlYXJjaEJveCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTZWFyY2hCb3goc2VhcmNoQm94LCBzZXJ2aWNlTG9jYXRvcikge1xuICAgICAgICB0aGlzLnNlYXJjaEJveCA9IHNlYXJjaEJveDtcbiAgICAgICAgdGhpcy5zZXJ2aWNlTG9jYXRvciA9IHNlcnZpY2VMb2NhdG9yO1xuICAgICAgICB0aGlzLmwxMG4gPSB0aGlzLnNlcnZpY2VMb2NhdG9yLmdldFNlcnZpY2UoJ2xvY2FsaXphdGlvbicpO1xuICAgIH1cbiAgICBTZWFyY2hCb3gucHJvdG90eXBlLnNlYXJjaEZvY3VzID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgYXJncy50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlLWlucHV0LWZvY3VzJyk7XG4gICAgICAgIGlmIChhcmdzLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaW5wdXQnKSAmJiBhcmdzLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2Utc2VhcmNoJykgJiYgYXJncy50YXJnZXQudmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBzSWNvbiA9IGFyZ3MudGFyZ2V0LnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtc2ljb24nKTtcbiAgICAgICAgICAgIHNJY29uLmNsYXNzTGlzdC5hZGQoJ2UtY2xlYXItaWNvbicpO1xuICAgICAgICAgICAgc0ljb24uc2V0QXR0cmlidXRlKCd0aXRsZScsIHRoaXMubDEwbi5nZXRDb25zdGFudCgnQ2xlYXInKSk7XG4gICAgICAgICAgICAoc0ljb24pLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VhcmNoQm94LnByb3RvdHlwZS5zZWFyY2hCbHVyID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgdmFyIHJlbGF0ZWRUYXJnZXQgPSBhcmdzLnJlbGF0ZWRUYXJnZXQgPyBhcmdzLnJlbGF0ZWRUYXJnZXQgOiBudWxsO1xuICAgICAgICBpZiAocmVsYXRlZFRhcmdldCAmJiByZWxhdGVkVGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1zaWNvbicpKSB7XG4gICAgICAgICAgICBpZiAocmVsYXRlZFRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtY2xlYXItaWNvbicpKSB7XG4gICAgICAgICAgICAgICAgYXJncy50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdlLWlucHV0LWZvY3VzJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhcmdzLnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2UtaW5wdXQtZm9jdXMnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXJncy50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXNlYXJjaCcpICYmICgocmVsYXRlZFRhcmdldCAmJiAhKHJlbGF0ZWRUYXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXNpY29uIGUtY2xlYXItaWNvbicpKVxuICAgICAgICAgICAgJiYgIShyZWxhdGVkVGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1zaWNvbicpKSkgfHwgaXNOdWxsT3JVbmRlZmluZWQocmVsYXRlZFRhcmdldCkpKSB7XG4gICAgICAgICAgICB2YXIgc0ljb24gPSBhcmdzLnRhcmdldC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXNpY29uJyk7XG4gICAgICAgICAgICBzSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdlLWNsZWFyLWljb24nKTtcbiAgICAgICAgICAgIHNJY29uLnJlbW92ZUF0dHJpYnV0ZSgndGl0bGUnKTtcbiAgICAgICAgICAgIHNJY29uLnN0eWxlLmN1cnNvciA9ICdkZWZhdWx0JztcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VhcmNoQm94LnByb3RvdHlwZS53aXJlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnNlYXJjaEJveCkge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnNlYXJjaEJveCwgJ2ZvY3VzJywgdGhpcy5zZWFyY2hGb2N1cywgdGhpcyk7XG4gICAgICAgICAgICBFdmVudEhhbmRsZXIuYWRkKHRoaXMuc2VhcmNoQm94LCAnYmx1cicsIHRoaXMuc2VhcmNoQmx1ciwgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlYXJjaEJveC5wcm90b3R5cGUudW5XaXJlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnNlYXJjaEJveCkge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLnNlYXJjaEJveCwgJ2ZvY3VzJywgdGhpcy5zZWFyY2hGb2N1cyk7XG4gICAgICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuc2VhcmNoQm94LCAnYmx1cicsIHRoaXMuc2VhcmNoQmx1cik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBTZWFyY2hCb3g7XG59KCkpO1xuZXhwb3J0IHsgU2VhcmNoQm94IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/focus-strategy.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/group-model-generator.js":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/group-model-generator.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GroupModelGenerator: () => (/* binding */ GroupModelGenerator)\n/* harmony export */ });\n/* harmony import */ var _models_row__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../models/row */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/row.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _services_row_model_generator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../services/row-model-generator */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/row-model-generator.js\");\n/* harmony import */ var _services_summary_model_generator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../services/summary-model-generator */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/summary-model-generator.js\");\n/* harmony import */ var _grid_base_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../grid/base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n/**\n * GroupModelGenerator is used to generate group caption rows and data rows.\n *\n * @hidden\n */\nvar GroupModelGenerator = /** @class */ (function (_super) {\n    __extends(GroupModelGenerator, _super);\n    function GroupModelGenerator(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.rows = [];\n        /** @hidden */\n        _this.index = 0;\n        _this.infiniteChildCount = 0;\n        _this.renderInfiniteAgg = true;\n        _this.parent = parent;\n        _this.summaryModelGen = new _services_summary_model_generator__WEBPACK_IMPORTED_MODULE_1__.GroupSummaryModelGenerator(parent);\n        _this.captionModelGen = new _services_summary_model_generator__WEBPACK_IMPORTED_MODULE_1__.CaptionSummaryModelGenerator(parent);\n        return _this;\n    }\n    GroupModelGenerator.prototype.generateRows = function (data, args) {\n        if (this.parent.groupSettings.columns.length === 0) {\n            return _super.prototype.generateRows.call(this, data, args);\n        }\n        this.isInfiniteScroll = (args.requestType === 'infiniteScroll');\n        this.rows = [];\n        this.index = this.parent.enableVirtualization || this.isInfiniteScroll ? args.startIndex : 0;\n        for (var i = 0, len = data.length; i < len; i++) {\n            this.infiniteChildCount = 0;\n            this.renderInfiniteAgg = true;\n            this.getGroupedRecords(0, data[parseInt(i.toString(), 10)], data.level, i, undefined, this.rows.length);\n        }\n        this.index = 0;\n        if (this.parent.isCollapseStateEnabled()) {\n            this.ensureRowVisibility();\n        }\n        return this.rows;\n    };\n    GroupModelGenerator.prototype.getGroupedRecords = function (index, data, raw, parentid, childId, tIndex, parentUid) {\n        var _a;\n        var level = raw;\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(data.items)) {\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(data.GroupGuid)) {\n                this.rows = this.rows.concat(this.generateDataRows(data, index, parentid, this.rows.length, parentUid));\n            }\n            else {\n                for (var j = 0, len = data.length; j < len; j++) {\n                    this.getGroupedRecords(index, data[parseInt(j.toString(), 10)], data.level, parentid, index, this.rows.length, parentUid);\n                }\n            }\n        }\n        else {\n            var preCaption = void 0;\n            var captionRow = this.generateCaptionRow(data, index, parentid, childId, tIndex, parentUid);\n            if (this.isInfiniteScroll) {\n                preCaption = this.getPreCaption(index, captionRow.data.key);\n            }\n            if (!preCaption) {\n                this.rows = this.rows.concat(captionRow);\n            }\n            else {\n                captionRow.uid = preCaption.uid;\n            }\n            if (data.items && data.items.length) {\n                this.getGroupedRecords(index + 1, data.items, data.items.level, parentid, index + 1, this.rows.length, captionRow.uid);\n            }\n            if (this.parent.aggregates.length && this.isRenderAggregate(captionRow)) {\n                var rowCnt = this.rows.length;\n                (_a = this.rows).push.apply(_a, this.summaryModelGen.generateRows(data, { level: level, parentUid: captionRow.uid }));\n                for (var i = rowCnt - 1; i >= 0; i--) {\n                    if (this.rows[parseInt(i.toString(), 10)].isCaptionRow) {\n                        this.rows[parseInt(i.toString(), 10)].aggregatesCount = this.rows.length - rowCnt;\n                    }\n                    else if (!this.rows[parseInt(i.toString(), 10)].isCaptionRow && !this.rows[parseInt(i.toString(), 10)].isDataRow) {\n                        break;\n                    }\n                }\n            }\n            if (preCaption) {\n                this.setInfiniteRowVisibility(preCaption);\n            }\n        }\n    };\n    GroupModelGenerator.prototype.isRenderAggregate = function (data) {\n        if (this.parent.enableInfiniteScrolling) {\n            if (!this.renderInfiniteAgg) {\n                return false;\n            }\n            this.getPreCaption(data.indent, data.data.key);\n            this.renderInfiniteAgg = data.data.count === this.infiniteChildCount;\n            return this.renderInfiniteAgg;\n        }\n        return !this.parent.enableInfiniteScrolling;\n    };\n    GroupModelGenerator.prototype.getPreCaption = function (indent, key) {\n        var rowObj = this.parent.getRowsObject().concat(this.rows);\n        var preCap;\n        this.infiniteChildCount = 0;\n        var i = rowObj.length;\n        while (i--) {\n            if (rowObj[parseInt(i.toString(), 10)].isCaptionRow && rowObj[parseInt(i.toString(), 10)].indent === indent) {\n                var groupKey = rowObj[parseInt(i.toString(), 10)].data.key;\n                if ((groupKey && groupKey.toString() === key.toString() && groupKey instanceof Date) || groupKey === key) {\n                    preCap = rowObj[parseInt(i.toString(), 10)];\n                }\n            }\n            if (rowObj[parseInt(i.toString(), 10)].indent === indent || rowObj[parseInt(i.toString(), 10)].indent < indent) {\n                break;\n            }\n            if (rowObj[parseInt(i.toString(), 10)].indent === indent + 1) {\n                this.infiniteChildCount++;\n            }\n        }\n        return preCap;\n    };\n    GroupModelGenerator.prototype.getCaptionRowCells = function (field, indent, data) {\n        var cells = [];\n        var visibles = [];\n        var column = this.parent.getColumnByField(field);\n        var indexes = this.parent.getColumnIndexesInView();\n        if (this.parent.enableColumnVirtualization) {\n            column = this.parent.columns.filter(function (c) { return c.field === field; })[0];\n        }\n        var groupedLen = this.parent.groupSettings.columns.length;\n        var gObj = this.parent;\n        if (!this.parent.enableColumnVirtualization || indexes.indexOf(indent) !== -1) {\n            for (var i = 0; i < indent; i++) {\n                cells.push(this.generateIndentCell());\n            }\n            cells.push(this.generateCell({}, null, _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Expand));\n        }\n        indent = this.parent.enableColumnVirtualization ? 1 :\n            (this.parent.getVisibleColumns().length + groupedLen + (gObj.detailTemplate || gObj.childGrid ? 1 : 0) -\n                indent + (this.parent.getVisibleColumns().length ? -1 : 0));\n        //Captionsummary cells will be added here.\n        if (this.parent.aggregates.length && !this.captionModelGen.isEmpty()) {\n            var captionCells = this.captionModelGen.generateRows(data)[0];\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(data, captionCells.data);\n            var cIndex_1 = 0;\n            captionCells.cells.some(function (cell, index) { cIndex_1 = index; return cell.visible && cell.isDataCell; });\n            visibles = captionCells.cells.slice(cIndex_1).filter(function (cell) { return cell.visible; });\n            if (captionCells.visible && visibles[0].column.field === this.parent.getVisibleColumns()[0].field) {\n                visibles = visibles.slice(1);\n            }\n            if (this.parent.getVisibleColumns().length === 1) {\n                visibles = [];\n            }\n            indent = indent - visibles.length;\n        }\n        var cols = (!this.parent.enableColumnVirtualization ? [column] : this.parent.getColumns());\n        var wFlag = true;\n        for (var j = 0; j < cols.length; j++) {\n            var tmpFlag = wFlag && indexes.indexOf(indent) !== -1;\n            if (tmpFlag) {\n                wFlag = false;\n            }\n            var cellType = !this.parent.enableColumnVirtualization || tmpFlag ?\n                _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.GroupCaption : _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.GroupCaptionEmpty;\n            indent = this.parent.enableColumnVirtualization && cellType === _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.GroupCaption ? indent + groupedLen : indent;\n            if (gObj.isRowDragable()) {\n                indent++;\n            }\n            cells.push(this.generateCell(column, null, cellType, indent));\n        }\n        cells.push.apply(cells, visibles);\n        return cells;\n    };\n    /**\n     * @param {GroupedData} data - specifies the data\n     * @param {number} indent - specifies the indent\n     * @param {number} parentID - specifies the parentID\n     * @param {number} childID - specifies the childID\n     * @param {number} tIndex - specifies the TIndex\n     * @param {string} parentUid - specifies the ParentUid\n     * @returns {Row<Column>} returns the Row object\n     * @hidden\n     */\n    GroupModelGenerator.prototype.generateCaptionRow = function (data, indent, parentID, childID, tIndex, parentUid) {\n        var options = {};\n        var records = 'records';\n        var col = this.parent.getColumnByField(data.field);\n        options.data = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)({}, data);\n        if (col) {\n            options.data.field = data.field;\n        }\n        options.isDataRow = false;\n        options.isExpand = !this.parent.groupSettings.enableLazyLoading && !this.parent.isCollapseStateEnabled();\n        options.parentGid = parentID;\n        options.childGid = childID;\n        options.tIndex = tIndex;\n        options.isCaptionRow = true;\n        options.parentUid = parentUid;\n        options.gSummary = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(data.items[\"\" + records]) ? data.items[\"\" + records].length : data.items.length;\n        options.uid = (0,_grid_base_util__WEBPACK_IMPORTED_MODULE_3__.getUid)('grid-row');\n        var row = new _models_row__WEBPACK_IMPORTED_MODULE_4__.Row(options);\n        row.indent = indent;\n        this.getForeignKeyData(row);\n        row.cells = this.getCaptionRowCells(data.field, indent, row.data);\n        return row;\n    };\n    GroupModelGenerator.prototype.getForeignKeyData = function (row) {\n        var data = row.data;\n        var col = this.parent.getColumnByField(data.field);\n        if (col && col.isForeignColumn && col.isForeignColumn()) {\n            var fkValue = ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(data.key) ? '' : col.valueAccessor(col.foreignKeyValue, (0,_grid_base_util__WEBPACK_IMPORTED_MODULE_3__.getForeignData)(col, {}, data.key)[0], col));\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setValue)('foreignKey', fkValue, row.data);\n        }\n    };\n    /**\n     * @param {Object[]} data - specifies the data\n     * @param {number} indent - specifies the indent\n     * @param {number} childID - specifies the childID\n     * @param {number} tIndex - specifies the tIndex\n     * @param {string} parentUid - specifies the ParentUid\n     * @returns {Row<Column>[]} returns the row object\n     * @hidden\n     */\n    GroupModelGenerator.prototype.generateDataRows = function (data, indent, childID, tIndex, parentUid) {\n        var rows = [];\n        var indexes = this.parent.getColumnIndexesInView();\n        for (var i = 0, len = data.length; i < len; i++, tIndex++) {\n            rows[parseInt(i.toString(), 10)] = this.generateRow(data[parseInt(i.toString(), 10)], this.index, i ? undefined : 'e-firstchildrow', indent, childID, tIndex, parentUid);\n            for (var j = 0; j < indent; j++) {\n                if (this.parent.enableColumnVirtualization && indexes.indexOf(indent) === -1) {\n                    continue;\n                }\n                rows[parseInt(i.toString(), 10)].cells.unshift(this.generateIndentCell());\n            }\n            this.index++;\n        }\n        return rows;\n    };\n    GroupModelGenerator.prototype.generateIndentCell = function () {\n        return this.generateCell({}, null, _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Indent);\n    };\n    GroupModelGenerator.prototype.refreshRows = function (input) {\n        var indexes = this.parent.getColumnIndexesInView();\n        for (var i = 0; i < input.length; i++) {\n            if (input[parseInt(i.toString(), 10)].isDataRow) {\n                input[parseInt(i.toString(), 10)].cells = this.generateCells(input[parseInt(i.toString(), 10)]);\n                for (var j = 0; j < input[parseInt(i.toString(), 10)].indent; j++) {\n                    if (this.parent.enableColumnVirtualization\n                        && indexes.indexOf(input[parseInt(i.toString(), 10)].indent) === -1) {\n                        continue;\n                    }\n                    input[parseInt(i.toString(), 10)].cells.unshift(this.generateIndentCell());\n                }\n            }\n            else {\n                var cRow = this.generateCaptionRow(input[parseInt(i.toString(), 10)].data, input[parseInt(i.toString(), 10)].indent);\n                input[parseInt(i.toString(), 10)].cells = cRow.cells;\n            }\n        }\n        return input;\n    };\n    GroupModelGenerator.prototype.setInfiniteRowVisibility = function (caption) {\n        if (!caption.isExpand || caption.visible === false) {\n            for (var _i = 0, _a = this.rows; _i < _a.length; _i++) {\n                var row = _a[_i];\n                if (row.parentUid === caption.uid) {\n                    row.visible = false;\n                    if (row.isCaptionRow) {\n                        this.setInfiniteRowVisibility(row);\n                    }\n                }\n            }\n        }\n    };\n    GroupModelGenerator.prototype.ensureRowVisibility = function () {\n        for (var i = 0; i < this.rows.length; i++) {\n            var row = this.rows[parseInt(i.toString(), 10)];\n            if (!row.isCaptionRow) {\n                continue;\n            }\n            for (var j = i + 1; j < this.rows.length; j++) {\n                var childRow = this.rows[parseInt(j.toString(), 10)];\n                if (row.uid === childRow.parentUid) {\n                    this.rows[parseInt(j.toString(), 10)].visible = row.isExpand;\n                }\n            }\n        }\n    };\n    return GroupModelGenerator;\n}(_services_row_model_generator__WEBPACK_IMPORTED_MODULE_5__.RowModelGenerator));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9ncm91cC1tb2RlbC1nZW5lcmF0b3IuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3QjtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLENBQUM7QUFDbUM7QUFDdUM7QUFDbkM7QUFDNEI7QUFDMkM7QUFDakQ7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLHlGQUEwQjtBQUM5RCxvQ0FBb0MsMkZBQTRCO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxTQUFTO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx1RUFBaUI7QUFDN0IsZ0JBQWdCLHVFQUFpQjtBQUNqQztBQUNBO0FBQ0E7QUFDQSxtREFBbUQsU0FBUztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRkFBMEYseUNBQXlDO0FBQ25JLHlDQUF5QyxRQUFRO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCwyQkFBMkI7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsWUFBWTtBQUN4QztBQUNBO0FBQ0EsMkNBQTJDLFFBQVEsZ0RBQVE7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDREQUFNO0FBQ2xCO0FBQ0EsNkRBQTZELGtCQUFrQix5Q0FBeUM7QUFDeEgsbUZBQW1GLHNCQUFzQjtBQUN6RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpQkFBaUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixnREFBUSxnQkFBZ0IsZ0RBQVE7QUFDaEQsNEVBQTRFLGdEQUFRO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsYUFBYTtBQUM1QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQixhQUFhO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qiw0REFBTSxHQUFHO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHVFQUFpQjtBQUM3QyxzQkFBc0IsdURBQU07QUFDNUIsc0JBQXNCLDRDQUFHO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQix1RUFBaUIseURBQXlELCtEQUFjLFFBQVE7QUFDM0gsWUFBWSw4REFBUTtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxlQUFlLFVBQVU7QUFDekIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQixlQUFlO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsU0FBUztBQUNwRDtBQUNBLDRCQUE0QixZQUFZO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLFFBQVEsZ0RBQVE7QUFDbkQ7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0EsZ0NBQWdDLDhDQUE4QztBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxnQkFBZ0I7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzQkFBc0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msc0JBQXNCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsNEVBQWlCO0FBQ1kiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9ncm91cC1tb2RlbC1nZW5lcmF0b3IuanM/ODA0YSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbmltcG9ydCB7IFJvdyB9IGZyb20gJy4uL21vZGVscy9yb3cnO1xuaW1wb3J0IHsgaXNOdWxsT3JVbmRlZmluZWQsIGV4dGVuZCwgc2V0VmFsdWUgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBDZWxsVHlwZSB9IGZyb20gJy4uL2Jhc2UvZW51bSc7XG5pbXBvcnQgeyBSb3dNb2RlbEdlbmVyYXRvciB9IGZyb20gJy4uL3NlcnZpY2VzL3Jvdy1tb2RlbC1nZW5lcmF0b3InO1xuaW1wb3J0IHsgR3JvdXBTdW1tYXJ5TW9kZWxHZW5lcmF0b3IsIENhcHRpb25TdW1tYXJ5TW9kZWxHZW5lcmF0b3IgfSBmcm9tICcuLi9zZXJ2aWNlcy9zdW1tYXJ5LW1vZGVsLWdlbmVyYXRvcic7XG5pbXBvcnQgeyBnZXRGb3JlaWduRGF0YSwgZ2V0VWlkIH0gZnJvbSAnLi4vLi4vZ3JpZC9iYXNlL3V0aWwnO1xuLyoqXG4gKiBHcm91cE1vZGVsR2VuZXJhdG9yIGlzIHVzZWQgdG8gZ2VuZXJhdGUgZ3JvdXAgY2FwdGlvbiByb3dzIGFuZCBkYXRhIHJvd3MuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgR3JvdXBNb2RlbEdlbmVyYXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoR3JvdXBNb2RlbEdlbmVyYXRvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBHcm91cE1vZGVsR2VuZXJhdG9yKHBhcmVudCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwYXJlbnQpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnJvd3MgPSBbXTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXMuaW5kZXggPSAwO1xuICAgICAgICBfdGhpcy5pbmZpbml0ZUNoaWxkQ291bnQgPSAwO1xuICAgICAgICBfdGhpcy5yZW5kZXJJbmZpbml0ZUFnZyA9IHRydWU7XG4gICAgICAgIF90aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgX3RoaXMuc3VtbWFyeU1vZGVsR2VuID0gbmV3IEdyb3VwU3VtbWFyeU1vZGVsR2VuZXJhdG9yKHBhcmVudCk7XG4gICAgICAgIF90aGlzLmNhcHRpb25Nb2RlbEdlbiA9IG5ldyBDYXB0aW9uU3VtbWFyeU1vZGVsR2VuZXJhdG9yKHBhcmVudCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgR3JvdXBNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2VuZXJhdGVSb3dzID0gZnVuY3Rpb24gKGRhdGEsIGFyZ3MpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLmdlbmVyYXRlUm93cy5jYWxsKHRoaXMsIGRhdGEsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNJbmZpbml0ZVNjcm9sbCA9IChhcmdzLnJlcXVlc3RUeXBlID09PSAnaW5maW5pdGVTY3JvbGwnKTtcbiAgICAgICAgdGhpcy5yb3dzID0gW107XG4gICAgICAgIHRoaXMuaW5kZXggPSB0aGlzLnBhcmVudC5lbmFibGVWaXJ0dWFsaXphdGlvbiB8fCB0aGlzLmlzSW5maW5pdGVTY3JvbGwgPyBhcmdzLnN0YXJ0SW5kZXggOiAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gZGF0YS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdGhpcy5pbmZpbml0ZUNoaWxkQ291bnQgPSAwO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJJbmZpbml0ZUFnZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmdldEdyb3VwZWRSZWNvcmRzKDAsIGRhdGFbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBkYXRhLmxldmVsLCBpLCB1bmRlZmluZWQsIHRoaXMucm93cy5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5kZXggPSAwO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNDb2xsYXBzZVN0YXRlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0aGlzLmVuc3VyZVJvd1Zpc2liaWxpdHkoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yb3dzO1xuICAgIH07XG4gICAgR3JvdXBNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2V0R3JvdXBlZFJlY29yZHMgPSBmdW5jdGlvbiAoaW5kZXgsIGRhdGEsIHJhdywgcGFyZW50aWQsIGNoaWxkSWQsIHRJbmRleCwgcGFyZW50VWlkKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGxldmVsID0gcmF3O1xuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5pdGVtcykpIHtcbiAgICAgICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChkYXRhLkdyb3VwR3VpZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJvd3MgPSB0aGlzLnJvd3MuY29uY2F0KHRoaXMuZ2VuZXJhdGVEYXRhUm93cyhkYXRhLCBpbmRleCwgcGFyZW50aWQsIHRoaXMucm93cy5sZW5ndGgsIHBhcmVudFVpZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGxlbiA9IGRhdGEubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRHcm91cGVkUmVjb3JkcyhpbmRleCwgZGF0YVtwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0sIGRhdGEubGV2ZWwsIHBhcmVudGlkLCBpbmRleCwgdGhpcy5yb3dzLmxlbmd0aCwgcGFyZW50VWlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgcHJlQ2FwdGlvbiA9IHZvaWQgMDtcbiAgICAgICAgICAgIHZhciBjYXB0aW9uUm93ID0gdGhpcy5nZW5lcmF0ZUNhcHRpb25Sb3coZGF0YSwgaW5kZXgsIHBhcmVudGlkLCBjaGlsZElkLCB0SW5kZXgsIHBhcmVudFVpZCk7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0luZmluaXRlU2Nyb2xsKSB7XG4gICAgICAgICAgICAgICAgcHJlQ2FwdGlvbiA9IHRoaXMuZ2V0UHJlQ2FwdGlvbihpbmRleCwgY2FwdGlvblJvdy5kYXRhLmtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXByZUNhcHRpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJvd3MgPSB0aGlzLnJvd3MuY29uY2F0KGNhcHRpb25Sb3cpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FwdGlvblJvdy51aWQgPSBwcmVDYXB0aW9uLnVpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXRhLml0ZW1zICYmIGRhdGEuaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRHcm91cGVkUmVjb3JkcyhpbmRleCArIDEsIGRhdGEuaXRlbXMsIGRhdGEuaXRlbXMubGV2ZWwsIHBhcmVudGlkLCBpbmRleCArIDEsIHRoaXMucm93cy5sZW5ndGgsIGNhcHRpb25Sb3cudWlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5hZ2dyZWdhdGVzLmxlbmd0aCAmJiB0aGlzLmlzUmVuZGVyQWdncmVnYXRlKGNhcHRpb25Sb3cpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvd0NudCA9IHRoaXMucm93cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgKF9hID0gdGhpcy5yb3dzKS5wdXNoLmFwcGx5KF9hLCB0aGlzLnN1bW1hcnlNb2RlbEdlbi5nZW5lcmF0ZVJvd3MoZGF0YSwgeyBsZXZlbDogbGV2ZWwsIHBhcmVudFVpZDogY2FwdGlvblJvdy51aWQgfSkpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSByb3dDbnQgLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0NhcHRpb25Sb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uYWdncmVnYXRlc0NvdW50ID0gdGhpcy5yb3dzLmxlbmd0aCAtIHJvd0NudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghdGhpcy5yb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0NhcHRpb25Sb3cgJiYgIXRoaXMucm93c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNEYXRhUm93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwcmVDYXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRJbmZpbml0ZVJvd1Zpc2liaWxpdHkocHJlQ2FwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyb3VwTW9kZWxHZW5lcmF0b3IucHJvdG90eXBlLmlzUmVuZGVyQWdncmVnYXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucmVuZGVySW5maW5pdGVBZ2cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmdldFByZUNhcHRpb24oZGF0YS5pbmRlbnQsIGRhdGEuZGF0YS5rZXkpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJJbmZpbml0ZUFnZyA9IGRhdGEuZGF0YS5jb3VudCA9PT0gdGhpcy5pbmZpbml0ZUNoaWxkQ291bnQ7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJJbmZpbml0ZUFnZztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIXRoaXMucGFyZW50LmVuYWJsZUluZmluaXRlU2Nyb2xsaW5nO1xuICAgIH07XG4gICAgR3JvdXBNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2V0UHJlQ2FwdGlvbiA9IGZ1bmN0aW9uIChpbmRlbnQsIGtleSkge1xuICAgICAgICB2YXIgcm93T2JqID0gdGhpcy5wYXJlbnQuZ2V0Um93c09iamVjdCgpLmNvbmNhdCh0aGlzLnJvd3MpO1xuICAgICAgICB2YXIgcHJlQ2FwO1xuICAgICAgICB0aGlzLmluZmluaXRlQ2hpbGRDb3VudCA9IDA7XG4gICAgICAgIHZhciBpID0gcm93T2JqLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgaWYgKHJvd09ialtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaXNDYXB0aW9uUm93ICYmIHJvd09ialtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZW50ID09PSBpbmRlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXBLZXkgPSByb3dPYmpbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmRhdGEua2V5O1xuICAgICAgICAgICAgICAgIGlmICgoZ3JvdXBLZXkgJiYgZ3JvdXBLZXkudG9TdHJpbmcoKSA9PT0ga2V5LnRvU3RyaW5nKCkgJiYgZ3JvdXBLZXkgaW5zdGFuY2VvZiBEYXRlKSB8fCBncm91cEtleSA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHByZUNhcCA9IHJvd09ialtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJvd09ialtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZW50ID09PSBpbmRlbnQgfHwgcm93T2JqW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRlbnQgPCBpbmRlbnQpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyb3dPYmpbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmluZGVudCA9PT0gaW5kZW50ICsgMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5maW5pdGVDaGlsZENvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByZUNhcDtcbiAgICB9O1xuICAgIEdyb3VwTW9kZWxHZW5lcmF0b3IucHJvdG90eXBlLmdldENhcHRpb25Sb3dDZWxscyA9IGZ1bmN0aW9uIChmaWVsZCwgaW5kZW50LCBkYXRhKSB7XG4gICAgICAgIHZhciBjZWxscyA9IFtdO1xuICAgICAgICB2YXIgdmlzaWJsZXMgPSBbXTtcbiAgICAgICAgdmFyIGNvbHVtbiA9IHRoaXMucGFyZW50LmdldENvbHVtbkJ5RmllbGQoZmllbGQpO1xuICAgICAgICB2YXIgaW5kZXhlcyA9IHRoaXMucGFyZW50LmdldENvbHVtbkluZGV4ZXNJblZpZXcoKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uKSB7XG4gICAgICAgICAgICBjb2x1bW4gPSB0aGlzLnBhcmVudC5jb2x1bW5zLmZpbHRlcihmdW5jdGlvbiAoYykgeyByZXR1cm4gYy5maWVsZCA9PT0gZmllbGQ7IH0pWzBdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBncm91cGVkTGVuID0gdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aDtcbiAgICAgICAgdmFyIGdPYmogPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudC5lbmFibGVDb2x1bW5WaXJ0dWFsaXphdGlvbiB8fCBpbmRleGVzLmluZGV4T2YoaW5kZW50KSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kZW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBjZWxscy5wdXNoKHRoaXMuZ2VuZXJhdGVJbmRlbnRDZWxsKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2VsbHMucHVzaCh0aGlzLmdlbmVyYXRlQ2VsbCh7fSwgbnVsbCwgQ2VsbFR5cGUuRXhwYW5kKSk7XG4gICAgICAgIH1cbiAgICAgICAgaW5kZW50ID0gdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gPyAxIDpcbiAgICAgICAgICAgICh0aGlzLnBhcmVudC5nZXRWaXNpYmxlQ29sdW1ucygpLmxlbmd0aCArIGdyb3VwZWRMZW4gKyAoZ09iai5kZXRhaWxUZW1wbGF0ZSB8fCBnT2JqLmNoaWxkR3JpZCA/IDEgOiAwKSAtXG4gICAgICAgICAgICAgICAgaW5kZW50ICsgKHRoaXMucGFyZW50LmdldFZpc2libGVDb2x1bW5zKCkubGVuZ3RoID8gLTEgOiAwKSk7XG4gICAgICAgIC8vQ2FwdGlvbnN1bW1hcnkgY2VsbHMgd2lsbCBiZSBhZGRlZCBoZXJlLlxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWdncmVnYXRlcy5sZW5ndGggJiYgIXRoaXMuY2FwdGlvbk1vZGVsR2VuLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgdmFyIGNhcHRpb25DZWxscyA9IHRoaXMuY2FwdGlvbk1vZGVsR2VuLmdlbmVyYXRlUm93cyhkYXRhKVswXTtcbiAgICAgICAgICAgIGV4dGVuZChkYXRhLCBjYXB0aW9uQ2VsbHMuZGF0YSk7XG4gICAgICAgICAgICB2YXIgY0luZGV4XzEgPSAwO1xuICAgICAgICAgICAgY2FwdGlvbkNlbGxzLmNlbGxzLnNvbWUoZnVuY3Rpb24gKGNlbGwsIGluZGV4KSB7IGNJbmRleF8xID0gaW5kZXg7IHJldHVybiBjZWxsLnZpc2libGUgJiYgY2VsbC5pc0RhdGFDZWxsOyB9KTtcbiAgICAgICAgICAgIHZpc2libGVzID0gY2FwdGlvbkNlbGxzLmNlbGxzLnNsaWNlKGNJbmRleF8xKS5maWx0ZXIoZnVuY3Rpb24gKGNlbGwpIHsgcmV0dXJuIGNlbGwudmlzaWJsZTsgfSk7XG4gICAgICAgICAgICBpZiAoY2FwdGlvbkNlbGxzLnZpc2libGUgJiYgdmlzaWJsZXNbMF0uY29sdW1uLmZpZWxkID09PSB0aGlzLnBhcmVudC5nZXRWaXNpYmxlQ29sdW1ucygpWzBdLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdmlzaWJsZXMgPSB2aXNpYmxlcy5zbGljZSgxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5nZXRWaXNpYmxlQ29sdW1ucygpLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHZpc2libGVzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbmRlbnQgPSBpbmRlbnQgLSB2aXNpYmxlcy5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbHMgPSAoIXRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uID8gW2NvbHVtbl0gOiB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCkpO1xuICAgICAgICB2YXIgd0ZsYWcgPSB0cnVlO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNvbHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHZhciB0bXBGbGFnID0gd0ZsYWcgJiYgaW5kZXhlcy5pbmRleE9mKGluZGVudCkgIT09IC0xO1xuICAgICAgICAgICAgaWYgKHRtcEZsYWcpIHtcbiAgICAgICAgICAgICAgICB3RmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNlbGxUeXBlID0gIXRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uIHx8IHRtcEZsYWcgP1xuICAgICAgICAgICAgICAgIENlbGxUeXBlLkdyb3VwQ2FwdGlvbiA6IENlbGxUeXBlLkdyb3VwQ2FwdGlvbkVtcHR5O1xuICAgICAgICAgICAgaW5kZW50ID0gdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgY2VsbFR5cGUgPT09IENlbGxUeXBlLkdyb3VwQ2FwdGlvbiA/IGluZGVudCArIGdyb3VwZWRMZW4gOiBpbmRlbnQ7XG4gICAgICAgICAgICBpZiAoZ09iai5pc1Jvd0RyYWdhYmxlKCkpIHtcbiAgICAgICAgICAgICAgICBpbmRlbnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNlbGxzLnB1c2godGhpcy5nZW5lcmF0ZUNlbGwoY29sdW1uLCBudWxsLCBjZWxsVHlwZSwgaW5kZW50KSk7XG4gICAgICAgIH1cbiAgICAgICAgY2VsbHMucHVzaC5hcHBseShjZWxscywgdmlzaWJsZXMpO1xuICAgICAgICByZXR1cm4gY2VsbHM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0dyb3VwZWREYXRhfSBkYXRhIC0gc3BlY2lmaWVzIHRoZSBkYXRhXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGVudCAtIHNwZWNpZmllcyB0aGUgaW5kZW50XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBhcmVudElEIC0gc3BlY2lmaWVzIHRoZSBwYXJlbnRJRFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjaGlsZElEIC0gc3BlY2lmaWVzIHRoZSBjaGlsZElEXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRJbmRleCAtIHNwZWNpZmllcyB0aGUgVEluZGV4XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHBhcmVudFVpZCAtIHNwZWNpZmllcyB0aGUgUGFyZW50VWlkXG4gICAgICogQHJldHVybnMge1JvdzxDb2x1bW4+fSByZXR1cm5zIHRoZSBSb3cgb2JqZWN0XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEdyb3VwTW9kZWxHZW5lcmF0b3IucHJvdG90eXBlLmdlbmVyYXRlQ2FwdGlvblJvdyA9IGZ1bmN0aW9uIChkYXRhLCBpbmRlbnQsIHBhcmVudElELCBjaGlsZElELCB0SW5kZXgsIHBhcmVudFVpZCkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHt9O1xuICAgICAgICB2YXIgcmVjb3JkcyA9ICdyZWNvcmRzJztcbiAgICAgICAgdmFyIGNvbCA9IHRoaXMucGFyZW50LmdldENvbHVtbkJ5RmllbGQoZGF0YS5maWVsZCk7XG4gICAgICAgIG9wdGlvbnMuZGF0YSA9IGV4dGVuZCh7fSwgZGF0YSk7XG4gICAgICAgIGlmIChjb2wpIHtcbiAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5maWVsZCA9IGRhdGEuZmllbGQ7XG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucy5pc0RhdGFSb3cgPSBmYWxzZTtcbiAgICAgICAgb3B0aW9ucy5pc0V4cGFuZCA9ICF0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmVuYWJsZUxhenlMb2FkaW5nICYmICF0aGlzLnBhcmVudC5pc0NvbGxhcHNlU3RhdGVFbmFibGVkKCk7XG4gICAgICAgIG9wdGlvbnMucGFyZW50R2lkID0gcGFyZW50SUQ7XG4gICAgICAgIG9wdGlvbnMuY2hpbGRHaWQgPSBjaGlsZElEO1xuICAgICAgICBvcHRpb25zLnRJbmRleCA9IHRJbmRleDtcbiAgICAgICAgb3B0aW9ucy5pc0NhcHRpb25Sb3cgPSB0cnVlO1xuICAgICAgICBvcHRpb25zLnBhcmVudFVpZCA9IHBhcmVudFVpZDtcbiAgICAgICAgb3B0aW9ucy5nU3VtbWFyeSA9ICFpc051bGxPclVuZGVmaW5lZChkYXRhLml0ZW1zW1wiXCIgKyByZWNvcmRzXSkgPyBkYXRhLml0ZW1zW1wiXCIgKyByZWNvcmRzXS5sZW5ndGggOiBkYXRhLml0ZW1zLmxlbmd0aDtcbiAgICAgICAgb3B0aW9ucy51aWQgPSBnZXRVaWQoJ2dyaWQtcm93Jyk7XG4gICAgICAgIHZhciByb3cgPSBuZXcgUm93KG9wdGlvbnMpO1xuICAgICAgICByb3cuaW5kZW50ID0gaW5kZW50O1xuICAgICAgICB0aGlzLmdldEZvcmVpZ25LZXlEYXRhKHJvdyk7XG4gICAgICAgIHJvdy5jZWxscyA9IHRoaXMuZ2V0Q2FwdGlvblJvd0NlbGxzKGRhdGEuZmllbGQsIGluZGVudCwgcm93LmRhdGEpO1xuICAgICAgICByZXR1cm4gcm93O1xuICAgIH07XG4gICAgR3JvdXBNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2V0Rm9yZWlnbktleURhdGEgPSBmdW5jdGlvbiAocm93KSB7XG4gICAgICAgIHZhciBkYXRhID0gcm93LmRhdGE7XG4gICAgICAgIHZhciBjb2wgPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5CeUZpZWxkKGRhdGEuZmllbGQpO1xuICAgICAgICBpZiAoY29sICYmIGNvbC5pc0ZvcmVpZ25Db2x1bW4gJiYgY29sLmlzRm9yZWlnbkNvbHVtbigpKSB7XG4gICAgICAgICAgICB2YXIgZmtWYWx1ZSA9IChpc051bGxPclVuZGVmaW5lZChkYXRhLmtleSkgPyAnJyA6IGNvbC52YWx1ZUFjY2Vzc29yKGNvbC5mb3JlaWduS2V5VmFsdWUsIGdldEZvcmVpZ25EYXRhKGNvbCwge30sIGRhdGEua2V5KVswXSwgY29sKSk7XG4gICAgICAgICAgICBzZXRWYWx1ZSgnZm9yZWlnbktleScsIGZrVmFsdWUsIHJvdy5kYXRhKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3RbXX0gZGF0YSAtIHNwZWNpZmllcyB0aGUgZGF0YVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRlbnQgLSBzcGVjaWZpZXMgdGhlIGluZGVudFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjaGlsZElEIC0gc3BlY2lmaWVzIHRoZSBjaGlsZElEXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRJbmRleCAtIHNwZWNpZmllcyB0aGUgdEluZGV4XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHBhcmVudFVpZCAtIHNwZWNpZmllcyB0aGUgUGFyZW50VWlkXG4gICAgICogQHJldHVybnMge1JvdzxDb2x1bW4+W119IHJldHVybnMgdGhlIHJvdyBvYmplY3RcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgR3JvdXBNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2VuZXJhdGVEYXRhUm93cyA9IGZ1bmN0aW9uIChkYXRhLCBpbmRlbnQsIGNoaWxkSUQsIHRJbmRleCwgcGFyZW50VWlkKSB7XG4gICAgICAgIHZhciByb3dzID0gW107XG4gICAgICAgIHZhciBpbmRleGVzID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1uSW5kZXhlc0luVmlldygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gZGF0YS5sZW5ndGg7IGkgPCBsZW47IGkrKywgdEluZGV4KyspIHtcbiAgICAgICAgICAgIHJvd3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldID0gdGhpcy5nZW5lcmF0ZVJvdyhkYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgdGhpcy5pbmRleCwgaSA/IHVuZGVmaW5lZCA6ICdlLWZpcnN0Y2hpbGRyb3cnLCBpbmRlbnQsIGNoaWxkSUQsIHRJbmRleCwgcGFyZW50VWlkKTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaW5kZW50OyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgaW5kZXhlcy5pbmRleE9mKGluZGVudCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxscy51bnNoaWZ0KHRoaXMuZ2VuZXJhdGVJbmRlbnRDZWxsKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByb3dzO1xuICAgIH07XG4gICAgR3JvdXBNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2VuZXJhdGVJbmRlbnRDZWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZUNlbGwoe30sIG51bGwsIENlbGxUeXBlLkluZGVudCk7XG4gICAgfTtcbiAgICBHcm91cE1vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5yZWZyZXNoUm93cyA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgaW5kZXhlcyA9IHRoaXMucGFyZW50LmdldENvbHVtbkluZGV4ZXNJblZpZXcoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGlucHV0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pc0RhdGFSb3cpIHtcbiAgICAgICAgICAgICAgICBpbnB1dFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbHMgPSB0aGlzLmdlbmVyYXRlQ2VsbHMoaW5wdXRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGlucHV0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRlbnQ7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICYmIGluZGV4ZXMuaW5kZXhPZihpbnB1dFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5kZW50KSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlucHV0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxscy51bnNoaWZ0KHRoaXMuZ2VuZXJhdGVJbmRlbnRDZWxsKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBjUm93ID0gdGhpcy5nZW5lcmF0ZUNhcHRpb25Sb3coaW5wdXRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmRhdGEsIGlucHV0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5pbmRlbnQpO1xuICAgICAgICAgICAgICAgIGlucHV0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jZWxscyA9IGNSb3cuY2VsbHM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH07XG4gICAgR3JvdXBNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuc2V0SW5maW5pdGVSb3dWaXNpYmlsaXR5ID0gZnVuY3Rpb24gKGNhcHRpb24pIHtcbiAgICAgICAgaWYgKCFjYXB0aW9uLmlzRXhwYW5kIHx8IGNhcHRpb24udmlzaWJsZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLnJvd3M7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvdyA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICBpZiAocm93LnBhcmVudFVpZCA9PT0gY2FwdGlvbi51aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93LnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvdy5pc0NhcHRpb25Sb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0SW5maW5pdGVSb3dWaXNpYmlsaXR5KHJvdyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyb3VwTW9kZWxHZW5lcmF0b3IucHJvdG90eXBlLmVuc3VyZVJvd1Zpc2liaWxpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5yb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcm93ID0gdGhpcy5yb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgIGlmICghcm93LmlzQ2FwdGlvblJvdykge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IGkgKyAxOyBqIDwgdGhpcy5yb3dzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkUm93ID0gdGhpcy5yb3dzW3BhcnNlSW50KGoudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICBpZiAocm93LnVpZCA9PT0gY2hpbGRSb3cucGFyZW50VWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm93c1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0udmlzaWJsZSA9IHJvdy5pc0V4cGFuZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBHcm91cE1vZGVsR2VuZXJhdG9yO1xufShSb3dNb2RlbEdlbmVyYXRvcikpO1xuZXhwb3J0IHsgR3JvdXBNb2RlbEdlbmVyYXRvciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/group-model-generator.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/renderer-factory.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/renderer-factory.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RendererFactory: () => (/* binding */ RendererFactory)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n\n\n/**\n * RendererFactory\n *\n * @hidden\n */\nvar RendererFactory = /** @class */ (function () {\n    function RendererFactory() {\n        this.rendererMap = {};\n    }\n    RendererFactory.prototype.addRenderer = function (name, type) {\n        var rName = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getEnumValue)(_base_enum__WEBPACK_IMPORTED_MODULE_1__.RenderType, name);\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.rendererMap[\"\" + rName])) {\n            this.rendererMap[\"\" + rName] = type;\n        }\n    };\n    RendererFactory.prototype.getRenderer = function (name) {\n        var rName = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getEnumValue)(_base_enum__WEBPACK_IMPORTED_MODULE_1__.RenderType, name);\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.rendererMap[\"\" + rName])) {\n            // eslint-disable-next-line no-throw-literal\n            throw \"The renderer \" + rName + \" is not found\";\n        }\n        else {\n            return this.rendererMap[\"\" + rName];\n        }\n    };\n    return RendererFactory;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9yZW5kZXJlci1mYWN0b3J5LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1RTtBQUM3QjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixrRUFBWSxDQUFDLGtEQUFVO0FBQzNDLFlBQVksdUVBQWlCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGtFQUFZLENBQUMsa0RBQVU7QUFDM0MsWUFBWSx1RUFBaUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDMEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9yZW5kZXJlci1mYWN0b3J5LmpzP2IxYTUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNOdWxsT3JVbmRlZmluZWQsIGdldEVudW1WYWx1ZSB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IFJlbmRlclR5cGUgfSBmcm9tICcuLi9iYXNlL2VudW0nO1xuLyoqXG4gKiBSZW5kZXJlckZhY3RvcnlcbiAqXG4gKiBAaGlkZGVuXG4gKi9cbnZhciBSZW5kZXJlckZhY3RvcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmVuZGVyZXJGYWN0b3J5KCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyTWFwID0ge307XG4gICAgfVxuICAgIFJlbmRlcmVyRmFjdG9yeS5wcm90b3R5cGUuYWRkUmVuZGVyZXIgPSBmdW5jdGlvbiAobmFtZSwgdHlwZSkge1xuICAgICAgICB2YXIgck5hbWUgPSBnZXRFbnVtVmFsdWUoUmVuZGVyVHlwZSwgbmFtZSk7XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZCh0aGlzLnJlbmRlcmVyTWFwW1wiXCIgKyByTmFtZV0pKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyTWFwW1wiXCIgKyByTmFtZV0gPSB0eXBlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSZW5kZXJlckZhY3RvcnkucHJvdG90eXBlLmdldFJlbmRlcmVyID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIHJOYW1lID0gZ2V0RW51bVZhbHVlKFJlbmRlclR5cGUsIG5hbWUpO1xuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQodGhpcy5yZW5kZXJlck1hcFtcIlwiICsgck5hbWVdKSkge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXRocm93LWxpdGVyYWxcbiAgICAgICAgICAgIHRocm93IFwiVGhlIHJlbmRlcmVyIFwiICsgck5hbWUgKyBcIiBpcyBub3QgZm91bmRcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlcmVyTWFwW1wiXCIgKyByTmFtZV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBSZW5kZXJlckZhY3Rvcnk7XG59KCkpO1xuZXhwb3J0IHsgUmVuZGVyZXJGYWN0b3J5IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/renderer-factory.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/row-model-generator.js":
/*!**************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/row-model-generator.js ***!
  \**************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RowModelGenerator: () => (/* binding */ RowModelGenerator)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _models_row__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../models/row */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/row.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _models_cell__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../models/cell */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/cell.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../grid/base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n\n\n\n\n\n\n\n/**\n * RowModelGenerator is used to generate grid data rows.\n *\n * @hidden\n */\nvar RowModelGenerator = /** @class */ (function () {\n    /**\n     * Constructor for header renderer module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     */\n    function RowModelGenerator(parent) {\n        this.parent = parent;\n    }\n    RowModelGenerator.prototype.generateRows = function (data, args) {\n        var rows = [];\n        var startIndex = this.parent.enableVirtualization && args ? args.startIndex : 0;\n        startIndex = this.parent.enableInfiniteScrolling && args ? this.getInfiniteIndex(args) : startIndex;\n        if (this.parent.enableImmutableMode && args && args.startIndex) {\n            startIndex = args.startIndex;\n        }\n        for (var i = 0, len = Object.keys(data).length; i < len; i++, startIndex++) {\n            rows[parseInt(i.toString(), 10)] = this.generateRow(data[parseInt(i.toString(), 10)], startIndex);\n        }\n        return rows;\n    };\n    RowModelGenerator.prototype.ensureColumns = function () {\n        //TODO: generate dummy column for group, detail here;\n        var cols = [];\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            var args = {};\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_1__.detailIndentCellInfo, args);\n            cols.push(this.generateCell(args, null, _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.DetailExpand));\n        }\n        if (this.parent.isRowDragable()) {\n            cols.push(this.generateCell({}, null, _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.RowDragIcon));\n        }\n        return cols;\n    };\n    RowModelGenerator.prototype.generateRow = function (data, index, cssClass, indent, pid, tIndex, parentUid) {\n        var options = {};\n        options.foreignKeyData = {};\n        options.uid = (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.getUid)('grid-row');\n        options.data = data;\n        options.index = index;\n        options.indent = indent;\n        options.tIndex = tIndex;\n        options.isDataRow = true;\n        options.parentGid = pid;\n        options.parentUid = parentUid;\n        if (this.parent.isPrinting) {\n            if (this.parent.hierarchyPrintMode === 'All') {\n                options.isExpand = true;\n            }\n            else if (this.parent.hierarchyPrintMode === 'Expanded' && this.parent.expandedRows && this.parent.expandedRows[parseInt(index.toString(), 10)]) {\n                options.isExpand = this.parent.expandedRows[parseInt(index.toString(), 10)].isExpand;\n            }\n        }\n        options.cssClass = cssClass;\n        options.isAltRow = this.parent.enableAltRow ? index % 2 !== 0 : false;\n        options.isAltRow = this.parent.enableAltRow ? index % 2 !== 0 : false;\n        options.isSelected = this.parent.getSelectedRowIndexes().indexOf(index) > -1;\n        this.refreshForeignKeyRow(options);\n        var cells = this.ensureColumns();\n        var row = new _models_row__WEBPACK_IMPORTED_MODULE_4__.Row(options, this.parent);\n        row.cells = this.parent.getFrozenMode() === 'Right' ? this.generateCells(options).concat(cells)\n            : cells.concat(this.generateCells(options));\n        return row;\n    };\n    RowModelGenerator.prototype.refreshForeignKeyRow = function (options) {\n        var foreignKeyColumns = this.parent.getForeignKeyColumns();\n        for (var i = 0; i < foreignKeyColumns.length; i++) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setValue)(foreignKeyColumns[parseInt(i.toString(), 10)].field, (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.getForeignData)(foreignKeyColumns[parseInt(i.toString(), 10)], options.data), options.foreignKeyData);\n        }\n    };\n    RowModelGenerator.prototype.generateCells = function (options) {\n        var dummies = this.parent.getColumns();\n        var tmp = [];\n        for (var i = 0; i < dummies.length; i++) {\n            tmp.push(this.generateCell(dummies[parseInt(i.toString(), 10)], options.uid, (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(dummies[parseInt(i.toString(), 10)].commands) ? undefined : _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.CommandColumn, null, i, options.foreignKeyData));\n        }\n        return tmp;\n    };\n    /**\n     *\n     * @param {Column} column - Defines column details\n     * @param {string} rowId - Defines row id\n     * @param {CellType} cellType  - Defines cell type\n     * @param {number} colSpan - Defines colSpan\n     * @param {number} oIndex - Defines index\n     * @param {Object} foreignKeyData - Defines foreign key data\n     * @returns {Cell<Column>} returns cell model\n     * @hidden\n     */\n    RowModelGenerator.prototype.generateCell = function (column, rowId, cellType, colSpan, oIndex, foreignKeyData) {\n        var opt = {\n            'visible': column.visible,\n            'isDataCell': !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.field || column.template),\n            'isTemplate': !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.template),\n            'rowID': rowId,\n            'column': column,\n            'cellType': !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cellType) ? cellType : _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Data,\n            'colSpan': colSpan,\n            'commands': column.commands,\n            'isForeignKey': column.isForeignColumn && column.isForeignColumn(),\n            'foreignKeyData': column.isForeignColumn && column.isForeignColumn() && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.getValue)(column.field, foreignKeyData)\n        };\n        if (opt.isDataCell || opt.column.type === 'checkbox' || opt.commands) {\n            opt.index = oIndex;\n        }\n        return new _models_cell__WEBPACK_IMPORTED_MODULE_5__.Cell(opt);\n    };\n    RowModelGenerator.prototype.refreshRows = function (input) {\n        for (var i = 0; i < input.length; i++) {\n            this.refreshForeignKeyRow(input[parseInt(i.toString(), 10)]);\n            input[parseInt(i.toString(), 10)].cells = this.generateCells(input[parseInt(i.toString(), 10)]);\n        }\n        return input;\n    };\n    RowModelGenerator.prototype.getInfiniteIndex = function (args) {\n        return args.requestType === 'infiniteScroll' || args.requestType === 'delete' || args.action === 'add'\n            ? ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(args.startIndex) ? args['index'] : args.startIndex) : 0;\n    };\n    return RowModelGenerator;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9yb3ctbW9kZWwtZ2VuZXJhdG9yLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBNkU7QUFDekM7QUFDSTtBQUNGO0FBQ0E7QUFDZ0I7QUFDWDtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxTQUFTO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixnRUFBMkI7QUFDMUQsb0RBQW9ELGdEQUFRO0FBQzVEO0FBQ0E7QUFDQSwwQ0FBMEMsUUFBUSxnREFBUTtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isa0RBQU07QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLDRDQUFHO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw4QkFBOEI7QUFDdEQsWUFBWSw4REFBUSxzREFBc0QsMERBQWM7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixvQkFBb0I7QUFDNUMseUZBQXlGLHVFQUFpQiw2REFBNkQsZ0RBQVE7QUFDL0s7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxVQUFVO0FBQ3pCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQixjQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsdUVBQWlCO0FBQzVDLDJCQUEyQix1RUFBaUI7QUFDNUM7QUFDQTtBQUNBLHlCQUF5Qix1RUFBaUIsd0JBQXdCLGdEQUFRO0FBQzFFO0FBQ0E7QUFDQTtBQUNBLG9GQUFvRiw4REFBUTtBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw4Q0FBSTtBQUN2QjtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsdUVBQWlCO0FBQ2hDO0FBQ0E7QUFDQSxDQUFDO0FBQzRCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvc2VydmljZXMvcm93LW1vZGVsLWdlbmVyYXRvci5qcz9mZTA0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzTnVsbE9yVW5kZWZpbmVkLCBnZXRWYWx1ZSwgc2V0VmFsdWUgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBSb3cgfSBmcm9tICcuLi9tb2RlbHMvcm93JztcbmltcG9ydCB7IENlbGxUeXBlIH0gZnJvbSAnLi4vYmFzZS9lbnVtJztcbmltcG9ydCB7IENlbGwgfSBmcm9tICcuLi9tb2RlbHMvY2VsbCc7XG5pbXBvcnQgeyBnZXRVaWQgfSBmcm9tICcuLi9iYXNlL3V0aWwnO1xuaW1wb3J0IHsgZ2V0Rm9yZWlnbkRhdGEgfSBmcm9tICcuLi8uLi9ncmlkL2Jhc2UvdXRpbCc7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnLi4vYmFzZS9jb25zdGFudCc7XG4vKipcbiAqIFJvd01vZGVsR2VuZXJhdG9yIGlzIHVzZWQgdG8gZ2VuZXJhdGUgZ3JpZCBkYXRhIHJvd3MuXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgUm93TW9kZWxHZW5lcmF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IgZm9yIGhlYWRlciByZW5kZXJlciBtb2R1bGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7SUdyaWR9IHBhcmVudCAtIHNwZWNpZmllcyB0aGUgSUdyaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBSb3dNb2RlbEdlbmVyYXRvcihwYXJlbnQpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgfVxuICAgIFJvd01vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5nZW5lcmF0ZVJvd3MgPSBmdW5jdGlvbiAoZGF0YSwgYXJncykge1xuICAgICAgICB2YXIgcm93cyA9IFtdO1xuICAgICAgICB2YXIgc3RhcnRJbmRleCA9IHRoaXMucGFyZW50LmVuYWJsZVZpcnR1YWxpemF0aW9uICYmIGFyZ3MgPyBhcmdzLnN0YXJ0SW5kZXggOiAwO1xuICAgICAgICBzdGFydEluZGV4ID0gdGhpcy5wYXJlbnQuZW5hYmxlSW5maW5pdGVTY3JvbGxpbmcgJiYgYXJncyA/IHRoaXMuZ2V0SW5maW5pdGVJbmRleChhcmdzKSA6IHN0YXJ0SW5kZXg7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5lbmFibGVJbW11dGFibGVNb2RlICYmIGFyZ3MgJiYgYXJncy5zdGFydEluZGV4KSB7XG4gICAgICAgICAgICBzdGFydEluZGV4ID0gYXJncy5zdGFydEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBPYmplY3Qua2V5cyhkYXRhKS5sZW5ndGg7IGkgPCBsZW47IGkrKywgc3RhcnRJbmRleCsrKSB7XG4gICAgICAgICAgICByb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSA9IHRoaXMuZ2VuZXJhdGVSb3coZGF0YVtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIHN0YXJ0SW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByb3dzO1xuICAgIH07XG4gICAgUm93TW9kZWxHZW5lcmF0b3IucHJvdG90eXBlLmVuc3VyZUNvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vVE9ETzogZ2VuZXJhdGUgZHVtbXkgY29sdW1uIGZvciBncm91cCwgZGV0YWlsIGhlcmU7XG4gICAgICAgIHZhciBjb2xzID0gW107XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5kZXRhaWxUZW1wbGF0ZSB8fCB0aGlzLnBhcmVudC5jaGlsZEdyaWQpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0ge307XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoZXZlbnRzLmRldGFpbEluZGVudENlbGxJbmZvLCBhcmdzKTtcbiAgICAgICAgICAgIGNvbHMucHVzaCh0aGlzLmdlbmVyYXRlQ2VsbChhcmdzLCBudWxsLCBDZWxsVHlwZS5EZXRhaWxFeHBhbmQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNSb3dEcmFnYWJsZSgpKSB7XG4gICAgICAgICAgICBjb2xzLnB1c2godGhpcy5nZW5lcmF0ZUNlbGwoe30sIG51bGwsIENlbGxUeXBlLlJvd0RyYWdJY29uKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbHM7XG4gICAgfTtcbiAgICBSb3dNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2VuZXJhdGVSb3cgPSBmdW5jdGlvbiAoZGF0YSwgaW5kZXgsIGNzc0NsYXNzLCBpbmRlbnQsIHBpZCwgdEluZGV4LCBwYXJlbnRVaWQpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7fTtcbiAgICAgICAgb3B0aW9ucy5mb3JlaWduS2V5RGF0YSA9IHt9O1xuICAgICAgICBvcHRpb25zLnVpZCA9IGdldFVpZCgnZ3JpZC1yb3cnKTtcbiAgICAgICAgb3B0aW9ucy5kYXRhID0gZGF0YTtcbiAgICAgICAgb3B0aW9ucy5pbmRleCA9IGluZGV4O1xuICAgICAgICBvcHRpb25zLmluZGVudCA9IGluZGVudDtcbiAgICAgICAgb3B0aW9ucy50SW5kZXggPSB0SW5kZXg7XG4gICAgICAgIG9wdGlvbnMuaXNEYXRhUm93ID0gdHJ1ZTtcbiAgICAgICAgb3B0aW9ucy5wYXJlbnRHaWQgPSBwaWQ7XG4gICAgICAgIG9wdGlvbnMucGFyZW50VWlkID0gcGFyZW50VWlkO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNQcmludGluZykge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmhpZXJhcmNoeVByaW50TW9kZSA9PT0gJ0FsbCcpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmlzRXhwYW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucGFyZW50LmhpZXJhcmNoeVByaW50TW9kZSA9PT0gJ0V4cGFuZGVkJyAmJiB0aGlzLnBhcmVudC5leHBhbmRlZFJvd3MgJiYgdGhpcy5wYXJlbnQuZXhwYW5kZWRSb3dzW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0pIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmlzRXhwYW5kID0gdGhpcy5wYXJlbnQuZXhwYW5kZWRSb3dzW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0uaXNFeHBhbmQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucy5jc3NDbGFzcyA9IGNzc0NsYXNzO1xuICAgICAgICBvcHRpb25zLmlzQWx0Um93ID0gdGhpcy5wYXJlbnQuZW5hYmxlQWx0Um93ID8gaW5kZXggJSAyICE9PSAwIDogZmFsc2U7XG4gICAgICAgIG9wdGlvbnMuaXNBbHRSb3cgPSB0aGlzLnBhcmVudC5lbmFibGVBbHRSb3cgPyBpbmRleCAlIDIgIT09IDAgOiBmYWxzZTtcbiAgICAgICAgb3B0aW9ucy5pc1NlbGVjdGVkID0gdGhpcy5wYXJlbnQuZ2V0U2VsZWN0ZWRSb3dJbmRleGVzKCkuaW5kZXhPZihpbmRleCkgPiAtMTtcbiAgICAgICAgdGhpcy5yZWZyZXNoRm9yZWlnbktleVJvdyhvcHRpb25zKTtcbiAgICAgICAgdmFyIGNlbGxzID0gdGhpcy5lbnN1cmVDb2x1bW5zKCk7XG4gICAgICAgIHZhciByb3cgPSBuZXcgUm93KG9wdGlvbnMsIHRoaXMucGFyZW50KTtcbiAgICAgICAgcm93LmNlbGxzID0gdGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSAnUmlnaHQnID8gdGhpcy5nZW5lcmF0ZUNlbGxzKG9wdGlvbnMpLmNvbmNhdChjZWxscylcbiAgICAgICAgICAgIDogY2VsbHMuY29uY2F0KHRoaXMuZ2VuZXJhdGVDZWxscyhvcHRpb25zKSk7XG4gICAgICAgIHJldHVybiByb3c7XG4gICAgfTtcbiAgICBSb3dNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUucmVmcmVzaEZvcmVpZ25LZXlSb3cgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICB2YXIgZm9yZWlnbktleUNvbHVtbnMgPSB0aGlzLnBhcmVudC5nZXRGb3JlaWduS2V5Q29sdW1ucygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZvcmVpZ25LZXlDb2x1bW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzZXRWYWx1ZShmb3JlaWduS2V5Q29sdW1uc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uZmllbGQsIGdldEZvcmVpZ25EYXRhKGZvcmVpZ25LZXlDb2x1bW5zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgb3B0aW9ucy5kYXRhKSwgb3B0aW9ucy5mb3JlaWduS2V5RGF0YSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJvd01vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5nZW5lcmF0ZUNlbGxzID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIGR1bW1pZXMgPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCk7XG4gICAgICAgIHZhciB0bXAgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkdW1taWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0bXAucHVzaCh0aGlzLmdlbmVyYXRlQ2VsbChkdW1taWVzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgb3B0aW9ucy51aWQsIGlzTnVsbE9yVW5kZWZpbmVkKGR1bW1pZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbW1hbmRzKSA/IHVuZGVmaW5lZCA6IENlbGxUeXBlLkNvbW1hbmRDb2x1bW4sIG51bGwsIGksIG9wdGlvbnMuZm9yZWlnbktleURhdGEpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG1wO1xuICAgIH07XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0NvbHVtbn0gY29sdW1uIC0gRGVmaW5lcyBjb2x1bW4gZGV0YWlsc1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByb3dJZCAtIERlZmluZXMgcm93IGlkXG4gICAgICogQHBhcmFtIHtDZWxsVHlwZX0gY2VsbFR5cGUgIC0gRGVmaW5lcyBjZWxsIHR5cGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY29sU3BhbiAtIERlZmluZXMgY29sU3BhblxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvSW5kZXggLSBEZWZpbmVzIGluZGV4XG4gICAgICogQHBhcmFtIHtPYmplY3R9IGZvcmVpZ25LZXlEYXRhIC0gRGVmaW5lcyBmb3JlaWduIGtleSBkYXRhXG4gICAgICogQHJldHVybnMge0NlbGw8Q29sdW1uPn0gcmV0dXJucyBjZWxsIG1vZGVsXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFJvd01vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5nZW5lcmF0ZUNlbGwgPSBmdW5jdGlvbiAoY29sdW1uLCByb3dJZCwgY2VsbFR5cGUsIGNvbFNwYW4sIG9JbmRleCwgZm9yZWlnbktleURhdGEpIHtcbiAgICAgICAgdmFyIG9wdCA9IHtcbiAgICAgICAgICAgICd2aXNpYmxlJzogY29sdW1uLnZpc2libGUsXG4gICAgICAgICAgICAnaXNEYXRhQ2VsbCc6ICFpc051bGxPclVuZGVmaW5lZChjb2x1bW4uZmllbGQgfHwgY29sdW1uLnRlbXBsYXRlKSxcbiAgICAgICAgICAgICdpc1RlbXBsYXRlJzogIWlzTnVsbE9yVW5kZWZpbmVkKGNvbHVtbi50ZW1wbGF0ZSksXG4gICAgICAgICAgICAncm93SUQnOiByb3dJZCxcbiAgICAgICAgICAgICdjb2x1bW4nOiBjb2x1bW4sXG4gICAgICAgICAgICAnY2VsbFR5cGUnOiAhaXNOdWxsT3JVbmRlZmluZWQoY2VsbFR5cGUpID8gY2VsbFR5cGUgOiBDZWxsVHlwZS5EYXRhLFxuICAgICAgICAgICAgJ2NvbFNwYW4nOiBjb2xTcGFuLFxuICAgICAgICAgICAgJ2NvbW1hbmRzJzogY29sdW1uLmNvbW1hbmRzLFxuICAgICAgICAgICAgJ2lzRm9yZWlnbktleSc6IGNvbHVtbi5pc0ZvcmVpZ25Db2x1bW4gJiYgY29sdW1uLmlzRm9yZWlnbkNvbHVtbigpLFxuICAgICAgICAgICAgJ2ZvcmVpZ25LZXlEYXRhJzogY29sdW1uLmlzRm9yZWlnbkNvbHVtbiAmJiBjb2x1bW4uaXNGb3JlaWduQ29sdW1uKCkgJiYgZ2V0VmFsdWUoY29sdW1uLmZpZWxkLCBmb3JlaWduS2V5RGF0YSlcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG9wdC5pc0RhdGFDZWxsIHx8IG9wdC5jb2x1bW4udHlwZSA9PT0gJ2NoZWNrYm94JyB8fCBvcHQuY29tbWFuZHMpIHtcbiAgICAgICAgICAgIG9wdC5pbmRleCA9IG9JbmRleDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IENlbGwob3B0KTtcbiAgICB9O1xuICAgIFJvd01vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5yZWZyZXNoUm93cyA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hGb3JlaWduS2V5Um93KGlucHV0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSk7XG4gICAgICAgICAgICBpbnB1dFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2VsbHMgPSB0aGlzLmdlbmVyYXRlQ2VsbHMoaW5wdXRbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfTtcbiAgICBSb3dNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2V0SW5maW5pdGVJbmRleCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHJldHVybiBhcmdzLnJlcXVlc3RUeXBlID09PSAnaW5maW5pdGVTY3JvbGwnIHx8IGFyZ3MucmVxdWVzdFR5cGUgPT09ICdkZWxldGUnIHx8IGFyZ3MuYWN0aW9uID09PSAnYWRkJ1xuICAgICAgICAgICAgPyAoaXNOdWxsT3JVbmRlZmluZWQoYXJncy5zdGFydEluZGV4KSA/IGFyZ3NbJ2luZGV4J10gOiBhcmdzLnN0YXJ0SW5kZXgpIDogMDtcbiAgICB9O1xuICAgIHJldHVybiBSb3dNb2RlbEdlbmVyYXRvcjtcbn0oKSk7XG5leHBvcnQgeyBSb3dNb2RlbEdlbmVyYXRvciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/row-model-generator.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/service-locator.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/service-locator.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ServiceLocator: () => (/* binding */ ServiceLocator)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _renderer_responsive_dialog_renderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../renderer/responsive-dialog-renderer */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/renderer/responsive-dialog-renderer.js\");\n\n\n/**\n * ServiceLocator\n *\n * @hidden\n */\nvar ServiceLocator = /** @class */ (function () {\n    function ServiceLocator() {\n        this.services = {};\n    }\n    ServiceLocator.prototype.register = function (name, type) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.services[\"\" + name])) {\n            this.services[\"\" + name] = type;\n        }\n    };\n    ServiceLocator.prototype.getService = function (name) {\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.services[\"\" + name])) {\n            // eslint-disable-next-line no-throw-literal\n            throw \"The service \" + name + \" is not registered\";\n        }\n        return this.services[\"\" + name];\n    };\n    ServiceLocator.prototype.registerAdaptiveService = function (type, isAdaptiveUI, action) {\n        if (isAdaptiveUI) {\n            type.responsiveDialogRenderer = new _renderer_responsive_dialog_renderer__WEBPACK_IMPORTED_MODULE_1__.ResponsiveDialogRenderer(type.parent, type.serviceLocator);\n            type.responsiveDialogRenderer.action = action;\n        }\n        else {\n            if (type.responsiveDialogRenderer) {\n                type.responsiveDialogRenderer.removeEventListener();\n                type.responsiveDialogRenderer = undefined;\n            }\n        }\n    };\n    return ServiceLocator;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9zZXJ2aWNlLWxvY2F0b3IuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXlEO0FBQ3lCO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx1RUFBaUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHVFQUFpQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCwwRkFBd0I7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ3lCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvc2VydmljZXMvc2VydmljZS1sb2NhdG9yLmpzPzMwZjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBSZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIgfSBmcm9tICcuLi9yZW5kZXJlci9yZXNwb25zaXZlLWRpYWxvZy1yZW5kZXJlcic7XG4vKipcbiAqIFNlcnZpY2VMb2NhdG9yXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgU2VydmljZUxvY2F0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2VydmljZUxvY2F0b3IoKSB7XG4gICAgICAgIHRoaXMuc2VydmljZXMgPSB7fTtcbiAgICB9XG4gICAgU2VydmljZUxvY2F0b3IucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKG5hbWUsIHR5cGUpIHtcbiAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc2VydmljZXNbXCJcIiArIG5hbWVdKSkge1xuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlc1tcIlwiICsgbmFtZV0gPSB0eXBlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZXJ2aWNlTG9jYXRvci5wcm90b3R5cGUuZ2V0U2VydmljZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZCh0aGlzLnNlcnZpY2VzW1wiXCIgKyBuYW1lXSkpIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby10aHJvdy1saXRlcmFsXG4gICAgICAgICAgICB0aHJvdyBcIlRoZSBzZXJ2aWNlIFwiICsgbmFtZSArIFwiIGlzIG5vdCByZWdpc3RlcmVkXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZXNbXCJcIiArIG5hbWVdO1xuICAgIH07XG4gICAgU2VydmljZUxvY2F0b3IucHJvdG90eXBlLnJlZ2lzdGVyQWRhcHRpdmVTZXJ2aWNlID0gZnVuY3Rpb24gKHR5cGUsIGlzQWRhcHRpdmVVSSwgYWN0aW9uKSB7XG4gICAgICAgIGlmIChpc0FkYXB0aXZlVUkpIHtcbiAgICAgICAgICAgIHR5cGUucmVzcG9uc2l2ZURpYWxvZ1JlbmRlcmVyID0gbmV3IFJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlcih0eXBlLnBhcmVudCwgdHlwZS5zZXJ2aWNlTG9jYXRvcik7XG4gICAgICAgICAgICB0eXBlLnJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodHlwZS5yZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIpIHtcbiAgICAgICAgICAgICAgICB0eXBlLnJlc3BvbnNpdmVEaWFsb2dSZW5kZXJlci5yZW1vdmVFdmVudExpc3RlbmVyKCk7XG4gICAgICAgICAgICAgICAgdHlwZS5yZXNwb25zaXZlRGlhbG9nUmVuZGVyZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBTZXJ2aWNlTG9jYXRvcjtcbn0oKSk7XG5leHBvcnQgeyBTZXJ2aWNlTG9jYXRvciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/service-locator.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/summary-model-generator.js":
/*!******************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/summary-model-generator.js ***!
  \******************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CaptionSummaryModelGenerator: () => (/* binding */ CaptionSummaryModelGenerator),\n/* harmony export */   GroupSummaryModelGenerator: () => (/* binding */ GroupSummaryModelGenerator),\n/* harmony export */   SummaryModelGenerator: () => (/* binding */ SummaryModelGenerator)\n/* harmony export */ });\n/* harmony import */ var _models_row__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../models/row */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/row.js\");\n/* harmony import */ var _models_column__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../models/column */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column.js\");\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_enum__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/enum */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/enum.js\");\n/* harmony import */ var _models_cell__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../models/cell */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/cell.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n/**\n * Summary row model generator\n *\n * @hidden\n */\nvar SummaryModelGenerator = /** @class */ (function () {\n    /**\n     * Constructor for Summary row model generator\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     */\n    function SummaryModelGenerator(parent) {\n        this.parent = parent;\n    }\n    SummaryModelGenerator.prototype.getData = function () {\n        var _this = this;\n        var rows = [];\n        var row = this.parent.aggregates.slice();\n        for (var i = 0; i < row.length; i++) {\n            var columns = row[parseInt(i.toString(), 10)].columns.filter(function (column) {\n                return !(column.footerTemplate || column.groupFooterTemplate || column.groupCaptionTemplate)\n                    || _this.columnSelector(column);\n            });\n            if (columns.length) {\n                rows.push({ columns: columns });\n            }\n        }\n        return rows;\n    };\n    SummaryModelGenerator.prototype.columnSelector = function (column) {\n        return column.footerTemplate !== undefined;\n    };\n    SummaryModelGenerator.prototype.getColumns = function (start) {\n        var columns = [];\n        if (this.parent.detailTemplate || !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.childGrid)) {\n            columns.push(new _models_column__WEBPACK_IMPORTED_MODULE_1__.Column({}));\n        }\n        if (this.parent.allowGrouping) {\n            for (var i = 0; i < this.parent.groupSettings.columns.length; i++) {\n                columns.push(new _models_column__WEBPACK_IMPORTED_MODULE_1__.Column({}));\n            }\n        }\n        if (this.parent.isRowDragable() && !start) {\n            columns.push(new _models_column__WEBPACK_IMPORTED_MODULE_1__.Column({}));\n        }\n        columns.push.apply(columns, this.parent.getColumns());\n        return columns;\n    };\n    SummaryModelGenerator.prototype.generateRows = function (input, args, start, end, columns) {\n        if (input.length === 0) {\n            if (args === undefined || !(args.count || args.loadSummaryOnEmpty)) {\n                return [];\n            }\n        }\n        var data = this.buildSummaryData(input, args);\n        var rows = [];\n        var row = this.getData();\n        for (var i = 0; i < row.length; i++) {\n            rows.push(this.getGeneratedRow(row[parseInt(i.toString(), 10)], data[parseInt(i.toString(), 10)], args ? args.level : undefined, start, end, args ? args.parentUid : undefined, columns));\n        }\n        return rows;\n    };\n    SummaryModelGenerator.prototype.getGeneratedRow = function (summaryRow, data, raw, start, end, parentUid, columns) {\n        var tmp = [];\n        var indents = this.getIndentByLevel();\n        var isDetailGridAlone = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.childGrid);\n        var indentLength = this.parent.getIndentCount();\n        if (this.parent.groupSettings.columns.length && this.parent.allowRowDragAndDrop) {\n            indents.push('e-indentcelltop');\n        }\n        else if (this.parent.isRowDragable() && !start) {\n            indents = ['e-indentcelltop'];\n        }\n        var values = columns ? columns : this.getColumns(start);\n        for (var i = 0; i < values.length; i++) {\n            tmp.push(this.getGeneratedCell(values[parseInt(i.toString(), 10)], summaryRow, i >= indentLength ? this.getCellType() :\n                i === 0 && this.parent.childGrid ? _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.DetailFooterIntent : _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Indent, indents[parseInt(i.toString(), 10)], isDetailGridAlone));\n        }\n        var row = new _models_row__WEBPACK_IMPORTED_MODULE_3__.Row({ data: data, attributes: { class: 'e-summaryrow' } });\n        row.cells = tmp;\n        row.uid = (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.getUid)('grid-row');\n        row.parentUid = parentUid;\n        row.isAggregateRow = true;\n        row.visible = tmp.some(function (cell) { return cell.isDataCell && cell.visible; });\n        return row;\n    };\n    SummaryModelGenerator.prototype.getGeneratedCell = function (column, summaryRow, cellType, indent, isDetailGridAlone) {\n        //Get the summary column by display\n        var sColumn = summaryRow.columns.filter(function (scolumn) { return scolumn.columnName === column.field; })[0];\n        var attrs = {\n            'e-mappinguid': column.uid, index: column.index\n        };\n        if (column.textAlign) {\n            var alignmentClassMap = { right: 'e-rightalign', left: 'e-leftalign', center: 'e-centeralign', justify: 'e-justifyalign' };\n            if (alignmentClassMap[column.textAlign.toLowerCase()]) {\n                attrs.class = alignmentClassMap[column.textAlign.toLowerCase()];\n            }\n        }\n        if (indent) {\n            attrs.class = indent;\n        }\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(indent) && isDetailGridAlone) {\n            attrs.class = 'e-detailindentcelltop';\n        }\n        var opt = {\n            'visible': column.visible,\n            'isDataCell': !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(sColumn),\n            'isTemplate': sColumn && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(sColumn.footerTemplate\n                || sColumn.groupFooterTemplate || sColumn.groupCaptionTemplate),\n            'column': sColumn || {},\n            'attributes': attrs,\n            'cellType': cellType\n        };\n        opt.column.headerText = column.headerText;\n        return new _models_cell__WEBPACK_IMPORTED_MODULE_5__.Cell(opt);\n    };\n    SummaryModelGenerator.prototype.buildSummaryData = function (data, args) {\n        var dummy = [];\n        var summaryRows = this.getData();\n        var single = {};\n        for (var i = 0; i < summaryRows.length; i++) {\n            single = {};\n            var column = summaryRows[parseInt(i.toString(), 10)].columns;\n            for (var j = 0; j < column.length; j++) {\n                single = this.setTemplate(column[parseInt(j.toString(), 10)], (args && args.aggregates) ? args : data, single);\n            }\n            dummy.push(single);\n        }\n        return dummy;\n    };\n    SummaryModelGenerator.prototype.getIndentByLevel = function () {\n        return this.parent.groupSettings.columns.map(function () { return 'e-indentcelltop'; });\n    };\n    SummaryModelGenerator.prototype.setTemplate = function (column, data, single) {\n        var types = column.type;\n        var helper = {};\n        var formatFn = column.getFormatter() || (function () { return function (a) { return a; }; })();\n        var group = data;\n        if (!(types instanceof Array)) {\n            types = [column.type];\n        }\n        for (var i = 0; i < types.length; i++) {\n            var key = column.field + ' - ' + types[parseInt(i.toString(), 10)].toLowerCase();\n            var disp = column.columnName;\n            var disablePageWiseAggregatesGroup = this.parent.groupSettings.disablePageWiseAggregates\n                && this.parent.groupSettings.columns.length && group.items ? true : false;\n            var val = (types[parseInt(i.toString(), 10)] !== 'Custom' || disablePageWiseAggregatesGroup) && group.aggregates\n                && key in group.aggregates ? group.aggregates[\"\" + key] :\n                (0,_base_util__WEBPACK_IMPORTED_MODULE_4__.calculateAggregate)(types[parseInt(i.toString(), 10)], group.aggregates ? group : data, column, this.parent);\n            single[\"\" + disp] = single[\"\" + disp] || {};\n            single[\"\" + disp][\"\" + key] = val;\n            single[\"\" + disp][types[parseInt(i.toString(), 10)]] = !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(val) ? formatFn(val) : ' ';\n            if (group.field) {\n                single[\"\" + disp].field = group.field;\n                single[\"\" + disp].key = group.key;\n            }\n        }\n        helper.format = column.getFormatter();\n        column.setTemplate(helper);\n        return single;\n    };\n    SummaryModelGenerator.prototype.getCellType = function () {\n        return _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.Summary;\n    };\n    return SummaryModelGenerator;\n}());\n\nvar GroupSummaryModelGenerator = /** @class */ (function (_super) {\n    __extends(GroupSummaryModelGenerator, _super);\n    function GroupSummaryModelGenerator() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    GroupSummaryModelGenerator.prototype.columnSelector = function (column) {\n        return column.groupFooterTemplate !== undefined;\n    };\n    GroupSummaryModelGenerator.prototype.getIndentByLevel = function (level) {\n        if (level === void 0) { level = this.parent.groupSettings.columns.length; }\n        if (this.parent.allowRowDragAndDrop && this.parent.groupSettings.columns.length) {\n            level -= 1;\n        }\n        return this.parent.groupSettings.columns.map(function (v, indx) { return indx <= level - 1 ? '' : 'e-indentcelltop'; });\n    };\n    GroupSummaryModelGenerator.prototype.getCellType = function () {\n        return _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.GroupSummary;\n    };\n    return GroupSummaryModelGenerator;\n}(SummaryModelGenerator));\n\nvar CaptionSummaryModelGenerator = /** @class */ (function (_super) {\n    __extends(CaptionSummaryModelGenerator, _super);\n    function CaptionSummaryModelGenerator() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    CaptionSummaryModelGenerator.prototype.columnSelector = function (column) {\n        return column.groupCaptionTemplate !== undefined;\n    };\n    CaptionSummaryModelGenerator.prototype.getData = function () {\n        var initVal = { columns: [] };\n        return [_super.prototype.getData.call(this).reduce(function (prev, cur) {\n                prev.columns = prev.columns.concat(cur.columns);\n                return prev;\n            }, initVal)];\n    };\n    CaptionSummaryModelGenerator.prototype.isEmpty = function () {\n        return (this.getData()[0].columns || []).length === 0;\n    };\n    CaptionSummaryModelGenerator.prototype.getCellType = function () {\n        return _base_enum__WEBPACK_IMPORTED_MODULE_2__.CellType.CaptionSummary;\n    };\n    return CaptionSummaryModelGenerator;\n}(SummaryModelGenerator));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy9zdW1tYXJ5LW1vZGVsLWdlbmVyYXRvci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ21DO0FBQ007QUFDZTtBQUNDO0FBQ2xCO0FBQ0Y7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0JBQWdCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLDRCQUE0QixrQkFBa0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLHVFQUFpQjtBQUM1RCw2QkFBNkIsa0RBQU0sR0FBRztBQUN0QztBQUNBO0FBQ0EsNEJBQTRCLDhDQUE4QztBQUMxRSxpQ0FBaUMsa0RBQU0sR0FBRztBQUMxQztBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsa0RBQU0sR0FBRztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnQkFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsdUVBQWlCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsbUJBQW1CO0FBQzNDO0FBQ0EsbURBQW1ELGdEQUFRLHNCQUFzQixnREFBUTtBQUN6RjtBQUNBLHNCQUFzQiw0Q0FBRyxHQUFHLDBCQUEwQix5QkFBeUI7QUFDL0U7QUFDQSxrQkFBa0Isa0RBQU07QUFDeEI7QUFDQTtBQUNBLGlEQUFpRCx5Q0FBeUM7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUUsNkNBQTZDO0FBQ2xIO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx1RUFBaUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsdUVBQWlCO0FBQzVDLHNDQUFzQyx1RUFBaUI7QUFDdkQ7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsOENBQUk7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3QkFBd0I7QUFDaEQ7QUFDQTtBQUNBLDRCQUE0QixtQkFBbUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtRUFBbUUsMkJBQTJCO0FBQzlGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStELHNCQUFzQixjQUFjO0FBQ25HO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsOERBQWtCO0FBQ2xDO0FBQ0E7QUFDQSxvRUFBb0UsdUVBQWlCO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnREFBUTtBQUN2QjtBQUNBO0FBQ0EsQ0FBQztBQUNnQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsMEVBQTBFLG9EQUFvRDtBQUM5SDtBQUNBO0FBQ0EsZUFBZSxnREFBUTtBQUN2QjtBQUNBO0FBQ0EsQ0FBQztBQUNxQztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGdEQUFRO0FBQ3ZCO0FBQ0E7QUFDQSxDQUFDO0FBQ3VDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvc2VydmljZXMvc3VtbWFyeS1tb2RlbC1nZW5lcmF0b3IuanM/ZGE4YSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbmltcG9ydCB7IFJvdyB9IGZyb20gJy4uL21vZGVscy9yb3cnO1xuaW1wb3J0IHsgQ29sdW1uIH0gZnJvbSAnLi4vbW9kZWxzL2NvbHVtbic7XG5pbXBvcnQgeyBpc051bGxPclVuZGVmaW5lZCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IGNhbGN1bGF0ZUFnZ3JlZ2F0ZSwgZ2V0VWlkIH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbmltcG9ydCB7IENlbGxUeXBlIH0gZnJvbSAnLi4vYmFzZS9lbnVtJztcbmltcG9ydCB7IENlbGwgfSBmcm9tICcuLi9tb2RlbHMvY2VsbCc7XG4vKipcbiAqIFN1bW1hcnkgcm93IG1vZGVsIGdlbmVyYXRvclxuICpcbiAqIEBoaWRkZW5cbiAqL1xudmFyIFN1bW1hcnlNb2RlbEdlbmVyYXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvciBmb3IgU3VtbWFyeSByb3cgbW9kZWwgZ2VuZXJhdG9yXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0lHcmlkfSBwYXJlbnQgLSBzcGVjaWZpZXMgdGhlIElHcmlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gU3VtbWFyeU1vZGVsR2VuZXJhdG9yKHBhcmVudCkge1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICB9XG4gICAgU3VtbWFyeU1vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5nZXREYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgcm93cyA9IFtdO1xuICAgICAgICB2YXIgcm93ID0gdGhpcy5wYXJlbnQuYWdncmVnYXRlcy5zbGljZSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvdy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNvbHVtbnMgPSByb3dbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNvbHVtbnMuZmlsdGVyKGZ1bmN0aW9uIChjb2x1bW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gIShjb2x1bW4uZm9vdGVyVGVtcGxhdGUgfHwgY29sdW1uLmdyb3VwRm9vdGVyVGVtcGxhdGUgfHwgY29sdW1uLmdyb3VwQ2FwdGlvblRlbXBsYXRlKVxuICAgICAgICAgICAgICAgICAgICB8fCBfdGhpcy5jb2x1bW5TZWxlY3Rvcihjb2x1bW4pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByb3dzLnB1c2goeyBjb2x1bW5zOiBjb2x1bW5zIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByb3dzO1xuICAgIH07XG4gICAgU3VtbWFyeU1vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5jb2x1bW5TZWxlY3RvciA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcbiAgICAgICAgcmV0dXJuIGNvbHVtbi5mb290ZXJUZW1wbGF0ZSAhPT0gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgU3VtbWFyeU1vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5nZXRDb2x1bW5zID0gZnVuY3Rpb24gKHN0YXJ0KSB7XG4gICAgICAgIHZhciBjb2x1bW5zID0gW107XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5kZXRhaWxUZW1wbGF0ZSB8fCAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuY2hpbGRHcmlkKSkge1xuICAgICAgICAgICAgY29sdW1ucy5wdXNoKG5ldyBDb2x1bW4oe30pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dHcm91cGluZykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5zLnB1c2gobmV3IENvbHVtbih7fSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc1Jvd0RyYWdhYmxlKCkgJiYgIXN0YXJ0KSB7XG4gICAgICAgICAgICBjb2x1bW5zLnB1c2gobmV3IENvbHVtbih7fSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbHVtbnMucHVzaC5hcHBseShjb2x1bW5zLCB0aGlzLnBhcmVudC5nZXRDb2x1bW5zKCkpO1xuICAgICAgICByZXR1cm4gY29sdW1ucztcbiAgICB9O1xuICAgIFN1bW1hcnlNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2VuZXJhdGVSb3dzID0gZnVuY3Rpb24gKGlucHV0LCBhcmdzLCBzdGFydCwgZW5kLCBjb2x1bW5zKSB7XG4gICAgICAgIGlmIChpbnB1dC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGlmIChhcmdzID09PSB1bmRlZmluZWQgfHwgIShhcmdzLmNvdW50IHx8IGFyZ3MubG9hZFN1bW1hcnlPbkVtcHR5KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IHRoaXMuYnVpbGRTdW1tYXJ5RGF0YShpbnB1dCwgYXJncyk7XG4gICAgICAgIHZhciByb3dzID0gW107XG4gICAgICAgIHZhciByb3cgPSB0aGlzLmdldERhdGEoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByb3cubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJvd3MucHVzaCh0aGlzLmdldEdlbmVyYXRlZFJvdyhyb3dbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBkYXRhW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgYXJncyA/IGFyZ3MubGV2ZWwgOiB1bmRlZmluZWQsIHN0YXJ0LCBlbmQsIGFyZ3MgPyBhcmdzLnBhcmVudFVpZCA6IHVuZGVmaW5lZCwgY29sdW1ucykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByb3dzO1xuICAgIH07XG4gICAgU3VtbWFyeU1vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5nZXRHZW5lcmF0ZWRSb3cgPSBmdW5jdGlvbiAoc3VtbWFyeVJvdywgZGF0YSwgcmF3LCBzdGFydCwgZW5kLCBwYXJlbnRVaWQsIGNvbHVtbnMpIHtcbiAgICAgICAgdmFyIHRtcCA9IFtdO1xuICAgICAgICB2YXIgaW5kZW50cyA9IHRoaXMuZ2V0SW5kZW50QnlMZXZlbCgpO1xuICAgICAgICB2YXIgaXNEZXRhaWxHcmlkQWxvbmUgPSAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wYXJlbnQuY2hpbGRHcmlkKTtcbiAgICAgICAgdmFyIGluZGVudExlbmd0aCA9IHRoaXMucGFyZW50LmdldEluZGVudENvdW50KCk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICYmIHRoaXMucGFyZW50LmFsbG93Um93RHJhZ0FuZERyb3ApIHtcbiAgICAgICAgICAgIGluZGVudHMucHVzaCgnZS1pbmRlbnRjZWxsdG9wJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5wYXJlbnQuaXNSb3dEcmFnYWJsZSgpICYmICFzdGFydCkge1xuICAgICAgICAgICAgaW5kZW50cyA9IFsnZS1pbmRlbnRjZWxsdG9wJ107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZhbHVlcyA9IGNvbHVtbnMgPyBjb2x1bW5zIDogdGhpcy5nZXRDb2x1bW5zKHN0YXJ0KTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRtcC5wdXNoKHRoaXMuZ2V0R2VuZXJhdGVkQ2VsbCh2YWx1ZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBzdW1tYXJ5Um93LCBpID49IGluZGVudExlbmd0aCA/IHRoaXMuZ2V0Q2VsbFR5cGUoKSA6XG4gICAgICAgICAgICAgICAgaSA9PT0gMCAmJiB0aGlzLnBhcmVudC5jaGlsZEdyaWQgPyBDZWxsVHlwZS5EZXRhaWxGb290ZXJJbnRlbnQgOiBDZWxsVHlwZS5JbmRlbnQsIGluZGVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLCBpc0RldGFpbEdyaWRBbG9uZSkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb3cgPSBuZXcgUm93KHsgZGF0YTogZGF0YSwgYXR0cmlidXRlczogeyBjbGFzczogJ2Utc3VtbWFyeXJvdycgfSB9KTtcbiAgICAgICAgcm93LmNlbGxzID0gdG1wO1xuICAgICAgICByb3cudWlkID0gZ2V0VWlkKCdncmlkLXJvdycpO1xuICAgICAgICByb3cucGFyZW50VWlkID0gcGFyZW50VWlkO1xuICAgICAgICByb3cuaXNBZ2dyZWdhdGVSb3cgPSB0cnVlO1xuICAgICAgICByb3cudmlzaWJsZSA9IHRtcC5zb21lKGZ1bmN0aW9uIChjZWxsKSB7IHJldHVybiBjZWxsLmlzRGF0YUNlbGwgJiYgY2VsbC52aXNpYmxlOyB9KTtcbiAgICAgICAgcmV0dXJuIHJvdztcbiAgICB9O1xuICAgIFN1bW1hcnlNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2V0R2VuZXJhdGVkQ2VsbCA9IGZ1bmN0aW9uIChjb2x1bW4sIHN1bW1hcnlSb3csIGNlbGxUeXBlLCBpbmRlbnQsIGlzRGV0YWlsR3JpZEFsb25lKSB7XG4gICAgICAgIC8vR2V0IHRoZSBzdW1tYXJ5IGNvbHVtbiBieSBkaXNwbGF5XG4gICAgICAgIHZhciBzQ29sdW1uID0gc3VtbWFyeVJvdy5jb2x1bW5zLmZpbHRlcihmdW5jdGlvbiAoc2NvbHVtbikgeyByZXR1cm4gc2NvbHVtbi5jb2x1bW5OYW1lID09PSBjb2x1bW4uZmllbGQ7IH0pWzBdO1xuICAgICAgICB2YXIgYXR0cnMgPSB7XG4gICAgICAgICAgICAnZS1tYXBwaW5ndWlkJzogY29sdW1uLnVpZCwgaW5kZXg6IGNvbHVtbi5pbmRleFxuICAgICAgICB9O1xuICAgICAgICBpZiAoY29sdW1uLnRleHRBbGlnbikge1xuICAgICAgICAgICAgdmFyIGFsaWdubWVudENsYXNzTWFwID0geyByaWdodDogJ2UtcmlnaHRhbGlnbicsIGxlZnQ6ICdlLWxlZnRhbGlnbicsIGNlbnRlcjogJ2UtY2VudGVyYWxpZ24nLCBqdXN0aWZ5OiAnZS1qdXN0aWZ5YWxpZ24nIH07XG4gICAgICAgICAgICBpZiAoYWxpZ25tZW50Q2xhc3NNYXBbY29sdW1uLnRleHRBbGlnbi50b0xvd2VyQ2FzZSgpXSkge1xuICAgICAgICAgICAgICAgIGF0dHJzLmNsYXNzID0gYWxpZ25tZW50Q2xhc3NNYXBbY29sdW1uLnRleHRBbGlnbi50b0xvd2VyQ2FzZSgpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5kZW50KSB7XG4gICAgICAgICAgICBhdHRycy5jbGFzcyA9IGluZGVudDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoaW5kZW50KSAmJiBpc0RldGFpbEdyaWRBbG9uZSkge1xuICAgICAgICAgICAgYXR0cnMuY2xhc3MgPSAnZS1kZXRhaWxpbmRlbnRjZWxsdG9wJztcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3B0ID0ge1xuICAgICAgICAgICAgJ3Zpc2libGUnOiBjb2x1bW4udmlzaWJsZSxcbiAgICAgICAgICAgICdpc0RhdGFDZWxsJzogIWlzTnVsbE9yVW5kZWZpbmVkKHNDb2x1bW4pLFxuICAgICAgICAgICAgJ2lzVGVtcGxhdGUnOiBzQ29sdW1uICYmICFpc051bGxPclVuZGVmaW5lZChzQ29sdW1uLmZvb3RlclRlbXBsYXRlXG4gICAgICAgICAgICAgICAgfHwgc0NvbHVtbi5ncm91cEZvb3RlclRlbXBsYXRlIHx8IHNDb2x1bW4uZ3JvdXBDYXB0aW9uVGVtcGxhdGUpLFxuICAgICAgICAgICAgJ2NvbHVtbic6IHNDb2x1bW4gfHwge30sXG4gICAgICAgICAgICAnYXR0cmlidXRlcyc6IGF0dHJzLFxuICAgICAgICAgICAgJ2NlbGxUeXBlJzogY2VsbFR5cGVcbiAgICAgICAgfTtcbiAgICAgICAgb3B0LmNvbHVtbi5oZWFkZXJUZXh0ID0gY29sdW1uLmhlYWRlclRleHQ7XG4gICAgICAgIHJldHVybiBuZXcgQ2VsbChvcHQpO1xuICAgIH07XG4gICAgU3VtbWFyeU1vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5idWlsZFN1bW1hcnlEYXRhID0gZnVuY3Rpb24gKGRhdGEsIGFyZ3MpIHtcbiAgICAgICAgdmFyIGR1bW15ID0gW107XG4gICAgICAgIHZhciBzdW1tYXJ5Um93cyA9IHRoaXMuZ2V0RGF0YSgpO1xuICAgICAgICB2YXIgc2luZ2xlID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3VtbWFyeVJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHNpbmdsZSA9IHt9O1xuICAgICAgICAgICAgdmFyIGNvbHVtbiA9IHN1bW1hcnlSb3dzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5jb2x1bW5zO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjb2x1bW4ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBzaW5nbGUgPSB0aGlzLnNldFRlbXBsYXRlKGNvbHVtbltwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0sIChhcmdzICYmIGFyZ3MuYWdncmVnYXRlcykgPyBhcmdzIDogZGF0YSwgc2luZ2xlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGR1bW15LnB1c2goc2luZ2xlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZHVtbXk7XG4gICAgfTtcbiAgICBTdW1tYXJ5TW9kZWxHZW5lcmF0b3IucHJvdG90eXBlLmdldEluZGVudEJ5TGV2ZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubWFwKGZ1bmN0aW9uICgpIHsgcmV0dXJuICdlLWluZGVudGNlbGx0b3AnOyB9KTtcbiAgICB9O1xuICAgIFN1bW1hcnlNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuc2V0VGVtcGxhdGUgPSBmdW5jdGlvbiAoY29sdW1uLCBkYXRhLCBzaW5nbGUpIHtcbiAgICAgICAgdmFyIHR5cGVzID0gY29sdW1uLnR5cGU7XG4gICAgICAgIHZhciBoZWxwZXIgPSB7fTtcbiAgICAgICAgdmFyIGZvcm1hdEZuID0gY29sdW1uLmdldEZvcm1hdHRlcigpIHx8IChmdW5jdGlvbiAoKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYTsgfTsgfSkoKTtcbiAgICAgICAgdmFyIGdyb3VwID0gZGF0YTtcbiAgICAgICAgaWYgKCEodHlwZXMgaW5zdGFuY2VvZiBBcnJheSkpIHtcbiAgICAgICAgICAgIHR5cGVzID0gW2NvbHVtbi50eXBlXTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR5cGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gY29sdW1uLmZpZWxkICsgJyAtICcgKyB0eXBlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHZhciBkaXNwID0gY29sdW1uLmNvbHVtbk5hbWU7XG4gICAgICAgICAgICB2YXIgZGlzYWJsZVBhZ2VXaXNlQWdncmVnYXRlc0dyb3VwID0gdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5kaXNhYmxlUGFnZVdpc2VBZ2dyZWdhdGVzXG4gICAgICAgICAgICAgICAgJiYgdGhpcy5wYXJlbnQuZ3JvdXBTZXR0aW5ncy5jb2x1bW5zLmxlbmd0aCAmJiBncm91cC5pdGVtcyA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIHZhciB2YWwgPSAodHlwZXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldICE9PSAnQ3VzdG9tJyB8fCBkaXNhYmxlUGFnZVdpc2VBZ2dyZWdhdGVzR3JvdXApICYmIGdyb3VwLmFnZ3JlZ2F0ZXNcbiAgICAgICAgICAgICAgICAmJiBrZXkgaW4gZ3JvdXAuYWdncmVnYXRlcyA/IGdyb3VwLmFnZ3JlZ2F0ZXNbXCJcIiArIGtleV0gOlxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZUFnZ3JlZ2F0ZSh0eXBlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0sIGdyb3VwLmFnZ3JlZ2F0ZXMgPyBncm91cCA6IGRhdGEsIGNvbHVtbiwgdGhpcy5wYXJlbnQpO1xuICAgICAgICAgICAgc2luZ2xlW1wiXCIgKyBkaXNwXSA9IHNpbmdsZVtcIlwiICsgZGlzcF0gfHwge307XG4gICAgICAgICAgICBzaW5nbGVbXCJcIiArIGRpc3BdW1wiXCIgKyBrZXldID0gdmFsO1xuICAgICAgICAgICAgc2luZ2xlW1wiXCIgKyBkaXNwXVt0eXBlc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV1dID0gIWlzTnVsbE9yVW5kZWZpbmVkKHZhbCkgPyBmb3JtYXRGbih2YWwpIDogJyAnO1xuICAgICAgICAgICAgaWYgKGdyb3VwLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgc2luZ2xlW1wiXCIgKyBkaXNwXS5maWVsZCA9IGdyb3VwLmZpZWxkO1xuICAgICAgICAgICAgICAgIHNpbmdsZVtcIlwiICsgZGlzcF0ua2V5ID0gZ3JvdXAua2V5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGhlbHBlci5mb3JtYXQgPSBjb2x1bW4uZ2V0Rm9ybWF0dGVyKCk7XG4gICAgICAgIGNvbHVtbi5zZXRUZW1wbGF0ZShoZWxwZXIpO1xuICAgICAgICByZXR1cm4gc2luZ2xlO1xuICAgIH07XG4gICAgU3VtbWFyeU1vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5nZXRDZWxsVHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIENlbGxUeXBlLlN1bW1hcnk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VtbWFyeU1vZGVsR2VuZXJhdG9yO1xufSgpKTtcbmV4cG9ydCB7IFN1bW1hcnlNb2RlbEdlbmVyYXRvciB9O1xudmFyIEdyb3VwU3VtbWFyeU1vZGVsR2VuZXJhdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhHcm91cFN1bW1hcnlNb2RlbEdlbmVyYXRvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBHcm91cFN1bW1hcnlNb2RlbEdlbmVyYXRvcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBHcm91cFN1bW1hcnlNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuY29sdW1uU2VsZWN0b3IgPSBmdW5jdGlvbiAoY29sdW1uKSB7XG4gICAgICAgIHJldHVybiBjb2x1bW4uZ3JvdXBGb290ZXJUZW1wbGF0ZSAhPT0gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgR3JvdXBTdW1tYXJ5TW9kZWxHZW5lcmF0b3IucHJvdG90eXBlLmdldEluZGVudEJ5TGV2ZWwgPSBmdW5jdGlvbiAobGV2ZWwpIHtcbiAgICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsgbGV2ZWwgPSB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoOyB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd1Jvd0RyYWdBbmREcm9wICYmIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxldmVsIC09IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5tYXAoZnVuY3Rpb24gKHYsIGluZHgpIHsgcmV0dXJuIGluZHggPD0gbGV2ZWwgLSAxID8gJycgOiAnZS1pbmRlbnRjZWxsdG9wJzsgfSk7XG4gICAgfTtcbiAgICBHcm91cFN1bW1hcnlNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuZ2V0Q2VsbFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBDZWxsVHlwZS5Hcm91cFN1bW1hcnk7XG4gICAgfTtcbiAgICByZXR1cm4gR3JvdXBTdW1tYXJ5TW9kZWxHZW5lcmF0b3I7XG59KFN1bW1hcnlNb2RlbEdlbmVyYXRvcikpO1xuZXhwb3J0IHsgR3JvdXBTdW1tYXJ5TW9kZWxHZW5lcmF0b3IgfTtcbnZhciBDYXB0aW9uU3VtbWFyeU1vZGVsR2VuZXJhdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDYXB0aW9uU3VtbWFyeU1vZGVsR2VuZXJhdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENhcHRpb25TdW1tYXJ5TW9kZWxHZW5lcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQ2FwdGlvblN1bW1hcnlNb2RlbEdlbmVyYXRvci5wcm90b3R5cGUuY29sdW1uU2VsZWN0b3IgPSBmdW5jdGlvbiAoY29sdW1uKSB7XG4gICAgICAgIHJldHVybiBjb2x1bW4uZ3JvdXBDYXB0aW9uVGVtcGxhdGUgIT09IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIENhcHRpb25TdW1tYXJ5TW9kZWxHZW5lcmF0b3IucHJvdG90eXBlLmdldERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbml0VmFsID0geyBjb2x1bW5zOiBbXSB9O1xuICAgICAgICByZXR1cm4gW19zdXBlci5wcm90b3R5cGUuZ2V0RGF0YS5jYWxsKHRoaXMpLnJlZHVjZShmdW5jdGlvbiAocHJldiwgY3VyKSB7XG4gICAgICAgICAgICAgICAgcHJldi5jb2x1bW5zID0gcHJldi5jb2x1bW5zLmNvbmNhdChjdXIuY29sdW1ucyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICAgICAgICB9LCBpbml0VmFsKV07XG4gICAgfTtcbiAgICBDYXB0aW9uU3VtbWFyeU1vZGVsR2VuZXJhdG9yLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuZ2V0RGF0YSgpWzBdLmNvbHVtbnMgfHwgW10pLmxlbmd0aCA9PT0gMDtcbiAgICB9O1xuICAgIENhcHRpb25TdW1tYXJ5TW9kZWxHZW5lcmF0b3IucHJvdG90eXBlLmdldENlbGxUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gQ2VsbFR5cGUuQ2FwdGlvblN1bW1hcnk7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FwdGlvblN1bW1hcnlNb2RlbEdlbmVyYXRvcjtcbn0oU3VtbWFyeU1vZGVsR2VuZXJhdG9yKSk7XG5leHBvcnQgeyBDYXB0aW9uU3VtbWFyeU1vZGVsR2VuZXJhdG9yIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/summary-model-generator.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/value-formatter.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/value-formatter.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ValueFormatter: () => (/* binding */ ValueFormatter)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n\n\n/**\n * ValueFormatter class to globalize the value.\n *\n * @hidden\n */\nvar ValueFormatter = /** @class */ (function () {\n    function ValueFormatter(cultureName) {\n        this.intl = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Internationalization();\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cultureName)) {\n            this.intl.culture = cultureName;\n        }\n    }\n    ValueFormatter.prototype.getFormatFunction = function (format) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(format) && (format.type === 'dateTime' || format.type === 'datetime' || format.type === 'date' || format.type === 'time')) {\n            return this.intl.getDateFormat(format);\n        }\n        else {\n            return this.intl.getNumberFormat(format);\n        }\n    };\n    ValueFormatter.prototype.getParserFunction = function (format) {\n        if (format.type) {\n            return this.intl.getDateParser(format);\n        }\n        else {\n            return this.intl.getNumberParser(format);\n        }\n    };\n    ValueFormatter.prototype.fromView = function (value, format, type) {\n        if ((type === 'date' || type === 'datetime' || type === 'number') && (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(format))) {\n            return format(value);\n        }\n        else {\n            return value;\n        }\n    };\n    ValueFormatter.prototype.toView = function (value, format) {\n        var result = value;\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(format) && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(value)) {\n            result = format(value);\n        }\n        return result;\n    };\n    ValueFormatter.prototype.setCulture = function (cultureName) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cultureName)) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.setCulture)(cultureName);\n        }\n    };\n    return ValueFormatter;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy92YWx1ZS1mb3JtYXR0ZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBeUQ7QUFDZTtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzRUFBb0I7QUFDNUMsYUFBYSx1RUFBaUI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLHVFQUFpQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrRUFBK0UsdUVBQWlCO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLHVFQUFpQixhQUFhLHVFQUFpQjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1RUFBaUI7QUFDOUIsWUFBWSxnRUFBVTtBQUN0QjtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ3lCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvc2VydmljZXMvdmFsdWUtZm9ybWF0dGVyLmpzPzVlMDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBJbnRlcm5hdGlvbmFsaXphdGlvbiwgc2V0Q3VsdHVyZSB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbi8qKlxuICogVmFsdWVGb3JtYXR0ZXIgY2xhc3MgdG8gZ2xvYmFsaXplIHRoZSB2YWx1ZS5cbiAqXG4gKiBAaGlkZGVuXG4gKi9cbnZhciBWYWx1ZUZvcm1hdHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBWYWx1ZUZvcm1hdHRlcihjdWx0dXJlTmFtZSkge1xuICAgICAgICB0aGlzLmludGwgPSBuZXcgSW50ZXJuYXRpb25hbGl6YXRpb24oKTtcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChjdWx0dXJlTmFtZSkpIHtcbiAgICAgICAgICAgIHRoaXMuaW50bC5jdWx0dXJlID0gY3VsdHVyZU5hbWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgVmFsdWVGb3JtYXR0ZXIucHJvdG90eXBlLmdldEZvcm1hdEZ1bmN0aW9uID0gZnVuY3Rpb24gKGZvcm1hdCkge1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGZvcm1hdCkgJiYgKGZvcm1hdC50eXBlID09PSAnZGF0ZVRpbWUnIHx8IGZvcm1hdC50eXBlID09PSAnZGF0ZXRpbWUnIHx8IGZvcm1hdC50eXBlID09PSAnZGF0ZScgfHwgZm9ybWF0LnR5cGUgPT09ICd0aW1lJykpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmludGwuZ2V0RGF0ZUZvcm1hdChmb3JtYXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW50bC5nZXROdW1iZXJGb3JtYXQoZm9ybWF0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmFsdWVGb3JtYXR0ZXIucHJvdG90eXBlLmdldFBhcnNlckZ1bmN0aW9uID0gZnVuY3Rpb24gKGZvcm1hdCkge1xuICAgICAgICBpZiAoZm9ybWF0LnR5cGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmludGwuZ2V0RGF0ZVBhcnNlcihmb3JtYXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW50bC5nZXROdW1iZXJQYXJzZXIoZm9ybWF0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmFsdWVGb3JtYXR0ZXIucHJvdG90eXBlLmZyb21WaWV3ID0gZnVuY3Rpb24gKHZhbHVlLCBmb3JtYXQsIHR5cGUpIHtcbiAgICAgICAgaWYgKCh0eXBlID09PSAnZGF0ZScgfHwgdHlwZSA9PT0gJ2RhdGV0aW1lJyB8fCB0eXBlID09PSAnbnVtYmVyJykgJiYgKCFpc051bGxPclVuZGVmaW5lZChmb3JtYXQpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZhbHVlRm9ybWF0dGVyLnByb3RvdHlwZS50b1ZpZXcgPSBmdW5jdGlvbiAodmFsdWUsIGZvcm1hdCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZm9ybWF0KSAmJiAhaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBmb3JtYXQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBWYWx1ZUZvcm1hdHRlci5wcm90b3R5cGUuc2V0Q3VsdHVyZSA9IGZ1bmN0aW9uIChjdWx0dXJlTmFtZSkge1xuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGN1bHR1cmVOYW1lKSkge1xuICAgICAgICAgICAgc2V0Q3VsdHVyZShjdWx0dXJlTmFtZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBWYWx1ZUZvcm1hdHRlcjtcbn0oKSk7XG5leHBvcnQgeyBWYWx1ZUZvcm1hdHRlciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/value-formatter.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/width-controller.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/width-controller.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ColumnWidthService: () => (/* binding */ ColumnWidthService)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _base_constant__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\n/* harmony import */ var _models_column__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../models/column */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/models/column.js\");\n/* harmony import */ var _base_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _base_string_literals__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base/string-literals */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/string-literals.js\");\n\n\n\n\n\n\n/**\n * ColumnWidthService\n *\n * @hidden\n */\nvar ColumnWidthService = /** @class */ (function () {\n    function ColumnWidthService(parent) {\n        this.parent = parent;\n    }\n    ColumnWidthService.prototype.setWidthToColumns = function () {\n        var i = 0;\n        var indexes = this.parent.getColumnIndexesInView();\n        var wFlag = true;\n        var totalColumnsWidth = 0;\n        if (this.parent.allowGrouping) {\n            for (var len = this.parent.groupSettings.columns.length; i < len; i++) {\n                if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n                    wFlag = false;\n                    continue;\n                }\n                this.setColumnWidth(new _models_column__WEBPACK_IMPORTED_MODULE_1__.Column({ width: '30px' }), i);\n            }\n        }\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            this.setColumnWidth(new _models_column__WEBPACK_IMPORTED_MODULE_1__.Column({ width: '30px' }), i);\n            i++;\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n            this.setColumnWidth(new _models_column__WEBPACK_IMPORTED_MODULE_1__.Column({ width: '30px' }), i);\n            i++;\n        }\n        var columns = this.parent.getColumns();\n        for (var j = 0; j < columns.length; j++) {\n            this.setColumnWidth(columns[parseInt(j.toString(), 10)], wFlag && this.parent.enableColumnVirtualization ? undefined : j + i);\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n            this.setColumnWidth(new _models_column__WEBPACK_IMPORTED_MODULE_1__.Column({ width: '30px' }), this.parent.groupSettings.columns.length + columns.length);\n        }\n        totalColumnsWidth = this.getTableWidth(this.parent.getColumns());\n        if (totalColumnsWidth !== 'auto') {\n            if (this.parent.width !== 'auto' && this.parent.width.toString().indexOf('%') === -1) {\n                this.setMinwidthBycalculation(totalColumnsWidth);\n            }\n            var maxWidthColumns = columns.filter(function (a) {\n                return !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(a.maxWidth);\n            });\n            var header = this.parent.getHeaderTable();\n            var content = this.parent.getContentTable();\n            if (this.parent.allowResizing && this.parent.element.getBoundingClientRect().width > totalColumnsWidth &&\n                maxWidthColumns.length === columns.length && header && content) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([header, content], ['e-tableborder']);\n            }\n        }\n    };\n    ColumnWidthService.prototype.setMinwidthBycalculation = function (tWidth) {\n        var _this = this;\n        var difference = 0;\n        var collection = this.parent.getColumns().filter(function (a) {\n            if (_this.parent.allowResizing) {\n                return ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(a.width) || a.width === 'auto') && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(a.maxWidth);\n            }\n            else {\n                return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(a.width) || a.width === 'auto';\n            }\n        });\n        if (collection.length) {\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.parent.width) && this.parent.width !== 'auto' &&\n                typeof (this.parent.width) === 'string' && this.parent.width.indexOf('%') === -1) {\n                difference = parseInt(this.parent.width, 10) - tWidth;\n            }\n            else {\n                difference = this.parent.element.getBoundingClientRect().width - tWidth;\n            }\n            var tmWidth = 0;\n            for (var _i = 0, collection_1 = collection; _i < collection_1.length; _i++) {\n                var cols = collection_1[_i];\n                tmWidth += !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(cols.minWidth) ?\n                    ((typeof cols.minWidth === 'string' ? parseInt(cols.minWidth, 10) : cols.minWidth)) : 0;\n            }\n            for (var i = 0; i < collection.length; i++) {\n                if (tWidth === 0 && this.parent.allowResizing && this.isWidthUndefined() && (i !== collection.length - 1)) {\n                    this.setUndefinedColumnWidth(collection);\n                }\n                var index = this.parent.getColumnIndexByField(collection[parseInt(i.toString(), 10)].field) + this.parent.getIndentCount();\n                if (tWidth !== 0 && difference < tmWidth) {\n                    this.setWidth(collection[parseInt(i.toString(), 10)].minWidth, index);\n                }\n                else if (tWidth !== 0 && difference > tmWidth) {\n                    this.setWidth('', index, true);\n                }\n            }\n        }\n    };\n    ColumnWidthService.prototype.setUndefinedColumnWidth = function (collection) {\n        for (var k = 0; k < collection.length; k++) {\n            if (k !== collection.length - 1) {\n                collection[parseInt(k.toString(), 10)].width = 200;\n                this.setWidth(200, this.parent.getColumnIndexByField(collection[parseInt(k.toString(), 10)].field));\n            }\n        }\n    };\n    ColumnWidthService.prototype.setColumnWidth = function (column, index, module) {\n        if (this.parent.getColumns().length < 1) {\n            return;\n        }\n        var columnIndex = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(index) ? this.parent.getNormalizedColumnIndex(column.uid) : index;\n        var cWidth = this.getWidth(column);\n        var tgridWidth = this.getTableWidth(this.parent.getColumns());\n        if (cWidth !== null) {\n            this.setWidth(cWidth, columnIndex);\n            if (this.parent.width !== 'auto' && this.parent.width.toString().indexOf('%') === -1 && tgridWidth !== 'auto') {\n                this.setMinwidthBycalculation(tgridWidth);\n            }\n            if (this.parent.allowResizing && (module === 'resize' || this.parent.getFrozenColumns())) {\n                var contentTable = this.parent.getContentTable();\n                this.setWidthToTable(this.parent.getFrozenColumns() && contentTable.style.width.indexOf('px') === -1 && tgridWidth < contentTable.clientWidth);\n            }\n            this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.columnWidthChanged, { index: columnIndex, width: cWidth, column: column, module: module });\n        }\n    };\n    ColumnWidthService.prototype.setWidth = function (width, index, clear) {\n        if (this.parent.groupSettings.columns.length > index && (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.ispercentageWidth)(this.parent) &&\n            !(this.parent.resizeModule && this.parent.resizeModule.resizeProcess)) {\n            var elementWidth = this.parent.element.offsetWidth;\n            width = (30 / elementWidth * 100).toFixed(1) + '%';\n        }\n        var header = this.parent.getHeaderTable();\n        var content = this.parent.getContentTable();\n        var fWidth = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.formatUnit)(width);\n        var headerCol = header.querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_4__.colGroup)\n            .children[parseInt(index.toString(), 10)];\n        if (headerCol && !clear) {\n            headerCol.style.width = fWidth;\n        }\n        else if (headerCol && clear) {\n            headerCol.style.width = '';\n        }\n        var contentCol = content.querySelector(_base_string_literals__WEBPACK_IMPORTED_MODULE_4__.colGroup).children[parseInt(index.toString(), 10)];\n        if (contentCol && !clear) {\n            contentCol.style.width = fWidth;\n        }\n        else if (contentCol && clear) {\n            contentCol.style.width = '';\n        }\n        if (!this.parent.enableColumnVirtualization && this.parent.isEdit) {\n            var edit = this.parent.element.querySelectorAll('.e-table.e-inline-edit');\n            var editTableCol = [];\n            for (var i = 0; i < edit.length; i++) {\n                if ((0,_base_util__WEBPACK_IMPORTED_MODULE_3__.parentsUntil)(edit[parseInt(i.toString(), 10)], 'e-grid').id === this.parent.element.id) {\n                    for (var j = 0; j < edit[parseInt(i.toString(), 10)].querySelector('colgroup').children.length; j++) {\n                        editTableCol.push(edit[parseInt(i.toString(), 10)].querySelector('colgroup').children[parseInt(j.toString(), 10)]);\n                    }\n                }\n            }\n            if (edit.length && editTableCol.length && editTableCol[parseInt(index.toString(), 10)]) {\n                editTableCol[parseInt(index.toString(), 10)].style.width = fWidth;\n            }\n        }\n        if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {\n            this.refreshFrozenScrollbar();\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    ColumnWidthService.prototype.refreshFrozenScrollbar = function () {\n        var args = { cancel: false };\n        this.parent.notify(_base_constant__WEBPACK_IMPORTED_MODULE_2__.preventFrozenScrollRefresh, args);\n        if (args.cancel) {\n            return;\n        }\n        var scrollWidth = (0,_base_util__WEBPACK_IMPORTED_MODULE_3__.getScrollBarWidth)();\n        var movableScrollbar = this.parent.element.querySelector('.e-movablescrollbar');\n        var movableWidth = this.parent.getContent().firstElementChild.getBoundingClientRect().width;\n        if (this.parent.enableColumnVirtualization) {\n            var placeHolder = this.parent.getContent().querySelector('.e-virtualtrack');\n            if (placeHolder) {\n                movableWidth = placeHolder.scrollWidth;\n            }\n        }\n        if (this.parent.height !== 'auto') {\n            movableWidth = movableWidth + scrollWidth;\n        }\n        movableScrollbar.firstElementChild.style.width = movableWidth + 'px';\n    };\n    ColumnWidthService.prototype.getSiblingsHeight = function (element) {\n        var previous = this.getHeightFromDirection(element, 'previous');\n        var next = this.getHeightFromDirection(element, 'next');\n        return previous + next;\n    };\n    ColumnWidthService.prototype.getHeightFromDirection = function (element, direction) {\n        var sibling = element[direction + 'ElementSibling'];\n        var result = 0;\n        var classList = [_base_string_literals__WEBPACK_IMPORTED_MODULE_4__.gridHeader, _base_string_literals__WEBPACK_IMPORTED_MODULE_4__.gridFooter, 'e-groupdroparea', 'e-gridpager', 'e-toolbar', 'e-temp-toolbar'];\n        while (sibling) {\n            if (classList.some(function (value) { return sibling.classList.contains(value); })) {\n                result += sibling.offsetHeight;\n            }\n            sibling = sibling[direction + 'ElementSibling'];\n        }\n        return result;\n    };\n    ColumnWidthService.prototype.isWidthUndefined = function () {\n        var isWidUndefCount = this.parent.getColumns().filter(function (col) {\n            return (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(col.width) && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(col.minWidth);\n        }).length;\n        return (this.parent.getColumns().length === isWidUndefCount);\n    };\n    ColumnWidthService.prototype.getWidth = function (column) {\n        if (this.parent.allowResizing && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.width)) {\n            if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.minWidth) && (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(column.maxWidth)\n                && !this.isWidthUndefined()) {\n                column.width = 200;\n            }\n            else if (column.maxWidth) {\n                column.width = column.maxWidth;\n            }\n        }\n        if (!column.width) {\n            return null;\n        }\n        var width = parseInt(column.width.toString(), 10);\n        if (column.minWidth && width < parseInt(column.minWidth.toString(), 10)) {\n            return column.minWidth;\n        }\n        else if (column.maxWidth && width > parseInt(column.maxWidth.toString(), 10)) {\n            return column.maxWidth;\n        }\n        else {\n            return column.width;\n        }\n    };\n    ColumnWidthService.prototype.getTableWidth = function (columns, resetIndentWidth) {\n        var tWidth = 0;\n        var isAutoColumn = false;\n        for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n            var column = columns_1[_i];\n            if (column.visible !== false) {\n                var cWidth = this.getWidth(column);\n                if (column.width === 'auto' || !column.width) {\n                    if (this.parent.allowResizing && !resetIndentWidth) {\n                        if (!column.maxWidth) {\n                            isAutoColumn = true;\n                        }\n                    }\n                    else {\n                        cWidth = 0;\n                    }\n                }\n                if (cWidth !== null) {\n                    tWidth += parseInt(cWidth.toString(), 10);\n                }\n            }\n        }\n        tWidth = isAutoColumn ? 'auto' : tWidth;\n        return tWidth;\n    };\n    ColumnWidthService.prototype.setWidthToTable = function (isMaxWidth) {\n        var tWidth = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.formatUnit)(this.getTableWidth(this.parent.getColumns()));\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            this.setColumnWidth(new _models_column__WEBPACK_IMPORTED_MODULE_1__.Column({ width: '30px' }));\n        }\n        tWidth = (this.isAutoResize() || tWidth === 'auto' || isMaxWidth) ? '100%' : tWidth;\n        this.parent.getHeaderTable().style.width = tWidth;\n        this.parent.getContentTable().style.width = tWidth;\n        var edit = this.parent.element.querySelector('.e-table.e-inline-edit');\n        if (edit) {\n            edit.style.width = tWidth;\n        }\n    };\n    ColumnWidthService.prototype.isAutoResize = function () {\n        return this.parent.allowResizing && this.parent.resizeSettings.mode === 'Auto';\n    };\n    return ColumnWidthService;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvZ3JpZC9zZXJ2aWNlcy93aWR0aC1jb250cm9sbGVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFtRTtBQUNqQjtBQUNnQztBQUN4QztBQUN3QztBQUM5QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUUsU0FBUztBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxrREFBTSxHQUFHLGVBQWU7QUFDaEU7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLGtEQUFNLEdBQUcsZUFBZTtBQUM1RDtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0Msa0RBQU0sR0FBRyxlQUFlO0FBQzVEO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixvQkFBb0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLGtEQUFNLEdBQUcsZUFBZTtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1RUFBaUI7QUFDekMsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDhEQUFRO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUVBQWlCLG9DQUFvQyx1RUFBaUI7QUFDOUY7QUFDQTtBQUNBLHVCQUF1Qix1RUFBaUI7QUFDeEM7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxpQkFBaUIsdUVBQWlCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELDBCQUEwQjtBQUNsRjtBQUNBLDRCQUE0Qix1RUFBaUI7QUFDN0M7QUFDQTtBQUNBLDRCQUE0Qix1QkFBdUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsdUVBQWlCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsOERBQWtCLElBQUksbUVBQW1FO0FBQ3hIO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRSw2REFBaUI7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLGdFQUFVO0FBQy9CLDZDQUE2QywyREFBaUI7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsMkRBQWlCO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixpQkFBaUI7QUFDN0Msb0JBQW9CLHdEQUFZO0FBQ2hDLG9DQUFvQyxnRkFBZ0Y7QUFDcEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLDJCQUEyQixzRUFBMEI7QUFDckQ7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDZEQUFpQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNkRBQW1CLEVBQUUsNkRBQW1CO0FBQ2pFO0FBQ0Esa0RBQWtELDJDQUEyQztBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHVFQUFpQixlQUFlLHVFQUFpQjtBQUNwRSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLHVFQUFpQjtBQUMxRCxnQkFBZ0IsdUVBQWlCLHFCQUFxQix1RUFBaUI7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHVCQUF1QjtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixnRUFBVTtBQUMvQjtBQUNBLG9DQUFvQyxrREFBTSxHQUFHLGVBQWU7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQzZCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL2dyaWQvc2VydmljZXMvd2lkdGgtY29udHJvbGxlci5qcz8yOTA0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzTnVsbE9yVW5kZWZpbmVkLCBhZGRDbGFzcyB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IGZvcm1hdFVuaXQgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBjb2x1bW5XaWR0aENoYW5nZWQsIHByZXZlbnRGcm96ZW5TY3JvbGxSZWZyZXNoIH0gZnJvbSAnLi4vYmFzZS9jb25zdGFudCc7XG5pbXBvcnQgeyBDb2x1bW4gfSBmcm9tICcuLi9tb2RlbHMvY29sdW1uJztcbmltcG9ydCB7IHBhcmVudHNVbnRpbCwgaXNwZXJjZW50YWdlV2lkdGgsIGdldFNjcm9sbEJhcldpZHRoIH0gZnJvbSAnLi4vYmFzZS91dGlsJztcbmltcG9ydCAqIGFzIGxpdGVyYWxzIGZyb20gJy4uL2Jhc2Uvc3RyaW5nLWxpdGVyYWxzJztcbi8qKlxuICogQ29sdW1uV2lkdGhTZXJ2aWNlXG4gKlxuICogQGhpZGRlblxuICovXG52YXIgQ29sdW1uV2lkdGhTZXJ2aWNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvbHVtbldpZHRoU2VydmljZShwYXJlbnQpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgfVxuICAgIENvbHVtbldpZHRoU2VydmljZS5wcm90b3R5cGUuc2V0V2lkdGhUb0NvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgdmFyIGluZGV4ZXMgPSB0aGlzLnBhcmVudC5nZXRDb2x1bW5JbmRleGVzSW5WaWV3KCk7XG4gICAgICAgIHZhciB3RmxhZyA9IHRydWU7XG4gICAgICAgIHZhciB0b3RhbENvbHVtbnNXaWR0aCA9IDA7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5hbGxvd0dyb3VwaW5nKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBsZW4gPSB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgaW5kZXhlcy5pbmRleE9mKGkpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB3RmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5XaWR0aChuZXcgQ29sdW1uKHsgd2lkdGg6ICczMHB4JyB9KSwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmRldGFpbFRlbXBsYXRlIHx8IHRoaXMucGFyZW50LmNoaWxkR3JpZCkge1xuICAgICAgICAgICAgdGhpcy5zZXRDb2x1bW5XaWR0aChuZXcgQ29sdW1uKHsgd2lkdGg6ICczMHB4JyB9KSwgaSk7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzUm93RHJhZ2FibGUoKSAmJiB0aGlzLnBhcmVudC5nZXRGcm96ZW5Nb2RlKCkgIT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Q29sdW1uV2lkdGgobmV3IENvbHVtbih7IHdpZHRoOiAnMzBweCcgfSksIGkpO1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb2x1bW5zID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNvbHVtbnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Q29sdW1uV2lkdGgoY29sdW1uc1twYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0sIHdGbGFnICYmIHRoaXMucGFyZW50LmVuYWJsZUNvbHVtblZpcnR1YWxpemF0aW9uID8gdW5kZWZpbmVkIDogaiArIGkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5pc1Jvd0RyYWdhYmxlKCkgJiYgdGhpcy5wYXJlbnQuZ2V0RnJvemVuTW9kZSgpID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICB0aGlzLnNldENvbHVtbldpZHRoKG5ldyBDb2x1bW4oeyB3aWR0aDogJzMwcHgnIH0pLCB0aGlzLnBhcmVudC5ncm91cFNldHRpbmdzLmNvbHVtbnMubGVuZ3RoICsgY29sdW1ucy5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIHRvdGFsQ29sdW1uc1dpZHRoID0gdGhpcy5nZXRUYWJsZVdpZHRoKHRoaXMucGFyZW50LmdldENvbHVtbnMoKSk7XG4gICAgICAgIGlmICh0b3RhbENvbHVtbnNXaWR0aCAhPT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQud2lkdGggIT09ICdhdXRvJyAmJiB0aGlzLnBhcmVudC53aWR0aC50b1N0cmluZygpLmluZGV4T2YoJyUnKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldE1pbndpZHRoQnljYWxjdWxhdGlvbih0b3RhbENvbHVtbnNXaWR0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbWF4V2lkdGhDb2x1bW5zID0gY29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWlzTnVsbE9yVW5kZWZpbmVkKGEubWF4V2lkdGgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgaGVhZGVyID0gdGhpcy5wYXJlbnQuZ2V0SGVhZGVyVGFibGUoKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5wYXJlbnQuZ2V0Q29udGVudFRhYmxlKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dSZXNpemluZyAmJiB0aGlzLnBhcmVudC5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoID4gdG90YWxDb2x1bW5zV2lkdGggJiZcbiAgICAgICAgICAgICAgICBtYXhXaWR0aENvbHVtbnMubGVuZ3RoID09PSBjb2x1bW5zLmxlbmd0aCAmJiBoZWFkZXIgJiYgY29udGVudCkge1xuICAgICAgICAgICAgICAgIGFkZENsYXNzKFtoZWFkZXIsIGNvbnRlbnRdLCBbJ2UtdGFibGVib3JkZXInXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbHVtbldpZHRoU2VydmljZS5wcm90b3R5cGUuc2V0TWlud2lkdGhCeWNhbGN1bGF0aW9uID0gZnVuY3Rpb24gKHRXaWR0aCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZGlmZmVyZW5jZSA9IDA7XG4gICAgICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpLmZpbHRlcihmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5hbGxvd1Jlc2l6aW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChpc051bGxPclVuZGVmaW5lZChhLndpZHRoKSB8fCBhLndpZHRoID09PSAnYXV0bycpICYmIGlzTnVsbE9yVW5kZWZpbmVkKGEubWF4V2lkdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlzTnVsbE9yVW5kZWZpbmVkKGEud2lkdGgpIHx8IGEud2lkdGggPT09ICdhdXRvJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChjb2xsZWN0aW9uLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnBhcmVudC53aWR0aCkgJiYgdGhpcy5wYXJlbnQud2lkdGggIT09ICdhdXRvJyAmJlxuICAgICAgICAgICAgICAgIHR5cGVvZiAodGhpcy5wYXJlbnQud2lkdGgpID09PSAnc3RyaW5nJyAmJiB0aGlzLnBhcmVudC53aWR0aC5pbmRleE9mKCclJykgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgZGlmZmVyZW5jZSA9IHBhcnNlSW50KHRoaXMucGFyZW50LndpZHRoLCAxMCkgLSB0V2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkaWZmZXJlbmNlID0gdGhpcy5wYXJlbnQuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCAtIHRXaWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0bVdpZHRoID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgY29sbGVjdGlvbl8xID0gY29sbGVjdGlvbjsgX2kgPCBjb2xsZWN0aW9uXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbHMgPSBjb2xsZWN0aW9uXzFbX2ldO1xuICAgICAgICAgICAgICAgIHRtV2lkdGggKz0gIWlzTnVsbE9yVW5kZWZpbmVkKGNvbHMubWluV2lkdGgpID9cbiAgICAgICAgICAgICAgICAgICAgKCh0eXBlb2YgY29scy5taW5XaWR0aCA9PT0gJ3N0cmluZycgPyBwYXJzZUludChjb2xzLm1pbldpZHRoLCAxMCkgOiBjb2xzLm1pbldpZHRoKSkgOiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2xsZWN0aW9uLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRXaWR0aCA9PT0gMCAmJiB0aGlzLnBhcmVudC5hbGxvd1Jlc2l6aW5nICYmIHRoaXMuaXNXaWR0aFVuZGVmaW5lZCgpICYmIChpICE9PSBjb2xsZWN0aW9uLmxlbmd0aCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VW5kZWZpbmVkQ29sdW1uV2lkdGgoY29sbGVjdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMucGFyZW50LmdldENvbHVtbkluZGV4QnlGaWVsZChjb2xsZWN0aW9uW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5maWVsZCkgKyB0aGlzLnBhcmVudC5nZXRJbmRlbnRDb3VudCgpO1xuICAgICAgICAgICAgICAgIGlmICh0V2lkdGggIT09IDAgJiYgZGlmZmVyZW5jZSA8IHRtV2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRXaWR0aChjb2xsZWN0aW9uW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5taW5XaWR0aCwgaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0V2lkdGggIT09IDAgJiYgZGlmZmVyZW5jZSA+IHRtV2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRXaWR0aCgnJywgaW5kZXgsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29sdW1uV2lkdGhTZXJ2aWNlLnByb3RvdHlwZS5zZXRVbmRlZmluZWRDb2x1bW5XaWR0aCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uKSB7XG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY29sbGVjdGlvbi5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgaWYgKGsgIT09IGNvbGxlY3Rpb24ubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25bcGFyc2VJbnQoay50b1N0cmluZygpLCAxMCldLndpZHRoID0gMjAwO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0V2lkdGgoMjAwLCB0aGlzLnBhcmVudC5nZXRDb2x1bW5JbmRleEJ5RmllbGQoY29sbGVjdGlvbltwYXJzZUludChrLnRvU3RyaW5nKCksIDEwKV0uZmllbGQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29sdW1uV2lkdGhTZXJ2aWNlLnByb3RvdHlwZS5zZXRDb2x1bW5XaWR0aCA9IGZ1bmN0aW9uIChjb2x1bW4sIGluZGV4LCBtb2R1bGUpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50LmdldENvbHVtbnMoKS5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbHVtbkluZGV4ID0gaXNOdWxsT3JVbmRlZmluZWQoaW5kZXgpID8gdGhpcy5wYXJlbnQuZ2V0Tm9ybWFsaXplZENvbHVtbkluZGV4KGNvbHVtbi51aWQpIDogaW5kZXg7XG4gICAgICAgIHZhciBjV2lkdGggPSB0aGlzLmdldFdpZHRoKGNvbHVtbik7XG4gICAgICAgIHZhciB0Z3JpZFdpZHRoID0gdGhpcy5nZXRUYWJsZVdpZHRoKHRoaXMucGFyZW50LmdldENvbHVtbnMoKSk7XG4gICAgICAgIGlmIChjV2lkdGggIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0V2lkdGgoY1dpZHRoLCBjb2x1bW5JbmRleCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQud2lkdGggIT09ICdhdXRvJyAmJiB0aGlzLnBhcmVudC53aWR0aC50b1N0cmluZygpLmluZGV4T2YoJyUnKSA9PT0gLTEgJiYgdGdyaWRXaWR0aCAhPT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRNaW53aWR0aEJ5Y2FsY3VsYXRpb24odGdyaWRXaWR0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dSZXNpemluZyAmJiAobW9kdWxlID09PSAncmVzaXplJyB8fCB0aGlzLnBhcmVudC5nZXRGcm96ZW5Db2x1bW5zKCkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRUYWJsZSA9IHRoaXMucGFyZW50LmdldENvbnRlbnRUYWJsZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0V2lkdGhUb1RhYmxlKHRoaXMucGFyZW50LmdldEZyb3plbkNvbHVtbnMoKSAmJiBjb250ZW50VGFibGUuc3R5bGUud2lkdGguaW5kZXhPZigncHgnKSA9PT0gLTEgJiYgdGdyaWRXaWR0aCA8IGNvbnRlbnRUYWJsZS5jbGllbnRXaWR0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkoY29sdW1uV2lkdGhDaGFuZ2VkLCB7IGluZGV4OiBjb2x1bW5JbmRleCwgd2lkdGg6IGNXaWR0aCwgY29sdW1uOiBjb2x1bW4sIG1vZHVsZTogbW9kdWxlIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb2x1bW5XaWR0aFNlcnZpY2UucHJvdG90eXBlLnNldFdpZHRoID0gZnVuY3Rpb24gKHdpZHRoLCBpbmRleCwgY2xlYXIpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50Lmdyb3VwU2V0dGluZ3MuY29sdW1ucy5sZW5ndGggPiBpbmRleCAmJiBpc3BlcmNlbnRhZ2VXaWR0aCh0aGlzLnBhcmVudCkgJiZcbiAgICAgICAgICAgICEodGhpcy5wYXJlbnQucmVzaXplTW9kdWxlICYmIHRoaXMucGFyZW50LnJlc2l6ZU1vZHVsZS5yZXNpemVQcm9jZXNzKSkge1xuICAgICAgICAgICAgdmFyIGVsZW1lbnRXaWR0aCA9IHRoaXMucGFyZW50LmVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICB3aWR0aCA9ICgzMCAvIGVsZW1lbnRXaWR0aCAqIDEwMCkudG9GaXhlZCgxKSArICclJztcbiAgICAgICAgfVxuICAgICAgICB2YXIgaGVhZGVyID0gdGhpcy5wYXJlbnQuZ2V0SGVhZGVyVGFibGUoKTtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSB0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKTtcbiAgICAgICAgdmFyIGZXaWR0aCA9IGZvcm1hdFVuaXQod2lkdGgpO1xuICAgICAgICB2YXIgaGVhZGVyQ29sID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IobGl0ZXJhbHMuY29sR3JvdXApXG4gICAgICAgICAgICAuY2hpbGRyZW5bcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgaWYgKGhlYWRlckNvbCAmJiAhY2xlYXIpIHtcbiAgICAgICAgICAgIGhlYWRlckNvbC5zdHlsZS53aWR0aCA9IGZXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChoZWFkZXJDb2wgJiYgY2xlYXIpIHtcbiAgICAgICAgICAgIGhlYWRlckNvbC5zdHlsZS53aWR0aCA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb250ZW50Q29sID0gY29udGVudC5xdWVyeVNlbGVjdG9yKGxpdGVyYWxzLmNvbEdyb3VwKS5jaGlsZHJlbltwYXJzZUludChpbmRleC50b1N0cmluZygpLCAxMCldO1xuICAgICAgICBpZiAoY29udGVudENvbCAmJiAhY2xlYXIpIHtcbiAgICAgICAgICAgIGNvbnRlbnRDb2wuc3R5bGUud2lkdGggPSBmV2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29udGVudENvbCAmJiBjbGVhcikge1xuICAgICAgICAgICAgY29udGVudENvbC5zdHlsZS53aWR0aCA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24gJiYgdGhpcy5wYXJlbnQuaXNFZGl0KSB7XG4gICAgICAgICAgICB2YXIgZWRpdCA9IHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtdGFibGUuZS1pbmxpbmUtZWRpdCcpO1xuICAgICAgICAgICAgdmFyIGVkaXRUYWJsZUNvbCA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlZGl0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudHNVbnRpbChlZGl0W3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgJ2UtZ3JpZCcpLmlkID09PSB0aGlzLnBhcmVudC5lbGVtZW50LmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZWRpdFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ucXVlcnlTZWxlY3RvcignY29sZ3JvdXAnKS5jaGlsZHJlbi5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdFRhYmxlQ29sLnB1c2goZWRpdFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0ucXVlcnlTZWxlY3RvcignY29sZ3JvdXAnKS5jaGlsZHJlbltwYXJzZUludChqLnRvU3RyaW5nKCksIDEwKV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVkaXQubGVuZ3RoICYmIGVkaXRUYWJsZUNvbC5sZW5ndGggJiYgZWRpdFRhYmxlQ29sW3BhcnNlSW50KGluZGV4LnRvU3RyaW5nKCksIDEwKV0pIHtcbiAgICAgICAgICAgICAgICBlZGl0VGFibGVDb2xbcGFyc2VJbnQoaW5kZXgudG9TdHJpbmcoKSwgMTApXS5zdHlsZS53aWR0aCA9IGZXaWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNGcm96ZW5HcmlkKCkgJiYgdGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaEZyb3plblNjcm9sbGJhcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQ29sdW1uV2lkdGhTZXJ2aWNlLnByb3RvdHlwZS5yZWZyZXNoRnJvemVuU2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IHsgY2FuY2VsOiBmYWxzZSB9O1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnkocHJldmVudEZyb3plblNjcm9sbFJlZnJlc2gsIGFyZ3MpO1xuICAgICAgICBpZiAoYXJncy5jYW5jZWwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2Nyb2xsV2lkdGggPSBnZXRTY3JvbGxCYXJXaWR0aCgpO1xuICAgICAgICB2YXIgbW92YWJsZVNjcm9sbGJhciA9IHRoaXMucGFyZW50LmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtbW92YWJsZXNjcm9sbGJhcicpO1xuICAgICAgICB2YXIgbW92YWJsZVdpZHRoID0gdGhpcy5wYXJlbnQuZ2V0Q29udGVudCgpLmZpcnN0RWxlbWVudENoaWxkLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuZW5hYmxlQ29sdW1uVmlydHVhbGl6YXRpb24pIHtcbiAgICAgICAgICAgIHZhciBwbGFjZUhvbGRlciA9IHRoaXMucGFyZW50LmdldENvbnRlbnQoKS5xdWVyeVNlbGVjdG9yKCcuZS12aXJ0dWFsdHJhY2snKTtcbiAgICAgICAgICAgIGlmIChwbGFjZUhvbGRlcikge1xuICAgICAgICAgICAgICAgIG1vdmFibGVXaWR0aCA9IHBsYWNlSG9sZGVyLnNjcm9sbFdpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5oZWlnaHQgIT09ICdhdXRvJykge1xuICAgICAgICAgICAgbW92YWJsZVdpZHRoID0gbW92YWJsZVdpZHRoICsgc2Nyb2xsV2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgbW92YWJsZVNjcm9sbGJhci5maXJzdEVsZW1lbnRDaGlsZC5zdHlsZS53aWR0aCA9IG1vdmFibGVXaWR0aCArICdweCc7XG4gICAgfTtcbiAgICBDb2x1bW5XaWR0aFNlcnZpY2UucHJvdG90eXBlLmdldFNpYmxpbmdzSGVpZ2h0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgdmFyIHByZXZpb3VzID0gdGhpcy5nZXRIZWlnaHRGcm9tRGlyZWN0aW9uKGVsZW1lbnQsICdwcmV2aW91cycpO1xuICAgICAgICB2YXIgbmV4dCA9IHRoaXMuZ2V0SGVpZ2h0RnJvbURpcmVjdGlvbihlbGVtZW50LCAnbmV4dCcpO1xuICAgICAgICByZXR1cm4gcHJldmlvdXMgKyBuZXh0O1xuICAgIH07XG4gICAgQ29sdW1uV2lkdGhTZXJ2aWNlLnByb3RvdHlwZS5nZXRIZWlnaHRGcm9tRGlyZWN0aW9uID0gZnVuY3Rpb24gKGVsZW1lbnQsIGRpcmVjdGlvbikge1xuICAgICAgICB2YXIgc2libGluZyA9IGVsZW1lbnRbZGlyZWN0aW9uICsgJ0VsZW1lbnRTaWJsaW5nJ107XG4gICAgICAgIHZhciByZXN1bHQgPSAwO1xuICAgICAgICB2YXIgY2xhc3NMaXN0ID0gW2xpdGVyYWxzLmdyaWRIZWFkZXIsIGxpdGVyYWxzLmdyaWRGb290ZXIsICdlLWdyb3VwZHJvcGFyZWEnLCAnZS1ncmlkcGFnZXInLCAnZS10b29sYmFyJywgJ2UtdGVtcC10b29sYmFyJ107XG4gICAgICAgIHdoaWxlIChzaWJsaW5nKSB7XG4gICAgICAgICAgICBpZiAoY2xhc3NMaXN0LnNvbWUoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBzaWJsaW5nLmNsYXNzTGlzdC5jb250YWlucyh2YWx1ZSk7IH0pKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IHNpYmxpbmcub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2libGluZyA9IHNpYmxpbmdbZGlyZWN0aW9uICsgJ0VsZW1lbnRTaWJsaW5nJ107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIENvbHVtbldpZHRoU2VydmljZS5wcm90b3R5cGUuaXNXaWR0aFVuZGVmaW5lZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlzV2lkVW5kZWZDb3VudCA9IHRoaXMucGFyZW50LmdldENvbHVtbnMoKS5maWx0ZXIoZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgcmV0dXJuIGlzTnVsbE9yVW5kZWZpbmVkKGNvbC53aWR0aCkgJiYgaXNOdWxsT3JVbmRlZmluZWQoY29sLm1pbldpZHRoKTtcbiAgICAgICAgfSkubGVuZ3RoO1xuICAgICAgICByZXR1cm4gKHRoaXMucGFyZW50LmdldENvbHVtbnMoKS5sZW5ndGggPT09IGlzV2lkVW5kZWZDb3VudCk7XG4gICAgfTtcbiAgICBDb2x1bW5XaWR0aFNlcnZpY2UucHJvdG90eXBlLmdldFdpZHRoID0gZnVuY3Rpb24gKGNvbHVtbikge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQuYWxsb3dSZXNpemluZyAmJiBpc051bGxPclVuZGVmaW5lZChjb2x1bW4ud2lkdGgpKSB7XG4gICAgICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoY29sdW1uLm1pbldpZHRoKSAmJiBpc051bGxPclVuZGVmaW5lZChjb2x1bW4ubWF4V2lkdGgpXG4gICAgICAgICAgICAgICAgJiYgIXRoaXMuaXNXaWR0aFVuZGVmaW5lZCgpKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uLndpZHRoID0gMjAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29sdW1uLm1heFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uLndpZHRoID0gY29sdW1uLm1heFdpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghY29sdW1uLndpZHRoKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd2lkdGggPSBwYXJzZUludChjb2x1bW4ud2lkdGgudG9TdHJpbmcoKSwgMTApO1xuICAgICAgICBpZiAoY29sdW1uLm1pbldpZHRoICYmIHdpZHRoIDwgcGFyc2VJbnQoY29sdW1uLm1pbldpZHRoLnRvU3RyaW5nKCksIDEwKSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbHVtbi5taW5XaWR0aDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2x1bW4ubWF4V2lkdGggJiYgd2lkdGggPiBwYXJzZUludChjb2x1bW4ubWF4V2lkdGgudG9TdHJpbmcoKSwgMTApKSB7XG4gICAgICAgICAgICByZXR1cm4gY29sdW1uLm1heFdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGNvbHVtbi53aWR0aDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29sdW1uV2lkdGhTZXJ2aWNlLnByb3RvdHlwZS5nZXRUYWJsZVdpZHRoID0gZnVuY3Rpb24gKGNvbHVtbnMsIHJlc2V0SW5kZW50V2lkdGgpIHtcbiAgICAgICAgdmFyIHRXaWR0aCA9IDA7XG4gICAgICAgIHZhciBpc0F1dG9Db2x1bW4gPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBjb2x1bW5zXzEgPSBjb2x1bW5zOyBfaSA8IGNvbHVtbnNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBjb2x1bW4gPSBjb2x1bW5zXzFbX2ldO1xuICAgICAgICAgICAgaWYgKGNvbHVtbi52aXNpYmxlICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHZhciBjV2lkdGggPSB0aGlzLmdldFdpZHRoKGNvbHVtbik7XG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbi53aWR0aCA9PT0gJ2F1dG8nIHx8ICFjb2x1bW4ud2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmFsbG93UmVzaXppbmcgJiYgIXJlc2V0SW5kZW50V2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY29sdW1uLm1heFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBdXRvQ29sdW1uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNXaWR0aCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNXaWR0aCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0V2lkdGggKz0gcGFyc2VJbnQoY1dpZHRoLnRvU3RyaW5nKCksIDEwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdFdpZHRoID0gaXNBdXRvQ29sdW1uID8gJ2F1dG8nIDogdFdpZHRoO1xuICAgICAgICByZXR1cm4gdFdpZHRoO1xuICAgIH07XG4gICAgQ29sdW1uV2lkdGhTZXJ2aWNlLnByb3RvdHlwZS5zZXRXaWR0aFRvVGFibGUgPSBmdW5jdGlvbiAoaXNNYXhXaWR0aCkge1xuICAgICAgICB2YXIgdFdpZHRoID0gZm9ybWF0VW5pdCh0aGlzLmdldFRhYmxlV2lkdGgodGhpcy5wYXJlbnQuZ2V0Q29sdW1ucygpKSk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudC5kZXRhaWxUZW1wbGF0ZSB8fCB0aGlzLnBhcmVudC5jaGlsZEdyaWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Q29sdW1uV2lkdGgobmV3IENvbHVtbih7IHdpZHRoOiAnMzBweCcgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHRXaWR0aCA9ICh0aGlzLmlzQXV0b1Jlc2l6ZSgpIHx8IHRXaWR0aCA9PT0gJ2F1dG8nIHx8IGlzTWF4V2lkdGgpID8gJzEwMCUnIDogdFdpZHRoO1xuICAgICAgICB0aGlzLnBhcmVudC5nZXRIZWFkZXJUYWJsZSgpLnN0eWxlLndpZHRoID0gdFdpZHRoO1xuICAgICAgICB0aGlzLnBhcmVudC5nZXRDb250ZW50VGFibGUoKS5zdHlsZS53aWR0aCA9IHRXaWR0aDtcbiAgICAgICAgdmFyIGVkaXQgPSB0aGlzLnBhcmVudC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXRhYmxlLmUtaW5saW5lLWVkaXQnKTtcbiAgICAgICAgaWYgKGVkaXQpIHtcbiAgICAgICAgICAgIGVkaXQuc3R5bGUud2lkdGggPSB0V2lkdGg7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbHVtbldpZHRoU2VydmljZS5wcm90b3R5cGUuaXNBdXRvUmVzaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuYWxsb3dSZXNpemluZyAmJiB0aGlzLnBhcmVudC5yZXNpemVTZXR0aW5ncy5tb2RlID09PSAnQXV0byc7XG4gICAgfTtcbiAgICByZXR1cm4gQ29sdW1uV2lkdGhTZXJ2aWNlO1xufSgpKTtcbmV4cG9ydCB7IENvbHVtbldpZHRoU2VydmljZSB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/services/width-controller.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/numeric-container.js":
/*!****************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/numeric-container.js ***!
  \****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NumericContainer: () => (/* binding */ NumericContainer)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n\n\n\n/**\n * `NumericContainer` module handles rendering and refreshing numeric container.\n */\nvar NumericContainer = /** @class */ (function () {\n    /**\n     * Constructor for numericContainer module\n     *\n     * @param {Pager} pagerModule - specifies the pagerModule\n     * @hidden\n     */\n    function NumericContainer(pagerModule) {\n        this.pagerModule = pagerModule;\n    }\n    /**\n     * The function is used to render numericContainer\n     *\n     * @returns {void}\n     * @hidden\n     */\n    NumericContainer.prototype.render = function () {\n        this.pagerElement = this.pagerModule.element;\n        this.renderNumericContainer();\n        this.refreshNumericLinks();\n        this.wireEvents();\n    };\n    /**\n     * Refreshes the numeric container of Pager.\n     *\n     * @returns {void}\n     */\n    NumericContainer.prototype.refresh = function () {\n        this.pagerModule.updateTotalPages();\n        if (this.links.length) {\n            this.updateLinksHtml();\n        }\n        this.refreshAriaAttrLabel();\n        this.updateStyles();\n    };\n    /**\n     * The function is used to refresh refreshNumericLinks\n     *\n     * @returns {void}\n     * @hidden\n     */\n    NumericContainer.prototype.refreshNumericLinks = function () {\n        var link;\n        var pagerObj = this.pagerModule;\n        var div = pagerObj.element.querySelector('.e-numericcontainer');\n        var frag = document.createDocumentFragment();\n        div.innerHTML = '';\n        for (var i = 1; i <= pagerObj.pageCount; i++) {\n            link = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('a', {\n                className: 'e-link e-numericitem e-spacing e-pager-default',\n                attrs: { tabindex: '-1', 'aria-label': pagerObj.getLocalizedLabel('Page') + i + pagerObj.getLocalizedLabel('Of') +\n                        pagerObj.totalPages + pagerObj.getLocalizedLabel('Pages'), href: '#' }\n            });\n            if (pagerObj.currentPage === i) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(link, ['e-currentitem', 'e-active'], ['e-pager-default']);\n                link.setAttribute('aria-current', 'page');\n            }\n            frag.appendChild(link);\n        }\n        div.appendChild(frag);\n        this.links = [].slice.call(div.childNodes);\n    };\n    /**\n     * Binding events to the element while component creation\n     *\n     * @returns {void}\n     * @hidden\n     */\n    NumericContainer.prototype.wireEvents = function () {\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.pagerElement, 'click', this.clickHandler, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.pagerElement, 'auxclick', this.auxiliaryClickHandler, this);\n    };\n    /**\n     * Unbinding events from the element while component destroy\n     *\n     * @returns {void}\n     * @hidden\n     */\n    NumericContainer.prototype.unwireEvents = function () {\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.pagerModule.element, 'click', this.clickHandler);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.pagerModule.element, 'auxclick', this.auxiliaryClickHandler);\n    };\n    /**\n     * To destroy the PagerMessage\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n     */\n    NumericContainer.prototype.destroy = function () {\n        this.unwireEvents();\n    };\n    NumericContainer.prototype.refreshAriaAttrLabel = function () {\n        var pagerObj = this.pagerModule;\n        var numericContainer = pagerObj.element.querySelector('.e-numericcontainer');\n        var links = numericContainer.querySelectorAll('a');\n        for (var i = 0; i < links.length; i++) {\n            if (links[parseInt(i.toString(), 10)].hasAttribute('aria-label') && links[parseInt(i.toString(), 10)].hasAttribute('index')) {\n                links[parseInt(i.toString(), 10)].setAttribute('aria-label', pagerObj.getLocalizedLabel('Page') + links[parseInt(i.toString(), 10)].getAttribute('index')\n                    + pagerObj.getLocalizedLabel('Of') + pagerObj.totalPages + pagerObj.getLocalizedLabel('Pages'));\n            }\n        }\n    };\n    NumericContainer.prototype.renderNumericContainer = function () {\n        this.element = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            className: 'e-pagercontainer', attrs: { 'role': 'navigation' }\n        });\n        this.renderFirstNPrev(this.element);\n        this.renderPrevPagerSet(this.element);\n        this.element.appendChild((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', { className: 'e-numericcontainer' }));\n        this.renderNextPagerSet(this.element);\n        this.renderNextNLast(this.element);\n        this.pagerModule.element.appendChild(this.element);\n    };\n    NumericContainer.prototype.renderFirstNPrev = function (pagerContainer) {\n        this.first = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            className: 'e-first e-icons e-icon-first',\n            attrs: {\n                title: this.pagerModule.getLocalizedLabel('firstPageTooltip'),\n                tabindex: '-1', role: 'button'\n            }\n        });\n        this.prev = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            className: 'e-prev e-icons e-icon-prev',\n            attrs: {\n                title: this.pagerModule.getLocalizedLabel('previousPageTooltip'),\n                tabindex: '-1', role: 'button'\n            }\n        });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.append)([this.first, this.prev], pagerContainer);\n    };\n    NumericContainer.prototype.renderPrevPagerSet = function (pagerContainer) {\n        var prevPager = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div');\n        this.PP = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('a', {\n            className: 'e-link e-pp e-spacing', innerHTML: '...',\n            attrs: {\n                title: this.pagerModule.getLocalizedLabel('previousPagerTooltip'),\n                'aria-label': this.pagerModule.getLocalizedLabel('previousPagerTooltip'),\n                tabindex: '-1',\n                href: '#'\n            }\n        });\n        prevPager.appendChild(this.PP);\n        pagerContainer.appendChild(prevPager);\n    };\n    NumericContainer.prototype.renderNextPagerSet = function (pagerContainer) {\n        var nextPager = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div');\n        this.NP = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('a', {\n            className: 'e-link e-np e-spacing',\n            innerHTML: '...', attrs: {\n                title: this.pagerModule.getLocalizedLabel('nextPagerTooltip'),\n                'aria-label': this.pagerModule.getLocalizedLabel('nextPagerTooltip'),\n                tabindex: '-1',\n                href: '#'\n            }\n        });\n        nextPager.appendChild(this.NP);\n        pagerContainer.appendChild(nextPager);\n    };\n    NumericContainer.prototype.renderNextNLast = function (pagerContainer) {\n        this.next = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            className: 'e-next e-icons e-icon-next',\n            attrs: {\n                title: this.pagerModule.getLocalizedLabel('nextPageTooltip'),\n                tabindex: '-1', role: 'button'\n            }\n        });\n        this.last = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            className: 'e-last e-icons e-icon-last',\n            attrs: {\n                title: this.pagerModule.getLocalizedLabel('lastPageTooltip'),\n                tabindex: '-1', role: 'button'\n            }\n        });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.append)([this.next, this.last], pagerContainer);\n    };\n    NumericContainer.prototype.clickHandler = function (e) {\n        var pagerObj = this.pagerModule;\n        this.target = e.target;\n        if (this.target.classList.contains('e-numericitem')) {\n            e.preventDefault();\n        }\n        pagerObj.previousPageNo = pagerObj.currentPage;\n        if (!this.target.classList.contains('e-disable') && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.target.getAttribute('index'))) {\n            pagerObj.currentPage = parseInt(this.target.getAttribute('index'), 10);\n            this.pagerModule.isInteracted = true;\n            pagerObj.dataBind();\n        }\n        return false;\n    };\n    NumericContainer.prototype.auxiliaryClickHandler = function (e) {\n        this.target = e.target;\n        if (this.target.classList.contains('e-numericitem') && (e.button === 1)) {\n            e.preventDefault();\n        }\n    };\n    NumericContainer.prototype.updateLinksHtml = function () {\n        var pagerObj = this.pagerModule;\n        var currentPageSet;\n        var isLastSet;\n        var pageNo;\n        var numItems = this.pagerElement.querySelectorAll('.e-numericitem:not(.e-hide):not([style*=\"display: none\"]):not(.e-np):not(.e-pp)');\n        pagerObj.currentPage = pagerObj.totalPages === 1 ? 1 : pagerObj.currentPage;\n        if (pagerObj.currentPage > pagerObj.totalPages && pagerObj.totalPages) {\n            pagerObj.currentPage = pagerObj.totalPages;\n        }\n        currentPageSet = parseInt((pagerObj.currentPage / pagerObj.pageCount).toString(), 10);\n        if (pagerObj.currentPage % pagerObj.pageCount === 0 && currentPageSet > 0) {\n            currentPageSet = currentPageSet - 1;\n        }\n        for (var i = 0; i < pagerObj.pageCount; i++) {\n            if (pagerObj.isPagerResized) {\n                var focusedItem = this.pagerElement.querySelector('.e-focus');\n                var focusedorTarget = this.target ? this.target : focusedItem ? focusedItem : null;\n                var prevFocused = false;\n                var nextFocused = false;\n                var firstFocused = false;\n                var lastFocused = false;\n                var numItemFocused = false;\n                var npFocused = false;\n                var ppFocused = false;\n                if (focusedorTarget) {\n                    var classList_1 = focusedorTarget.classList;\n                    if (classList_1.contains('e-icons')) {\n                        switch (true) {\n                            case classList_1.contains('e-prev'):\n                                prevFocused = true;\n                                break;\n                            case classList_1.contains('e-next'):\n                                nextFocused = true;\n                                break;\n                            case classList_1.contains('e-first'):\n                                firstFocused = true;\n                                break;\n                            case classList_1.contains('e-last'):\n                                lastFocused = true;\n                                break;\n                        }\n                    }\n                    else if (classList_1.contains('e-numericitem')) {\n                        switch (true) {\n                            case classList_1.contains('e-np'):\n                                npFocused = true;\n                                break;\n                            case classList_1.contains('e-pp'):\n                                ppFocused = true;\n                                break;\n                            default:\n                                numItemFocused = classList_1.contains('e-numericitem');\n                                break;\n                        }\n                    }\n                }\n                isLastSet = lastFocused || (this.pagerModule.keyAction === 'End');\n                numItems = this.pagerElement.querySelectorAll('.e-numericitem:not(.e-hide):not([style*=\"display: none\"]):not(.e-np):not(.e-pp)');\n                var isPageAvailable = Array.from(numItems).some(function (item) { return parseInt(item.getAttribute('index'), 10) === pagerObj.currentPage; });\n                //Setting pageNo to render based on key action or click action.\n                if (firstFocused || this.pagerModule.keyAction === 'Home') {\n                    pageNo = 1 + i;\n                }\n                else if (lastFocused || this.pagerModule.keyAction === 'End') {\n                    pageNo = (currentPageSet * pagerObj.pageCount) + 1 + i;\n                }\n                else if (nextFocused || this.pagerModule.keyAction === 'ArrowRight' || prevFocused || this.pagerModule.keyAction === 'ArrowLeft') {\n                    if (isPageAvailable) {\n                        pageNo = parseInt(numItems[0].getAttribute('index'), 10) + i;\n                    }\n                    else if (prevFocused || this.pagerModule.keyAction === 'ArrowLeft') {\n                        pageNo = parseInt(this.PP.getAttribute('index'), 10) + i;\n                    }\n                    else {\n                        pageNo = pagerObj.currentPage + i;\n                    }\n                }\n                else if (npFocused || ppFocused) {\n                    pageNo = pagerObj.currentPage + i;\n                }\n                else if (numItemFocused) {\n                    pageNo = (parseInt(numItems[0].getAttribute('index'), 10) + i);\n                }\n                else {\n                    pageNo = (currentPageSet * pagerObj.pageCount) + 1 + i;\n                }\n            }\n            else {\n                pageNo = (currentPageSet * pagerObj.pageCount) + 1 + i;\n            }\n            if (pageNo <= pagerObj.totalPages) {\n                this.links[parseInt(i.toString(), 10)].classList.remove('e-hide');\n                this.links[parseInt(i.toString(), 10)].style.display = '';\n                this.links[parseInt(i.toString(), 10)].setAttribute('index', pageNo.toString());\n                this.links[parseInt(i.toString(), 10)].innerHTML = !pagerObj.customText ? pageNo.toString() : pagerObj.customText + pageNo;\n                if (pagerObj.currentPage !== pageNo) {\n                    this.links[parseInt(i.toString(), 10)].classList.add('e-pager-default');\n                }\n                else {\n                    this.links[parseInt(i.toString(), 10)].classList.remove('e-pager-default');\n                }\n            }\n            else {\n                this.links[parseInt(i.toString(), 10)].innerHTML = !pagerObj.customText ? pageNo.toString() : pagerObj.customText + pageNo;\n                this.links[parseInt(i.toString(), 10)].style.display = 'none';\n            }\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.links[parseInt(i.toString(), 10)], [], ['e-currentitem', 'e-active']);\n            this.links[parseInt(i.toString(), 10)].removeAttribute('aria-current');\n        }\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.first, {\n            'index': '1',\n            'title': this.pagerModule.getLocalizedLabel('firstPageTooltip')\n        });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.pagerElement.querySelector('.e-mfirst'), {\n            'index': '1',\n            'title': this.pagerModule.getLocalizedLabel('firstPageTooltip')\n        });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.last, {\n            'index': pagerObj.totalPages.toString(),\n            'title': this.pagerModule.getLocalizedLabel('lastPageTooltip')\n        });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.pagerElement.querySelector('.e-mlast'), {\n            'index': pagerObj.totalPages.toString(),\n            'title': this.pagerModule.getLocalizedLabel('lastPageTooltip')\n        });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.prev, {\n            'index': (pagerObj.currentPage - 1).toString(),\n            'title': this.pagerModule.getLocalizedLabel('previousPageTooltip')\n        });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.pagerElement.querySelector('.e-mprev'), {\n            'index': (pagerObj.currentPage - 1).toString(),\n            'title': this.pagerModule.getLocalizedLabel('previousPageTooltip')\n        });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.next, {\n            'index': (pagerObj.currentPage + 1).toString(),\n            'title': this.pagerModule.getLocalizedLabel('nextPageTooltip')\n        });\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.pagerElement.querySelector('.e-mnext'), {\n            'index': (pagerObj.currentPage + 1).toString(),\n            'title': this.pagerModule.getLocalizedLabel('nextPageTooltip')\n        });\n        var ppIndex = (this.pagerModule.isPagerResized && numItems.length)\n            ? isLastSet\n                ? parseInt(numItems[0].getAttribute('index'), 10) - pagerObj.avgNumItems\n                : parseInt(numItems[0].getAttribute('index'), 10) - numItems.length\n            : parseInt(this.links[0].getAttribute('index'), 10) - pagerObj.pageCount;\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.PP, {\n            'index': ((ppIndex < 1) ? '1' : ppIndex.toString()),\n            'title': this.pagerModule.getLocalizedLabel('previousPagerTooltip'),\n            'aria-label': this.pagerModule.getLocalizedLabel('previousPagerTooltip')\n        });\n        var NPIndex = (this.pagerModule.isPagerResized && numItems.length)\n            ? parseInt(numItems[numItems.length - 1].getAttribute('index'), 10)\n            : parseInt(this.links[this.links.length - 1].getAttribute('index'), 10);\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.attributes)(this.NP, {\n            'index': (NPIndex + 1).toString(),\n            'title': this.pagerModule.getLocalizedLabel('nextPagerTooltip'),\n            'aria-label': this.pagerModule.getLocalizedLabel('nextPagerTooltip')\n        });\n        this.target = undefined;\n    };\n    NumericContainer.prototype.updateStyles = function () {\n        var _this = this;\n        this.updateFirstNPrevStyles();\n        this.updatePrevPagerSetStyles();\n        this.updateNextPagerSetStyles();\n        this.updateNextNLastStyles();\n        if (this.links.length) {\n            var currentPageIndex = this.links.findIndex(function (link) { return link.getAttribute('index') === _this.pagerModule.currentPage.toString(); });\n            var currentPage = (this.pagerModule.isPagerResized && currentPageIndex !== -1) ? currentPageIndex\n                : ((this.pagerModule.currentPage - 1) % this.pagerModule.pageCount);\n            if (this.links[parseInt(currentPage.toString(), 10)]) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.links[parseInt(currentPage.toString(), 10)], ['e-currentitem', 'e-active'], []);\n                this.links[parseInt(currentPage.toString(), 10)].setAttribute('aria-current', 'page');\n            }\n        }\n    };\n    NumericContainer.prototype.updateFirstNPrevStyles = function () {\n        var firstPage = ['e-firstpage', 'e-pager-default'];\n        var firstPageDisabled = ['e-firstpagedisabled', 'e-disable'];\n        var prevPage = ['e-prevpage', 'e-pager-default'];\n        var prevPageDisabled = ['e-prevpagedisabled', 'e-disable'];\n        if (this.pagerModule.totalPages > 0 && this.pagerModule.currentPage > 1) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.prev, prevPage, prevPageDisabled);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.first, firstPage, firstPageDisabled);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.pagerElement.querySelector('.e-mfirst'), firstPage, firstPageDisabled);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.pagerElement.querySelector('.e-mprev'), prevPage, prevPageDisabled);\n        }\n        else {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.prev, prevPageDisabled, prevPage);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.first, firstPageDisabled, firstPage);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.pagerElement.querySelector('.e-mprev'), prevPageDisabled, prevPage);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.pagerElement.querySelector('.e-mfirst'), firstPageDisabled, firstPage);\n        }\n    };\n    NumericContainer.prototype.updatePrevPagerSetStyles = function () {\n        if (this.pagerModule.currentPage > this.pagerModule.pageCount || (this.pagerModule.isPagerResized\n            && this.links.findIndex(function (link) { return parseInt(link.getAttribute('index'), 10) === 1; }))) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.PP, ['e-numericitem', 'e-pager-default'], ['e-nextprevitemdisabled', 'e-disable']);\n        }\n        else {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.PP, ['e-nextprevitemdisabled', 'e-disable'], ['e-numericitem', 'e-pager-default']);\n        }\n    };\n    NumericContainer.prototype.updateNextPagerSetStyles = function () {\n        var pagerObj = this.pagerModule;\n        var firstPage = this.links[0].innerHTML.replace(pagerObj.customText, '');\n        var numItems = this.pagerElement.querySelectorAll('.e-numericitem:not(.e-hide):not([style*=\"display: none\"]):not(.e-np):not(.e-pp)');\n        if (!firstPage.length || !this.links.length || (parseInt(firstPage, 10) + pagerObj.pageCount > pagerObj.totalPages)\n            || (pagerObj.isPagerResized && Array.from(numItems).some(function (item) { return parseInt(item.getAttribute('index'), 10) === pagerObj.totalPages; }))) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.NP, ['e-nextprevitemdisabled', 'e-disable'], ['e-numericitem', 'e-pager-default']);\n        }\n        else {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.NP, ['e-numericitem', 'e-pager-default'], ['e-nextprevitemdisabled', 'e-disable']);\n        }\n    };\n    NumericContainer.prototype.updateNextNLastStyles = function () {\n        var lastPage = ['e-lastpage', 'e-pager-default'];\n        var lastPageDisabled = ['e-lastpagedisabled', 'e-disable'];\n        var nextPage = ['e-nextpage', 'e-pager-default'];\n        var nextPageDisabled = ['e-nextpagedisabled', 'e-disable'];\n        var pagerObj = this.pagerModule;\n        if (pagerObj.currentPage === pagerObj.totalPages || pagerObj.totalRecordsCount === 0) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.last, lastPageDisabled, lastPage);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.next, nextPageDisabled, nextPage);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.pagerElement.querySelector('.e-mlast'), lastPageDisabled, lastPage);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.pagerElement.querySelector('.e-mnext'), nextPageDisabled, nextPage);\n        }\n        else {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.last, lastPage, lastPageDisabled);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.next, nextPage, nextPageDisabled);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.pagerElement.querySelector('.e-mlast'), lastPage, lastPageDisabled);\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(this.pagerElement.querySelector('.e-mnext'), nextPage, nextPageDisabled);\n        }\n    };\n    return NumericContainer;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvcGFnZXIvbnVtZXJpYy1jb250YWluZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBeUQ7QUFDTDtBQUNnQztBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUJBQXlCO0FBQ2pELG1CQUFtQixtRUFBYTtBQUNoQztBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLGFBQWE7QUFDYjtBQUNBLGdCQUFnQiwrREFBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhEQUFZO0FBQ3BCLFFBQVEsOERBQVk7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBWTtBQUNwQixRQUFRLDhEQUFZO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGtCQUFrQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVC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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwrREFBUztBQUNyQixZQUFZLCtEQUFTO0FBQ3JCLFlBQVksK0RBQVM7QUFDckIsWUFBWSwrREFBUztBQUNyQjtBQUNBO0FBQ0EsWUFBWSwrREFBUztBQUNyQixZQUFZLCtEQUFTO0FBQ3JCLFlBQVksK0RBQVM7QUFDckIsWUFBWSwrREFBUztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCx3REFBd0Q7QUFDOUcsWUFBWSwrREFBUztBQUNyQjtBQUNBO0FBQ0EsWUFBWSwrREFBUztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVGQUF1RiwwRUFBMEU7QUFDakssWUFBWSwrREFBUztBQUNyQjtBQUNBO0FBQ0EsWUFBWSwrREFBUztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLCtEQUFTO0FBQ3JCLFlBQVksK0RBQVM7QUFDckIsWUFBWSwrREFBUztBQUNyQixZQUFZLCtEQUFTO0FBQ3JCO0FBQ0E7QUFDQSxZQUFZLCtEQUFTO0FBQ3JCLFlBQVksK0RBQVM7QUFDckIsWUFBWSwrREFBUztBQUNyQixZQUFZLCtEQUFTO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDMkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvcGFnZXIvbnVtZXJpYy1jb250YWluZXIuanM/OWZmMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc051bGxPclVuZGVmaW5lZCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IEV2ZW50SGFuZGxlciB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IGF0dHJpYnV0ZXMsIGNyZWF0ZUVsZW1lbnQsIGNsYXNzTGlzdCwgYXBwZW5kIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuLyoqXG4gKiBgTnVtZXJpY0NvbnRhaW5lcmAgbW9kdWxlIGhhbmRsZXMgcmVuZGVyaW5nIGFuZCByZWZyZXNoaW5nIG51bWVyaWMgY29udGFpbmVyLlxuICovXG52YXIgTnVtZXJpY0NvbnRhaW5lciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvciBmb3IgbnVtZXJpY0NvbnRhaW5lciBtb2R1bGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UGFnZXJ9IHBhZ2VyTW9kdWxlIC0gc3BlY2lmaWVzIHRoZSBwYWdlck1vZHVsZVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBOdW1lcmljQ29udGFpbmVyKHBhZ2VyTW9kdWxlKSB7XG4gICAgICAgIHRoaXMucGFnZXJNb2R1bGUgPSBwYWdlck1vZHVsZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVuZGVyIG51bWVyaWNDb250YWluZXJcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBOdW1lcmljQ29udGFpbmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucGFnZXJFbGVtZW50ID0gdGhpcy5wYWdlck1vZHVsZS5lbGVtZW50O1xuICAgICAgICB0aGlzLnJlbmRlck51bWVyaWNDb250YWluZXIoKTtcbiAgICAgICAgdGhpcy5yZWZyZXNoTnVtZXJpY0xpbmtzKCk7XG4gICAgICAgIHRoaXMud2lyZUV2ZW50cygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVmcmVzaGVzIHRoZSBudW1lcmljIGNvbnRhaW5lciBvZiBQYWdlci5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIE51bWVyaWNDb250YWluZXIucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucGFnZXJNb2R1bGUudXBkYXRlVG90YWxQYWdlcygpO1xuICAgICAgICBpZiAodGhpcy5saW5rcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTGlua3NIdG1sKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWZyZXNoQXJpYUF0dHJMYWJlbCgpO1xuICAgICAgICB0aGlzLnVwZGF0ZVN0eWxlcygpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIHVzZWQgdG8gcmVmcmVzaCByZWZyZXNoTnVtZXJpY0xpbmtzXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgTnVtZXJpY0NvbnRhaW5lci5wcm90b3R5cGUucmVmcmVzaE51bWVyaWNMaW5rcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxpbms7XG4gICAgICAgIHZhciBwYWdlck9iaiA9IHRoaXMucGFnZXJNb2R1bGU7XG4gICAgICAgIHZhciBkaXYgPSBwYWdlck9iai5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLW51bWVyaWNjb250YWluZXInKTtcbiAgICAgICAgdmFyIGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIGRpdi5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gcGFnZXJPYmoucGFnZUNvdW50OyBpKyspIHtcbiAgICAgICAgICAgIGxpbmsgPSBjcmVhdGVFbGVtZW50KCdhJywge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UtbGluayBlLW51bWVyaWNpdGVtIGUtc3BhY2luZyBlLXBhZ2VyLWRlZmF1bHQnLFxuICAgICAgICAgICAgICAgIGF0dHJzOiB7IHRhYmluZGV4OiAnLTEnLCAnYXJpYS1sYWJlbCc6IHBhZ2VyT2JqLmdldExvY2FsaXplZExhYmVsKCdQYWdlJykgKyBpICsgcGFnZXJPYmouZ2V0TG9jYWxpemVkTGFiZWwoJ09mJykgK1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZXJPYmoudG90YWxQYWdlcyArIHBhZ2VyT2JqLmdldExvY2FsaXplZExhYmVsKCdQYWdlcycpLCBocmVmOiAnIycgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocGFnZXJPYmouY3VycmVudFBhZ2UgPT09IGkpIHtcbiAgICAgICAgICAgICAgICBjbGFzc0xpc3QobGluaywgWydlLWN1cnJlbnRpdGVtJywgJ2UtYWN0aXZlJ10sIFsnZS1wYWdlci1kZWZhdWx0J10pO1xuICAgICAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdhcmlhLWN1cnJlbnQnLCAncGFnZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZChsaW5rKTtcbiAgICAgICAgfVxuICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoZnJhZyk7XG4gICAgICAgIHRoaXMubGlua3MgPSBbXS5zbGljZS5jYWxsKGRpdi5jaGlsZE5vZGVzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEJpbmRpbmcgZXZlbnRzIHRvIHRoZSBlbGVtZW50IHdoaWxlIGNvbXBvbmVudCBjcmVhdGlvblxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIE51bWVyaWNDb250YWluZXIucHJvdG90eXBlLndpcmVFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5wYWdlckVsZW1lbnQsICdjbGljaycsIHRoaXMuY2xpY2tIYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnBhZ2VyRWxlbWVudCwgJ2F1eGNsaWNrJywgdGhpcy5hdXhpbGlhcnlDbGlja0hhbmRsZXIsIHRoaXMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVW5iaW5kaW5nIGV2ZW50cyBmcm9tIHRoZSBlbGVtZW50IHdoaWxlIGNvbXBvbmVudCBkZXN0cm95XG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgTnVtZXJpY0NvbnRhaW5lci5wcm90b3R5cGUudW53aXJlRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMucGFnZXJNb2R1bGUuZWxlbWVudCwgJ2NsaWNrJywgdGhpcy5jbGlja0hhbmRsZXIpO1xuICAgICAgICBFdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMucGFnZXJNb2R1bGUuZWxlbWVudCwgJ2F1eGNsaWNrJywgdGhpcy5hdXhpbGlhcnlDbGlja0hhbmRsZXIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVG8gZGVzdHJveSB0aGUgUGFnZXJNZXNzYWdlXG4gICAgICpcbiAgICAgKiBAZnVuY3Rpb24gZGVzdHJveVxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBOdW1lcmljQ29udGFpbmVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnVud2lyZUV2ZW50cygpO1xuICAgIH07XG4gICAgTnVtZXJpY0NvbnRhaW5lci5wcm90b3R5cGUucmVmcmVzaEFyaWFBdHRyTGFiZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYWdlck9iaiA9IHRoaXMucGFnZXJNb2R1bGU7XG4gICAgICAgIHZhciBudW1lcmljQ29udGFpbmVyID0gcGFnZXJPYmouZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1udW1lcmljY29udGFpbmVyJyk7XG4gICAgICAgIHZhciBsaW5rcyA9IG51bWVyaWNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnYScpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobGlua3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmhhc0F0dHJpYnV0ZSgnYXJpYS1sYWJlbCcpICYmIGxpbmtzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5oYXNBdHRyaWJ1dGUoJ2luZGV4JykpIHtcbiAgICAgICAgICAgICAgICBsaW5rc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgcGFnZXJPYmouZ2V0TG9jYWxpemVkTGFiZWwoJ1BhZ2UnKSArIGxpbmtzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5nZXRBdHRyaWJ1dGUoJ2luZGV4JylcbiAgICAgICAgICAgICAgICAgICAgKyBwYWdlck9iai5nZXRMb2NhbGl6ZWRMYWJlbCgnT2YnKSArIHBhZ2VyT2JqLnRvdGFsUGFnZXMgKyBwYWdlck9iai5nZXRMb2NhbGl6ZWRMYWJlbCgnUGFnZXMnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE51bWVyaWNDb250YWluZXIucHJvdG90eXBlLnJlbmRlck51bWVyaWNDb250YWluZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UtcGFnZXJjb250YWluZXInLCBhdHRyczogeyAncm9sZSc6ICduYXZpZ2F0aW9uJyB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlbmRlckZpcnN0TlByZXYodGhpcy5lbGVtZW50KTtcbiAgICAgICAgdGhpcy5yZW5kZXJQcmV2UGFnZXJTZXQodGhpcy5lbGVtZW50KTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnZS1udW1lcmljY29udGFpbmVyJyB9KSk7XG4gICAgICAgIHRoaXMucmVuZGVyTmV4dFBhZ2VyU2V0KHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHRoaXMucmVuZGVyTmV4dE5MYXN0KHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHRoaXMucGFnZXJNb2R1bGUuZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgIH07XG4gICAgTnVtZXJpY0NvbnRhaW5lci5wcm90b3R5cGUucmVuZGVyRmlyc3ROUHJldiA9IGZ1bmN0aW9uIChwYWdlckNvbnRhaW5lcikge1xuICAgICAgICB0aGlzLmZpcnN0ID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiAnZS1maXJzdCBlLWljb25zIGUtaWNvbi1maXJzdCcsXG4gICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnBhZ2VyTW9kdWxlLmdldExvY2FsaXplZExhYmVsKCdmaXJzdFBhZ2VUb29sdGlwJyksXG4gICAgICAgICAgICAgICAgdGFiaW5kZXg6ICctMScsIHJvbGU6ICdidXR0b24nXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnByZXYgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICBjbGFzc05hbWU6ICdlLXByZXYgZS1pY29ucyBlLWljb24tcHJldicsXG4gICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnBhZ2VyTW9kdWxlLmdldExvY2FsaXplZExhYmVsKCdwcmV2aW91c1BhZ2VUb29sdGlwJyksXG4gICAgICAgICAgICAgICAgdGFiaW5kZXg6ICctMScsIHJvbGU6ICdidXR0b24nXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBhcHBlbmQoW3RoaXMuZmlyc3QsIHRoaXMucHJldl0sIHBhZ2VyQ29udGFpbmVyKTtcbiAgICB9O1xuICAgIE51bWVyaWNDb250YWluZXIucHJvdG90eXBlLnJlbmRlclByZXZQYWdlclNldCA9IGZ1bmN0aW9uIChwYWdlckNvbnRhaW5lcikge1xuICAgICAgICB2YXIgcHJldlBhZ2VyID0gY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuUFAgPSBjcmVhdGVFbGVtZW50KCdhJywge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiAnZS1saW5rIGUtcHAgZS1zcGFjaW5nJywgaW5uZXJIVE1MOiAnLi4uJyxcbiAgICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMucGFnZXJNb2R1bGUuZ2V0TG9jYWxpemVkTGFiZWwoJ3ByZXZpb3VzUGFnZXJUb29sdGlwJyksXG4gICAgICAgICAgICAgICAgJ2FyaWEtbGFiZWwnOiB0aGlzLnBhZ2VyTW9kdWxlLmdldExvY2FsaXplZExhYmVsKCdwcmV2aW91c1BhZ2VyVG9vbHRpcCcpLFxuICAgICAgICAgICAgICAgIHRhYmluZGV4OiAnLTEnLFxuICAgICAgICAgICAgICAgIGhyZWY6ICcjJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcHJldlBhZ2VyLmFwcGVuZENoaWxkKHRoaXMuUFApO1xuICAgICAgICBwYWdlckNvbnRhaW5lci5hcHBlbmRDaGlsZChwcmV2UGFnZXIpO1xuICAgIH07XG4gICAgTnVtZXJpY0NvbnRhaW5lci5wcm90b3R5cGUucmVuZGVyTmV4dFBhZ2VyU2V0ID0gZnVuY3Rpb24gKHBhZ2VyQ29udGFpbmVyKSB7XG4gICAgICAgIHZhciBuZXh0UGFnZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5OUCA9IGNyZWF0ZUVsZW1lbnQoJ2EnLCB7XG4gICAgICAgICAgICBjbGFzc05hbWU6ICdlLWxpbmsgZS1ucCBlLXNwYWNpbmcnLFxuICAgICAgICAgICAgaW5uZXJIVE1MOiAnLi4uJywgYXR0cnM6IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy5wYWdlck1vZHVsZS5nZXRMb2NhbGl6ZWRMYWJlbCgnbmV4dFBhZ2VyVG9vbHRpcCcpLFxuICAgICAgICAgICAgICAgICdhcmlhLWxhYmVsJzogdGhpcy5wYWdlck1vZHVsZS5nZXRMb2NhbGl6ZWRMYWJlbCgnbmV4dFBhZ2VyVG9vbHRpcCcpLFxuICAgICAgICAgICAgICAgIHRhYmluZGV4OiAnLTEnLFxuICAgICAgICAgICAgICAgIGhyZWY6ICcjJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbmV4dFBhZ2VyLmFwcGVuZENoaWxkKHRoaXMuTlApO1xuICAgICAgICBwYWdlckNvbnRhaW5lci5hcHBlbmRDaGlsZChuZXh0UGFnZXIpO1xuICAgIH07XG4gICAgTnVtZXJpY0NvbnRhaW5lci5wcm90b3R5cGUucmVuZGVyTmV4dE5MYXN0ID0gZnVuY3Rpb24gKHBhZ2VyQ29udGFpbmVyKSB7XG4gICAgICAgIHRoaXMubmV4dCA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UtbmV4dCBlLWljb25zIGUtaWNvbi1uZXh0JyxcbiAgICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMucGFnZXJNb2R1bGUuZ2V0TG9jYWxpemVkTGFiZWwoJ25leHRQYWdlVG9vbHRpcCcpLFxuICAgICAgICAgICAgICAgIHRhYmluZGV4OiAnLTEnLCByb2xlOiAnYnV0dG9uJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sYXN0ID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiAnZS1sYXN0IGUtaWNvbnMgZS1pY29uLWxhc3QnLFxuICAgICAgICAgICAgYXR0cnM6IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy5wYWdlck1vZHVsZS5nZXRMb2NhbGl6ZWRMYWJlbCgnbGFzdFBhZ2VUb29sdGlwJyksXG4gICAgICAgICAgICAgICAgdGFiaW5kZXg6ICctMScsIHJvbGU6ICdidXR0b24nXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBhcHBlbmQoW3RoaXMubmV4dCwgdGhpcy5sYXN0XSwgcGFnZXJDb250YWluZXIpO1xuICAgIH07XG4gICAgTnVtZXJpY0NvbnRhaW5lci5wcm90b3R5cGUuY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHBhZ2VyT2JqID0gdGhpcy5wYWdlck1vZHVsZTtcbiAgICAgICAgdGhpcy50YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1udW1lcmljaXRlbScpKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcGFnZXJPYmoucHJldmlvdXNQYWdlTm8gPSBwYWdlck9iai5jdXJyZW50UGFnZTtcbiAgICAgICAgaWYgKCF0aGlzLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZGlzYWJsZScpICYmICFpc051bGxPclVuZGVmaW5lZCh0aGlzLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2luZGV4JykpKSB7XG4gICAgICAgICAgICBwYWdlck9iai5jdXJyZW50UGFnZSA9IHBhcnNlSW50KHRoaXMudGFyZ2V0LmdldEF0dHJpYnV0ZSgnaW5kZXgnKSwgMTApO1xuICAgICAgICAgICAgdGhpcy5wYWdlck1vZHVsZS5pc0ludGVyYWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgcGFnZXJPYmouZGF0YUJpbmQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBOdW1lcmljQ29udGFpbmVyLnByb3RvdHlwZS5hdXhpbGlhcnlDbGlja0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB0aGlzLnRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICBpZiAodGhpcy50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLW51bWVyaWNpdGVtJykgJiYgKGUuYnV0dG9uID09PSAxKSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBOdW1lcmljQ29udGFpbmVyLnByb3RvdHlwZS51cGRhdGVMaW5rc0h0bWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYWdlck9iaiA9IHRoaXMucGFnZXJNb2R1bGU7XG4gICAgICAgIHZhciBjdXJyZW50UGFnZVNldDtcbiAgICAgICAgdmFyIGlzTGFzdFNldDtcbiAgICAgICAgdmFyIHBhZ2VObztcbiAgICAgICAgdmFyIG51bUl0ZW1zID0gdGhpcy5wYWdlckVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtbnVtZXJpY2l0ZW06bm90KC5lLWhpZGUpOm5vdChbc3R5bGUqPVwiZGlzcGxheTogbm9uZVwiXSk6bm90KC5lLW5wKTpub3QoLmUtcHApJyk7XG4gICAgICAgIHBhZ2VyT2JqLmN1cnJlbnRQYWdlID0gcGFnZXJPYmoudG90YWxQYWdlcyA9PT0gMSA/IDEgOiBwYWdlck9iai5jdXJyZW50UGFnZTtcbiAgICAgICAgaWYgKHBhZ2VyT2JqLmN1cnJlbnRQYWdlID4gcGFnZXJPYmoudG90YWxQYWdlcyAmJiBwYWdlck9iai50b3RhbFBhZ2VzKSB7XG4gICAgICAgICAgICBwYWdlck9iai5jdXJyZW50UGFnZSA9IHBhZ2VyT2JqLnRvdGFsUGFnZXM7XG4gICAgICAgIH1cbiAgICAgICAgY3VycmVudFBhZ2VTZXQgPSBwYXJzZUludCgocGFnZXJPYmouY3VycmVudFBhZ2UgLyBwYWdlck9iai5wYWdlQ291bnQpLnRvU3RyaW5nKCksIDEwKTtcbiAgICAgICAgaWYgKHBhZ2VyT2JqLmN1cnJlbnRQYWdlICUgcGFnZXJPYmoucGFnZUNvdW50ID09PSAwICYmIGN1cnJlbnRQYWdlU2V0ID4gMCkge1xuICAgICAgICAgICAgY3VycmVudFBhZ2VTZXQgPSBjdXJyZW50UGFnZVNldCAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYWdlck9iai5wYWdlQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKHBhZ2VyT2JqLmlzUGFnZXJSZXNpemVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzZWRJdGVtID0gdGhpcy5wYWdlckVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZm9jdXMnKTtcbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNlZG9yVGFyZ2V0ID0gdGhpcy50YXJnZXQgPyB0aGlzLnRhcmdldCA6IGZvY3VzZWRJdGVtID8gZm9jdXNlZEl0ZW0gOiBudWxsO1xuICAgICAgICAgICAgICAgIHZhciBwcmV2Rm9jdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBuZXh0Rm9jdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBmaXJzdEZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgbGFzdEZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgbnVtSXRlbUZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgbnBGb2N1c2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIHBwRm9jdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChmb2N1c2Vkb3JUYXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNsYXNzTGlzdF8xID0gZm9jdXNlZG9yVGFyZ2V0LmNsYXNzTGlzdDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzTGlzdF8xLmNvbnRhaW5zKCdlLWljb25zJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgY2xhc3NMaXN0XzEuY29udGFpbnMoJ2UtcHJldicpOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2Rm9jdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgY2xhc3NMaXN0XzEuY29udGFpbnMoJ2UtbmV4dCcpOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0Rm9jdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgY2xhc3NMaXN0XzEuY29udGFpbnMoJ2UtZmlyc3QnKTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RGb2N1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBjbGFzc0xpc3RfMS5jb250YWlucygnZS1sYXN0Jyk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RGb2N1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoY2xhc3NMaXN0XzEuY29udGFpbnMoJ2UtbnVtZXJpY2l0ZW0nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBjbGFzc0xpc3RfMS5jb250YWlucygnZS1ucCcpOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBucEZvY3VzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGNsYXNzTGlzdF8xLmNvbnRhaW5zKCdlLXBwJyk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBwRm9jdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bUl0ZW1Gb2N1c2VkID0gY2xhc3NMaXN0XzEuY29udGFpbnMoJ2UtbnVtZXJpY2l0ZW0nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaXNMYXN0U2V0ID0gbGFzdEZvY3VzZWQgfHwgKHRoaXMucGFnZXJNb2R1bGUua2V5QWN0aW9uID09PSAnRW5kJyk7XG4gICAgICAgICAgICAgICAgbnVtSXRlbXMgPSB0aGlzLnBhZ2VyRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZS1udW1lcmljaXRlbTpub3QoLmUtaGlkZSk6bm90KFtzdHlsZSo9XCJkaXNwbGF5OiBub25lXCJdKTpub3QoLmUtbnApOm5vdCguZS1wcCknKTtcbiAgICAgICAgICAgICAgICB2YXIgaXNQYWdlQXZhaWxhYmxlID0gQXJyYXkuZnJvbShudW1JdGVtcykuc29tZShmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gcGFyc2VJbnQoaXRlbS5nZXRBdHRyaWJ1dGUoJ2luZGV4JyksIDEwKSA9PT0gcGFnZXJPYmouY3VycmVudFBhZ2U7IH0pO1xuICAgICAgICAgICAgICAgIC8vU2V0dGluZyBwYWdlTm8gdG8gcmVuZGVyIGJhc2VkIG9uIGtleSBhY3Rpb24gb3IgY2xpY2sgYWN0aW9uLlxuICAgICAgICAgICAgICAgIGlmIChmaXJzdEZvY3VzZWQgfHwgdGhpcy5wYWdlck1vZHVsZS5rZXlBY3Rpb24gPT09ICdIb21lJykge1xuICAgICAgICAgICAgICAgICAgICBwYWdlTm8gPSAxICsgaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobGFzdEZvY3VzZWQgfHwgdGhpcy5wYWdlck1vZHVsZS5rZXlBY3Rpb24gPT09ICdFbmQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VObyA9IChjdXJyZW50UGFnZVNldCAqIHBhZ2VyT2JqLnBhZ2VDb3VudCkgKyAxICsgaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobmV4dEZvY3VzZWQgfHwgdGhpcy5wYWdlck1vZHVsZS5rZXlBY3Rpb24gPT09ICdBcnJvd1JpZ2h0JyB8fCBwcmV2Rm9jdXNlZCB8fCB0aGlzLnBhZ2VyTW9kdWxlLmtleUFjdGlvbiA9PT0gJ0Fycm93TGVmdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzUGFnZUF2YWlsYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZU5vID0gcGFyc2VJbnQobnVtSXRlbXNbMF0uZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkgKyBpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHByZXZGb2N1c2VkIHx8IHRoaXMucGFnZXJNb2R1bGUua2V5QWN0aW9uID09PSAnQXJyb3dMZWZ0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZU5vID0gcGFyc2VJbnQodGhpcy5QUC5nZXRBdHRyaWJ1dGUoJ2luZGV4JyksIDEwKSArIGk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlTm8gPSBwYWdlck9iai5jdXJyZW50UGFnZSArIGk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobnBGb2N1c2VkIHx8IHBwRm9jdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICBwYWdlTm8gPSBwYWdlck9iai5jdXJyZW50UGFnZSArIGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG51bUl0ZW1Gb2N1c2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VObyA9IChwYXJzZUludChudW1JdGVtc1swXS5nZXRBdHRyaWJ1dGUoJ2luZGV4JyksIDEwKSArIGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZU5vID0gKGN1cnJlbnRQYWdlU2V0ICogcGFnZXJPYmoucGFnZUNvdW50KSArIDEgKyBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhZ2VObyA9IChjdXJyZW50UGFnZVNldCAqIHBhZ2VyT2JqLnBhZ2VDb3VudCkgKyAxICsgaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYWdlTm8gPD0gcGFnZXJPYmoudG90YWxQYWdlcykge1xuICAgICAgICAgICAgICAgIHRoaXMubGlua3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5yZW1vdmUoJ2UtaGlkZScpO1xuICAgICAgICAgICAgICAgIHRoaXMubGlua3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmtzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5zZXRBdHRyaWJ1dGUoJ2luZGV4JywgcGFnZU5vLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIHRoaXMubGlua3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmlubmVySFRNTCA9ICFwYWdlck9iai5jdXN0b21UZXh0ID8gcGFnZU5vLnRvU3RyaW5nKCkgOiBwYWdlck9iai5jdXN0b21UZXh0ICsgcGFnZU5vO1xuICAgICAgICAgICAgICAgIGlmIChwYWdlck9iai5jdXJyZW50UGFnZSAhPT0gcGFnZU5vKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlua3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5hZGQoJ2UtcGFnZXItZGVmYXVsdCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saW5rc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uY2xhc3NMaXN0LnJlbW92ZSgnZS1wYWdlci1kZWZhdWx0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saW5rc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uaW5uZXJIVE1MID0gIXBhZ2VyT2JqLmN1c3RvbVRleHQgPyBwYWdlTm8udG9TdHJpbmcoKSA6IHBhZ2VyT2JqLmN1c3RvbVRleHQgKyBwYWdlTm87XG4gICAgICAgICAgICAgICAgdGhpcy5saW5rc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLmxpbmtzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSwgW10sIFsnZS1jdXJyZW50aXRlbScsICdlLWFjdGl2ZSddKTtcbiAgICAgICAgICAgIHRoaXMubGlua3NbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1jdXJyZW50Jyk7XG4gICAgICAgIH1cbiAgICAgICAgYXR0cmlidXRlcyh0aGlzLmZpcnN0LCB7XG4gICAgICAgICAgICAnaW5kZXgnOiAnMScsXG4gICAgICAgICAgICAndGl0bGUnOiB0aGlzLnBhZ2VyTW9kdWxlLmdldExvY2FsaXplZExhYmVsKCdmaXJzdFBhZ2VUb29sdGlwJylcbiAgICAgICAgfSk7XG4gICAgICAgIGF0dHJpYnV0ZXModGhpcy5wYWdlckVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtbWZpcnN0JyksIHtcbiAgICAgICAgICAgICdpbmRleCc6ICcxJyxcbiAgICAgICAgICAgICd0aXRsZSc6IHRoaXMucGFnZXJNb2R1bGUuZ2V0TG9jYWxpemVkTGFiZWwoJ2ZpcnN0UGFnZVRvb2x0aXAnKVxuICAgICAgICB9KTtcbiAgICAgICAgYXR0cmlidXRlcyh0aGlzLmxhc3QsIHtcbiAgICAgICAgICAgICdpbmRleCc6IHBhZ2VyT2JqLnRvdGFsUGFnZXMudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICd0aXRsZSc6IHRoaXMucGFnZXJNb2R1bGUuZ2V0TG9jYWxpemVkTGFiZWwoJ2xhc3RQYWdlVG9vbHRpcCcpXG4gICAgICAgIH0pO1xuICAgICAgICBhdHRyaWJ1dGVzKHRoaXMucGFnZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLW1sYXN0JyksIHtcbiAgICAgICAgICAgICdpbmRleCc6IHBhZ2VyT2JqLnRvdGFsUGFnZXMudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICd0aXRsZSc6IHRoaXMucGFnZXJNb2R1bGUuZ2V0TG9jYWxpemVkTGFiZWwoJ2xhc3RQYWdlVG9vbHRpcCcpXG4gICAgICAgIH0pO1xuICAgICAgICBhdHRyaWJ1dGVzKHRoaXMucHJldiwge1xuICAgICAgICAgICAgJ2luZGV4JzogKHBhZ2VyT2JqLmN1cnJlbnRQYWdlIC0gMSkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICd0aXRsZSc6IHRoaXMucGFnZXJNb2R1bGUuZ2V0TG9jYWxpemVkTGFiZWwoJ3ByZXZpb3VzUGFnZVRvb2x0aXAnKVxuICAgICAgICB9KTtcbiAgICAgICAgYXR0cmlidXRlcyh0aGlzLnBhZ2VyRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1tcHJldicpLCB7XG4gICAgICAgICAgICAnaW5kZXgnOiAocGFnZXJPYmouY3VycmVudFBhZ2UgLSAxKS50b1N0cmluZygpLFxuICAgICAgICAgICAgJ3RpdGxlJzogdGhpcy5wYWdlck1vZHVsZS5nZXRMb2NhbGl6ZWRMYWJlbCgncHJldmlvdXNQYWdlVG9vbHRpcCcpXG4gICAgICAgIH0pO1xuICAgICAgICBhdHRyaWJ1dGVzKHRoaXMubmV4dCwge1xuICAgICAgICAgICAgJ2luZGV4JzogKHBhZ2VyT2JqLmN1cnJlbnRQYWdlICsgMSkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICd0aXRsZSc6IHRoaXMucGFnZXJNb2R1bGUuZ2V0TG9jYWxpemVkTGFiZWwoJ25leHRQYWdlVG9vbHRpcCcpXG4gICAgICAgIH0pO1xuICAgICAgICBhdHRyaWJ1dGVzKHRoaXMucGFnZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLW1uZXh0JyksIHtcbiAgICAgICAgICAgICdpbmRleCc6IChwYWdlck9iai5jdXJyZW50UGFnZSArIDEpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAndGl0bGUnOiB0aGlzLnBhZ2VyTW9kdWxlLmdldExvY2FsaXplZExhYmVsKCduZXh0UGFnZVRvb2x0aXAnKVxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHBwSW5kZXggPSAodGhpcy5wYWdlck1vZHVsZS5pc1BhZ2VyUmVzaXplZCAmJiBudW1JdGVtcy5sZW5ndGgpXG4gICAgICAgICAgICA/IGlzTGFzdFNldFxuICAgICAgICAgICAgICAgID8gcGFyc2VJbnQobnVtSXRlbXNbMF0uZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkgLSBwYWdlck9iai5hdmdOdW1JdGVtc1xuICAgICAgICAgICAgICAgIDogcGFyc2VJbnQobnVtSXRlbXNbMF0uZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkgLSBudW1JdGVtcy5sZW5ndGhcbiAgICAgICAgICAgIDogcGFyc2VJbnQodGhpcy5saW5rc1swXS5nZXRBdHRyaWJ1dGUoJ2luZGV4JyksIDEwKSAtIHBhZ2VyT2JqLnBhZ2VDb3VudDtcbiAgICAgICAgYXR0cmlidXRlcyh0aGlzLlBQLCB7XG4gICAgICAgICAgICAnaW5kZXgnOiAoKHBwSW5kZXggPCAxKSA/ICcxJyA6IHBwSW5kZXgudG9TdHJpbmcoKSksXG4gICAgICAgICAgICAndGl0bGUnOiB0aGlzLnBhZ2VyTW9kdWxlLmdldExvY2FsaXplZExhYmVsKCdwcmV2aW91c1BhZ2VyVG9vbHRpcCcpLFxuICAgICAgICAgICAgJ2FyaWEtbGFiZWwnOiB0aGlzLnBhZ2VyTW9kdWxlLmdldExvY2FsaXplZExhYmVsKCdwcmV2aW91c1BhZ2VyVG9vbHRpcCcpXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgTlBJbmRleCA9ICh0aGlzLnBhZ2VyTW9kdWxlLmlzUGFnZXJSZXNpemVkICYmIG51bUl0ZW1zLmxlbmd0aClcbiAgICAgICAgICAgID8gcGFyc2VJbnQobnVtSXRlbXNbbnVtSXRlbXMubGVuZ3RoIC0gMV0uZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMClcbiAgICAgICAgICAgIDogcGFyc2VJbnQodGhpcy5saW5rc1t0aGlzLmxpbmtzLmxlbmd0aCAtIDFdLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSwgMTApO1xuICAgICAgICBhdHRyaWJ1dGVzKHRoaXMuTlAsIHtcbiAgICAgICAgICAgICdpbmRleCc6IChOUEluZGV4ICsgMSkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICd0aXRsZSc6IHRoaXMucGFnZXJNb2R1bGUuZ2V0TG9jYWxpemVkTGFiZWwoJ25leHRQYWdlclRvb2x0aXAnKSxcbiAgICAgICAgICAgICdhcmlhLWxhYmVsJzogdGhpcy5wYWdlck1vZHVsZS5nZXRMb2NhbGl6ZWRMYWJlbCgnbmV4dFBhZ2VyVG9vbHRpcCcpXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnRhcmdldCA9IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIE51bWVyaWNDb250YWluZXIucHJvdG90eXBlLnVwZGF0ZVN0eWxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy51cGRhdGVGaXJzdE5QcmV2U3R5bGVzKCk7XG4gICAgICAgIHRoaXMudXBkYXRlUHJldlBhZ2VyU2V0U3R5bGVzKCk7XG4gICAgICAgIHRoaXMudXBkYXRlTmV4dFBhZ2VyU2V0U3R5bGVzKCk7XG4gICAgICAgIHRoaXMudXBkYXRlTmV4dE5MYXN0U3R5bGVzKCk7XG4gICAgICAgIGlmICh0aGlzLmxpbmtzLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRQYWdlSW5kZXggPSB0aGlzLmxpbmtzLmZpbmRJbmRleChmdW5jdGlvbiAobGluaykgeyByZXR1cm4gbGluay5nZXRBdHRyaWJ1dGUoJ2luZGV4JykgPT09IF90aGlzLnBhZ2VyTW9kdWxlLmN1cnJlbnRQYWdlLnRvU3RyaW5nKCk7IH0pO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRQYWdlID0gKHRoaXMucGFnZXJNb2R1bGUuaXNQYWdlclJlc2l6ZWQgJiYgY3VycmVudFBhZ2VJbmRleCAhPT0gLTEpID8gY3VycmVudFBhZ2VJbmRleFxuICAgICAgICAgICAgICAgIDogKCh0aGlzLnBhZ2VyTW9kdWxlLmN1cnJlbnRQYWdlIC0gMSkgJSB0aGlzLnBhZ2VyTW9kdWxlLnBhZ2VDb3VudCk7XG4gICAgICAgICAgICBpZiAodGhpcy5saW5rc1twYXJzZUludChjdXJyZW50UGFnZS50b1N0cmluZygpLCAxMCldKSB7XG4gICAgICAgICAgICAgICAgY2xhc3NMaXN0KHRoaXMubGlua3NbcGFyc2VJbnQoY3VycmVudFBhZ2UudG9TdHJpbmcoKSwgMTApXSwgWydlLWN1cnJlbnRpdGVtJywgJ2UtYWN0aXZlJ10sIFtdKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmtzW3BhcnNlSW50KGN1cnJlbnRQYWdlLnRvU3RyaW5nKCksIDEwKV0uc2V0QXR0cmlidXRlKCdhcmlhLWN1cnJlbnQnLCAncGFnZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBOdW1lcmljQ29udGFpbmVyLnByb3RvdHlwZS51cGRhdGVGaXJzdE5QcmV2U3R5bGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZmlyc3RQYWdlID0gWydlLWZpcnN0cGFnZScsICdlLXBhZ2VyLWRlZmF1bHQnXTtcbiAgICAgICAgdmFyIGZpcnN0UGFnZURpc2FibGVkID0gWydlLWZpcnN0cGFnZWRpc2FibGVkJywgJ2UtZGlzYWJsZSddO1xuICAgICAgICB2YXIgcHJldlBhZ2UgPSBbJ2UtcHJldnBhZ2UnLCAnZS1wYWdlci1kZWZhdWx0J107XG4gICAgICAgIHZhciBwcmV2UGFnZURpc2FibGVkID0gWydlLXByZXZwYWdlZGlzYWJsZWQnLCAnZS1kaXNhYmxlJ107XG4gICAgICAgIGlmICh0aGlzLnBhZ2VyTW9kdWxlLnRvdGFsUGFnZXMgPiAwICYmIHRoaXMucGFnZXJNb2R1bGUuY3VycmVudFBhZ2UgPiAxKSB7XG4gICAgICAgICAgICBjbGFzc0xpc3QodGhpcy5wcmV2LCBwcmV2UGFnZSwgcHJldlBhZ2VEaXNhYmxlZCk7XG4gICAgICAgICAgICBjbGFzc0xpc3QodGhpcy5maXJzdCwgZmlyc3RQYWdlLCBmaXJzdFBhZ2VEaXNhYmxlZCk7XG4gICAgICAgICAgICBjbGFzc0xpc3QodGhpcy5wYWdlckVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtbWZpcnN0JyksIGZpcnN0UGFnZSwgZmlyc3RQYWdlRGlzYWJsZWQpO1xuICAgICAgICAgICAgY2xhc3NMaXN0KHRoaXMucGFnZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLW1wcmV2JyksIHByZXZQYWdlLCBwcmV2UGFnZURpc2FibGVkKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLnByZXYsIHByZXZQYWdlRGlzYWJsZWQsIHByZXZQYWdlKTtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLmZpcnN0LCBmaXJzdFBhZ2VEaXNhYmxlZCwgZmlyc3RQYWdlKTtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLnBhZ2VyRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1tcHJldicpLCBwcmV2UGFnZURpc2FibGVkLCBwcmV2UGFnZSk7XG4gICAgICAgICAgICBjbGFzc0xpc3QodGhpcy5wYWdlckVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtbWZpcnN0JyksIGZpcnN0UGFnZURpc2FibGVkLCBmaXJzdFBhZ2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBOdW1lcmljQ29udGFpbmVyLnByb3RvdHlwZS51cGRhdGVQcmV2UGFnZXJTZXRTdHlsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBhZ2VyTW9kdWxlLmN1cnJlbnRQYWdlID4gdGhpcy5wYWdlck1vZHVsZS5wYWdlQ291bnQgfHwgKHRoaXMucGFnZXJNb2R1bGUuaXNQYWdlclJlc2l6ZWRcbiAgICAgICAgICAgICYmIHRoaXMubGlua3MuZmluZEluZGV4KGZ1bmN0aW9uIChsaW5rKSB7IHJldHVybiBwYXJzZUludChsaW5rLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSwgMTApID09PSAxOyB9KSkpIHtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLlBQLCBbJ2UtbnVtZXJpY2l0ZW0nLCAnZS1wYWdlci1kZWZhdWx0J10sIFsnZS1uZXh0cHJldml0ZW1kaXNhYmxlZCcsICdlLWRpc2FibGUnXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjbGFzc0xpc3QodGhpcy5QUCwgWydlLW5leHRwcmV2aXRlbWRpc2FibGVkJywgJ2UtZGlzYWJsZSddLCBbJ2UtbnVtZXJpY2l0ZW0nLCAnZS1wYWdlci1kZWZhdWx0J10pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBOdW1lcmljQ29udGFpbmVyLnByb3RvdHlwZS51cGRhdGVOZXh0UGFnZXJTZXRTdHlsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYWdlck9iaiA9IHRoaXMucGFnZXJNb2R1bGU7XG4gICAgICAgIHZhciBmaXJzdFBhZ2UgPSB0aGlzLmxpbmtzWzBdLmlubmVySFRNTC5yZXBsYWNlKHBhZ2VyT2JqLmN1c3RvbVRleHQsICcnKTtcbiAgICAgICAgdmFyIG51bUl0ZW1zID0gdGhpcy5wYWdlckVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtbnVtZXJpY2l0ZW06bm90KC5lLWhpZGUpOm5vdChbc3R5bGUqPVwiZGlzcGxheTogbm9uZVwiXSk6bm90KC5lLW5wKTpub3QoLmUtcHApJyk7XG4gICAgICAgIGlmICghZmlyc3RQYWdlLmxlbmd0aCB8fCAhdGhpcy5saW5rcy5sZW5ndGggfHwgKHBhcnNlSW50KGZpcnN0UGFnZSwgMTApICsgcGFnZXJPYmoucGFnZUNvdW50ID4gcGFnZXJPYmoudG90YWxQYWdlcylcbiAgICAgICAgICAgIHx8IChwYWdlck9iai5pc1BhZ2VyUmVzaXplZCAmJiBBcnJheS5mcm9tKG51bUl0ZW1zKS5zb21lKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBwYXJzZUludChpdGVtLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSwgMTApID09PSBwYWdlck9iai50b3RhbFBhZ2VzOyB9KSkpIHtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLk5QLCBbJ2UtbmV4dHByZXZpdGVtZGlzYWJsZWQnLCAnZS1kaXNhYmxlJ10sIFsnZS1udW1lcmljaXRlbScsICdlLXBhZ2VyLWRlZmF1bHQnXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjbGFzc0xpc3QodGhpcy5OUCwgWydlLW51bWVyaWNpdGVtJywgJ2UtcGFnZXItZGVmYXVsdCddLCBbJ2UtbmV4dHByZXZpdGVtZGlzYWJsZWQnLCAnZS1kaXNhYmxlJ10pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBOdW1lcmljQ29udGFpbmVyLnByb3RvdHlwZS51cGRhdGVOZXh0Tkxhc3RTdHlsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsYXN0UGFnZSA9IFsnZS1sYXN0cGFnZScsICdlLXBhZ2VyLWRlZmF1bHQnXTtcbiAgICAgICAgdmFyIGxhc3RQYWdlRGlzYWJsZWQgPSBbJ2UtbGFzdHBhZ2VkaXNhYmxlZCcsICdlLWRpc2FibGUnXTtcbiAgICAgICAgdmFyIG5leHRQYWdlID0gWydlLW5leHRwYWdlJywgJ2UtcGFnZXItZGVmYXVsdCddO1xuICAgICAgICB2YXIgbmV4dFBhZ2VEaXNhYmxlZCA9IFsnZS1uZXh0cGFnZWRpc2FibGVkJywgJ2UtZGlzYWJsZSddO1xuICAgICAgICB2YXIgcGFnZXJPYmogPSB0aGlzLnBhZ2VyTW9kdWxlO1xuICAgICAgICBpZiAocGFnZXJPYmouY3VycmVudFBhZ2UgPT09IHBhZ2VyT2JqLnRvdGFsUGFnZXMgfHwgcGFnZXJPYmoudG90YWxSZWNvcmRzQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLmxhc3QsIGxhc3RQYWdlRGlzYWJsZWQsIGxhc3RQYWdlKTtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLm5leHQsIG5leHRQYWdlRGlzYWJsZWQsIG5leHRQYWdlKTtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLnBhZ2VyRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1tbGFzdCcpLCBsYXN0UGFnZURpc2FibGVkLCBsYXN0UGFnZSk7XG4gICAgICAgICAgICBjbGFzc0xpc3QodGhpcy5wYWdlckVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtbW5leHQnKSwgbmV4dFBhZ2VEaXNhYmxlZCwgbmV4dFBhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY2xhc3NMaXN0KHRoaXMubGFzdCwgbGFzdFBhZ2UsIGxhc3RQYWdlRGlzYWJsZWQpO1xuICAgICAgICAgICAgY2xhc3NMaXN0KHRoaXMubmV4dCwgbmV4dFBhZ2UsIG5leHRQYWdlRGlzYWJsZWQpO1xuICAgICAgICAgICAgY2xhc3NMaXN0KHRoaXMucGFnZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLW1sYXN0JyksIGxhc3RQYWdlLCBsYXN0UGFnZURpc2FibGVkKTtcbiAgICAgICAgICAgIGNsYXNzTGlzdCh0aGlzLnBhZ2VyRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1tbmV4dCcpLCBuZXh0UGFnZSwgbmV4dFBhZ2VEaXNhYmxlZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBOdW1lcmljQ29udGFpbmVyO1xufSgpKTtcbmV4cG9ydCB7IE51bWVyaWNDb250YWluZXIgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/numeric-container.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/pager-message.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/pager-message.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PagerMessage: () => (/* binding */ PagerMessage)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n\n/**\n * `PagerMessage` module is used to display pager information.\n */\nvar PagerMessage = /** @class */ (function () {\n    /**\n     * Constructor for externalMessage module\n     *\n     * @param {Pager} pagerModule - specifies the pager Module\n     * @hidden\n     */\n    function PagerMessage(pagerModule) {\n        this.pagerModule = pagerModule;\n    }\n    /**\n     * The function is used to render pager message\n     *\n     * @returns {void}\n     * @hidden\n     */\n    PagerMessage.prototype.render = function () {\n        var div = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', { className: 'e-parentmsgbar' });\n        this.pageNoMsgElem = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('span', { className: 'e-pagenomsg' });\n        this.pageNoMsgElem.style.textAlign = 'right';\n        this.pageCountMsgElem = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('span', { className: 'e-pagecountmsg' });\n        this.pageCountMsgElem.style.textAlign = 'right';\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.append)([this.pageNoMsgElem, this.pageCountMsgElem], div);\n        this.pagerModule.element.appendChild(div);\n        this.refresh();\n    };\n    /**\n     * Refreshes the pager information.\n     *\n     * @returns {void}\n     */\n    PagerMessage.prototype.refresh = function () {\n        var pagerObj = this.pagerModule;\n        this.pageNoMsgElem.textContent = this.format(pagerObj.getLocalizedLabel('currentPageInfo'), [pagerObj.totalRecordsCount === 0 ? 0 :\n                pagerObj.currentPage, pagerObj.totalPages || 0, pagerObj.totalRecordsCount || 0]) + ' ';\n        this.pageCountMsgElem.textContent = this.format(pagerObj.getLocalizedLabel(pagerObj.totalRecordsCount <= 1 ? 'totalItemInfo' : 'totalItemsInfo'), [pagerObj.totalRecordsCount || 0, pagerObj.totalRecordsCount ? (pagerObj.pageSize * (pagerObj.currentPage - 1)) + 1 : 0,\n            pagerObj.pageSize * pagerObj.currentPage > pagerObj.totalRecordsCount ? pagerObj.totalRecordsCount :\n                pagerObj.pageSize * pagerObj.currentPage]);\n        this.pageNoMsgElem.parentElement.classList.remove('e-hide');\n    };\n    /**\n     * Hides the Pager information.\n     *\n     * @returns {void}\n     */\n    PagerMessage.prototype.hideMessage = function () {\n        if (this.pageNoMsgElem) {\n            this.pageNoMsgElem.style.display = 'none';\n        }\n        if (this.pageCountMsgElem) {\n            this.pageCountMsgElem.style.display = 'none';\n        }\n    };\n    /**\n     * Shows the Pager information.\n     *\n     * @returns {void}\n     */\n    PagerMessage.prototype.showMessage = function () {\n        if (!this.pageNoMsgElem) {\n            this.render();\n        }\n        this.pageNoMsgElem.style.display = '';\n        this.pageCountMsgElem.style.display = '';\n    };\n    /**\n     * To destroy the PagerMessage\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n     */\n    PagerMessage.prototype.destroy = function () {\n        //destroy\n    };\n    /**\n     * To format the PagerMessage\n     *\n     * @function format\n     * @param {string} str - specifies the string\n     * @param {number[]} args - specifies the argument\n     * @returns {string} returns the format string\n     * @hidden\n     */\n    PagerMessage.prototype.format = function (str, args) {\n        var regx;\n        var regExp = RegExp;\n        for (var i = 0; i < args.length; i++) {\n            regx = new regExp('\\\\{' + (i) + '\\\\}', 'gm');\n            if (this.isValidLocale(this.pagerModule.locale)) {\n                str = str.replace(regx, args[parseInt(i.toString(), 10)].toLocaleString(this.pagerModule.locale));\n            }\n            else {\n                str = str.replace(regx, args[parseInt(i.toString(), 10)].toString());\n            }\n        }\n        return str;\n    };\n    PagerMessage.prototype.isValidLocale = function (locale) {\n        try {\n            new Intl.NumberFormat(locale);\n            return true;\n        }\n        catch (e) {\n            return false;\n        }\n    };\n    return PagerMessage;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvcGFnZXIvcGFnZXItbWVzc2FnZS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUE2RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtRUFBYSxVQUFVLDZCQUE2QjtBQUN0RSw2QkFBNkIsbUVBQWEsV0FBVywwQkFBMEI7QUFDL0U7QUFDQSxnQ0FBZ0MsbUVBQWEsV0FBVyw2QkFBNkI7QUFDckY7QUFDQSxRQUFRLDREQUFNO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsVUFBVTtBQUN6QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlCQUFpQjtBQUN6QyxrQ0FBa0MsY0FBYztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDdUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haV90cmF2ZWwvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvcGFnZXIvcGFnZXItbWVzc2FnZS5qcz8zOTg2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUVsZW1lbnQsIGFwcGVuZCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbi8qKlxuICogYFBhZ2VyTWVzc2FnZWAgbW9kdWxlIGlzIHVzZWQgdG8gZGlzcGxheSBwYWdlciBpbmZvcm1hdGlvbi5cbiAqL1xudmFyIFBhZ2VyTWVzc2FnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvciBmb3IgZXh0ZXJuYWxNZXNzYWdlIG1vZHVsZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtQYWdlcn0gcGFnZXJNb2R1bGUgLSBzcGVjaWZpZXMgdGhlIHBhZ2VyIE1vZHVsZVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBQYWdlck1lc3NhZ2UocGFnZXJNb2R1bGUpIHtcbiAgICAgICAgdGhpcy5wYWdlck1vZHVsZSA9IHBhZ2VyTW9kdWxlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZnVuY3Rpb24gaXMgdXNlZCB0byByZW5kZXIgcGFnZXIgbWVzc2FnZVxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFBhZ2VyTWVzc2FnZS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGl2ID0gY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICdlLXBhcmVudG1zZ2JhcicgfSk7XG4gICAgICAgIHRoaXMucGFnZU5vTXNnRWxlbSA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2UtcGFnZW5vbXNnJyB9KTtcbiAgICAgICAgdGhpcy5wYWdlTm9Nc2dFbGVtLnN0eWxlLnRleHRBbGlnbiA9ICdyaWdodCc7XG4gICAgICAgIHRoaXMucGFnZUNvdW50TXNnRWxlbSA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2UtcGFnZWNvdW50bXNnJyB9KTtcbiAgICAgICAgdGhpcy5wYWdlQ291bnRNc2dFbGVtLnN0eWxlLnRleHRBbGlnbiA9ICdyaWdodCc7XG4gICAgICAgIGFwcGVuZChbdGhpcy5wYWdlTm9Nc2dFbGVtLCB0aGlzLnBhZ2VDb3VudE1zZ0VsZW1dLCBkaXYpO1xuICAgICAgICB0aGlzLnBhZ2VyTW9kdWxlLmVsZW1lbnQuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZWZyZXNoZXMgdGhlIHBhZ2VyIGluZm9ybWF0aW9uLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgUGFnZXJNZXNzYWdlLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFnZXJPYmogPSB0aGlzLnBhZ2VyTW9kdWxlO1xuICAgICAgICB0aGlzLnBhZ2VOb01zZ0VsZW0udGV4dENvbnRlbnQgPSB0aGlzLmZvcm1hdChwYWdlck9iai5nZXRMb2NhbGl6ZWRMYWJlbCgnY3VycmVudFBhZ2VJbmZvJyksIFtwYWdlck9iai50b3RhbFJlY29yZHNDb3VudCA9PT0gMCA/IDAgOlxuICAgICAgICAgICAgICAgIHBhZ2VyT2JqLmN1cnJlbnRQYWdlLCBwYWdlck9iai50b3RhbFBhZ2VzIHx8IDAsIHBhZ2VyT2JqLnRvdGFsUmVjb3Jkc0NvdW50IHx8IDBdKSArICcgJztcbiAgICAgICAgdGhpcy5wYWdlQ291bnRNc2dFbGVtLnRleHRDb250ZW50ID0gdGhpcy5mb3JtYXQocGFnZXJPYmouZ2V0TG9jYWxpemVkTGFiZWwocGFnZXJPYmoudG90YWxSZWNvcmRzQ291bnQgPD0gMSA/ICd0b3RhbEl0ZW1JbmZvJyA6ICd0b3RhbEl0ZW1zSW5mbycpLCBbcGFnZXJPYmoudG90YWxSZWNvcmRzQ291bnQgfHwgMCwgcGFnZXJPYmoudG90YWxSZWNvcmRzQ291bnQgPyAocGFnZXJPYmoucGFnZVNpemUgKiAocGFnZXJPYmouY3VycmVudFBhZ2UgLSAxKSkgKyAxIDogMCxcbiAgICAgICAgICAgIHBhZ2VyT2JqLnBhZ2VTaXplICogcGFnZXJPYmouY3VycmVudFBhZ2UgPiBwYWdlck9iai50b3RhbFJlY29yZHNDb3VudCA/IHBhZ2VyT2JqLnRvdGFsUmVjb3Jkc0NvdW50IDpcbiAgICAgICAgICAgICAgICBwYWdlck9iai5wYWdlU2l6ZSAqIHBhZ2VyT2JqLmN1cnJlbnRQYWdlXSk7XG4gICAgICAgIHRoaXMucGFnZU5vTXNnRWxlbS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2UtaGlkZScpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogSGlkZXMgdGhlIFBhZ2VyIGluZm9ybWF0aW9uLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgUGFnZXJNZXNzYWdlLnByb3RvdHlwZS5oaWRlTWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFnZU5vTXNnRWxlbSkge1xuICAgICAgICAgICAgdGhpcy5wYWdlTm9Nc2dFbGVtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFnZUNvdW50TXNnRWxlbSkge1xuICAgICAgICAgICAgdGhpcy5wYWdlQ291bnRNc2dFbGVtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNob3dzIHRoZSBQYWdlciBpbmZvcm1hdGlvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIFBhZ2VyTWVzc2FnZS5wcm90b3R5cGUuc2hvd01lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5wYWdlTm9Nc2dFbGVtKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFnZU5vTXNnRWxlbS5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgICAgIHRoaXMucGFnZUNvdW50TXNnRWxlbS5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUbyBkZXN0cm95IHRoZSBQYWdlck1lc3NhZ2VcbiAgICAgKlxuICAgICAqIEBmdW5jdGlvbiBkZXN0cm95XG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFBhZ2VyTWVzc2FnZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9kZXN0cm95XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUbyBmb3JtYXQgdGhlIFBhZ2VyTWVzc2FnZVxuICAgICAqXG4gICAgICogQGZ1bmN0aW9uIGZvcm1hdFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgLSBzcGVjaWZpZXMgdGhlIHN0cmluZ1xuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IGFyZ3MgLSBzcGVjaWZpZXMgdGhlIGFyZ3VtZW50XG4gICAgICogQHJldHVybnMge3N0cmluZ30gcmV0dXJucyB0aGUgZm9ybWF0IHN0cmluZ1xuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBQYWdlck1lc3NhZ2UucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uIChzdHIsIGFyZ3MpIHtcbiAgICAgICAgdmFyIHJlZ3g7XG4gICAgICAgIHZhciByZWdFeHAgPSBSZWdFeHA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmVneCA9IG5ldyByZWdFeHAoJ1xcXFx7JyArIChpKSArICdcXFxcfScsICdnbScpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZExvY2FsZSh0aGlzLnBhZ2VyTW9kdWxlLmxvY2FsZSkpIHtcbiAgICAgICAgICAgICAgICBzdHIgPSBzdHIucmVwbGFjZShyZWd4LCBhcmdzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS50b0xvY2FsZVN0cmluZyh0aGlzLnBhZ2VyTW9kdWxlLmxvY2FsZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UocmVneCwgYXJnc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0udG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICB9O1xuICAgIFBhZ2VyTWVzc2FnZS5wcm90b3R5cGUuaXNWYWxpZExvY2FsZSA9IGZ1bmN0aW9uIChsb2NhbGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG5ldyBJbnRsLk51bWJlckZvcm1hdChsb2NhbGUpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFBhZ2VyTWVzc2FnZTtcbn0oKSk7XG5leHBvcnQgeyBQYWdlck1lc3NhZ2UgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/pager-message.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/pager.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/pager.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Pager: () => (/* binding */ Pager)\n/* harmony export */ });\n/* harmony import */ var _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @syncfusion/ej2-base */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-base@29.1.36/node_modules/@syncfusion/ej2-base/index.js\");\n/* harmony import */ var _numeric_container__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./numeric-container */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/numeric-container.js\");\n/* harmony import */ var _pager_message__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./pager-message */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/pager-message.js\");\n/* harmony import */ var _grid_base_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../grid/base/util */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/util.js\");\n/* harmony import */ var _grid_base_constant__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../grid/base/constant */ \"(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/grid/base/constant.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\n\n\n\n\n\n\n\n/**\n * Represents the `Pager` component.\n * ```html\n * <div id=\"pager\"/>\n * ```\n * ```typescript\n * <script>\n *   var pagerObj = new Pager({ totalRecordsCount: 50, pageSize:10 });\n *   pagerObj.appendTo(\"#pager\");\n * </script>\n * ```\n */\nvar Pager = /** @class */ (function (_super) {\n    __extends(Pager, _super);\n    /**\n     * Constructor for creating the component.\n     *\n     * @param {PagerModel} options - specifies the options\n     * @param {string} element - specifies the element\n     * @param {string} parent - specifies the pager parent\n     * @hidden\n     */\n    function Pager(options, element, parent) {\n        var _this = _super.call(this, options, element) || this;\n        /** @hidden */\n        _this.hasParent = false;\n        _this.checkAll = true;\n        _this.pageRefresh = 'pager-refresh';\n        _this.firstPagerFocus = false;\n        /** @hidden */\n        _this.isCancel = false;\n        /** @hidden */\n        _this.isInteracted = false;\n        _this.parent = parent;\n        return _this;\n    }\n    /**\n     * To provide the array of modules needed for component rendering\n     *\n     * @returns {ModuleDeclaration[]} returns the modules declaration\n     * @hidden\n     */\n    Pager.prototype.requiredModules = function () {\n        var modules = [];\n        if (this.enableExternalMessage) {\n            modules.push({\n                member: 'externalMessage',\n                args: [this],\n                name: 'ExternalMessage'\n            });\n        }\n        if (this.checkpagesizes()) {\n            modules.push({\n                member: 'pagerdropdown',\n                args: [this],\n                name: 'PagerDropDown'\n            });\n        }\n        return modules;\n    };\n    /**\n     * Initialize the event handler\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Pager.prototype.preRender = function () {\n        //preRender\n        this.defaultConstants = {\n            currentPageInfo: '{0} of {1} pages',\n            totalItemsInfo: '({0} items)',\n            totalItemInfo: '({0} item)',\n            firstPageTooltip: 'Go to first page',\n            lastPageTooltip: 'Go to last page',\n            nextPageTooltip: 'Go to next page',\n            previousPageTooltip: 'Go to previous page',\n            nextPagerTooltip: 'Go to next pager items',\n            previousPagerTooltip: 'Go to previous pager items',\n            pagerDropDown: 'Items per page',\n            pagerAllDropDown: 'Items',\n            CurrentPageInfo: '{0} of {1} pages',\n            TotalItemsInfo: '({0} items)',\n            FirstPageTooltip: 'Go to first page',\n            LastPageTooltip: 'Go to last page',\n            NextPageTooltip: 'Go to next page',\n            PreviousPageTooltip: 'Go to previous page',\n            NextPagerTooltip: 'Go to next pager items',\n            PreviousPagerTooltip: 'Go to previous pager items',\n            PagerDropDown: 'Items per page',\n            PagerAllDropDown: 'Items',\n            All: 'All',\n            Container: 'Pager Container',\n            Information: 'Pager Information',\n            ExternalMsg: 'Pager external message',\n            Page: 'Page ',\n            Of: ' of ',\n            Pages: ' Pages'\n        };\n        this.containerModule = new _numeric_container__WEBPACK_IMPORTED_MODULE_1__.NumericContainer(this);\n        this.pagerMessageModule = new _pager_message__WEBPACK_IMPORTED_MODULE_2__.PagerMessage(this);\n    };\n    /**\n     * To Initialize the component rendering\n     *\n     * @returns {void}\n     */\n    Pager.prototype.render = function () {\n        this.element.setAttribute('data-role', 'pager');\n        this.element.setAttribute('tabindex', '-1');\n        this.initLocalization();\n        if (/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {\n            this.element.classList.add('e-mac-safari');\n        }\n        if (this.cssClass) {\n            if (this.cssClass.indexOf(' ') !== -1) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.element], this.cssClass.split(' '));\n            }\n            else {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([this.element], [this.cssClass]);\n            }\n        }\n        if (!this.hasParent) {\n            this.element.setAttribute('tabindex', '0');\n        }\n        if (this.enableQueryString) {\n            var pageValue = new URL(window.location.href).searchParams.get('page');\n            if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(pageValue) && window.location.href.indexOf('?page=') > 0) {\n                var currentPageValue = parseInt(pageValue, 10);\n                if (this.hasParent) {\n                    this.parent\n                        .setProperties({ pageSettings: { currentPage: currentPageValue } }, true);\n                }\n                this.currentPage = currentPageValue;\n            }\n        }\n        if (this.template) {\n            if (this.isReactTemplate()) {\n                this.on(this.pageRefresh, this.pagerTemplate, this);\n                this.notify(this.pageRefresh, {});\n            }\n            else {\n                this.pagerTemplate();\n            }\n        }\n        else {\n            this.updateRTL();\n            this.totalRecordsCount = this.totalRecordsCount || 0;\n            this.renderFirstPrevDivForDevice();\n            this.containerModule.render();\n            if (this.enablePagerMessage) {\n                this.pagerMessageModule.render();\n            }\n            this.renderNextLastDivForDevice();\n            if (this.checkpagesizes() && this.pagerdropdownModule) {\n                this.pagerdropdownModule.render();\n            }\n            this.addAriaLabel();\n            if (this.enableExternalMessage && this.externalMessageModule) {\n                this.externalMessageModule.render();\n            }\n            this.refresh();\n            this.trigger('created', { 'currentPage': this.currentPage, 'totalRecordsCount': this.totalRecordsCount });\n        }\n        this.wireEvents();\n        this.addListener();\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} returns the persist data\n     * @hidden\n     */\n    Pager.prototype.getPersistData = function () {\n        var keyEntity = ['currentPage', 'pageSize'];\n        return this.addOnPersist(keyEntity);\n    };\n    /**\n     * To destroy the Pager component.\n     *\n     * @method destroy\n     * @returns {void}\n     */\n    Pager.prototype.destroy = function () {\n        if (this.isDestroyed) {\n            return;\n        }\n        if (this.isReactTemplate()) {\n            this.off(this.pageRefresh, this.pagerTemplate);\n            if (!this.hasParent) {\n                this.destroyTemplate(['pagerTemplate']);\n            }\n        }\n        this.removeListener();\n        this.unwireEvents();\n        _super.prototype.destroy.call(this);\n        this.containerModule.destroy();\n        this.pagerMessageModule.destroy();\n        if (!this.isReactTemplate()) {\n            this.element.innerHTML = '';\n        }\n    };\n    /**\n     * Destroys the given template reference.\n     *\n     * @param {string[]} propertyNames - Defines the collection of template name.\n     * @param {any} index - Defines the index\n     */\n    // eslint-disable-next-line\n    Pager.prototype.destroyTemplate = function (propertyNames, index) {\n        this.clearTemplate(propertyNames, index);\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Pager.prototype.getModuleName = function () {\n        return 'pager';\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {PagerModel} newProp - specifies the new property\n     * @param {PagerModel} oldProp - specifies the old propety\n     * @returns {void}\n     * @hidden\n     */\n    Pager.prototype.onPropertyChanged = function (newProp, oldProp) {\n        if (this.isDestroyed) {\n            return;\n        }\n        if ((newProp.pageSize === this.getLocalizedLabel('All')) && oldProp.pageSize === this.totalRecordsCount) {\n            this.pageSize = this.totalRecordsCount;\n            return;\n        }\n        if (newProp.pageCount !== oldProp.pageCount) {\n            this.containerModule.refreshNumericLinks();\n            this.containerModule.refresh();\n        }\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'currentPage':\n                    if (this.checkGoToPage(newProp.currentPage, oldProp.currentPage)) {\n                        this.currentPageChanged(newProp, oldProp);\n                    }\n                    break;\n                case 'pageSize':\n                case 'totalRecordsCount':\n                case 'customText':\n                    if (this.checkpagesizes() && this.pagerdropdownModule) {\n                        if (oldProp.pageSize !== newProp.pageSize) {\n                            this.currentPage = 1;\n                        }\n                        this.pagerdropdownModule.setDropDownValue('value', this.pageSize);\n                    }\n                    if (newProp.pageSize !== oldProp.pageSize) {\n                        this.pageSize = newProp.pageSize;\n                        this.currentPageChanged(newProp, oldProp);\n                        if (this.isCancel && this.hasParent) {\n                            this.parent\n                                .setProperties({ pageSettings: { pageSize: oldProp.pageSize } }, true);\n                        }\n                    }\n                    else {\n                        this.refresh();\n                    }\n                    break;\n                case 'pageSizes':\n                    if (this.checkpagesizes() && this.pagerdropdownModule) {\n                        this.pagerdropdownModule.destroy();\n                        this.pagerdropdownModule.render();\n                    }\n                    this.refresh();\n                    break;\n                case 'template':\n                    this.templateFn = this.compile(this.template);\n                    this.refresh();\n                    break;\n                case 'locale':\n                    this.initLocalization();\n                    this.refresh();\n                    break;\n                case 'enableExternalMessage':\n                    if (this.enableExternalMessage && this.externalMessageModule) {\n                        this.externalMessageModule.render();\n                    }\n                    break;\n                case 'externalMessage':\n                    if (this.externalMessageModule) {\n                        this.externalMessageModule.refresh();\n                    }\n                    break;\n                case 'enableRtl':\n                    this.updateRTL();\n                    break;\n                case 'enablePagerMessage':\n                    if (this.enablePagerMessage) {\n                        this.pagerMessageModule.showMessage();\n                    }\n                    else {\n                        this.pagerMessageModule.hideMessage();\n                    }\n                    break;\n            }\n        }\n        this.resizePager();\n    };\n    Pager.prototype.wireEvents = function () {\n        if (!this.hasParent) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'keydown', this.keyPressHandler, this);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(document.body, 'keydown', this.keyDownHandler, this);\n        }\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'focusin', this.onFocusIn, this);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(this.element, 'focusout', this.onFocusOut, this);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(window, 'resize', this.resizePager, this);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.add(window, 'load', this.resizePager, this);\n    };\n    Pager.prototype.unwireEvents = function () {\n        if (!this.hasParent) {\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'keydown', this.keyPressHandler);\n            _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(document.body, 'keydown', this.keyDownHandler);\n        }\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'focusin', this.onFocusIn);\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(this.element, 'focusout', this.onFocusOut);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(window, 'resize', this.resizePager);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.EventHandler.remove(window, 'load', this.resizePager);\n    };\n    Pager.prototype.onFocusIn = function (e) {\n        var focusedTabIndexElement = this.getFocusedTabindexElement();\n        if ((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(focusedTabIndexElement)) {\n            var target = e.target;\n            var dropDownPage = this.getDropDownPage();\n            if (!this.hasParent) {\n                this.element.tabIndex = -1;\n            }\n            if (target === this.element && !this.hasParent) {\n                var focusablePagerElements = this.getFocusablePagerElements(this.element, []);\n                this.addFocus(focusablePagerElements[0], true);\n                return;\n            }\n            if (target === this.element) {\n                this.element.tabIndex = 0;\n                return;\n            }\n            if (target !== dropDownPage && !target.classList.contains('e-disable')) {\n                this.addFocus(target, true);\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Pager.prototype.onFocusOut = function (e) {\n        var focusedElement = this.getFocusedElement();\n        var dropDownPage = this.getDropDownPage();\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(focusedElement)) {\n            this.removeFocus(focusedElement, true);\n        }\n        if (this.pageSizes && dropDownPage && dropDownPage.classList.contains('e-input-focus')) {\n            this.removeFocus(dropDownPage, true);\n        }\n        this.setTabIndexForFocusLastElement();\n        if (!this.hasParent) {\n            this.element.tabIndex = 0;\n        }\n        if (this.hasParent) {\n            this.element.tabIndex = -1;\n        }\n    };\n    Pager.prototype.keyDownHandler = function (e) {\n        if (e.altKey) {\n            if (e.keyCode === 74) {\n                var focusablePagerElements = this.getFocusablePagerElements(this.element, []);\n                if (focusablePagerElements.length > 0) {\n                    focusablePagerElements[0].focus();\n                }\n            }\n        }\n    };\n    Pager.prototype.keyPressHandler = function (e) {\n        var presskey = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.extend)(e, { cancel: false });\n        this.notify(_grid_base_constant__WEBPACK_IMPORTED_MODULE_3__.keyPressed, presskey);\n        if (presskey.cancel === true) {\n            e.stopImmediatePropagation();\n        }\n    };\n    Pager.prototype.addListener = function () {\n        if (this.isDestroyed) {\n            return;\n        }\n        if (!this.hasParent) {\n            this.on(_grid_base_constant__WEBPACK_IMPORTED_MODULE_3__.keyPressed, this.onKeyPress, this);\n        }\n    };\n    Pager.prototype.removeListener = function () {\n        if (this.isDestroyed) {\n            return;\n        }\n        if (!this.hasParent) {\n            this.off(_grid_base_constant__WEBPACK_IMPORTED_MODULE_3__.keyPressed, this.onKeyPress);\n        }\n    };\n    Pager.prototype.onKeyPress = function (e) {\n        if (!this.hasParent) {\n            if (this.checkPagerHasFocus()) {\n                this.changePagerFocus(e);\n            }\n            else {\n                e.preventDefault();\n                this.setPagerFocus();\n            }\n        }\n    };\n    /**\n     * @returns {boolean} - Return the true value if pager has focus\n     * @hidden */\n    Pager.prototype.checkPagerHasFocus = function () {\n        return this.getFocusedTabindexElement() ? true : false;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    Pager.prototype.setPagerContainerFocus = function () {\n        this.element.focus();\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    Pager.prototype.setPagerFocus = function () {\n        var focusablePagerElements = this.getFocusablePagerElements(this.element, []);\n        if (focusablePagerElements.length > 0) {\n            focusablePagerElements[0].focus();\n        }\n    };\n    Pager.prototype.setPagerFocusForActiveElement = function () {\n        var currentActivePage = this.getActiveElement();\n        if (currentActivePage) {\n            currentActivePage.focus();\n        }\n    };\n    Pager.prototype.setTabIndexForFocusLastElement = function () {\n        var focusablePagerElements = this.getFocusablePagerElements(this.element, []);\n        var dropDownPage = this.getDropDownPage();\n        if (this.pageSizes && dropDownPage && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(dropDownPage.offsetParent)) {\n            dropDownPage.tabIndex = 0;\n        }\n        else if (focusablePagerElements.length > 0) {\n            focusablePagerElements[focusablePagerElements.length - 1].tabIndex = 0;\n        }\n    };\n    /**\n     * @param {KeyboardEventArgs} e - Keyboard Event Args\n     * @returns {void}\n     * @hidden */\n    Pager.prototype.changePagerFocus = function (e) {\n        this.keyAction = e.key;\n        if (e.shiftKey && e.keyCode === 9) {\n            this.changeFocusByShiftTab(e);\n        }\n        else if (e.keyCode === 9) {\n            this.changeFocusByTab(e);\n        }\n        else if (e.keyCode === 13 || e.keyCode === 32) {\n            this.navigateToPageByEnterOrSpace(e);\n        }\n        else if (e.keyCode === 37 || e.keyCode === 39 || e.keyCode === 35 || e.keyCode === 36) {\n            this.navigateToPageByKey(e);\n        }\n        this.keyAction = '';\n    };\n    Pager.prototype.getFocusedTabindexElement = function () {\n        var focusedTabIndexElement;\n        var tabindexElements = this.element.querySelectorAll('[tabindex]:not([tabindex=\"-1\"])');\n        for (var i = 0; i < tabindexElements.length; i++) {\n            var element = tabindexElements[parseInt(i.toString(), 10)];\n            if (element && (element.classList.contains('e-focused') || element.classList.contains('e-input-focus'))) {\n                focusedTabIndexElement = element;\n                break;\n            }\n        }\n        return focusedTabIndexElement;\n    };\n    Pager.prototype.changeFocusByTab = function (e) {\n        var currentItemPagerFocus = this.getFocusedTabindexElement();\n        var focusablePagerElements = this.getFocusablePagerElements(this.element, []);\n        var dropDownPage = this.getDropDownPage();\n        if (focusablePagerElements.length > 0) {\n            if (this.pageSizes && dropDownPage && currentItemPagerFocus === focusablePagerElements[focusablePagerElements.length - 1]) {\n                dropDownPage.tabIndex = 0;\n            }\n            else {\n                for (var i = 0; i < focusablePagerElements.length; i++) {\n                    if (currentItemPagerFocus === focusablePagerElements[parseInt(i.toString(), 10)]) {\n                        var incrementNumber = i + 1;\n                        if (incrementNumber < focusablePagerElements.length) {\n                            e.preventDefault();\n                            focusablePagerElements[parseInt(incrementNumber.toString(), 10)].focus();\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n    };\n    Pager.prototype.changeFocusByShiftTab = function (e) {\n        var currentItemPagerFocus = this.getFocusedTabindexElement();\n        var focusablePagerElements = this.getFocusablePagerElements(this.element, []);\n        var dropDownPage = this.getDropDownPage();\n        if (this.pageSizes && dropDownPage && dropDownPage.classList.contains('e-input-focus')) {\n            dropDownPage.tabIndex = -1;\n            this.addFocus(focusablePagerElements[focusablePagerElements.length - 1], true);\n        }\n        else if (focusablePagerElements.length > 0) {\n            for (var i = 0; i < focusablePagerElements.length; i++) {\n                if (currentItemPagerFocus === focusablePagerElements[parseInt(i.toString(), 10)]) {\n                    var decrementNumber = i - 1;\n                    if (decrementNumber >= 0) {\n                        e.preventDefault();\n                        focusablePagerElements[parseInt(decrementNumber.toString(), 10)].focus();\n                    }\n                    else if (this.hasParent) {\n                        var rows = this.parent.getRows();\n                        var lastRow = rows[rows.length - 1];\n                        var lastCell = lastRow.lastChild;\n                        e.preventDefault();\n                        lastCell.focus();\n                        this.firstPagerFocus = true;\n                    }\n                    break;\n                }\n            }\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    Pager.prototype.checkFirstPagerFocus = function () {\n        if (this.firstPagerFocus) {\n            this.firstPagerFocus = false;\n            return true;\n        }\n        return false;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Pager.prototype.navigateToPageByEnterOrSpace = function (e) {\n        var currentItemPagerFocus = this.getFocusedElement();\n        if (currentItemPagerFocus) {\n            this.goToPage(parseInt(currentItemPagerFocus.getAttribute('index'), 10));\n            var currentActivePage = this.getActiveElement();\n            var selectedClass = this.getClass(currentItemPagerFocus);\n            var classElement = this.getElementByClass(selectedClass);\n            if ((selectedClass === 'e-first' || selectedClass === 'e-prev' || selectedClass === 'e-next'\n                || selectedClass === 'e-last' || selectedClass === 'e-pp' || selectedClass === 'e-np')\n                && classElement && !classElement.classList.contains('e-disable')) {\n                classElement.focus();\n            }\n            else if (this.checkFocusInAdaptiveMode(currentItemPagerFocus)) {\n                this.changeFocusInAdaptiveMode(currentItemPagerFocus);\n            }\n            else {\n                if (currentActivePage) {\n                    currentActivePage.focus();\n                }\n            }\n        }\n    };\n    Pager.prototype.navigateToPageByKey = function (e) {\n        var actionClass = e.keyCode === 37 ? '.e-prev' : e.keyCode === 39 ? '.e-next'\n            : e.keyCode === 35 ? '.e-last' : e.keyCode === 36 ? '.e-first' : '';\n        var pagingItem = this.element.querySelector(actionClass);\n        var currentItemPagerFocus = this.getFocusedElement();\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(pagingItem) && pagingItem.hasAttribute('index')\n            && !isNaN(parseInt(pagingItem.getAttribute('index'), 10))) {\n            this.goToPage(parseInt(pagingItem.getAttribute('index'), 10));\n            var currentActivePage = this.getActiveElement();\n            if (this.checkFocusInAdaptiveMode(currentItemPagerFocus)) {\n                this.changeFocusInAdaptiveMode(currentItemPagerFocus);\n            }\n            else {\n                if (currentActivePage) {\n                    currentActivePage.focus();\n                }\n            }\n        }\n    };\n    Pager.prototype.checkFocusInAdaptiveMode = function (element) {\n        var selectedClass = this.getClass(element);\n        return selectedClass === 'e-mfirst' || selectedClass === 'e-mprev' || selectedClass === 'e-mnext'\n            || selectedClass === 'e-mlast' ? true : false;\n    };\n    Pager.prototype.changeFocusInAdaptiveMode = function (element) {\n        var selectedClass = this.getClass(element);\n        var classElement = this.getElementByClass(selectedClass);\n        if (classElement && classElement.classList.contains('e-disable')) {\n            if (selectedClass === 'e-mnext' || selectedClass === 'e-mlast') {\n                var mPrev = this.element.querySelector('.e-mprev');\n                mPrev.focus();\n            }\n            else {\n                this.setPagerFocus();\n            }\n        }\n    };\n    Pager.prototype.removeTabindexLastElements = function () {\n        var tabIndexElements = this.element.querySelectorAll('[tabindex]:not([tabindex=\"-1\"])');\n        if (tabIndexElements.length > 1) {\n            for (var i = 1; i < tabIndexElements.length; i++) {\n                var element = tabIndexElements[parseInt(i.toString(), 10)];\n                if (element) {\n                    element.tabIndex = -1;\n                }\n            }\n        }\n    };\n    Pager.prototype.getActiveElement = function () {\n        return this.element.querySelector('.e-active');\n    };\n    /**\n     * @returns {Element} - Returns DropDown Page\n     * @hidden */\n    Pager.prototype.getDropDownPage = function () {\n        var dropDownPageHolder = this.element.querySelector('.e-pagerdropdown');\n        var dropDownPage;\n        if (dropDownPageHolder) {\n            dropDownPage = dropDownPageHolder.children[0];\n        }\n        return dropDownPage;\n    };\n    Pager.prototype.getFocusedElement = function () {\n        return this.element.querySelector('.e-focused');\n    };\n    Pager.prototype.getClass = function (element) {\n        var currentClass;\n        var classList = ['e-mfirst', 'e-mprev', 'e-first', 'e-prev', 'e-pp',\n            'e-np', 'e-next', 'e-last', 'e-mnext', 'e-mlast'];\n        for (var i = 0; i < classList.length; i++) {\n            if (element && element.classList.contains(classList[parseInt(i.toString(), 10)])) {\n                currentClass = classList[parseInt(i.toString(), 10)];\n                return currentClass;\n            }\n        }\n        return currentClass;\n    };\n    Pager.prototype.getElementByClass = function (className) {\n        return this.element.querySelector('.' + className);\n    };\n    /**\n     * @param {Element} element - Pager element\n     * @param {Element[]} previousElements - Iterating pager element\n     * @returns {Element[]} - Returns focusable pager element\n     * @hidden */\n    Pager.prototype.getFocusablePagerElements = function (element, previousElements) {\n        var target = element;\n        var targetChildrens = target.children;\n        var pagerElements = previousElements;\n        for (var i = 0; i < targetChildrens.length; i++) {\n            var element_1 = targetChildrens[parseInt(i.toString(), 10)];\n            if (element_1.children.length > 0 && !element_1.classList.contains('e-pagesizes')) {\n                pagerElements = this.getFocusablePagerElements(element_1, pagerElements);\n            }\n            else {\n                var tabindexElement = targetChildrens[parseInt(i.toString(), 10)];\n                if (tabindexElement.hasAttribute('tabindex') && !element_1.classList.contains('e-disable')\n                    && element_1.style.display !== 'none'\n                    && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(element_1.offsetParent)) {\n                    pagerElements.push(tabindexElement);\n                }\n            }\n        }\n        return pagerElements;\n    };\n    Pager.prototype.addFocus = function (element, addFocusClass) {\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(element)) {\n            if (addFocusClass) {\n                (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.addClass)([element], ['e-focused', 'e-focus']);\n            }\n            element.tabIndex = 0;\n        }\n    };\n    Pager.prototype.removeFocus = function (element, removeFocusClass) {\n        if (removeFocusClass) {\n            (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.removeClass)([element], ['e-focused', 'e-focus']);\n        }\n        element.tabIndex = -1;\n    };\n    /**\n     * Gets the localized label by locale keyword.\n     *\n     * @param  {string} key - specifies the key\n     * @returns {string} returns the localized label\n     */\n    Pager.prototype.getLocalizedLabel = function (key) {\n        return this.localeObj.getConstant(key);\n    };\n    /**\n     * Navigate to target page by given number.\n     *\n     * @param  {number} pageNo - Defines page number.\n     * @returns {void}\n     */\n    Pager.prototype.goToPage = function (pageNo) {\n        if (this.checkGoToPage(pageNo)) {\n            this.currentPage = pageNo;\n            this.isInteracted = false;\n            this.dataBind();\n        }\n    };\n    /**\n     * @param {number} pageSize - specifies the pagesize\n     * @returns {void}\n     * @hidden\n     */\n    Pager.prototype.setPageSize = function (pageSize) {\n        this.pageSize = pageSize;\n        this.dataBind();\n    };\n    Pager.prototype.checkpagesizes = function () {\n        if (this.pageSizes === true || this.pageSizes.length) {\n            return true;\n        }\n        return false;\n    };\n    Pager.prototype.checkGoToPage = function (newPageNo, oldPageNo) {\n        if (newPageNo !== this.currentPage) {\n            this.previousPageNo = this.currentPage;\n        }\n        if (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(oldPageNo)) {\n            this.previousPageNo = oldPageNo;\n        }\n        if (this.previousPageNo !== newPageNo && (newPageNo >= 1 && newPageNo <= this.totalPages)) {\n            return true;\n        }\n        return false;\n    };\n    Pager.prototype.currentPageChanged = function (newProp, oldProp) {\n        if (this.enableQueryString) {\n            this.updateQueryString(this.currentPage);\n        }\n        if (newProp.currentPage !== oldProp.currentPage || newProp.pageSize !== oldProp.pageSize) {\n            var args = {\n                currentPage: this.currentPage,\n                newProp: newProp, oldProp: oldProp, cancel: false, isInteracted: this.isInteracted\n            };\n            this.trigger('click', args);\n            if (!args.cancel) {\n                this.isCancel = false;\n                this.refresh();\n            }\n            else {\n                this.isCancel = true;\n                if (oldProp && oldProp.pageSize) {\n                    this.setProperties({ pageSize: oldProp.pageSize }, true);\n                    if (this.pagerdropdownModule) {\n                        this.pagerdropdownModule.setDropDownValue('value', oldProp.pageSize);\n                        this.pagerdropdownModule['dropDownListObject'].text = oldProp.pageSize + '';\n                    }\n                }\n            }\n        }\n    };\n    Pager.prototype.pagerTemplate = function () {\n        if (this.isReactTemplate() && this.hasParent) {\n            return;\n        }\n        var result;\n        this.element.classList.add('e-pagertemplate');\n        this.compile(this.template);\n        var data = {\n            currentPage: this.currentPage, pageSize: this.pageSize, pageCount: this.pageCount,\n            totalRecordsCount: this.totalRecordsCount, totalPages: this.totalPages\n        };\n        var tempId = this.element.parentElement.id + '_template';\n        if (this.isReactTemplate() && !this.isVue) {\n            this.getPagerTemplate()(data, this, 'pagerTemplate', tempId, null, null, this.element);\n            this.renderReactTemplates();\n        }\n        else {\n            result = this.isVue ? this.getPagerTemplate()(data, this, 'pagerTemplate', null, null, null, null, this.root)\n                : this.getPagerTemplate()(data);\n            (0,_grid_base_util__WEBPACK_IMPORTED_MODULE_4__.appendChildren)(this.element, result);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Pager.prototype.updateTotalPages = function () {\n        this.totalPages = this.isAllPage ? 1 : (this.totalRecordsCount % this.pageSize === 0) ? (this.totalRecordsCount / this.pageSize) :\n            (parseInt((this.totalRecordsCount / this.pageSize).toString(), 10) + 1);\n    };\n    /**\n     * @returns {Function} returns the function\n     * @hidden\n     */\n    Pager.prototype.getPagerTemplate = function () {\n        return this.templateFn;\n    };\n    /**\n     * @param {string | Function} template - specifies the template\n     * @returns {Function} returns the function\n     * @hidden\n     */\n    Pager.prototype.compile = function (template) {\n        if (template) {\n            try {\n                if (typeof template === 'function') {\n                    this.templateFn = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(template);\n                }\n                else {\n                    if (document.querySelectorAll(template).length) {\n                        this.templateFn = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(document.querySelector(template).innerHTML.trim());\n                    }\n                    else {\n                        this.templateFn = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(template);\n                    }\n                }\n            }\n            catch (e) {\n                this.templateFn = (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.compile)(template);\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Refreshes page count, pager information and external message.\n     *\n     * @returns {void}\n     */\n    Pager.prototype.refresh = function () {\n        if (this.template) {\n            if (this.isReactTemplate()) {\n                this.updateTotalPages();\n                this.notify(this.pageRefresh, {});\n            }\n            else {\n                if (this.parent && this.parent.isAngular) {\n                    this.parent.destroyTemplate(['pagerTemplate']);\n                }\n                else {\n                    this.element.innerHTML = '';\n                }\n                this.updateTotalPages();\n                this.pagerTemplate();\n            }\n        }\n        else {\n            this.updateRTL();\n            var focusedTabIndexElement = this.getFocusedTabindexElement();\n            this.containerModule.refresh();\n            this.removeTabindexLastElements();\n            if (focusedTabIndexElement && focusedTabIndexElement.classList.contains('e-disable')) {\n                if (this.checkFocusInAdaptiveMode(focusedTabIndexElement)) {\n                    this.changeFocusInAdaptiveMode(focusedTabIndexElement);\n                }\n                else {\n                    this.setPagerFocusForActiveElement();\n                }\n            }\n            if (this.enablePagerMessage) {\n                this.pagerMessageModule.refresh();\n            }\n            if (this.pagerdropdownModule) {\n                this.pagerdropdownModule.refresh();\n            }\n            if (this.enableExternalMessage && this.externalMessageModule) {\n                this.externalMessageModule.refresh();\n            }\n            this.setTabIndexForFocusLastElement();\n            this.resizePager();\n        }\n    };\n    Pager.prototype.updateRTL = function () {\n        if (this.enableRtl) {\n            this.element.classList.add('e-rtl');\n        }\n        else {\n            this.element.classList.remove('e-rtl');\n        }\n    };\n    Pager.prototype.initLocalization = function () {\n        this.localeObj = new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.L10n(this.getModuleName(), this.defaultConstants, this.locale);\n    };\n    Pager.prototype.updateQueryString = function (value) {\n        var updatedUrl = this.getUpdatedURL(window.location.href, 'page', value.toString());\n        window.history.pushState({ path: updatedUrl }, '', updatedUrl);\n    };\n    Pager.prototype.getUpdatedURL = function (uri, key, value) {\n        var regExp = RegExp;\n        var regx = new regExp('([?|&])' + key + '=.*?(&|#|$)', 'i');\n        if (uri.match(regx)) {\n            return uri.replace(regx, '$1' + key + '=' + value + '$2');\n        }\n        else {\n            var hash = '';\n            if (uri.indexOf('#') !== -1) {\n                hash = uri.replace(/.*#/, '#');\n                uri = uri.replace(/#.*/, '');\n            }\n            return uri + (uri.indexOf('?') !== -1 ? '&' : '?') + key + '=' + value + hash;\n        }\n    };\n    Pager.prototype.renderFirstPrevDivForDevice = function () {\n        this.element.appendChild((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            className: 'e-mfirst e-icons e-icon-first',\n            attrs: { title: this.getLocalizedLabel('firstPageTooltip'), tabindex: '-1' }\n        }));\n        this.element.appendChild((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            className: 'e-mprev e-icons e-icon-prev',\n            attrs: { title: this.getLocalizedLabel('previousPageTooltip'), tabindex: '-1' }\n        }));\n    };\n    Pager.prototype.renderNextLastDivForDevice = function () {\n        this.element.appendChild((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            className: 'e-mnext e-icons e-icon-next',\n            attrs: { title: this.getLocalizedLabel('nextPageTooltip'), tabindex: '-1' }\n        }));\n        this.element.appendChild((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.createElement)('div', {\n            className: 'e-mlast e-icons e-icon-last',\n            attrs: { title: this.getLocalizedLabel('lastPageTooltip'), tabindex: '-1' }\n        }));\n    };\n    Pager.prototype.addAriaLabel = function () {\n        var classList = ['.e-mfirst', '.e-mprev', '.e-mnext', '.e-mlast'];\n        if (!_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Browser.isDevice) {\n            for (var i = 0; i < classList.length; i++) {\n                var element = this.element.querySelector(classList[parseInt(i.toString(), 10)]);\n                element.setAttribute('aria-label', element.getAttribute('title'));\n            }\n        }\n    };\n    Pager.prototype.isReactTemplate = function () {\n        return (this.isReact || this.isVue) && this.template && typeof (this.template) !== 'string' && !(this.template.prototype && this.template.prototype.CSPTemplate);\n    };\n    /**\n     * Loop through all the inner elements of pager to calculate the required width for pager child elements.\n     *\n     * @returns {number} returns the actual width occupied by pager elements.\n     */\n    Pager.prototype.calculateActualWidth = function () {\n        var pagerElements = this.element.querySelectorAll(\n        /* tslint:disable-next-line:max-line-length */\n        '.e-mfirst, .e-mprev, .e-icon-first, .e-icon-prev, .e-pp:not(.e-disable), .e-numericitem:not(.e-hide), .e-numericitem.e-active.e-hide, .e-np:not(.e-disable), .e-icon-next, .e-icon-last, .e-parentmsgbar, .e-mnext, .e-mlast, .e-pagerdropdown, .e-pagerconstant');\n        var actualWidth = 0;\n        for (var i = 0; i < pagerElements.length; i++) {\n            if (getComputedStyle(pagerElements[parseInt(i.toString(), 10)]).display !== 'none') {\n                actualWidth += pagerElements[parseInt(i.toString(), 10)].offsetWidth\n                    + parseFloat(getComputedStyle(pagerElements[parseInt(i.toString(), 10)]).marginLeft)\n                    + parseFloat(getComputedStyle(pagerElements[parseInt(i.toString(), 10)]).marginRight);\n            }\n        }\n        var pagerContainer = this.element.querySelector('.e-pagercontainer');\n        actualWidth += parseFloat(getComputedStyle(pagerContainer).marginLeft)\n            + parseFloat(getComputedStyle(pagerContainer).marginRight);\n        return actualWidth;\n    };\n    /**\n     * Resize pager component by hiding pager component's numeric items based on total width available for pager.\n     *\n     * @returns {void}\n     */\n    Pager.prototype.resizePager = function () {\n        var _this = this;\n        var isStyleApplied = this.element.classList.contains('e-pager') ? getComputedStyle(this.element).getPropertyValue('border-style').includes('solid') : null;\n        if (!(this.template) && isStyleApplied) {\n            var pagerContainer = this.element.querySelector('.e-pagercontainer');\n            var actualWidth = this.calculateActualWidth();\n            var pagerWidth = this.element.clientWidth\n                - parseFloat(getComputedStyle(this.element).paddingLeft)\n                - parseFloat(getComputedStyle(this.element).paddingRight)\n                - parseFloat(getComputedStyle(this.element).marginLeft)\n                - parseFloat(getComputedStyle(this.element).marginRight);\n            var numItems = pagerContainer.querySelectorAll('.e-numericitem:not(.e-hide):not([style*=\"display: none\"]):not(.e-np):not(.e-pp)');\n            var hiddenNumItems = pagerContainer.querySelectorAll('.e-numericitem.e-hide:not([style*=\"display: none\"])');\n            var hideFrom = numItems.length;\n            var showFrom = 1;\n            var bufferWidth = (!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)((0,_grid_base_util__WEBPACK_IMPORTED_MODULE_4__.parentsUntil)(this.element, 'e-bigger'))) ? 10 : 5;\n            var NP = pagerContainer.querySelector('.e-np');\n            var PP = pagerContainer.querySelector('.e-pp');\n            var detailItems = this.element.querySelectorAll('.e-parentmsgbar:not(.e-hide):not([style*=\"display: none\"]), .e-pagesizes:not(.e-hide):not([style*=\"display: none\"])');\n            var totDetailWidth_1 = 0;\n            if (detailItems.length) {\n                detailItems.forEach(function (item) {\n                    totDetailWidth_1 += item.offsetWidth;\n                });\n                this.averageDetailWidth = totDetailWidth_1 / detailItems.length;\n            }\n            var totalWidth = 0;\n            /**\n             * Loop to calculate average width of numeric item.\n             */\n            for (var i = 0; i < numItems.length; i++) {\n                totalWidth += numItems[parseInt(i.toString(), 10)].offsetWidth\n                    + parseFloat(getComputedStyle(numItems[parseInt(i.toString(), 10)]).marginLeft)\n                    + parseFloat(getComputedStyle(numItems[parseInt(i.toString(), 10)]).marginRight);\n            }\n            var numericItemWidth = totalWidth / numItems.length;\n            /**\n             * Condition to hide numeric items when calculated actual width exceeds available pager space.\n             */\n            if (pagerWidth > 0 && (actualWidth >= (pagerWidth - (numericItemWidth ? numericItemWidth : 0)))) {\n                this.isPagerResized = true;\n                if (this.currentPage !== this.totalPages) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(NP, ['e-numericitem', 'e-pager-default'], ['e-nextprevitemdisabled', 'e-disable']);\n                }\n                actualWidth = this.calculateActualWidth();\n                var diff = Math.abs((actualWidth) - pagerWidth);\n                // To calculate number of numeric items need to be hidden.\n                var numToHide = Math.ceil(diff / (numericItemWidth));\n                numToHide = (numToHide === 0) ? 1 : (numToHide > numItems.length) ? (numItems.length - 1) : numToHide;\n                for (var i = 1; i <= numToHide; i++) {\n                    var hideIndex = hideFrom - parseInt(i.toString(), 10);\n                    numItems = pagerContainer.querySelectorAll('.e-numericitem:not(.e-hide):not([style*=\"display: none\"]):not(.e-np):not(.e-pp)');\n                    if (this.currentPage !== 1 && ((parseInt(numItems[Math.abs(hideIndex)].getAttribute('index'), 10) === this.currentPage)\n                        || parseInt(numItems[numItems.length - 1].getAttribute('index'), 10) === this.currentPage)) {\n                        hideIndex = 0;\n                        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(PP, ['e-numericitem', 'e-pager-default'], ['e-nextprevitemdisabled', 'e-disable']);\n                    }\n                    if (numItems[Math.abs(hideIndex)] && !(numItems[Math.abs(hideIndex)].classList.contains('e-currentitem'))) {\n                        numItems[Math.abs(hideIndex)].classList.add('e-hide');\n                    }\n                }\n                numItems = pagerContainer.querySelectorAll('.e-numericitem:not(.e-hide):not([style*=\"display: none\"]):not(.e-np):not(.e-pp)');\n                // To hide Pager message elements when no more numeric items available to hide.\n                if (numItems.length <= 1 && detailItems.length && window.innerWidth >= 768) {\n                    var pagerDetailItemsWidth = this.calculateActualWidth();\n                    if ((pagerDetailItemsWidth) > (pagerWidth - bufferWidth)) {\n                        var detailtoHide = Math.floor((pagerWidth - (pagerDetailItemsWidth - totDetailWidth_1))\n                            / this.averageDetailWidth);\n                        detailtoHide = detailItems.length - detailtoHide;\n                        for (var i = 0; i < (detailtoHide > detailItems.length ? detailItems.length : detailtoHide); i++) {\n                            detailItems[parseInt(i.toString(), 10)].classList.add('e-hide');\n                        }\n                    }\n                }\n            }\n            /**\n             * Condition to show numeric items when space availble in pager at dom.\n             */\n            else if (actualWidth < (pagerWidth) && hiddenNumItems.length) {\n                var diff = Math.abs(pagerWidth - (actualWidth));\n                var hiddenDetailItems = this.element.querySelectorAll('.e-parentmsgbar.e-hide, .e-pagesizes.e-hide');\n                // To show Pager message elements.\n                if (hiddenDetailItems.length && (diff > (this.averageDetailWidth + (this.averageDetailWidth / 4)))) {\n                    hiddenDetailItems[(hiddenDetailItems.length - 1)].classList.remove('e-hide');\n                }\n                if ((diff > (numericItemWidth * 2) && !hiddenDetailItems.length && window.innerWidth >= 768)) {\n                    // To calculate number of numeric items need to be shown.\n                    var numToShow = Math.floor((diff) / (numericItemWidth + bufferWidth));\n                    numToShow = (numToShow > hiddenNumItems.length) ? hiddenNumItems.length : (numToShow - 1);\n                    //Seggregating hidden num items as less index and greater index values than current page value.\n                    var lesserIndexItems = Array.from(hiddenNumItems).filter(function (item) { return parseInt(item.getAttribute('index'), 10) < _this.currentPage; }).sort(function (a, b) { return parseInt(b.getAttribute('index'), 10) - parseInt(a.getAttribute('index'), 10); });\n                    var greaterIndexItems = Array.from(hiddenNumItems).filter(function (item) { return parseInt(item.getAttribute('index'), 10) > _this.currentPage; });\n                    var showItems = (lesserIndexItems.length && lesserIndexItems)\n                        || (greaterIndexItems.length && greaterIndexItems);\n                    for (var i = 1; i <= numToShow; i++) {\n                        var showItem = showItems && showItems[Math.abs(showFrom - i)];\n                        if (showItem) {\n                            showItem.classList.remove('e-hide');\n                            if (showItem === showItems[showItems.length - 1]) {\n                                showItems = null;\n                            }\n                        }\n                    }\n                }\n            }\n            numItems = pagerContainer.querySelectorAll('.e-numericitem:not(.e-hide):not([style*=\"display: none\"]):not(.e-np):not(.e-pp)');\n            if (numItems.length) {\n                if (parseInt(numItems[numItems.length - 1].getAttribute('index'), 10) === this.totalPages) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(NP, ['e-nextprevitemdisabled', 'e-disable'], ['e-numericitem', 'e-pager-default']);\n                }\n                if (parseInt(numItems[0].getAttribute('index'), 10) === 1) {\n                    (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.classList)(PP, ['e-nextprevitemdisabled', 'e-disable'], ['e-numericitem', 'e-pager-default']);\n                }\n                var isLastSet = Array.from(numItems).some(function (item) { return parseInt(item.getAttribute('index'), 10) === _this.totalPages; });\n                var ppIndex = (parseInt(numItems[0].getAttribute('index'), 10) - (isLastSet && !(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.isNullOrUndefined)(this.avgNumItems) ? this.avgNumItems : numItems.length));\n                PP.setAttribute('index', (ppIndex < 1) ? '1' : ppIndex.toString());\n                NP.setAttribute('index', (parseInt(numItems[numItems.length - 1].getAttribute('index'), 10) + 1).toString());\n                this.avgNumItems = isLastSet ? this.avgNumItems : numItems.length;\n            }\n            /**\n             * Condition to add adaptive class name and set pagermessage content with \"/\" when media query css has been applied.\n             */\n            if (((this.element.offsetWidth < 769) && window.getComputedStyle(this.element.querySelector('.e-mfirst')).getPropertyValue('display') !== 'none') && this.pageSizes) {\n                this.element.querySelector('.e-pagesizes').classList.remove('e-hide');\n                this.element.querySelector('.e-parentmsgbar').classList.remove('e-hide');\n                this.element.classList.add('e-adaptive');\n                this.element.querySelector('.e-pagenomsg').innerHTML = this.element.offsetWidth < 481 ? (this.currentPage + ' / ' + this.totalPages) : this.pagerMessageModule.format(this.getLocalizedLabel('currentPageInfo'), [this.totalRecordsCount === 0 ? 0 :\n                        this.currentPage, this.totalPages || 0, this.totalRecordsCount || 0]) + ' ';\n            }\n            else {\n                this.element.classList.remove('e-adaptive');\n                this.element.querySelector('.e-pagenomsg').innerHTML = this.pagerMessageModule.format(this.getLocalizedLabel('currentPageInfo'), [this.totalRecordsCount === 0 ? 0 :\n                        this.currentPage, this.totalPages || 0, this.totalRecordsCount || 0]) + ' ';\n            }\n        }\n    };\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Pager.prototype, \"enableQueryString\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Pager.prototype, \"enableExternalMessage\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(true)\n    ], Pager.prototype, \"enablePagerMessage\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(12)\n    ], Pager.prototype, \"pageSize\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(10)\n    ], Pager.prototype, \"pageCount\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(1)\n    ], Pager.prototype, \"currentPage\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Pager.prototype, \"totalRecordsCount\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Pager.prototype, \"externalMessage\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)(false)\n    ], Pager.prototype, \"pageSizes\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)()\n    ], Pager.prototype, \"template\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('')\n    ], Pager.prototype, \"customText\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Pager.prototype, \"click\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Property)('')\n    ], Pager.prototype, \"cssClass\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Pager.prototype, \"dropDownChanged\", void 0);\n    __decorate([\n        (0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Event)()\n    ], Pager.prototype, \"created\", void 0);\n    Pager = __decorate([\n        _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.NotifyPropertyChanges\n    ], Pager);\n    return Pager;\n}(_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_0__.Component));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHN5bmNmdXNpb24rZWoyLWdyaWRzQDI5LjEuNDAvbm9kZV9tb2R1bGVzL0BzeW5jZnVzaW9uL2VqMi1ncmlkcy9zcmMvcGFnZXIvcGFnZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUNELGtCQUFrQixTQUFJLElBQUksU0FBSTtBQUM5QjtBQUNBO0FBQ0EsNkNBQTZDLFFBQVE7QUFDckQ7QUFDQTtBQUNrRztBQUNNO0FBQy9DO0FBQ3FCO0FBQ3ZCO0FBQ1I7QUFDa0I7QUFDakI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msb0NBQW9DO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsWUFBWTtBQUMzQixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHFCQUFxQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLEdBQUcsSUFBSSxHQUFHO0FBQ3pDLCtCQUErQixHQUFHO0FBQ2xDLDhCQUE4QixHQUFHO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsR0FBRyxJQUFJLEdBQUc7QUFDekMsK0JBQStCLEdBQUc7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsZ0VBQWdCO0FBQ25ELHNDQUFzQyx3REFBWTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw4REFBUTtBQUN4QjtBQUNBO0FBQ0EsZ0JBQWdCLDhEQUFRO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHVFQUFpQjtBQUNsQztBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsZ0JBQWdCLGlDQUFpQztBQUMxRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyw4RUFBOEU7QUFDcEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxVQUFVO0FBQ3pCLGVBQWUsS0FBSztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsWUFBWTtBQUMzQixlQUFlLFlBQVk7QUFDM0IsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0QsZ0JBQWdCO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxnQkFBZ0IsOEJBQThCO0FBQy9GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksOERBQVk7QUFDeEIsWUFBWSw4REFBWTtBQUN4QjtBQUNBLFFBQVEsOERBQVk7QUFDcEIsUUFBUSw4REFBWTtBQUNwQjtBQUNBLFFBQVEsOERBQVk7QUFDcEI7QUFDQSxRQUFRLDhEQUFZO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLFlBQVksOERBQVk7QUFDeEIsWUFBWSw4REFBWTtBQUN4QjtBQUNBLFFBQVEsOERBQVk7QUFDcEIsUUFBUSw4REFBWTtBQUNwQjtBQUNBLFFBQVEsOERBQVk7QUFDcEI7QUFDQSxRQUFRLDhEQUFZO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLFlBQVksdUVBQWlCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLHVFQUFpQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsNERBQU0sTUFBTSxlQUFlO0FBQ2xELG9CQUFvQiwyREFBaUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJEQUFpQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiwyREFBaUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixTQUFTO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyx1RUFBaUI7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG1CQUFtQjtBQUNsQyxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw2QkFBNkI7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxtQ0FBbUM7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLG1DQUFtQztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsdUVBQWlCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDZCQUE2QjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQVM7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0JBQXNCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEIsZUFBZSxXQUFXO0FBQzFCLGlCQUFpQixXQUFXO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNEJBQTRCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUVBQWlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1RUFBaUI7QUFDOUI7QUFDQSxnQkFBZ0IsOERBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxpRUFBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUTtBQUN4QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixRQUFRO0FBQ3hCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1RUFBaUI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLDRCQUE0QjtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLCtEQUFjO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsbUJBQW1CO0FBQ2xDLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyw2REFBZ0I7QUFDdEQ7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDZEQUFnQjtBQUMxRDtBQUNBO0FBQ0EsMENBQTBDLDZEQUFnQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyw2REFBZ0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHNEQUFJO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxrQkFBa0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtRUFBYTtBQUM5QztBQUNBLHFCQUFxQjtBQUNyQixTQUFTO0FBQ1QsaUNBQWlDLG1FQUFhO0FBQzlDO0FBQ0EscUJBQXFCO0FBQ3JCLFNBQVM7QUFDVDtBQUNBO0FBQ0EsaUNBQWlDLG1FQUFhO0FBQzlDO0FBQ0EscUJBQXFCO0FBQ3JCLFNBQVM7QUFDVCxpQ0FBaUMsbUVBQWE7QUFDOUM7QUFDQSxxQkFBcUI7QUFDckIsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWEseURBQU87QUFDcEIsNEJBQTRCLHNCQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHVFQUFpQixDQUFDLDZEQUFZO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixxQkFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwrREFBUztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsZ0JBQWdCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsK0RBQVM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsNkVBQTZFO0FBQ3JIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrRkFBK0Ysc0VBQXNFLHlCQUF5Qix1RkFBdUY7QUFDclIsZ0dBQWdHLHNFQUFzRTtBQUN0SztBQUNBO0FBQ0Esb0NBQW9DLGdCQUFnQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwrREFBUztBQUM3QjtBQUNBO0FBQ0Esb0JBQW9CLCtEQUFTO0FBQzdCO0FBQ0EsNEVBQTRFLHVFQUF1RTtBQUNuSixnR0FBZ0csdUVBQWlCO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSw4REFBUTtBQUNoQjtBQUNBO0FBQ0EsUUFBUSwyREFBSztBQUNiO0FBQ0E7QUFDQSxRQUFRLDhEQUFRO0FBQ2hCO0FBQ0E7QUFDQSxRQUFRLDJEQUFLO0FBQ2I7QUFDQTtBQUNBLFFBQVEsMkRBQUs7QUFDYjtBQUNBO0FBQ0EsUUFBUSx1RUFBcUI7QUFDN0I7QUFDQTtBQUNBLENBQUMsQ0FBQywyREFBUztBQUNNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWlfdHJhdmVsLy4vbm9kZV9tb2R1bGVzLy5wbnBtL0BzeW5jZnVzaW9uK2VqMi1ncmlkc0AyOS4xLjQwL25vZGVfbW9kdWxlcy9Ac3luY2Z1c2lvbi9lajItZ3JpZHMvc3JjL3BhZ2VyL3BhZ2VyLmpzP2FlMjUiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG5pbXBvcnQgeyBDb21wb25lbnQsIEwxMG4sIEJyb3dzZXIsIGFkZENsYXNzLCByZW1vdmVDbGFzcywgY2xhc3NMaXN0IH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgY3JlYXRlRWxlbWVudCwgY29tcGlsZSBhcyB0ZW1wbGF0ZUNvbXBpbGVyLCBFdmVudEhhbmRsZXIsIGV4dGVuZCB9IGZyb20gJ0BzeW5jZnVzaW9uL2VqMi1iYXNlJztcbmltcG9ydCB7IGlzTnVsbE9yVW5kZWZpbmVkIH0gZnJvbSAnQHN5bmNmdXNpb24vZWoyLWJhc2UnO1xuaW1wb3J0IHsgUHJvcGVydHksIEV2ZW50LCBOb3RpZnlQcm9wZXJ0eUNoYW5nZXMgfSBmcm9tICdAc3luY2Z1c2lvbi9lajItYmFzZSc7XG5pbXBvcnQgeyBOdW1lcmljQ29udGFpbmVyIH0gZnJvbSAnLi9udW1lcmljLWNvbnRhaW5lcic7XG5pbXBvcnQgeyBQYWdlck1lc3NhZ2UgfSBmcm9tICcuL3BhZ2VyLW1lc3NhZ2UnO1xuaW1wb3J0IHsgYXBwZW5kQ2hpbGRyZW4sIHBhcmVudHNVbnRpbCB9IGZyb20gJy4uL2dyaWQvYmFzZS91dGlsJztcbmltcG9ydCAqIGFzIGV2ZW50cyBmcm9tICcuLi9ncmlkL2Jhc2UvY29uc3RhbnQnO1xuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBgUGFnZXJgIGNvbXBvbmVudC5cbiAqIGBgYGh0bWxcbiAqIDxkaXYgaWQ9XCJwYWdlclwiLz5cbiAqIGBgYFxuICogYGBgdHlwZXNjcmlwdFxuICogPHNjcmlwdD5cbiAqICAgdmFyIHBhZ2VyT2JqID0gbmV3IFBhZ2VyKHsgdG90YWxSZWNvcmRzQ291bnQ6IDUwLCBwYWdlU2l6ZToxMCB9KTtcbiAqICAgcGFnZXJPYmouYXBwZW5kVG8oXCIjcGFnZXJcIik7XG4gKiA8L3NjcmlwdD5cbiAqIGBgYFxuICovXG52YXIgUGFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFBhZ2VyLCBfc3VwZXIpO1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIGZvciBjcmVhdGluZyB0aGUgY29tcG9uZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtQYWdlck1vZGVsfSBvcHRpb25zIC0gc3BlY2lmaWVzIHRoZSBvcHRpb25zXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGVsZW1lbnQgLSBzcGVjaWZpZXMgdGhlIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcGFyZW50IC0gc3BlY2lmaWVzIHRoZSBwYWdlciBwYXJlbnRcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZnVuY3Rpb24gUGFnZXIob3B0aW9ucywgZWxlbWVudCwgcGFyZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG9wdGlvbnMsIGVsZW1lbnQpIHx8IHRoaXM7XG4gICAgICAgIC8qKiBAaGlkZGVuICovXG4gICAgICAgIF90aGlzLmhhc1BhcmVudCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5jaGVja0FsbCA9IHRydWU7XG4gICAgICAgIF90aGlzLnBhZ2VSZWZyZXNoID0gJ3BhZ2VyLXJlZnJlc2gnO1xuICAgICAgICBfdGhpcy5maXJzdFBhZ2VyRm9jdXMgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXMuaXNDYW5jZWwgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBoaWRkZW4gKi9cbiAgICAgICAgX3RoaXMuaXNJbnRlcmFjdGVkID0gZmFsc2U7XG4gICAgICAgIF90aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUbyBwcm92aWRlIHRoZSBhcnJheSBvZiBtb2R1bGVzIG5lZWRlZCBmb3IgY29tcG9uZW50IHJlbmRlcmluZ1xuICAgICAqXG4gICAgICogQHJldHVybnMge01vZHVsZURlY2xhcmF0aW9uW119IHJldHVybnMgdGhlIG1vZHVsZXMgZGVjbGFyYXRpb25cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgUGFnZXIucHJvdG90eXBlLnJlcXVpcmVkTW9kdWxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1vZHVsZXMgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRXh0ZXJuYWxNZXNzYWdlKSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ2V4dGVybmFsTWVzc2FnZScsXG4gICAgICAgICAgICAgICAgYXJnczogW3RoaXNdLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdFeHRlcm5hbE1lc3NhZ2UnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jaGVja3BhZ2VzaXplcygpKSB7XG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJ3BhZ2VyZHJvcGRvd24nLFxuICAgICAgICAgICAgICAgIGFyZ3M6IFt0aGlzXSxcbiAgICAgICAgICAgICAgICBuYW1lOiAnUGFnZXJEcm9wRG93bidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtb2R1bGVzO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZSB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5wcmVSZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vcHJlUmVuZGVyXG4gICAgICAgIHRoaXMuZGVmYXVsdENvbnN0YW50cyA9IHtcbiAgICAgICAgICAgIGN1cnJlbnRQYWdlSW5mbzogJ3swfSBvZiB7MX0gcGFnZXMnLFxuICAgICAgICAgICAgdG90YWxJdGVtc0luZm86ICcoezB9IGl0ZW1zKScsXG4gICAgICAgICAgICB0b3RhbEl0ZW1JbmZvOiAnKHswfSBpdGVtKScsXG4gICAgICAgICAgICBmaXJzdFBhZ2VUb29sdGlwOiAnR28gdG8gZmlyc3QgcGFnZScsXG4gICAgICAgICAgICBsYXN0UGFnZVRvb2x0aXA6ICdHbyB0byBsYXN0IHBhZ2UnLFxuICAgICAgICAgICAgbmV4dFBhZ2VUb29sdGlwOiAnR28gdG8gbmV4dCBwYWdlJyxcbiAgICAgICAgICAgIHByZXZpb3VzUGFnZVRvb2x0aXA6ICdHbyB0byBwcmV2aW91cyBwYWdlJyxcbiAgICAgICAgICAgIG5leHRQYWdlclRvb2x0aXA6ICdHbyB0byBuZXh0IHBhZ2VyIGl0ZW1zJyxcbiAgICAgICAgICAgIHByZXZpb3VzUGFnZXJUb29sdGlwOiAnR28gdG8gcHJldmlvdXMgcGFnZXIgaXRlbXMnLFxuICAgICAgICAgICAgcGFnZXJEcm9wRG93bjogJ0l0ZW1zIHBlciBwYWdlJyxcbiAgICAgICAgICAgIHBhZ2VyQWxsRHJvcERvd246ICdJdGVtcycsXG4gICAgICAgICAgICBDdXJyZW50UGFnZUluZm86ICd7MH0gb2YgezF9IHBhZ2VzJyxcbiAgICAgICAgICAgIFRvdGFsSXRlbXNJbmZvOiAnKHswfSBpdGVtcyknLFxuICAgICAgICAgICAgRmlyc3RQYWdlVG9vbHRpcDogJ0dvIHRvIGZpcnN0IHBhZ2UnLFxuICAgICAgICAgICAgTGFzdFBhZ2VUb29sdGlwOiAnR28gdG8gbGFzdCBwYWdlJyxcbiAgICAgICAgICAgIE5leHRQYWdlVG9vbHRpcDogJ0dvIHRvIG5leHQgcGFnZScsXG4gICAgICAgICAgICBQcmV2aW91c1BhZ2VUb29sdGlwOiAnR28gdG8gcHJldmlvdXMgcGFnZScsXG4gICAgICAgICAgICBOZXh0UGFnZXJUb29sdGlwOiAnR28gdG8gbmV4dCBwYWdlciBpdGVtcycsXG4gICAgICAgICAgICBQcmV2aW91c1BhZ2VyVG9vbHRpcDogJ0dvIHRvIHByZXZpb3VzIHBhZ2VyIGl0ZW1zJyxcbiAgICAgICAgICAgIFBhZ2VyRHJvcERvd246ICdJdGVtcyBwZXIgcGFnZScsXG4gICAgICAgICAgICBQYWdlckFsbERyb3BEb3duOiAnSXRlbXMnLFxuICAgICAgICAgICAgQWxsOiAnQWxsJyxcbiAgICAgICAgICAgIENvbnRhaW5lcjogJ1BhZ2VyIENvbnRhaW5lcicsXG4gICAgICAgICAgICBJbmZvcm1hdGlvbjogJ1BhZ2VyIEluZm9ybWF0aW9uJyxcbiAgICAgICAgICAgIEV4dGVybmFsTXNnOiAnUGFnZXIgZXh0ZXJuYWwgbWVzc2FnZScsXG4gICAgICAgICAgICBQYWdlOiAnUGFnZSAnLFxuICAgICAgICAgICAgT2Y6ICcgb2YgJyxcbiAgICAgICAgICAgIFBhZ2VzOiAnIFBhZ2VzJ1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNvbnRhaW5lck1vZHVsZSA9IG5ldyBOdW1lcmljQ29udGFpbmVyKHRoaXMpO1xuICAgICAgICB0aGlzLnBhZ2VyTWVzc2FnZU1vZHVsZSA9IG5ldyBQYWdlck1lc3NhZ2UodGhpcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBUbyBJbml0aWFsaXplIHRoZSBjb21wb25lbnQgcmVuZGVyaW5nXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKi9cbiAgICBQYWdlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXJvbGUnLCAncGFnZXInKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcbiAgICAgICAgdGhpcy5pbml0TG9jYWxpemF0aW9uKCk7XG4gICAgICAgIGlmICgvXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1tYWMtc2FmYXJpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3NzQ2xhc3MpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNzc0NsYXNzLmluZGV4T2YoJyAnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhZGRDbGFzcyhbdGhpcy5lbGVtZW50XSwgdGhpcy5jc3NDbGFzcy5zcGxpdCgnICcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFkZENsYXNzKFt0aGlzLmVsZW1lbnRdLCBbdGhpcy5jc3NDbGFzc10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5oYXNQYXJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lbmFibGVRdWVyeVN0cmluZykge1xuICAgICAgICAgICAgdmFyIHBhZ2VWYWx1ZSA9IG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpLnNlYXJjaFBhcmFtcy5nZXQoJ3BhZ2UnKTtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQocGFnZVZhbHVlKSAmJiB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCc/cGFnZT0nKSA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFBhZ2VWYWx1ZSA9IHBhcnNlSW50KHBhZ2VWYWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1BhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFByb3BlcnRpZXMoeyBwYWdlU2V0dGluZ3M6IHsgY3VycmVudFBhZ2U6IGN1cnJlbnRQYWdlVmFsdWUgfSB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IGN1cnJlbnRQYWdlVmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGVtcGxhdGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzUmVhY3RUZW1wbGF0ZSgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbih0aGlzLnBhZ2VSZWZyZXNoLCB0aGlzLnBhZ2VyVGVtcGxhdGUsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KHRoaXMucGFnZVJlZnJlc2gsIHt9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGFnZXJUZW1wbGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVSVEwoKTtcbiAgICAgICAgICAgIHRoaXMudG90YWxSZWNvcmRzQ291bnQgPSB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50IHx8IDA7XG4gICAgICAgICAgICB0aGlzLnJlbmRlckZpcnN0UHJldkRpdkZvckRldmljZSgpO1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXJNb2R1bGUucmVuZGVyKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVQYWdlck1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2VyTWVzc2FnZU1vZHVsZS5yZW5kZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVuZGVyTmV4dExhc3REaXZGb3JEZXZpY2UoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrcGFnZXNpemVzKCkgJiYgdGhpcy5wYWdlcmRyb3Bkb3duTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYWdlcmRyb3Bkb3duTW9kdWxlLnJlbmRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hZGRBcmlhTGFiZWwoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUV4dGVybmFsTWVzc2FnZSAmJiB0aGlzLmV4dGVybmFsTWVzc2FnZU1vZHVsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZXh0ZXJuYWxNZXNzYWdlTW9kdWxlLnJlbmRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2NyZWF0ZWQnLCB7ICdjdXJyZW50UGFnZSc6IHRoaXMuY3VycmVudFBhZ2UsICd0b3RhbFJlY29yZHNDb3VudCc6IHRoaXMudG90YWxSZWNvcmRzQ291bnQgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53aXJlRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuYWRkTGlzdGVuZXIoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCB0aGUgcHJvcGVydGllcyB0byBiZSBtYWludGFpbmVkIGluIHRoZSBwZXJzaXN0ZWQgc3RhdGUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSByZXR1cm5zIHRoZSBwZXJzaXN0IGRhdGFcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgUGFnZXIucHJvdG90eXBlLmdldFBlcnNpc3REYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIga2V5RW50aXR5ID0gWydjdXJyZW50UGFnZScsICdwYWdlU2l6ZSddO1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRPblBlcnNpc3Qoa2V5RW50aXR5KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRvIGRlc3Ryb3kgdGhlIFBhZ2VyIGNvbXBvbmVudC5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgZGVzdHJveVxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pc0Rlc3Ryb3llZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzUmVhY3RUZW1wbGF0ZSgpKSB7XG4gICAgICAgICAgICB0aGlzLm9mZih0aGlzLnBhZ2VSZWZyZXNoLCB0aGlzLnBhZ2VyVGVtcGxhdGUpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmhhc1BhcmVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVzdHJveVRlbXBsYXRlKFsncGFnZXJUZW1wbGF0ZSddKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKCk7XG4gICAgICAgIHRoaXMudW53aXJlRXZlbnRzKCk7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGVzdHJveS5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lck1vZHVsZS5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMucGFnZXJNZXNzYWdlTW9kdWxlLmRlc3Ryb3koKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzUmVhY3RUZW1wbGF0ZSgpKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIERlc3Ryb3lzIHRoZSBnaXZlbiB0ZW1wbGF0ZSByZWZlcmVuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBwcm9wZXJ0eU5hbWVzIC0gRGVmaW5lcyB0aGUgY29sbGVjdGlvbiBvZiB0ZW1wbGF0ZSBuYW1lLlxuICAgICAqIEBwYXJhbSB7YW55fSBpbmRleCAtIERlZmluZXMgdGhlIGluZGV4XG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgUGFnZXIucHJvdG90eXBlLmRlc3Ryb3lUZW1wbGF0ZSA9IGZ1bmN0aW9uIChwcm9wZXJ0eU5hbWVzLCBpbmRleCkge1xuICAgICAgICB0aGlzLmNsZWFyVGVtcGxhdGUocHJvcGVydHlOYW1lcywgaW5kZXgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRm9yIGludGVybmFsIHVzZSBvbmx5IC0gR2V0IHRoZSBtb2R1bGUgbmFtZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgdGhlIG1vZHVsZSBuYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBQYWdlci5wcm90b3R5cGUuZ2V0TW9kdWxlTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICdwYWdlcic7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDYWxsZWQgaW50ZXJuYWxseSBpZiBhbnkgb2YgdGhlIHByb3BlcnR5IHZhbHVlIGNoYW5nZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1BhZ2VyTW9kZWx9IG5ld1Byb3AgLSBzcGVjaWZpZXMgdGhlIG5ldyBwcm9wZXJ0eVxuICAgICAqIEBwYXJhbSB7UGFnZXJNb2RlbH0gb2xkUHJvcCAtIHNwZWNpZmllcyB0aGUgb2xkIHByb3BldHlcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgUGFnZXIucHJvdG90eXBlLm9uUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1Byb3AsIG9sZFByb3ApIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoKG5ld1Byb3AucGFnZVNpemUgPT09IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwoJ0FsbCcpKSAmJiBvbGRQcm9wLnBhZ2VTaXplID09PSB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50KSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2VTaXplID0gdGhpcy50b3RhbFJlY29yZHNDb3VudDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3UHJvcC5wYWdlQ291bnQgIT09IG9sZFByb3AucGFnZUNvdW50KSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lck1vZHVsZS5yZWZyZXNoTnVtZXJpY0xpbmtzKCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lck1vZHVsZS5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IE9iamVjdC5rZXlzKG5ld1Byb3ApOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHByb3AgPSBfYVtfaV07XG4gICAgICAgICAgICBzd2l0Y2ggKHByb3ApIHtcbiAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50UGFnZSc6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrR29Ub1BhZ2UobmV3UHJvcC5jdXJyZW50UGFnZSwgb2xkUHJvcC5jdXJyZW50UGFnZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2VDaGFuZ2VkKG5ld1Byb3AsIG9sZFByb3ApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3BhZ2VTaXplJzpcbiAgICAgICAgICAgICAgICBjYXNlICd0b3RhbFJlY29yZHNDb3VudCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnY3VzdG9tVGV4dCc6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrcGFnZXNpemVzKCkgJiYgdGhpcy5wYWdlcmRyb3Bkb3duTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2xkUHJvcC5wYWdlU2l6ZSAhPT0gbmV3UHJvcC5wYWdlU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlcmRyb3Bkb3duTW9kdWxlLnNldERyb3BEb3duVmFsdWUoJ3ZhbHVlJywgdGhpcy5wYWdlU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1Byb3AucGFnZVNpemUgIT09IG9sZFByb3AucGFnZVNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZVNpemUgPSBuZXdQcm9wLnBhZ2VTaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZUNoYW5nZWQobmV3UHJvcCwgb2xkUHJvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0NhbmNlbCAmJiB0aGlzLmhhc1BhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRQcm9wZXJ0aWVzKHsgcGFnZVNldHRpbmdzOiB7IHBhZ2VTaXplOiBvbGRQcm9wLnBhZ2VTaXplIH0gfSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYWdlU2l6ZXMnOlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGVja3BhZ2VzaXplcygpICYmIHRoaXMucGFnZXJkcm9wZG93bk1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlcmRyb3Bkb3duTW9kdWxlLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZXJkcm9wZG93bk1vZHVsZS5yZW5kZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAndGVtcGxhdGUnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlRm4gPSB0aGlzLmNvbXBpbGUodGhpcy50ZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdsb2NhbGUnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRMb2NhbGl6YXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2VuYWJsZUV4dGVybmFsTWVzc2FnZSc6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUV4dGVybmFsTWVzc2FnZSAmJiB0aGlzLmV4dGVybmFsTWVzc2FnZU1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5leHRlcm5hbE1lc3NhZ2VNb2R1bGUucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZXh0ZXJuYWxNZXNzYWdlJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZXh0ZXJuYWxNZXNzYWdlTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4dGVybmFsTWVzc2FnZU1vZHVsZS5yZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZW5hYmxlUnRsJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVSVEwoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZW5hYmxlUGFnZXJNZXNzYWdlJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlUGFnZXJNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2VyTWVzc2FnZU1vZHVsZS5zaG93TWVzc2FnZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlck1lc3NhZ2VNb2R1bGUuaGlkZU1lc3NhZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc2l6ZVBhZ2VyKCk7XG4gICAgfTtcbiAgICBQYWdlci5wcm90b3R5cGUud2lyZUV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc1BhcmVudCkge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmVsZW1lbnQsICdrZXlkb3duJywgdGhpcy5rZXlQcmVzc0hhbmRsZXIsIHRoaXMpO1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLmFkZChkb2N1bWVudC5ib2R5LCAna2V5ZG93bicsIHRoaXMua2V5RG93bkhhbmRsZXIsIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQodGhpcy5lbGVtZW50LCAnZm9jdXNpbicsIHRoaXMub25Gb2N1c0luLCB0aGlzKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmVsZW1lbnQsICdmb2N1c291dCcsIHRoaXMub25Gb2N1c091dCwgdGhpcyk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQod2luZG93LCAncmVzaXplJywgdGhpcy5yZXNpemVQYWdlciwgdGhpcyk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIEV2ZW50SGFuZGxlci5hZGQod2luZG93LCAnbG9hZCcsIHRoaXMucmVzaXplUGFnZXIsIHRoaXMpO1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLnVud2lyZUV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc1BhcmVudCkge1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmVsZW1lbnQsICdrZXlkb3duJywgdGhpcy5rZXlQcmVzc0hhbmRsZXIpO1xuICAgICAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZShkb2N1bWVudC5ib2R5LCAna2V5ZG93bicsIHRoaXMua2V5RG93bkhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5lbGVtZW50LCAnZm9jdXNpbicsIHRoaXMub25Gb2N1c0luKTtcbiAgICAgICAgRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmVsZW1lbnQsICdmb2N1c291dCcsIHRoaXMub25Gb2N1c091dCk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUod2luZG93LCAncmVzaXplJywgdGhpcy5yZXNpemVQYWdlcik7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIEV2ZW50SGFuZGxlci5yZW1vdmUod2luZG93LCAnbG9hZCcsIHRoaXMucmVzaXplUGFnZXIpO1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLm9uRm9jdXNJbiA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBmb2N1c2VkVGFiSW5kZXhFbGVtZW50ID0gdGhpcy5nZXRGb2N1c2VkVGFiaW5kZXhFbGVtZW50KCk7XG4gICAgICAgIGlmIChpc051bGxPclVuZGVmaW5lZChmb2N1c2VkVGFiSW5kZXhFbGVtZW50KSkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgdmFyIGRyb3BEb3duUGFnZSA9IHRoaXMuZ2V0RHJvcERvd25QYWdlKCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaGFzUGFyZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSB0aGlzLmVsZW1lbnQgJiYgIXRoaXMuaGFzUGFyZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvY3VzYWJsZVBhZ2VyRWxlbWVudHMgPSB0aGlzLmdldEZvY3VzYWJsZVBhZ2VyRWxlbWVudHModGhpcy5lbGVtZW50LCBbXSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRGb2N1cyhmb2N1c2FibGVQYWdlckVsZW1lbnRzWzBdLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSB0aGlzLmVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudGFiSW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0YXJnZXQgIT09IGRyb3BEb3duUGFnZSAmJiAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZS1kaXNhYmxlJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEZvY3VzKHRhcmdldCwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBQYWdlci5wcm90b3R5cGUub25Gb2N1c091dCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBmb2N1c2VkRWxlbWVudCA9IHRoaXMuZ2V0Rm9jdXNlZEVsZW1lbnQoKTtcbiAgICAgICAgdmFyIGRyb3BEb3duUGFnZSA9IHRoaXMuZ2V0RHJvcERvd25QYWdlKCk7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZm9jdXNlZEVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUZvY3VzKGZvY3VzZWRFbGVtZW50LCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYWdlU2l6ZXMgJiYgZHJvcERvd25QYWdlICYmIGRyb3BEb3duUGFnZS5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaW5wdXQtZm9jdXMnKSkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVGb2N1cyhkcm9wRG93blBhZ2UsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0VGFiSW5kZXhGb3JGb2N1c0xhc3RFbGVtZW50KCk7XG4gICAgICAgIGlmICghdGhpcy5oYXNQYXJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC50YWJJbmRleCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaGFzUGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQudGFiSW5kZXggPSAtMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmtleURvd25IYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUuYWx0S2V5KSB7XG4gICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSA3NCkge1xuICAgICAgICAgICAgICAgIHZhciBmb2N1c2FibGVQYWdlckVsZW1lbnRzID0gdGhpcy5nZXRGb2N1c2FibGVQYWdlckVsZW1lbnRzKHRoaXMuZWxlbWVudCwgW10pO1xuICAgICAgICAgICAgICAgIGlmIChmb2N1c2FibGVQYWdlckVsZW1lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNhYmxlUGFnZXJFbGVtZW50c1swXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmtleVByZXNzSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBwcmVzc2tleSA9IGV4dGVuZChlLCB7IGNhbmNlbDogZmFsc2UgfSk7XG4gICAgICAgIHRoaXMubm90aWZ5KGV2ZW50cy5rZXlQcmVzc2VkLCBwcmVzc2tleSk7XG4gICAgICAgIGlmIChwcmVzc2tleS5jYW5jZWwgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhZ2VyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuaGFzUGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLm9uKGV2ZW50cy5rZXlQcmVzc2VkLCB0aGlzLm9uS2V5UHJlc3MsIHRoaXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQYWdlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmhhc1BhcmVudCkge1xuICAgICAgICAgICAgdGhpcy5vZmYoZXZlbnRzLmtleVByZXNzZWQsIHRoaXMub25LZXlQcmVzcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhZ2VyLnByb3RvdHlwZS5vbktleVByZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc1BhcmVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tQYWdlckhhc0ZvY3VzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZVBhZ2VyRm9jdXMoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQYWdlckZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFJldHVybiB0aGUgdHJ1ZSB2YWx1ZSBpZiBwYWdlciBoYXMgZm9jdXNcbiAgICAgKiBAaGlkZGVuICovXG4gICAgUGFnZXIucHJvdG90eXBlLmNoZWNrUGFnZXJIYXNGb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Rm9jdXNlZFRhYmluZGV4RWxlbWVudCgpID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlbiAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5zZXRQYWdlckNvbnRhaW5lckZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuZm9jdXMoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW4gKi9cbiAgICBQYWdlci5wcm90b3R5cGUuc2V0UGFnZXJGb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZvY3VzYWJsZVBhZ2VyRWxlbWVudHMgPSB0aGlzLmdldEZvY3VzYWJsZVBhZ2VyRWxlbWVudHModGhpcy5lbGVtZW50LCBbXSk7XG4gICAgICAgIGlmIChmb2N1c2FibGVQYWdlckVsZW1lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvY3VzYWJsZVBhZ2VyRWxlbWVudHNbMF0uZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLnNldFBhZ2VyRm9jdXNGb3JBY3RpdmVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3VycmVudEFjdGl2ZVBhZ2UgPSB0aGlzLmdldEFjdGl2ZUVsZW1lbnQoKTtcbiAgICAgICAgaWYgKGN1cnJlbnRBY3RpdmVQYWdlKSB7XG4gICAgICAgICAgICBjdXJyZW50QWN0aXZlUGFnZS5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQYWdlci5wcm90b3R5cGUuc2V0VGFiSW5kZXhGb3JGb2N1c0xhc3RFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZm9jdXNhYmxlUGFnZXJFbGVtZW50cyA9IHRoaXMuZ2V0Rm9jdXNhYmxlUGFnZXJFbGVtZW50cyh0aGlzLmVsZW1lbnQsIFtdKTtcbiAgICAgICAgdmFyIGRyb3BEb3duUGFnZSA9IHRoaXMuZ2V0RHJvcERvd25QYWdlKCk7XG4gICAgICAgIGlmICh0aGlzLnBhZ2VTaXplcyAmJiBkcm9wRG93blBhZ2UgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKGRyb3BEb3duUGFnZS5vZmZzZXRQYXJlbnQpKSB7XG4gICAgICAgICAgICBkcm9wRG93blBhZ2UudGFiSW5kZXggPSAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGZvY3VzYWJsZVBhZ2VyRWxlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9jdXNhYmxlUGFnZXJFbGVtZW50c1tmb2N1c2FibGVQYWdlckVsZW1lbnRzLmxlbmd0aCAtIDFdLnRhYkluZGV4ID0gMDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtLZXlib2FyZEV2ZW50QXJnc30gZSAtIEtleWJvYXJkIEV2ZW50IEFyZ3NcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICAgKiBAaGlkZGVuICovXG4gICAgUGFnZXIucHJvdG90eXBlLmNoYW5nZVBhZ2VyRm9jdXMgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB0aGlzLmtleUFjdGlvbiA9IGUua2V5O1xuICAgICAgICBpZiAoZS5zaGlmdEtleSAmJiBlLmtleUNvZGUgPT09IDkpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlRm9jdXNCeVNoaWZ0VGFiKGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gOSkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VGb2N1c0J5VGFiKGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMTMgfHwgZS5rZXlDb2RlID09PSAzMikge1xuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZVRvUGFnZUJ5RW50ZXJPclNwYWNlKGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMzcgfHwgZS5rZXlDb2RlID09PSAzOSB8fCBlLmtleUNvZGUgPT09IDM1IHx8IGUua2V5Q29kZSA9PT0gMzYpIHtcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGVUb1BhZ2VCeUtleShlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmtleUFjdGlvbiA9ICcnO1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmdldEZvY3VzZWRUYWJpbmRleEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBmb2N1c2VkVGFiSW5kZXhFbGVtZW50O1xuICAgICAgICB2YXIgdGFiaW5kZXhFbGVtZW50cyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbdGFiaW5kZXhdOm5vdChbdGFiaW5kZXg9XCItMVwiXSknKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJpbmRleEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IHRhYmluZGV4RWxlbWVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQgJiYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLWZvY3VzZWQnKSB8fCBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1pbnB1dC1mb2N1cycpKSkge1xuICAgICAgICAgICAgICAgIGZvY3VzZWRUYWJJbmRleEVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmb2N1c2VkVGFiSW5kZXhFbGVtZW50O1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmNoYW5nZUZvY3VzQnlUYWIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgY3VycmVudEl0ZW1QYWdlckZvY3VzID0gdGhpcy5nZXRGb2N1c2VkVGFiaW5kZXhFbGVtZW50KCk7XG4gICAgICAgIHZhciBmb2N1c2FibGVQYWdlckVsZW1lbnRzID0gdGhpcy5nZXRGb2N1c2FibGVQYWdlckVsZW1lbnRzKHRoaXMuZWxlbWVudCwgW10pO1xuICAgICAgICB2YXIgZHJvcERvd25QYWdlID0gdGhpcy5nZXREcm9wRG93blBhZ2UoKTtcbiAgICAgICAgaWYgKGZvY3VzYWJsZVBhZ2VyRWxlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFnZVNpemVzICYmIGRyb3BEb3duUGFnZSAmJiBjdXJyZW50SXRlbVBhZ2VyRm9jdXMgPT09IGZvY3VzYWJsZVBhZ2VyRWxlbWVudHNbZm9jdXNhYmxlUGFnZXJFbGVtZW50cy5sZW5ndGggLSAxXSkge1xuICAgICAgICAgICAgICAgIGRyb3BEb3duUGFnZS50YWJJbmRleCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZvY3VzYWJsZVBhZ2VyRWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJdGVtUGFnZXJGb2N1cyA9PT0gZm9jdXNhYmxlUGFnZXJFbGVtZW50c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmNyZW1lbnROdW1iZXIgPSBpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmNyZW1lbnROdW1iZXIgPCBmb2N1c2FibGVQYWdlckVsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c2FibGVQYWdlckVsZW1lbnRzW3BhcnNlSW50KGluY3JlbWVudE51bWJlci50b1N0cmluZygpLCAxMCldLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmNoYW5nZUZvY3VzQnlTaGlmdFRhYiA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBjdXJyZW50SXRlbVBhZ2VyRm9jdXMgPSB0aGlzLmdldEZvY3VzZWRUYWJpbmRleEVsZW1lbnQoKTtcbiAgICAgICAgdmFyIGZvY3VzYWJsZVBhZ2VyRWxlbWVudHMgPSB0aGlzLmdldEZvY3VzYWJsZVBhZ2VyRWxlbWVudHModGhpcy5lbGVtZW50LCBbXSk7XG4gICAgICAgIHZhciBkcm9wRG93blBhZ2UgPSB0aGlzLmdldERyb3BEb3duUGFnZSgpO1xuICAgICAgICBpZiAodGhpcy5wYWdlU2l6ZXMgJiYgZHJvcERvd25QYWdlICYmIGRyb3BEb3duUGFnZS5jbGFzc0xpc3QuY29udGFpbnMoJ2UtaW5wdXQtZm9jdXMnKSkge1xuICAgICAgICAgICAgZHJvcERvd25QYWdlLnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICB0aGlzLmFkZEZvY3VzKGZvY3VzYWJsZVBhZ2VyRWxlbWVudHNbZm9jdXNhYmxlUGFnZXJFbGVtZW50cy5sZW5ndGggLSAxXSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZm9jdXNhYmxlUGFnZXJFbGVtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZvY3VzYWJsZVBhZ2VyRWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudEl0ZW1QYWdlckZvY3VzID09PSBmb2N1c2FibGVQYWdlckVsZW1lbnRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVjcmVtZW50TnVtYmVyID0gaSAtIDE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZWNyZW1lbnROdW1iZXIgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNhYmxlUGFnZXJFbGVtZW50c1twYXJzZUludChkZWNyZW1lbnROdW1iZXIudG9TdHJpbmcoKSwgMTApXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuaGFzUGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93cyA9IHRoaXMucGFyZW50LmdldFJvd3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXN0Um93ID0gcm93c1tyb3dzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RDZWxsID0gbGFzdFJvdy5sYXN0Q2hpbGQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0Q2VsbC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJzdFBhZ2VyRm9jdXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlbiAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5jaGVja0ZpcnN0UGFnZXJGb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuZmlyc3RQYWdlckZvY3VzKSB7XG4gICAgICAgICAgICB0aGlzLmZpcnN0UGFnZXJGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIFBhZ2VyLnByb3RvdHlwZS5uYXZpZ2F0ZVRvUGFnZUJ5RW50ZXJPclNwYWNlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRJdGVtUGFnZXJGb2N1cyA9IHRoaXMuZ2V0Rm9jdXNlZEVsZW1lbnQoKTtcbiAgICAgICAgaWYgKGN1cnJlbnRJdGVtUGFnZXJGb2N1cykge1xuICAgICAgICAgICAgdGhpcy5nb1RvUGFnZShwYXJzZUludChjdXJyZW50SXRlbVBhZ2VyRm9jdXMuZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkpO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRBY3RpdmVQYWdlID0gdGhpcy5nZXRBY3RpdmVFbGVtZW50KCk7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDbGFzcyA9IHRoaXMuZ2V0Q2xhc3MoY3VycmVudEl0ZW1QYWdlckZvY3VzKTtcbiAgICAgICAgICAgIHZhciBjbGFzc0VsZW1lbnQgPSB0aGlzLmdldEVsZW1lbnRCeUNsYXNzKHNlbGVjdGVkQ2xhc3MpO1xuICAgICAgICAgICAgaWYgKChzZWxlY3RlZENsYXNzID09PSAnZS1maXJzdCcgfHwgc2VsZWN0ZWRDbGFzcyA9PT0gJ2UtcHJldicgfHwgc2VsZWN0ZWRDbGFzcyA9PT0gJ2UtbmV4dCdcbiAgICAgICAgICAgICAgICB8fCBzZWxlY3RlZENsYXNzID09PSAnZS1sYXN0JyB8fCBzZWxlY3RlZENsYXNzID09PSAnZS1wcCcgfHwgc2VsZWN0ZWRDbGFzcyA9PT0gJ2UtbnAnKVxuICAgICAgICAgICAgICAgICYmIGNsYXNzRWxlbWVudCAmJiAhY2xhc3NFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1kaXNhYmxlJykpIHtcbiAgICAgICAgICAgICAgICBjbGFzc0VsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuY2hlY2tGb2N1c0luQWRhcHRpdmVNb2RlKGN1cnJlbnRJdGVtUGFnZXJGb2N1cykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUZvY3VzSW5BZGFwdGl2ZU1vZGUoY3VycmVudEl0ZW1QYWdlckZvY3VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50QWN0aXZlUGFnZSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWN0aXZlUGFnZS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLm5hdmlnYXRlVG9QYWdlQnlLZXkgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgYWN0aW9uQ2xhc3MgPSBlLmtleUNvZGUgPT09IDM3ID8gJy5lLXByZXYnIDogZS5rZXlDb2RlID09PSAzOSA/ICcuZS1uZXh0J1xuICAgICAgICAgICAgOiBlLmtleUNvZGUgPT09IDM1ID8gJy5lLWxhc3QnIDogZS5rZXlDb2RlID09PSAzNiA/ICcuZS1maXJzdCcgOiAnJztcbiAgICAgICAgdmFyIHBhZ2luZ0l0ZW0gPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihhY3Rpb25DbGFzcyk7XG4gICAgICAgIHZhciBjdXJyZW50SXRlbVBhZ2VyRm9jdXMgPSB0aGlzLmdldEZvY3VzZWRFbGVtZW50KCk7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQocGFnaW5nSXRlbSkgJiYgcGFnaW5nSXRlbS5oYXNBdHRyaWJ1dGUoJ2luZGV4JylcbiAgICAgICAgICAgICYmICFpc05hTihwYXJzZUludChwYWdpbmdJdGVtLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSwgMTApKSkge1xuICAgICAgICAgICAgdGhpcy5nb1RvUGFnZShwYXJzZUludChwYWdpbmdJdGVtLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSwgMTApKTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50QWN0aXZlUGFnZSA9IHRoaXMuZ2V0QWN0aXZlRWxlbWVudCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tGb2N1c0luQWRhcHRpdmVNb2RlKGN1cnJlbnRJdGVtUGFnZXJGb2N1cykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUZvY3VzSW5BZGFwdGl2ZU1vZGUoY3VycmVudEl0ZW1QYWdlckZvY3VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50QWN0aXZlUGFnZSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWN0aXZlUGFnZS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmNoZWNrRm9jdXNJbkFkYXB0aXZlTW9kZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHZhciBzZWxlY3RlZENsYXNzID0gdGhpcy5nZXRDbGFzcyhlbGVtZW50KTtcbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkQ2xhc3MgPT09ICdlLW1maXJzdCcgfHwgc2VsZWN0ZWRDbGFzcyA9PT0gJ2UtbXByZXYnIHx8IHNlbGVjdGVkQ2xhc3MgPT09ICdlLW1uZXh0J1xuICAgICAgICAgICAgfHwgc2VsZWN0ZWRDbGFzcyA9PT0gJ2UtbWxhc3QnID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmNoYW5nZUZvY3VzSW5BZGFwdGl2ZU1vZGUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICB2YXIgc2VsZWN0ZWRDbGFzcyA9IHRoaXMuZ2V0Q2xhc3MoZWxlbWVudCk7XG4gICAgICAgIHZhciBjbGFzc0VsZW1lbnQgPSB0aGlzLmdldEVsZW1lbnRCeUNsYXNzKHNlbGVjdGVkQ2xhc3MpO1xuICAgICAgICBpZiAoY2xhc3NFbGVtZW50ICYmIGNsYXNzRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZGlzYWJsZScpKSB7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRDbGFzcyA9PT0gJ2UtbW5leHQnIHx8IHNlbGVjdGVkQ2xhc3MgPT09ICdlLW1sYXN0Jykge1xuICAgICAgICAgICAgICAgIHZhciBtUHJldiA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1tcHJldicpO1xuICAgICAgICAgICAgICAgIG1QcmV2LmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFBhZ2VyRm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLnJlbW92ZVRhYmluZGV4TGFzdEVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFiSW5kZXhFbGVtZW50cyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbdGFiaW5kZXhdOm5vdChbdGFiaW5kZXg9XCItMVwiXSknKTtcbiAgICAgICAgaWYgKHRhYkluZGV4RWxlbWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0YWJJbmRleEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0YWJJbmRleEVsZW1lbnRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXTtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBQYWdlci5wcm90b3R5cGUuZ2V0QWN0aXZlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1hY3RpdmUnKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSAtIFJldHVybnMgRHJvcERvd24gUGFnZVxuICAgICAqIEBoaWRkZW4gKi9cbiAgICBQYWdlci5wcm90b3R5cGUuZ2V0RHJvcERvd25QYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZHJvcERvd25QYWdlSG9sZGVyID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXBhZ2VyZHJvcGRvd24nKTtcbiAgICAgICAgdmFyIGRyb3BEb3duUGFnZTtcbiAgICAgICAgaWYgKGRyb3BEb3duUGFnZUhvbGRlcikge1xuICAgICAgICAgICAgZHJvcERvd25QYWdlID0gZHJvcERvd25QYWdlSG9sZGVyLmNoaWxkcmVuWzBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkcm9wRG93blBhZ2U7XG4gICAgfTtcbiAgICBQYWdlci5wcm90b3R5cGUuZ2V0Rm9jdXNlZEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtZm9jdXNlZCcpO1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmdldENsYXNzID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRDbGFzcztcbiAgICAgICAgdmFyIGNsYXNzTGlzdCA9IFsnZS1tZmlyc3QnLCAnZS1tcHJldicsICdlLWZpcnN0JywgJ2UtcHJldicsICdlLXBwJyxcbiAgICAgICAgICAgICdlLW5wJywgJ2UtbmV4dCcsICdlLWxhc3QnLCAnZS1tbmV4dCcsICdlLW1sYXN0J107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2xhc3NMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc0xpc3RbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRDbGFzcyA9IGNsYXNzTGlzdFtwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRDbGFzcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3VycmVudENsYXNzO1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmdldEVsZW1lbnRCeUNsYXNzID0gZnVuY3Rpb24gKGNsYXNzTmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgY2xhc3NOYW1lKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFBhZ2VyIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnRbXX0gcHJldmlvdXNFbGVtZW50cyAtIEl0ZXJhdGluZyBwYWdlciBlbGVtZW50XG4gICAgICogQHJldHVybnMge0VsZW1lbnRbXX0gLSBSZXR1cm5zIGZvY3VzYWJsZSBwYWdlciBlbGVtZW50XG4gICAgICogQGhpZGRlbiAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5nZXRGb2N1c2FibGVQYWdlckVsZW1lbnRzID0gZnVuY3Rpb24gKGVsZW1lbnQsIHByZXZpb3VzRWxlbWVudHMpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGVsZW1lbnQ7XG4gICAgICAgIHZhciB0YXJnZXRDaGlsZHJlbnMgPSB0YXJnZXQuY2hpbGRyZW47XG4gICAgICAgIHZhciBwYWdlckVsZW1lbnRzID0gcHJldmlvdXNFbGVtZW50cztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXJnZXRDaGlsZHJlbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50XzEgPSB0YXJnZXRDaGlsZHJlbnNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnRfMS5jaGlsZHJlbi5sZW5ndGggPiAwICYmICFlbGVtZW50XzEuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXBhZ2VzaXplcycpKSB7XG4gICAgICAgICAgICAgICAgcGFnZXJFbGVtZW50cyA9IHRoaXMuZ2V0Rm9jdXNhYmxlUGFnZXJFbGVtZW50cyhlbGVtZW50XzEsIHBhZ2VyRWxlbWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhYmluZGV4RWxlbWVudCA9IHRhcmdldENoaWxkcmVuc1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV07XG4gICAgICAgICAgICAgICAgaWYgKHRhYmluZGV4RWxlbWVudC5oYXNBdHRyaWJ1dGUoJ3RhYmluZGV4JykgJiYgIWVsZW1lbnRfMS5jbGFzc0xpc3QuY29udGFpbnMoJ2UtZGlzYWJsZScpXG4gICAgICAgICAgICAgICAgICAgICYmIGVsZW1lbnRfMS5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSdcbiAgICAgICAgICAgICAgICAgICAgJiYgIWlzTnVsbE9yVW5kZWZpbmVkKGVsZW1lbnRfMS5vZmZzZXRQYXJlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VyRWxlbWVudHMucHVzaCh0YWJpbmRleEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFnZXJFbGVtZW50cztcbiAgICB9O1xuICAgIFBhZ2VyLnByb3RvdHlwZS5hZGRGb2N1cyA9IGZ1bmN0aW9uIChlbGVtZW50LCBhZGRGb2N1c0NsYXNzKSB7XG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIGlmIChhZGRGb2N1c0NsYXNzKSB7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoW2VsZW1lbnRdLCBbJ2UtZm9jdXNlZCcsICdlLWZvY3VzJ10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxlbWVudC50YWJJbmRleCA9IDA7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhZ2VyLnByb3RvdHlwZS5yZW1vdmVGb2N1cyA9IGZ1bmN0aW9uIChlbGVtZW50LCByZW1vdmVGb2N1c0NsYXNzKSB7XG4gICAgICAgIGlmIChyZW1vdmVGb2N1c0NsYXNzKSB7XG4gICAgICAgICAgICByZW1vdmVDbGFzcyhbZWxlbWVudF0sIFsnZS1mb2N1c2VkJywgJ2UtZm9jdXMnXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC50YWJJbmRleCA9IC0xO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbG9jYWxpemVkIGxhYmVsIGJ5IGxvY2FsZSBrZXl3b3JkLlxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBrZXkgLSBzcGVjaWZpZXMgdGhlIGtleVxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJldHVybnMgdGhlIGxvY2FsaXplZCBsYWJlbFxuICAgICAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5nZXRMb2NhbGl6ZWRMYWJlbCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlT2JqLmdldENvbnN0YW50KGtleSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBOYXZpZ2F0ZSB0byB0YXJnZXQgcGFnZSBieSBnaXZlbiBudW1iZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHBhZ2VObyAtIERlZmluZXMgcGFnZSBudW1iZXIuXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgUGFnZXIucHJvdG90eXBlLmdvVG9QYWdlID0gZnVuY3Rpb24gKHBhZ2VObykge1xuICAgICAgICBpZiAodGhpcy5jaGVja0dvVG9QYWdlKHBhZ2VObykpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSBwYWdlTm87XG4gICAgICAgICAgICB0aGlzLmlzSW50ZXJhY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5kYXRhQmluZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcGFnZVNpemUgLSBzcGVjaWZpZXMgdGhlIHBhZ2VzaXplXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5zZXRQYWdlU2l6ZSA9IGZ1bmN0aW9uIChwYWdlU2l6ZSkge1xuICAgICAgICB0aGlzLnBhZ2VTaXplID0gcGFnZVNpemU7XG4gICAgICAgIHRoaXMuZGF0YUJpbmQoKTtcbiAgICB9O1xuICAgIFBhZ2VyLnByb3RvdHlwZS5jaGVja3BhZ2VzaXplcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFnZVNpemVzID09PSB0cnVlIHx8IHRoaXMucGFnZVNpemVzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmNoZWNrR29Ub1BhZ2UgPSBmdW5jdGlvbiAobmV3UGFnZU5vLCBvbGRQYWdlTm8pIHtcbiAgICAgICAgaWYgKG5ld1BhZ2VObyAhPT0gdGhpcy5jdXJyZW50UGFnZSkge1xuICAgICAgICAgICAgdGhpcy5wcmV2aW91c1BhZ2VObyA9IHRoaXMuY3VycmVudFBhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChvbGRQYWdlTm8pKSB7XG4gICAgICAgICAgICB0aGlzLnByZXZpb3VzUGFnZU5vID0gb2xkUGFnZU5vO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByZXZpb3VzUGFnZU5vICE9PSBuZXdQYWdlTm8gJiYgKG5ld1BhZ2VObyA+PSAxICYmIG5ld1BhZ2VObyA8PSB0aGlzLnRvdGFsUGFnZXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBQYWdlci5wcm90b3R5cGUuY3VycmVudFBhZ2VDaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1Byb3AsIG9sZFByb3ApIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlUXVlcnlTdHJpbmcpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUXVlcnlTdHJpbmcodGhpcy5jdXJyZW50UGFnZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld1Byb3AuY3VycmVudFBhZ2UgIT09IG9sZFByb3AuY3VycmVudFBhZ2UgfHwgbmV3UHJvcC5wYWdlU2l6ZSAhPT0gb2xkUHJvcC5wYWdlU2l6ZSkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFBhZ2U6IHRoaXMuY3VycmVudFBhZ2UsXG4gICAgICAgICAgICAgICAgbmV3UHJvcDogbmV3UHJvcCwgb2xkUHJvcDogb2xkUHJvcCwgY2FuY2VsOiBmYWxzZSwgaXNJbnRlcmFjdGVkOiB0aGlzLmlzSW50ZXJhY3RlZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignY2xpY2snLCBhcmdzKTtcbiAgICAgICAgICAgIGlmICghYXJncy5jYW5jZWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzQ2FuY2VsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzQ2FuY2VsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAob2xkUHJvcCAmJiBvbGRQcm9wLnBhZ2VTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh7IHBhZ2VTaXplOiBvbGRQcm9wLnBhZ2VTaXplIH0sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wYWdlcmRyb3Bkb3duTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2VyZHJvcGRvd25Nb2R1bGUuc2V0RHJvcERvd25WYWx1ZSgndmFsdWUnLCBvbGRQcm9wLnBhZ2VTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZXJkcm9wZG93bk1vZHVsZVsnZHJvcERvd25MaXN0T2JqZWN0J10udGV4dCA9IG9sZFByb3AucGFnZVNpemUgKyAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLnBhZ2VyVGVtcGxhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUmVhY3RUZW1wbGF0ZSgpICYmIHRoaXMuaGFzUGFyZW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2UtcGFnZXJ0ZW1wbGF0ZScpO1xuICAgICAgICB0aGlzLmNvbXBpbGUodGhpcy50ZW1wbGF0ZSk7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgY3VycmVudFBhZ2U6IHRoaXMuY3VycmVudFBhZ2UsIHBhZ2VTaXplOiB0aGlzLnBhZ2VTaXplLCBwYWdlQ291bnQ6IHRoaXMucGFnZUNvdW50LFxuICAgICAgICAgICAgdG90YWxSZWNvcmRzQ291bnQ6IHRoaXMudG90YWxSZWNvcmRzQ291bnQsIHRvdGFsUGFnZXM6IHRoaXMudG90YWxQYWdlc1xuICAgICAgICB9O1xuICAgICAgICB2YXIgdGVtcElkID0gdGhpcy5lbGVtZW50LnBhcmVudEVsZW1lbnQuaWQgKyAnX3RlbXBsYXRlJztcbiAgICAgICAgaWYgKHRoaXMuaXNSZWFjdFRlbXBsYXRlKCkgJiYgIXRoaXMuaXNWdWUpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0UGFnZXJUZW1wbGF0ZSgpKGRhdGEsIHRoaXMsICdwYWdlclRlbXBsYXRlJywgdGVtcElkLCBudWxsLCBudWxsLCB0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJSZWFjdFRlbXBsYXRlcygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pc1Z1ZSA/IHRoaXMuZ2V0UGFnZXJUZW1wbGF0ZSgpKGRhdGEsIHRoaXMsICdwYWdlclRlbXBsYXRlJywgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgdGhpcy5yb290KVxuICAgICAgICAgICAgICAgIDogdGhpcy5nZXRQYWdlclRlbXBsYXRlKCkoZGF0YSk7XG4gICAgICAgICAgICBhcHBlbmRDaGlsZHJlbih0aGlzLmVsZW1lbnQsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBQYWdlci5wcm90b3R5cGUudXBkYXRlVG90YWxQYWdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy50b3RhbFBhZ2VzID0gdGhpcy5pc0FsbFBhZ2UgPyAxIDogKHRoaXMudG90YWxSZWNvcmRzQ291bnQgJSB0aGlzLnBhZ2VTaXplID09PSAwKSA/ICh0aGlzLnRvdGFsUmVjb3Jkc0NvdW50IC8gdGhpcy5wYWdlU2l6ZSkgOlxuICAgICAgICAgICAgKHBhcnNlSW50KCh0aGlzLnRvdGFsUmVjb3Jkc0NvdW50IC8gdGhpcy5wYWdlU2l6ZSkudG9TdHJpbmcoKSwgMTApICsgMSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IHJldHVybnMgdGhlIGZ1bmN0aW9uXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5nZXRQYWdlclRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50ZW1wbGF0ZUZuO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmcgfCBGdW5jdGlvbn0gdGVtcGxhdGUgLSBzcGVjaWZpZXMgdGhlIHRlbXBsYXRlXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSByZXR1cm5zIHRoZSBmdW5jdGlvblxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBQYWdlci5wcm90b3R5cGUuY29tcGlsZSA9IGZ1bmN0aW9uICh0ZW1wbGF0ZSkge1xuICAgICAgICBpZiAodGVtcGxhdGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0ZW1wbGF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlRm4gPSB0ZW1wbGF0ZUNvbXBpbGVyKHRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRlbXBsYXRlKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVGbiA9IHRlbXBsYXRlQ29tcGlsZXIoZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0ZW1wbGF0ZSkuaW5uZXJIVE1MLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlRm4gPSB0ZW1wbGF0ZUNvbXBpbGVyKHRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZUZuID0gdGVtcGxhdGVDb21waWxlcih0ZW1wbGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlZnJlc2hlcyBwYWdlIGNvdW50LCBwYWdlciBpbmZvcm1hdGlvbiBhbmQgZXh0ZXJuYWwgbWVzc2FnZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50ZW1wbGF0ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNSZWFjdFRlbXBsYXRlKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRvdGFsUGFnZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLnBhZ2VSZWZyZXNoLCB7fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQgJiYgdGhpcy5wYXJlbnQuaXNBbmd1bGFyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmRlc3Ryb3lUZW1wbGF0ZShbJ3BhZ2VyVGVtcGxhdGUnXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVG90YWxQYWdlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMucGFnZXJUZW1wbGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVSVEwoKTtcbiAgICAgICAgICAgIHZhciBmb2N1c2VkVGFiSW5kZXhFbGVtZW50ID0gdGhpcy5nZXRGb2N1c2VkVGFiaW5kZXhFbGVtZW50KCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lck1vZHVsZS5yZWZyZXNoKCk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZVRhYmluZGV4TGFzdEVsZW1lbnRzKCk7XG4gICAgICAgICAgICBpZiAoZm9jdXNlZFRhYkluZGV4RWxlbWVudCAmJiBmb2N1c2VkVGFiSW5kZXhFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZS1kaXNhYmxlJykpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGVja0ZvY3VzSW5BZGFwdGl2ZU1vZGUoZm9jdXNlZFRhYkluZGV4RWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VGb2N1c0luQWRhcHRpdmVNb2RlKGZvY3VzZWRUYWJJbmRleEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQYWdlckZvY3VzRm9yQWN0aXZlRWxlbWVudCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZVBhZ2VyTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFnZXJNZXNzYWdlTW9kdWxlLnJlZnJlc2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnBhZ2VyZHJvcGRvd25Nb2R1bGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2VyZHJvcGRvd25Nb2R1bGUucmVmcmVzaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlRXh0ZXJuYWxNZXNzYWdlICYmIHRoaXMuZXh0ZXJuYWxNZXNzYWdlTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5leHRlcm5hbE1lc3NhZ2VNb2R1bGUucmVmcmVzaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZXRUYWJJbmRleEZvckZvY3VzTGFzdEVsZW1lbnQoKTtcbiAgICAgICAgICAgIHRoaXMucmVzaXplUGFnZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLnVwZGF0ZVJUTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlUnRsKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1ydGwnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdlLXJ0bCcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQYWdlci5wcm90b3R5cGUuaW5pdExvY2FsaXphdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5sb2NhbGVPYmogPSBuZXcgTDEwbih0aGlzLmdldE1vZHVsZU5hbWUoKSwgdGhpcy5kZWZhdWx0Q29uc3RhbnRzLCB0aGlzLmxvY2FsZSk7XG4gICAgfTtcbiAgICBQYWdlci5wcm90b3R5cGUudXBkYXRlUXVlcnlTdHJpbmcgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHVwZGF0ZWRVcmwgPSB0aGlzLmdldFVwZGF0ZWRVUkwod2luZG93LmxvY2F0aW9uLmhyZWYsICdwYWdlJywgdmFsdWUudG9TdHJpbmcoKSk7XG4gICAgICAgIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSh7IHBhdGg6IHVwZGF0ZWRVcmwgfSwgJycsIHVwZGF0ZWRVcmwpO1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmdldFVwZGF0ZWRVUkwgPSBmdW5jdGlvbiAodXJpLCBrZXksIHZhbHVlKSB7XG4gICAgICAgIHZhciByZWdFeHAgPSBSZWdFeHA7XG4gICAgICAgIHZhciByZWd4ID0gbmV3IHJlZ0V4cCgnKFs/fCZdKScgKyBrZXkgKyAnPS4qPygmfCN8JCknLCAnaScpO1xuICAgICAgICBpZiAodXJpLm1hdGNoKHJlZ3gpKSB7XG4gICAgICAgICAgICByZXR1cm4gdXJpLnJlcGxhY2UocmVneCwgJyQxJyArIGtleSArICc9JyArIHZhbHVlICsgJyQyJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgaGFzaCA9ICcnO1xuICAgICAgICAgICAgaWYgKHVyaS5pbmRleE9mKCcjJykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgaGFzaCA9IHVyaS5yZXBsYWNlKC8uKiMvLCAnIycpO1xuICAgICAgICAgICAgICAgIHVyaSA9IHVyaS5yZXBsYWNlKC8jLiovLCAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdXJpICsgKHVyaS5pbmRleE9mKCc/JykgIT09IC0xID8gJyYnIDogJz8nKSArIGtleSArICc9JyArIHZhbHVlICsgaGFzaDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLnJlbmRlckZpcnN0UHJldkRpdkZvckRldmljZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2UtbWZpcnN0IGUtaWNvbnMgZS1pY29uLWZpcnN0JyxcbiAgICAgICAgICAgIGF0dHJzOiB7IHRpdGxlOiB0aGlzLmdldExvY2FsaXplZExhYmVsKCdmaXJzdFBhZ2VUb29sdGlwJyksIHRhYmluZGV4OiAnLTEnIH1cbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiAnZS1tcHJldiBlLWljb25zIGUtaWNvbi1wcmV2JyxcbiAgICAgICAgICAgIGF0dHJzOiB7IHRpdGxlOiB0aGlzLmdldExvY2FsaXplZExhYmVsKCdwcmV2aW91c1BhZ2VUb29sdGlwJyksIHRhYmluZGV4OiAnLTEnIH1cbiAgICAgICAgfSkpO1xuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLnJlbmRlck5leHRMYXN0RGl2Rm9yRGV2aWNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgY2xhc3NOYW1lOiAnZS1tbmV4dCBlLWljb25zIGUtaWNvbi1uZXh0JyxcbiAgICAgICAgICAgIGF0dHJzOiB7IHRpdGxlOiB0aGlzLmdldExvY2FsaXplZExhYmVsKCduZXh0UGFnZVRvb2x0aXAnKSwgdGFiaW5kZXg6ICctMScgfVxuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICBjbGFzc05hbWU6ICdlLW1sYXN0IGUtaWNvbnMgZS1pY29uLWxhc3QnLFxuICAgICAgICAgICAgYXR0cnM6IHsgdGl0bGU6IHRoaXMuZ2V0TG9jYWxpemVkTGFiZWwoJ2xhc3RQYWdlVG9vbHRpcCcpLCB0YWJpbmRleDogJy0xJyB9XG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIFBhZ2VyLnByb3RvdHlwZS5hZGRBcmlhTGFiZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjbGFzc0xpc3QgPSBbJy5lLW1maXJzdCcsICcuZS1tcHJldicsICcuZS1tbmV4dCcsICcuZS1tbGFzdCddO1xuICAgICAgICBpZiAoIUJyb3dzZXIuaXNEZXZpY2UpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2xhc3NMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihjbGFzc0xpc3RbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0aXRsZScpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZXIucHJvdG90eXBlLmlzUmVhY3RUZW1wbGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmlzUmVhY3QgfHwgdGhpcy5pc1Z1ZSkgJiYgdGhpcy50ZW1wbGF0ZSAmJiB0eXBlb2YgKHRoaXMudGVtcGxhdGUpICE9PSAnc3RyaW5nJyAmJiAhKHRoaXMudGVtcGxhdGUucHJvdG90eXBlICYmIHRoaXMudGVtcGxhdGUucHJvdG90eXBlLkNTUFRlbXBsYXRlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIExvb3AgdGhyb3VnaCBhbGwgdGhlIGlubmVyIGVsZW1lbnRzIG9mIHBhZ2VyIHRvIGNhbGN1bGF0ZSB0aGUgcmVxdWlyZWQgd2lkdGggZm9yIHBhZ2VyIGNoaWxkIGVsZW1lbnRzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn0gcmV0dXJucyB0aGUgYWN0dWFsIHdpZHRoIG9jY3VwaWVkIGJ5IHBhZ2VyIGVsZW1lbnRzLlxuICAgICAqL1xuICAgIFBhZ2VyLnByb3RvdHlwZS5jYWxjdWxhdGVBY3R1YWxXaWR0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhZ2VyRWxlbWVudHMgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgICAgICAgLyogdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aCAqL1xuICAgICAgICAnLmUtbWZpcnN0LCAuZS1tcHJldiwgLmUtaWNvbi1maXJzdCwgLmUtaWNvbi1wcmV2LCAuZS1wcDpub3QoLmUtZGlzYWJsZSksIC5lLW51bWVyaWNpdGVtOm5vdCguZS1oaWRlKSwgLmUtbnVtZXJpY2l0ZW0uZS1hY3RpdmUuZS1oaWRlLCAuZS1ucDpub3QoLmUtZGlzYWJsZSksIC5lLWljb24tbmV4dCwgLmUtaWNvbi1sYXN0LCAuZS1wYXJlbnRtc2diYXIsIC5lLW1uZXh0LCAuZS1tbGFzdCwgLmUtcGFnZXJkcm9wZG93biwgLmUtcGFnZXJjb25zdGFudCcpO1xuICAgICAgICB2YXIgYWN0dWFsV2lkdGggPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhZ2VyRWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlKHBhZ2VyRWxlbWVudHNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKS5kaXNwbGF5ICE9PSAnbm9uZScpIHtcbiAgICAgICAgICAgICAgICBhY3R1YWxXaWR0aCArPSBwYWdlckVsZW1lbnRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXS5vZmZzZXRXaWR0aFxuICAgICAgICAgICAgICAgICAgICArIHBhcnNlRmxvYXQoZ2V0Q29tcHV0ZWRTdHlsZShwYWdlckVsZW1lbnRzW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSkubWFyZ2luTGVmdClcbiAgICAgICAgICAgICAgICAgICAgKyBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUocGFnZXJFbGVtZW50c1twYXJzZUludChpLnRvU3RyaW5nKCksIDEwKV0pLm1hcmdpblJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFnZXJDb250YWluZXIgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmUtcGFnZXJjb250YWluZXInKTtcbiAgICAgICAgYWN0dWFsV2lkdGggKz0gcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKHBhZ2VyQ29udGFpbmVyKS5tYXJnaW5MZWZ0KVxuICAgICAgICAgICAgKyBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUocGFnZXJDb250YWluZXIpLm1hcmdpblJpZ2h0KTtcbiAgICAgICAgcmV0dXJuIGFjdHVhbFdpZHRoO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVzaXplIHBhZ2VyIGNvbXBvbmVudCBieSBoaWRpbmcgcGFnZXIgY29tcG9uZW50J3MgbnVtZXJpYyBpdGVtcyBiYXNlZCBvbiB0b3RhbCB3aWR0aCBhdmFpbGFibGUgZm9yIHBhZ2VyLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3ZvaWR9XG4gICAgICovXG4gICAgUGFnZXIucHJvdG90eXBlLnJlc2l6ZVBhZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaXNTdHlsZUFwcGxpZWQgPSB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlLXBhZ2VyJykgPyBnZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLXN0eWxlJykuaW5jbHVkZXMoJ3NvbGlkJykgOiBudWxsO1xuICAgICAgICBpZiAoISh0aGlzLnRlbXBsYXRlKSAmJiBpc1N0eWxlQXBwbGllZCkge1xuICAgICAgICAgICAgdmFyIHBhZ2VyQ29udGFpbmVyID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXBhZ2VyY29udGFpbmVyJyk7XG4gICAgICAgICAgICB2YXIgYWN0dWFsV2lkdGggPSB0aGlzLmNhbGN1bGF0ZUFjdHVhbFdpZHRoKCk7XG4gICAgICAgICAgICB2YXIgcGFnZXJXaWR0aCA9IHRoaXMuZWxlbWVudC5jbGllbnRXaWR0aFxuICAgICAgICAgICAgICAgIC0gcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudCkucGFkZGluZ0xlZnQpXG4gICAgICAgICAgICAgICAgLSBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUodGhpcy5lbGVtZW50KS5wYWRkaW5nUmlnaHQpXG4gICAgICAgICAgICAgICAgLSBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUodGhpcy5lbGVtZW50KS5tYXJnaW5MZWZ0KVxuICAgICAgICAgICAgICAgIC0gcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudCkubWFyZ2luUmlnaHQpO1xuICAgICAgICAgICAgdmFyIG51bUl0ZW1zID0gcGFnZXJDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmUtbnVtZXJpY2l0ZW06bm90KC5lLWhpZGUpOm5vdChbc3R5bGUqPVwiZGlzcGxheTogbm9uZVwiXSk6bm90KC5lLW5wKTpub3QoLmUtcHApJyk7XG4gICAgICAgICAgICB2YXIgaGlkZGVuTnVtSXRlbXMgPSBwYWdlckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuZS1udW1lcmljaXRlbS5lLWhpZGU6bm90KFtzdHlsZSo9XCJkaXNwbGF5OiBub25lXCJdKScpO1xuICAgICAgICAgICAgdmFyIGhpZGVGcm9tID0gbnVtSXRlbXMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHNob3dGcm9tID0gMTtcbiAgICAgICAgICAgIHZhciBidWZmZXJXaWR0aCA9ICghaXNOdWxsT3JVbmRlZmluZWQocGFyZW50c1VudGlsKHRoaXMuZWxlbWVudCwgJ2UtYmlnZ2VyJykpKSA/IDEwIDogNTtcbiAgICAgICAgICAgIHZhciBOUCA9IHBhZ2VyQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5lLW5wJyk7XG4gICAgICAgICAgICB2YXIgUFAgPSBwYWdlckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuZS1wcCcpO1xuICAgICAgICAgICAgdmFyIGRldGFpbEl0ZW1zID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lLXBhcmVudG1zZ2Jhcjpub3QoLmUtaGlkZSk6bm90KFtzdHlsZSo9XCJkaXNwbGF5OiBub25lXCJdKSwgLmUtcGFnZXNpemVzOm5vdCguZS1oaWRlKTpub3QoW3N0eWxlKj1cImRpc3BsYXk6IG5vbmVcIl0pJyk7XG4gICAgICAgICAgICB2YXIgdG90RGV0YWlsV2lkdGhfMSA9IDA7XG4gICAgICAgICAgICBpZiAoZGV0YWlsSXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZGV0YWlsSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICB0b3REZXRhaWxXaWR0aF8xICs9IGl0ZW0ub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hdmVyYWdlRGV0YWlsV2lkdGggPSB0b3REZXRhaWxXaWR0aF8xIC8gZGV0YWlsSXRlbXMubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRvdGFsV2lkdGggPSAwO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBMb29wIHRvIGNhbGN1bGF0ZSBhdmVyYWdlIHdpZHRoIG9mIG51bWVyaWMgaXRlbS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1JdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRvdGFsV2lkdGggKz0gbnVtSXRlbXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLm9mZnNldFdpZHRoXG4gICAgICAgICAgICAgICAgICAgICsgcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKG51bUl0ZW1zW3BhcnNlSW50KGkudG9TdHJpbmcoKSwgMTApXSkubWFyZ2luTGVmdClcbiAgICAgICAgICAgICAgICAgICAgKyBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUobnVtSXRlbXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldKS5tYXJnaW5SaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbnVtZXJpY0l0ZW1XaWR0aCA9IHRvdGFsV2lkdGggLyBudW1JdGVtcy5sZW5ndGg7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvbmRpdGlvbiB0byBoaWRlIG51bWVyaWMgaXRlbXMgd2hlbiBjYWxjdWxhdGVkIGFjdHVhbCB3aWR0aCBleGNlZWRzIGF2YWlsYWJsZSBwYWdlciBzcGFjZS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKHBhZ2VyV2lkdGggPiAwICYmIChhY3R1YWxXaWR0aCA+PSAocGFnZXJXaWR0aCAtIChudW1lcmljSXRlbVdpZHRoID8gbnVtZXJpY0l0ZW1XaWR0aCA6IDApKSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzUGFnZXJSZXNpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSAhPT0gdGhpcy50b3RhbFBhZ2VzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTGlzdChOUCwgWydlLW51bWVyaWNpdGVtJywgJ2UtcGFnZXItZGVmYXVsdCddLCBbJ2UtbmV4dHByZXZpdGVtZGlzYWJsZWQnLCAnZS1kaXNhYmxlJ10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhY3R1YWxXaWR0aCA9IHRoaXMuY2FsY3VsYXRlQWN0dWFsV2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgZGlmZiA9IE1hdGguYWJzKChhY3R1YWxXaWR0aCkgLSBwYWdlcldpZHRoKTtcbiAgICAgICAgICAgICAgICAvLyBUbyBjYWxjdWxhdGUgbnVtYmVyIG9mIG51bWVyaWMgaXRlbXMgbmVlZCB0byBiZSBoaWRkZW4uXG4gICAgICAgICAgICAgICAgdmFyIG51bVRvSGlkZSA9IE1hdGguY2VpbChkaWZmIC8gKG51bWVyaWNJdGVtV2lkdGgpKTtcbiAgICAgICAgICAgICAgICBudW1Ub0hpZGUgPSAobnVtVG9IaWRlID09PSAwKSA/IDEgOiAobnVtVG9IaWRlID4gbnVtSXRlbXMubGVuZ3RoKSA/IChudW1JdGVtcy5sZW5ndGggLSAxKSA6IG51bVRvSGlkZTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBudW1Ub0hpZGU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGlkZUluZGV4ID0gaGlkZUZyb20gLSBwYXJzZUludChpLnRvU3RyaW5nKCksIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgbnVtSXRlbXMgPSBwYWdlckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuZS1udW1lcmljaXRlbTpub3QoLmUtaGlkZSk6bm90KFtzdHlsZSo9XCJkaXNwbGF5OiBub25lXCJdKTpub3QoLmUtbnApOm5vdCguZS1wcCknKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgIT09IDEgJiYgKChwYXJzZUludChudW1JdGVtc1tNYXRoLmFicyhoaWRlSW5kZXgpXS5nZXRBdHRyaWJ1dGUoJ2luZGV4JyksIDEwKSA9PT0gdGhpcy5jdXJyZW50UGFnZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8IHBhcnNlSW50KG51bUl0ZW1zW251bUl0ZW1zLmxlbmd0aCAtIDFdLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSwgMTApID09PSB0aGlzLmN1cnJlbnRQYWdlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZUluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTGlzdChQUCwgWydlLW51bWVyaWNpdGVtJywgJ2UtcGFnZXItZGVmYXVsdCddLCBbJ2UtbmV4dHByZXZpdGVtZGlzYWJsZWQnLCAnZS1kaXNhYmxlJ10pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChudW1JdGVtc1tNYXRoLmFicyhoaWRlSW5kZXgpXSAmJiAhKG51bUl0ZW1zW01hdGguYWJzKGhpZGVJbmRleCldLmNsYXNzTGlzdC5jb250YWlucygnZS1jdXJyZW50aXRlbScpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbnVtSXRlbXNbTWF0aC5hYnMoaGlkZUluZGV4KV0uY2xhc3NMaXN0LmFkZCgnZS1oaWRlJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbnVtSXRlbXMgPSBwYWdlckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuZS1udW1lcmljaXRlbTpub3QoLmUtaGlkZSk6bm90KFtzdHlsZSo9XCJkaXNwbGF5OiBub25lXCJdKTpub3QoLmUtbnApOm5vdCguZS1wcCknKTtcbiAgICAgICAgICAgICAgICAvLyBUbyBoaWRlIFBhZ2VyIG1lc3NhZ2UgZWxlbWVudHMgd2hlbiBubyBtb3JlIG51bWVyaWMgaXRlbXMgYXZhaWxhYmxlIHRvIGhpZGUuXG4gICAgICAgICAgICAgICAgaWYgKG51bUl0ZW1zLmxlbmd0aCA8PSAxICYmIGRldGFpbEl0ZW1zLmxlbmd0aCAmJiB3aW5kb3cuaW5uZXJXaWR0aCA+PSA3NjgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhZ2VyRGV0YWlsSXRlbXNXaWR0aCA9IHRoaXMuY2FsY3VsYXRlQWN0dWFsV2lkdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChwYWdlckRldGFpbEl0ZW1zV2lkdGgpID4gKHBhZ2VyV2lkdGggLSBidWZmZXJXaWR0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZXRhaWx0b0hpZGUgPSBNYXRoLmZsb29yKChwYWdlcldpZHRoIC0gKHBhZ2VyRGV0YWlsSXRlbXNXaWR0aCAtIHRvdERldGFpbFdpZHRoXzEpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8gdGhpcy5hdmVyYWdlRGV0YWlsV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsdG9IaWRlID0gZGV0YWlsSXRlbXMubGVuZ3RoIC0gZGV0YWlsdG9IaWRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAoZGV0YWlsdG9IaWRlID4gZGV0YWlsSXRlbXMubGVuZ3RoID8gZGV0YWlsSXRlbXMubGVuZ3RoIDogZGV0YWlsdG9IaWRlKTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsSXRlbXNbcGFyc2VJbnQoaS50b1N0cmluZygpLCAxMCldLmNsYXNzTGlzdC5hZGQoJ2UtaGlkZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb25kaXRpb24gdG8gc2hvdyBudW1lcmljIGl0ZW1zIHdoZW4gc3BhY2UgYXZhaWxibGUgaW4gcGFnZXIgYXQgZG9tLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBlbHNlIGlmIChhY3R1YWxXaWR0aCA8IChwYWdlcldpZHRoKSAmJiBoaWRkZW5OdW1JdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlmZiA9IE1hdGguYWJzKHBhZ2VyV2lkdGggLSAoYWN0dWFsV2lkdGgpKTtcbiAgICAgICAgICAgICAgICB2YXIgaGlkZGVuRGV0YWlsSXRlbXMgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtcGFyZW50bXNnYmFyLmUtaGlkZSwgLmUtcGFnZXNpemVzLmUtaGlkZScpO1xuICAgICAgICAgICAgICAgIC8vIFRvIHNob3cgUGFnZXIgbWVzc2FnZSBlbGVtZW50cy5cbiAgICAgICAgICAgICAgICBpZiAoaGlkZGVuRGV0YWlsSXRlbXMubGVuZ3RoICYmIChkaWZmID4gKHRoaXMuYXZlcmFnZURldGFpbFdpZHRoICsgKHRoaXMuYXZlcmFnZURldGFpbFdpZHRoIC8gNCkpKSkge1xuICAgICAgICAgICAgICAgICAgICBoaWRkZW5EZXRhaWxJdGVtc1soaGlkZGVuRGV0YWlsSXRlbXMubGVuZ3RoIC0gMSldLmNsYXNzTGlzdC5yZW1vdmUoJ2UtaGlkZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoKGRpZmYgPiAobnVtZXJpY0l0ZW1XaWR0aCAqIDIpICYmICFoaWRkZW5EZXRhaWxJdGVtcy5sZW5ndGggJiYgd2luZG93LmlubmVyV2lkdGggPj0gNzY4KSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUbyBjYWxjdWxhdGUgbnVtYmVyIG9mIG51bWVyaWMgaXRlbXMgbmVlZCB0byBiZSBzaG93bi5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG51bVRvU2hvdyA9IE1hdGguZmxvb3IoKGRpZmYpIC8gKG51bWVyaWNJdGVtV2lkdGggKyBidWZmZXJXaWR0aCkpO1xuICAgICAgICAgICAgICAgICAgICBudW1Ub1Nob3cgPSAobnVtVG9TaG93ID4gaGlkZGVuTnVtSXRlbXMubGVuZ3RoKSA/IGhpZGRlbk51bUl0ZW1zLmxlbmd0aCA6IChudW1Ub1Nob3cgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgLy9TZWdncmVnYXRpbmcgaGlkZGVuIG51bSBpdGVtcyBhcyBsZXNzIGluZGV4IGFuZCBncmVhdGVyIGluZGV4IHZhbHVlcyB0aGFuIGN1cnJlbnQgcGFnZSB2YWx1ZS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlc3NlckluZGV4SXRlbXMgPSBBcnJheS5mcm9tKGhpZGRlbk51bUl0ZW1zKS5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIHBhcnNlSW50KGl0ZW0uZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkgPCBfdGhpcy5jdXJyZW50UGFnZTsgfSkuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gcGFyc2VJbnQoYi5nZXRBdHRyaWJ1dGUoJ2luZGV4JyksIDEwKSAtIHBhcnNlSW50KGEuZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JlYXRlckluZGV4SXRlbXMgPSBBcnJheS5mcm9tKGhpZGRlbk51bUl0ZW1zKS5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIHBhcnNlSW50KGl0ZW0uZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkgPiBfdGhpcy5jdXJyZW50UGFnZTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaG93SXRlbXMgPSAobGVzc2VySW5kZXhJdGVtcy5sZW5ndGggJiYgbGVzc2VySW5kZXhJdGVtcylcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8IChncmVhdGVySW5kZXhJdGVtcy5sZW5ndGggJiYgZ3JlYXRlckluZGV4SXRlbXMpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBudW1Ub1Nob3c7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNob3dJdGVtID0gc2hvd0l0ZW1zICYmIHNob3dJdGVtc1tNYXRoLmFicyhzaG93RnJvbSAtIGkpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaG93SXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dJdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2UtaGlkZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaG93SXRlbSA9PT0gc2hvd0l0ZW1zW3Nob3dJdGVtcy5sZW5ndGggLSAxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93SXRlbXMgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG51bUl0ZW1zID0gcGFnZXJDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmUtbnVtZXJpY2l0ZW06bm90KC5lLWhpZGUpOm5vdChbc3R5bGUqPVwiZGlzcGxheTogbm9uZVwiXSk6bm90KC5lLW5wKTpub3QoLmUtcHApJyk7XG4gICAgICAgICAgICBpZiAobnVtSXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KG51bUl0ZW1zW251bUl0ZW1zLmxlbmd0aCAtIDFdLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSwgMTApID09PSB0aGlzLnRvdGFsUGFnZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NMaXN0KE5QLCBbJ2UtbmV4dHByZXZpdGVtZGlzYWJsZWQnLCAnZS1kaXNhYmxlJ10sIFsnZS1udW1lcmljaXRlbScsICdlLXBhZ2VyLWRlZmF1bHQnXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChudW1JdGVtc1swXS5nZXRBdHRyaWJ1dGUoJ2luZGV4JyksIDEwKSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc0xpc3QoUFAsIFsnZS1uZXh0cHJldml0ZW1kaXNhYmxlZCcsICdlLWRpc2FibGUnXSwgWydlLW51bWVyaWNpdGVtJywgJ2UtcGFnZXItZGVmYXVsdCddKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGlzTGFzdFNldCA9IEFycmF5LmZyb20obnVtSXRlbXMpLnNvbWUoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIHBhcnNlSW50KGl0ZW0uZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkgPT09IF90aGlzLnRvdGFsUGFnZXM7IH0pO1xuICAgICAgICAgICAgICAgIHZhciBwcEluZGV4ID0gKHBhcnNlSW50KG51bUl0ZW1zWzBdLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSwgMTApIC0gKGlzTGFzdFNldCAmJiAhaXNOdWxsT3JVbmRlZmluZWQodGhpcy5hdmdOdW1JdGVtcykgPyB0aGlzLmF2Z051bUl0ZW1zIDogbnVtSXRlbXMubGVuZ3RoKSk7XG4gICAgICAgICAgICAgICAgUFAuc2V0QXR0cmlidXRlKCdpbmRleCcsIChwcEluZGV4IDwgMSkgPyAnMScgOiBwcEluZGV4LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIE5QLnNldEF0dHJpYnV0ZSgnaW5kZXgnLCAocGFyc2VJbnQobnVtSXRlbXNbbnVtSXRlbXMubGVuZ3RoIC0gMV0uZ2V0QXR0cmlidXRlKCdpbmRleCcpLCAxMCkgKyAxKS50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmF2Z051bUl0ZW1zID0gaXNMYXN0U2V0ID8gdGhpcy5hdmdOdW1JdGVtcyA6IG51bUl0ZW1zLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ29uZGl0aW9uIHRvIGFkZCBhZGFwdGl2ZSBjbGFzcyBuYW1lIGFuZCBzZXQgcGFnZXJtZXNzYWdlIGNvbnRlbnQgd2l0aCBcIi9cIiB3aGVuIG1lZGlhIHF1ZXJ5IGNzcyBoYXMgYmVlbiBhcHBsaWVkLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoKCh0aGlzLmVsZW1lbnQub2Zmc2V0V2lkdGggPCA3NjkpICYmIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1tZmlyc3QnKSkuZ2V0UHJvcGVydHlWYWx1ZSgnZGlzcGxheScpICE9PSAnbm9uZScpICYmIHRoaXMucGFnZVNpemVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXBhZ2VzaXplcycpLmNsYXNzTGlzdC5yZW1vdmUoJ2UtaGlkZScpO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1wYXJlbnRtc2diYXInKS5jbGFzc0xpc3QucmVtb3ZlKCdlLWhpZGUnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZS1hZGFwdGl2ZScpO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZS1wYWdlbm9tc2cnKS5pbm5lckhUTUwgPSB0aGlzLmVsZW1lbnQub2Zmc2V0V2lkdGggPCA0ODEgPyAodGhpcy5jdXJyZW50UGFnZSArICcgLyAnICsgdGhpcy50b3RhbFBhZ2VzKSA6IHRoaXMucGFnZXJNZXNzYWdlTW9kdWxlLmZvcm1hdCh0aGlzLmdldExvY2FsaXplZExhYmVsKCdjdXJyZW50UGFnZUluZm8nKSwgW3RoaXMudG90YWxSZWNvcmRzQ291bnQgPT09IDAgPyAwIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UsIHRoaXMudG90YWxQYWdlcyB8fCAwLCB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50IHx8IDBdKSArICcgJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdlLWFkYXB0aXZlJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lLXBhZ2Vub21zZycpLmlubmVySFRNTCA9IHRoaXMucGFnZXJNZXNzYWdlTW9kdWxlLmZvcm1hdCh0aGlzLmdldExvY2FsaXplZExhYmVsKCdjdXJyZW50UGFnZUluZm8nKSwgW3RoaXMudG90YWxSZWNvcmRzQ291bnQgPT09IDAgPyAwIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UsIHRoaXMudG90YWxQYWdlcyB8fCAwLCB0aGlzLnRvdGFsUmVjb3Jkc0NvdW50IHx8IDBdKSArICcgJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIFBhZ2VyLnByb3RvdHlwZSwgXCJlbmFibGVRdWVyeVN0cmluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBQYWdlci5wcm90b3R5cGUsIFwiZW5hYmxlRXh0ZXJuYWxNZXNzYWdlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KHRydWUpXG4gICAgXSwgUGFnZXIucHJvdG90eXBlLCBcImVuYWJsZVBhZ2VyTWVzc2FnZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgxMilcbiAgICBdLCBQYWdlci5wcm90b3R5cGUsIFwicGFnZVNpemVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoMTApXG4gICAgXSwgUGFnZXIucHJvdG90eXBlLCBcInBhZ2VDb3VudFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgxKVxuICAgIF0sIFBhZ2VyLnByb3RvdHlwZSwgXCJjdXJyZW50UGFnZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgpXG4gICAgXSwgUGFnZXIucHJvdG90eXBlLCBcInRvdGFsUmVjb3Jkc0NvdW50XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KClcbiAgICBdLCBQYWdlci5wcm90b3R5cGUsIFwiZXh0ZXJuYWxNZXNzYWdlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KGZhbHNlKVxuICAgIF0sIFBhZ2VyLnByb3RvdHlwZSwgXCJwYWdlU2l6ZXNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgUHJvcGVydHkoKVxuICAgIF0sIFBhZ2VyLnByb3RvdHlwZSwgXCJ0ZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBQcm9wZXJ0eSgnJylcbiAgICBdLCBQYWdlci5wcm90b3R5cGUsIFwiY3VzdG9tVGV4dFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgUGFnZXIucHJvdG90eXBlLCBcImNsaWNrXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIFByb3BlcnR5KCcnKVxuICAgIF0sIFBhZ2VyLnByb3RvdHlwZSwgXCJjc3NDbGFzc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgUGFnZXIucHJvdG90eXBlLCBcImRyb3BEb3duQ2hhbmdlZFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBFdmVudCgpXG4gICAgXSwgUGFnZXIucHJvdG90eXBlLCBcImNyZWF0ZWRcIiwgdm9pZCAwKTtcbiAgICBQYWdlciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBOb3RpZnlQcm9wZXJ0eUNoYW5nZXNcbiAgICBdLCBQYWdlcik7XG4gICAgcmV0dXJuIFBhZ2VyO1xufShDb21wb25lbnQpKTtcbmV4cG9ydCB7IFBhZ2VyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@syncfusion+ej2-grids@29.1.40/node_modules/@syncfusion/ej2-grids/src/pager/pager.js\n");

/***/ })

};
;