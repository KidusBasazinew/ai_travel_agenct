(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8427],{4169:function(e,t,s){Promise.resolve().then(s.bind(s,9111))},9111:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var r=s(5193),n=s(9557),i=s(2310);s(8022);var a=s(4477),l=s(8367),o=e=>{let{headerTitle:t,total:s,lastMonthCount:n,currentMonthCount:i}=e,{trend:o,percentage:c}=(0,a.jd)(i,n),u="decrement"===o;return(0,r.jsxs)("article",{className:"stats-card",children:[(0,r.jsx)("h3",{className:"text-base font-medium",children:t}),(0,r.jsxs)("div",{className:"content",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)("h2",{className:"text-4xl font-semibold",children:s}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("figure",{className:"flex items-center gap-1",children:[(0,r.jsx)(l.default,{src:"/assets/icons/".concat(u?"arrow-down-red.svg":"arrow-up-green.svg"),className:"size-5",alt:"arrow",width:20,height:20}),(0,r.jsxs)("figcaption",{className:(0,a.cn)("text-sm font-medium",u?"text-red-500":"text-success-700"),children:[Math.round(c),"%"]})]}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-100 truncate",children:"vs last month"})]})]}),(0,r.jsx)(l.default,{width:100,height:100,src:"/assets/icons/".concat(u?"decrement.svg":"increment.svg"),className:"xl:w-32 w-full h-full md:h-32 xl:h-full",alt:"trend graph"})]})]})},c=s(6006),u=s(5367),d=s(568),h=s(1461);let p=async()=>{let e,t,s,r,n,i,a,l,o,c,u,h,p,m,f;let g=new Date,x=new Date(g.getFullYear(),g.getMonth(),1).toISOString(),v=new Date(g.getFullYear(),g.getMonth()-1,1).toISOString(),y=new Date(g.getFullYear(),g.getMonth(),0).toISOString(),[b,j]=await Promise.all([d.Fs.listDocuments(d.qA.databaseId,d.qA.userCollectionId),d.Fs.listDocuments(d.qA.databaseId,d.qA.tripCollectionId)]),w=e=>b.documents.filter(t=>t.status===e);return{totalUsers:b.total,usersJoined:{currentMonth:(e=b.documents,t="joinedAt",s=void 0,e.filter(e=>e[t]>=x&&(!s||e[t]<=s)).length),lastMonth:(r=b.documents,n="joinedAt",r.filter(e=>e[n]>=v&&(!y||e[n]<=y)).length)},userRole:{total:w("user").length,currentMonth:(i=w("user"),a="joinedAt",l=void 0,i.filter(e=>e[a]>=x&&(!l||e[a]<=l)).length),lastMonth:(o=w("user"),c="joinedAt",o.filter(e=>e[c]>=v&&(!y||e[c]<=y)).length)},totalTrips:j.total,tripsCreated:{currentMonth:(u=j.documents,h="createdAt",p=void 0,u.filter(e=>e[h]>=x&&(!p||e[h]<=p)).length),lastMonth:(m=w("user"),f="joinedAt",m.filter(e=>e[f]>=v&&(!y||e[f]<=y)).length)}}},m=async()=>Object.entries((await d.Fs.listDocuments(d.qA.databaseId,d.qA.userCollectionId)).documents.reduce((e,t)=>{let s=new Date(t.joinedAt).toLocaleDateString("en-US",{month:"short",day:"numeric"});return e[s]=(e[s]||0)+1,e},{})).map(e=>{let[t,s]=e;return{count:Number(s),day:t}}),f=async()=>Object.entries((await d.Fs.listDocuments(d.qA.databaseId,d.qA.tripCollectionId)).documents.reduce((e,t)=>{let s=(0,a.c_)(t.tripDetails);if(s&&s.travelStyle){let t=s.travelStyle;e[t]=(e[t]||0)+1}return e},{})).map(e=>{let[t,s]=e;return{count:Number(s),travelStyle:t}});var g=s(3046),x=()=>{var e;let[t,s]=(0,i.useState)(null),[l,x]=(0,i.useState)([]),[v,y]=(0,i.useState)({totalUsers:0,usersJoined:{currentMonth:0,lastMonth:0},totalTrips:0,tripsCreated:{currentMonth:0,lastMonth:0},userRole:{total:0,currentMonth:0,lastMonth:0}}),[b,j]=(0,i.useState)(!0),w=async()=>{try{j(!0);let e=await d.JT.get(),t=await (0,u.Lo)(e.$id);t&&s({id:t.$id,name:t.name,email:t.email,imageUrl:t.imageUrl||"",dateJoined:t.joinedAt});let[r,,,,n]=await Promise.all([p(),m(),f(),(0,u.AW)(4,0),(0,h.B)(4,0)]);y({totalUsers:r.totalUsers,usersJoined:r.usersJoined,totalTrips:r.totalTrips,tripsCreated:r.tripsCreated,userRole:r.userRole});let i=n.allTrips.filter(e=>"tripDetails"in e).map(e=>{let t=(0,a.c_)(e.tripDetails);return t?{id:e.$id,name:t.name||"",imageUrls:e.imageUrls||[],itinerary:t.itinerary,interests:t.interests,travelStyle:t.travelStyle,estimatedPrice:t.estimatedPrice}:null}).filter(e=>null!==e);x(i),j(!1)}catch(e){console.error("Error fetching data:",e)}};return(0,i.useEffect)(()=>{w()},[]),(0,r.jsxs)("main",{className:"dashboard wrapper",children:[(0,r.jsx)(n.Z,{title:"Welcome ".concat(null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"Guest"," \uD83D\uDC4B"),description:"Track activities, trends and popular destinations in real time"}),(0,r.jsx)("section",{className:"flex flex-col gap-6",children:(0,r.jsxs)("div",{className:"grid grid-col-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,r.jsx)(o,{headerTitle:"Total Users",total:v.totalUsers,currentMonthCount:v.usersJoined.currentMonth,lastMonthCount:v.usersJoined.lastMonth}),(0,r.jsx)(o,{headerTitle:"Total Trips",total:v.totalTrips,currentMonthCount:v.tripsCreated.currentMonth,lastMonthCount:v.tripsCreated.lastMonth}),(0,r.jsx)(o,{headerTitle:"Active Users",total:v.userRole.total,currentMonthCount:v.userRole.currentMonth,lastMonthCount:v.userRole.lastMonth})]})}),(0,r.jsxs)("section",{className:"container",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold text-dark-100",children:"Created Trips"}),(0,r.jsx)("div",{className:"trip-grid",children:b?(0,r.jsx)(g.Z,{length:4}):l.map(e=>{var t,s,n;return(0,r.jsx)(c.Z,{id:e.id,name:e.name,imageUrl:e.imageUrls[0],location:null!==(n=null===(s=e.itinerary)||void 0===s?void 0:null===(t=s[0])||void 0===t?void 0:t.location)&&void 0!==n?n:"",tags:[e.interests||"",e.travelStyle||""],price:e.estimatedPrice||""},e.id)})})]})]})}},5367:function(e,t,s){"use strict";s.d(t,{AW:function(){return h},Cb:function(){return u},Lo:function(){return l},TX:function(){return d},aC:function(){return p},cm:function(){return o}});var r=s(2289),n=s(568),i=s(8954),a=s(2310);let l=async e=>{try{let{documents:t,total:s}=await n.Fs.listDocuments(n.qA.databaseId,n.qA.userCollectionId,[r.AE.equal("accountId",e)]);return s>0?t[0]:null}catch(e){return console.error("Error fetching user:",e),null}},o=async()=>{try{let e=await n.JT.get();if(!e)throw Error("User not found");let{providerAccessToken:t}=await n.JT.getSession("current")||{},s=t?await c(t):null;(await n.Fs.createDocument(n.qA.databaseId,n.qA.userCollectionId,r.ID.unique(),{accountId:e.$id,email:e.email,name:e.name,imageUrl:s,joinedAt:new Date().toISOString()})).$id||(0,i.redirect)("/sign-in")}catch(e){console.error("Error storing user data:",e)}},c=async e=>{try{var t;let s=await fetch("https://people.googleapis.com/v1/people/me?personFields=photos",{headers:{Authorization:"Bearer ".concat(e)}});if(!s.ok)throw Error("Failed to fetch Google profile picture");let{photos:r}=await s.json();return(null==r?void 0:null===(t=r[0])||void 0===t?void 0:t.url)||null}catch(e){return console.error("Error fetching Google picture:",e),null}},u=async()=>{try{n.JT.createOAuth2Session(r.O4.Google,"".concat(window.location.origin,"/"),"".concat(window.location.origin,"/404"))}catch(e){console.error("Error during OAuth2 session creation:",e)}},d=async()=>{try{await n.JT.deleteSession("current")}catch(e){console.error("Error during logout:",e)}},h=async(e,t)=>{try{let{documents:s,total:i}=await n.Fs.listDocuments(n.qA.databaseId,n.qA.userCollectionId,[r.AE.limit(e),r.AE.offset(t)]);if(0===i)return{users:[],total:i};return{users:s,total:i}}catch(e){return console.log("Error fetching users"),{users:[],total:0}}};function p(){let[e,t]=(0,a.useState)(null),[s,r]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async()=>{try{let e=await n.JT.get();t(e)}catch(e){console.error("No user found",e),t(null)}finally{r(!1)}})()},[]),{user:e,loading:s,logout:async()=>{try{await n.JT.deleteSession("current"),t(null)}catch(e){throw console.error("Logout failed:",e),e}}}}},568:function(e,t,s){"use strict";s.d(t,{Fs:function(){return l},JT:function(){return a},qA:function(){return n}});var r=s(2289);let n={endpointUrl:"https://fra.cloud.appwrite.io/v1",projectId:"6814b4380013a9b2410d",apiKey:"6814b4380013a9b2410d",databaseId:"6814b52c000b72ebe3de",userCollectionId:"6814b5420024dcd92e84",tripCollectionId:"6814b56000150e453129"},i=new r.KU().setEndpoint(n.endpointUrl).setProject(n.projectId),a=new r.mR(i),l=new r.Lg(i);new r.Ke(i)},1461:function(e,t,s){"use strict";s.d(t,{B:function(){return i},s:function(){return a}});var r=s(568),n=s(2289);let i=async(e,t)=>{let s=await r.Fs.listDocuments(r.qA.databaseId,r.qA.tripCollectionId,[n.AE.limit(e),n.AE.offset(t),n.AE.orderDesc("createdAt")]);return 0===s.total?(console.error("No trips found"),{allTrips:[],total:0}):{allTrips:s.documents,total:s.total}},a=async e=>{let t=await r.Fs.getDocument(r.qA.databaseId,r.qA.tripCollectionId,e);return t.$id?t:(console.log("Trip not found"),null)}},9557:function(e,t,s){"use strict";var r=s(5193),n=s(3356),i=s(4477),a=s(7008),l=s(8954),o=s(8367);t.Z=e=>{let{title:t,description:s,ctaText:c,ctaUrl:u}=e,d=(0,l.usePathname)();return(0,r.jsxs)("header",{className:"header",children:[(0,r.jsxs)("article",{children:[(0,r.jsx)("h1",{className:(0,i.cn)("text-dark-100","/admin"===d?"text-2xl md:text-4xl font-bold":"text-xl md:text-2xl font-semibold"),children:t}),(0,r.jsx)("p",{className:(0,i.cn)("text-gray-600 font-normal","/"===d?"text-base md:text-lg":"text-sm md:text-lg"),children:s})]}),c&&u&&(0,r.jsx)(a.default,{href:u,children:(0,r.jsxs)(n.r,{type:"button",className:"button-class !h-11 !w-full md:w-[240px]",children:[(0,r.jsx)(o.default,{src:"/assets/icons/plus.svg",alt:"plus",className:"size-5",width:100,height:100}),(0,r.jsx)("span",{className:"p-16-semibold text-white",children:c})]})})]})}},6006:function(e,t,s){"use strict";var r=s(5193),n=s(403),i=s(152),a=s(4477),l=s(7008),o=s(8954),c=s(8367);t.Z=e=>{let{id:t,name:s,location:u,imageUrl:d,tags:h,price:p}=e,m=(0,o.usePathname)();return(0,r.jsxs)(l.default,{href:"/"===m||m.startsWith("/travel")?"/travel/".concat(t):"/admin/trips/".concat(t),className:"trip-card",children:[(0,r.jsx)(c.default,{src:d,width:600,height:600,alt:s}),(0,r.jsxs)("article",{children:[(0,r.jsx)("h2",{children:s}),(0,r.jsxs)("figure",{children:[(0,r.jsx)(c.default,{src:"/assets/icons/location-mark.svg",alt:"location",className:"size-4 !w-3 !h-3",width:20,height:20}),(0,r.jsx)("figcaption",{className:"!text-gray-600",children:u})]})]}),(0,r.jsx)("div",{className:"mt-2 pl-[18px] pr-3.5 pb-5",children:(0,r.jsx)(n.r,{id:"travel-chip",children:(0,r.jsx)(i.U,{children:null==h?void 0:h.map((e,t)=>(0,r.jsx)(i.g,{text:(0,a.gr)(e),cssClass:(0,a.cn)(1===t?"!bg-pink-50 !text-pink-500":"!bg-success-50 !text-success-700")},t))})})}),(0,r.jsx)("article",{className:"tripCard-pill",children:p})]})}},3046:function(e,t,s){"use strict";var r=s(5193),n=s(6156);s(2310),t.Z=e=>{let{length:t}=e;return(0,r.jsx)(r.Fragment,{children:Array.from({length:t}).map((e,t)=>(0,r.jsxs)("div",{className:"trip-card",children:[(0,r.jsx)(n._,{width:"100%",height:"100px",shape:"Rectangle",className:"mb-2 bg-gray-300"}),(0,r.jsxs)("article",{className:"p-4",children:[(0,r.jsx)(n._,{width:"100%",height:"20px",shape:"Text",className:"mb-2 bg-gray-300"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(n._,{width:"16px",height:"16px",shape:"Circle",className:"mb-2 bg-gray-300"}),(0,r.jsx)(n._,{width:"40%",height:"14px",shape:"Text",className:"mb-2 bg-gray-300"})]})]}),(0,r.jsxs)("div",{className:"mt-2 pl-[18px] pr-3.5 pb-5 flex gap-2 flex-wrap",children:[(0,r.jsx)(n._,{width:"60px",height:"28px",shape:"Text",className:" bg-gray-300"}),(0,r.jsx)(n._,{width:"50px",height:"28px",shape:"Text",className:" bg-gray-300"})]}),(0,r.jsx)("div",{className:"tripCard-pill",children:(0,r.jsx)(n._,{width:"80px",height:"24px",shape:"Text"})})]},t))})}},8022:function(e,t,s){"use strict";(0,s(4173).GG)("Ngo9BigBOggjHTQxAR8/V1NNaF5cWWJCf1FpRmJGdld5fUVHYVZUTXxaS00DNHVRdkdmWXpednRQQmNdVUdzW0pWYUA=")},4477:function(e,t,s){"use strict";s.d(t,{Ew:function(){return h},c_:function(){return c},cn:function(){return l},gr:function(){return u},jd:function(){return d},p6:function(){return o}});var r=s(4848),n=s(9998),i=s(3676),a=s.n(i);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,r.W)(t))}let o=e=>a()(e).format("MMMM DD, YYYY");function c(e){try{return JSON.parse(e)}catch(e){return console.error("Failed to parse trip data:",e),null}}function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.trim().split(/\s+/)[0]||""}let d=(e,t)=>{if(0===t)return 0===e?{trend:"no change",percentage:0}:{trend:"increment",percentage:100};let s=e-t,r=Math.abs(s/t*100);return s>0?{trend:"increment",percentage:r}:s<0?{trend:"decrement",percentage:r}:{trend:"no change",percentage:0}},h=e=>e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())},7366:function(e,t,s){"use strict";s.d(t,{Od:function(){return h}});var r,n,i,a,l,o=s(4173),c=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,t)},function(e,t){function s(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}),u=function(e,t,s,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,s,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(a=(i<3?n(a):i>3?n(t,s,a):n(t,s))||a);return i>3&&a&&Object.defineProperty(t,s,a),a},d={TEXTSHAPE:"e-skeleton-text",CIRCLESHAPE:"e-skeleton-circle",SQUARESHAPE:"e-skeleton-square",RECTANGLESHAPE:"e-skeleton-rectangle",WAVEEFFECT:"e-shimmer-wave",PULSEEFFECT:"e-shimmer-pulse",FADEEFFECT:"e-shimmer-fade",VISIBLENONE:"e-visible-none"};(n=a||(a={})).Text="Text",n.Circle="Circle",n.Square="Square",n.Rectangle="Rectangle",(i=l||(l={})).Wave="Wave",i.Fade="Fade",i.Pulse="Pulse",i.None="None";var h=function(e){function t(t,s){return e.call(this,t,s)||this}return c(t,e),t.prototype.getModuleName=function(){return"skeleton"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.preRender=function(){this.element.id||(this.element.id=(0,o.QI)("e-"+this.getModuleName())),this.updateCssClass(),(0,o.Y4)(this.element,{role:"alert","aria-busy":"true","aria-live":"polite","aria-label":this.label})},t.prototype.render=function(){this.initialize()},t.prototype.onPropertyChanged=function(e,t){for(var s=0,r=Object.keys(e);s<r.length;s++)switch(r[s]){case"width":case"height":this.updateDimension();break;case"shape":this.updateShape();break;case"shimmerEffect":this.updateEffect();break;case"visible":this.updateVisibility();break;case"label":this.element.setAttribute("aria-label",this.label);break;case"cssClass":t.cssClass&&(0,o.IV)([this.element],t.cssClass.split(" ")),this.updateCssClass()}},t.prototype.destroy=function(){e.prototype.destroy.call(this);var t=["role","aria-live","aria-busy","aria-label"],s=[];this.cssClass&&(s=s.concat(this.cssClass.split(" ")));for(var r=0;r<t.length;r++)this.element.removeAttribute(t[parseInt(r.toString(),10)]);s=(s=s.concat(this.element.classList.value.match(/(e-skeleton-[^\s]+)/g)||[])).concat(this.element.classList.value.match(/(e-shimmer-[^\s]+)/g)||[]),(0,o.IV)([this.element],s)},t.prototype.initialize=function(){this.updateShape(),this.updateEffect(),this.updateVisibility()},t.prototype.updateShape=function(){if(!(0,o.le)(this.shape)){var e=d[this.shape.toUpperCase()+"SHAPE"],t=this.element.classList.value.match(/(e-skeleton-[^\s]+)/g)||[];this.updateDimension(),t&&(0,o.IV)([this.element],t),(0,o.cn)([this.element],[e])}},t.prototype.updateDimension=function(){var e=!this.width&&["Text","Rectangle"].indexOf(this.shape)>-1?"100%":(0,o.Ac)(this.width),t=["Circle","Square"].indexOf(this.shape)>-1?e:(0,o.Ac)(this.height);this.element.style.width=e,this.element.style.height=t},t.prototype.updateEffect=function(){var e=this.element.classList.value.match(/(e-shimmer-[^\s]+)/g)||[];e&&(0,o.IV)([this.element],e),(0,o.le)(this.shimmerEffect)||(0,o.cn)([this.element],[d[this.shimmerEffect.toUpperCase()+"EFFECT"]])},t.prototype.updateVisibility=function(){this.element.classList[this.visible?"remove":"add"](d.VISIBLENONE)},t.prototype.updateCssClass=function(){this.cssClass&&(0,o.cn)([this.element],this.cssClass.split(" "))},u([(0,o.Z9)("")],t.prototype,"width",void 0),u([(0,o.Z9)("")],t.prototype,"height",void 0),u([(0,o.Z9)(!0)],t.prototype,"visible",void 0),u([(0,o.Z9)("Text")],t.prototype,"shape",void 0),u([(0,o.Z9)("Wave")],t.prototype,"shimmerEffect",void 0),u([(0,o.Z9)("Loading...")],t.prototype,"label",void 0),u([(0,o.Z9)("")],t.prototype,"cssClass",void 0),t=u([o.Zl],t)}(o.wA)},6156:function(e,t,s){"use strict";s.d(t,{_:function(){return o}});var r,n=s(2310),i=s(7366),a=s(1226),l=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,t)},function(e,t){function s(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}),o=function(e){function t(t){var s=e.call(this,t)||this;return s.initRenderCalled=!1,s.checkInjectedModules=!1,s.statelessTemplateProps=null,s.templateProps=null,s.immediateRender=!0,s.isReactMock=!0,s.portals=[],s}return l(t,e),t.prototype.render=function(){if(this.isReactMock=!1,(!this.element||this.initRenderCalled)&&!this.refreshing||this.isReactForeceUpdate)return n.createElement("div",this.getDefaultAttributes(),[].concat(this.props.children,this.portals));e.prototype.render.call(this),this.initRenderCalled=!0},t}(i.Od);(0,a.ef)(o,[a.VZ,n.Component])}},function(e){e.O(0,[3612,9276,7981,1226,3356,8631,3044,7550,1744],function(){return e(e.s=4169)}),_N_E=e.O()}]);