(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1253],{2509:function(e,t,r){Promise.resolve().then(r.bind(r,1783))},1783:function(e,t,r){"use strict";r.r(t);var n=r(5193),o=r(3356),s=r(5367),a=r(568),i=r(7008),c=r(8367);r(8022);var l=r(2310),u=r(8954);t.default=()=>{let e=(0,u.useRouter)();return(0,l.useEffect)(()=>{(async()=>{try{let t=await a.JT.get();(null==t?void 0:t.$id)&&e.push("/")}catch(e){console.log("No user logged in",e)}})()},[e]),(0,n.jsx)("main",{className:"auth",children:(0,n.jsx)("section",{className:"size-full glassmorphism flex-center px-6",children:(0,n.jsxs)("div",{className:"sign-in-card",children:[(0,n.jsxs)("header",{className:"header",children:[(0,n.jsx)(i.default,{href:"/",children:(0,n.jsx)(c.default,{src:"/assets/icons/logo.svg",alt:"logo",width:100,height:100,className:"size-[30px]"})}),(0,n.jsx)("h1",{className:"p-28-bold text-dark-100",children:"Tourvisto"})]}),(0,n.jsxs)("article",{children:[(0,n.jsx)("h2",{className:"p-28-semibold text-dark-100 text-center",children:"Start Your Travel Journey"}),(0,n.jsx)("p",{className:"p-18-regular text-center text-gray-600 !leading-7",children:"Sign in with Google to manage destinations, itineraries, and user activity with ease."})]}),(0,n.jsxs)(o.r,{type:"button",iconCss:"e-search-icon",className:"button-class !h-11 !w-full",onClick:s.Cb,children:[(0,n.jsx)(c.default,{src:"/assets/icons/google.svg",className:"size-5",width:100,height:100,alt:"google"}),(0,n.jsx)("span",{className:"p-18-semibold text-white",children:"Sign in with Google"})]})]})})})}},5367:function(e,t,r){"use strict";r.d(t,{AW:function(){return h},Cb:function(){return u},Lo:function(){return i},TX:function(){return d},aC:function(){return g},cm:function(){return c}});var n=r(2289),o=r(568),s=r(8954),a=r(2310);let i=async e=>{try{let{documents:t,total:r}=await o.Fs.listDocuments(o.qA.databaseId,o.qA.userCollectionId,[n.AE.equal("accountId",e)]);return r>0?t[0]:null}catch(e){return console.error("Error fetching user:",e),null}},c=async()=>{try{let e=await o.JT.get();if(!e)throw Error("User not found");let{providerAccessToken:t}=await o.JT.getSession("current")||{},r=t?await l(t):null;(await o.Fs.createDocument(o.qA.databaseId,o.qA.userCollectionId,n.ID.unique(),{accountId:e.$id,email:e.email,name:e.name,imageUrl:r,joinedAt:new Date().toISOString()})).$id||(0,s.redirect)("/sign-in")}catch(e){console.error("Error storing user data:",e)}},l=async e=>{try{var t;let r=await fetch("https://people.googleapis.com/v1/people/me?personFields=photos",{headers:{Authorization:"Bearer ".concat(e)}});if(!r.ok)throw Error("Failed to fetch Google profile picture");let{photos:n}=await r.json();return(null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.url)||null}catch(e){return console.error("Error fetching Google picture:",e),null}},u=async()=>{try{o.JT.createOAuth2Session(n.O4.Google,"".concat(window.location.origin,"/"),"".concat(window.location.origin,"/404"))}catch(e){console.error("Error during OAuth2 session creation:",e)}},d=async()=>{try{await o.JT.deleteSession("current")}catch(e){console.error("Error during logout:",e)}},h=async(e,t)=>{try{let{documents:r,total:s}=await o.Fs.listDocuments(o.qA.databaseId,o.qA.userCollectionId,[n.AE.limit(e),n.AE.offset(t)]);if(0===s)return{users:[],total:s};return{users:r,total:s}}catch(e){return console.log("Error fetching users"),{users:[],total:0}}};function g(){let[e,t]=(0,a.useState)(null),[r,n]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async()=>{try{let e=await o.JT.get();t(e)}catch(e){console.error("No user found",e),t(null)}finally{n(!1)}})()},[]),{user:e,loading:r,logout:async()=>{try{await o.JT.deleteSession("current"),t(null)}catch(e){throw console.error("Logout failed:",e),e}}}}},568:function(e,t,r){"use strict";r.d(t,{Fs:function(){return i},JT:function(){return a},qA:function(){return o}});var n=r(2289);let o={endpointUrl:"https://fra.cloud.appwrite.io/v1",projectId:"6814b4380013a9b2410d",apiKey:"6814b4380013a9b2410d",databaseId:"6814b52c000b72ebe3de",userCollectionId:"6814b5420024dcd92e84",tripCollectionId:"6814b56000150e453129"},s=new n.KU().setEndpoint(o.endpointUrl).setProject(o.projectId),a=new n.mR(s),i=new n.Lg(s);new n.Ke(s)},8022:function(e,t,r){"use strict";(0,r(4173).GG)("Ngo9BigBOggjHTQxAR8/V1NNaF5cWWJCf1FpRmJGdld5fUVHYVZUTXxaS00DNHVRdkdmWXpednRQQmNdVUdzW0pWYUA=")}},function(e){e.O(0,[3612,7981,1226,3356,3044,7550,1744],function(){return e(e.s=2509)}),_N_E=e.O()}]);