(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{2134:function(e,t,r){Promise.resolve().then(r.bind(r,7971)),Promise.resolve().then(r.t.bind(r,7624,23)),Promise.resolve().then(r.t.bind(r,6686,23)),Promise.resolve().then(r.t.bind(r,1839,23))},5367:function(e,t,r){"use strict";r.d(t,{AW:function(){return f},Cb:function(){return u},Lo:function(){return i},TX:function(){return d},aC:function(){return h},cm:function(){return l}});var n=r(2289),a=r(568),o=r(8954),s=r(2310);let i=async e=>{try{let{documents:t,total:r}=await a.Fs.listDocuments(a.qA.databaseId,a.qA.userCollectionId,[n.AE.equal("accountId",e)]);return r>0?t[0]:null}catch(e){return console.error("Error fetching user:",e),null}},l=async()=>{try{let e=await a.JT.get();if(!e)throw Error("User not found");let{providerAccessToken:t}=await a.JT.getSession("current")||{},r=t?await c(t):null;(await a.Fs.createDocument(a.qA.databaseId,a.qA.userCollectionId,n.ID.unique(),{accountId:e.$id,email:e.email,name:e.name,imageUrl:r,joinedAt:new Date().toISOString()})).$id||(0,o.redirect)("/sign-in")}catch(e){console.error("Error storing user data:",e)}},c=async e=>{try{var t;let r=await fetch("https://people.googleapis.com/v1/people/me?personFields=photos",{headers:{Authorization:"Bearer ".concat(e)}});if(!r.ok)throw Error("Failed to fetch Google profile picture");let{photos:n}=await r.json();return(null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.url)||null}catch(e){return console.error("Error fetching Google picture:",e),null}},u=async()=>{try{a.JT.createOAuth2Session(n.O4.Google,"".concat(window.location.origin,"/"),"".concat(window.location.origin,"/404"))}catch(e){console.error("Error during OAuth2 session creation:",e)}},d=async()=>{try{await a.JT.deleteSession("current")}catch(e){console.error("Error during logout:",e)}},f=async(e,t)=>{try{let{documents:r,total:o}=await a.Fs.listDocuments(a.qA.databaseId,a.qA.userCollectionId,[n.AE.limit(e),n.AE.offset(t)]);if(0===o)return{users:[],total:o};return{users:r,total:o}}catch(e){return console.log("Error fetching users"),{users:[],total:0}}};function h(){let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{let e=await a.JT.get();t(e)}catch(e){console.error("No user found",e),t(null)}finally{n(!1)}})()},[]),{user:e,loading:r,logout:async()=>{try{await a.JT.deleteSession("current"),t(null)}catch(e){throw console.error("Logout failed:",e),e}}}}},568:function(e,t,r){"use strict";r.d(t,{Fs:function(){return i},JT:function(){return s},qA:function(){return a}});var n=r(2289);let a={endpointUrl:"https://fra.cloud.appwrite.io/v1",projectId:"6814b4380013a9b2410d",apiKey:"6814b4380013a9b2410d",databaseId:"6814b52c000b72ebe3de",userCollectionId:"6814b5420024dcd92e84",tripCollectionId:"6814b56000150e453129"},o=new n.KU().setEndpoint(a.endpointUrl).setProject(a.projectId),s=new n.mR(o),i=new n.Lg(o);new n.Ke(o)},7971:function(e,t,r){"use strict";r.d(t,{default:function(){return d}});var n=r(5193),a=r(8954),o=r(7008),s=r(8367),i=r(4477),l=r(5367),c=r(2310),u=r(568);function d(){let e=(0,a.usePathname)(),{logout:t}=(0,l.aC)(),r=(0,a.useRouter)(),[d,f]=(0,c.useState)(null),[h,m]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{try{let e=await u.JT.get(),t=await (0,l.Lo)(e.$id);if(t){let e={id:t.$id,name:t.name,email:t.email,imageUrl:t.imageUrl||""};f(e)}}catch(e){console.error("No user found",e)}})();let e=()=>{m(window.scrollY>600)};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[]);let g=async()=>{try{await t(),r.push("/sign-in")}catch(e){console.error("Logout failed:",e)}};return e.startsWith("/sign-in")||e.startsWith("/admin")||e.startsWith("/payment")?null:(0,n.jsxs)("nav",{className:(0,i.cn)(h||e.startsWith("/travel")?"bg-white shadow-gray-100 shadow-md":"glassmorphism","flex py-2 justify-between w-full items-center fixed z-50"),children:[(0,n.jsx)("div",{className:"flex items-center space-x-4 ml-10",children:(0,n.jsxs)(o.default,{href:"/",className:"flex items-center space-x-2",children:[(0,n.jsx)(s.default,{src:"/assets/icons/logo.svg",alt:"Logo",width:32,height:32,className:"size-8"}),(0,n.jsx)("span",{className:"font-semibold text-lg",children:"Tourvisto"})]})}),(0,n.jsxs)("div",{className:"flex items-center space-x-4 mr-10",children:[(0,n.jsx)(o.default,{href:"/admin",className:(0,i.cn)(h||e.startsWith("/travel")?"text-gray-800":"text-white","font-base font-normal"),children:"Admin Panel"}),(0,n.jsx)(o.default,{href:"/",className:(0,i.cn)("text-base font-normal",{"text-white":!h,"text-black":h,"text-dark-100":e.startsWith("/travel")})}),(0,n.jsx)(s.default,{src:(null==d?void 0:d.imageUrl)||"/assets/images/david.wepb",alt:"user",referrerPolicy:"no-referrer",width:100,height:100,className:"w-10 h-10 rounded-full overflow-hidden"}),(0,n.jsx)("button",{onClick:g,className:"cursor-pointer rounded-full bg-white opacity-70 p-1 transition-all duration-300 hover:opacity-100",children:(0,n.jsx)(s.default,{width:100,height:100,src:"/assets/icons/logout.svg",alt:"logout",className:"size-10 rotate-180 transition-all duration-300"})})]})]})}},4477:function(e,t,r){"use strict";r.d(t,{Ew:function(){return f},c_:function(){return c},cn:function(){return i},gr:function(){return u},jd:function(){return d},p6:function(){return l}});var n=r(4848),a=r(9998),o=r(3676),s=r.n(o);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}let l=e=>s()(e).format("MMMM DD, YYYY");function c(e){try{return JSON.parse(e)}catch(e){return console.error("Failed to parse trip data:",e),null}}function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.trim().split(/\s+/)[0]||""}let d=(e,t)=>{if(0===t)return 0===e?{trend:"no change",percentage:0}:{trend:"increment",percentage:100};let r=e-t,n=Math.abs(r/t*100);return r>0?{trend:"increment",percentage:n}:r<0?{trend:"decrement",percentage:n}:{trend:"no change",percentage:0}},f=e=>e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())},1839:function(){},6686:function(e){e.exports={style:{fontFamily:"'__geistMono_c3aa02', '__geistMono_Fallback_c3aa02'"},className:"__className_c3aa02",variable:"__variable_c3aa02"}},7624:function(e){e.exports={style:{fontFamily:"'__geistSans_1e4310', '__geistSans_Fallback_1e4310'"},className:"__className_1e4310",variable:"__variable_1e4310"}}},function(e){e.O(0,[9425,9473,3698,114,5996,7028,2599,4101,9068,7742,6103,3612,9276,7981,3044,7550,1744],function(){return e(e.s=2134)}),_N_E=e.O()}]);